Starting job 14 at Thu Mar  6 10:11:18 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_fact_first_zero_shot_structured train=json_fact_first_zero_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '14', 'training']
Updating job 14 to status training with exit code None
Status update completed for job 14
[2025-03-06 10:11:34,018][root][INFO] - Global seed set to 314
[2025-03-06 10:11:34,020][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 10:11:34,020][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 10:11:34,020][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 10:11:34,020][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:11:34,020][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 10:11:34,042][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:11:34,117][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 10:11:34,119][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 10:11:34,141][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 10:11:34,915][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 10:11:58,687][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 10:12:31,908][root][INFO] - Model prepared for kbit training
[2025-03-06 10:12:31,909][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'down_proj', 'k_proj', 'q_proj', 'up_proj', 'gate_proj', 'v_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 10:12:33,701][root][INFO] - Lora adapter added to model
[2025-03-06 10:12:33,704][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_zero_shot_structured
[2025-03-06 10:12:33,951][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.796, 'grad_norm': 0.4874052405357361, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4417, 'grad_norm': 0.41700202226638794, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.2339, 'grad_norm': 0.38822686672210693, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.0782, 'grad_norm': 0.38202959299087524, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8461, 'grad_norm': 0.385928213596344, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 319.6931, 'train_samples_per_second': 0.328, 'train_steps_per_second': 0.047, 'train_loss': 1.2791800657908121, 'epoch': 15.0}
[2025-03-06 10:18:01,627][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_zero_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '14', 'trained', '0']
Updating job 14 to status trained with exit code 0
Status update completed for job 14
Starting evaluations for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 10:18:11,078][root][INFO] - Setting global seed to 206
[2025-03-06 10:18:11,085][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:18:11,086][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:18:11,087][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:18:11,090][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:18:11,096][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:18:11,096][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:18:11,252][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:18:11,838][root][INFO] - Full model selected, loading model
[2025-03-06 10:18:35,261][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:20:36,124][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:20:36,124][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:21:11,247][root][INFO] - Peft model loaded successfully
[2025-03-06 10:21:19,447][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:21:19,449][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:21:19,449][root][INFO] - Starting inference
[2025-03-06 10:21:19,677][root][INFO] - Processing question number 0
[2025-03-06 10:21:19,679][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:21:29,496][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:21:42,214][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:21:57,869][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:22:13,809][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:22:26,143][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:22:38,782][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:22:52,219][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:23:05,751][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:23:17,877][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:23:27,872][root][INFO] - Processing question number 10
[2025-03-06 10:23:27,874][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:23:43,251][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:23:55,417][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:24:06,216][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:24:20,322][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:24:32,527][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:24:46,370][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:24:56,431][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:25:06,148][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:25:17,650][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:25:30,403][root][INFO] - Processing question number 20
[2025-03-06 10:25:30,405][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:25:41,920][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:25:57,088][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:26:10,999][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:26:22,991][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:26:34,846][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:26:47,817][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:26:59,795][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:27:11,194][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:27:23,107][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:27:34,116][root][INFO] - Processing question number 30
[2025-03-06 10:27:34,118][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:27:47,223][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:28:01,164][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:28:14,750][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:28:25,771][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:28:35,941][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:28:50,317][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:29:01,610][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:29:14,854][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:29:32,783][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:29:46,984][root][INFO] - Processing question number 40
[2025-03-06 10:29:46,987][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:30:01,324][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:30:13,677][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:30:28,864][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:30:41,341][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:30:57,156][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:31:08,718][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:31:22,866][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:31:34,823][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:31:44,463][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:31:53,945][root][INFO] - Processing question number 50
[2025-03-06 10:31:53,948][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:32:06,261][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:32:20,368][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:32:29,411][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:32:43,451][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:32:53,195][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:33:04,678][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:33:19,312][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:33:29,791][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:33:41,850][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:33:52,951][root][INFO] - Processing question number 60
[2025-03-06 10:33:52,955][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:34:07,397][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:34:19,570][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:34:31,600][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:34:39,766][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:34:51,317][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:35:03,516][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:35:14,912][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:35:28,649][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:35:41,697][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:35:56,175][root][INFO] - Processing question number 70
[2025-03-06 10:35:56,179][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:36:08,860][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:36:25,148][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:36:36,564][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:36:50,611][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:37:02,817][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:37:17,497][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:37:34,599][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:37:47,517][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:38:01,302][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:38:13,810][root][INFO] - Processing question number 80
[2025-03-06 10:38:13,815][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:38:30,278][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:38:46,124][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:38:58,345][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:39:13,302][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:39:26,584][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:39:40,292][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:39:52,099][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:40:06,269][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:40:21,283][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:40:31,885][root][INFO] - Processing question number 90
[2025-03-06 10:40:31,889][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:40:45,229][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:40:56,582][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:41:12,035][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:41:24,263][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:41:37,822][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:41:48,206][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:41:57,905][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:42:11,387][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:42:23,408][root][INFO] - Inference complete
[2025-03-06 10:42:23,408][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,416][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,428][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,433][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,433][root][INFO] - Saved parsed outputs
[2025-03-06 10:42:23,433][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,435][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,435][root][INFO] - Saved parsing metadata
[2025-03-06 10:42:23,437][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,439][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:42:23,441][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:42:23,473][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 10:42:23,473][root][INFO] - Summary of metrics : {'label_accuracy': 0.42424242424242425, 'misclassification_rate': 0.5757575757575757, 'combined_accuracy': 0.0, 'malformed_label': 27, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 57}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 10:42:32,149][root][INFO] - Setting global seed to 206
[2025-03-06 10:42:32,157][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:42:32,157][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:42:32,159][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:42:32,160][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:42:32,164][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:42:32,164][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:42:32,318][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:42:32,862][root][INFO] - Full model selected, loading model
[2025-03-06 10:42:57,258][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:42:57,259][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:43:05,308][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:43:05,310][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:43:05,310][root][INFO] - Starting inference
[2025-03-06 10:43:05,512][root][INFO] - Processing question number 0
[2025-03-06 10:43:05,514][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:43:14,410][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:43:25,163][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:43:39,880][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:43:53,486][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:44:03,034][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:44:18,619][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:44:26,891][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:44:43,213][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:44:54,965][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:45:04,905][root][INFO] - Processing question number 10
[2025-03-06 10:45:04,907][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:45:18,080][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:45:26,572][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:45:37,967][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:45:50,735][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:46:04,604][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:46:15,253][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:46:26,215][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:46:34,036][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:46:40,230][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:46:48,131][root][INFO] - Processing question number 20
[2025-03-06 10:46:48,133][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:46:57,830][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:47:08,997][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:47:20,447][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:47:30,463][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:47:42,259][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:47:52,383][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:48:02,083][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:48:13,051][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:48:20,242][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:48:31,341][root][INFO] - Processing question number 30
[2025-03-06 10:48:31,344][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:48:45,843][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:48:57,229][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:49:09,020][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:49:18,909][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:49:31,057][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:49:41,374][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:49:50,625][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:50:08,143][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:50:22,259][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:50:32,363][root][INFO] - Processing question number 40
[2025-03-06 10:50:32,366][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:50:42,056][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:50:52,571][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:51:08,827][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:51:20,708][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:51:32,128][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:51:39,332][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:51:48,602][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:51:59,365][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:52:08,164][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:52:18,783][root][INFO] - Processing question number 50
[2025-03-06 10:52:18,786][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:52:29,150][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:52:39,989][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:52:47,754][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:52:57,201][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:53:07,218][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:53:18,239][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:53:31,642][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:53:42,172][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:53:57,747][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:54:05,864][root][INFO] - Processing question number 60
[2025-03-06 10:54:05,867][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:54:17,097][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:54:27,176][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:54:39,712][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:54:48,567][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:54:57,054][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:55:09,344][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:55:18,216][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:55:27,401][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:55:37,402][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:55:52,013][root][INFO] - Processing question number 70
[2025-03-06 10:55:52,016][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:56:02,407][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:56:17,048][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:56:28,320][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:56:40,242][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:56:52,668][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:57:02,286][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:57:18,210][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:57:29,120][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:57:41,255][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:57:49,683][root][INFO] - Processing question number 80
[2025-03-06 10:57:49,686][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:58:00,368][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:58:13,640][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:58:22,038][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:58:31,368][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:58:41,646][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:58:51,908][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:59:01,094][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:59:11,340][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:59:21,024][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:59:31,958][root][INFO] - Processing question number 90
[2025-03-06 10:59:31,962][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:59:45,269][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:59:55,854][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:00:10,047][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:00:20,405][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:00:28,153][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:00:36,935][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:00:45,710][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:01:02,748][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:01:13,031][root][INFO] - Inference complete
[2025-03-06 11:01:13,031][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,037][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,039][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,040][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,041][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,041][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,041][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,041][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,042][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,042][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,042][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,043][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,043][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,043][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,043][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,043][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,044][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,044][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,044][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,044][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,044][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,045][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,045][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,045][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,045][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,045][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,046][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,046][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,047][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,047][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,047][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,047][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,047][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,048][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,048][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,049][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,049][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,049][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,050][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,051][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,051][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,051][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,051][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,051][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,051][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,052][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,052][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,053][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:13,053][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:13,053][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:13,056][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,060][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,060][root][INFO] - Saved parsed outputs
[2025-03-06 11:01:13,061][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,062][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,062][root][INFO] - Saved parsing metadata
[2025-03-06 11:01:13,064][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,065][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:01:13,067][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:01:13,094][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 11:01:13,094][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.0, 'malformed_label': 18, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 11:01:20,023][root][INFO] - Setting global seed to 206
[2025-03-06 11:01:20,028][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:01:20,028][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:01:20,030][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:01:20,031][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:01:20,034][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:01:20,034][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:01:20,199][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:01:20,781][root][INFO] - Full model selected, loading model
[2025-03-06 11:01:47,159][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:03:44,053][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:03:44,053][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:04:19,426][root][INFO] - Peft model loaded successfully
[2025-03-06 11:04:27,011][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:04:27,012][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:04:27,013][root][INFO] - Starting inference
[2025-03-06 11:04:27,233][root][INFO] - Processing question number 0
[2025-03-06 11:04:27,235][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:04:37,328][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:04:49,213][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:05:05,197][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:05:20,449][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:05:33,824][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:05:48,442][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:06:02,033][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:06:16,480][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:06:29,727][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:06:39,981][root][INFO] - Processing question number 10
[2025-03-06 11:06:39,983][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:06:54,042][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:07:05,971][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:07:17,133][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:07:29,669][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:07:43,551][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:07:56,567][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:08:09,955][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:08:22,662][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:08:34,152][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:08:46,436][root][INFO] - Processing question number 20
[2025-03-06 11:08:46,438][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:09:00,019][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:09:12,980][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:09:26,632][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:09:38,821][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:09:50,813][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:10:05,777][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:10:17,611][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:10:29,996][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:10:42,809][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:10:52,899][root][INFO] - Processing question number 30
[2025-03-06 11:10:52,901][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:11:08,619][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:11:18,967][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:11:32,606][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:11:44,034][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:11:53,771][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:12:05,921][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:12:18,582][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:12:30,931][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:12:45,352][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:12:58,169][root][INFO] - Processing question number 40
[2025-03-06 11:12:58,172][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:13:10,021][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:13:24,937][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:13:37,656][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:13:51,541][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:14:04,889][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:14:15,792][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:14:30,677][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:14:42,506][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:14:50,790][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:15:00,594][root][INFO] - Processing question number 50
[2025-03-06 11:15:00,597][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:15:15,229][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:15:28,892][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:15:38,059][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:15:51,774][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:16:01,354][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:16:12,603][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:16:24,190][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:16:35,362][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:16:47,465][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:16:58,079][root][INFO] - Processing question number 60
[2025-03-06 11:16:58,083][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:17:11,742][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:17:22,831][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:17:35,192][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:17:43,741][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:17:55,435][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:18:07,686][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:18:18,995][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:18:38,375][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:18:50,811][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:19:04,625][root][INFO] - Processing question number 70
[2025-03-06 11:19:04,629][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:19:14,645][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:19:29,073][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:19:40,352][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:19:56,620][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:20:11,346][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:20:22,436][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:20:35,554][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:20:50,155][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:21:03,291][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:21:16,240][root][INFO] - Processing question number 80
[2025-03-06 11:21:16,244][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:21:31,731][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:21:50,655][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:22:02,521][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:22:14,500][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:22:28,280][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:22:43,920][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:22:55,684][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:23:04,311][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:23:17,698][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:23:29,272][root][INFO] - Processing question number 90
[2025-03-06 11:23:29,276][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:23:44,326][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:23:56,380][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:24:12,783][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:24:25,260][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:24:38,404][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:24:47,952][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:24:58,288][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:25:17,979][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:25:32,616][root][INFO] - Inference complete
[2025-03-06 11:25:32,616][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,621][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,629][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:25:32,629][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:25:32,630][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:25:32,636][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,640][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,640][root][INFO] - Saved parsed outputs
[2025-03-06 11:25:32,641][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,642][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,642][root][INFO] - Saved parsing metadata
[2025-03-06 11:25:32,642][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,644][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:32,645][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:25:32,666][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 11:25:32,666][root][INFO] - Summary of metrics : {'label_accuracy': 0.3838383838383838, 'misclassification_rate': 0.6161616161616161, 'combined_accuracy': 0.0, 'malformed_label': 23, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 38, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 38, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 11:25:44,179][root][INFO] - Setting global seed to 206
[2025-03-06 11:25:44,185][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:25:44,185][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:25:44,187][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:25:44,189][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:25:44,202][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:25:44,202][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:25:44,379][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:25:44,974][root][INFO] - Full model selected, loading model
[2025-03-06 11:26:12,116][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:26:12,130][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:26:20,097][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:26:20,098][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:26:20,098][root][INFO] - Starting inference
[2025-03-06 11:26:20,256][root][INFO] - Processing question number 0
[2025-03-06 11:26:20,258][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:26:28,573][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:26:40,065][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:26:57,817][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:27:06,647][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:27:20,389][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:27:33,303][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:27:41,700][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:27:53,399][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:28:06,171][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:28:16,456][root][INFO] - Processing question number 10
[2025-03-06 11:28:16,458][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:28:26,867][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:28:38,464][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:28:49,802][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:29:00,006][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:29:12,354][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:29:25,939][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:29:36,530][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:29:44,905][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:29:53,110][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:30:04,112][root][INFO] - Processing question number 20
[2025-03-06 11:30:04,114][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:30:14,621][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:30:25,017][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:30:33,356][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:30:43,429][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:30:53,751][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:31:04,127][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:31:14,407][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:31:26,110][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:31:34,402][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:31:45,400][root][INFO] - Processing question number 30
[2025-03-06 11:31:45,403][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:31:57,883][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:32:09,433][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:32:22,447][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:32:32,871][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:32:44,266][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:32:54,030][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:33:04,269][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:33:16,414][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:33:27,081][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:33:36,996][root][INFO] - Processing question number 40
[2025-03-06 11:33:36,999][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:33:49,250][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:33:59,369][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:34:11,512][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:34:21,667][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:34:30,500][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:34:40,624][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:34:49,839][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:34:59,337][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:35:09,115][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:35:19,410][root][INFO] - Processing question number 50
[2025-03-06 11:35:19,413][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:35:32,185][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:35:43,314][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:35:52,178][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:36:04,374][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:36:13,191][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:36:23,837][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:36:36,559][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:36:46,521][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:36:58,185][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:37:09,158][root][INFO] - Processing question number 60
[2025-03-06 11:37:09,161][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:37:21,963][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:37:30,751][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:37:42,490][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:37:51,993][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:38:00,887][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:38:11,608][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:38:20,399][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:38:32,631][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:38:41,808][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:38:56,681][root][INFO] - Processing question number 70
[2025-03-06 11:38:56,684][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:39:06,826][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:39:17,764][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:39:28,737][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:39:41,214][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:39:53,828][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:40:03,560][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:40:18,457][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:40:30,402][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:40:42,577][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:40:49,901][root][INFO] - Processing question number 80
[2025-03-06 11:40:49,905][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:41:00,556][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:41:12,129][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:41:20,904][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:41:31,504][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:41:42,936][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:41:57,660][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:42:07,468][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:42:17,601][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:42:30,966][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:42:38,783][root][INFO] - Processing question number 90
[2025-03-06 11:42:38,787][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:42:53,493][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:43:05,395][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:43:16,714][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:43:29,042][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:43:38,907][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:43:46,694][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:43:54,040][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:44:07,915][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:44:20,650][root][INFO] - Inference complete
[2025-03-06 11:44:20,651][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,656][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,658][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,658][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,659][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,660][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,660][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,660][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,661][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,661][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,661][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,662][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,662][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,662][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,662][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,662][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,662][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,663][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,663][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,663][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,663][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,663][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,663][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,664][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,664][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,664][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,664][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,664][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,664][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,665][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,665][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,665][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,666][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,666][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,666][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,667][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,667][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,667][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,669][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,669][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,669][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,670][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,671][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,671][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,671][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,671][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,671][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,672][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,672][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,672][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,673][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:44:20,673][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:44:20,673][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:44:20,676][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,681][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,681][root][INFO] - Saved parsed outputs
[2025-03-06 11:44:20,681][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,682][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,682][root][INFO] - Saved parsing metadata
[2025-03-06 11:44:20,683][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,684][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:44:20,696][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:44:20,720][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 11:44:20,720][root][INFO] - Summary of metrics : {'label_accuracy': 0.43434343434343436, 'misclassification_rate': 0.5656565656565656, 'combined_accuracy': 0.0, 'malformed_label': 17, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 43, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 43, 'both_wrong': 56}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 11:44:27,663][root][INFO] - Setting global seed to 206
[2025-03-06 11:44:27,668][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:44:27,668][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:44:27,670][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:44:27,671][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:44:27,674][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:44:27,674][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:44:27,846][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:44:28,405][root][INFO] - Full model selected, loading model
[2025-03-06 11:44:52,230][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:46:52,213][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:46:52,213][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:47:27,252][root][INFO] - Peft model loaded successfully
[2025-03-06 11:47:34,891][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:47:34,893][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:47:34,893][root][INFO] - Starting inference
[2025-03-06 11:47:35,121][root][INFO] - Processing question number 0
[2025-03-06 11:47:35,123][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:47:44,417][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:47:56,679][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:48:11,992][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:48:29,593][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:48:43,999][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:48:55,561][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:49:09,390][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:49:25,651][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:49:35,456][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:49:49,779][root][INFO] - Processing question number 10
[2025-03-06 11:49:49,781][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:50:01,833][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:50:15,215][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:50:27,693][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:50:43,205][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:50:55,710][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:51:07,935][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:51:19,413][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:51:30,141][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:51:43,189][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:51:56,272][root][INFO] - Processing question number 20
[2025-03-06 11:51:56,274][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:52:08,445][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:52:21,272][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:52:33,140][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:52:47,245][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:52:59,286][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:53:12,600][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:53:26,505][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:53:40,159][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:53:53,163][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:54:03,347][root][INFO] - Processing question number 30
[2025-03-06 11:54:03,350][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:54:19,833][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:54:30,788][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:54:43,724][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:54:58,782][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:55:08,935][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:55:21,131][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:55:31,587][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:55:44,404][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:56:04,889][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:56:22,340][root][INFO] - Processing question number 40
[2025-03-06 11:56:22,343][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:56:40,010][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:56:53,264][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:57:07,813][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:57:20,687][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:57:34,783][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:57:46,245][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:58:00,744][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:58:12,473][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:58:19,837][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:58:30,070][root][INFO] - Processing question number 50
[2025-03-06 11:58:30,073][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:58:42,390][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:58:57,137][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:59:06,308][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:59:19,397][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:59:28,649][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:59:42,997][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:59:56,500][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:00:08,083][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:00:21,568][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:00:32,662][root][INFO] - Processing question number 60
[2025-03-06 12:00:32,665][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:00:43,382][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:00:55,879][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:01:11,206][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:01:21,883][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:01:35,747][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:01:51,595][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:02:02,702][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:02:17,973][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:02:29,799][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:02:45,589][root][INFO] - Processing question number 70
[2025-03-06 12:02:45,593][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:02:59,312][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:03:11,575][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:03:23,273][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:03:39,634][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:03:54,060][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:04:05,287][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:04:19,120][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:04:33,617][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:04:45,139][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:04:58,266][root][INFO] - Processing question number 80
[2025-03-06 12:04:58,271][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:05:10,842][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:05:27,345][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:05:38,456][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:05:53,924][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:06:06,317][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:06:22,921][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:06:35,295][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:06:46,848][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:06:59,852][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:07:11,430][root][INFO] - Processing question number 90
[2025-03-06 12:07:11,434][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:07:26,095][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:07:39,205][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:07:50,823][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:08:02,834][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:08:16,889][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:08:27,596][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:08:37,096][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:08:51,599][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:09:06,737][root][INFO] - Inference complete
[2025-03-06 12:09:06,738][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,743][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,746][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:09:06,746][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:09:06,747][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:09:06,753][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:09:06,753][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:09:06,753][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:09:06,758][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,762][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,763][root][INFO] - Saved parsed outputs
[2025-03-06 12:09:06,763][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,764][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,764][root][INFO] - Saved parsing metadata
[2025-03-06 12:09:06,765][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,766][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:06,768][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:09:06,810][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 12:09:06,810][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 24, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 12:09:23,752][root][INFO] - Setting global seed to 206
[2025-03-06 12:09:23,810][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:09:23,810][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:09:23,812][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:09:23,898][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:09:23,902][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:09:23,902][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:09:24,051][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:09:24,617][root][INFO] - Full model selected, loading model
[2025-03-06 12:09:48,872][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:09:48,888][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:09:57,744][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:09:57,746][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:09:57,746][root][INFO] - Starting inference
[2025-03-06 12:09:57,951][root][INFO] - Processing question number 0
[2025-03-06 12:09:57,953][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:10:10,226][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:10:18,385][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:10:34,028][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:10:46,363][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:10:59,026][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:11:10,356][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:11:21,442][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:11:35,399][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:11:49,040][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:11:59,998][root][INFO] - Processing question number 10
[2025-03-06 12:12:00,000][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:12:11,059][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:12:19,807][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:12:31,812][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:12:42,030][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:13:00,259][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:13:10,260][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:13:23,976][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:13:34,366][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:13:43,844][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:13:51,163][root][INFO] - Processing question number 20
[2025-03-06 12:13:51,165][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:13:59,880][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:14:11,849][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:14:25,260][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:14:34,253][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:14:45,204][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:14:56,769][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:15:06,263][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:15:22,045][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:15:30,682][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:15:41,929][root][INFO] - Processing question number 30
[2025-03-06 12:15:41,931][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:15:52,872][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:16:03,599][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:16:17,669][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:16:29,420][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:16:38,041][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:16:50,716][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:16:59,587][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:17:10,751][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:17:21,771][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:17:34,061][root][INFO] - Processing question number 40
[2025-03-06 12:17:34,064][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:17:48,091][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:17:57,010][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:18:10,121][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:18:21,244][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:18:29,689][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:18:36,998][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:18:50,000][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:19:00,074][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:19:13,983][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:19:26,108][root][INFO] - Processing question number 50
[2025-03-06 12:19:26,111][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:19:38,564][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:19:55,084][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:20:04,610][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:20:17,300][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:20:29,985][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:20:41,465][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:20:50,259][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:20:58,567][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:21:10,626][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:21:19,514][root][INFO] - Processing question number 60
[2025-03-06 12:21:19,517][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:21:28,756][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:21:41,532][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:21:51,868][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:22:01,942][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:22:11,101][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:22:21,556][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:22:32,191][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:22:41,546][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:22:51,347][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:23:04,834][root][INFO] - Processing question number 70
[2025-03-06 12:23:04,838][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:23:17,152][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:23:27,728][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:23:38,816][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:23:50,406][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:24:01,331][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:24:10,797][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:24:23,341][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:24:33,166][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:24:42,048][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:24:53,202][root][INFO] - Processing question number 80
[2025-03-06 12:24:53,206][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:25:05,394][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:25:16,461][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:25:27,149][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:25:36,051][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:25:46,646][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:25:59,027][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:26:09,280][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:26:23,751][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:26:34,585][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:26:43,251][root][INFO] - Processing question number 90
[2025-03-06 12:26:43,256][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:26:54,542][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:27:03,379][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:27:12,605][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:27:21,991][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:27:35,473][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:27:45,765][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:27:52,822][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:28:05,004][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:28:13,543][root][INFO] - Inference complete
[2025-03-06 12:28:13,543][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,548][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,550][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,551][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,551][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,552][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,552][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,552][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,552][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,552][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,553][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,553][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,553][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,553][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,554][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,554][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,555][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,555][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,555][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,555][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,555][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,555][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,556][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,556][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,556][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,556][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,557][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,557][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,557][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,558][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,558][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,558][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,559][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,559][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,559][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,559][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,559][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,559][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,560][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,560][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,560][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,561][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,561][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,561][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,561][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,562][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,562][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,562][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,562][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,562][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,563][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,563][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,563][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,564][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,564][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,565][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,565][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,565][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,565][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,565][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,565][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,565][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,566][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,566][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,566][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,566][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,567][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,567][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,567][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:28:13,567][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:28:13,567][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:28:13,570][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,574][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,574][root][INFO] - Saved parsed outputs
[2025-03-06 12:28:13,575][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,576][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,576][root][INFO] - Saved parsing metadata
[2025-03-06 12:28:13,576][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,578][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:28:13,579][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:28:13,602][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 12:28:13,602][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.0, 'malformed_label': 23, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 40, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 12:28:20,405][root][INFO] - Setting global seed to 989
[2025-03-06 12:28:20,410][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:28:20,411][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:28:20,412][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:28:20,414][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:28:20,417][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:28:20,417][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:28:20,579][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:28:21,176][root][INFO] - Full model selected, loading model
[2025-03-06 12:28:44,179][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:30:42,125][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:30:42,125][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:31:16,839][root][INFO] - Peft model loaded successfully
[2025-03-06 12:31:24,647][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:31:24,649][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:31:24,649][root][INFO] - Starting inference
[2025-03-06 12:31:24,855][root][INFO] - Processing question number 0
[2025-03-06 12:31:24,857][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:31:34,810][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:31:47,513][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:32:03,136][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:32:19,039][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:32:31,345][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:32:43,955][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:32:57,354][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:33:10,868][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:33:22,970][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:33:32,945][root][INFO] - Processing question number 10
[2025-03-06 12:33:32,946][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:33:48,287][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:34:00,427][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:34:11,202][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:34:25,269][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:34:37,456][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:34:51,266][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:35:01,305][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:35:11,001][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:35:22,464][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:35:35,185][root][INFO] - Processing question number 20
[2025-03-06 12:35:35,187][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:35:46,669][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:36:01,808][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:36:15,688][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:36:27,652][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:36:39,481][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:36:52,424][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:37:04,382][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:37:15,752][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:37:27,646][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:37:38,629][root][INFO] - Processing question number 30
[2025-03-06 12:37:38,632][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:37:51,703][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:38:05,607][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:38:19,150][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:38:30,146][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:38:40,289][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:38:54,632][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:39:05,904][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:39:19,122][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:39:37,008][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:39:51,175][root][INFO] - Processing question number 40
[2025-03-06 12:39:51,179][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:40:05,479][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:40:17,792][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:40:32,950][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:40:45,400][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:41:01,186][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:41:12,724][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:41:26,839][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:41:38,767][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:41:48,386][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:41:57,857][root][INFO] - Processing question number 50
[2025-03-06 12:41:57,860][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:42:10,146][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:42:24,226][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:42:33,252][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:42:47,265][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:42:56,993][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:43:08,450][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:43:23,061][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:43:33,519][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:43:45,568][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:43:56,637][root][INFO] - Processing question number 60
[2025-03-06 12:43:56,640][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:44:11,046][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:44:23,181][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:44:35,177][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:44:43,318][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:44:54,849][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:45:07,017][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:45:18,385][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:45:32,089][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:45:45,102][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:45:59,545][root][INFO] - Processing question number 70
[2025-03-06 12:45:59,548][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:46:12,193][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:46:28,448][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:46:39,834][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:46:53,844][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:47:06,012][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:47:20,650][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:47:37,714][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:47:50,605][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:48:04,362][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:48:16,841][root][INFO] - Processing question number 80
[2025-03-06 12:48:16,845][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:48:33,263][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:48:49,074][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:49:01,269][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:49:16,197][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:49:29,445][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:49:43,111][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:49:54,885][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:50:09,021][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:50:24,003][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:50:34,591][root][INFO] - Processing question number 90
[2025-03-06 12:50:34,596][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:50:47,906][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:50:59,239][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:51:14,666][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:51:26,874][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:51:40,406][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:51:50,763][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:52:00,447][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:52:13,904][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:52:25,906][root][INFO] - Inference complete
[2025-03-06 12:52:25,906][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,911][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,924][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,929][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,929][root][INFO] - Saved parsed outputs
[2025-03-06 12:52:25,929][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,930][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,930][root][INFO] - Saved parsing metadata
[2025-03-06 12:52:25,931][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,933][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:52:25,934][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:52:25,953][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 12:52:25,953][root][INFO] - Summary of metrics : {'label_accuracy': 0.42424242424242425, 'misclassification_rate': 0.5757575757575757, 'combined_accuracy': 0.0, 'malformed_label': 27, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 57}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 12:52:34,948][root][INFO] - Setting global seed to 989
[2025-03-06 12:52:34,955][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:52:34,955][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:52:34,957][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:52:34,959][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:52:34,961][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:52:34,961][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:52:35,112][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:52:35,703][root][INFO] - Full model selected, loading model
[2025-03-06 12:53:00,824][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:53:00,825][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:53:09,067][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:53:09,069][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:53:09,069][root][INFO] - Starting inference
[2025-03-06 12:53:09,282][root][INFO] - Processing question number 0
[2025-03-06 12:53:09,284][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:53:18,140][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:53:28,893][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:53:43,708][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:53:57,345][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:54:06,903][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:54:22,606][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:54:30,938][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:54:47,305][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:54:59,032][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:55:08,948][root][INFO] - Processing question number 10
[2025-03-06 12:55:08,950][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:55:22,095][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:55:30,572][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:55:41,949][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:55:54,697][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:56:08,540][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:56:19,170][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:56:30,113][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:56:37,913][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:56:44,093][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:56:51,974][root][INFO] - Processing question number 20
[2025-03-06 12:56:51,976][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:57:01,653][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:57:12,797][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:57:24,217][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:57:34,209][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:57:45,984][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:57:56,087][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:58:05,767][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:58:16,717][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:58:23,895][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:58:34,975][root][INFO] - Processing question number 30
[2025-03-06 12:58:34,977][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:58:49,451][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:59:00,819][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:59:12,585][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:59:22,457][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:59:34,582][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:59:44,875][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:59:54,109][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:00:11,593][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:00:25,673][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:00:35,754][root][INFO] - Processing question number 40
[2025-03-06 13:00:35,764][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:00:45,430][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:00:55,921][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:01:12,130][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:01:23,978][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:01:35,360][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:01:42,546][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:01:51,791][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:02:02,524][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:02:11,308][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:02:21,900][root][INFO] - Processing question number 50
[2025-03-06 13:02:21,906][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:02:32,238][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:02:43,031][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:02:50,774][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:03:00,196][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:03:10,188][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:03:21,176][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:03:34,542][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:03:45,042][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:04:00,574][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:04:08,668][root][INFO] - Processing question number 60
[2025-03-06 13:04:08,672][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:04:19,821][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:04:29,772][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:04:42,153][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:04:50,976][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:04:59,443][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:05:11,704][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:05:20,559][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:05:29,722][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:05:39,698][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:05:54,276][root][INFO] - Processing question number 70
[2025-03-06 13:05:54,280][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:06:04,648][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:06:19,253][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:06:30,499][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:06:42,398][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:06:54,805][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:07:04,398][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:07:20,296][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:07:31,188][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:07:43,301][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:07:51,711][root][INFO] - Processing question number 80
[2025-03-06 13:07:51,714][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:08:02,378][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:08:15,631][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:08:24,013][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:08:33,321][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:08:43,582][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:08:53,826][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:09:02,999][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:09:13,228][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:09:22,884][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:09:33,786][root][INFO] - Processing question number 90
[2025-03-06 13:09:33,790][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:09:47,066][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:09:57,617][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:10:11,772][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:10:22,102][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:10:29,833][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:10:38,599][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:10:47,360][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:11:04,372][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:11:14,651][root][INFO] - Inference complete
[2025-03-06 13:11:14,651][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,656][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,659][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,659][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,660][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,660][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,661][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,661][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,661][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,662][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,662][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,662][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,662][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,662][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,663][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,663][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,663][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,663][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,664][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,664][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,664][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,664][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,664][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,665][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,665][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,665][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,666][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,666][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,666][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,666][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,667][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,667][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,667][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,667][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,667][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,668][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,669][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,669][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,670][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,670][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,671][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,671][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,671][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,671][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,671][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,671][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,672][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,673][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:11:14,673][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:11:14,673][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:11:14,675][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,680][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,680][root][INFO] - Saved parsed outputs
[2025-03-06 13:11:14,680][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,681][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,681][root][INFO] - Saved parsing metadata
[2025-03-06 13:11:14,682][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,683][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:11:14,684][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:11:14,710][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 13:11:14,710][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.0, 'malformed_label': 18, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 13:11:22,307][root][INFO] - Setting global seed to 989
[2025-03-06 13:11:22,315][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:11:22,315][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:11:22,316][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:11:22,318][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:11:22,321][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:11:22,321][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:11:22,474][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:11:23,079][root][INFO] - Full model selected, loading model
[2025-03-06 13:11:46,960][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:13:44,411][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:13:44,412][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:14:21,637][root][INFO] - Peft model loaded successfully
[2025-03-06 13:14:29,235][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:14:29,237][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:14:29,237][root][INFO] - Starting inference
[2025-03-06 13:14:29,479][root][INFO] - Processing question number 0
[2025-03-06 13:14:29,481][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:14:38,219][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:14:51,379][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:15:14,058][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:15:31,667][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:15:44,663][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:15:58,109][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:16:13,533][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:16:29,040][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:16:43,764][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:16:53,839][root][INFO] - Processing question number 10
[2025-03-06 13:16:53,841][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:17:09,191][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:17:20,947][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:17:33,715][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:17:48,799][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:18:01,307][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:18:15,176][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:18:25,321][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:18:37,513][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:18:51,470][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:19:01,890][root][INFO] - Processing question number 20
[2025-03-06 13:19:01,892][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:19:13,128][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:19:27,548][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:19:41,666][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:19:54,012][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:20:06,294][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:20:24,228][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:20:36,932][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:20:49,366][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:21:03,845][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:21:17,140][root][INFO] - Processing question number 30
[2025-03-06 13:21:17,143][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:21:30,589][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:21:44,934][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:21:56,825][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:22:09,104][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:22:19,214][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:22:31,700][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:22:43,326][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:22:57,294][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:23:12,110][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:23:24,872][root][INFO] - Processing question number 40
[2025-03-06 13:23:24,875][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:23:38,513][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:23:51,529][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:24:06,032][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:24:17,813][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:24:31,535][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:24:43,326][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:24:57,822][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:25:11,031][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:25:21,028][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:25:31,203][root][INFO] - Processing question number 50
[2025-03-06 13:25:31,206][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:25:43,470][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:25:56,172][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:26:06,766][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:26:19,699][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:26:29,184][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:26:40,843][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:26:54,634][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:27:05,708][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:27:18,951][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:27:30,334][root][INFO] - Processing question number 60
[2025-03-06 13:27:30,338][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:27:42,589][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:27:54,707][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:28:08,304][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:28:17,129][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:28:28,966][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:28:43,480][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:28:54,825][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:29:11,681][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:29:24,873][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:29:38,923][root][INFO] - Processing question number 70
[2025-03-06 13:29:38,926][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:29:49,411][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:30:02,807][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:30:14,790][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:30:27,603][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:30:42,134][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:30:56,872][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:31:14,564][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:31:25,235][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:31:39,424][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:31:51,939][root][INFO] - Processing question number 80
[2025-03-06 13:31:51,943][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:32:07,233][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:32:22,198][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:32:34,671][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:32:49,236][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:33:02,303][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:33:17,268][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:33:29,311][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:33:38,675][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:33:52,106][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:34:02,933][root][INFO] - Processing question number 90
[2025-03-06 13:34:02,937][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:34:17,646][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:34:30,299][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:34:42,723][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:34:57,103][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:35:09,634][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:35:19,877][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:35:29,563][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:35:45,355][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:35:59,793][root][INFO] - Inference complete
[2025-03-06 13:35:59,793][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,799][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,812][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,817][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,817][root][INFO] - Saved parsed outputs
[2025-03-06 13:35:59,817][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,818][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,818][root][INFO] - Saved parsing metadata
[2025-03-06 13:35:59,819][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,821][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:35:59,822][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:35:59,891][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 13:35:59,891][root][INFO] - Summary of metrics : {'label_accuracy': 0.3838383838383838, 'misclassification_rate': 0.6161616161616161, 'combined_accuracy': 0.0, 'malformed_label': 26, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 38, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 38, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 13:36:08,425][root][INFO] - Setting global seed to 989
[2025-03-06 13:36:08,432][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:36:08,432][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:36:08,434][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:36:08,435][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:36:08,438][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:36:08,439][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:36:08,590][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:36:09,157][root][INFO] - Full model selected, loading model
[2025-03-06 13:36:34,661][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:36:34,676][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:36:42,908][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:36:42,910][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:36:42,910][root][INFO] - Starting inference
[2025-03-06 13:36:43,116][root][INFO] - Processing question number 0
[2025-03-06 13:36:43,118][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:36:53,571][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:37:04,141][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:37:18,720][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:37:32,495][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:37:42,927][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:37:53,470][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:38:01,676][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:38:13,073][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:38:21,863][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:38:31,515][root][INFO] - Processing question number 10
[2025-03-06 13:38:31,517][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:38:42,104][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:38:51,557][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:39:00,303][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:39:11,954][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:39:23,859][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:39:36,053][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:39:45,279][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:39:56,201][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:40:04,394][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:40:12,371][root][INFO] - Processing question number 20
[2025-03-06 13:40:12,373][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:40:23,471][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:40:37,062][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:40:47,510][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:40:56,194][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:41:07,442][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:41:18,173][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:41:28,008][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:41:39,598][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:41:47,320][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:41:55,529][root][INFO] - Processing question number 30
[2025-03-06 13:41:55,532][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:42:10,176][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:42:21,052][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:42:34,131][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:42:44,624][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:42:54,133][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:43:06,296][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:43:15,402][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:43:28,136][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:43:39,489][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:43:49,586][root][INFO] - Processing question number 40
[2025-03-06 13:43:49,588][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:44:00,493][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:44:12,052][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:44:25,265][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:44:36,962][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:44:46,754][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:44:57,419][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:45:07,674][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:45:20,936][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:45:30,774][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:45:38,653][root][INFO] - Processing question number 50
[2025-03-06 13:45:38,656][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:45:51,331][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:46:04,845][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:46:13,901][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:46:24,114][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:46:38,131][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:46:47,813][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:47:03,871][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:47:14,133][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:47:32,436][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:47:41,641][root][INFO] - Processing question number 60
[2025-03-06 13:47:41,645][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:47:50,890][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:48:00,539][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:48:15,402][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:48:24,284][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:48:35,372][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:48:47,669][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:48:57,846][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:49:12,548][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:49:22,071][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:49:34,089][root][INFO] - Processing question number 70
[2025-03-06 13:49:34,092][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:49:46,121][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:50:03,501][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:50:16,515][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:50:25,284][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:50:36,775][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:50:46,662][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:50:58,833][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:51:11,589][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:51:22,789][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:51:33,762][root][INFO] - Processing question number 80
[2025-03-06 13:51:33,766][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:51:44,117][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:51:57,318][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:52:08,383][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:52:20,414][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:52:31,161][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:52:43,077][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:52:53,288][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:53:05,924][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:53:16,809][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:53:27,928][root][INFO] - Processing question number 90
[2025-03-06 13:53:27,932][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:53:41,540][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:53:51,663][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:54:06,261][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:54:16,258][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:54:27,526][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:54:34,929][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:54:42,815][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:54:59,819][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:55:09,367][root][INFO] - Inference complete
[2025-03-06 13:55:09,367][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,372][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,374][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,375][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,375][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,376][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,376][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,376][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,377][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,377][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,377][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,377][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,377][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,378][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,378][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,378][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,378][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,379][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,379][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,379][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,379][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,379][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,379][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,380][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,380][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,380][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,380][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,380][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,381][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,381][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,381][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,381][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,382][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,383][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,383][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,383][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,383][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,383][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,383][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,383][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,384][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,384][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,384][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,384][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,387][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,387][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,387][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,388][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:55:09,388][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:55:09,388][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:55:09,391][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,396][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,396][root][INFO] - Saved parsed outputs
[2025-03-06 13:55:09,396][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,397][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,397][root][INFO] - Saved parsing metadata
[2025-03-06 13:55:09,398][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,399][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:55:09,400][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:55:09,437][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 13:55:09,437][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.0, 'malformed_label': 18, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 13:55:16,277][root][INFO] - Setting global seed to 989
[2025-03-06 13:55:16,282][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:55:16,282][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:55:16,284][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:55:16,285][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:55:16,288][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:55:16,288][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:55:16,459][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:55:17,445][root][INFO] - Full model selected, loading model
[2025-03-06 13:55:40,591][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:57:36,786][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:57:36,798][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:58:13,082][root][INFO] - Peft model loaded successfully
[2025-03-06 13:58:20,634][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:58:20,637][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:58:20,637][root][INFO] - Starting inference
[2025-03-06 13:58:20,859][root][INFO] - Processing question number 0
[2025-03-06 13:58:20,862][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:58:31,601][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:58:44,338][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:59:00,368][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:59:13,412][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:59:27,350][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:59:42,352][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:59:58,254][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:00:15,421][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:00:26,009][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:00:37,676][root][INFO] - Processing question number 10
[2025-03-06 14:00:37,678][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:00:51,589][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:01:03,146][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:01:15,952][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:01:28,911][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:01:42,404][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:01:56,540][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:02:07,778][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:02:18,545][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:02:30,271][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:02:41,612][root][INFO] - Processing question number 20
[2025-03-06 14:02:41,614][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:02:53,500][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:03:06,125][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:03:18,590][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:03:28,969][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:03:42,468][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:03:58,950][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:04:14,643][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:04:27,214][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:04:42,149][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:04:55,435][root][INFO] - Processing question number 30
[2025-03-06 14:04:55,437][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:05:10,958][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:05:21,722][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:05:34,126][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:05:48,568][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:06:00,686][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:06:12,930][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:06:30,716][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:06:45,006][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:07:01,577][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:07:17,622][root][INFO] - Processing question number 40
[2025-03-06 14:07:17,624][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:07:33,648][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:07:48,463][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:08:03,297][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:08:16,973][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:08:33,673][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:08:45,134][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:08:58,039][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:09:08,477][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:09:16,898][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:09:28,118][root][INFO] - Processing question number 50
[2025-03-06 14:09:28,121][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:09:41,591][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:09:54,954][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:10:03,842][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:10:16,684][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:10:27,677][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:10:40,591][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:10:56,747][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:11:08,184][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:11:26,478][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:11:37,762][root][INFO] - Processing question number 60
[2025-03-06 14:11:37,765][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:11:51,428][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:12:02,475][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:12:19,151][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:12:28,126][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:12:39,023][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:12:52,928][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:13:03,708][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:13:18,314][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:13:30,425][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:13:47,851][root][INFO] - Processing question number 70
[2025-03-06 14:13:47,854][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:13:59,981][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:14:13,512][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:14:25,727][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:14:39,590][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:14:53,544][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:15:04,913][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:15:24,364][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:15:38,526][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:15:52,721][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:16:04,910][root][INFO] - Processing question number 80
[2025-03-06 14:16:04,914][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:16:18,670][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:16:29,885][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:16:43,153][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:16:57,863][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:17:10,681][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:17:24,011][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:17:36,765][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:17:50,435][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:18:03,680][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:18:14,056][root][INFO] - Processing question number 90
[2025-03-06 14:18:14,060][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:18:26,898][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:18:39,773][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:18:54,034][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:19:03,375][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:19:15,758][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:19:25,915][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:19:36,856][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:19:51,409][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:20:04,797][root][INFO] - Inference complete
[2025-03-06 14:20:04,797][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,803][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,804][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:20:04,804][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:20:04,805][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:20:04,817][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,822][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,822][root][INFO] - Saved parsed outputs
[2025-03-06 14:20:04,822][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,823][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,823][root][INFO] - Saved parsing metadata
[2025-03-06 14:20:04,824][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,826][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:04,827][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:20:04,860][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 14:20:04,861][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.0, 'malformed_label': 24, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 14:20:19,478][root][INFO] - Setting global seed to 989
[2025-03-06 14:20:19,566][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:20:19,566][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:20:19,568][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:20:19,588][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:20:19,591][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:20:19,591][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:20:19,778][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:20:20,348][root][INFO] - Full model selected, loading model
[2025-03-06 14:20:48,383][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:20:48,401][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:20:57,375][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:20:57,376][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:20:57,376][root][INFO] - Starting inference
[2025-03-06 14:20:57,556][root][INFO] - Processing question number 0
[2025-03-06 14:20:57,558][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:21:09,445][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:21:21,696][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:21:37,826][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:21:47,695][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:22:00,171][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:22:09,207][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:22:23,121][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:22:37,133][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:22:46,553][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:22:58,068][root][INFO] - Processing question number 10
[2025-03-06 14:22:58,069][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:23:09,064][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:23:22,898][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:23:31,811][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:23:44,475][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:23:59,638][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:24:10,316][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:24:20,206][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:24:30,820][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:24:39,635][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:24:52,042][root][INFO] - Processing question number 20
[2025-03-06 14:24:52,044][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:25:01,721][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:25:12,683][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:25:21,167][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:25:28,544][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:25:40,134][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:25:51,402][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:26:00,032][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:26:10,278][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:26:18,674][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:26:28,053][root][INFO] - Processing question number 30
[2025-03-06 14:26:28,056][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:26:40,336][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:26:50,952][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:27:03,246][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:27:14,093][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:27:21,506][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:27:32,453][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:27:46,879][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:27:56,707][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:28:08,739][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:28:17,920][root][INFO] - Processing question number 40
[2025-03-06 14:28:17,922][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:28:29,794][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:28:44,920][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:28:54,978][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:29:06,309][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:29:15,703][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:29:25,823][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:29:37,154][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:29:49,178][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:30:02,344][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:30:11,377][root][INFO] - Processing question number 50
[2025-03-06 14:30:11,380][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:30:21,848][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:30:37,088][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:30:45,951][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:30:53,410][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:31:06,965][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:31:17,591][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:31:29,585][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:31:40,133][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:31:55,037][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:32:05,385][root][INFO] - Processing question number 60
[2025-03-06 14:32:05,388][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:32:15,482][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:32:24,643][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:32:39,804][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:32:51,663][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:33:01,366][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:33:12,935][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:33:24,679][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:33:36,694][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:33:46,575][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:34:02,818][root][INFO] - Processing question number 70
[2025-03-06 14:34:02,822][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:34:12,729][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:34:24,223][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:34:38,581][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:34:48,223][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:35:00,539][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:35:15,024][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:35:32,120][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:35:41,697][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:35:51,276][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:36:00,827][root][INFO] - Processing question number 80
[2025-03-06 14:36:00,831][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:36:13,283][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:36:28,803][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:36:40,271][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:36:52,320][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:37:05,269][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:37:19,119][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:37:29,308][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:37:41,827][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:37:53,254][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:38:03,096][root][INFO] - Processing question number 90
[2025-03-06 14:38:03,100][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:38:21,677][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:38:34,212][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:38:46,372][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:38:56,842][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:39:06,755][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:39:17,075][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:39:25,310][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:39:35,215][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:39:46,660][root][INFO] - Inference complete
[2025-03-06 14:39:46,661][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,670][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,672][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,672][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,673][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,674][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,674][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,674][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,675][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,675][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,675][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,676][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,676][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,676][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,676][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,676][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,677][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,677][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,677][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,677][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,678][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,678][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,678][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,678][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,679][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,679][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,679][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,679][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,679][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,680][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,680][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,680][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,680][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,681][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,681][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,681][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,681][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,681][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,682][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,682][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,682][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,683][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,683][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,683][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,683][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,684][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,684][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,684][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,684][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,684][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,685][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,685][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,686][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,686][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,686][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,686][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,686][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,687][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,687][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,687][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,687][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,687][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,687][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,688][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,688][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,688][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,688][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,688][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,690][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:46,690][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:46,690][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:46,691][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,696][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,696][root][INFO] - Saved parsed outputs
[2025-03-06 14:39:46,696][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,697][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,697][root][INFO] - Saved parsing metadata
[2025-03-06 14:39:46,698][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,700][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:39:46,701][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:39:46,726][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 14:39:46,727][root][INFO] - Summary of metrics : {'label_accuracy': 0.37373737373737376, 'misclassification_rate': 0.6262626262626263, 'combined_accuracy': 0.0, 'malformed_label': 26, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 37, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 37, 'both_wrong': 62}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 14:39:53,679][root][INFO] - Setting global seed to 206
[2025-03-06 14:39:53,685][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:39:53,685][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:39:53,686][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:39:53,688][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:39:53,691][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:39:53,691][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:39:53,864][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:39:54,421][root][INFO] - Full model selected, loading model
[2025-03-06 14:40:18,449][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:42:14,238][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:42:14,238][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:42:51,325][root][INFO] - Peft model loaded successfully
[2025-03-06 14:42:58,904][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:42:58,906][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:42:58,906][root][INFO] - Starting inference
[2025-03-06 14:42:59,144][root][INFO] - Processing question number 0
[2025-03-06 14:42:59,146][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:43:14,056][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:43:29,921][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:43:43,877][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:44:02,837][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:44:14,137][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:44:24,479][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:44:38,372][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:44:50,460][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:44:59,719][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:45:10,363][root][INFO] - Processing question number 10
[2025-03-06 14:45:10,365][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:45:19,027][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:45:27,584][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:45:39,635][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:45:49,653][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:46:03,404][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:46:12,928][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:46:26,010][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:46:37,418][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:46:49,464][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:47:02,114][root][INFO] - Processing question number 20
[2025-03-06 14:47:02,117][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:47:11,054][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:47:22,104][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:47:31,422][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:47:42,326][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:47:54,433][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:48:07,856][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:48:20,822][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:48:32,598][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:48:44,205][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:48:56,671][root][INFO] - Processing question number 30
[2025-03-06 14:48:56,674][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:49:06,458][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:49:18,994][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:49:31,358][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:49:45,448][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:49:58,560][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:50:11,447][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:50:24,537][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:50:40,055][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:50:52,856][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:51:05,914][root][INFO] - Processing question number 40
[2025-03-06 14:51:05,916][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:51:17,079][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:51:27,368][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:51:41,679][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:51:49,529][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:52:08,669][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:52:19,368][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:52:28,616][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:52:39,407][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:52:50,948][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:53:02,727][root][INFO] - Processing question number 50
[2025-03-06 14:53:02,730][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:53:13,478][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:53:26,895][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:53:42,663][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:53:59,052][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:54:12,063][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:54:24,256][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:54:42,882][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:54:55,663][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:55:07,629][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:55:17,911][root][INFO] - Processing question number 60
[2025-03-06 14:55:17,914][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:55:30,540][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:55:43,664][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:55:57,731][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:56:10,612][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:56:24,728][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:56:35,858][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:56:53,902][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:57:05,189][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:57:14,411][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:57:25,495][root][INFO] - Processing question number 70
[2025-03-06 14:57:25,499][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:57:39,212][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:57:52,199][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:58:05,708][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:58:20,631][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:58:30,829][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:58:44,814][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:58:59,090][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:59:13,721][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:59:24,746][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:59:36,108][root][INFO] - Processing question number 80
[2025-03-06 14:59:36,112][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:59:50,354][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:00:06,096][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:00:20,364][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:00:31,215][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:00:49,578][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:01:02,163][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:01:14,876][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:01:28,416][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:01:42,819][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:01:56,452][root][INFO] - Processing question number 90
[2025-03-06 15:01:56,456][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:02:10,685][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:02:25,699][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:02:39,336][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:02:49,602][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:03:02,739][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:03:18,023][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:03:32,502][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:03:43,082][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:03:53,307][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:04:06,996][root][INFO] - Inference complete
[2025-03-06 15:04:06,996][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,003][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,014][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:04:07,015][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:04:07,016][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:04:07,017][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,022][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,022][root][INFO] - Saved parsed outputs
[2025-03-06 15:04:07,022][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,023][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,023][root][INFO] - Saved parsing metadata
[2025-03-06 15:04:07,024][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,026][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:07,027][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:04:07,069][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 15:04:07,069][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.0, 'malformed_label': 21, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 15:04:15,546][root][INFO] - Setting global seed to 206
[2025-03-06 15:04:15,553][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:04:15,553][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:04:15,554][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:04:15,556][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:04:15,559][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:04:15,559][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:04:15,709][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:04:16,329][root][INFO] - Full model selected, loading model
[2025-03-06 15:04:44,197][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:04:44,214][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:04:52,532][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:04:52,533][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:04:52,533][root][INFO] - Starting inference
[2025-03-06 15:04:52,728][root][INFO] - Processing question number 0
[2025-03-06 15:04:52,730][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:05:06,506][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:05:16,638][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:05:29,098][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:05:40,904][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:05:49,256][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:05:57,649][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:06:07,896][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:06:18,186][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:06:29,845][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:06:40,276][root][INFO] - Processing question number 10
[2025-03-06 15:06:40,277][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:06:47,313][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:06:56,153][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:07:08,761][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:07:16,481][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:07:29,502][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:07:38,959][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:07:48,725][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:07:58,132][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:08:09,182][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:08:19,713][root][INFO] - Processing question number 20
[2025-03-06 15:08:19,715][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:08:30,817][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:08:43,248][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:08:52,915][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:09:01,546][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:09:10,544][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:09:19,218][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:09:29,544][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:09:37,869][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:09:48,241][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:09:59,418][root][INFO] - Processing question number 30
[2025-03-06 15:09:59,421][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:10:07,158][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:10:17,442][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:10:27,790][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:10:37,603][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:10:49,765][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:11:02,215][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:11:16,360][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:11:28,118][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:11:36,855][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:11:46,525][root][INFO] - Processing question number 40
[2025-03-06 15:11:46,528][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:11:56,413][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:12:06,002][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:12:19,344][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:12:27,267][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:12:45,555][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:12:54,612][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:13:05,496][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:13:17,282][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:13:29,917][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:13:42,429][root][INFO] - Processing question number 50
[2025-03-06 15:13:42,432][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:13:52,559][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:14:03,177][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:14:14,566][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:14:27,564][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:14:36,055][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:14:46,431][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:14:57,509][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:15:10,924][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:15:21,235][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:15:33,783][root][INFO] - Processing question number 60
[2025-03-06 15:15:33,787][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:15:41,616][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:15:52,150][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:16:03,917][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:16:18,710][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:16:27,659][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:16:38,212][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:16:47,342][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:16:57,064][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:17:06,047][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:17:18,559][root][INFO] - Processing question number 70
[2025-03-06 15:17:18,563][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:17:28,809][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:17:37,280][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:17:54,518][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:18:09,234][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:18:18,368][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:18:29,703][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:18:41,380][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:18:55,813][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:19:05,589][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:19:15,314][root][INFO] - Processing question number 80
[2025-03-06 15:19:15,318][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:19:26,629][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:19:36,723][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:19:50,501][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:20:01,056][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:20:13,177][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:20:26,073][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:20:40,889][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:20:50,670][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:21:02,486][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:21:16,667][root][INFO] - Processing question number 90
[2025-03-06 15:21:16,671][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:21:27,231][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:21:38,659][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:21:54,052][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:22:03,187][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:22:14,602][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:22:27,069][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:22:38,523][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:22:50,611][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:23:00,316][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:23:09,367][root][INFO] - Inference complete
[2025-03-06 15:23:09,367][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,373][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,373][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,374][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,375][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,375][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,375][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,375][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,375][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,376][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,376][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,376][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,376][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,376][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,376][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,377][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,377][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,377][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,377][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,377][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,377][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,378][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,378][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,378][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,378][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,378][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,378][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,379][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,379][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,379][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,379][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,379][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,379][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,380][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,380][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,380][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,380][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,380][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,382][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,382][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,382][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,383][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,383][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,383][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,383][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,383][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,383][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,384][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,384][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,384][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,385][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,385][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,385][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,387][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,387][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,387][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,388][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,389][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,389][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,389][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,389][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,389][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,389][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,389][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,390][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,390][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,390][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,390][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,390][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,391][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,391][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,391][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,391][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,391][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,391][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,392][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,392][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,392][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,392][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,392][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,393][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,393][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,393][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,394][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:23:09,394][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:23:09,394][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:23:09,396][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,400][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,400][root][INFO] - Saved parsed outputs
[2025-03-06 15:23:09,400][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,401][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,402][root][INFO] - Saved parsing metadata
[2025-03-06 15:23:09,403][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,404][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:23:09,405][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:23:09,431][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 15:23:09,431][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 29, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 15:23:16,826][root][INFO] - Setting global seed to 206
[2025-03-06 15:23:16,832][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:23:16,833][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:23:16,834][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:23:16,836][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:23:16,839][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:23:16,839][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:23:17,237][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:23:17,830][root][INFO] - Full model selected, loading model
[2025-03-06 15:23:42,511][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:25:39,422][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:25:39,439][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:26:16,382][root][INFO] - Peft model loaded successfully
[2025-03-06 15:26:23,990][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:26:23,992][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:26:23,992][root][INFO] - Starting inference
[2025-03-06 15:26:24,196][root][INFO] - Processing question number 0
[2025-03-06 15:26:24,198][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:26:42,135][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:26:58,546][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:27:16,292][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:27:32,785][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:27:43,798][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:27:54,546][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:28:08,454][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:28:20,027][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:28:30,420][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:28:43,686][root][INFO] - Processing question number 10
[2025-03-06 15:28:43,688][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:28:52,782][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:29:04,573][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:29:18,037][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:29:28,046][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:29:42,964][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:29:53,174][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:30:05,837][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:30:17,149][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:30:30,855][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:30:44,092][root][INFO] - Processing question number 20
[2025-03-06 15:30:44,094][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:30:53,882][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:31:03,372][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:31:13,645][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:31:24,304][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:31:35,895][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:31:45,883][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:32:00,176][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:32:12,328][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:32:26,095][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:32:42,211][root][INFO] - Processing question number 30
[2025-03-06 15:32:42,214][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:32:53,013][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:33:03,029][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:33:14,878][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:33:26,374][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:33:40,067][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:33:51,791][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:34:07,309][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:34:23,487][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:34:37,284][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:34:50,441][root][INFO] - Processing question number 40
[2025-03-06 15:34:50,444][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:35:03,796][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:35:16,795][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:35:29,793][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:35:37,573][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:35:53,901][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:36:04,216][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:36:15,910][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:36:28,288][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:36:39,824][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:36:50,983][root][INFO] - Processing question number 50
[2025-03-06 15:36:50,986][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:37:04,053][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:37:15,747][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:37:32,357][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:37:45,704][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:37:56,765][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:38:07,283][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:38:25,669][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:38:39,524][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:38:51,624][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:39:02,356][root][INFO] - Processing question number 60
[2025-03-06 15:39:02,359][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:39:14,229][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:39:29,588][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:39:43,099][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:39:55,850][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:40:07,856][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:40:19,223][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:40:37,752][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:40:47,940][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:40:56,825][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:41:07,543][root][INFO] - Processing question number 70
[2025-03-06 15:41:07,547][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:41:20,575][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:41:34,954][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:41:47,113][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:42:02,198][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:42:12,393][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:42:26,008][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:42:42,841][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:42:56,022][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:43:07,100][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:43:19,218][root][INFO] - Processing question number 80
[2025-03-06 15:43:19,222][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:43:32,195][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:43:48,554][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:44:04,146][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:44:15,325][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:44:29,147][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:44:42,169][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:44:57,972][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:45:11,627][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:45:25,345][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:45:40,713][root][INFO] - Processing question number 90
[2025-03-06 15:45:40,717][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:45:56,066][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:46:10,673][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:46:27,655][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:46:40,737][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:46:53,163][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:47:06,178][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:47:17,747][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:47:27,668][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:47:37,613][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:47:51,879][root][INFO] - Inference complete
[2025-03-06 15:47:51,879][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,886][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,898][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:47:51,898][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:47:51,899][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:47:51,900][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,905][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,905][root][INFO] - Saved parsed outputs
[2025-03-06 15:47:51,905][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,907][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,907][root][INFO] - Saved parsing metadata
[2025-03-06 15:47:51,907][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,909][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:47:51,910][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:47:51,923][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 15:47:51,923][root][INFO] - Summary of metrics : {'label_accuracy': 0.34, 'misclassification_rate': 0.6599999999999999, 'combined_accuracy': 0.0, 'malformed_label': 26, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 34, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 34, 'both_wrong': 66}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 15:47:58,696][root][INFO] - Setting global seed to 206
[2025-03-06 15:47:58,702][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:47:58,702][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:47:58,703][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:47:58,718][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:47:58,720][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:47:58,720][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:47:59,066][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:47:59,677][root][INFO] - Full model selected, loading model
[2025-03-06 15:48:25,310][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:48:25,327][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:48:33,682][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:48:33,685][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:48:33,685][root][INFO] - Starting inference
[2025-03-06 15:48:33,909][root][INFO] - Processing question number 0
[2025-03-06 15:48:33,912][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:48:46,156][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:48:55,444][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:49:09,531][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:49:19,924][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:49:27,797][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:49:37,032][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:49:47,517][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:49:59,047][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:50:09,776][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:50:19,577][root][INFO] - Processing question number 10
[2025-03-06 15:50:19,579][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:50:26,767][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:50:37,250][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:50:49,456][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:50:59,286][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:51:10,854][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:51:20,229][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:51:27,957][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:51:37,886][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:51:50,995][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:52:00,230][root][INFO] - Processing question number 20
[2025-03-06 15:52:00,233][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:52:09,660][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:52:22,599][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:52:33,439][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:52:40,734][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:52:51,775][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:53:01,480][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:53:09,741][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:53:18,946][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:53:28,923][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:53:40,801][root][INFO] - Processing question number 30
[2025-03-06 15:53:40,805][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:53:51,278][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:54:02,647][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:54:14,177][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:54:24,273][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:54:35,858][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:54:49,336][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:55:01,328][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:55:16,468][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:55:27,118][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:55:39,106][root][INFO] - Processing question number 40
[2025-03-06 15:55:39,109][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:55:48,871][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:55:58,797][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:56:12,856][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:56:20,192][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:56:35,761][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:56:46,789][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:56:57,273][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:57:07,357][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:57:21,224][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:57:32,735][root][INFO] - Processing question number 50
[2025-03-06 15:57:32,738][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:57:42,552][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:57:53,522][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:58:09,980][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:58:20,462][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:58:28,958][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:58:39,488][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:58:56,684][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:59:07,309][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:59:15,751][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:59:29,284][root][INFO] - Processing question number 60
[2025-03-06 15:59:29,288][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:59:39,901][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:59:50,452][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:00:00,188][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:00:13,518][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:00:23,597][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:00:35,912][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:00:44,178][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:01:01,738][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:01:09,109][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:01:19,510][root][INFO] - Processing question number 70
[2025-03-06 16:01:19,514][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:01:32,693][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:01:43,312][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:01:57,444][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:02:09,658][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:02:18,571][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:02:27,934][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:02:39,337][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:02:50,391][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:03:00,367][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:03:10,757][root][INFO] - Processing question number 80
[2025-03-06 16:03:10,761][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:03:22,567][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:03:31,064][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:03:48,028][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:03:57,428][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:04:09,041][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:04:21,508][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:04:34,744][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:04:43,298][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:04:55,899][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:05:07,780][root][INFO] - Processing question number 90
[2025-03-06 16:05:07,793][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:05:19,367][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:05:30,443][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:05:43,027][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:05:51,051][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:06:03,538][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:06:15,988][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:06:28,942][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:06:40,464][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:06:49,733][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:06:58,742][root][INFO] - Inference complete
[2025-03-06 16:06:58,743][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,749][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,750][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,750][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,751][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,751][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,751][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,752][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,752][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,752][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,752][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,752][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,753][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,753][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,753][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,753][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,753][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,753][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,754][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,754][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,754][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,754][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,754][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,754][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,755][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,755][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,755][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,755][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,755][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,756][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,756][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,756][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,756][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,757][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,757][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,758][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,758][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,758][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,759][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,759][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,759][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,760][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,760][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,760][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,760][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,760][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,760][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,761][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,761][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,761][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,761][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,761][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,762][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,762][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,763][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,763][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,765][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,765][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,765][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,766][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,766][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,766][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,766][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,766][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,767][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,767][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,767][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,767][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,767][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,767][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,767][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,768][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,768][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,768][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,768][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,769][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,769][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,769][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,769][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,769][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,769][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,770][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,770][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,770][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:06:58,770][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:06:58,770][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:06:58,773][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,777][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,777][root][INFO] - Saved parsed outputs
[2025-03-06 16:06:58,778][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,779][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,779][root][INFO] - Saved parsing metadata
[2025-03-06 16:06:58,780][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,781][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:06:58,782][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:06:58,810][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 16:06:58,810][root][INFO] - Summary of metrics : {'label_accuracy': 0.41, 'misclassification_rate': 0.5900000000000001, 'combined_accuracy': 0.0, 'malformed_label': 28, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 16:07:07,253][root][INFO] - Setting global seed to 206
[2025-03-06 16:07:07,260][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:07:07,261][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:07:07,262][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:07:07,297][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:07:07,300][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:07:07,300][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:07:07,455][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:07:08,025][root][INFO] - Full model selected, loading model
[2025-03-06 16:07:28,980][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:09:26,180][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:09:26,181][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:10:04,917][root][INFO] - Peft model loaded successfully
[2025-03-06 16:10:12,567][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:10:12,569][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:10:12,569][root][INFO] - Starting inference
[2025-03-06 16:10:12,761][root][INFO] - Processing question number 0
[2025-03-06 16:10:12,763][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:10:27,674][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:10:40,576][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:10:54,256][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:11:11,127][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:11:21,580][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:11:32,419][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:11:49,208][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:11:59,551][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:12:10,310][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:12:21,177][root][INFO] - Processing question number 10
[2025-03-06 16:12:21,179][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:12:30,452][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:12:40,137][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:12:54,924][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:13:04,795][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:13:20,713][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:13:30,503][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:13:43,737][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:13:55,940][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:14:06,855][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:14:19,569][root][INFO] - Processing question number 20
[2025-03-06 16:14:19,571][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:14:28,348][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:14:40,193][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:14:52,094][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:15:01,919][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:15:15,913][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:15:27,551][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:15:39,112][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:15:50,933][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:16:05,270][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:16:20,711][root][INFO] - Processing question number 30
[2025-03-06 16:16:20,716][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:16:29,737][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:16:42,002][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:16:53,854][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:17:05,590][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:17:17,961][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:17:33,991][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:17:50,644][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:18:04,897][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:18:17,705][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:18:38,409][root][INFO] - Processing question number 40
[2025-03-06 16:18:38,412][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:18:52,393][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:19:02,496][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:19:17,544][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:19:25,553][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:19:46,812][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:19:56,753][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:20:08,960][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:20:20,366][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:20:32,330][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:20:45,399][root][INFO] - Processing question number 50
[2025-03-06 16:20:45,403][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:20:56,347][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:21:09,421][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:21:26,140][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:21:39,497][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:21:54,524][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:22:07,127][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:22:21,204][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:22:37,952][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:22:48,691][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:23:03,258][root][INFO] - Processing question number 60
[2025-03-06 16:23:03,262][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:23:15,272][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:23:27,278][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:23:42,518][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:23:59,333][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:24:12,288][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:24:25,017][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:24:36,853][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:24:47,229][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:24:57,226][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:25:08,176][root][INFO] - Processing question number 70
[2025-03-06 16:25:08,180][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:25:23,396][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:25:38,825][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:25:51,267][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:26:05,831][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:26:16,350][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:26:30,492][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:26:46,337][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:26:58,754][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:27:09,596][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:27:19,747][root][INFO] - Processing question number 80
[2025-03-06 16:27:19,751][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:27:35,550][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:27:50,795][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:28:06,671][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:28:20,728][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:28:34,113][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:28:47,756][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:28:59,682][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:29:13,769][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:29:28,010][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:29:39,123][root][INFO] - Processing question number 90
[2025-03-06 16:29:39,127][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:29:50,168][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:30:06,714][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:30:20,953][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:30:32,103][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:30:45,348][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:30:57,980][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:31:09,635][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:31:19,974][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:31:29,274][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:31:40,922][root][INFO] - Inference complete
[2025-03-06 16:31:40,922][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,930][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,942][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:31:40,942][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:31:40,943][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:31:40,944][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,949][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,949][root][INFO] - Saved parsed outputs
[2025-03-06 16:31:40,949][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,951][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,951][root][INFO] - Saved parsing metadata
[2025-03-06 16:31:40,952][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,953][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:31:40,955][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:31:40,986][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 16:31:40,986][root][INFO] - Summary of metrics : {'label_accuracy': 0.34, 'misclassification_rate': 0.6599999999999999, 'combined_accuracy': 0.0, 'malformed_label': 17, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 34, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 34, 'both_wrong': 66}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 16:31:47,918][root][INFO] - Setting global seed to 206
[2025-03-06 16:31:47,924][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:31:47,924][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:31:47,925][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:31:47,927][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:31:47,930][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:31:47,930][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:31:48,105][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:31:48,714][root][INFO] - Full model selected, loading model
[2025-03-06 16:32:21,152][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:32:21,160][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:32:29,686][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:32:29,688][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:32:29,689][root][INFO] - Starting inference
[2025-03-06 16:32:29,893][root][INFO] - Processing question number 0
[2025-03-06 16:32:29,908][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:32:42,786][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:32:55,298][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:33:11,434][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:33:25,565][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:33:36,432][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:33:45,107][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:33:54,374][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:34:06,265][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:34:16,608][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:34:26,958][root][INFO] - Processing question number 10
[2025-03-06 16:34:26,959][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:34:38,300][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:34:49,288][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:35:01,149][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:35:13,470][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:35:25,258][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:35:35,510][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:35:44,709][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:35:52,564][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:36:05,392][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:36:15,107][root][INFO] - Processing question number 20
[2025-03-06 16:36:15,110][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:36:25,684][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:36:34,413][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:36:42,645][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:36:49,878][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:37:01,788][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:37:09,043][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:37:17,009][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:37:27,177][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:37:39,194][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:37:49,953][root][INFO] - Processing question number 30
[2025-03-06 16:37:49,955][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:37:58,686][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:38:09,233][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:38:20,084][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:38:31,431][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:38:42,467][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:38:53,524][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:39:07,444][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:39:20,500][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:39:30,868][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:39:43,645][root][INFO] - Processing question number 40
[2025-03-06 16:39:43,647][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:39:53,683][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:40:03,512][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:40:15,847][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:40:24,774][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:40:40,442][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:40:47,694][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:40:56,045][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:41:09,598][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:41:22,283][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:41:36,841][root][INFO] - Processing question number 50
[2025-03-06 16:41:36,844][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:41:47,804][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:42:00,795][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:42:14,029][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:42:29,496][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:42:40,258][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:42:51,619][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:43:05,697][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:43:17,326][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:43:28,611][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:43:40,079][root][INFO] - Processing question number 60
[2025-03-06 16:43:40,082][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:43:51,981][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:44:03,486][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:44:16,150][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:44:25,817][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:44:36,579][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:44:47,177][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:44:55,838][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:45:05,504][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:45:14,971][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:45:23,877][root][INFO] - Processing question number 70
[2025-03-06 16:45:23,880][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:45:34,386][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:45:47,893][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:45:59,004][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:46:15,287][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:46:22,436][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:46:33,207][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:46:43,626][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:46:59,382][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:47:08,007][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:47:18,467][root][INFO] - Processing question number 80
[2025-03-06 16:47:18,471][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:47:28,647][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:47:38,394][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:47:49,658][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:47:59,834][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:48:12,333][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:48:22,564][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:48:39,954][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:48:50,848][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:49:02,189][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:49:17,919][root][INFO] - Processing question number 90
[2025-03-06 16:49:17,923][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:49:28,381][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:49:40,709][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:49:55,127][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:50:03,905][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:50:18,167][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:50:32,180][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:50:39,563][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:50:50,674][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:50:59,725][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:51:11,111][root][INFO] - Inference complete
[2025-03-06 16:51:11,112][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,120][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,121][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,121][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,122][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,122][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,123][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,123][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,123][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,123][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,123][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,123][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,123][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,124][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,124][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,124][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,124][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,124][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,125][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,125][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,125][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,125][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,125][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,126][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,126][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,126][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,126][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,127][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,127][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,127][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,127][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,128][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,128][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,129][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,129][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,129][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,129][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,129][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,130][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,130][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,130][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,130][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,130][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,131][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,131][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,131][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,131][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,132][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,132][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,132][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,134][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,134][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,134][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,134][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,134][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,135][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,135][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,135][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,135][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,135][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,135][root][WARNING] - |Q. 68||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,135][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,136][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,136][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,136][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,137][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,137][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:51:11,137][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,137][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,137][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,137][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,137][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,138][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,138][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,138][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,138][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,138][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,139][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,139][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,139][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,139][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,139][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,140][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,140][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,140][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,140][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,141][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:51:11,141][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:51:11,141][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:51:11,143][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,148][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,148][root][INFO] - Saved parsed outputs
[2025-03-06 16:51:11,148][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,149][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,149][root][INFO] - Saved parsing metadata
[2025-03-06 16:51:11,150][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,151][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:51:11,152][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:51:11,174][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 16:51:11,174][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 30, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 16:51:18,337][root][INFO] - Setting global seed to 989
[2025-03-06 16:51:18,344][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:51:18,344][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:51:18,345][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:51:18,347][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:51:18,350][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:51:18,350][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:51:18,516][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:51:19,103][root][INFO] - Full model selected, loading model
[2025-03-06 16:51:42,165][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:53:25,625][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:53:25,665][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:53:59,002][root][INFO] - Peft model loaded successfully
[2025-03-06 16:54:06,427][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:54:06,430][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:54:06,430][root][INFO] - Starting inference
[2025-03-06 16:54:06,636][root][INFO] - Processing question number 0
[2025-03-06 16:54:06,638][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:54:21,306][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:54:37,142][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:54:51,064][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:55:09,981][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:55:21,252][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:55:31,576][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:55:45,438][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:55:57,504][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:56:06,742][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:56:17,366][root][INFO] - Processing question number 10
[2025-03-06 16:56:17,368][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:56:26,004][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:56:34,539][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:56:46,562][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:56:56,559][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:57:10,293][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:57:19,801][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:57:32,850][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:57:44,231][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:57:56,251][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:58:08,879][root][INFO] - Processing question number 20
[2025-03-06 16:58:08,882][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:58:17,800][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:58:28,825][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:58:38,123][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:58:49,007][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:59:01,086][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:59:14,484][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:59:27,417][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:59:39,165][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:59:50,748][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:00:03,193][root][INFO] - Processing question number 30
[2025-03-06 17:00:03,195][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:00:12,965][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:00:25,481][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:00:37,826][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:00:51,906][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:01:04,998][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:01:17,865][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:01:30,928][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:01:46,432][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:01:59,213][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:02:12,255][root][INFO] - Processing question number 40
[2025-03-06 17:02:12,258][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:02:23,406][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:02:33,682][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:02:47,981][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:02:55,814][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:03:14,916][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:03:25,594][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:03:34,820][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:03:45,591][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:03:57,109][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:04:08,866][root][INFO] - Processing question number 50
[2025-03-06 17:04:08,869][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:04:19,593][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:04:32,973][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:04:48,716][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:05:05,072][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:05:18,054][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:05:30,231][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:05:48,830][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:06:01,583][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:06:13,526][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:06:23,788][root][INFO] - Processing question number 60
[2025-03-06 17:06:23,791][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:06:36,392][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:06:49,488][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:07:03,533][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:07:16,395][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:07:30,494][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:07:41,613][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:07:59,636][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:08:10,914][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:08:20,128][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:08:31,209][root][INFO] - Processing question number 70
[2025-03-06 17:08:31,213][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:08:44,933][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:08:57,913][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:09:11,416][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:09:26,327][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:09:36,513][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:09:50,477][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:10:04,733][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:10:19,348][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:10:30,362][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:10:41,712][root][INFO] - Processing question number 80
[2025-03-06 17:10:41,716][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:10:55,939][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:11:11,663][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:11:25,919][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:11:36,758][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:11:55,103][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:12:07,680][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:12:20,430][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:12:33,964][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:12:48,348][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:13:01,969][root][INFO] - Processing question number 90
[2025-03-06 17:13:01,974][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:13:16,185][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:13:31,190][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:13:44,813][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:13:55,081][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:14:08,205][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:14:23,495][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:14:37,961][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:14:48,538][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:14:58,750][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:15:12,412][root][INFO] - Inference complete
[2025-03-06 17:15:12,413][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,419][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,430][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:15:12,431][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:15:12,432][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:15:12,433][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,438][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,438][root][INFO] - Saved parsed outputs
[2025-03-06 17:15:12,438][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,439][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,439][root][INFO] - Saved parsing metadata
[2025-03-06 17:15:12,440][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,442][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:12,445][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:15:12,472][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 17:15:12,472][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.0, 'malformed_label': 21, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 17:15:19,842][root][INFO] - Setting global seed to 989
[2025-03-06 17:15:19,849][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:15:19,849][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:15:19,850][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:15:19,852][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:15:19,855][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:15:19,855][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:15:20,290][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:15:20,845][root][INFO] - Full model selected, loading model
[2025-03-06 17:15:45,740][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:15:45,741][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:15:53,555][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:15:53,557][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:15:53,557][root][INFO] - Starting inference
[2025-03-06 17:15:53,745][root][INFO] - Processing question number 0
[2025-03-06 17:15:53,747][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:16:07,624][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:16:17,752][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:16:30,206][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:16:41,985][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:16:50,275][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:16:58,592][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:17:08,725][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:17:18,913][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:17:30,528][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:17:40,976][root][INFO] - Processing question number 10
[2025-03-06 17:17:40,978][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:17:48,159][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:17:57,006][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:18:09,698][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:18:17,401][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:18:30,336][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:18:39,776][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:18:49,509][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:18:58,936][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:19:10,071][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:19:20,695][root][INFO] - Processing question number 20
[2025-03-06 17:19:20,697][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:19:31,868][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:19:44,290][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:19:53,942][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:20:02,560][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:20:11,544][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:20:20,210][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:20:30,521][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:20:38,839][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:20:49,211][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:21:00,389][root][INFO] - Processing question number 30
[2025-03-06 17:21:00,391][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:21:08,117][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:21:18,375][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:21:28,707][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:21:38,511][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:21:50,657][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:22:03,095][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:22:17,237][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:22:28,988][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:22:37,721][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:22:47,387][root][INFO] - Processing question number 40
[2025-03-06 17:22:47,390][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:22:57,266][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:23:06,849][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:23:20,187][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:23:28,108][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:23:46,390][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:23:55,438][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:24:06,313][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:24:18,098][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:24:30,726][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:24:43,232][root][INFO] - Processing question number 50
[2025-03-06 17:24:43,235][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:24:53,355][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:25:03,964][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:25:15,345][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:25:28,328][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:25:36,808][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:25:47,167][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:25:58,222][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:26:11,632][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:26:21,938][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:26:34,478][root][INFO] - Processing question number 60
[2025-03-06 17:26:34,481][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:26:42,308][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:26:52,835][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:27:04,597][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:27:19,386][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:27:28,332][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:27:38,884][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:27:48,018][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:27:57,747][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:28:06,722][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:28:19,225][root][INFO] - Processing question number 70
[2025-03-06 17:28:19,228][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:28:29,466][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:28:37,931][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:28:55,144][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:29:09,850][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:29:18,982][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:29:30,308][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:29:41,974][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:29:56,403][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:30:06,186][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:30:15,913][root][INFO] - Processing question number 80
[2025-03-06 17:30:15,916][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:30:27,219][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:30:37,311][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:30:51,076][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:31:01,617][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:31:13,731][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:31:26,621][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:31:41,427][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:31:51,202][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:32:03,014][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:32:17,195][root][INFO] - Processing question number 90
[2025-03-06 17:32:17,199][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:32:27,758][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:32:39,182][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:32:54,575][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:33:03,706][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:33:15,109][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:33:27,572][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:33:39,022][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:33:51,108][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:34:00,808][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:34:09,855][root][INFO] - Inference complete
[2025-03-06 17:34:09,856][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,862][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,862][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,863][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,864][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,864][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,864][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,864][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,864][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,864][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,865][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,865][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,865][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,865][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,865][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,865][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,865][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,866][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,866][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,866][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,866][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,866][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,866][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,867][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,867][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,867][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,867][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,867][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,868][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,868][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,868][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,868][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,868][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,868][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,868][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,869][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,869][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,869][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,871][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,871][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,871][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,871][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,872][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,872][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,872][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,872][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,872][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,873][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,873][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,873][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,874][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,874][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,874][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,876][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,876][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,876][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,877][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,877][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,878][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,878][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,878][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,878][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,878][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,878][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,878][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,879][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,879][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,879][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,879][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,879][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,880][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,880][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,880][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,880][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,880][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,880][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,881][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,881][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,881][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,881][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,882][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,882][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,882][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,883][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:09,883][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:09,883][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:09,884][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,889][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,889][root][INFO] - Saved parsed outputs
[2025-03-06 17:34:09,889][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,890][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,891][root][INFO] - Saved parsing metadata
[2025-03-06 17:34:09,891][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,893][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:09,894][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:34:09,923][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 17:34:09,923][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 29, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 17:34:17,085][root][INFO] - Setting global seed to 989
[2025-03-06 17:34:17,092][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:34:17,092][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:34:17,093][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:34:17,095][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:34:17,097][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:34:17,098][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:34:17,258][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:34:17,808][root][INFO] - Full model selected, loading model
[2025-03-06 17:34:41,071][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:36:25,130][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:36:25,130][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:37:00,230][root][INFO] - Peft model loaded successfully
[2025-03-06 17:37:07,697][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:37:07,699][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:37:07,699][root][INFO] - Starting inference
[2025-03-06 17:37:07,904][root][INFO] - Processing question number 0
[2025-03-06 17:37:07,907][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:37:23,155][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:37:39,679][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:37:53,403][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:38:08,058][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:38:18,276][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:38:28,742][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:38:40,563][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:38:53,539][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:39:04,751][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:39:16,880][root][INFO] - Processing question number 10
[2025-03-06 17:39:16,882][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:39:25,562][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:39:35,474][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:39:51,778][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:40:01,966][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:40:16,497][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:40:26,511][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:40:40,207][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:40:52,172][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:41:04,307][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:41:18,492][root][INFO] - Processing question number 20
[2025-03-06 17:41:18,495][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:41:27,822][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:41:37,968][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:41:47,495][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:41:57,035][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:42:07,038][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:42:19,985][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:42:32,569][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:42:45,660][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:42:54,695][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:43:09,315][root][INFO] - Processing question number 30
[2025-03-06 17:43:09,317][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:43:19,463][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:43:31,714][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:43:42,851][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:43:55,109][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:44:07,804][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:44:21,499][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:44:35,202][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:44:49,537][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:45:06,085][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:45:24,263][root][INFO] - Processing question number 40
[2025-03-06 17:45:24,266][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:45:38,570][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:45:50,541][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:46:03,865][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:46:11,828][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:46:27,045][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:46:36,106][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:46:45,147][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:46:57,137][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:47:08,011][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:47:20,108][root][INFO] - Processing question number 50
[2025-03-06 17:47:20,111][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:47:32,404][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:47:47,079][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:48:02,007][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:48:14,699][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:48:27,799][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:48:41,403][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:48:54,178][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:49:07,140][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:49:18,529][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:49:32,366][root][INFO] - Processing question number 60
[2025-03-06 17:49:32,369][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:49:44,848][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:49:54,776][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:50:07,320][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:50:22,109][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:50:36,576][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:50:47,192][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:51:05,632][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:51:15,862][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:51:26,729][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:51:37,682][root][INFO] - Processing question number 70
[2025-03-06 17:51:37,685][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:51:52,126][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:52:05,379][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:52:18,916][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:52:32,931][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:52:43,847][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:52:55,870][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:53:10,116][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:53:26,451][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:53:38,385][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:53:49,694][root][INFO] - Processing question number 80
[2025-03-06 17:53:49,697][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:54:02,754][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:54:16,405][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:54:30,395][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:54:42,783][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:54:59,177][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:55:15,302][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:55:26,743][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:55:40,386][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:55:54,900][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:56:09,924][root][INFO] - Processing question number 90
[2025-03-06 17:56:09,928][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:56:21,996][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:56:37,320][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:56:53,063][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:57:04,444][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:57:15,720][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:57:29,592][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:57:44,079][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:57:54,731][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:58:06,790][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:58:22,971][root][INFO] - Inference complete
[2025-03-06 17:58:22,971][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,977][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,990][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,994][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,994][root][INFO] - Saved parsed outputs
[2025-03-06 17:58:22,994][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,996][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,996][root][INFO] - Saved parsing metadata
[2025-03-06 17:58:22,996][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,998][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:58:22,999][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:58:23,012][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 17:58:23,012][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.0, 'malformed_label': 25, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 17:58:30,158][root][INFO] - Setting global seed to 989
[2025-03-06 17:58:30,164][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:58:30,164][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:58:30,165][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:58:30,167][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:58:30,168][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:58:30,169][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:58:30,484][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:58:31,157][root][INFO] - Full model selected, loading model
[2025-03-06 17:58:55,595][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:58:55,604][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:59:03,550][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:59:03,552][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:59:03,552][root][INFO] - Starting inference
[2025-03-06 17:59:03,774][root][INFO] - Processing question number 0
[2025-03-06 17:59:03,776][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:59:16,177][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:59:25,820][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:59:37,273][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:59:48,300][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:59:56,200][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:00:05,873][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:00:15,322][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:00:25,470][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:00:37,828][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:00:47,145][root][INFO] - Processing question number 10
[2025-03-06 18:00:47,147][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:00:55,087][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:01:04,663][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:01:16,694][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:01:25,491][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:01:38,491][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:01:49,056][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:02:00,247][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:02:13,090][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:02:26,012][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:02:35,320][root][INFO] - Processing question number 20
[2025-03-06 18:02:35,322][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:02:45,508][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:02:54,843][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:03:03,160][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:03:10,939][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:03:20,008][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:03:29,084][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:03:41,129][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:03:50,411][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:04:00,923][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:04:12,673][root][INFO] - Processing question number 30
[2025-03-06 18:04:12,676][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:04:19,702][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:04:30,114][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:04:41,664][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:04:52,259][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:05:02,087][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:05:13,143][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:05:27,981][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:05:42,903][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:05:53,727][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:06:05,643][root][INFO] - Processing question number 40
[2025-03-06 18:06:05,647][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:06:15,617][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:06:26,024][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:06:36,830][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:06:46,283][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:07:03,413][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:07:12,637][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:07:20,465][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:07:29,913][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:07:42,793][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:07:57,080][root][INFO] - Processing question number 50
[2025-03-06 18:07:57,083][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:08:07,204][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:08:17,459][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:08:31,233][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:08:45,143][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:08:53,942][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:09:03,904][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:09:13,796][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:09:25,534][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:09:35,372][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:09:48,788][root][INFO] - Processing question number 60
[2025-03-06 18:09:48,791][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:09:56,773][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:10:09,554][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:10:21,128][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:10:31,891][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:10:42,665][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:10:58,118][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:11:09,185][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:11:19,550][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:11:28,191][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:11:38,107][root][INFO] - Processing question number 70
[2025-03-06 18:11:38,111][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:11:51,071][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:12:00,777][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:12:12,315][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:12:27,007][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:12:35,211][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:12:45,471][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:12:58,691][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:13:11,919][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:13:23,491][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:13:33,726][root][INFO] - Processing question number 80
[2025-03-06 18:13:33,730][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:13:46,228][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:13:56,927][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:14:10,878][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:14:19,415][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:14:33,476][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:14:44,753][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:14:58,637][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:15:11,465][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:15:20,233][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:15:33,645][root][INFO] - Processing question number 90
[2025-03-06 18:15:33,649][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:15:41,914][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:15:53,875][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:16:04,590][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:16:12,229][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:16:25,957][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:16:37,332][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:16:49,452][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:16:57,883][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:17:06,342][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:17:17,308][root][INFO] - Inference complete
[2025-03-06 18:17:17,308][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,313][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,314][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,315][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,315][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,316][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,316][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,316][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,316][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,316][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,316][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,316][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,317][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,317][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,317][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,317][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,317][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,317][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,318][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,318][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,318][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,318][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,318][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,319][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,319][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,319][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,319][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,319][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,319][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,320][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,320][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,320][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,320][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,320][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,321][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,322][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,322][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,322][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,322][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,323][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,323][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,323][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,323][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,323][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,324][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,324][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,324][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,324][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,325][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,325][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,325][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,325][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,325][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,325][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,325][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,326][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,326][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,327][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,327][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,327][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,327][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,327][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,329][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,329][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,329][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,330][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,330][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,330][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,330][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,331][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,331][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,331][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,331][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,331][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,332][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,332][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,332][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,332][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,332][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,332][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,333][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,333][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,333][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,333][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:17:17,334][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:17:17,334][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:17:17,336][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,340][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,340][root][INFO] - Saved parsed outputs
[2025-03-06 18:17:17,341][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,342][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,342][root][INFO] - Saved parsing metadata
[2025-03-06 18:17:17,342][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,344][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:17:17,345][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:17:17,472][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 18:17:17,473][root][INFO] - Summary of metrics : {'label_accuracy': 0.41, 'misclassification_rate': 0.5900000000000001, 'combined_accuracy': 0.0, 'malformed_label': 28, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 18:17:29,033][root][INFO] - Setting global seed to 989
[2025-03-06 18:17:29,040][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:17:29,040][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:17:29,042][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:17:29,043][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:17:29,058][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:17:29,058][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:17:29,242][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:17:29,783][root][INFO] - Full model selected, loading model
[2025-03-06 18:17:53,401][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:19:37,599][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:19:37,599][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:20:13,499][root][INFO] - Peft model loaded successfully
[2025-03-06 18:20:21,445][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:20:21,447][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:21,490][root][INFO] - Starting inference
[2025-03-06 18:20:21,701][root][INFO] - Processing question number 0
[2025-03-06 18:20:21,703][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:20:35,642][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:20:52,561][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:21:08,694][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:21:24,400][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:21:35,315][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:21:46,096][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:21:58,915][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:22:12,647][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:22:20,597][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:22:33,334][root][INFO] - Processing question number 10
[2025-03-06 18:22:33,337][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:22:42,151][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:22:52,663][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:23:04,749][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:23:13,732][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:23:27,207][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:23:38,715][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:23:49,722][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:24:00,974][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:24:13,959][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:24:24,165][root][INFO] - Processing question number 20
[2025-03-06 18:24:24,167][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:24:33,857][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:24:48,428][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:24:57,765][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:25:10,426][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:25:23,365][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:25:34,711][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:25:47,717][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:26:00,236][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:26:11,077][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:26:25,979][root][INFO] - Processing question number 30
[2025-03-06 18:26:25,982][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:26:36,066][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:26:47,005][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:26:58,754][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:27:10,430][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:27:23,403][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:27:37,990][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:27:52,773][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:28:07,067][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:28:22,463][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:28:38,621][root][INFO] - Processing question number 40
[2025-03-06 18:28:38,624][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:28:51,794][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:29:04,418][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:29:15,944][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:29:23,857][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:29:41,766][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:29:50,349][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:30:02,030][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:30:18,288][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:30:30,799][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:30:41,992][root][INFO] - Processing question number 50
[2025-03-06 18:30:41,995][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:30:56,241][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:31:08,707][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:31:23,713][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:31:36,057][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:31:48,044][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:31:59,722][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:32:13,219][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:32:26,989][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:32:39,233][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:32:50,194][root][INFO] - Processing question number 60
[2025-03-06 18:32:50,198][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:33:04,841][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:33:16,733][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:33:29,029][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:33:44,093][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:33:56,604][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:34:08,609][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:34:21,739][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:34:31,410][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:34:46,255][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:34:58,036][root][INFO] - Processing question number 70
[2025-03-06 18:34:58,040][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:35:10,817][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:35:23,812][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:35:40,069][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:35:54,668][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:36:04,027][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:36:17,969][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:36:33,076][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:36:46,010][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:36:59,060][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:37:15,051][root][INFO] - Processing question number 80
[2025-03-06 18:37:15,054][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:37:29,427][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:37:44,953][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:38:02,804][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:38:17,491][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:38:34,422][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:38:48,259][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:39:01,135][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:39:15,479][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:39:29,200][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:39:42,232][root][INFO] - Processing question number 90
[2025-03-06 18:39:42,236][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:39:54,203][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:40:09,034][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:40:22,479][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:40:32,539][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:40:45,427][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:41:01,122][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:41:18,293][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:41:27,328][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:41:38,601][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:41:53,628][root][INFO] - Inference complete
[2025-03-06 18:41:53,628][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,635][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,644][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:41:53,644][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:41:53,644][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:41:53,649][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,655][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,655][root][INFO] - Saved parsed outputs
[2025-03-06 18:41:53,655][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,656][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,656][root][INFO] - Saved parsing metadata
[2025-03-06 18:41:53,658][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,659][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:41:53,661][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:41:53,674][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 18:41:53,674][root][INFO] - Summary of metrics : {'label_accuracy': 0.39, 'misclassification_rate': 0.61, 'combined_accuracy': 0.0, 'malformed_label': 23, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 14 to status running with exit code None
Eval status update completed for job 14
[2025-03-06 18:42:00,192][root][INFO] - Setting global seed to 989
[2025-03-06 18:42:00,198][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:42:00,198][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:42:00,199][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:42:00,201][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:42:00,202][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:42:00,203][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:42:00,362][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:42:00,955][root][INFO] - Full model selected, loading model
[2025-03-06 18:42:27,995][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:42:28,006][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:42:36,247][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:42:36,249][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:42:36,249][root][INFO] - Starting inference
[2025-03-06 18:42:36,416][root][INFO] - Processing question number 0
[2025-03-06 18:42:36,418][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:42:49,718][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:43:06,357][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:43:18,007][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:43:29,979][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:43:40,048][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:43:51,338][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:44:01,289][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:44:12,889][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:44:22,529][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:44:33,662][root][INFO] - Processing question number 10
[2025-03-06 18:44:33,664][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:44:41,509][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:44:49,515][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:44:59,532][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:45:09,440][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:45:23,202][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:45:36,500][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:45:45,275][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:45:56,150][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:46:05,029][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:46:16,737][root][INFO] - Processing question number 20
[2025-03-06 18:46:16,739][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:46:25,096][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:46:35,511][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:46:48,005][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:46:56,435][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:47:08,672][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:47:18,460][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:47:29,858][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:47:38,308][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:47:50,088][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:48:01,133][root][INFO] - Processing question number 30
[2025-03-06 18:48:01,135][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:48:08,800][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:48:17,037][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:48:26,631][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:48:34,641][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:48:46,061][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:48:56,081][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:49:10,068][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:49:23,350][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:49:33,328][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:49:47,660][root][INFO] - Processing question number 40
[2025-03-06 18:49:47,663][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:49:59,459][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:50:09,175][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:50:20,988][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:50:28,573][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:50:41,519][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:50:49,681][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:50:57,651][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:51:09,354][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:51:19,705][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:51:31,050][root][INFO] - Processing question number 50
[2025-03-06 18:51:31,053][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:51:43,919][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:51:51,551][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:52:03,886][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:52:17,975][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:52:29,803][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:52:42,690][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:52:55,892][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:53:06,264][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:53:21,062][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:53:32,486][root][INFO] - Processing question number 60
[2025-03-06 18:53:32,489][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:53:45,235][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:53:57,594][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:54:06,832][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:54:20,602][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:54:33,294][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:54:45,718][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:54:53,466][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:55:03,558][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:55:13,812][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:55:25,638][root][INFO] - Processing question number 70
[2025-03-06 18:55:25,642][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:55:38,127][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:55:49,191][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:56:00,973][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:56:19,609][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:56:28,457][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:56:38,610][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:56:49,029][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:57:02,287][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:57:09,129][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:57:22,734][root][INFO] - Processing question number 80
[2025-03-06 18:57:22,738][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:57:34,094][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:57:42,532][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:57:52,526][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:58:03,359][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:58:16,053][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:58:28,399][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:58:41,986][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:58:51,561][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:59:03,194][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:59:12,708][root][INFO] - Processing question number 90
[2025-03-06 18:59:12,713][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:59:22,287][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:59:35,774][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:59:45,594][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:59:54,341][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:00:07,720][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:00:19,909][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:00:31,367][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:00:39,893][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:00:48,688][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:01:02,401][root][INFO] - Inference complete
[2025-03-06 19:01:02,401][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,407][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,408][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,408][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,409][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,409][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,410][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,410][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,410][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,410][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,410][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,411][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,411][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,411][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,411][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,411][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,411][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,412][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,412][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,412][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,412][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,412][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,412][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,412][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,413][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,413][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,413][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,413][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,413][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,413][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,414][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,414][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,414][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,414][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,414][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,415][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,415][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,415][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,416][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,416][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,416][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,417][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,417][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,417][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,417][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,417][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,418][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,418][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,418][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,418][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,419][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,419][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,419][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,419][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,420][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,420][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,420][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,420][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,420][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,421][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,421][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,421][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,421][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,421][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,421][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,422][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,423][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,423][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,423][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,423][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,423][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,424][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,424][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,424][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,425][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,425][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,425][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,425][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,425][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,426][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,426][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,426][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,426][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,426][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,426][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,426][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,427][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,427][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,427][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,427][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,428][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,428][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,428][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,428][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,428][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,428][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,428][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,429][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,429][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,429][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,429][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,430][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,430][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,430][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,430][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,430][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,430][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,431][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:01:02,431][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:01:02,431][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:01:02,433][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,438][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,438][root][INFO] - Saved parsed outputs
[2025-03-06 19:01:02,438][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,439][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,439][root][INFO] - Saved parsing metadata
[2025-03-06 19:01:02,440][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,442][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:01:02,443][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:01:02,472][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 19:01:02,472][root][INFO] - Summary of metrics : {'label_accuracy': 0.37, 'misclassification_rate': 0.63, 'combined_accuracy': 0.0, 'malformed_label': 37, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 37, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 37, 'both_wrong': 63}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '14', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 14 to status completed with exit code 0
Eval status update completed for job 14
Job 14 completed at Thu Mar  6 19:01:03 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n517
Job ID: 25358389
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 08:42:53
CPU Efficiency: 9.86% of 3-16:22:50 core-walltime
Job Wall-clock time: 08:50:17
Memory Utilized: 35.39 GB
Memory Efficiency: 98.30% of 36.00 GB
