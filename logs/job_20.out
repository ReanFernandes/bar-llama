Starting job 20 at Thu Feb 20 23:07:07 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=markdown_answer_first_few_shot_unstructured train=markdown_answer_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '20', 'training']
Updating job 20 to status training with exit code None
Status update completed for job 20
[2025-02-20 23:07:21,842][root][INFO] - Global seed set to 314
[2025-02-20 23:07:21,843][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 23:07:21,843][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 23:07:21,843][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 23:07:21,843][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:07:21,844][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 23:07:21,856][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:07:21,860][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 23:07:21,860][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 23:07:21,887][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 23:07:22,625][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:07:47,899][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:08:15,556][root][INFO] - Model prepared for kbit training
[2025-02-20 23:08:15,557][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'up_proj', 'gate_proj', 'down_proj', 'k_proj', 'o_proj', 'v_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 23:08:17,238][root][INFO] - Lora adapter added to model
[2025-02-20 23:08:17,241][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_answer_first_few_shot_unstructured
[2025-02-20 23:08:17,458][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.8825, 'grad_norm': 0.4172150790691376, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.5553, 'grad_norm': 0.36735981702804565, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3453, 'grad_norm': 0.388027161359787, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1708, 'grad_norm': 0.5361517667770386, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8847, 'grad_norm': 0.4361908435821533, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 417.1441, 'train_samples_per_second': 0.252, 'train_steps_per_second': 0.036, 'train_loss': 1.367709716161092, 'epoch': 15.0}
[2025-02-20 23:15:21,977][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_answer_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '20', 'trained', '0']
Updating job 20 to status trained with exit code 0
Status update completed for job 20
Starting evaluations for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-20 23:15:31,513][root][INFO] - Setting global seed to 206
[2025-02-20 23:15:31,520][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:15:31,521][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:15:31,522][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:15:31,524][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:15:31,529][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:15:31,529][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:15:31,770][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:15:32,354][root][INFO] - Full model selected, loading model
[2025-02-20 23:15:52,951][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:17:36,528][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:17:36,549][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:18:08,955][root][INFO] - Peft model loaded successfully
[2025-02-20 23:18:16,400][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:18:16,401][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:16,401][root][INFO] - Starting inference
[2025-02-20 23:18:16,558][root][INFO] - Processing question number 0
[2025-02-20 23:18:16,587][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:18:28,750][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:18:44,253][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:18:51,501][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:19:22,701][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:19:29,119][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:19:59,936][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:20:09,595][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:20:40,519][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:20:48,818][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:20:55,632][root][INFO] - Processing question number 10
[2025-02-20 23:20:55,634][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:21:27,968][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:21:39,945][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:21:52,032][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:22:04,594][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:22:13,488][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:22:25,166][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:22:55,737][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:23:11,334][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:23:42,246][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:23:56,343][root][INFO] - Processing question number 20
[2025-02-20 23:23:56,345][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:24:04,613][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:24:16,220][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:24:46,824][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:25:17,411][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:25:48,503][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:25:56,297][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:26:27,896][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:26:58,804][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:27:29,768][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:27:37,498][root][INFO] - Processing question number 30
[2025-02-20 23:27:37,501][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:27:47,044][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:27:56,843][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:28:09,112][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:28:22,835][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:28:29,936][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:28:41,282][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:28:54,007][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:29:09,098][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:29:17,864][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:29:26,775][root][INFO] - Processing question number 40
[2025-02-20 23:29:26,778][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:29:41,193][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:29:52,262][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:30:11,218][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:30:42,563][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:30:52,888][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:31:23,880][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:31:33,297][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:31:44,362][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:32:15,280][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:32:25,149][root][INFO] - Processing question number 50
[2025-02-20 23:32:25,153][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:32:33,406][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:32:45,384][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:32:55,639][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:33:27,396][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:33:58,388][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:34:10,076][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:34:20,519][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:34:37,651][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:34:44,575][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:35:16,307][root][INFO] - Processing question number 60
[2025-02-20 23:35:16,311][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:35:22,855][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:35:53,686][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:36:24,957][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:36:32,997][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:36:45,619][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:37:16,578][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:37:36,287][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:38:07,399][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:38:14,649][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:38:21,703][root][INFO] - Processing question number 70
[2025-02-20 23:38:21,708][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:38:33,974][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:38:42,536][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:38:50,362][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:39:00,938][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:39:32,153][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:40:02,819][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:40:13,773][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:40:26,249][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:40:35,556][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:41:06,487][root][INFO] - Processing question number 80
[2025-02-20 23:41:06,491][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:41:15,833][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:41:47,073][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:41:54,520][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:42:08,608][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:42:39,949][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:43:11,270][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:43:42,574][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:44:13,415][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:44:44,477][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:45:15,055][root][INFO] - Processing question number 90
[2025-02-20 23:45:15,060][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:45:46,637][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:46:16,846][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:46:29,849][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:46:35,926][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:46:49,385][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:47:19,994][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:47:50,787][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:47:59,157][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:48:30,506][root][INFO] - Inference complete
[2025-02-20 23:48:30,506][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,512][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,513][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,513][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,514][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,514][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,514][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,515][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 23:48:30,515][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,516][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,516][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,516][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,516][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,517][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,517][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,517][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 23:48:30,517][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,518][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,518][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,518][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,518][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,518][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,519][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,519][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,519][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-20 23:48:30,519][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,520][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,520][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,520][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,520][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,520][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,521][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,521][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-20 23:48:30,521][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,521][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,522][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,522][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,522][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,522][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,523][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,523][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-20 23:48:30,523][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,523][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,524][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,524][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,524][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,524][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,524][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,525][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,525][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,525][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,525][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-20 23:48:30,525][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,526][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,526][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,526][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,526][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,527][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,527][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,527][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,527][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,528][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 23:48:30,528][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,567][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,567][root][INFO] - Saved parsed outputs
[2025-02-20 23:48:30,567][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,602][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,602][root][INFO] - Saved parsing metadata
[2025-02-20 23:48:30,602][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,604][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:30,629][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:48:30,643][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:48:30,643][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 13, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-20 23:48:37,040][root][INFO] - Setting global seed to 206
[2025-02-20 23:48:37,046][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:48:37,046][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:48:37,047][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:48:37,049][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:48:37,051][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:48:37,051][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:48:37,196][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:48:37,742][root][INFO] - Full model selected, loading model
[2025-02-20 23:48:51,293][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:48:51,293][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:48:58,915][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:48:58,916][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:58,916][root][INFO] - Starting inference
[2025-02-20 23:48:59,060][root][INFO] - Processing question number 0
[2025-02-20 23:48:59,096][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:49:12,458][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:49:22,745][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:49:29,252][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:49:44,397][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:49:55,577][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:50:09,391][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:50:18,962][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:50:37,416][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:50:45,294][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:50:58,234][root][INFO] - Processing question number 10
[2025-02-20 23:50:58,236][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:51:09,293][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:51:18,053][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:51:27,133][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:51:34,961][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:51:43,022][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:51:55,017][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:52:04,513][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:52:15,783][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:52:22,711][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:52:35,179][root][INFO] - Processing question number 20
[2025-02-20 23:52:35,181][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:52:49,654][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:52:58,585][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:53:14,625][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:53:24,225][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:53:33,772][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:53:44,823][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:53:58,584][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:54:08,951][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:54:25,802][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:54:39,279][root][INFO] - Processing question number 30
[2025-02-20 23:54:39,282][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:54:49,087][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:54:59,796][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:55:17,377][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:55:27,635][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:55:35,085][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:55:44,402][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:55:53,821][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:56:04,457][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:56:13,331][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:56:22,900][root][INFO] - Processing question number 40
[2025-02-20 23:56:22,903][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:56:33,286][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:56:43,118][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:56:53,934][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:57:02,463][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:57:17,473][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:57:29,016][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:57:38,336][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:57:48,339][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:57:57,373][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:58:09,101][root][INFO] - Processing question number 50
[2025-02-20 23:58:09,104][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:58:20,175][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:58:34,163][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:58:43,117][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:58:54,805][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:59:08,147][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:59:23,347][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:59:33,348][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:59:47,310][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:00:01,292][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:00:10,037][root][INFO] - Processing question number 60
[2025-02-21 00:00:10,040][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:00:18,244][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:00:27,896][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:00:59,225][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:01:07,815][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:01:18,363][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:01:33,147][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:01:45,647][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:01:56,433][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:02:04,420][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:02:15,660][root][INFO] - Processing question number 70
[2025-02-21 00:02:15,665][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:02:26,656][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:02:37,094][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:02:45,124][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:02:55,262][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:03:05,644][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:03:12,825][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:03:24,146][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:03:35,431][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:03:44,095][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:03:51,898][root][INFO] - Processing question number 80
[2025-02-21 00:03:51,902][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:04:01,830][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:04:14,661][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:04:26,983][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:04:38,360][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:04:49,230][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:05:00,589][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:05:10,401][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:05:21,637][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:05:31,909][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:05:41,064][root][INFO] - Processing question number 90
[2025-02-21 00:05:41,069][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:05:55,281][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:06:08,208][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:06:25,878][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:06:35,894][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:06:47,958][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:06:54,009][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:07:02,376][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:07:12,235][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:07:22,270][root][INFO] - Inference complete
[2025-02-21 00:07:22,270][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,276][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,277][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:07:22,277][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,277][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:07:22,277][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,277][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:07:22,278][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,278][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:07:22,278][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:07:22,278][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,278][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:07:22,278][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,278][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:07:22,278][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,278][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:07:22,279][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:07:22,279][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,279][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:07:22,279][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,279][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:07:22,279][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,279][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:07:22,279][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,279][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:07:22,279][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:07:22,280][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:07:22,280][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:07:22,280][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:07:22,280][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:07:22,280][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,280][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:07:22,281][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:07:22,281][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:07:22,281][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:07:22,281][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,281][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:07:22,282][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:07:22,282][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:07:22,282][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:07:22,282][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:07:22,283][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,283][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:07:22,283][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,283][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:07:22,283][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:07:22,283][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,283][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:07:22,283][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,283][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:07:22,283][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:07:22,284][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:07:22,284][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:07:22,284][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:07:22,284][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:07:22,284][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,284][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,285][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,285][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:07:22,285][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,285][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,285][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:07:22,285][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:07:22,286][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:07:22,286][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:07:22,286][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:07:22,286][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:07:22,286][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,286][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:07:22,287][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,287][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:07:22,287][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,287][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:07:22,287][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,287][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:07:22,287][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,287][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:07:22,287][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:07:22,287][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:07:22,288][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:07:22,288][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:07:22,288][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,288][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:07:22,288][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,288][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:07:22,288][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,288][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:07:22,288][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:07:22,289][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:07:22,289][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:07:22,289][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:07:22,289][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,289][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:07:22,289][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:07:22,290][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:07:22,290][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:07:22,290][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:07:22,290][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:07:22,290][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,290][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,291][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,291][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,291][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,291][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,291][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:07:22,291][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,292][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:07:22,292][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:07:22,293][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:07:22,293][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:07:22,293][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:07:22,293][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:07:22,293][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:07:22,294][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:07:22,294][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:07:22,294][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:07:22,294][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,294][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:07:22,294][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,295][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:07:22,295][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:07:22,295][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,324][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,324][root][INFO] - Saved parsed outputs
[2025-02-21 00:07:22,324][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,373][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,373][root][INFO] - Saved parsing metadata
[2025-02-21 00:07:22,374][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,375][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:07:22,402][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:07:22,430][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:07:22,430][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 53, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 00:07:29,657][root][INFO] - Setting global seed to 206
[2025-02-21 00:07:29,664][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:07:29,664][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:07:29,666][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:07:29,668][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:07:29,670][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:07:29,670][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:07:29,828][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:07:30,365][root][INFO] - Full model selected, loading model
[2025-02-21 00:07:49,568][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:09:29,752][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:09:29,754][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:10:02,539][root][INFO] - Peft model loaded successfully
[2025-02-21 00:10:09,916][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:10:09,918][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:10:09,918][root][INFO] - Starting inference
[2025-02-21 00:10:10,077][root][INFO] - Processing question number 0
[2025-02-21 00:10:10,079][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:10:43,791][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:11:15,454][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:11:23,906][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:11:31,524][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:11:41,216][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:11:54,269][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:12:03,295][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:12:11,695][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:12:20,313][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:12:29,450][root][INFO] - Processing question number 10
[2025-02-21 00:12:29,452][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:13:02,118][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:13:19,026][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:13:24,340][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:13:36,316][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:14:08,069][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:14:21,908][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:14:31,159][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:14:49,427][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:15:20,733][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:15:36,042][root][INFO] - Processing question number 20
[2025-02-21 00:15:36,044][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:15:42,970][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:16:14,343][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:16:22,999][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:16:36,965][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:16:48,203][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:16:57,256][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:17:08,482][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:17:17,147][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:17:45,565][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:17:53,226][root][INFO] - Processing question number 30
[2025-02-21 00:17:53,229][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:18:24,531][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:18:35,840][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:18:47,524][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:18:58,671][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:19:06,678][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:19:15,780][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:19:30,400][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:19:42,647][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:19:52,649][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:20:02,162][root][INFO] - Processing question number 40
[2025-02-21 00:20:02,165][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:20:32,990][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:20:43,514][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:20:56,311][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:21:27,996][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:21:46,499][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:21:59,152][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:22:08,051][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:22:21,862][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:22:32,781][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:23:04,477][root][INFO] - Processing question number 50
[2025-02-21 00:23:04,480][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:23:13,723][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:23:45,167][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:23:52,336][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:24:24,424][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:24:39,048][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:24:51,794][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:25:08,689][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:25:25,600][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:25:34,453][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:26:06,528][root][INFO] - Processing question number 60
[2025-02-21 00:26:06,532][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:26:13,782][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:26:22,044][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:26:53,659][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:27:04,995][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:27:14,891][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:27:46,187][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:27:53,649][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:28:06,761][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:28:15,027][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:28:23,060][root][INFO] - Processing question number 70
[2025-02-21 00:28:23,064][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:28:32,413][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:28:40,917][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:28:47,400][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:28:58,290][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:29:09,527][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:29:40,523][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:29:52,663][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:30:04,866][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:30:36,504][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:31:07,729][root][INFO] - Processing question number 80
[2025-02-21 00:31:07,734][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:31:16,170][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:31:33,627][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:31:42,084][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:31:51,726][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:32:01,893][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:32:33,540][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:33:05,181][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:33:15,270][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:33:24,536][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:33:33,286][root][INFO] - Processing question number 90
[2025-02-21 00:33:33,291][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:33:43,593][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:34:14,118][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:34:45,389][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:34:52,358][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:35:02,420][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:35:11,028][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:35:36,674][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:35:50,863][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:36:22,551][root][INFO] - Inference complete
[2025-02-21 00:36:22,551][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,557][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,558][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:36:22,558][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:36:22,559][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:36:22,560][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:36:22,560][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:36:22,561][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:36:22,561][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:36:22,561][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:36:22,562][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:36:22,562][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,562][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,562][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,562][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,563][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,563][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,563][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,563][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,564][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,564][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:36:22,564][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,564][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,565][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,565][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,565][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,565][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,566][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,566][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:36:22,566][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,566][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,567][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,567][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,567][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,567][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:36:22,568][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,568][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,568][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,568][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,569][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,569][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,569][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,569][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,569][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,570][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:36:22,570][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,570][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,570][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,571][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,571][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,571][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,571][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,571][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:36:22,572][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,578][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,578][root][INFO] - Saved parsed outputs
[2025-02-21 00:36:22,578][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,579][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,579][root][INFO] - Saved parsing metadata
[2025-02-21 00:36:22,580][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,581][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:22,583][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:36:22,591][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:36:22,591][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.09090909090909091, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.020202020202020204, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 11, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 00:36:29,296][root][INFO] - Setting global seed to 206
[2025-02-21 00:36:29,301][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:36:29,302][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:36:29,303][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:36:29,304][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:36:29,306][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:36:29,306][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:36:29,450][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:36:29,987][root][INFO] - Full model selected, loading model
[2025-02-21 00:36:43,942][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:36:43,943][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:36:51,523][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:36:51,524][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:36:51,525][root][INFO] - Starting inference
[2025-02-21 00:36:51,660][root][INFO] - Processing question number 0
[2025-02-21 00:36:51,662][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:36:59,492][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:37:11,268][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:37:21,528][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:37:30,733][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:37:45,057][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:37:57,530][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:38:06,372][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:38:18,993][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:38:26,487][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:38:36,814][root][INFO] - Processing question number 10
[2025-02-21 00:38:36,816][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:38:49,575][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:39:01,812][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:39:11,173][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:39:23,038][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:39:32,616][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:39:41,453][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:39:54,044][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:40:03,010][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:40:11,179][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:40:26,865][root][INFO] - Processing question number 20
[2025-02-21 00:40:26,867][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:40:37,998][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:40:48,454][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:40:58,682][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:41:09,053][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:41:19,980][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:41:30,972][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:41:39,952][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:41:52,210][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:42:06,809][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:42:17,515][root][INFO] - Processing question number 30
[2025-02-21 00:42:17,517][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:42:30,865][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:42:39,902][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:42:52,535][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:43:02,127][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:43:10,131][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:43:19,974][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:43:33,592][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:43:46,788][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:43:58,344][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:44:07,382][root][INFO] - Processing question number 40
[2025-02-21 00:44:07,385][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:44:15,948][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:44:26,210][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:44:35,756][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:44:44,701][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:45:00,745][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:45:11,532][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:45:22,106][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:45:36,895][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:45:46,204][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:45:56,764][root][INFO] - Processing question number 50
[2025-02-21 00:45:56,767][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:46:12,903][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:46:28,640][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:46:38,156][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:46:50,871][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:47:07,931][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:47:28,588][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:47:40,339][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:47:49,985][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:48:02,706][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:48:11,371][root][INFO] - Processing question number 60
[2025-02-21 00:48:11,374][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:48:20,283][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:48:29,323][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:48:40,006][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:48:48,864][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:49:01,259][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:49:11,337][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:49:23,740][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:49:34,464][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:49:45,524][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:49:58,012][root][INFO] - Processing question number 70
[2025-02-21 00:49:58,016][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:50:09,350][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:50:18,976][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:50:28,157][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:50:42,071][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:50:54,753][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:51:03,864][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:51:15,372][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:51:28,613][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:51:37,953][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:51:46,906][root][INFO] - Processing question number 80
[2025-02-21 00:51:46,910][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:51:57,620][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:52:07,786][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:52:19,205][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:52:29,927][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:52:43,321][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:52:57,827][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:53:09,828][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:53:18,174][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:53:31,800][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:53:41,818][root][INFO] - Processing question number 90
[2025-02-21 00:53:41,823][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:54:02,060][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:54:10,497][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:54:24,878][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:54:31,694][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:54:42,898][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:54:51,940][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:54:58,849][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:55:08,994][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:55:20,473][root][INFO] - Inference complete
[2025-02-21 00:55:20,473][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,562][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,563][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:55:20,563][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,563][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:55:20,564][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,564][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:55:20,564][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,564][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:55:20,564][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,564][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:55:20,564][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:55:20,564][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,564][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,565][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,565][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,565][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,565][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,565][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:55:20,565][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:55:20,566][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:55:20,566][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:55:20,566][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:55:20,566][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,566][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:55:20,567][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,567][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:55:20,567][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,567][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:55:20,567][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:55:20,567][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:55:20,567][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,567][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:55:20,567][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:55:20,568][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:55:20,568][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:55:20,568][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:55:20,568][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:55:20,568][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,568][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,569][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:20,569][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,569][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,569][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,569][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:55:20,569][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:55:20,570][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:55:20,570][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:55:20,570][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:55:20,570][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,570][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:55:20,571][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,571][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:55:20,571][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,571][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:55:20,571][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,571][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:55:20,571][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,571][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:55:20,571][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:20,571][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:55:20,572][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:55:20,572][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:55:20,572][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:55:20,572][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,572][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:55:20,572][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:55:20,573][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:55:20,573][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:55:20,573][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:55:20,573][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:20,574][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:55:20,574][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,574][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:55:20,574][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,574][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:55:20,574][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,574][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:55:20,574][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,574][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:55:20,574][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:55:20,575][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:55:20,575][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:55:20,575][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:55:20,575][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:55:20,575][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,575][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,576][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,576][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,576][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,576][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:20,576][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:55:20,576][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:55:20,577][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:55:20,577][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:55:20,577][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:55:20,577][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,577][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,578][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,578][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,578][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,578][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,578][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:55:20,578][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:55:20,579][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:55:20,579][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:55:20,579][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:55:20,579][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:55:20,579][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,579][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:55:20,580][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:55:20,580][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:55:20,580][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:55:20,580][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,580][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:55:20,581][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,581][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:55:20,581][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,581][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:55:20,581][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,581][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:55:20,581][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:20,582][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,587][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,587][root][INFO] - Saved parsed outputs
[2025-02-21 00:55:20,587][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,588][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,588][root][INFO] - Saved parsing metadata
[2025-02-21 00:55:20,589][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,591][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:20,593][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:55:20,606][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:55:20,606][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 50, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 00:55:27,257][root][INFO] - Setting global seed to 206
[2025-02-21 00:55:27,262][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:55:27,262][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:55:27,264][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:55:27,265][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:55:27,267][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:55:27,267][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:55:27,415][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:55:27,946][root][INFO] - Full model selected, loading model
[2025-02-21 00:55:41,632][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:57:23,175][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:57:23,176][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:57:54,305][root][INFO] - Peft model loaded successfully
[2025-02-21 00:58:01,661][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:58:01,663][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:58:01,663][root][INFO] - Starting inference
[2025-02-21 00:58:01,792][root][INFO] - Processing question number 0
[2025-02-21 00:58:01,794][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:58:09,794][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:58:25,381][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:58:38,256][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:59:09,764][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:59:20,607][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:59:34,337][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:59:55,967][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:00:08,383][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:00:16,123][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:00:26,651][root][INFO] - Processing question number 10
[2025-02-21 01:00:26,653][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:00:59,287][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:01:13,216][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:01:20,741][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:01:26,982][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:01:38,767][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:01:53,810][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:02:05,797][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:02:13,723][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:02:27,490][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:02:35,986][root][INFO] - Processing question number 20
[2025-02-21 01:02:35,988][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:02:44,091][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:02:55,351][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:03:02,382][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:03:10,343][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:03:16,830][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:03:32,850][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:03:45,448][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:03:58,860][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:04:10,237][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:04:19,318][root][INFO] - Processing question number 30
[2025-02-21 01:04:19,320][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:04:32,665][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:04:39,848][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:04:57,060][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:05:08,006][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:05:17,941][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:05:28,861][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:05:37,918][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:05:49,410][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:05:57,418][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:06:15,838][root][INFO] - Processing question number 40
[2025-02-21 01:06:15,841][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:06:24,965][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:06:37,446][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:06:51,253][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:07:13,375][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:07:22,616][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:07:36,175][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:07:45,681][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:07:56,408][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:08:04,240][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:08:14,852][root][INFO] - Processing question number 50
[2025-02-21 01:08:14,856][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:08:23,694][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:08:32,219][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:08:43,410][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:09:03,025][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:09:17,280][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:09:30,008][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:09:42,371][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:09:51,723][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:10:04,803][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:10:13,320][root][INFO] - Processing question number 60
[2025-02-21 01:10:13,325][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:10:19,930][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:10:32,811][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:10:46,474][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:10:56,021][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:11:07,505][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:11:19,182][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:11:30,776][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:11:43,870][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:11:54,530][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:12:11,761][root][INFO] - Processing question number 70
[2025-02-21 01:12:11,766][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:12:24,902][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:12:37,780][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:12:49,952][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:13:16,966][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:13:26,928][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:13:57,887][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:14:05,682][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:14:13,158][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:14:23,395][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:14:32,251][root][INFO] - Processing question number 80
[2025-02-21 01:14:32,255][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:14:42,233][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:14:52,853][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:15:07,180][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:15:19,599][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:15:38,374][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:15:48,568][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:16:20,166][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:16:51,296][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:17:02,358][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:17:11,441][root][INFO] - Processing question number 90
[2025-02-21 01:17:11,446][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:17:28,919][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:17:39,903][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:17:50,615][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:18:03,815][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:18:17,507][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:18:27,950][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:18:36,315][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:18:50,025][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:18:56,131][root][INFO] - Inference complete
[2025-02-21 01:18:56,131][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,137][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,138][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:18:56,138][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:18:56,138][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:18:56,139][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:18:56,139][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:18:56,140][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:18:56,141][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:18:56,141][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:18:56,141][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:18:56,141][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,141][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,142][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,142][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,142][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,143][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:18:56,143][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 01:18:56,143][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 01:18:56,143][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 01:18:56,144][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 01:18:56,144][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:18:56,146][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 01:18:56,146][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 01:18:56,146][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 01:18:56,147][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 01:18:56,147][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 01:18:56,147][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,148][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,148][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,148][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,149][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,149][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:18:56,150][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,155][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,155][root][INFO] - Saved parsed outputs
[2025-02-21 01:18:56,155][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,157][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,157][root][INFO] - Saved parsing metadata
[2025-02-21 01:18:56,158][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,159][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:18:56,161][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:18:56,178][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:18:56,178][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 0, 'malformed_domain': 32, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 13, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 01:19:03,225][root][INFO] - Setting global seed to 206
[2025-02-21 01:19:03,230][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:19:03,231][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:19:03,232][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:19:03,234][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:19:03,236][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:19:03,236][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:19:03,379][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:19:03,922][root][INFO] - Full model selected, loading model
[2025-02-21 01:19:26,764][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:19:26,787][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:19:34,481][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:19:34,482][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:19:34,482][root][INFO] - Starting inference
[2025-02-21 01:19:34,657][root][INFO] - Processing question number 0
[2025-02-21 01:19:34,660][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:19:50,418][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:20:01,603][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:20:10,973][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:20:27,762][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:20:42,526][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:20:55,882][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:21:08,084][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:21:19,481][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:21:26,964][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:21:39,182][root][INFO] - Processing question number 10
[2025-02-21 01:21:39,184][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:21:47,942][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:21:56,563][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:22:08,305][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:22:26,696][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:22:34,259][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:22:46,284][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:22:58,359][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:23:11,310][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:23:19,320][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:23:35,084][root][INFO] - Processing question number 20
[2025-02-21 01:23:35,095][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:23:42,989][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:23:53,831][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:24:03,206][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:24:12,823][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:24:22,134][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:24:33,362][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:24:41,977][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:24:53,816][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:25:04,781][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:25:13,160][root][INFO] - Processing question number 30
[2025-02-21 01:25:13,164][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:25:26,140][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:25:35,170][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:25:47,338][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:26:01,721][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:26:12,886][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:26:19,718][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:26:29,459][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:26:47,890][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:26:59,178][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:27:11,706][root][INFO] - Processing question number 40
[2025-02-21 01:27:11,709][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:27:21,614][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:27:35,328][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:27:48,041][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:28:00,958][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:28:11,165][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:28:23,894][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:28:34,915][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:28:48,487][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:28:58,683][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:29:08,025][root][INFO] - Processing question number 50
[2025-02-21 01:29:08,028][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:29:17,904][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:29:31,682][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:29:42,812][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:29:55,409][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:30:10,813][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:30:29,269][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:30:39,445][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:30:50,047][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:31:00,197][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:31:10,843][root][INFO] - Processing question number 60
[2025-02-21 01:31:10,847][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:31:19,353][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:31:27,196][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:31:37,216][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:31:46,550][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:31:58,727][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:32:08,489][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:32:17,823][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:32:29,436][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:32:38,531][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:32:49,293][root][INFO] - Processing question number 70
[2025-02-21 01:32:49,297][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:32:58,920][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:33:07,698][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:33:16,968][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:33:27,227][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:33:38,987][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:33:48,676][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:33:58,518][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:34:09,827][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:34:19,453][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:34:26,962][root][INFO] - Processing question number 80
[2025-02-21 01:34:26,967][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:34:35,663][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:34:44,667][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:34:56,171][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:35:05,290][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:35:16,335][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:35:29,440][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:35:41,785][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:35:52,349][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:36:00,197][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:36:18,648][root][INFO] - Processing question number 90
[2025-02-21 01:36:18,653][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:36:34,402][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:36:45,177][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:36:53,936][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:37:06,822][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:37:22,286][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:37:30,284][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:37:38,956][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:37:53,962][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:38:07,663][root][INFO] - Inference complete
[2025-02-21 01:38:07,663][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,669][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,670][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:38:07,670][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:38:07,670][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,670][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,670][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:38:07,670][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:38:07,671][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:38:07,671][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,671][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:38:07,671][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,671][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:38:07,671][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,671][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,671][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:38:07,671][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,671][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:38:07,672][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,672][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:38:07,672][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,672][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:38:07,672][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:38:07,672][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:38:07,672][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,672][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:38:07,672][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:38:07,673][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:38:07,673][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:38:07,673][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,673][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:38:07,673][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,674][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:38:07,674][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,675][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:38:07,675][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,675][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:38:07,675][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:38:07,675][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:38:07,675][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,675][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:38:07,675][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,675][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:38:07,675][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:38:07,676][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:38:07,676][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:38:07,676][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,676][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:38:07,677][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:38:07,677][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,677][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:38:07,677][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,677][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:38:07,677][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:38:07,677][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:38:07,677][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:38:07,677][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:38:07,678][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:38:07,678][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:38:07,678][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,678][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:38:07,679][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:38:07,679][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:38:07,679][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 01:38:07,679][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,680][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,680][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,680][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,680][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,680][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:38:07,680][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,681][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:38:07,681][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:38:07,681][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:38:07,681][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,681][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,681][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:38:07,681][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,681][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,681][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,682][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:38:07,682][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,682][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,682][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:38:07,682][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,683][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:38:07,683][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:38:07,684][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:38:07,684][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:38:07,684][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:38:07,684][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 01:38:07,684][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:38:07,685][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,685][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:38:07,685][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,685][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,685][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:38:07,685][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:38:07,685][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:38:07,685][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,685][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:38:07,686][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:38:07,686][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:38:07,686][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,686][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:38:07,686][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:38:07,687][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,692][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,692][root][INFO] - Saved parsed outputs
[2025-02-21 01:38:07,692][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,693][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,693][root][INFO] - Saved parsing metadata
[2025-02-21 01:38:07,694][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,695][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:38:07,697][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:38:07,709][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:38:07,709][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.0, 'malformed_label': 11, 'malformed_domain': 97, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 49, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 01:38:14,312][root][INFO] - Setting global seed to 989
[2025-02-21 01:38:14,317][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:38:14,317][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:38:14,319][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:38:14,322][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:38:14,324][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:38:14,324][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:38:14,480][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:38:14,996][root][INFO] - Full model selected, loading model
[2025-02-21 01:38:28,378][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:40:10,446][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:40:10,458][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:40:41,666][root][INFO] - Peft model loaded successfully
[2025-02-21 01:40:49,046][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:40:49,048][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:40:49,048][root][INFO] - Starting inference
[2025-02-21 01:40:49,199][root][INFO] - Processing question number 0
[2025-02-21 01:40:49,201][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:41:01,596][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:41:17,117][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:41:24,374][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:41:55,620][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:42:02,045][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:42:32,911][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:42:42,581][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:43:13,552][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:43:21,865][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:43:28,690][root][INFO] - Processing question number 10
[2025-02-21 01:43:28,691][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:44:01,071][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:44:13,058][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:44:25,164][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:44:37,742][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:44:46,650][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:44:58,345][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:45:28,961][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:45:44,579][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:46:15,536][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:46:29,653][root][INFO] - Processing question number 20
[2025-02-21 01:46:29,655][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:46:37,936][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:46:49,561][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:47:20,207][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:47:50,857][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:48:22,152][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:48:29,955][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:49:01,596][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:49:32,574][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:50:03,597][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:50:11,338][root][INFO] - Processing question number 30
[2025-02-21 01:50:11,342][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:50:20,899][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:50:30,715][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:50:43,003][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:50:56,749][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:51:03,863][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:51:15,231][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:51:27,990][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:51:43,098][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:51:51,879][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:52:00,806][root][INFO] - Processing question number 40
[2025-02-21 01:52:00,809][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:52:15,242][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:52:26,333][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:52:45,324][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:53:16,709][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:53:27,047][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:53:58,097][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:54:07,527][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:54:18,607][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:54:49,568][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:54:59,449][root][INFO] - Processing question number 50
[2025-02-21 01:54:59,452][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:55:07,717][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:55:19,712][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:55:29,980][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:56:01,792][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:56:32,823][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:56:44,521][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:56:54,974][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:57:12,131][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:57:19,066][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:57:50,915][root][INFO] - Processing question number 60
[2025-02-21 01:57:50,923][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:57:57,499][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:58:28,382][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:58:59,706][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:59:07,761][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:59:20,404][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:59:51,427][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:00:11,190][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:00:42,350][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:00:49,607][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:00:56,673][root][INFO] - Processing question number 70
[2025-02-21 02:00:56,677][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:01:08,965][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:01:17,568][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:01:25,425][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:01:36,051][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:02:07,323][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:02:38,031][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:02:49,001][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:03:01,486][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:03:10,799][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:03:41,725][root][INFO] - Processing question number 80
[2025-02-21 02:03:41,730][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:03:51,081][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:04:22,360][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:04:29,815][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:04:43,920][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:05:15,300][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:05:46,655][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:06:18,009][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:06:48,892][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:07:19,990][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:07:50,610][root][INFO] - Processing question number 90
[2025-02-21 02:07:50,615][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:08:22,240][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:08:52,487][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:09:05,508][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:09:11,593][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:09:25,072][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:09:55,723][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:10:26,557][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:10:34,937][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:11:06,327][root][INFO] - Inference complete
[2025-02-21 02:11:06,328][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,334][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,335][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,336][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,336][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,336][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,336][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,337][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:11:06,337][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,338][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,338][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,338][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,339][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,339][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,339][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,339][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:11:06,340][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,340][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,340][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,340][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,341][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,341][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,341][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,341][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,341][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:11:06,342][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,342][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,342][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,342][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,343][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,343][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,343][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,343][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 02:11:06,343][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,344][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,344][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,344][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,345][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,345][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,345][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,345][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:11:06,346][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,346][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,346][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,346][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,346][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,347][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,347][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,347][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,347][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,347][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,348][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 02:11:06,348][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,348][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,348][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,349][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,349][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,349][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,349][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,349][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,350][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,350][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:11:06,351][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,356][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,356][root][INFO] - Saved parsed outputs
[2025-02-21 02:11:06,356][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,357][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,357][root][INFO] - Saved parsing metadata
[2025-02-21 02:11:06,358][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,360][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:06,361][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:11:06,371][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:11:06,371][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 13, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 02:11:14,121][root][INFO] - Setting global seed to 989
[2025-02-21 02:11:14,129][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:11:14,129][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:11:14,130][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:11:14,132][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:11:14,133][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:11:14,134][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:11:14,308][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:11:14,834][root][INFO] - Full model selected, loading model
[2025-02-21 02:11:32,340][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:11:32,340][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:11:39,991][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:11:39,992][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:11:39,992][root][INFO] - Starting inference
[2025-02-21 02:11:40,125][root][INFO] - Processing question number 0
[2025-02-21 02:11:40,127][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:11:53,569][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:12:03,915][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:12:10,417][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:12:25,551][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:12:36,721][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:12:50,528][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:13:00,090][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:13:18,532][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:13:26,400][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:13:39,335][root][INFO] - Processing question number 10
[2025-02-21 02:13:39,337][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:13:50,388][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:13:59,145][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:14:08,222][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:14:16,042][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:14:24,096][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:14:36,086][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:14:45,577][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:14:56,843][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:15:03,771][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:15:16,232][root][INFO] - Processing question number 20
[2025-02-21 02:15:16,234][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:15:30,698][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:15:39,627][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:15:55,655][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:16:05,253][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:16:14,794][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:16:25,842][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:16:39,596][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:16:49,962][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:17:06,803][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:17:20,276][root][INFO] - Processing question number 30
[2025-02-21 02:17:20,278][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:17:30,076][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:17:40,783][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:17:58,352][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:18:08,604][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:18:16,049][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:18:25,362][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:18:34,777][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:18:45,405][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:18:54,275][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:19:03,845][root][INFO] - Processing question number 40
[2025-02-21 02:19:03,847][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:19:14,229][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:19:24,057][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:19:34,867][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:19:43,392][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:19:58,392][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:20:09,931][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:20:19,248][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:20:29,248][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:20:38,281][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:20:50,000][root][INFO] - Processing question number 50
[2025-02-21 02:20:50,004][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:21:01,068][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:21:15,049][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:21:23,995][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:21:35,685][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:21:49,017][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:22:04,205][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:22:14,202][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:22:28,160][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:22:42,134][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:22:50,880][root][INFO] - Processing question number 60
[2025-02-21 02:22:50,884][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:22:59,084][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:23:08,733][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:23:40,037][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:23:48,621][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:23:59,166][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:24:13,935][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:24:26,431][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:24:37,212][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:24:45,199][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:24:56,425][root][INFO] - Processing question number 70
[2025-02-21 02:24:56,429][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:25:07,434][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:25:17,886][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:25:25,925][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:25:36,061][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:25:46,438][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:25:53,620][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:26:04,944][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:26:16,249][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:26:24,924][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:26:32,737][root][INFO] - Processing question number 80
[2025-02-21 02:26:32,741][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:26:42,670][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:26:55,518][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:27:07,856][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:27:19,253][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:27:30,116][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:27:41,471][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:27:51,272][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:28:02,513][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:28:12,800][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:28:21,976][root][INFO] - Processing question number 90
[2025-02-21 02:28:21,981][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:28:36,203][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:28:49,118][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:29:06,635][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:29:16,608][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:29:28,663][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:29:34,710][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:29:43,071][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:29:52,927][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:30:02,960][root][INFO] - Inference complete
[2025-02-21 02:30:02,960][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,966][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,967][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:30:02,967][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,967][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:30:02,967][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,967][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:30:02,967][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,967][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:30:02,968][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:30:02,968][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:30:02,968][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:30:02,968][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,968][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,969][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,969][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,969][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,969][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,969][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:30:02,969][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,970][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:30:02,970][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:30:02,970][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:30:02,970][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,970][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:30:02,970][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,970][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:30:02,970][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,970][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:30:02,970][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:30:02,971][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:30:02,971][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:30:02,971][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,971][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:30:02,971][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:30:02,972][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:30:02,972][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,972][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:30:02,973][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,973][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:30:02,973][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:30:02,973][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,973][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:30:02,973][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,973][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:30:02,973][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,973][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:30:02,973][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:30:02,974][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:30:02,974][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:30:02,974][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:30:02,974][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:30:02,974][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,974][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:30:02,975][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,975][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:30:02,975][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:30:02,975][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:30:02,975][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,975][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:30:02,975][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,975][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:30:02,975][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,975][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:30:02,976][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,976][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:30:02,976][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,976][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:30:02,976][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,976][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:30:02,976][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,976][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:30:02,976][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,976][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:30:02,977][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,977][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:30:02,977][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,977][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:30:02,977][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,977][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:30:02,977][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,977][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:30:02,977][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 02:30:02,977][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:30:02,978][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:30:02,978][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:30:02,978][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,978][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:30:02,978][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,978][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:30:02,978][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,978][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:30:02,979][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,979][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:30:02,979][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,979][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:30:02,979][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,979][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:30:02,979][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:30:02,979][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,979][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:30:02,979][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,980][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:30:02,980][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,980][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:30:02,980][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,980][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:30:02,980][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,980][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:30:02,980][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:30:02,980][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:30:02,980][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,981][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:30:02,981][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,981][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:30:02,981][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,981][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:30:02,981][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,981][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:30:02,981][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,981][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:30:02,981][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:30:02,982][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:30:02,982][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:30:02,982][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:30:02,982][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:30:02,982][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,982][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,983][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,983][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 02:30:02,983][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,983][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,983][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:30:02,983][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:30:02,984][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:30:02,984][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,984][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:30:02,984][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,985][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:30:02,985][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,985][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:30:02,985][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,985][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:30:02,985][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,985][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:30:02,985][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:30:02,986][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,991][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,991][root][INFO] - Saved parsed outputs
[2025-02-21 02:30:02,992][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,993][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,993][root][INFO] - Saved parsing metadata
[2025-02-21 02:30:02,994][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,995][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:30:02,997][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:30:03,022][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:30:03,022][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 53, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 02:30:10,612][root][INFO] - Setting global seed to 989
[2025-02-21 02:30:10,619][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:30:10,619][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:30:10,621][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:30:10,622][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:30:10,625][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:30:10,625][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:30:10,768][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:30:11,302][root][INFO] - Full model selected, loading model
[2025-02-21 02:30:25,588][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:32:09,360][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:32:09,380][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:32:41,049][root][INFO] - Peft model loaded successfully
[2025-02-21 02:32:48,357][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:32:48,359][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:32:48,359][root][INFO] - Starting inference
[2025-02-21 02:32:48,522][root][INFO] - Processing question number 0
[2025-02-21 02:32:48,525][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:33:03,983][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:33:35,644][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:33:42,492][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:34:14,094][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:34:22,514][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:34:38,794][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:35:10,471][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:35:21,049][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:35:29,544][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:35:36,482][root][INFO] - Processing question number 10
[2025-02-21 02:35:36,484][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:36:09,156][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:36:20,466][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:36:51,713][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:37:00,864][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:37:11,258][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:37:25,717][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:37:37,969][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:38:09,278][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:38:18,316][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:38:30,178][root][INFO] - Processing question number 20
[2025-02-21 02:38:30,181][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:38:38,104][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:39:09,626][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:39:27,994][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:39:40,511][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:40:12,043][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:40:18,833][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:40:27,726][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:40:58,971][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:41:11,365][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:41:19,029][root][INFO] - Processing question number 30
[2025-02-21 02:41:19,032][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:41:50,400][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:41:59,659][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:42:15,233][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:42:30,796][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:42:38,325][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:42:50,704][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:43:21,965][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:43:34,429][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:43:41,011][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:43:50,085][root][INFO] - Processing question number 40
[2025-02-21 02:43:50,088][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:44:01,949][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:44:12,094][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:44:21,560][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:44:30,547][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:44:40,252][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:45:11,582][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:45:43,731][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:45:54,456][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:46:04,911][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:46:16,162][root][INFO] - Processing question number 50
[2025-02-21 02:46:16,166][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:46:48,090][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:47:04,824][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:47:18,465][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:47:34,528][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:48:05,924][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:48:36,516][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:48:47,221][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:49:01,019][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:49:10,829][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:49:42,914][root][INFO] - Processing question number 60
[2025-02-21 02:49:42,918][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:49:52,387][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:50:00,254][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:50:17,576][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:50:26,198][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:50:36,546][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:50:46,296][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:50:53,530][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:51:04,559][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:51:12,153][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:51:22,236][root][INFO] - Processing question number 70
[2025-02-21 02:51:22,240][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:51:34,203][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:51:43,178][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:51:50,073][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:52:21,692][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:52:38,674][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:52:52,079][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:53:02,851][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:53:18,408][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:53:30,220][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:53:43,088][root][INFO] - Processing question number 80
[2025-02-21 02:53:43,093][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:53:52,831][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:54:05,230][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:54:13,590][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:54:23,177][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:54:36,803][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:55:08,476][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:55:32,283][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:56:03,474][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:56:15,249][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:56:21,108][root][INFO] - Processing question number 90
[2025-02-21 02:56:21,113][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:56:53,011][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:57:23,539][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:57:33,759][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:57:47,579][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:57:59,548][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:58:12,220][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:58:23,095][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:58:30,757][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:58:39,085][root][INFO] - Inference complete
[2025-02-21 02:58:39,086][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,092][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,093][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:58:39,093][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:58:39,094][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:58:39,094][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:58:39,094][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:58:39,095][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,095][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,096][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,096][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,096][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,097][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:58:39,097][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,097][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,097][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,097][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,098][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,098][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,098][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,098][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:58:39,099][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,099][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,099][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,100][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,100][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,100][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,100][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,100][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,101][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 02:58:39,101][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:58:39,101][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:58:39,102][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,102][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,103][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,103][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,103][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,103][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,104][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,104][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,104][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 02:58:39,104][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,104][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,105][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,105][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,105][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,105][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:58:39,106][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,111][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,111][root][INFO] - Saved parsed outputs
[2025-02-21 02:58:39,111][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,113][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,113][root][INFO] - Saved parsing metadata
[2025-02-21 02:58:39,113][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,115][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:39,116][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:58:39,132][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:58:39,132][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 11, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 02:58:45,786][root][INFO] - Setting global seed to 989
[2025-02-21 02:58:45,791][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:58:45,791][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:58:45,793][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:58:45,794][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:58:45,796][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:58:45,796][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:58:46,177][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:58:46,826][root][INFO] - Full model selected, loading model
[2025-02-21 02:59:04,130][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:59:04,130][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:59:11,774][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:59:11,776][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:59:11,776][root][INFO] - Starting inference
[2025-02-21 02:59:11,935][root][INFO] - Processing question number 0
[2025-02-21 02:59:11,937][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:59:23,536][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:59:33,258][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:59:42,036][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:59:58,333][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:00:07,223][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:00:20,102][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:00:30,003][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:00:39,868][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:00:48,449][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:01:00,187][root][INFO] - Processing question number 10
[2025-02-21 03:01:00,189][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:01:09,735][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:01:20,890][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:01:30,903][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:01:44,963][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:01:54,341][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:02:05,994][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:02:18,541][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:02:30,671][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:02:39,045][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:02:55,041][root][INFO] - Processing question number 20
[2025-02-21 03:02:55,043][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:03:03,719][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:03:13,597][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:03:24,144][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:03:34,442][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:03:45,491][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:03:56,697][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:04:07,724][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:04:18,663][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:04:33,828][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:04:48,074][root][INFO] - Processing question number 30
[2025-02-21 03:04:48,076][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:05:01,236][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:05:10,331][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:05:22,110][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:05:34,557][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:05:45,939][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:05:55,328][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:06:08,381][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:06:20,265][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:06:28,615][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:06:37,457][root][INFO] - Processing question number 40
[2025-02-21 03:06:37,460][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:06:46,876][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:07:01,274][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:07:14,207][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:07:22,998][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:07:42,463][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:07:52,205][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:08:01,501][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:08:10,562][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:08:17,992][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:08:28,302][root][INFO] - Processing question number 50
[2025-02-21 03:08:28,305][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:08:37,637][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:08:50,026][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:09:01,919][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:09:16,285][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:09:26,624][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:09:44,817][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:09:57,854][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:10:09,034][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:10:22,322][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:10:32,572][root][INFO] - Processing question number 60
[2025-02-21 03:10:32,576][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:10:40,755][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:10:47,774][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:10:59,772][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:11:10,404][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:11:20,545][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:11:31,429][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:11:45,248][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:11:56,228][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:12:05,187][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:12:14,357][root][INFO] - Processing question number 70
[2025-02-21 03:12:14,361][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:12:24,800][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:12:35,027][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:12:42,583][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:12:54,926][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:13:05,797][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:13:15,751][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:13:29,104][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:13:44,079][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:13:53,215][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:14:02,422][root][INFO] - Processing question number 80
[2025-02-21 03:14:02,427][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:14:19,544][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:14:27,910][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:14:36,900][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:14:46,182][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:14:58,611][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:15:08,403][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:15:20,007][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:15:29,542][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:15:38,302][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:15:46,651][root][INFO] - Processing question number 90
[2025-02-21 03:15:46,656][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:15:56,950][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:16:06,475][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:16:17,492][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:16:27,644][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:16:40,779][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:16:47,320][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:16:56,649][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:17:07,897][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:17:21,210][root][INFO] - Inference complete
[2025-02-21 03:17:21,211][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,217][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,218][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:17:21,218][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,218][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:17:21,218][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:17:21,219][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:17:21,219][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:17:21,219][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:17:21,219][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,219][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,220][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,220][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,220][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,220][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,220][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:17:21,220][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:17:21,221][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:17:21,221][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:17:21,221][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:17:21,221][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,221][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:17:21,222][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,222][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:17:21,222][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:17:21,222][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,222][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:17:21,222][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,222][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:17:21,222][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,222][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:17:21,222][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:17:21,223][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:17:21,223][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:17:21,223][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:17:21,223][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:17:21,223][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:17:21,224][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:17:21,224][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,224][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:17:21,224][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,224][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:17:21,224][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,224][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:17:21,224][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,224][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:17:21,224][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:17:21,225][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:17:21,225][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:17:21,225][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:17:21,225][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,225][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:17:21,225][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:17:21,226][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:17:21,226][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:17:21,226][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,226][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:17:21,226][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:17:21,227][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:17:21,227][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:17:21,227][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:17:21,227][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:17:21,227][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,227][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:17:21,228][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,228][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:17:21,228][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,228][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:17:21,228][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,228][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:17:21,228][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:17:21,228][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:17:21,228][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:17:21,228][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:17:21,229][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:17:21,229][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:17:21,229][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:17:21,229][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:17:21,229][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:17:21,230][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:17:21,230][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:17:21,230][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:17:21,230][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:17:21,230][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,230][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,231][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,231][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:17:21,231][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,231][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,231][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:17:21,231][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:17:21,232][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:17:21,232][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:17:21,232][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:17:21,232][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:17:21,232][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,232][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:17:21,233][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:17:21,233][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,233][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:17:21,233][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,233][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:17:21,233][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,233][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:17:21,233][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,233][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:17:21,233][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,234][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:17:21,234][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:17:21,235][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:17:21,235][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:17:21,235][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:17:21,235][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:17:21,235][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,235][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:17:21,236][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,236][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:17:21,236][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:17:21,237][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,242][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,242][root][INFO] - Saved parsed outputs
[2025-02-21 03:17:21,242][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,243][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,243][root][INFO] - Saved parsing metadata
[2025-02-21 03:17:21,244][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,245][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:17:21,247][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:17:21,259][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:17:21,259][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 51, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 03:17:27,807][root][INFO] - Setting global seed to 989
[2025-02-21 03:17:27,812][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:17:27,812][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:17:27,813][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:17:27,816][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:17:27,818][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:17:27,818][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:17:27,992][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:17:28,547][root][INFO] - Full model selected, loading model
[2025-02-21 03:17:47,423][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:19:30,434][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:19:30,435][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:20:02,127][root][INFO] - Peft model loaded successfully
[2025-02-21 03:20:09,564][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:20:09,565][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:20:09,565][root][INFO] - Starting inference
[2025-02-21 03:20:09,724][root][INFO] - Processing question number 0
[2025-02-21 03:20:09,727][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:20:19,373][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:20:33,460][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:21:04,560][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:21:14,678][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:21:23,924][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:21:35,859][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:21:43,757][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:21:55,232][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:22:04,412][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:22:13,045][root][INFO] - Processing question number 10
[2025-02-21 03:22:13,047][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:22:45,721][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:23:09,941][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:23:16,737][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:23:23,990][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:23:34,939][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:23:43,296][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:23:51,702][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:24:00,778][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:24:08,712][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:24:16,725][root][INFO] - Processing question number 20
[2025-02-21 03:24:16,727][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:24:24,994][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:24:40,369][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:24:48,398][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:24:56,859][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:25:10,073][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:25:19,334][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:25:31,702][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:25:39,880][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:25:57,667][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:26:07,749][root][INFO] - Processing question number 30
[2025-02-21 03:26:07,751][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:26:23,809][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:26:41,877][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:26:53,624][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:27:04,781][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:27:12,404][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:27:21,212][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:27:29,142][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:27:38,877][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:27:45,853][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:27:53,752][root][INFO] - Processing question number 40
[2025-02-21 03:27:53,756][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:28:00,498][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:28:10,930][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:28:21,145][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:28:52,828][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:29:04,675][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:29:17,841][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:29:27,055][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:29:44,533][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:29:56,118][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:30:08,079][root][INFO] - Processing question number 50
[2025-02-21 03:30:08,083][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:30:21,175][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:30:30,066][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:30:40,984][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:31:13,108][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:31:23,407][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:31:32,655][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:31:46,531][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:32:02,137][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:32:11,398][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:32:43,488][root][INFO] - Processing question number 60
[2025-02-21 03:32:43,492][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:32:54,902][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:33:08,766][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:33:17,958][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:33:29,650][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:33:42,919][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:34:09,839][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:34:21,558][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:34:31,602][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:34:37,692][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:34:47,075][root][INFO] - Processing question number 70
[2025-02-21 03:34:47,080][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:34:56,484][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:35:05,686][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:35:15,079][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:35:29,876][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:35:42,425][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:35:53,578][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:36:01,139][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:36:10,531][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:36:20,282][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:36:31,951][root][INFO] - Processing question number 80
[2025-02-21 03:36:31,955][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:36:41,647][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:36:57,829][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:37:07,525][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:37:17,514][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:37:30,363][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:37:41,683][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:37:57,213][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:38:13,422][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:38:27,984][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:38:37,132][root][INFO] - Processing question number 90
[2025-02-21 03:38:37,137][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:38:48,671][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:39:04,378][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:39:14,156][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:39:20,252][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:39:33,964][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:39:43,368][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:39:55,499][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:40:26,845][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:40:42,175][root][INFO] - Inference complete
[2025-02-21 03:40:42,175][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,181][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,182][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:40:42,183][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:40:42,183][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:40:42,184][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:40:42,185][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:40:42,185][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:40:42,185][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:40:42,185][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:40:42,186][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,186][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,186][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,186][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,187][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,187][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:40:42,187][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,187][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,188][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,189][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,189][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:40:42,189][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:40:42,189][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:40:42,189][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:40:42,190][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:40:42,191][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,191][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,191][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,191][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,192][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,193][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,193][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,193][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,194][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:40:42,194][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,199][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,199][root][INFO] - Saved parsed outputs
[2025-02-21 03:40:42,200][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,201][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,201][root][INFO] - Saved parsing metadata
[2025-02-21 03:40:42,201][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,203][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:40:42,205][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:40:42,243][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:40:42,243][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.09090909090909091, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 14, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 03:40:50,199][root][INFO] - Setting global seed to 989
[2025-02-21 03:40:50,205][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:40:50,206][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:40:50,207][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:40:50,209][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:40:50,211][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:40:50,212][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:40:50,351][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:40:50,885][root][INFO] - Full model selected, loading model
[2025-02-21 03:41:04,862][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:41:04,862][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:41:12,409][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:41:12,410][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:41:12,410][root][INFO] - Starting inference
[2025-02-21 03:41:12,548][root][INFO] - Processing question number 0
[2025-02-21 03:41:12,552][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:41:25,634][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:41:33,903][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:42:00,758][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:42:15,827][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:42:24,769][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:42:35,294][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:42:46,809][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:42:57,021][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:43:05,308][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:43:13,581][root][INFO] - Processing question number 10
[2025-02-21 03:43:13,583][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:43:22,048][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:43:38,296][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:43:48,355][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:43:55,944][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:44:04,773][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:44:20,133][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:44:39,687][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:44:49,851][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:44:57,137][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:45:10,467][root][INFO] - Processing question number 20
[2025-02-21 03:45:10,469][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:45:20,558][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:45:37,250][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:45:46,249][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:45:54,064][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:46:04,096][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:46:15,843][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:46:30,700][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:46:39,212][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:46:51,956][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:46:59,128][root][INFO] - Processing question number 30
[2025-02-21 03:46:59,130][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:47:11,732][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:47:21,428][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:47:33,059][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:47:44,257][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:48:00,937][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:48:10,284][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:48:24,301][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:48:33,067][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:48:41,025][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:48:50,171][root][INFO] - Processing question number 40
[2025-02-21 03:48:50,174][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:49:02,158][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:49:13,078][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:49:25,455][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:49:33,803][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:49:44,585][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:49:54,438][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:50:05,945][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:50:17,129][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:50:25,505][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:50:34,014][root][INFO] - Processing question number 50
[2025-02-21 03:50:34,017][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:50:45,700][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:50:58,696][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:51:04,590][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:51:16,546][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:51:33,521][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:51:44,539][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:51:56,815][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:52:06,571][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:52:18,039][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:52:28,085][root][INFO] - Processing question number 60
[2025-02-21 03:52:28,089][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:52:39,431][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:52:46,549][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:52:59,616][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:53:08,084][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:53:16,377][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:53:28,062][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:53:37,160][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:53:47,688][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:53:56,799][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:54:04,222][root][INFO] - Processing question number 70
[2025-02-21 03:54:04,226][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:54:13,173][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:54:22,809][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:54:30,714][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:54:49,496][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:54:59,265][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:55:08,577][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:55:16,826][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:55:25,749][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:55:34,035][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:55:44,742][root][INFO] - Processing question number 80
[2025-02-21 03:55:44,747][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:55:57,783][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:56:09,421][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:56:17,954][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:56:30,772][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:56:41,285][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:56:48,770][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:56:59,117][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:57:14,773][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:57:25,386][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:57:36,018][root][INFO] - Processing question number 90
[2025-02-21 03:57:36,023][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:57:45,960][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:57:58,329][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:58:07,002][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:58:23,014][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:58:32,055][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:58:38,598][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:58:46,394][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:59:00,264][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:59:10,690][root][INFO] - Inference complete
[2025-02-21 03:59:10,690][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,696][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,697][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:59:10,698][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,698][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:59:10,698][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:59:10,698][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:59:10,698][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,698][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:59:10,698][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,698][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:59:10,698][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,699][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:59:10,699][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,699][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,699][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,699][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:59:10,699][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,699][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:59:10,699][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,700][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,700][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:59:10,700][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:59:10,700][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:59:10,700][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:59:10,700][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:59:10,700][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,700][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,700][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:59:10,701][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:59:10,701][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,701][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:59:10,701][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,701][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:59:10,701][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,701][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:59:10,701][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,701][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:59:10,701][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:59:10,702][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:59:10,702][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:59:10,702][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,702][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:59:10,702][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:59:10,703][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:59:10,703][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:59:10,703][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:59:10,703][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:59:10,703][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,704][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:59:10,704][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,704][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:59:10,704][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,704][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:59:10,704][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,704][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:59:10,704][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,704][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:59:10,705][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:59:10,705][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,705][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:59:10,705][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,705][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:59:10,705][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:59:10,705][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,705][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:59:10,705][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,705][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:59:10,706][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,706][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:59:10,706][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,706][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,706][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:59:10,706][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,706][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:59:10,706][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:59:10,706][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:59:10,707][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:59:10,707][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:59:10,707][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:59:10,707][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:59:10,707][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,707][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,708][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,708][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,708][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,708][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:59:10,708][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:59:10,709][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:59:10,709][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,710][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:59:10,710][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:59:10,711][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:59:10,711][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:59:10,711][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:59:10,711][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,711][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:59:10,712][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:59:10,712][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:59:10,712][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:59:10,712][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:59:10,712][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,712][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:59:10,713][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:59:10,713][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:59:10,713][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:59:10,713][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,713][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:59:10,714][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,714][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:59:10,714][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:59:10,714][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:59:10,715][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,719][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,719][root][INFO] - Saved parsed outputs
[2025-02-21 03:59:10,720][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,721][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,721][root][INFO] - Saved parsing metadata
[2025-02-21 03:59:10,721][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,723][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:59:10,732][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:59:10,746][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:59:10,746][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 4, 'malformed_domain': 94, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 48, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 03:59:17,206][root][INFO] - Setting global seed to 206
[2025-02-21 03:59:17,211][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:59:17,212][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:59:17,213][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:59:17,215][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:59:17,217][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:59:17,217][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:59:17,377][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:59:17,943][root][INFO] - Full model selected, loading model
[2025-02-21 03:59:39,890][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:01:23,103][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:01:23,103][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:01:55,814][root][INFO] - Peft model loaded successfully
[2025-02-21 04:02:03,291][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:02:03,292][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:03,292][root][INFO] - Starting inference
[2025-02-21 04:02:03,446][root][INFO] - Processing question number 0
[2025-02-21 04:02:03,448][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:02:13,263][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:02:44,804][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:02:57,849][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:03:29,190][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:03:45,890][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:03:54,584][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:04:25,479][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:04:31,989][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:04:39,135][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:04:54,433][root][INFO] - Processing question number 10
[2025-02-21 04:04:54,435][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:05:08,990][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:05:22,903][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:05:53,867][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:06:02,367][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:06:09,342][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:06:21,061][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:06:52,035][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:07:22,902][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:07:33,530][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:07:40,741][root][INFO] - Processing question number 20
[2025-02-21 04:07:40,744][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:08:11,096][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:08:42,233][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:08:54,062][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:09:04,593][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:09:16,711][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:09:47,982][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:10:18,879][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:10:29,085][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:10:42,019][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:10:51,487][root][INFO] - Processing question number 30
[2025-02-21 04:10:51,490][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:11:00,257][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:11:31,142][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:12:02,080][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:12:33,390][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:12:44,254][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:12:53,700][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:13:03,855][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:13:21,667][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:13:30,870][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:13:42,450][root][INFO] - Processing question number 40
[2025-02-21 04:13:42,453][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:13:56,456][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:14:07,288][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:14:20,879][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:14:28,894][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:14:42,669][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:14:51,232][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:15:01,947][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:15:12,886][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:15:43,901][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:16:15,211][root][INFO] - Processing question number 50
[2025-02-21 04:16:15,214][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:16:46,631][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:16:57,644][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:17:13,774][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:17:44,916][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:18:15,553][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:18:24,217][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:18:38,584][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:18:48,134][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:19:19,429][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:19:33,653][root][INFO] - Processing question number 60
[2025-02-21 04:19:33,658][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:19:42,428][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:19:52,564][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:20:24,396][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:20:55,713][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:21:07,004][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:21:38,036][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:21:50,025][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:21:59,329][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:22:06,633][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:22:24,722][root][INFO] - Processing question number 70
[2025-02-21 04:22:24,727][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:22:55,875][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:23:06,127][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:23:24,257][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:23:55,881][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:24:06,912][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:24:16,259][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:24:28,985][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:25:00,370][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:25:12,057][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:25:42,924][root][INFO] - Processing question number 80
[2025-02-21 04:25:42,929][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:25:50,255][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:26:02,708][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:26:34,161][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:26:46,151][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:26:57,589][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:27:06,419][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:27:18,506][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:27:50,150][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:27:59,249][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:28:30,275][root][INFO] - Processing question number 90
[2025-02-21 04:28:30,281][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:29:01,450][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:29:32,975][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:29:42,298][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:30:13,368][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:30:24,772][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:30:39,787][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:31:10,954][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:31:19,677][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:31:31,227][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:31:43,426][root][INFO] - Inference complete
[2025-02-21 04:31:43,427][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,434][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,435][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,435][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,436][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,436][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,436][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,436][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,436][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,437][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:31:43,437][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,437][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,438][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,438][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,438][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,439][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:31:43,439][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,439][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,439][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,439][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,440][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,440][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,440][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,440][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,440][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,441][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,441][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,441][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:31:43,442][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:31:43,442][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:31:43,442][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:31:43,443][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:31:43,443][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:31:43,443][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,443][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,444][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,444][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,444][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,445][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:31:43,445][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,446][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,446][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,446][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,446][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,446][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,447][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,448][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,448][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,448][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,448][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,448][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,449][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,449][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,449][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,449][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 04:31:43,450][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,455][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,456][root][INFO] - Saved parsed outputs
[2025-02-21 04:31:43,456][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,461][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,461][root][INFO] - Saved parsing metadata
[2025-02-21 04:31:43,462][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,464][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:31:43,468][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:31:43,496][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:31:43,496][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.37, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 37, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 23, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 04:31:50,792][root][INFO] - Setting global seed to 206
[2025-02-21 04:31:50,798][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:31:50,799][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:31:50,800][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:31:50,802][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:31:50,804][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:31:50,804][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:31:50,960][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:31:51,550][root][INFO] - Full model selected, loading model
[2025-02-21 04:32:13,570][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:32:13,586][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:32:21,252][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:32:21,254][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:32:21,254][root][INFO] - Starting inference
[2025-02-21 04:32:21,378][root][INFO] - Processing question number 0
[2025-02-21 04:32:21,382][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:32:30,863][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:32:41,446][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:32:51,727][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:33:00,473][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:33:11,436][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:33:25,016][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:33:34,462][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:33:43,571][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:33:55,340][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:34:04,453][root][INFO] - Processing question number 10
[2025-02-21 04:34:04,455][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:34:18,697][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:34:29,030][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:34:40,332][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:34:52,970][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:35:06,234][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:35:17,939][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:35:26,965][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:35:43,605][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:35:55,311][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:36:04,586][root][INFO] - Processing question number 20
[2025-02-21 04:36:04,589][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:36:11,960][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:36:21,444][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:36:30,594][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:36:40,373][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:36:49,415][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:37:01,886][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:37:13,013][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:37:29,446][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:37:39,189][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:37:51,333][root][INFO] - Processing question number 30
[2025-02-21 04:37:51,336][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:38:05,463][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:38:14,858][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:38:25,991][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:38:35,773][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:38:44,985][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:38:59,197][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:39:09,383][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:39:22,853][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:39:39,280][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:39:48,364][root][INFO] - Processing question number 40
[2025-02-21 04:39:48,368][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:40:19,283][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:40:33,624][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:40:43,943][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:40:51,904][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:41:06,924][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:41:14,982][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:41:24,821][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:41:35,571][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:41:49,579][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:42:00,906][root][INFO] - Processing question number 50
[2025-02-21 04:42:00,910][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:42:09,976][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:42:18,486][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:42:29,257][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:42:40,422][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:42:53,552][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:43:02,561][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:43:13,886][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:43:23,876][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:43:34,705][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:43:45,225][root][INFO] - Processing question number 60
[2025-02-21 04:43:45,229][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:43:56,516][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:44:07,052][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:44:19,723][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:44:30,907][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:44:43,176][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:44:53,952][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:45:02,148][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:45:17,764][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:45:29,873][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:45:40,669][root][INFO] - Processing question number 70
[2025-02-21 04:45:40,673][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:45:52,300][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:46:00,663][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:46:14,101][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:46:29,875][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:46:41,726][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:46:53,350][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:47:03,419][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:47:17,178][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:47:25,527][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:47:34,968][root][INFO] - Processing question number 80
[2025-02-21 04:47:34,973][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:47:44,666][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:47:52,958][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:48:01,246][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:48:12,235][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:48:22,854][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:48:31,872][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:48:47,338][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:48:59,011][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:49:12,025][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:49:30,798][root][INFO] - Processing question number 90
[2025-02-21 04:49:30,803][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:49:45,354][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:49:55,697][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:50:12,299][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:50:22,109][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:50:31,845][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:50:42,281][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:50:53,208][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:51:04,576][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:51:16,310][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:51:36,515][root][INFO] - Inference complete
[2025-02-21 04:51:36,516][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,522][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,522][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:51:36,523][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,523][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:51:36,523][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,523][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:51:36,523][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,523][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:51:36,523][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,523][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:51:36,523][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:51:36,524][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:51:36,524][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,524][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:51:36,524][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,524][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:51:36,524][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:51:36,524][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,524][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:51:36,525][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:51:36,525][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:51:36,525][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:51:36,525][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,525][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:51:36,526][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,526][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:51:36,526][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:51:36,526][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,526][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:51:36,526][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,526][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:51:36,526][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,526][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:51:36,526][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:51:36,527][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:51:36,527][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:51:36,527][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:51:36,527][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:51:36,527][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,527][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:51:36,528][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:51:36,528][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:51:36,528][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,528][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:51:36,528][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,528][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:51:36,528][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:51:36,528][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,528][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:51:36,528][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:51:36,529][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:51:36,529][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:51:36,529][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:51:36,529][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:51:36,529][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,529][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:51:36,530][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:51:36,530][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,530][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:51:36,530][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,530][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:51:36,530][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:51:36,530][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:51:36,530][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:51:36,530][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:51:36,531][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:51:36,531][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:51:36,531][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:51:36,531][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:51:36,531][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,531][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,532][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,532][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,532][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,532][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,532][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:51:36,532][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:51:36,533][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:51:36,533][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:51:36,533][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:51:36,533][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:51:36,533][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,533][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,534][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,534][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,534][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,534][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,534][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:51:36,534][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:51:36,535][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:51:36,535][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:51:36,535][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:51:36,535][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:51:36,535][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:51:36,535][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,536][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:51:36,536][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,536][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:51:36,536][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,536][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:51:36,536][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,536][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:51:36,536][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,536][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:51:36,536][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,537][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:51:36,537][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:51:36,538][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:51:36,538][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:51:36,538][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:51:36,538][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:51:36,538][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,538][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:51:36,539][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:51:36,539][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:51:36,539][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,539][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:51:36,540][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,540][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:51:36,540][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,540][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:51:36,540][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,540][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:51:36,540][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,540][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:51:36,540][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 04:51:36,540][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 04:51:36,541][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,546][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,546][root][INFO] - Saved parsed outputs
[2025-02-21 04:51:36,546][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,548][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,548][root][INFO] - Saved parsing metadata
[2025-02-21 04:51:36,549][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,550][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:36,552][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:51:36,567][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:51:36,567][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 04:51:43,347][root][INFO] - Setting global seed to 206
[2025-02-21 04:51:43,352][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:51:43,352][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:51:43,354][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:51:43,356][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:51:43,358][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:51:43,358][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:51:43,518][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:51:44,104][root][INFO] - Full model selected, loading model
[2025-02-21 04:52:05,203][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:53:47,038][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:53:47,039][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:54:21,789][root][INFO] - Peft model loaded successfully
[2025-02-21 04:54:29,629][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:54:29,631][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:54:29,631][root][INFO] - Starting inference
[2025-02-21 04:54:29,781][root][INFO] - Processing question number 0
[2025-02-21 04:54:29,783][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:54:47,817][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:55:01,489][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:55:33,330][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:55:42,314][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:55:54,378][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:56:25,178][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:56:56,329][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:57:09,130][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:57:23,302][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:57:34,602][root][INFO] - Processing question number 10
[2025-02-21 04:57:34,604][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:57:43,215][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:58:01,414][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:58:32,624][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:58:41,879][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:58:50,600][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:59:01,717][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:59:12,427][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:59:23,194][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:59:31,358][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:59:41,024][root][INFO] - Processing question number 20
[2025-02-21 04:59:41,027][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:59:48,570][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:00:19,960][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:00:50,992][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:01:00,813][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:01:09,349][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:01:20,477][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:01:29,468][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:01:40,448][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:01:49,741][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:02:21,356][root][INFO] - Processing question number 30
[2025-02-21 05:02:21,359][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:02:29,305][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:03:00,439][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:03:15,245][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:03:29,628][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:03:39,229][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:03:51,407][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:04:05,651][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:04:37,285][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:04:47,410][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:04:55,629][root][INFO] - Processing question number 40
[2025-02-21 05:04:55,633][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:05:26,874][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:05:41,299][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:06:06,718][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:06:37,314][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:06:53,091][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:07:02,313][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:07:10,759][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:07:17,575][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:07:32,729][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:08:04,283][root][INFO] - Processing question number 50
[2025-02-21 05:08:04,287][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:08:12,745][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:08:20,594][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:08:31,858][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:08:46,017][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:09:16,905][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:09:27,782][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:09:41,003][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:09:50,390][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:10:11,808][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:10:22,265][root][INFO] - Processing question number 60
[2025-02-21 05:10:22,269][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:10:34,458][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:10:44,984][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:10:55,797][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:11:09,092][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:11:25,710][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:11:57,023][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:12:07,864][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:12:38,769][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:12:52,554][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:13:02,069][root][INFO] - Processing question number 70
[2025-02-21 05:13:02,073][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:13:11,604][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:13:42,911][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:14:14,488][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:14:46,379][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:14:58,149][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:15:29,697][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:15:43,503][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:16:15,119][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:16:24,631][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:16:55,771][root][INFO] - Processing question number 80
[2025-02-21 05:16:55,776][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:17:27,378][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:17:45,214][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:17:58,898][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:18:30,295][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:18:40,139][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:18:53,742][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:19:05,677][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:19:19,408][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:19:28,177][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:19:59,456][root][INFO] - Processing question number 90
[2025-02-21 05:19:59,462][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:20:10,293][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:20:42,055][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:21:13,685][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:21:26,297][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:21:35,002][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:21:52,914][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:22:06,743][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:22:12,899][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:22:29,769][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:22:47,438][root][INFO] - Inference complete
[2025-02-21 05:22:47,438][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,445][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,446][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,446][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,446][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,447][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,447][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,447][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,448][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,448][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:22:47,448][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,448][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,449][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,449][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,449][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,450][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:22:47,450][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,450][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,450][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,450][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,451][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,452][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,452][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,452][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:22:47,452][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:22:47,453][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:22:47,453][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:22:47,454][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:22:47,455][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:22:47,455][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:22:47,456][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,456][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,456][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,456][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,456][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,457][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,457][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,457][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,457][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,457][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,458][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,458][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,458][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 05:22:47,458][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,458][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,459][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,459][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,459][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,459][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,459][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,460][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,460][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,460][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,460][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 05:22:47,461][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,466][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,466][root][INFO] - Saved parsed outputs
[2025-02-21 05:22:47,466][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,469][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,469][root][INFO] - Saved parsing metadata
[2025-02-21 05:22:47,470][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,471][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:22:47,474][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:22:47,489][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:22:47,489][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.37, 'malformed_label': 0, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 37, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.04, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 23, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 05:22:54,093][root][INFO] - Setting global seed to 206
[2025-02-21 05:22:54,098][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:22:54,098][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:22:54,100][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:22:54,101][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:22:54,103][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:22:54,103][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:22:54,250][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:22:54,815][root][INFO] - Full model selected, loading model
[2025-02-21 05:23:14,072][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:23:14,072][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:23:21,977][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:23:21,979][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:21,979][root][INFO] - Starting inference
[2025-02-21 05:23:22,144][root][INFO] - Processing question number 0
[2025-02-21 05:23:22,146][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:23:31,902][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:23:41,715][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:23:55,460][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:24:27,051][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:24:37,916][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:24:52,121][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:25:01,109][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:25:13,707][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:25:23,065][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:25:33,063][root][INFO] - Processing question number 10
[2025-02-21 05:25:33,065][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:25:49,038][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:26:00,021][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:26:09,998][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:26:18,773][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:26:32,623][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:26:43,137][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:26:54,095][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:27:08,718][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:27:19,631][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:27:30,351][root][INFO] - Processing question number 20
[2025-02-21 05:27:30,353][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:27:41,472][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:27:51,143][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:28:03,412][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:28:11,558][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:28:20,388][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:28:31,561][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:28:43,437][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:28:53,811][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:29:04,792][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:29:17,047][root][INFO] - Processing question number 30
[2025-02-21 05:29:17,050][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:29:25,979][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:29:35,456][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:29:46,391][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:29:57,014][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:30:09,711][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:30:20,131][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:30:32,209][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:30:42,455][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:30:51,477][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:31:02,796][root][INFO] - Processing question number 40
[2025-02-21 05:31:02,799][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:31:14,448][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:31:32,567][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:31:45,244][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:31:53,223][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:32:09,096][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:32:18,216][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:32:28,893][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:32:38,738][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:32:49,108][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:32:59,679][root][INFO] - Processing question number 50
[2025-02-21 05:32:59,682][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:33:07,976][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:33:15,623][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:33:28,040][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:33:38,664][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:33:52,606][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:34:03,173][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:34:14,642][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:34:24,213][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:34:33,126][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:34:47,154][root][INFO] - Processing question number 60
[2025-02-21 05:34:47,158][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:34:59,393][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:35:11,563][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:35:28,005][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:35:37,376][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:35:55,562][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:36:10,544][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:36:21,718][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:36:32,922][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:36:43,983][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:36:55,819][root][INFO] - Processing question number 70
[2025-02-21 05:36:55,823][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:37:12,376][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:37:27,544][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:37:40,334][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:37:55,324][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:38:07,329][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:38:17,392][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:38:28,212][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:38:42,041][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:38:48,797][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:38:56,157][root][INFO] - Processing question number 80
[2025-02-21 05:38:56,161][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:39:08,169][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:39:18,958][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:39:27,567][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:39:39,196][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:39:48,729][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:39:58,326][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:40:15,212][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:40:24,496][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:40:33,411][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:40:45,447][root][INFO] - Processing question number 90
[2025-02-21 05:40:45,452][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:40:55,524][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:41:06,287][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:41:23,381][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:41:31,190][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:41:41,115][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:41:57,159][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:42:06,779][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:42:17,647][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:42:28,394][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:42:45,212][root][INFO] - Inference complete
[2025-02-21 05:42:45,212][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,219][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,219][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:42:45,220][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,220][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:42:45,220][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,220][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:42:45,220][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,220][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 05:42:45,220][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:42:45,221][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:42:45,221][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:42:45,221][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,221][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:42:45,222][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:42:45,222][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:42:45,222][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:42:45,222][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:42:45,222][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:42:45,223][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,223][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:42:45,223][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,223][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:42:45,223][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:42:45,223][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,223][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:42:45,223][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,223][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:42:45,223][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:42:45,224][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:42:45,224][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:42:45,224][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:42:45,224][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:42:45,224][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,224][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,225][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:42:45,225][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,225][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,225][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,225][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:42:45,225][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,226][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:42:45,226][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,226][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:42:45,226][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,226][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:42:45,226][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,226][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:42:45,226][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,226][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:42:45,226][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:42:45,227][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:42:45,227][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:42:45,227][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:42:45,227][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:42:45,227][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:42:45,227][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:42:45,228][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:42:45,228][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,228][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:42:45,228][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,228][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:42:45,228][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,228][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:42:45,228][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,228][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:42:45,228][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,229][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,229][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:42:45,229][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,229][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:42:45,229][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,229][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:42:45,229][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,229][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:42:45,229][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 05:42:45,229][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:42:45,230][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:42:45,230][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:42:45,230][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:42:45,230][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:42:45,230][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,230][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:42:45,231][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:42:45,231][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,231][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:42:45,231][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,231][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:42:45,231][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,231][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:42:45,231][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,231][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:42:45,232][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:42:45,232][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:42:45,232][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:42:45,232][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:42:45,233][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:42:45,233][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,233][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:42:45,233][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,233][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:42:45,233][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,233][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:42:45,233][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,233][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:42:45,233][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:42:45,234][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:42:45,234][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:42:45,234][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:42:45,234][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:42:45,234][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,234][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,235][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,235][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,235][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 05:42:45,235][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,235][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:42:45,235][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:42:45,236][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:42:45,236][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 05:42:45,236][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:42:45,236][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:42:45,236][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:42:45,236][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:42:45,237][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:42:45,237][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:42:45,237][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:42:45,237][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 05:42:45,237][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:42:45,238][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,252][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,252][root][INFO] - Saved parsed outputs
[2025-02-21 05:42:45,253][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,254][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,254][root][INFO] - Saved parsing metadata
[2025-02-21 05:42:45,255][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,256][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:42:45,272][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:42:45,285][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:42:45,285][root][INFO] - Summary of metrics : {'label_accuracy': 0.5, 'misclassification_rate': 0.5, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 99, 'total_predictions': 100, 'correct_predictions': 50, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 50, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 05:42:51,686][root][INFO] - Setting global seed to 206
[2025-02-21 05:42:51,690][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:42:51,691][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:42:51,692][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:42:51,693][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:42:51,695][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:42:51,695][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:42:51,851][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:42:52,383][root][INFO] - Full model selected, loading model
[2025-02-21 05:43:13,514][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:44:56,662][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:44:56,664][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:45:29,895][root][INFO] - Peft model loaded successfully
[2025-02-21 05:45:37,740][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:45:37,742][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:45:37,742][root][INFO] - Starting inference
[2025-02-21 05:45:37,899][root][INFO] - Processing question number 0
[2025-02-21 05:45:37,912][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:46:02,456][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:46:11,140][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:46:25,499][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:46:36,589][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:46:46,908][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:46:55,765][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:47:26,956][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:47:41,097][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:47:48,741][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:48:01,841][root][INFO] - Processing question number 10
[2025-02-21 05:48:01,844][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:48:11,718][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:48:23,595][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:48:33,053][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:48:43,389][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:48:51,959][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:49:16,085][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:49:26,194][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:49:34,925][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:49:45,046][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:49:53,110][root][INFO] - Processing question number 20
[2025-02-21 05:49:53,113][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:50:23,689][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:50:32,013][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:50:39,232][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:50:45,750][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:50:55,124][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:51:03,741][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:51:15,814][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:51:30,258][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:51:42,592][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:51:51,333][root][INFO] - Processing question number 30
[2025-02-21 05:51:51,337][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:52:02,976][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:52:34,095][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:52:46,284][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:52:57,519][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:53:05,830][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:53:16,704][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:53:25,103][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:53:42,687][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:53:54,317][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:54:04,634][root][INFO] - Processing question number 40
[2025-02-21 05:54:04,638][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:54:20,976][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:54:30,943][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:54:40,204][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:54:48,332][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:55:06,426][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:55:16,750][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:55:28,332][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:55:36,137][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:56:07,386][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:56:23,951][root][INFO] - Processing question number 50
[2025-02-21 05:56:23,955][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:56:31,107][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:56:37,976][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:56:50,705][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:57:03,092][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:57:11,937][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:57:24,454][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:57:56,118][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:58:05,941][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:58:19,141][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:58:32,459][root][INFO] - Processing question number 60
[2025-02-21 05:58:32,464][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:58:40,947][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:58:56,086][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:59:11,765][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:59:22,438][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:59:30,358][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:59:47,776][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:59:55,719][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:00:11,773][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:00:21,844][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:00:32,043][root][INFO] - Processing question number 70
[2025-02-21 06:00:32,056][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:00:44,443][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:00:51,351][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:01:11,580][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:01:18,873][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:01:29,756][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:01:38,831][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:01:49,107][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:02:02,976][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:02:10,067][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:02:41,308][root][INFO] - Processing question number 80
[2025-02-21 06:02:41,314][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:02:51,065][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:03:22,853][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:03:35,865][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:03:48,698][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:03:57,624][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:04:10,065][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:04:27,418][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:04:42,024][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:04:56,535][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:05:27,790][root][INFO] - Processing question number 90
[2025-02-21 06:05:27,796][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:05:39,076][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:06:10,811][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:06:23,528][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:06:33,668][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:06:44,587][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:06:56,799][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:07:08,841][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:07:16,545][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:07:26,854][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:07:40,316][root][INFO] - Inference complete
[2025-02-21 06:07:40,318][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,325][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,325][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,326][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,326][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,327][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,327][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,327][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:07:40,327][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:07:40,328][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:07:40,328][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:07:40,329][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,329][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,329][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,329][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,329][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,330][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:07:40,331][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:07:40,331][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:07:40,332][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:07:40,333][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:07:40,334][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,334][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,334][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,334][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,335][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,335][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,335][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:07:40,335][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,336][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,336][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,336][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,336][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,336][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,337][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,337][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,337][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,337][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:07:40,338][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,344][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,344][root][INFO] - Saved parsed outputs
[2025-02-21 06:07:40,344][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,350][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,350][root][INFO] - Saved parsing metadata
[2025-02-21 06:07:40,351][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,352][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:07:40,354][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:07:40,367][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:07:40,367][root][INFO] - Summary of metrics : {'label_accuracy': 0.63, 'misclassification_rate': 0.37, 'combined_accuracy': 0.43, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 63, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 20, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 06:07:46,970][root][INFO] - Setting global seed to 206
[2025-02-21 06:07:46,975][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:07:46,975][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:07:46,976][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:07:46,977][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:07:46,979][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:07:46,979][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:07:47,129][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:07:47,731][root][INFO] - Full model selected, loading model
[2025-02-21 06:08:01,846][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:08:01,847][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:08:09,392][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:08:09,394][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:08:09,394][root][INFO] - Starting inference
[2025-02-21 06:08:09,550][root][INFO] - Processing question number 0
[2025-02-21 06:08:09,557][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:08:22,852][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:08:36,756][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:08:49,646][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:09:03,072][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:09:21,398][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:09:31,888][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:09:44,774][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:09:54,266][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:10:05,307][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:10:14,810][root][INFO] - Processing question number 10
[2025-02-21 06:10:14,812][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:10:31,393][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:10:42,125][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:10:53,689][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:11:02,162][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:11:15,351][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:11:26,066][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:11:36,822][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:11:55,866][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:12:10,423][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:12:18,979][root][INFO] - Processing question number 20
[2025-02-21 06:12:18,981][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:12:30,347][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:12:40,870][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:12:52,337][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:13:00,921][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:13:09,405][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:13:19,069][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:13:29,695][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:13:43,756][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:13:54,952][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:14:14,448][root][INFO] - Processing question number 30
[2025-02-21 06:14:14,451][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:14:23,937][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:14:33,618][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:14:42,369][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:14:51,141][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:15:02,241][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:15:17,907][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:15:27,009][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:15:36,002][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:15:44,182][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:15:59,910][root][INFO] - Processing question number 40
[2025-02-21 06:15:59,913][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:16:08,866][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:16:20,028][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:16:28,485][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:16:38,923][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:16:54,137][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:17:03,161][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:17:12,942][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:17:22,086][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:17:31,555][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:17:40,822][root][INFO] - Processing question number 50
[2025-02-21 06:17:40,826][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:17:53,510][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:18:02,979][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:18:16,977][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:18:27,802][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:18:35,606][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:18:44,239][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:18:54,852][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:19:04,971][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:19:20,458][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:19:33,024][root][INFO] - Processing question number 60
[2025-02-21 06:19:33,028][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:19:51,923][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:20:00,494][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:20:12,824][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:20:22,345][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:20:38,845][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:20:48,519][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:20:55,900][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:21:08,201][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:21:22,424][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:21:34,413][root][INFO] - Processing question number 70
[2025-02-21 06:21:34,417][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:21:44,995][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:21:54,631][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:22:13,676][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:22:23,916][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:22:36,876][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:22:47,294][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:22:57,198][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:23:06,079][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:23:13,620][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:23:25,288][root][INFO] - Processing question number 80
[2025-02-21 06:23:25,292][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:23:33,016][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:23:39,167][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:23:51,769][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:24:02,287][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:24:12,430][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:24:25,876][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:24:40,358][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:24:52,797][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:25:06,433][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:25:22,047][root][INFO] - Processing question number 90
[2025-02-21 06:25:22,051][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:25:34,740][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:25:48,435][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:26:02,934][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:26:10,386][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:26:25,260][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:26:36,196][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:26:47,277][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:26:58,296][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:27:06,584][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:27:15,991][root][INFO] - Inference complete
[2025-02-21 06:27:15,991][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:15,997][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:15,998][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:15,998][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:27:15,998][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:27:15,999][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:15,999][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:27:15,999][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:27:15,999][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:27:15,999][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:15,999][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:27:15,999][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:27:15,999][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,000][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:27:16,000][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,000][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,000][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:27:16,000][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:27:16,000][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,000][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:27:16,000][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,000][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:27:16,001][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:27:16,001][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:27:16,001][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,001][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:27:16,001][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,001][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:27:16,001][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,001][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:27:16,001][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:27:16,001][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,002][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,002][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:27:16,002][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,002][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:27:16,002][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:27:16,002][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,002][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,002][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:27:16,002][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:27:16,003][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:27:16,003][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:27:16,003][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,003][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,004][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,004][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,004][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,004][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,004][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:27:16,004][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,005][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:27:16,005][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,005][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,005][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:27:16,005][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:27:16,005][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,005][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:27:16,005][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,005][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:27:16,005][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:27:16,006][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:27:16,006][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,006][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:27:16,006][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,006][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:27:16,006][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,006][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:27:16,006][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,006][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:27:16,006][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,007][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,007][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:27:16,007][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,007][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:27:16,007][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,007][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:27:16,007][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,007][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:27:16,007][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:27:16,007][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,008][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,008][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,008][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,008][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:27:16,008][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:27:16,008][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:27:16,008][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:27:16,008][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,009][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:27:16,009][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,009][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,009][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:27:16,009][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,009][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:27:16,009][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:27:16,009][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,009][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:27:16,009][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:27:16,010][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:27:16,010][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:27:16,010][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,010][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:27:16,011][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:27:16,011][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:27:16,011][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:27:16,011][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,011][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,012][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,012][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,012][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,012][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,012][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:27:16,012][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:27:16,013][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:27:16,013][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:27:16,013][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:27:16,013][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:27:16,013][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:27:16,014][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:27:16,014][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:27:16,014][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:27:16,014][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,014][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:27:16,015][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,015][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:27:16,015][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,015][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:27:16,015][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,015][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:27:16,015][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:27:16,016][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,021][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,021][root][INFO] - Saved parsed outputs
[2025-02-21 06:27:16,021][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,039][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,039][root][INFO] - Saved parsing metadata
[2025-02-21 06:27:16,040][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,041][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:27:16,043][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:27:16,072][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:27:16,072][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.02, 'malformed_label': 6, 'malformed_domain': 96, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 49, 'both_wrong': 47}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 06:27:23,209][root][INFO] - Setting global seed to 989
[2025-02-21 06:27:23,216][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:27:23,216][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:27:23,217][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:27:23,219][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:27:23,222][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:27:23,222][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:27:23,412][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:27:23,961][root][INFO] - Full model selected, loading model
[2025-02-21 06:27:45,104][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:29:28,815][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:29:28,832][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:30:01,248][root][INFO] - Peft model loaded successfully
[2025-02-21 06:30:08,695][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:30:08,697][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:30:08,697][root][INFO] - Starting inference
[2025-02-21 06:30:08,864][root][INFO] - Processing question number 0
[2025-02-21 06:30:08,866][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:30:18,428][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:30:49,965][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:31:02,998][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:31:34,331][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:31:51,022][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:31:59,717][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:32:30,639][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:32:37,282][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:32:44,472][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:32:59,877][root][INFO] - Processing question number 10
[2025-02-21 06:32:59,880][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:33:14,461][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:33:28,474][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:33:59,580][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:34:08,142][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:34:15,164][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:34:26,904][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:34:57,901][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:35:28,787][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:35:39,417][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:35:46,629][root][INFO] - Processing question number 20
[2025-02-21 06:35:46,632][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:36:16,985][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:36:48,136][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:36:59,968][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:37:10,501][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:37:22,615][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:37:53,887][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:38:24,776][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:38:34,980][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:38:47,912][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:38:57,381][root][INFO] - Processing question number 30
[2025-02-21 06:38:57,384][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:39:06,148][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:39:37,033][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:40:07,964][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:40:39,275][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:40:50,138][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:40:59,584][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:41:09,729][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:41:27,541][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:41:36,745][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:41:48,325][root][INFO] - Processing question number 40
[2025-02-21 06:41:48,328][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:42:02,329][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:42:13,155][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:42:26,741][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:42:34,754][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:42:48,530][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:42:57,085][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:43:07,783][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:43:18,694][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:43:49,692][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:44:21,000][root][INFO] - Processing question number 50
[2025-02-21 06:44:21,004][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:44:52,417][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:45:03,430][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:45:19,557][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:45:50,698][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:46:21,324][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:46:29,987][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:46:44,352][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:46:53,901][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:47:25,187][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:47:39,411][root][INFO] - Processing question number 60
[2025-02-21 06:47:39,416][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:47:48,182][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:47:58,319][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:48:29,958][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:49:01,110][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:49:12,345][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:49:43,213][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:49:55,144][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:50:04,446][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:50:11,762][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:50:29,860][root][INFO] - Processing question number 70
[2025-02-21 06:50:29,864][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:51:01,006][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:51:11,270][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:51:29,419][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:52:01,088][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:52:12,120][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:52:21,469][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:52:34,197][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:53:05,603][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:53:17,383][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:53:48,319][root][INFO] - Processing question number 80
[2025-02-21 06:53:48,324][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:53:55,650][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:54:08,101][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:54:39,538][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:54:51,527][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:55:02,961][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:55:11,789][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:55:23,871][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:55:55,514][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:56:04,612][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:56:35,635][root][INFO] - Processing question number 90
[2025-02-21 06:56:35,641][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:57:06,773][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:57:38,283][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:57:47,602][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:58:18,654][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:58:30,045][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:58:45,055][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:59:16,208][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:59:24,932][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:59:36,479][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:59:48,671][root][INFO] - Inference complete
[2025-02-21 06:59:48,671][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,680][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,681][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,681][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,682][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,682][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,682][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,682][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,682][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,683][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:59:48,683][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,683][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,684][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,684][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,684][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,685][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:59:48,685][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,685][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,685][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,685][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,686][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,686][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,686][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,686][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,686][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,687][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,687][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,687][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:59:48,688][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:59:48,688][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:59:48,688][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:59:48,689][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:59:48,689][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:59:48,689][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,689][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,690][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,690][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,690][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,691][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:59:48,691][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,692][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,692][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,692][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,692][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,692][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,693][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,694][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,694][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,694][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,694][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,694][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,695][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,695][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,695][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,695][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:59:48,696][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,701][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,701][root][INFO] - Saved parsed outputs
[2025-02-21 06:59:48,701][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,705][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,706][root][INFO] - Saved parsing metadata
[2025-02-21 06:59:48,706][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,708][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:59:48,710][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:59:48,735][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:59:48,735][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.37, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 37, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 23, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 06:59:55,464][root][INFO] - Setting global seed to 989
[2025-02-21 06:59:55,470][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:59:55,470][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:59:55,471][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:59:55,473][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:59:55,475][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:59:55,475][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:59:55,631][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:59:56,188][root][INFO] - Full model selected, loading model
[2025-02-21 07:00:17,664][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:00:17,665][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:00:25,277][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:00:25,278][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:25,279][root][INFO] - Starting inference
[2025-02-21 07:00:25,419][root][INFO] - Processing question number 0
[2025-02-21 07:00:25,432][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:00:34,919][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:00:45,500][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:00:55,780][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:01:04,531][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:01:15,494][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:01:29,072][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:01:38,515][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:01:47,625][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:01:59,391][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:02:08,505][root][INFO] - Processing question number 10
[2025-02-21 07:02:08,507][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:02:22,748][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:02:33,083][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:02:44,382][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:02:57,021][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:03:10,282][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:03:21,986][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:03:31,008][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:03:47,646][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:03:59,354][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:04:08,628][root][INFO] - Processing question number 20
[2025-02-21 07:04:08,631][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:04:16,000][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:04:25,482][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:04:34,632][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:04:44,410][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:04:53,451][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:05:05,917][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:05:17,037][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:05:33,466][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:05:43,205][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:05:55,345][root][INFO] - Processing question number 30
[2025-02-21 07:05:55,347][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:06:09,470][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:06:18,863][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:06:29,996][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:06:39,777][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:06:48,989][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:07:03,199][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:07:13,402][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:07:26,888][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:07:43,311][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:07:52,394][root][INFO] - Processing question number 40
[2025-02-21 07:07:52,397][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:08:23,301][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:08:37,638][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:08:47,952][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:08:55,904][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:09:10,921][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:09:18,977][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:09:28,816][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:09:39,565][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:09:53,571][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:10:04,896][root][INFO] - Processing question number 50
[2025-02-21 07:10:04,899][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:10:13,964][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:10:22,468][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:10:33,219][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:10:44,340][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:10:57,459][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:11:06,452][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:11:17,760][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:11:27,736][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:11:38,555][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:11:49,061][root][INFO] - Processing question number 60
[2025-02-21 07:11:49,065][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:12:00,291][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:12:10,760][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:12:23,384][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:12:34,509][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:12:46,763][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:12:57,533][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:13:05,722][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:13:21,328][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:13:33,428][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:13:44,217][root][INFO] - Processing question number 70
[2025-02-21 07:13:44,221][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:13:55,857][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:14:04,231][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:14:17,677][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:14:33,452][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:14:45,301][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:14:56,924][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:15:06,987][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:15:20,746][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:15:29,093][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:15:38,532][root][INFO] - Processing question number 80
[2025-02-21 07:15:38,536][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:15:48,223][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:15:56,504][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:16:04,786][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:16:15,758][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:16:26,364][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:16:35,375][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:16:50,830][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:17:02,497][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:17:15,506][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:17:34,272][root][INFO] - Processing question number 90
[2025-02-21 07:17:34,277][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:17:48,805][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:17:59,147][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:18:15,741][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:18:25,547][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:18:35,278][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:18:45,714][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:18:56,640][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:19:08,007][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:19:19,736][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:19:39,932][root][INFO] - Inference complete
[2025-02-21 07:19:39,933][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,939][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,940][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:19:39,940][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,940][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:19:39,940][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,940][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:19:39,940][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:19:39,941][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:19:39,941][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:19:39,941][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,941][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:19:39,942][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:19:39,942][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:19:39,942][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:19:39,942][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:19:39,943][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,943][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:19:39,943][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,943][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:19:39,943][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,943][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:19:39,943][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:19:39,943][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,943][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:19:39,943][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:19:39,944][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:19:39,944][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:19:39,944][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:19:39,944][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:19:39,944][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,944][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:19:39,945][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,945][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:19:39,945][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,945][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:19:39,945][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:39,945][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:19:39,945][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,945][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:19:39,945][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,945][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:19:39,946][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:19:39,946][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,946][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:19:39,946][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,946][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:19:39,946][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,946][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:19:39,946][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,946][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:19:39,946][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,947][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:19:39,947][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,947][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:19:39,947][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,947][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:19:39,947][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:19:39,947][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,947][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:19:39,948][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,948][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:19:39,948][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:19:39,948][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:39,948][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:19:39,948][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,948][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:19:39,948][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,948][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:19:39,948][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,949][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:19:39,949][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,949][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:19:39,949][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,949][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:19:39,949][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,949][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:19:39,949][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,949][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:19:39,949][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:19:39,950][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:19:39,950][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:19:39,950][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:19:39,950][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:19:39,950][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,950][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:19:39,951][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,951][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:19:39,951][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:19:39,951][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:19:39,951][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,951][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:19:39,951][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,951][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:19:39,951][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,951][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,952][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,952][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,952][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,952][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,952][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:19:39,952][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:19:39,953][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:19:39,953][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:19:39,953][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:19:39,953][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,953][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,954][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,954][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,954][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,954][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,954][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:19:39,954][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:19:39,955][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:19:39,955][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:19:39,955][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:19:39,955][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:19:39,955][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,955][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:19:39,956][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,956][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:19:39,956][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,956][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:19:39,956][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 07:19:39,956][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:19:39,956][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,956][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:19:39,956][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,956][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:19:39,957][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:19:39,957][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:19:39,957][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,957][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:19:39,958][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,958][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:19:39,958][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,958][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:19:39,958][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,958][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:19:39,958][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,958][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:19:39,958][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:39,958][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:19:39,959][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,965][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,965][root][INFO] - Saved parsed outputs
[2025-02-21 07:19:39,965][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,966][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,967][root][INFO] - Saved parsing metadata
[2025-02-21 07:19:39,967][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,969][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:19:39,979][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:19:40,007][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:19:40,007][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 07:19:47,079][root][INFO] - Setting global seed to 989
[2025-02-21 07:19:47,085][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:19:47,086][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:19:47,087][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:19:47,088][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:19:47,091][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:19:47,091][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:19:47,250][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:19:48,100][root][INFO] - Full model selected, loading model
[2025-02-21 07:20:08,670][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:21:51,638][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:21:51,640][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:22:23,016][root][INFO] - Peft model loaded successfully
[2025-02-21 07:22:30,742][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:22:30,744][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:22:30,744][root][INFO] - Starting inference
[2025-02-21 07:22:30,913][root][INFO] - Processing question number 0
[2025-02-21 07:22:30,915][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:22:51,440][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:23:04,180][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:23:35,991][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:24:07,557][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:24:38,565][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:24:48,994][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:25:03,327][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:25:13,061][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:25:22,533][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:25:35,853][root][INFO] - Processing question number 10
[2025-02-21 07:25:35,855][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:25:47,833][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:25:59,961][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:26:10,515][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:26:20,600][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:26:29,563][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:26:39,174][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:26:47,784][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:26:59,142][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:27:07,996][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:27:17,658][root][INFO] - Processing question number 20
[2025-02-21 07:27:17,661][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:27:48,228][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:28:19,609][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:28:50,634][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:28:57,394][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:29:14,232][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:29:24,849][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:29:36,376][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:29:45,368][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:30:16,535][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:30:28,291][root][INFO] - Processing question number 30
[2025-02-21 07:30:28,294][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:30:37,783][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:31:08,904][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:31:40,068][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:32:11,612][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:32:22,259][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:32:36,088][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:33:07,218][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:33:21,115][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:33:37,327][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:33:47,641][root][INFO] - Processing question number 40
[2025-02-21 07:33:47,644][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:33:57,387][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:34:09,441][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:34:21,360][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:34:31,496][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:34:48,148][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:34:57,574][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:35:09,056][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:35:20,407][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:35:51,645][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:36:03,280][root][INFO] - Processing question number 50
[2025-02-21 07:36:03,285][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:36:12,940][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:36:24,183][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:36:36,969][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:36:48,145][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:36:58,853][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:37:09,517][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:37:24,716][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:37:33,837][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:38:05,363][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:38:15,663][root][INFO] - Processing question number 60
[2025-02-21 07:38:15,667][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:38:26,389][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:38:38,003][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:38:55,681][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:39:27,061][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:39:37,270][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:40:08,369][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:40:17,369][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:40:48,233][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:41:19,248][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:41:32,984][root][INFO] - Processing question number 70
[2025-02-21 07:41:32,989][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:41:40,710][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:41:51,342][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:42:22,884][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:42:54,741][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:43:06,249][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:43:24,337][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:43:56,552][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:44:14,271][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:44:20,514][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:44:51,766][root][INFO] - Processing question number 80
[2025-02-21 07:44:51,772][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:45:00,195][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:45:11,941][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:45:43,622][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:45:53,536][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:46:05,103][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:46:18,142][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:46:30,116][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:47:01,983][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:47:11,535][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:47:42,778][root][INFO] - Processing question number 90
[2025-02-21 07:47:42,784][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:47:52,896][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:48:05,054][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:48:36,637][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:48:47,024][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:49:18,807][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:49:50,515][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:49:59,489][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:50:06,353][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:50:23,387][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:50:38,877][root][INFO] - Inference complete
[2025-02-21 07:50:38,878][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,885][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,886][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,886][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,886][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,887][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,887][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,887][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,888][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:50:38,888][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:50:38,888][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:50:38,889][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:50:38,889][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:50:38,890][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,890][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,890][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,890][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,890][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,891][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,891][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,891][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,891][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,891][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:50:38,892][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:50:38,893][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:50:38,893][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,894][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,894][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,894][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,895][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,895][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:50:38,895][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,895][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,896][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,896][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,896][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,896][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,896][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,897][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,897][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,897][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 07:50:38,897][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,898][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,899][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,899][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,899][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,899][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,899][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 07:50:38,900][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,905][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,905][root][INFO] - Saved parsed outputs
[2025-02-21 07:50:38,905][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,906][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,907][root][INFO] - Saved parsing metadata
[2025-02-21 07:50:38,907][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,909][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:38,910][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:50:38,923][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:50:38,923][root][INFO] - Summary of metrics : {'label_accuracy': 0.62, 'misclassification_rate': 0.38, 'combined_accuracy': 0.38, 'malformed_label': 0, 'malformed_domain': 39, 'total_predictions': 100, 'correct_predictions': 62, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 24, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 07:50:45,428][root][INFO] - Setting global seed to 989
[2025-02-21 07:50:45,433][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:50:45,433][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:50:45,435][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:50:45,437][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:50:45,439][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:50:45,439][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:50:45,580][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:50:46,132][root][INFO] - Full model selected, loading model
[2025-02-21 07:51:07,276][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:51:07,298][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:51:14,963][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:51:14,965][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:51:14,965][root][INFO] - Starting inference
[2025-02-21 07:51:15,118][root][INFO] - Processing question number 0
[2025-02-21 07:51:15,121][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:51:27,174][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:51:37,348][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:51:51,258][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:52:00,640][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:52:11,809][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:52:23,631][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:52:32,823][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:52:41,117][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:52:56,197][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:53:07,145][root][INFO] - Processing question number 10
[2025-02-21 07:53:07,147][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:53:20,929][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:53:31,509][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:53:40,421][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:53:49,779][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:54:02,720][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:54:12,838][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:54:22,400][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:54:37,130][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:54:55,841][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:55:08,443][root][INFO] - Processing question number 20
[2025-02-21 07:55:08,445][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:55:16,899][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:55:25,266][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:55:36,449][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:55:44,102][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:55:52,789][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:56:04,823][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:56:19,071][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:56:31,412][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:56:41,352][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:56:55,048][root][INFO] - Processing question number 30
[2025-02-21 07:56:55,050][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:57:14,124][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:57:23,910][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:57:35,455][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:57:46,594][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:57:55,701][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:58:10,609][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:58:20,400][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:58:32,829][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:58:41,213][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:58:50,739][root][INFO] - Processing question number 40
[2025-02-21 07:58:50,742][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:59:00,358][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:59:13,147][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:59:24,279][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:59:38,536][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:59:50,848][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:00:00,332][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:00:11,271][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:00:21,131][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:00:33,374][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:00:43,203][root][INFO] - Processing question number 50
[2025-02-21 08:00:43,207][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:00:53,269][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:01:02,545][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:01:14,366][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:01:27,565][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:01:38,084][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:01:48,555][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:02:00,033][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:02:10,514][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:02:21,041][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:02:29,802][root][INFO] - Processing question number 60
[2025-02-21 08:02:29,806][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:02:39,645][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:02:52,931][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:03:09,541][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:03:19,825][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:03:34,954][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:03:43,992][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:03:52,905][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:04:03,182][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:04:15,908][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:04:25,226][root][INFO] - Processing question number 70
[2025-02-21 08:04:25,230][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:04:38,588][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:04:48,982][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:04:59,468][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:05:13,449][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:05:24,177][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:05:34,754][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:05:47,330][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:06:00,557][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:06:07,124][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:06:17,002][root][INFO] - Processing question number 80
[2025-02-21 08:06:17,006][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:06:26,087][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:06:33,944][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:06:45,382][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:06:55,407][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:07:04,179][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:07:14,475][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:07:29,113][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:07:40,636][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:07:51,457][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:08:04,600][root][INFO] - Processing question number 90
[2025-02-21 08:08:04,605][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:08:18,459][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:08:30,268][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:08:42,431][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:08:50,281][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:09:00,764][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:09:13,644][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:09:22,221][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:09:34,449][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:09:44,466][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:10:00,683][root][INFO] - Inference complete
[2025-02-21 08:10:00,683][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,690][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,691][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:10:00,691][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,691][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:10:00,692][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,692][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:10:00,692][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,692][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:10:00,692][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,692][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:10:00,692][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,692][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 08:10:00,692][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,692][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:10:00,693][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,693][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:10:00,693][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,693][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:10:00,693][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:10:00,693][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,693][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:10:00,693][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:10:00,693][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,694][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 08:10:00,694][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,694][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:10:00,694][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:10:00,694][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:10:00,694][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:10:00,694][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,694][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:10:00,694][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:10:00,695][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:10:00,695][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:10:00,695][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,695][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:10:00,695][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,696][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:10:00,696][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,696][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:10:00,696][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,696][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:10:00,696][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,696][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:10:00,696][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,696][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 08:10:00,696][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:10:00,697][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 08:10:00,697][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:10:00,697][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:10:00,697][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,697][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:10:00,697][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,698][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:10:00,698][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,698][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:10:00,698][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,698][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 08:10:00,698][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,698][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:10:00,698][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,698][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:10:00,698][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:10:00,699][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 08:10:00,699][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:10:00,699][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 08:10:00,699][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:10:00,699][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:10:00,699][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,700][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:10:00,700][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,700][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:10:00,700][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,700][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:10:00,700][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,700][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:10:00,700][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,700][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:10:00,700][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 08:10:00,701][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 08:10:00,701][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 08:10:00,701][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:10:00,701][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:10:00,701][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,701][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,702][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:10:00,702][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,702][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,702][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:10:00,702][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 08:10:00,703][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 08:10:00,703][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 08:10:00,703][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:10:00,703][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,703][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 08:10:00,703][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,704][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 08:10:00,704][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,704][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:10:00,704][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,704][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:10:00,704][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,704][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 08:10:00,704][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:10:00,704][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:10:00,704][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:10:00,705][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 08:10:00,705][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:10:00,705][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:10:00,705][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 08:10:00,705][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,705][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,706][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,706][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,706][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,706][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,706][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 08:10:00,706][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 08:10:00,707][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:10:00,707][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 08:10:00,707][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:10:00,707][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:10:00,707][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,707][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:10:00,708][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 08:10:00,708][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 08:10:00,708][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:10:00,708][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:10:00,708][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,708][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 08:10:00,709][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,709][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 08:10:00,709][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,709][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 08:10:00,709][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,709][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 08:10:00,709][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,709][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:10:00,709][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 08:10:00,709][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 08:10:00,710][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,715][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,716][root][INFO] - Saved parsed outputs
[2025-02-21 08:10:00,716][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,717][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,717][root][INFO] - Saved parsing metadata
[2025-02-21 08:10:00,718][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,719][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:10:00,721][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:10:00,733][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 08:10:00,733][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 47, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 08:10:07,203][root][INFO] - Setting global seed to 989
[2025-02-21 08:10:07,208][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 08:10:07,208][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:10:07,209][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:10:07,210][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:10:07,212][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:10:07,212][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:10:07,368][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:10:07,895][root][INFO] - Full model selected, loading model
[2025-02-21 08:10:26,539][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 08:12:08,282][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 08:12:08,310][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 08:12:40,283][root][INFO] - Peft model loaded successfully
[2025-02-21 08:12:47,620][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:12:47,622][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:12:47,622][root][INFO] - Starting inference
[2025-02-21 08:12:47,777][root][INFO] - Processing question number 0
[2025-02-21 08:12:47,782][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:12:59,813][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:13:11,948][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:13:24,063][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:13:37,080][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:14:00,275][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:14:11,999][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:14:43,154][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:14:53,847][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:15:05,140][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:15:15,990][root][INFO] - Processing question number 10
[2025-02-21 08:15:15,993][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:15:21,880][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:15:35,921][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:15:46,280][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:15:58,447][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:16:06,667][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:16:16,634][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:16:32,480][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:16:57,078][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:17:08,100][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:17:16,692][root][INFO] - Processing question number 20
[2025-02-21 08:17:16,694][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:17:29,869][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:17:40,903][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:17:54,901][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:18:03,408][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:18:11,580][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:18:20,225][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:18:31,551][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:18:45,176][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:19:04,112][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:19:15,731][root][INFO] - Processing question number 30
[2025-02-21 08:19:15,734][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:19:29,454][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:20:00,603][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:20:20,874][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:20:32,924][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:20:41,733][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:20:51,609][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:21:02,945][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:21:13,758][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:21:32,657][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:21:43,838][root][INFO] - Processing question number 40
[2025-02-21 08:21:43,841][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:21:59,024][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:22:07,811][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:22:22,428][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:22:33,706][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:22:50,317][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:22:57,613][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:23:07,703][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:23:39,039][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:23:48,226][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:23:59,722][root][INFO] - Processing question number 50
[2025-02-21 08:23:59,725][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:24:14,007][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:24:24,223][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:24:41,955][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:24:56,338][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:25:15,397][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:25:27,326][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:25:44,343][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:25:54,429][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:26:06,280][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:26:19,215][root][INFO] - Processing question number 60
[2025-02-21 08:26:19,219][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:26:27,865][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:26:38,345][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:26:54,501][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:27:06,248][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:27:18,893][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:27:32,225][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:27:40,600][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:27:52,067][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:28:00,719][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:28:11,871][root][INFO] - Processing question number 70
[2025-02-21 08:28:11,875][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:28:43,293][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:28:53,939][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:29:05,586][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:29:16,145][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:29:28,666][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:29:36,289][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:29:46,612][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:30:18,240][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:30:39,226][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:30:50,806][root][INFO] - Processing question number 80
[2025-02-21 08:30:50,810][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:31:22,417][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:31:29,931][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:32:01,656][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:32:10,032][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:32:21,158][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:32:30,612][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:33:02,299][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:33:11,643][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:33:24,227][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:33:35,320][root][INFO] - Processing question number 90
[2025-02-21 08:33:35,325][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:34:06,745][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:34:38,518][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:34:55,189][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:35:02,679][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:35:12,911][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:35:24,553][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:35:55,994][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:36:04,894][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:36:11,289][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:36:25,770][root][INFO] - Inference complete
[2025-02-21 08:36:25,770][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,777][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,778][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:36:25,778][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:36:25,779][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:36:25,779][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:36:25,779][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:36:25,780][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:36:25,780][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:36:25,780][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:36:25,781][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:36:25,781][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:36:25,781][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:36:25,781][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:36:25,782][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:36:25,782][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:36:25,783][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,783][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,783][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,784][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,784][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,784][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:36:25,785][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:36:25,785][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:36:25,786][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:36:25,786][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,786][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,786][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,787][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,787][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,787][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,788][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 08:36:25,788][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,788][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,788][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,789][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,789][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,789][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,789][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,790][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,790][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,790][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 08:36:25,791][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,796][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,796][root][INFO] - Saved parsed outputs
[2025-02-21 08:36:25,796][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,800][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,800][root][INFO] - Saved parsing metadata
[2025-02-21 08:36:25,800][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,801][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:25,810][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:36:25,851][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 08:36:25,851][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.35, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 19, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 20 to status running with exit code None
Eval status update completed for job 20
[2025-02-21 08:36:34,032][root][INFO] - Setting global seed to 989
[2025-02-21 08:36:34,040][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 08:36:34,040][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:36:34,041][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:36:34,043][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:36:34,046][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:36:34,046][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:36:34,186][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:36:34,744][root][INFO] - Full model selected, loading model
[2025-02-21 08:36:51,024][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:36:51,024][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:36:58,537][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:36:58,539][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:58,539][root][INFO] - Starting inference
[2025-02-21 08:36:58,695][root][INFO] - Processing question number 0
[2025-02-21 08:36:58,704][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:37:15,947][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:37:26,875][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:37:48,495][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:37:59,834][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:38:09,603][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:38:21,762][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:38:31,193][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:38:39,432][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:38:48,298][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:38:59,639][root][INFO] - Processing question number 10
[2025-02-21 08:38:59,646][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:39:08,889][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:39:20,613][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:39:29,269][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:39:42,573][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:39:57,683][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:40:11,100][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:40:26,778][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:40:42,005][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:40:55,480][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:41:11,156][root][INFO] - Processing question number 20
[2025-02-21 08:41:11,158][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:41:19,471][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:41:32,356][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:41:37,408][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:41:45,396][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:41:57,705][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:42:08,973][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:42:18,902][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:42:36,298][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:42:44,742][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:42:59,237][root][INFO] - Processing question number 30
[2025-02-21 08:42:59,239][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:43:11,981][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:43:19,829][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:43:30,215][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:43:43,970][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:43:54,463][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:44:05,787][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:44:14,823][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:44:24,618][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:44:33,440][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:44:44,909][root][INFO] - Processing question number 40
[2025-02-21 08:44:44,912][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:44:54,959][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:45:10,841][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:45:21,499][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:45:30,504][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:45:42,336][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:45:50,416][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:46:05,561][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:46:12,915][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:46:22,383][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:46:33,002][root][INFO] - Processing question number 50
[2025-02-21 08:46:33,005][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:46:41,649][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:46:52,198][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:47:06,400][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:47:18,226][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:47:31,267][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:47:43,979][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:47:54,993][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:48:09,344][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:48:20,063][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:48:30,164][root][INFO] - Processing question number 60
[2025-02-21 08:48:30,168][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:48:40,997][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:48:53,516][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:49:03,099][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:49:12,119][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:49:29,021][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:49:37,951][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:49:54,184][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:50:07,679][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:50:20,611][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:50:39,357][root][INFO] - Processing question number 70
[2025-02-21 08:50:39,362][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:50:48,981][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:50:56,622][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:51:10,327][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:51:20,209][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:51:33,112][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:51:42,726][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:51:51,297][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:52:04,721][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:52:14,664][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:52:24,389][root][INFO] - Processing question number 80
[2025-02-21 08:52:24,394][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:52:32,326][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:52:43,105][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:52:57,794][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:53:07,514][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:53:16,787][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:53:27,075][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:53:40,171][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:53:48,946][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:53:59,863][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:54:10,940][root][INFO] - Processing question number 90
[2025-02-21 08:54:10,945][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:54:24,540][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:54:33,815][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:54:48,619][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:54:58,161][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:55:10,015][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:55:25,598][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:55:36,627][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:55:49,904][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:56:00,951][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:56:15,978][root][INFO] - Inference complete
[2025-02-21 08:56:15,978][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:15,985][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:15,986][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:56:15,986][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:56:15,986][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,986][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:56:15,986][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:56:15,986][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:56:15,987][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 08:56:15,987][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:56:15,987][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:56:15,987][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:56:15,987][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,987][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:56:15,988][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,988][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:56:15,988][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,988][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:56:15,988][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,988][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 08:56:15,988][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:56:15,988][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:56:15,988][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:56:15,988][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:56:15,989][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:56:15,989][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:56:15,989][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:56:15,989][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:56:15,990][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:56:15,990][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:56:15,990][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,990][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:56:15,990][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:56:15,991][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:56:15,991][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,991][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:56:15,991][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:56:15,992][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:56:15,992][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:56:15,992][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 08:56:15,992][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:56:15,992][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,992][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:56:15,993][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:56:15,993][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 08:56:15,993][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 08:56:15,993][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:56:15,993][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,993][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:56:15,994][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,994][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:56:15,994][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,994][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:56:15,994][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:56:15,994][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,994][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:56:15,994][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,994][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:56:15,994][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,995][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 08:56:15,995][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:56:15,996][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:56:15,996][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:56:15,996][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:56:15,996][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,996][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 08:56:15,997][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,997][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,997][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,997][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 08:56:15,997][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:56:15,997][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,997][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 08:56:15,997][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:56:15,998][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:56:15,998][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:56:15,998][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 08:56:15,998][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,998][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:56:15,999][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:56:15,999][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 08:56:15,999][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:56:15,999][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 08:56:15,999][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:56:15,999][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 08:56:16,000][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:56:16,001][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,001][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:56:16,001][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,001][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:56:16,001][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,001][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 08:56:16,001][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,001][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 08:56:16,001][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 08:56:16,001][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:56:16,002][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 08:56:16,002][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 08:56:16,002][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,002][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 08:56:16,002][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,003][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:56:16,003][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 08:56:16,003][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 08:56:16,004][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,021][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,021][root][INFO] - Saved parsed outputs
[2025-02-21 08:56:16,021][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,024][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,024][root][INFO] - Saved parsing metadata
[2025-02-21 08:56:16,025][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,026][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:56:16,028][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:56:16,065][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 08:56:16,065][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.0, 'malformed_label': 6, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 47, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '20', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 20 to status completed with exit code 0
Eval status update completed for job 20
Job 20 completed at Fri Feb 21 08:56:17 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n517
Job ID: 25309355
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 09:45:24
CPU Efficiency: 9.93% of 4-02:17:20 core-walltime
Job Wall-clock time: 09:49:44
Memory Utilized: 35.25 GB
Memory Efficiency: 97.93% of 36.00 GB
