Starting job 27 at Thu Feb 20 23:39:33 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=markdown_fact_first_few_shot_unstructured train=markdown_fact_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '27', 'training']
Updating job 27 to status training with exit code None
Status update completed for job 27
[2025-02-20 23:39:47,386][root][INFO] - Global seed set to 314
[2025-02-20 23:39:47,387][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 23:39:47,387][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 23:39:47,387][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 23:39:47,388][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:39:47,388][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 23:39:47,404][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:39:47,437][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 23:39:47,440][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 23:39:47,467][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 23:39:47,928][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 23:40:01,373][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 23:40:30,318][root][INFO] - Model prepared for kbit training
[2025-02-20 23:40:30,319][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'q_proj', 'k_proj', 'gate_proj', 'up_proj', 'down_proj', 'v_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 23:40:32,029][root][INFO] - Lora adapter added to model
[2025-02-20 23:40:32,032][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_markdown_fact_first_few_shot_unstructured
[2025-02-20 23:40:32,135][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6112, 'grad_norm': 0.1490873098373413, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4597, 'grad_norm': 0.1732141077518463, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3413, 'grad_norm': 0.17342717945575714, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.2457, 'grad_norm': 0.20710216462612152, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0725, 'grad_norm': 0.24600137770175934, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 384.2792, 'train_samples_per_second': 0.273, 'train_steps_per_second': 0.039, 'train_loss': 1.3460884253184, 'epoch': 15.0}
[2025-02-20 23:46:59,526][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_markdown_fact_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '27', 'trained', '0']
Updating job 27 to status trained with exit code 0
Status update completed for job 27
Starting evaluations for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-20 23:47:08,669][root][INFO] - Setting global seed to 206
[2025-02-20 23:47:08,674][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:47:08,675][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:47:08,676][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:47:08,678][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:47:08,680][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:47:08,680][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:47:08,832][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:47:09,142][root][INFO] - Full model selected, loading model
[2025-02-20 23:47:25,104][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:48:28,281][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:48:28,282][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:48:54,717][root][INFO] - Peft model loaded successfully
[2025-02-20 23:49:01,072][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:49:01,073][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:49:01,073][root][INFO] - Starting inference
[2025-02-20 23:49:01,279][root][INFO] - Processing question number 0
[2025-02-20 23:49:01,293][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:49:30,749][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:50:01,143][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:50:31,139][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:51:01,471][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:51:31,116][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:52:00,731][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:52:31,140][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:53:01,091][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:53:30,670][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:54:00,945][root][INFO] - Processing question number 10
[2025-02-20 23:54:00,947][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:54:32,550][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:55:01,944][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:55:31,843][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:56:02,303][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:56:32,748][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:57:02,202][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:57:31,588][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:58:01,439][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:58:31,274][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:59:00,835][root][INFO] - Processing question number 20
[2025-02-20 23:59:00,838][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:59:30,655][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:00:00,656][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:00:30,117][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:00:59,504][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:01:29,588][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:01:59,458][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:02:30,128][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:02:59,968][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:03:29,926][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:03:59,242][root][INFO] - Processing question number 30
[2025-02-21 00:03:59,245][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:04:29,449][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:04:59,879][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:05:29,841][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:05:59,631][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:06:29,291][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:06:59,676][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:07:29,452][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:07:59,637][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:08:29,581][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:09:00,311][root][INFO] - Processing question number 40
[2025-02-21 00:09:00,314][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:09:30,325][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:10:00,320][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:10:30,782][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:11:01,197][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:11:30,886][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:12:00,835][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:12:32,104][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:13:01,155][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:13:31,005][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:14:01,591][root][INFO] - Processing question number 50
[2025-02-21 00:14:01,595][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:14:32,420][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:15:02,569][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:15:31,898][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:16:02,914][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:16:32,956][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:17:02,015][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:17:32,721][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:18:02,201][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:18:32,705][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:19:04,046][root][INFO] - Processing question number 60
[2025-02-21 00:19:04,050][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:19:33,514][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:20:03,330][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:20:33,746][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:21:03,193][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:21:33,125][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:22:03,118][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:22:33,130][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:23:03,449][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:23:33,547][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:24:04,184][root][INFO] - Processing question number 70
[2025-02-21 00:24:04,189][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:24:33,965][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:25:03,780][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:25:33,449][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:26:03,745][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:26:33,997][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:27:03,528][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:27:33,870][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:28:04,071][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:28:34,421][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:29:04,218][root][INFO] - Processing question number 80
[2025-02-21 00:29:04,223][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:29:34,452][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:30:04,669][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:30:34,327][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:31:04,073][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:31:34,566][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:32:04,875][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:32:35,237][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:33:04,912][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:33:35,117][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:34:04,575][root][INFO] - Processing question number 90
[2025-02-21 00:34:04,581][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:34:35,553][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:35:04,748][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:35:34,765][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:36:04,000][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:36:34,473][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:37:04,074][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:37:33,863][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:38:03,883][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:38:34,384][root][INFO] - Inference complete
[2025-02-21 00:38:34,384][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,391][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,392][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,393][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:38:34,394][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:38:34,395][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,395][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:38:34,395][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:38:34,395][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,396][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:38:34,396][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,396][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:38:34,396][root][ERROR] - |Q. 22||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 38||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:38:34,397][root][ERROR] - |Q. 81||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:38:34,398][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 4||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,398][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,399][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 62||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 76||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:38:34,400][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,401][root][ERROR] - |Q. 12||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,401][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,401][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,401][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,401][root][ERROR] - |Q. 44||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:38:34,402][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:38:34,403][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,403][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,403][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,403][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:38:34,403][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,403][root][ERROR] - |Q. 33||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,404][root][ERROR] - |Q. 61||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,405][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:38:34,405][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 00:38:34,405][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,405][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,405][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,406][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,407][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:38:34,407][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:38:34,408][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,432][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,432][root][INFO] - Saved parsed outputs
[2025-02-21 00:38:34,432][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,443][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,443][root][INFO] - Saved parsing metadata
[2025-02-21 00:38:34,443][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,445][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:38:34,464][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:38:34,482][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:38:34,482][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 44, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.23232323232323232, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 00:38:42,847][root][INFO] - Setting global seed to 206
[2025-02-21 00:38:42,854][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:38:42,854][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:38:42,855][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:38:42,858][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:38:42,859][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:38:42,860][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:38:43,004][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:38:43,257][root][INFO] - Full model selected, loading model
[2025-02-21 00:38:57,657][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:38:57,658][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:39:03,904][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:39:03,905][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:39:03,905][root][INFO] - Starting inference
[2025-02-21 00:39:04,129][root][INFO] - Processing question number 0
[2025-02-21 00:39:04,131][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:39:33,242][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:40:03,349][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:40:33,016][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:41:03,159][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:41:32,763][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:42:02,468][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:42:32,971][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:43:02,950][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:43:32,595][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:44:02,879][root][INFO] - Processing question number 10
[2025-02-21 00:44:02,881][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:44:34,487][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:45:03,721][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:45:33,534][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:46:03,910][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:46:34,265][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:47:03,653][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:47:32,865][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:48:02,648][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:48:32,362][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:49:01,860][root][INFO] - Processing question number 20
[2025-02-21 00:49:01,863][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:49:31,547][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:50:01,469][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:50:30,843][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:51:00,082][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:51:30,089][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:51:59,890][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:52:30,421][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:53:00,142][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:53:30,020][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:53:59,180][root][INFO] - Processing question number 30
[2025-02-21 00:53:59,183][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:54:29,258][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:54:59,634][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:55:29,540][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:55:59,252][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:56:28,827][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:56:59,144][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:57:28,794][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:57:58,867][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:58:28,737][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:58:59,292][root][INFO] - Processing question number 40
[2025-02-21 00:58:59,296][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:59:29,214][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:59:59,133][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:00:29,511][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:00:59,984][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:01:29,582][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:01:59,467][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:02:30,671][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:02:59,641][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:03:29,410][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:03:59,835][root][INFO] - Processing question number 50
[2025-02-21 01:03:59,839][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:04:30,432][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:05:00,438][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:05:29,602][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:06:00,547][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:06:30,516][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:06:59,513][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:07:30,076][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:07:59,544][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:08:30,061][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:09:01,332][root][INFO] - Processing question number 60
[2025-02-21 01:09:01,336][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:09:30,724][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:10:00,429][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:10:30,757][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:11:00,136][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:11:29,991][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:11:59,899][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:12:29,833][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:13:00,090][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:13:30,100][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:14:00,620][root][INFO] - Processing question number 70
[2025-02-21 01:14:00,625][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:14:30,295][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:15:00,012][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:15:29,600][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:15:59,779][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:16:29,900][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:16:59,381][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:17:29,698][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:17:59,794][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:18:30,085][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:18:59,784][root][INFO] - Processing question number 80
[2025-02-21 01:18:59,789][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:19:29,889][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:19:59,982][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:20:29,744][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:20:59,594][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:21:30,142][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:22:00,588][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:22:30,993][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:23:00,760][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:23:30,796][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:24:00,178][root][INFO] - Processing question number 90
[2025-02-21 01:24:00,184][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:24:30,980][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:24:59,847][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:25:29,561][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:25:58,576][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:26:28,857][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:26:58,226][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:27:27,868][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:27:57,839][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:28:28,252][root][INFO] - Inference complete
[2025-02-21 01:28:28,252][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,258][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,259][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,259][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,259][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,259][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,260][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,260][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,260][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,260][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:28:28,261][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,262][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:28:28,262][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,263][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:28:28,263][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,263][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:28:28,263][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,264][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:28:28,264][root][ERROR] - |Q. 38||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:28:28,264][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 81||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:28:28,265][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:28:28,266][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 01:28:28,266][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:28:28,267][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:28:28,267][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:28:28,267][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 01:28:28,267][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:28:28,268][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:28:28,268][root][ERROR] - |Q. 18||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:28:28,268][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:28:28,268][root][ERROR] - |Q. 40||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:28:28,270][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 01:28:28,270][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 01:28:28,270][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 01:28:28,270][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 01:28:28,271][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 01:28:28,271][root][ERROR] - |Q. 89||D: Property| Failed to extract chosen option: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:28:28,272][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,273][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:28:28,273][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,273][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:28:28,273][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,273][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:28:28,274][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,279][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,279][root][INFO] - Saved parsed outputs
[2025-02-21 01:28:28,279][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,281][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,281][root][INFO] - Saved parsing metadata
[2025-02-21 01:28:28,281][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,283][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:28:28,284][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:28:28,304][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:28:28,304][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 29, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 01:28:36,187][root][INFO] - Setting global seed to 206
[2025-02-21 01:28:36,195][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:28:36,195][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:28:36,196][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:28:36,198][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:28:36,200][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:28:36,200][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:28:37,638][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:28:37,900][root][INFO] - Full model selected, loading model
[2025-02-21 01:28:56,280][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:29:56,842][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:29:56,842][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:30:21,323][root][INFO] - Peft model loaded successfully
[2025-02-21 01:30:27,420][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:30:27,422][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:30:27,422][root][INFO] - Starting inference
[2025-02-21 01:30:27,615][root][INFO] - Processing question number 0
[2025-02-21 01:30:27,617][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:30:57,283][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:31:27,691][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:31:57,660][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:32:28,101][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:32:57,950][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:33:27,753][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:33:58,344][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:34:28,472][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:34:58,238][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:35:28,691][root][INFO] - Processing question number 10
[2025-02-21 01:35:28,693][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:36:00,494][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:36:30,063][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:37:00,215][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:37:31,076][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:38:01,817][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:38:31,615][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:39:01,265][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:39:31,484][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:40:01,504][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:40:31,252][root][INFO] - Processing question number 20
[2025-02-21 01:40:31,254][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:41:01,250][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:41:31,434][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:42:01,075][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:42:30,691][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:43:00,966][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:43:31,024][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:44:01,880][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:44:31,902][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:45:02,053][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:45:31,637][root][INFO] - Processing question number 30
[2025-02-21 01:45:31,641][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:46:02,084][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:46:32,722][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:47:02,872][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:47:32,858][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:48:02,706][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:48:33,288][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:49:03,244][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:49:33,631][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:50:03,765][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:50:34,646][root][INFO] - Processing question number 40
[2025-02-21 01:50:34,649][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:51:04,844][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:51:35,034][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:52:05,685][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:52:36,281][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:53:06,146][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:53:36,297][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:54:07,764][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:54:36,995][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:55:07,063][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:55:37,753][root][INFO] - Processing question number 50
[2025-02-21 01:55:37,757][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:56:08,668][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:56:38,939][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:57:08,456][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:57:39,650][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:58:09,886][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:58:39,130][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:59:10,016][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:59:39,687][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:00:10,372][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:00:41,902][root][INFO] - Processing question number 60
[2025-02-21 02:00:41,906][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:01:11,560][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:01:41,565][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:02:12,181][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:02:41,829][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:03:12,042][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:03:42,324][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:04:12,534][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:04:43,048][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:05:13,412][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:05:44,407][root][INFO] - Processing question number 70
[2025-02-21 02:05:44,412][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:06:14,501][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:06:44,681][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:07:14,618][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:07:45,280][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:08:15,742][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:08:45,491][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:09:16,045][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:09:46,460][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:10:17,000][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:10:46,978][root][INFO] - Processing question number 80
[2025-02-21 02:10:46,984][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:11:17,392][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:11:47,786][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:12:17,639][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:12:47,578][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:13:18,250][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:13:48,736][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:14:19,286][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:14:49,141][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:15:19,446][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:15:49,076][root][INFO] - Processing question number 90
[2025-02-21 02:15:49,082][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:16:20,149][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:16:49,280][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:17:19,299][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:17:48,565][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:18:19,116][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:18:48,735][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:19:18,682][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:19:48,911][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:20:19,603][root][INFO] - Inference complete
[2025-02-21 02:20:19,603][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,610][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,611][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:20:19,612][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:20:19,612][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:20:19,612][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:20:19,612][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:20:19,612][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,613][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,614][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,614][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,614][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:20:19,614][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,614][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,614][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:20:19,614][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,615][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,615][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,616][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:20:19,616][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,616][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:20:19,616][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:20:19,616][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:20:19,617][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:20:19,617][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:20:19,617][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:20:19,617][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:20:19,617][root][ERROR] - |Q. 94||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:20:19,618][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 02:20:19,618][root][ERROR] - |Q. 62||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:20:19,619][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:20:19,619][root][ERROR] - |Q. 18||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:20:19,619][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:20:19,620][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:20:19,620][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:20:19,620][root][ERROR] - |Q. 44||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:20:19,620][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:20:19,620][root][ERROR] - |Q. 86||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:20:19,621][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 02:20:19,621][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,621][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,621][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 02:20:19,621][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,622][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:20:19,622][root][ERROR] - |Q. 75||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,622][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 02:20:19,622][root][ERROR] - |Q. 83||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,622][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:20:19,623][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 02:20:19,623][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:20:19,623][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,624][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:20:19,624][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,624][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:20:19,624][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,624][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:20:19,625][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,630][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,630][root][INFO] - Saved parsed outputs
[2025-02-21 02:20:19,630][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,631][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,631][root][INFO] - Saved parsing metadata
[2025-02-21 02:20:19,632][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,634][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:19,635][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:20:19,649][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:20:19,649][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 31, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.20202020202020202, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 10, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 02:20:26,038][root][INFO] - Setting global seed to 206
[2025-02-21 02:20:26,044][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:20:26,044][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:20:26,045][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:20:26,047][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:20:26,049][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:20:26,049][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:20:26,196][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:20:26,481][root][INFO] - Full model selected, loading model
[2025-02-21 02:20:43,388][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:20:43,388][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:20:49,693][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:20:49,694][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:20:49,694][root][INFO] - Starting inference
[2025-02-21 02:20:49,864][root][INFO] - Processing question number 0
[2025-02-21 02:20:49,866][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:21:19,276][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:21:49,588][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:22:19,450][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:22:49,792][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:23:19,576][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:23:49,328][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:24:19,860][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:24:49,924][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:25:19,624][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:25:49,980][root][INFO] - Processing question number 10
[2025-02-21 02:25:49,982][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:26:21,701][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:26:51,187][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:27:21,206][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:27:51,794][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:28:22,359][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:28:51,972][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:29:21,439][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:29:51,442][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:30:21,367][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:30:51,099][root][INFO] - Processing question number 20
[2025-02-21 02:30:51,102][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:31:21,015][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:31:51,297][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:32:20,887][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:32:50,328][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:33:20,621][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:33:50,793][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:34:21,644][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:34:51,735][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:35:21,936][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:35:51,428][root][INFO] - Processing question number 30
[2025-02-21 02:35:51,431][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:36:21,712][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:36:52,283][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:37:22,358][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:37:52,239][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:38:22,008][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:38:52,524][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:39:22,380][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:39:52,657][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:40:22,723][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:40:53,485][root][INFO] - Processing question number 40
[2025-02-21 02:40:53,488][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:41:23,664][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:41:53,805][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:42:24,441][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:42:55,004][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:43:24,801][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:43:54,920][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:44:26,310][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:44:55,481][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:45:25,448][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:45:56,102][root][INFO] - Processing question number 50
[2025-02-21 02:45:56,106][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:46:26,897][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:46:57,095][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:47:26,456][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:47:57,588][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:48:27,752][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:48:56,944][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:49:27,695][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:49:57,369][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:50:28,044][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:50:59,524][root][INFO] - Processing question number 60
[2025-02-21 02:50:59,528][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:51:29,148][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:51:59,235][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:52:29,929][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:52:59,591][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:53:29,768][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:54:00,059][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:54:30,304][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:55:00,774][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:55:31,015][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:56:01,755][root][INFO] - Processing question number 70
[2025-02-21 02:56:01,760][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:56:31,643][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:57:01,567][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:57:31,352][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:58:01,728][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:58:32,053][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:59:01,792][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:59:32,370][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:00:02,643][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:00:33,118][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:01:02,983][root][INFO] - Processing question number 80
[2025-02-21 03:01:02,987][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:01:33,277][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:02:03,562][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:02:33,350][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:03:03,192][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:03:33,792][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:04:04,218][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:04:34,703][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:05:04,499][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:05:34,736][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:06:04,304][root][INFO] - Processing question number 90
[2025-02-21 03:06:04,309][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:06:35,305][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:07:04,383][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:07:34,292][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:08:03,516][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:08:33,999][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:09:03,566][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:09:33,413][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:10:03,570][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:10:34,179][root][INFO] - Inference complete
[2025-02-21 03:10:34,180][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,186][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,188][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:10:34,188][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:10:34,189][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:10:34,189][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:10:34,189][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:10:34,189][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,189][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:10:34,190][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,191][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:10:34,191][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:10:34,191][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:10:34,191][root][ERROR] - |Q. 8||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:10:34,192][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:10:34,193][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 03:10:34,193][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:10:34,194][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:10:34,194][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:10:34,194][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:10:34,196][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:10:34,196][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:10:34,196][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 03:10:34,196][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 03:10:34,197][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 03:10:34,197][root][ERROR] - |Q. 13||D: Property| Failed to extract chosen option: 
[2025-02-21 03:10:34,197][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 03:10:34,197][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 03:10:34,197][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 03:10:34,198][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:10:34,198][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 03:10:34,199][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:10:34,199][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,199][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:10:34,199][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,200][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:10:34,200][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,200][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,200][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:10:34,200][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:10:34,201][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,206][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,206][root][INFO] - Saved parsed outputs
[2025-02-21 03:10:34,206][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,207][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,207][root][INFO] - Saved parsing metadata
[2025-02-21 03:10:34,208][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,209][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:10:34,211][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:10:34,222][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:10:34,223][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 23, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 7, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 03:10:41,084][root][INFO] - Setting global seed to 206
[2025-02-21 03:10:41,089][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:10:41,090][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:10:41,091][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:10:41,093][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:10:41,094][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:10:41,095][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:10:41,239][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:10:41,506][root][INFO] - Full model selected, loading model
[2025-02-21 03:10:58,506][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:11:59,736][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:11:59,736][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:12:25,479][root][INFO] - Peft model loaded successfully
[2025-02-21 03:12:31,511][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:12:31,513][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:12:31,513][root][INFO] - Starting inference
[2025-02-21 03:12:31,720][root][INFO] - Processing question number 0
[2025-02-21 03:12:31,722][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:13:01,459][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:13:31,901][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:14:01,903][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:14:32,375][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:15:02,257][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:15:32,083][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:16:02,761][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:16:32,916][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:17:02,705][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:17:33,184][root][INFO] - Processing question number 10
[2025-02-21 03:17:33,186][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:18:05,006][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:18:34,599][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:19:04,743][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:19:35,537][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:20:06,199][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:20:35,875][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:21:05,465][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:21:35,552][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:22:05,608][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:22:35,397][root][INFO] - Processing question number 20
[2025-02-21 03:22:35,399][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:23:05,427][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:23:35,687][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:24:05,380][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:24:34,984][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:25:05,294][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:25:35,382][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:26:06,270][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:26:36,323][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:27:06,656][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:27:36,344][root][INFO] - Processing question number 30
[2025-02-21 03:27:36,348][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:28:06,873][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:28:37,672][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:29:07,965][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:29:38,093][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:30:07,974][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:30:38,582][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:31:08,570][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:31:38,965][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:32:09,111][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:32:40,004][root][INFO] - Processing question number 40
[2025-02-21 03:32:40,008][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:33:10,213][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:33:40,417][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:34:11,081][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:34:41,688][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:35:11,568][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:35:41,730][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:36:13,211][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:36:42,463][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:37:12,529][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:37:43,231][root][INFO] - Processing question number 50
[2025-02-21 03:37:43,235][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:38:14,164][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:38:44,450][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:39:14,075][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:39:45,443][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:40:15,802][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:40:45,257][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:41:16,295][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:41:46,113][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:42:16,846][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:42:48,403][root][INFO] - Processing question number 60
[2025-02-21 03:42:48,408][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:43:18,095][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:43:48,109][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:44:18,716][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:44:48,354][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:45:18,480][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:45:48,672][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:46:18,894][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:46:49,425][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:47:19,726][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:47:50,576][root][INFO] - Processing question number 70
[2025-02-21 03:47:50,581][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:48:20,568][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:48:50,598][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:49:20,457][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:49:50,957][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:50:21,441][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:50:51,198][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:51:21,767][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:51:52,186][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:52:22,740][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:52:52,727][root][INFO] - Processing question number 80
[2025-02-21 03:52:52,732][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:53:23,153][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:53:53,653][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:54:23,648][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:54:53,603][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:55:24,292][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:55:54,788][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:56:25,352][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:56:55,219][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:57:25,542][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:57:55,186][root][INFO] - Processing question number 90
[2025-02-21 03:57:55,191][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:58:26,275][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:58:55,422][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:59:25,463][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:59:54,743][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:00:25,310][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:00:54,951][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:01:24,913][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:01:55,153][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:02:25,886][root][INFO] - Inference complete
[2025-02-21 04:02:25,886][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,893][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,894][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:02:25,894][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:02:25,894][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:02:25,894][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:02:25,895][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:02:25,895][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:02:25,895][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:02:25,895][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:02:25,896][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:02:25,896][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 04:02:25,896][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:02:25,896][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:02:25,896][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:02:25,896][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 04:02:25,896][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:02:25,897][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:02:25,897][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 04:02:25,897][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:02:25,897][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 04:02:25,898][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:02:25,898][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:02:25,899][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 04:02:25,899][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 04:02:25,899][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:02:25,899][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 04:02:25,899][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 04:02:25,899][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 04:02:25,900][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:02:25,900][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:02:25,900][root][ERROR] - |Q. 40||D: Evidence| Failed to extract chosen option: 
[2025-02-21 04:02:25,901][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:02:25,901][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 04:02:25,901][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 04:02:25,902][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 04:02:25,902][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 04:02:25,902][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 04:02:25,903][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:02:25,903][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:02:25,903][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 04:02:25,904][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:02:25,905][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,909][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,909][root][INFO] - Saved parsed outputs
[2025-02-21 04:02:25,909][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,911][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,911][root][INFO] - Saved parsing metadata
[2025-02-21 04:02:25,912][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,913][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:25,914][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:02:25,921][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:02:25,921][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 14, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 16, 'both_wrong': 35}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 04:02:32,285][root][INFO] - Setting global seed to 206
[2025-02-21 04:02:32,290][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:02:32,290][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:02:32,292][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:02:32,293][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:02:32,295][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:02:32,295][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:02:32,439][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:02:32,691][root][INFO] - Full model selected, loading model
[2025-02-21 04:02:50,284][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:02:50,284][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:02:56,662][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:02:56,664][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:02:56,664][root][INFO] - Starting inference
[2025-02-21 04:02:56,859][root][INFO] - Processing question number 0
[2025-02-21 04:02:56,861][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:03:26,212][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:03:56,577][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:04:26,635][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:04:56,968][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:05:26,748][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:05:56,490][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:06:27,019][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:06:57,076][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:07:26,774][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:07:57,108][root][INFO] - Processing question number 10
[2025-02-21 04:07:57,110][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:08:28,838][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:08:58,263][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:09:28,279][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:09:58,858][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:10:29,419][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:10:58,996][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:11:28,416][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:11:58,394][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:12:28,309][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:12:57,993][root][INFO] - Processing question number 20
[2025-02-21 04:12:57,995][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:13:27,887][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:13:58,003][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:14:27,576][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:14:57,000][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:15:27,200][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:15:57,186][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:16:27,914][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:16:57,822][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:17:27,903][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:17:57,254][root][INFO] - Processing question number 30
[2025-02-21 04:17:57,257][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:18:27,529][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:18:58,095][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:19:28,170][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:19:58,043][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:20:27,816][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:20:58,322][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:21:28,165][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:21:58,424][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:22:28,481][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:22:59,288][root][INFO] - Processing question number 40
[2025-02-21 04:22:59,291][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:23:29,574][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:23:59,848][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:24:30,596][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:25:01,219][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:25:31,149][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:26:01,218][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:26:32,605][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:27:01,761][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:27:31,781][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:28:02,422][root][INFO] - Processing question number 50
[2025-02-21 04:28:02,426][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:28:33,227][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:29:03,447][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:29:32,845][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:30:03,985][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:30:34,145][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:31:03,327][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:31:34,079][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:32:03,675][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:32:34,280][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:33:05,727][root][INFO] - Processing question number 60
[2025-02-21 04:33:05,731][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:33:35,309][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:34:05,197][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:34:35,721][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:35:05,281][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:35:35,326][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:36:05,431][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:36:35,591][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:37:06,026][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:37:36,231][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:38:06,938][root][INFO] - Processing question number 70
[2025-02-21 04:38:06,944][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:38:36,972][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:39:06,910][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:39:36,688][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:40:07,048][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:40:37,382][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:41:07,034][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:41:37,490][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:42:07,742][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:42:38,226][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:43:08,090][root][INFO] - Processing question number 80
[2025-02-21 04:43:08,095][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:43:38,370][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:44:08,647][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:44:38,420][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:45:08,235][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:45:38,821][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:46:09,229][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:46:39,694][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:47:09,468][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:47:39,688][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:48:09,236][root][INFO] - Processing question number 90
[2025-02-21 04:48:09,241][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:48:40,224][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:49:09,277][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:49:39,171][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:50:08,384][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:50:38,846][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:51:08,389][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:51:38,215][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:52:08,350][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:52:38,944][root][INFO] - Inference complete
[2025-02-21 04:52:38,944][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,951][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,953][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:52:38,953][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:52:38,954][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:52:38,954][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:52:38,954][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:52:38,961][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:52:38,961][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 04:52:38,961][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 04:52:38,962][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 04:52:38,962][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 04:52:38,964][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 04:52:38,965][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,969][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,969][root][INFO] - Saved parsed outputs
[2025-02-21 04:52:38,970][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,975][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,975][root][INFO] - Saved parsing metadata
[2025-02-21 04:52:38,975][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,977][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:52:38,978][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:52:38,996][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:52:38,997][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 6, 'malformed_domain': 41, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.15151515151515152, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 9, 'both_wrong': 32}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 04:52:45,262][root][INFO] - Setting global seed to 989
[2025-02-21 04:52:45,267][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 04:52:45,267][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:52:45,269][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:52:45,270][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:52:45,272][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:52:45,272][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:52:45,437][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:52:45,675][root][INFO] - Full model selected, loading model
[2025-02-21 04:53:03,023][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:54:04,076][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:54:04,077][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:54:29,819][root][INFO] - Peft model loaded successfully
[2025-02-21 04:54:35,915][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:54:35,916][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:54:35,916][root][INFO] - Starting inference
[2025-02-21 04:54:36,132][root][INFO] - Processing question number 0
[2025-02-21 04:54:36,141][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:55:05,414][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:55:35,638][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:56:05,480][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:56:35,927][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:57:05,700][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:57:35,405][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:58:05,894][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:58:35,969][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:59:05,576][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:59:35,844][root][INFO] - Processing question number 10
[2025-02-21 04:59:35,847][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:00:07,453][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:00:36,853][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:01:06,753][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:01:37,208][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:02:07,654][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:02:37,109][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:03:06,493][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:03:36,350][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:04:06,187][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:04:35,760][root][INFO] - Processing question number 20
[2025-02-21 05:04:35,763][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:05:05,583][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:05:35,589][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:06:05,056][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:06:34,447][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:07:04,542][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:07:34,415][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:08:05,084][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:08:34,925][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:09:04,887][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:09:34,203][root][INFO] - Processing question number 30
[2025-02-21 05:09:34,206][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:10:04,417][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:10:34,853][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:11:04,824][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:11:34,635][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:12:04,298][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:12:34,691][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:13:04,474][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:13:34,664][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:14:04,736][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:14:35,413][root][INFO] - Processing question number 40
[2025-02-21 05:14:35,416][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:15:05,422][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:15:35,423][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:16:05,889][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:16:36,297][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:17:05,981][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:17:35,937][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:18:07,205][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:18:36,262][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:19:06,119][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:19:36,614][root][INFO] - Processing question number 50
[2025-02-21 05:19:36,617][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:20:07,347][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:20:37,407][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:21:06,753][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:21:37,746][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:22:07,786][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:22:36,847][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:23:07,543][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:23:37,023][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:24:07,519][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:24:38,856][root][INFO] - Processing question number 60
[2025-02-21 05:24:38,860][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:25:08,322][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:25:38,140][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:26:08,553][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:26:37,995][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:27:07,932][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:27:37,931][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:28:07,944][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:28:38,261][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:29:08,364][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:29:39,009][root][INFO] - Processing question number 70
[2025-02-21 05:29:39,013][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:30:08,794][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:30:38,653][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:31:08,449][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:31:38,839][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:32:09,205][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:32:38,808][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:33:09,264][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:33:39,471][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:34:09,817][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:34:39,614][root][INFO] - Processing question number 80
[2025-02-21 05:34:39,619][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:35:09,844][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:35:40,064][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:36:09,717][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:36:39,462][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:37:09,968][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:37:40,277][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:38:10,649][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:38:40,318][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:39:10,438][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:39:39,865][root][INFO] - Processing question number 90
[2025-02-21 05:39:39,871][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:40:10,757][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:40:39,718][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:41:09,556][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:41:38,632][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:42:08,999][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:42:38,440][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:43:08,216][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:43:38,248][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:44:08,752][root][INFO] - Inference complete
[2025-02-21 05:44:08,753][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,760][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,761][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,762][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:44:08,763][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:44:08,764][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,764][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:44:08,764][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:44:08,764][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,765][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:44:08,765][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,765][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:44:08,765][root][ERROR] - |Q. 22||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:44:08,766][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:44:08,766][root][ERROR] - |Q. 38||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:44:08,766][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:44:08,766][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 81||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:44:08,767][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 4||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,767][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,768][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 62||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 76||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 05:44:08,769][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:44:08,770][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,770][root][ERROR] - |Q. 12||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,770][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,770][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,770][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 44||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:44:08,771][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:44:08,772][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,772][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,772][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,772][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:44:08,772][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,772][root][ERROR] - |Q. 33||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,773][root][ERROR] - |Q. 61||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,774][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 05:44:08,774][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 05:44:08,774][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,774][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,774][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,775][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,776][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:44:08,776][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:44:08,776][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,781][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,781][root][INFO] - Saved parsed outputs
[2025-02-21 05:44:08,781][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,783][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,783][root][INFO] - Saved parsing metadata
[2025-02-21 05:44:08,784][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,787][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:08,793][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:44:08,815][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 05:44:08,815][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 44, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.23232323232323232, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 05:44:15,377][root][INFO] - Setting global seed to 989
[2025-02-21 05:44:15,382][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 05:44:15,382][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:44:15,384][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:44:15,385][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:44:15,387][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:44:15,387][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:44:15,603][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:44:15,867][root][INFO] - Full model selected, loading model
[2025-02-21 05:44:33,662][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:44:33,663][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:44:40,032][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:44:40,034][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:44:40,034][root][INFO] - Starting inference
[2025-02-21 05:44:40,257][root][INFO] - Processing question number 0
[2025-02-21 05:44:40,259][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:45:09,707][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:45:39,822][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:46:09,499][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:46:39,646][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:47:09,240][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:47:38,793][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:48:09,135][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:48:39,016][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:49:08,528][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:49:38,679][root][INFO] - Processing question number 10
[2025-02-21 05:49:38,681][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:50:10,211][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:50:39,451][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:51:09,280][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:51:39,672][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:52:10,039][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:52:39,430][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:53:08,652][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:53:38,439][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:54:08,163][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:54:37,667][root][INFO] - Processing question number 20
[2025-02-21 05:54:37,670][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:55:07,362][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:55:37,287][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:56:06,669][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:56:35,911][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:57:05,925][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:57:35,730][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:58:06,271][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:58:36,039][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:59:06,031][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:59:35,190][root][INFO] - Processing question number 30
[2025-02-21 05:59:35,194][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:00:05,288][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:00:35,721][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:01:05,634][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:01:35,353][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:02:04,956][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:02:35,309][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:03:04,968][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:03:35,049][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:04:04,925][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:04:35,482][root][INFO] - Processing question number 40
[2025-02-21 06:04:35,486][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:05:05,416][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:05:35,388][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:06:05,806][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:06:36,330][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:07:06,059][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:07:36,056][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:08:07,267][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:08:36,241][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:09:06,017][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:09:36,446][root][INFO] - Processing question number 50
[2025-02-21 06:09:36,449][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:10:07,042][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:10:37,050][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:11:06,223][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:11:37,163][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:12:07,132][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:12:36,126][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:13:06,698][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:13:36,118][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:14:06,534][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:14:37,799][root][INFO] - Processing question number 60
[2025-02-21 06:14:37,804][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:15:07,193][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:15:36,899][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:16:07,246][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:16:36,626][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:17:06,482][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:17:36,392][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:18:06,331][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:18:36,590][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:19:06,611][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:19:37,125][root][INFO] - Processing question number 70
[2025-02-21 06:19:37,130][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:20:06,803][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:20:36,527][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:21:06,119][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:21:36,297][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:22:06,434][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:22:35,912][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:23:06,276][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:23:36,371][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:24:06,646][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:24:36,317][root][INFO] - Processing question number 80
[2025-02-21 06:24:36,322][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:25:06,423][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:25:36,508][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:26:06,104][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:26:35,741][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:27:06,152][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:27:36,381][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:28:06,668][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:28:36,267][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:29:06,309][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:29:35,694][root][INFO] - Processing question number 90
[2025-02-21 06:29:35,699][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:30:06,503][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:30:35,376][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:31:05,101][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:31:34,117][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:32:04,406][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:32:33,775][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:33:03,423][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:33:33,389][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:34:03,804][root][INFO] - Inference complete
[2025-02-21 06:34:03,804][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,812][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,813][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,813][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,813][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,813][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,814][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,814][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,814][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,814][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:34:03,815][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,816][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:34:03,816][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,816][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:34:03,817][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,817][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:34:03,817][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,818][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:34:03,818][root][ERROR] - |Q. 38||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:34:03,818][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:34:03,818][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 81||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:34:03,819][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:34:03,820][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 06:34:03,820][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:34:03,821][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 06:34:03,821][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:34:03,822][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:34:03,822][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:34:03,822][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:34:03,822][root][ERROR] - |Q. 18||D: Evidence| Failed to extract chosen option: 
[2025-02-21 06:34:03,823][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:34:03,823][root][ERROR] - |Q. 40||D: Evidence| Failed to extract chosen option: 
[2025-02-21 06:34:03,824][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 06:34:03,824][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 06:34:03,824][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 06:34:03,824][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 06:34:03,825][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 06:34:03,825][root][ERROR] - |Q. 89||D: Property| Failed to extract chosen option: 
[2025-02-21 06:34:03,826][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:34:03,826][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:34:03,827][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,828][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:34:03,828][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,842][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,842][root][INFO] - Saved parsed outputs
[2025-02-21 06:34:03,842][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,843][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,843][root][INFO] - Saved parsing metadata
[2025-02-21 06:34:03,844][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,846][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:34:03,848][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:34:03,870][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 06:34:03,870][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 29, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 06:34:10,204][root][INFO] - Setting global seed to 989
[2025-02-21 06:34:10,209][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 06:34:10,209][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:34:10,211][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:34:10,212][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:34:10,214][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:34:10,214][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:34:10,368][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:34:10,651][root][INFO] - Full model selected, loading model
[2025-02-21 06:34:27,341][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:35:27,538][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:35:27,540][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:35:52,796][root][INFO] - Peft model loaded successfully
[2025-02-21 06:35:58,843][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:35:58,844][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:35:58,845][root][INFO] - Starting inference
[2025-02-21 06:35:59,049][root][INFO] - Processing question number 0
[2025-02-21 06:35:59,064][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:36:28,580][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:36:58,976][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:37:28,931][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:37:59,359][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:38:29,196][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:38:58,982][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:39:29,565][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:39:59,829][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:40:29,597][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:41:00,030][root][INFO] - Processing question number 10
[2025-02-21 06:41:00,033][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:41:31,814][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:42:01,366][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:42:31,446][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:43:02,069][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:43:32,715][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:44:02,352][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:44:31,921][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:45:01,985][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:45:32,134][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:46:01,902][root][INFO] - Processing question number 20
[2025-02-21 06:46:01,905][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:46:31,937][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:47:02,132][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:47:31,764][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:48:01,346][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:48:31,621][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:49:01,672][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:49:32,505][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:50:02,499][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:50:32,630][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:51:02,099][root][INFO] - Processing question number 30
[2025-02-21 06:51:02,103][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:51:32,470][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:52:03,078][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:52:33,199][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:53:03,155][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:53:32,975][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:54:03,525][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:54:33,453][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:55:03,813][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:55:33,918][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:56:04,768][root][INFO] - Processing question number 40
[2025-02-21 06:56:04,772][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:56:34,936][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:57:05,096][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:57:35,717][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:58:06,282][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:58:36,119][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:59:06,241][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:59:37,673][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:00:06,868][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:00:36,886][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:01:07,535][root][INFO] - Processing question number 50
[2025-02-21 07:01:07,540][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:01:38,417][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:02:08,653][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:02:38,138][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:03:09,299][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:03:39,503][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:04:08,715][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:04:39,568][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:05:09,211][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:05:40,006][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:06:11,650][root][INFO] - Processing question number 60
[2025-02-21 07:06:11,656][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:06:41,390][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:07:11,475][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:07:42,190][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:08:11,831][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:08:41,953][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:09:12,196][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:09:42,504][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:10:12,968][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:10:43,207][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:11:13,997][root][INFO] - Processing question number 70
[2025-02-21 07:11:14,002][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:11:43,945][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:12:13,911][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:12:43,709][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:13:14,145][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:13:44,538][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:14:14,224][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:14:44,728][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:15:15,073][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:15:45,575][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:16:15,506][root][INFO] - Processing question number 80
[2025-02-21 07:16:15,511][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:16:45,883][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:17:16,246][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:17:46,072][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:18:15,974][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:18:46,606][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:19:17,054][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:19:47,564][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:20:17,378][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:20:47,644][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:21:17,232][root][INFO] - Processing question number 90
[2025-02-21 07:21:17,237][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:21:48,263][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:22:17,357][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:22:47,335][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:23:16,562][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:23:47,069][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:24:16,669][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:24:46,596][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:25:16,786][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:25:47,446][root][INFO] - Inference complete
[2025-02-21 07:25:47,447][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,453][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,454][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:25:47,454][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:25:47,454][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:25:47,455][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:25:47,455][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:25:47,455][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:25:47,455][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:25:47,456][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,457][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:25:47,457][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:25:47,457][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,458][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:25:47,458][root][ERROR] - |Q. 38||D: Contracts| Failed to extract chosen option: 
[2025-02-21 07:25:47,458][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:25:47,458][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:25:47,458][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 4||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,459][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,459][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 62||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,460][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:25:47,461][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:25:47,461][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:25:47,461][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:25:47,462][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:25:47,462][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 07:25:47,462][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 07:25:47,462][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 07:25:47,462][root][ERROR] - |Q. 13||D: Property| Failed to extract chosen option: 
[2025-02-21 07:25:47,462][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:25:47,463][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 07:25:47,463][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 07:25:47,463][root][ERROR] - |Q. 89||D: Property| Failed to extract chosen option: 
[2025-02-21 07:25:47,463][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:25:47,464][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,465][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:25:47,465][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:25:47,466][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,477][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,477][root][INFO] - Saved parsed outputs
[2025-02-21 07:25:47,477][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,478][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,478][root][INFO] - Saved parsing metadata
[2025-02-21 07:25:47,479][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,480][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:25:47,481][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:25:47,519][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 07:25:47,520][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 27, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.24242424242424243, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 11, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 07:25:54,374][root][INFO] - Setting global seed to 989
[2025-02-21 07:25:54,380][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 07:25:54,381][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:25:54,382][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:25:54,383][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:25:54,386][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:25:54,386][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:25:54,650][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:25:54,886][root][INFO] - Full model selected, loading model
[2025-02-21 07:26:07,267][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:26:07,267][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:26:13,552][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:26:13,553][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:26:13,553][root][INFO] - Starting inference
[2025-02-21 07:26:13,747][root][INFO] - Processing question number 0
[2025-02-21 07:26:13,749][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:26:43,125][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:27:13,430][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:27:43,294][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:28:13,629][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:28:43,414][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:29:13,159][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:29:43,690][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:30:13,752][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:30:43,576][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:31:13,954][root][INFO] - Processing question number 10
[2025-02-21 07:31:13,955][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:31:45,672][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:32:15,101][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:32:45,133][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:33:15,779][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:33:46,362][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:34:15,984][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:34:45,418][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:35:15,445][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:35:45,405][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:36:15,219][root][INFO] - Processing question number 20
[2025-02-21 07:36:15,222][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:36:45,117][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:37:15,242][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:37:44,823][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:38:14,256][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:38:44,467][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:39:14,470][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:39:45,208][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:40:15,130][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:40:45,217][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:41:14,575][root][INFO] - Processing question number 30
[2025-02-21 07:41:14,579][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:41:44,862][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:42:15,439][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:42:45,526][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:43:15,410][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:43:45,187][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:44:15,701][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:44:45,557][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:45:15,826][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:45:45,897][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:46:16,655][root][INFO] - Processing question number 40
[2025-02-21 07:46:16,659][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:46:46,784][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:47:16,905][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:47:47,488][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:48:18,022][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:48:47,821][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:49:17,909][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:49:49,311][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:50:18,484][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:50:48,470][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:51:19,248][root][INFO] - Processing question number 50
[2025-02-21 07:51:19,252][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:51:50,208][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:52:20,573][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:52:50,127][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:53:21,474][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:53:51,710][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:54:20,909][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:54:51,672][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:55:21,329][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:55:51,940][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:56:23,389][root][INFO] - Processing question number 60
[2025-02-21 07:56:23,394][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:56:52,969][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:57:22,856][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:57:53,378][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:58:22,935][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:58:52,978][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:59:23,077][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:59:53,204][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:00:23,639][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:00:53,844][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:01:24,541][root][INFO] - Processing question number 70
[2025-02-21 08:01:24,545][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:01:54,397][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:02:24,292][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:02:54,061][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:03:24,420][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:03:54,729][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:04:24,386][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:04:54,856][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:05:25,255][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:05:55,864][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:06:25,823][root][INFO] - Processing question number 80
[2025-02-21 08:06:25,828][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:06:56,209][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:07:26,636][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:07:56,451][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:08:26,267][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:08:56,848][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:09:27,260][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:09:57,729][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:10:27,504][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:10:57,729][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:11:27,287][root][INFO] - Processing question number 90
[2025-02-21 08:11:27,293][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:11:58,278][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:12:27,334][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:12:57,232][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:13:26,440][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:13:56,911][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:14:26,466][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:14:56,298][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:15:26,446][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:15:57,043][root][INFO] - Inference complete
[2025-02-21 08:15:57,043][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,050][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,051][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:15:57,052][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:15:57,052][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:15:57,052][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:15:57,052][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:15:57,052][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:15:57,053][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:15:57,053][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:15:57,053][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:15:57,053][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:15:57,056][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:15:57,056][root][ERROR] - |Q. 46||D: Contracts| Failed to extract chosen option: 
[2025-02-21 08:15:57,056][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:15:57,056][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 08:15:57,057][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:15:57,057][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 08:15:57,057][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,057][root][ERROR] - |Q. 4||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 41||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 76||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,058][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,059][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,059][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 08:15:57,059][root][ERROR] - |Q. 99||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:15:57,059][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:15:57,059][root][ERROR] - |Q. 12||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:15:57,060][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:15:57,060][root][ERROR] - |Q. 44||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:15:57,060][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:15:57,061][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:15:57,061][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:15:57,061][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:15:57,061][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 08:15:57,061][root][ERROR] - |Q. 6||D: Property| Failed to extract chosen option: 
[2025-02-21 08:15:57,062][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 08:15:57,062][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 08:15:57,063][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 08:15:57,063][root][ERROR] - |Q. 83||D: Property| Failed to extract chosen option: 
[2025-02-21 08:15:57,063][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,063][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,064][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,064][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,064][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,064][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,065][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:15:57,066][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,081][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,081][root][INFO] - Saved parsed outputs
[2025-02-21 08:15:57,081][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,174][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,174][root][INFO] - Saved parsing metadata
[2025-02-21 08:15:57,175][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,176][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:15:57,184][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:15:57,195][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 08:15:57,195][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 28, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 13, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 08:16:03,371][root][INFO] - Setting global seed to 989
[2025-02-21 08:16:03,376][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 08:16:03,376][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:16:03,377][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:16:03,380][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:16:03,382][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:16:03,382][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:16:03,548][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:16:03,819][root][INFO] - Full model selected, loading model
[2025-02-21 08:16:21,002][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 08:17:21,808][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 08:17:21,809][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 08:17:47,318][root][INFO] - Peft model loaded successfully
[2025-02-21 08:17:53,354][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:17:53,356][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:17:53,356][root][INFO] - Starting inference
[2025-02-21 08:17:53,583][root][INFO] - Processing question number 0
[2025-02-21 08:17:53,592][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:18:23,127][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:18:53,540][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:19:23,522][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:19:54,032][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:20:23,914][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:20:53,756][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:21:24,370][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:21:54,535][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:22:24,294][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:22:54,747][root][INFO] - Processing question number 10
[2025-02-21 08:22:54,749][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:23:26,544][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:23:56,109][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:24:26,204][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:24:56,846][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:25:27,470][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:25:57,099][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:26:26,661][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:26:56,710][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:27:26,730][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:27:56,473][root][INFO] - Processing question number 20
[2025-02-21 08:27:56,475][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:28:26,469][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:28:56,677][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:29:26,310][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:29:55,878][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:30:26,148][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:30:56,224][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:31:27,210][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:31:57,226][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:32:27,376][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:32:56,870][root][INFO] - Processing question number 30
[2025-02-21 08:32:56,873][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:33:27,260][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:33:57,886][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:34:28,029][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:34:58,007][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:35:27,848][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:35:58,423][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:36:28,372][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:36:58,752][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:37:28,882][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:37:59,755][root][INFO] - Processing question number 40
[2025-02-21 08:37:59,758][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:38:29,945][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:39:00,133][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:39:30,808][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:40:01,392][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:40:31,248][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:41:01,389][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:41:32,852][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:42:02,118][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:42:32,156][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:43:02,825][root][INFO] - Processing question number 50
[2025-02-21 08:43:02,828][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:43:33,726][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:44:03,979][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:44:33,484][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:45:04,661][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:45:34,880][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:46:04,110][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:46:34,981][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:47:04,633][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:47:35,303][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:48:06,816][root][INFO] - Processing question number 60
[2025-02-21 08:48:06,820][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:48:36,455][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:49:06,455][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:49:37,035][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:50:06,644][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:50:36,747][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:51:06,909][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:51:37,098][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:52:07,587][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:52:37,849][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:53:08,657][root][INFO] - Processing question number 70
[2025-02-21 08:53:08,661][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:53:38,610][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:54:08,600][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:54:38,423][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:55:08,880][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:55:39,296][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:56:08,999][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:56:39,519][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:57:09,885][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:57:40,402][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:58:10,356][root][INFO] - Processing question number 80
[2025-02-21 08:58:10,361][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:58:40,750][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:59:11,127][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:59:40,976][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:00:11,056][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:00:41,842][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:01:12,444][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:01:43,073][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:02:13,072][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:02:43,364][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:03:12,965][root][INFO] - Processing question number 90
[2025-02-21 09:03:12,971][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:03:44,009][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:04:13,119][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:04:43,116][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:05:12,358][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:05:42,885][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:06:12,484][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:06:42,408][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:07:12,611][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:07:43,285][root][INFO] - Inference complete
[2025-02-21 09:07:43,285][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,292][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,293][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 09:07:43,294][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 09:07:43,294][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 09:07:43,295][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 09:07:43,295][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 09:07:43,295][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 09:07:43,295][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 09:07:43,295][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 09:07:43,296][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 09:07:43,296][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 09:07:43,296][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 09:07:43,296][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 09:07:43,297][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 09:07:43,297][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 09:07:43,297][root][ERROR] - |Q. 94||D: Contracts| Failed to extract chosen option: 
[2025-02-21 09:07:43,297][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 09:07:43,297][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 09:07:43,297][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 09:07:43,298][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 09:07:43,298][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 09:07:43,298][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 09:07:43,298][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 09:07:43,298][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 09:07:43,299][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 09:07:43,299][root][ERROR] - |Q. 40||D: Evidence| Failed to extract chosen option: 
[2025-02-21 09:07:43,300][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 09:07:43,300][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 09:07:43,300][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 09:07:43,301][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 09:07:43,301][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 09:07:43,302][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 09:07:43,303][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,316][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,316][root][INFO] - Saved parsed outputs
[2025-02-21 09:07:43,316][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,333][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,333][root][INFO] - Saved parsing metadata
[2025-02-21 09:07:43,333][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,335][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:07:43,336][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:07:43,350][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 09:07:43,350][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.12121212121212122, 'malformed_label': 6, 'malformed_domain': 50, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.0707070707070707, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 16, 'both_wrong': 34}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 09:07:49,842][root][INFO] - Setting global seed to 989
[2025-02-21 09:07:49,848][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 09:07:49,849][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 09:07:49,850][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 09:07:49,852][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:07:49,854][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:07:49,854][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 09:07:49,999][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:07:50,249][root][INFO] - Full model selected, loading model
[2025-02-21 09:08:06,709][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 09:08:06,709][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 09:08:12,932][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:08:12,933][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:08:12,933][root][INFO] - Starting inference
[2025-02-21 09:08:13,146][root][INFO] - Processing question number 0
[2025-02-21 09:08:13,165][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 09:08:42,527][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 09:09:12,883][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 09:09:42,745][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 09:10:13,085][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 09:10:42,865][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 09:11:12,617][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 09:11:43,145][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 09:12:13,206][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 09:12:42,901][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 09:13:13,245][root][INFO] - Processing question number 10
[2025-02-21 09:13:13,248][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 09:13:44,977][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 09:14:14,407][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 09:14:44,424][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 09:15:15,008][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 09:15:45,565][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 09:16:15,148][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 09:16:44,567][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 09:17:14,552][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 09:17:44,470][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 09:18:14,164][root][INFO] - Processing question number 20
[2025-02-21 09:18:14,167][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 09:18:44,060][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 09:19:14,185][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 09:19:43,762][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 09:20:13,194][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 09:20:43,397][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 09:21:13,390][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 09:21:44,158][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 09:22:14,078][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 09:22:44,160][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 09:23:13,559][root][INFO] - Processing question number 30
[2025-02-21 09:23:13,562][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:23:43,887][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 09:24:14,499][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 09:24:44,634][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 09:25:14,523][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 09:25:44,294][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 09:26:14,801][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 09:26:44,771][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 09:27:15,118][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:27:45,176][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 09:28:15,926][root][INFO] - Processing question number 40
[2025-02-21 09:28:15,930][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:28:46,049][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 09:29:16,164][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 09:29:46,736][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 09:30:17,257][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 09:30:47,044][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:31:17,117][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 09:31:48,504][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:32:17,665][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 09:32:47,625][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 09:33:18,233][root][INFO] - Processing question number 50
[2025-02-21 09:33:18,237][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:33:49,015][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 09:34:19,202][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 09:34:48,555][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 09:35:19,677][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 09:35:49,831][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 09:36:19,016][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 09:36:49,761][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 09:37:19,364][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 09:37:49,960][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 09:38:21,407][root][INFO] - Processing question number 60
[2025-02-21 09:38:21,411][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:38:50,981][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:39:20,863][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 09:39:51,374][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 09:40:20,926][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 09:40:50,958][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 09:41:21,058][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 09:41:51,177][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 09:42:21,605][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:42:51,802][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 09:43:22,493][root][INFO] - Processing question number 70
[2025-02-21 09:43:22,497][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 09:43:52,342][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 09:44:22,251][root][INFO] - Domain : Property, Question : 6
[2025-02-21 09:44:52,014][root][INFO] - Domain : Property, Question : 13
[2025-02-21 09:45:22,376][root][INFO] - Domain : Property, Question : 20
[2025-02-21 09:45:52,684][root][INFO] - Domain : Property, Question : 33
[2025-02-21 09:46:22,339][root][INFO] - Domain : Property, Question : 39
[2025-02-21 09:46:52,796][root][INFO] - Domain : Property, Question : 48
[2025-02-21 09:47:23,054][root][INFO] - Domain : Property, Question : 54
[2025-02-21 09:47:53,511][root][INFO] - Domain : Property, Question : 61
[2025-02-21 09:48:23,361][root][INFO] - Processing question number 80
[2025-02-21 09:48:23,365][root][INFO] - Domain : Property, Question : 67
[2025-02-21 09:48:53,643][root][INFO] - Domain : Property, Question : 75
[2025-02-21 09:49:23,920][root][INFO] - Domain : Property, Question : 83
[2025-02-21 09:49:53,701][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:50:23,527][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:50:54,113][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:51:24,523][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:51:54,986][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:52:24,763][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:52:54,981][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:53:24,532][root][INFO] - Processing question number 90
[2025-02-21 09:53:24,537][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:53:55,516][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:54:24,574][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:54:54,467][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:55:23,687][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:55:54,373][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:56:24,115][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:56:54,047][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:57:24,322][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:57:55,042][root][INFO] - Inference complete
[2025-02-21 09:57:55,042][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,048][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,049][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 09:57:55,050][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 09:57:55,053][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 09:57:55,054][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 09:57:55,054][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 09:57:55,054][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 09:57:55,056][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 09:57:55,056][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 09:57:55,058][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 09:57:55,058][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 09:57:55,061][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,067][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,067][root][INFO] - Saved parsed outputs
[2025-02-21 09:57:55,067][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,068][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,069][root][INFO] - Saved parsing metadata
[2025-02-21 09:57:55,069][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,071][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:57:55,085][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:57:55,125][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 09:57:55,125][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 5, 'malformed_domain': 43, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 14, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 09:58:03,465][root][INFO] - Setting global seed to 206
[2025-02-21 09:58:03,473][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:58:03,474][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 09:58:03,475][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:58:03,476][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:58:03,480][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:58:03,480][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:58:03,642][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:58:03,888][root][INFO] - Full model selected, loading model
[2025-02-21 09:58:20,779][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:59:20,452][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:59:20,453][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:59:45,749][root][INFO] - Peft model loaded successfully
[2025-02-21 09:59:51,788][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:59:51,790][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:59:51,790][root][INFO] - Starting inference
[2025-02-21 09:59:52,008][root][INFO] - Processing question number 0
[2025-02-21 09:59:52,010][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:00:22,118][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:00:52,808][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:01:23,680][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:01:54,019][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:02:23,773][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:02:52,924][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:03:22,603][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:03:52,581][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:04:21,893][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:04:51,781][root][INFO] - Processing question number 10
[2025-02-21 10:04:51,783][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:05:20,845][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:05:50,511][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:06:20,334][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:06:49,662][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:07:19,929][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:07:49,789][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:08:19,610][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:08:49,271][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:09:19,497][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:09:49,892][root][INFO] - Processing question number 20
[2025-02-21 10:09:49,895][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:10:19,006][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:10:48,995][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:11:18,524][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:11:48,200][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:12:17,986][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:12:48,305][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:13:18,140][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:13:48,150][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:14:17,987][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:14:48,417][root][INFO] - Processing question number 30
[2025-02-21 10:14:48,420][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:15:18,312][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:15:48,048][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:16:17,703][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:16:48,100][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:17:17,916][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:17:47,803][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:18:17,643][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:18:48,129][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:19:18,142][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:19:48,168][root][INFO] - Processing question number 40
[2025-02-21 10:19:48,172][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:20:18,168][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:20:47,983][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:21:18,291][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:21:47,437][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:22:17,987][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:22:48,183][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:23:18,004][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:23:47,996][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:24:17,894][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:24:48,149][root][INFO] - Processing question number 50
[2025-02-21 10:24:48,153][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:25:18,644][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:25:48,079][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:26:18,571][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:26:48,674][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:27:18,151][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:27:47,911][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:28:18,573][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:28:48,958][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:29:19,338][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:29:49,537][root][INFO] - Processing question number 60
[2025-02-21 10:29:49,541][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:30:19,473][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:30:49,465][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:31:20,179][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:31:50,423][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:32:20,543][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:32:50,179][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:33:19,635][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:33:48,984][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:34:18,593][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:34:48,128][root][INFO] - Processing question number 70
[2025-02-21 10:34:48,147][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:35:18,254][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:35:48,256][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:36:18,507][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:36:49,223][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:37:18,751][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:37:48,967][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:38:20,186][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:38:50,401][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:39:19,548][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:39:49,127][root][INFO] - Processing question number 80
[2025-02-21 10:39:49,131][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:40:19,610][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:40:50,137][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:41:20,571][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:41:50,771][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:42:21,950][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:42:51,724][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:43:22,060][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:43:52,925][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:44:22,933][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:44:52,962][root][INFO] - Processing question number 90
[2025-02-21 10:44:52,969][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:45:23,009][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:45:53,408][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:46:23,702][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:46:53,705][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:47:24,388][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:47:54,912][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:48:25,154][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:48:55,147][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:49:24,616][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:49:55,269][root][INFO] - Inference complete
[2025-02-21 10:49:55,269][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,278][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:49:55,279][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,280][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 10:49:55,280][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:49:55,280][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,280][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:49:55,280][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,281][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,281][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,281][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,281][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,281][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,281][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,282][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 10:49:55,283][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,283][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,284][root][ERROR] - |Q. 28||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,284][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,284][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,284][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,284][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 97||D: Contracts| Failed to extract chosen option: 
[2025-02-21 10:49:55,285][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 10:49:55,285][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:49:55,285][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,287][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,288][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,288][root][ERROR] - |Q. 17||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,289][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,289][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 91||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,290][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,291][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,292][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,292][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,292][root][ERROR] - |Q. 45||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,292][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,292][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,293][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 10:49:55,293][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 10:49:55,293][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 10:49:55,294][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,304][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,304][root][INFO] - Saved parsed outputs
[2025-02-21 10:49:55,304][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,309][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,309][root][INFO] - Saved parsing metadata
[2025-02-21 10:49:55,309][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,311][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:49:55,320][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:49:55,380][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 10:49:55,380][root][INFO] - Summary of metrics : {'label_accuracy': 0.21, 'misclassification_rate': 0.79, 'combined_accuracy': 0.12, 'malformed_label': 43, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 21, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.25, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 9, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 10:50:08,052][root][INFO] - Setting global seed to 206
[2025-02-21 10:50:08,060][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 10:50:08,060][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 10:50:08,061][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:50:08,062][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:50:08,067][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:50:08,067][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:50:08,213][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:50:08,479][root][INFO] - Full model selected, loading model
[2025-02-21 10:50:26,989][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 10:50:26,989][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 10:50:33,361][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:50:33,363][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:50:33,363][root][INFO] - Starting inference
[2025-02-21 10:50:33,565][root][INFO] - Processing question number 0
[2025-02-21 10:50:33,584][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:51:03,734][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:51:34,302][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:52:05,083][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:52:35,345][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:53:04,983][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:53:34,066][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:54:03,673][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:54:33,572][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:55:02,715][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:55:32,520][root][INFO] - Processing question number 10
[2025-02-21 10:55:32,522][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:56:01,533][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:56:31,112][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:57:00,812][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:57:29,965][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:58:00,089][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:58:29,878][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:58:59,567][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:59:29,143][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:59:59,239][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:00:29,469][root][INFO] - Processing question number 20
[2025-02-21 11:00:29,472][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:00:58,511][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:01:28,412][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:01:57,864][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:02:27,457][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:02:57,116][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:03:27,346][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:03:57,067][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:04:26,989][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:04:56,708][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:05:27,048][root][INFO] - Processing question number 30
[2025-02-21 11:05:27,051][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:05:56,861][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:06:26,482][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:06:56,058][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:07:26,369][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:07:56,061][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:08:25,863][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:08:55,583][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:09:25,986][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:09:55,912][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:10:25,862][root][INFO] - Processing question number 40
[2025-02-21 11:10:25,865][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:10:55,777][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:11:25,463][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:11:55,688][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:12:24,766][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:12:55,186][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:13:25,077][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:13:54,783][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:14:24,685][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:14:54,499][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:15:24,625][root][INFO] - Processing question number 50
[2025-02-21 11:15:24,629][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:15:55,029][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:16:24,387][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:16:54,797][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:17:24,823][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:17:54,233][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:18:23,873][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:18:54,407][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:19:24,708][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:19:55,017][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:20:25,093][root][INFO] - Processing question number 60
[2025-02-21 11:20:25,097][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:20:54,959][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:21:24,879][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:21:55,471][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:22:25,592][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:22:55,627][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:23:25,190][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:23:54,587][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:24:23,773][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:24:53,314][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:25:22,786][root][INFO] - Processing question number 70
[2025-02-21 11:25:22,792][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:25:52,859][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:26:22,828][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:26:52,958][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:27:23,625][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:27:53,088][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:28:23,175][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:28:54,330][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:29:24,429][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:29:53,512][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:30:23,034][root][INFO] - Processing question number 80
[2025-02-21 11:30:23,040][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:30:53,445][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:31:23,892][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:31:54,269][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:32:24,342][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:32:55,346][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:33:25,013][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:33:55,273][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:34:26,066][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:34:56,008][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:35:25,977][root][INFO] - Processing question number 90
[2025-02-21 11:35:25,983][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:35:55,960][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:36:26,283][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:36:56,391][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:37:26,285][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:37:56,819][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:38:27,239][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:38:57,350][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:39:27,033][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:39:56,247][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:40:26,690][root][INFO] - Inference complete
[2025-02-21 11:40:26,690][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,699][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,700][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,701][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,701][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,701][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,701][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,702][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,702][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,702][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:40:26,702][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,703][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:40:26,703][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,703][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:40:26,703][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,703][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,704][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:40:26,704][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,704][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:40:26,704][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,705][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 28||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,706][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 65||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:40:26,707][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 11:40:26,708][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:40:26,708][root][ERROR] - |Q. 16||D: Evidence| Failed to extract chosen option: 
[2025-02-21 11:40:26,708][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:40:26,708][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 11:40:26,709][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:40:26,709][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 11:40:26,709][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 98||D: Evidence| Failed to extract chosen option: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:40:26,710][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 11:40:26,711][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:40:26,711][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 11:40:26,711][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:40:26,711][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 11:40:26,712][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:40:26,712][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 11:40:26,712][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 11:40:26,712][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 11:40:26,713][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 11:40:26,713][root][ERROR] - |Q. 36||D: Property| Failed to extract chosen option: 
[2025-02-21 11:40:26,713][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 11:40:26,713][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 11:40:26,713][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 11:40:26,714][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 11:40:26,714][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 11:40:26,714][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 11:40:26,714][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 11:40:26,714][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 22||D: Torts| Failed to extract chosen option: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 11:40:26,715][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 11:40:26,717][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,722][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,722][root][INFO] - Saved parsed outputs
[2025-02-21 11:40:26,722][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,725][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,725][root][INFO] - Saved parsing metadata
[2025-02-21 11:40:26,725][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,727][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:40:26,728][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:40:26,741][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 11:40:26,741][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.09, 'malformed_label': 42, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 9, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.23, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 6, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 11:40:32,858][root][INFO] - Setting global seed to 206
[2025-02-21 11:40:32,863][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 11:40:32,863][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 11:40:32,864][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:40:32,866][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:40:32,868][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:40:32,868][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:40:33,030][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:40:33,281][root][INFO] - Full model selected, loading model
[2025-02-21 11:40:47,213][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 11:41:48,219][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 11:41:48,220][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 11:42:14,294][root][INFO] - Peft model loaded successfully
[2025-02-21 11:42:20,479][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:42:20,482][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:42:20,482][root][INFO] - Starting inference
[2025-02-21 11:42:20,724][root][INFO] - Processing question number 0
[2025-02-21 11:42:20,726][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:42:51,185][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:43:22,050][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:43:53,074][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:44:23,576][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:44:53,498][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:45:22,810][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:45:52,667][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:46:22,810][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:46:52,290][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:47:22,338][root][INFO] - Processing question number 10
[2025-02-21 11:47:22,341][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:47:51,572][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:48:21,409][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:48:51,404][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:49:20,941][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:49:51,388][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:50:21,447][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:50:51,457][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:51:21,293][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:51:51,684][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:52:22,161][root][INFO] - Processing question number 20
[2025-02-21 11:52:22,165][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:52:51,437][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:53:21,593][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:53:51,288][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:54:21,133][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:54:51,085][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:55:21,565][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:55:51,579][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:56:21,772][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:56:51,785][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:57:22,377][root][INFO] - Processing question number 30
[2025-02-21 11:57:22,380][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:57:52,436][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:58:22,351][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:58:52,185][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:59:22,747][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:59:52,728][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:00:22,783][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:00:52,805][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:01:23,460][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:01:53,637][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:02:23,844][root][INFO] - Processing question number 40
[2025-02-21 12:02:23,848][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:02:54,018][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:03:23,996][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:03:54,471][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:04:23,780][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:04:54,449][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:05:24,595][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:05:54,587][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:06:24,745][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:06:54,801][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:07:25,220][root][INFO] - Processing question number 50
[2025-02-21 12:07:25,224][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:07:55,875][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:08:25,474][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:08:56,133][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:09:26,405][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:09:56,056][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:10:25,981][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:10:56,818][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:11:27,370][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:11:57,917][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:12:28,286][root][INFO] - Processing question number 60
[2025-02-21 12:12:28,290][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:12:58,407][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:13:28,579][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:13:59,473][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:14:29,891][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:15:00,186][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:15:30,256][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:16:00,105][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:16:29,705][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:16:59,573][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:17:29,352][root][INFO] - Processing question number 70
[2025-02-21 12:17:29,358][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:17:59,725][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:18:29,981][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:19:00,493][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:19:31,493][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:20:01,273][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:20:31,738][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:21:03,225][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:21:33,700][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:22:03,106][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:22:32,948][root][INFO] - Processing question number 80
[2025-02-21 12:22:32,953][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:23:03,702][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:23:34,477][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:24:05,180][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:24:35,623][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:25:07,053][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:25:37,079][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:26:07,665][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:26:38,779][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:27:09,048][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:27:39,335][root][INFO] - Processing question number 90
[2025-02-21 12:27:39,342][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:28:09,643][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:28:40,285][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:29:10,768][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:29:40,982][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:30:11,903][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:30:42,647][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:31:13,134][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:31:43,182][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:32:12,801][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:32:43,606][root][INFO] - Inference complete
[2025-02-21 12:32:43,606][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,615][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,616][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:32:43,617][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,617][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 12:32:43,617][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 12:32:43,617][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:32:43,617][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,618][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:32:43,618][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,618][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:32:43,618][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:32:43,619][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 12:32:43,620][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:32:43,620][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 12:32:43,620][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:32:43,620][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 12:32:43,621][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:32:43,621][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 12:32:43,621][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:32:43,621][root][ERROR] - |Q. 65||D: Contracts| Failed to extract chosen option: 
[2025-02-21 12:32:43,621][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 10||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 16||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,622][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,623][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,623][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 12:32:43,623][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,623][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,623][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:32:43,623][root][ERROR] - |Q. 80||D: Evidence| Failed to extract chosen option: 
[2025-02-21 12:32:43,624][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 12:32:43,624][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 12:32:43,624][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 12:32:43,624][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 12:32:43,624][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 12:32:43,624][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 12:32:43,625][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 12:32:43,625][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 12:32:43,626][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 12:32:43,626][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,627][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 63||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,628][root][ERROR] - |Q. 67||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,629][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 12:32:43,629][root][ERROR] - |Q. 79||D: Torts| Failed to extract chosen option: 
[2025-02-21 12:32:43,630][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,634][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,635][root][INFO] - Saved parsed outputs
[2025-02-21 12:32:43,635][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,636][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,636][root][INFO] - Saved parsing metadata
[2025-02-21 12:32:43,637][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,639][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:32:43,641][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:32:43,808][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 12:32:43,808][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.13, 'malformed_label': 32, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.22, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.01, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 9, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 12:33:10,457][root][INFO] - Setting global seed to 206
[2025-02-21 12:33:10,482][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 12:33:10,482][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 12:33:10,483][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:33:10,485][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:33:10,490][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:33:10,491][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:33:10,642][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:33:10,943][root][INFO] - Full model selected, loading model
[2025-02-21 12:33:29,415][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 12:33:29,415][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 12:33:35,859][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:33:35,861][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:33:35,861][root][INFO] - Starting inference
[2025-02-21 12:33:36,078][root][INFO] - Processing question number 0
[2025-02-21 12:33:36,080][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:34:06,698][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:34:37,521][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:35:08,540][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:35:39,040][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:36:08,981][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:36:38,333][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:37:08,195][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:37:38,329][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:38:07,733][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:38:37,789][root][INFO] - Processing question number 10
[2025-02-21 12:38:37,793][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:39:07,047][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:39:36,883][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:40:06,842][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:40:36,246][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:41:06,632][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:41:36,668][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:42:06,613][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:42:36,443][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:43:06,786][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:43:37,269][root][INFO] - Processing question number 20
[2025-02-21 12:43:37,271][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:44:06,563][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:44:36,716][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:45:06,416][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:45:36,257][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:46:06,168][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:46:36,647][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:47:06,616][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:47:36,788][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:48:06,761][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:48:37,347][root][INFO] - Processing question number 30
[2025-02-21 12:48:37,351][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:49:07,411][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:49:37,270][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:50:07,104][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:50:37,665][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:51:07,610][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:51:37,660][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:52:07,632][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:52:38,283][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:53:08,467][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:53:38,661][root][INFO] - Processing question number 40
[2025-02-21 12:53:38,684][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:54:08,854][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:54:38,790][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:55:09,280][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:55:38,602][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:56:09,279][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:56:39,427][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:57:09,387][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:57:39,547][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:58:09,615][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:58:39,997][root][INFO] - Processing question number 50
[2025-02-21 12:58:40,000][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:59:10,662][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:59:40,276][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:00:10,948][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:00:41,232][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:01:10,903][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:01:40,793][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:02:11,584][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:02:42,144][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:03:12,712][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:03:43,043][root][INFO] - Processing question number 60
[2025-02-21 13:03:43,047][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:04:13,163][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:04:43,340][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:05:14,188][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:05:44,564][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:06:14,860][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:06:44,689][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:07:14,339][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:07:43,775][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:08:13,566][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:08:43,288][root][INFO] - Processing question number 70
[2025-02-21 13:08:43,292][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:09:13,585][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:09:43,759][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:10:14,140][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:10:45,040][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:11:14,748][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:11:45,078][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:12:16,474][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:12:46,811][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:13:16,137][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:13:45,895][root][INFO] - Processing question number 80
[2025-02-21 13:13:45,900][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:14:16,559][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:14:47,248][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:15:17,871][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:15:48,185][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:16:19,434][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:16:49,344][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:17:19,846][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:17:50,879][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:18:21,071][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:18:51,272][root][INFO] - Processing question number 90
[2025-02-21 13:18:51,277][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:19:21,500][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:19:52,058][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:20:22,454][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:20:52,606][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:21:23,405][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:21:54,090][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:22:24,448][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:22:54,371][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:23:23,828][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:23:54,506][root][INFO] - Inference complete
[2025-02-21 13:23:54,507][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,516][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,517][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:23:54,517][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,518][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:23:54,518][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,519][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,520][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,520][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,520][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,520][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:23:54,521][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 13:23:54,522][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:23:54,522][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 13:23:54,523][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:23:54,523][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 13:23:54,523][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:23:54,523][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 13:23:54,524][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:23:54,524][root][ERROR] - |Q. 16||D: Evidence| Failed to extract chosen option: 
[2025-02-21 13:23:54,525][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:23:54,525][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 13:23:54,526][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,526][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,526][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,526][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,526][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,527][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,527][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,527][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,527][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,527][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,528][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:23:54,528][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 13:23:54,528][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 13:23:54,528][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 13:23:54,529][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 13:23:54,529][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 13:23:54,529][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 13:23:54,529][root][ERROR] - |Q. 91||D: Property| Failed to extract chosen option: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 13:23:54,530][root][ERROR] - |Q. 22||D: Torts| Failed to extract chosen option: 
[2025-02-21 13:23:54,531][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 13:23:54,531][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 13:23:54,532][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,538][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,538][root][INFO] - Saved parsed outputs
[2025-02-21 13:23:54,538][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,540][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,540][root][INFO] - Saved parsing metadata
[2025-02-21 13:23:54,541][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,543][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:23:54,545][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:23:54,558][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 13:23:54,559][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.14, 'malformed_label': 28, 'malformed_domain': 38, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.15, 'Civil_Procedure_confidence': 0.04, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 10, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 13:24:00,950][root][INFO] - Setting global seed to 206
[2025-02-21 13:24:00,955][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 13:24:00,956][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 13:24:00,957][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:24:00,961][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:24:00,963][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:24:00,963][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:24:01,108][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:24:01,357][root][INFO] - Full model selected, loading model
[2025-02-21 13:24:12,652][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 13:25:14,140][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 13:25:14,140][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 13:25:40,576][root][INFO] - Peft model loaded successfully
[2025-02-21 13:25:46,829][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:25:46,831][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:25:46,832][root][INFO] - Starting inference
[2025-02-21 13:25:47,035][root][INFO] - Processing question number 0
[2025-02-21 13:25:47,038][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:26:17,566][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:26:48,529][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:27:19,646][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:27:50,261][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:28:20,286][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:28:49,699][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:29:19,658][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:29:49,960][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:30:19,549][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:30:49,692][root][INFO] - Processing question number 10
[2025-02-21 13:30:49,694][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:31:19,022][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:31:48,939][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:32:19,024][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:32:48,605][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:33:19,126][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:33:49,253][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:34:19,333][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:34:49,249][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:35:19,737][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:35:50,305][root][INFO] - Processing question number 20
[2025-02-21 13:35:50,308][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:36:19,678][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:36:49,920][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:37:19,706][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:37:49,636][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:38:19,685][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:38:50,254][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:39:20,354][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:39:50,621][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:40:20,725][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:40:51,411][root][INFO] - Processing question number 30
[2025-02-21 13:40:51,414][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:41:21,565][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:41:51,566][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:42:21,496][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:42:52,148][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:43:22,224][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:43:52,365][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:44:22,471][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:44:53,209][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:45:23,478][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:45:53,770][root][INFO] - Processing question number 40
[2025-02-21 13:45:53,775][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:46:24,038][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:46:54,112][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:47:24,691][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:47:54,092][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:48:24,866][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:48:55,111][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:49:25,204][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:49:55,456][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:50:25,616][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:50:56,132][root][INFO] - Processing question number 50
[2025-02-21 13:50:56,137][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:51:26,893][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:51:56,576][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:52:27,330][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:52:57,695][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:53:27,439][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:53:57,454][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:54:28,383][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:54:59,024][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:55:29,674][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:56:00,131][root][INFO] - Processing question number 60
[2025-02-21 13:56:00,136][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:56:30,338][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:57:00,589][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:57:31,575][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:58:02,077][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:58:32,454][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:59:02,343][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:59:32,069][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:00:01,667][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:00:31,547][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:01:01,341][root][INFO] - Processing question number 70
[2025-02-21 14:01:01,346][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:01:31,719][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:02:02,006][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:02:32,520][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:03:03,517][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:03:33,309][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:04:03,777][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:04:35,268][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:05:05,745][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:05:35,160][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:06:05,008][root][INFO] - Processing question number 80
[2025-02-21 14:06:05,014][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:06:35,766][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:07:06,564][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:07:37,298][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:08:07,752][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:08:39,206][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:09:09,243][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:09:39,839][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:10:10,966][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:10:41,246][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:11:11,544][root][INFO] - Processing question number 90
[2025-02-21 14:11:11,550][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:11:41,861][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:12:12,513][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:12:42,997][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:13:13,214][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:13:44,131][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:14:14,880][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:14:45,376][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:15:15,424][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:15:45,043][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:16:15,845][root][INFO] - Inference complete
[2025-02-21 14:16:15,845][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,857][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,859][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 14:16:15,859][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 14:16:15,859][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 14:16:15,859][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 14:16:15,859][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 14:16:15,860][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 14:16:15,860][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 14:16:15,860][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 14:16:15,860][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 14:16:15,860][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 14:16:15,861][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 14:16:15,861][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 14:16:15,862][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 14:16:15,862][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 14:16:15,862][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 14:16:15,862][root][ERROR] - |Q. 65||D: Contracts| Failed to extract chosen option: 
[2025-02-21 14:16:15,863][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 14:16:15,863][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 14:16:15,863][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 14:16:15,863][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 14:16:15,863][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 14:16:15,864][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 14:16:15,864][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 14:16:15,864][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 14:16:15,864][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 14:16:15,864][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 14:16:15,864][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 14:16:15,865][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 14:16:15,865][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 14:16:15,865][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 14:16:15,865][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 14:16:15,866][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 14:16:15,866][root][ERROR] - |Q. 17||D: Property| Failed to extract chosen option: 
[2025-02-21 14:16:15,866][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 14:16:15,866][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 14:16:15,866][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 14:16:15,867][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 14:16:15,867][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 14:16:15,869][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,876][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,876][root][INFO] - Saved parsed outputs
[2025-02-21 14:16:15,876][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,883][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,883][root][INFO] - Saved parsing metadata
[2025-02-21 14:16:15,884][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,886][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:15,888][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:16:16,039][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 14:16:16,039][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.12, 'malformed_label': 8, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 14, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 14:16:23,196][root][INFO] - Setting global seed to 206
[2025-02-21 14:16:23,203][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 14:16:23,203][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 14:16:23,205][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:16:23,206][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:16:23,209][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:16:23,209][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:16:23,386][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:16:23,632][root][INFO] - Full model selected, loading model
[2025-02-21 14:16:37,325][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 14:16:37,325][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 14:16:43,741][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:16:43,744][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:16:43,744][root][INFO] - Starting inference
[2025-02-21 14:16:43,953][root][INFO] - Processing question number 0
[2025-02-21 14:16:43,955][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:17:14,267][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:17:45,100][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:18:16,142][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:18:46,664][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:19:16,581][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:19:45,944][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:20:15,830][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:20:46,002][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:21:15,433][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:21:45,511][root][INFO] - Processing question number 10
[2025-02-21 14:21:45,516][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:22:14,800][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:22:44,664][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:23:14,649][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:23:44,087][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:24:14,505][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:24:44,570][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:25:14,544][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:25:44,400][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:26:14,778][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:26:45,288][root][INFO] - Processing question number 20
[2025-02-21 14:26:45,291][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:27:14,614][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:27:44,795][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:28:14,529][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:28:44,398][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:29:14,340][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:29:44,842][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:30:14,840][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:30:45,060][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:31:15,057][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:31:45,674][root][INFO] - Processing question number 30
[2025-02-21 14:31:45,677][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:32:15,764][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:32:45,656][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:33:15,519][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:33:46,103][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:34:16,075][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:34:46,156][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:35:16,156][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:35:46,835][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:36:17,047][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:36:47,267][root][INFO] - Processing question number 40
[2025-02-21 14:36:47,270][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:37:17,471][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:37:47,431][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:38:17,934][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:38:47,290][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:39:17,993][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:39:48,171][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:40:18,157][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:40:48,346][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:41:18,441][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:41:48,844][root][INFO] - Processing question number 50
[2025-02-21 14:41:48,848][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:42:19,539][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:42:49,184][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:43:19,880][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:43:50,188][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:44:19,889][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:44:49,811][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:45:20,627][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:45:51,274][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:46:21,895][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:46:52,281][root][INFO] - Processing question number 60
[2025-02-21 14:46:52,286][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:47:22,469][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:47:52,673][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:48:23,541][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:48:53,942][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:49:24,254][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:49:54,085][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:50:23,754][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:50:53,217][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:51:23,030][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:51:52,773][root][INFO] - Processing question number 70
[2025-02-21 14:51:52,778][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:52:23,092][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:52:53,291][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:53:23,702][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:53:54,628][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:54:24,365][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:54:54,715][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:55:26,132][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:55:56,493][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:56:25,851][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:56:55,641][root][INFO] - Processing question number 80
[2025-02-21 14:56:55,646][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:57:26,330][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:57:57,041][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:58:27,689][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:58:58,025][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:59:29,300][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:59:59,231][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:00:29,756][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:01:00,816][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:01:31,036][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:02:01,265][root][INFO] - Processing question number 90
[2025-02-21 15:02:01,270][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:02:31,513][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:03:02,101][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:03:32,477][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:04:02,631][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:04:33,433][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:05:04,112][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:05:34,490][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:06:04,437][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:06:33,925][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:07:04,637][root][INFO] - Inference complete
[2025-02-21 15:07:04,637][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,644][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,647][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:07:04,647][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:07:04,647][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:07:04,649][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:07:04,649][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:07:04,653][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 15:07:04,653][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 15:07:04,653][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 15:07:04,653][root][ERROR] - |Q. 36||D: Property| Failed to extract chosen option: 
[2025-02-21 15:07:04,657][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,662][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,662][root][INFO] - Saved parsed outputs
[2025-02-21 15:07:04,663][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,664][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,664][root][INFO] - Saved parsing metadata
[2025-02-21 15:07:04,665][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,666][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:07:04,668][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:07:04,679][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:07:04,679][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.13, 'malformed_label': 5, 'malformed_domain': 50, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 13, 'both_wrong': 37}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 15:07:10,987][root][INFO] - Setting global seed to 989
[2025-02-21 15:07:10,992][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 15:07:10,993][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 15:07:10,994][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:07:10,997][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:07:10,998][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:07:10,999][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:07:11,143][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:07:11,407][root][INFO] - Full model selected, loading model
[2025-02-21 15:07:23,001][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 15:08:24,308][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 15:08:24,309][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 15:08:50,614][root][INFO] - Peft model loaded successfully
[2025-02-21 15:08:56,917][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:08:56,919][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:08:56,919][root][INFO] - Starting inference
[2025-02-21 15:08:57,090][root][INFO] - Processing question number 0
[2025-02-21 15:08:57,093][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:09:27,341][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:09:58,148][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:10:29,111][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:10:59,545][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:11:29,409][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:11:58,661][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:12:28,451][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:12:58,536][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:13:27,952][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:13:57,939][root][INFO] - Processing question number 10
[2025-02-21 15:13:57,941][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:14:27,113][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:14:56,882][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:15:26,810][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:15:56,238][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:16:26,605][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:16:56,575][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:17:26,503][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:17:56,265][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:18:26,601][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:18:57,025][root][INFO] - Processing question number 20
[2025-02-21 15:18:57,028][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:19:26,248][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:19:56,332][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:20:25,963][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:20:55,744][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:21:25,638][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:21:56,059][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:22:26,007][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:22:56,121][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:23:26,066][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:23:56,594][root][INFO] - Processing question number 30
[2025-02-21 15:23:56,597][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:24:26,597][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:24:56,440][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:25:26,208][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:25:56,714][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:26:26,642][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:26:56,679][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:27:26,626][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:27:57,221][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:28:27,335][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:28:57,461][root][INFO] - Processing question number 40
[2025-02-21 15:28:57,465][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:29:27,570][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:29:57,483][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:30:27,889][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:30:57,126][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:31:27,738][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:31:57,830][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:32:27,754][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:32:57,837][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:33:27,838][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:33:58,197][root][INFO] - Processing question number 50
[2025-02-21 15:33:58,201][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:34:28,792][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:34:58,327][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:35:28,930][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:35:59,132][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:36:28,728][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:36:58,588][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:37:29,364][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:37:59,845][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:38:30,327][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:39:00,620][root][INFO] - Processing question number 60
[2025-02-21 15:39:00,624][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:39:30,658][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:40:00,748][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:40:31,570][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:41:01,912][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:41:32,148][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:42:01,877][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:42:31,439][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:43:00,888][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:43:30,610][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:44:00,246][root][INFO] - Processing question number 70
[2025-02-21 15:44:00,251][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:44:30,462][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:45:00,559][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:45:30,916][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:46:01,733][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:46:31,366][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:47:01,681][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:47:33,020][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:48:03,340][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:48:32,598][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:49:02,281][root][INFO] - Processing question number 80
[2025-02-21 15:49:02,286][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:49:32,880][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:50:03,512][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:50:34,049][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:51:04,358][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:51:35,651][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:52:05,528][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:52:35,969][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:53:06,930][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:53:37,041][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:54:07,184][root][INFO] - Processing question number 90
[2025-02-21 15:54:07,189][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:54:37,332][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:55:07,820][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:55:38,144][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:56:08,205][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:56:38,954][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:57:09,542][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:57:39,872][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:58:09,750][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:58:39,237][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:59:09,937][root][INFO] - Inference complete
[2025-02-21 15:59:09,937][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,944][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,944][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:59:09,944][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,945][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:59:09,945][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,946][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:59:09,946][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,946][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,946][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,947][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,947][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,947][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,947][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 15:59:09,947][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:59:09,948][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 15:59:09,949][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 28||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,949][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:59:09,950][root][ERROR] - |Q. 97||D: Contracts| Failed to extract chosen option: 
[2025-02-21 15:59:09,951][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 15:59:09,951][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 15:59:09,951][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:59:09,951][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 15:59:09,952][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,952][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,952][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,952][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,953][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,953][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 17||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,954][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,955][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,955][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 91||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,956][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,957][root][ERROR] - |Q. 45||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,958][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,958][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,958][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 15:59:09,958][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 15:59:09,958][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 15:59:09,959][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,964][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,964][root][INFO] - Saved parsed outputs
[2025-02-21 15:59:09,964][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,965][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,966][root][INFO] - Saved parsing metadata
[2025-02-21 15:59:09,966][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,968][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:09,970][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:59:09,981][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:59:09,981][root][INFO] - Summary of metrics : {'label_accuracy': 0.21, 'misclassification_rate': 0.79, 'combined_accuracy': 0.12, 'malformed_label': 43, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 21, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.25, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 9, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 15:59:16,577][root][INFO] - Setting global seed to 989
[2025-02-21 15:59:16,582][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:59:16,583][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 15:59:16,584][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:59:16,586][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:59:16,588][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:59:16,588][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:59:16,742][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:59:16,993][root][INFO] - Full model selected, loading model
[2025-02-21 15:59:28,827][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:59:28,828][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:59:35,421][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:59:35,423][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:59:35,423][root][INFO] - Starting inference
[2025-02-21 15:59:35,591][root][INFO] - Processing question number 0
[2025-02-21 15:59:35,592][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:00:05,729][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:00:36,474][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:01:07,419][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:01:37,860][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:02:07,680][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:02:36,935][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:03:06,723][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:03:36,796][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:04:06,115][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:04:36,097][root][INFO] - Processing question number 10
[2025-02-21 16:04:36,099][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:05:05,268][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:05:35,019][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:06:04,881][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:06:34,239][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:07:04,567][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:07:34,563][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:08:04,453][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:08:34,193][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:09:04,444][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:09:34,846][root][INFO] - Processing question number 20
[2025-02-21 16:09:34,849][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:10:04,051][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:10:34,113][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:11:03,723][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:11:33,512][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:12:03,361][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:12:33,779][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:13:03,652][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:13:33,739][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:14:03,622][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:14:34,129][root][INFO] - Processing question number 30
[2025-02-21 16:14:34,133][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:15:04,110][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:15:33,895][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:16:03,631][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:16:34,143][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:17:04,027][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:17:34,023][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:18:03,962][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:18:34,566][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:19:04,683][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:19:34,823][root][INFO] - Processing question number 40
[2025-02-21 16:19:34,826][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:20:04,925][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:20:34,799][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:21:05,205][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:21:34,515][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:22:05,151][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:22:35,248][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:23:05,134][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:23:35,225][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:24:05,221][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:24:35,541][root][INFO] - Processing question number 50
[2025-02-21 16:24:35,546][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:25:06,136][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:25:35,686][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:26:06,281][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:26:36,478][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:27:06,054][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:27:35,857][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:28:06,590][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:28:37,081][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:29:07,582][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:29:37,836][root][INFO] - Processing question number 60
[2025-02-21 16:29:37,840][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:30:07,880][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:30:37,976][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:31:08,760][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:31:39,054][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:32:09,254][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:32:38,988][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:33:08,571][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:33:37,926][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:34:07,635][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:34:37,285][root][INFO] - Processing question number 70
[2025-02-21 16:34:37,290][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:35:07,500][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:35:37,608][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:36:07,939][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:36:38,823][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:37:08,499][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:37:38,801][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:38:10,149][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:38:40,430][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:39:09,685][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:39:39,400][root][INFO] - Processing question number 80
[2025-02-21 16:39:39,405][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:40:10,005][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:40:40,635][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:41:11,195][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:41:41,435][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:42:12,608][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:42:42,453][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:43:12,890][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:43:43,865][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:44:13,987][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:44:44,138][root][INFO] - Processing question number 90
[2025-02-21 16:44:44,143][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:45:14,298][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:45:44,804][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:46:15,090][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:46:45,156][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:47:15,850][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:47:46,483][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:48:16,794][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:48:46,675][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:49:16,076][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:49:46,714][root][INFO] - Inference complete
[2025-02-21 16:49:46,714][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,721][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,722][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,722][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,722][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,722][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,723][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,724][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,724][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,724][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:49:46,725][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,725][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:49:46,725][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,725][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:49:46,725][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,726][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,726][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:49:46,726][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,726][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:49:46,726][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,727][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:49:46,727][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 16:49:46,727][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,727][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,727][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 28||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,728][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,729][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,729][root][ERROR] - |Q. 65||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,729][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,729][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,729][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:49:46,730][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 16:49:46,730][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:49:46,730][root][ERROR] - |Q. 16||D: Evidence| Failed to extract chosen option: 
[2025-02-21 16:49:46,731][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:49:46,731][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 16:49:46,731][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:49:46,731][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 16:49:46,732][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:49:46,732][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 16:49:46,732][root][ERROR] - |Q. 98||D: Evidence| Failed to extract chosen option: 
[2025-02-21 16:49:46,732][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 16:49:46,733][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:49:46,734][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 16:49:46,734][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:49:46,734][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 16:49:46,734][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 16:49:46,735][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 16:49:46,735][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 16:49:46,735][root][ERROR] - |Q. 36||D: Property| Failed to extract chosen option: 
[2025-02-21 16:49:46,735][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 16:49:46,735][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 16:49:46,736][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 16:49:46,736][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 16:49:46,736][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 16:49:46,736][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 22||D: Torts| Failed to extract chosen option: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 16:49:46,737][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 16:49:46,738][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 16:49:46,738][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 16:49:46,739][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,744][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,744][root][INFO] - Saved parsed outputs
[2025-02-21 16:49:46,745][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,746][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,746][root][INFO] - Saved parsing metadata
[2025-02-21 16:49:46,747][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,748][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:49:46,750][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:49:46,763][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 16:49:46,763][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.09, 'malformed_label': 42, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 9, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.23, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 6, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 16:49:53,970][root][INFO] - Setting global seed to 989
[2025-02-21 16:49:53,975][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 16:49:53,975][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 16:49:53,977][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:49:53,978][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:49:53,980][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:49:53,980][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:49:54,128][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:49:54,375][root][INFO] - Full model selected, loading model
[2025-02-21 16:50:05,784][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 16:51:08,656][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 16:51:08,656][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 16:51:35,219][root][INFO] - Peft model loaded successfully
[2025-02-21 16:51:41,516][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:51:41,517][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:51:41,517][root][INFO] - Starting inference
[2025-02-21 16:51:41,709][root][INFO] - Processing question number 0
[2025-02-21 16:51:41,711][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:52:12,263][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:52:43,325][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:53:14,557][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:53:45,252][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:54:15,380][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:54:44,891][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:55:14,957][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:55:45,295][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:56:14,974][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:56:45,222][root][INFO] - Processing question number 10
[2025-02-21 16:56:45,224][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:57:14,650][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:57:44,706][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:58:14,902][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:58:44,597][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:59:15,237][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:59:45,473][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:00:15,660][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:00:45,704][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:01:16,312][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:01:47,004][root][INFO] - Processing question number 20
[2025-02-21 17:01:47,007][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:02:16,490][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:02:46,846][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:03:16,742][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:03:46,778][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:04:16,934][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:04:47,612][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:05:17,844][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:05:48,218][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:06:18,444][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:06:49,224][root][INFO] - Processing question number 30
[2025-02-21 17:06:49,226][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:07:19,483][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:07:49,606][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:08:19,644][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:08:50,408][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:09:20,592][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:09:50,842][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:10:21,054][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:10:51,924][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:11:22,321][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:11:52,728][root][INFO] - Processing question number 40
[2025-02-21 17:11:52,732][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:12:23,097][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:12:53,278][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:13:23,967][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:13:53,480][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:14:24,356][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:14:54,704][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:15:24,905][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:15:55,292][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:16:25,589][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:16:56,247][root][INFO] - Processing question number 50
[2025-02-21 17:16:56,251][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:17:27,120][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:17:56,923][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:18:27,783][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:18:58,251][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:19:28,106][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:19:58,227][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:20:29,259][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:21:00,044][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:21:30,839][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:22:01,442][root][INFO] - Processing question number 60
[2025-02-21 17:22:01,447][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:22:31,754][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:23:02,114][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:23:33,209][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:24:03,820][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:24:34,304][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:25:04,314][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:25:34,162][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:26:03,886][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:26:33,861][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:27:03,749][root][INFO] - Processing question number 70
[2025-02-21 17:27:03,753][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:27:34,272][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:28:04,671][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:28:35,311][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:29:06,434][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:29:36,349][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:30:06,934][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:30:38,559][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:31:09,178][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:31:38,730][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:32:08,703][root][INFO] - Processing question number 80
[2025-02-21 17:32:08,708][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:32:39,577][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:33:10,471][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:33:41,290][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:34:11,841][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:34:43,373][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:35:13,491][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:35:44,199][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:36:15,436][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:36:45,823][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:37:16,223][root][INFO] - Processing question number 90
[2025-02-21 17:37:16,228][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:37:46,632][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:38:17,384][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:38:47,974][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:39:18,295][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:39:49,319][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:40:20,180][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:40:50,807][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:41:20,989][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:41:50,736][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:42:21,635][root][INFO] - Inference complete
[2025-02-21 17:42:21,635][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,642][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,643][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:42:21,643][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,643][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 17:42:21,644][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:42:21,644][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,644][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:42:21,644][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,644][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 17:42:21,644][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 17:42:21,645][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:42:21,645][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,646][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,646][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:42:21,646][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,647][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:42:21,647][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 17:42:21,647][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 17:42:21,647][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 17:42:21,647][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:42:21,647][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 28||D: Contracts| Failed to extract chosen option: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:42:21,648][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 17:42:21,649][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:42:21,649][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 17:42:21,649][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 17:42:21,649][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 17:42:21,650][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:42:21,650][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 17:42:21,650][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 17:42:21,650][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:42:21,650][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 17:42:21,651][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:42:21,651][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 17:42:21,651][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:42:21,651][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 17:42:21,651][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:42:21,652][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 17:42:21,652][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,652][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,653][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,653][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,653][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 17:42:21,653][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 17:42:21,653][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,653][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 91||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,654][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 17:42:21,654][root][ERROR] - |Q. 100||D: Property| Failed to extract chosen option: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 22||D: Torts| Failed to extract chosen option: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 17:42:21,655][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 17:42:21,655][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 17:42:21,656][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 17:42:21,656][root][ERROR] - |Q. 63||D: Torts| Failed to extract chosen option: 
[2025-02-21 17:42:21,656][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 17:42:21,656][root][ERROR] - |Q. 67||D: Torts| Failed to extract chosen option: 
[2025-02-21 17:42:21,656][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 17:42:21,656][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 17:42:21,657][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,662][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,662][root][INFO] - Saved parsed outputs
[2025-02-21 17:42:21,662][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,672][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,672][root][INFO] - Saved parsing metadata
[2025-02-21 17:42:21,672][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,674][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:21,676][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:42:21,688][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 17:42:21,689][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.14, 'malformed_label': 30, 'malformed_domain': 47, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.23, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 8, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 17:42:28,180][root][INFO] - Setting global seed to 989
[2025-02-21 17:42:28,186][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 17:42:28,186][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 17:42:28,187][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:42:28,188][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:42:28,190][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:42:28,191][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:42:28,528][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:42:28,784][root][INFO] - Full model selected, loading model
[2025-02-21 17:42:40,288][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 17:42:40,288][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 17:42:46,735][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:42:46,736][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:42:46,736][root][INFO] - Starting inference
[2025-02-21 17:42:46,915][root][INFO] - Processing question number 0
[2025-02-21 17:42:46,916][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:43:17,301][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:43:48,230][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:44:19,367][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:44:49,964][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:45:19,973][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:45:49,467][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:46:19,469][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:46:49,744][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:47:19,308][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:47:49,489][root][INFO] - Processing question number 10
[2025-02-21 17:47:49,491][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:48:18,878][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:48:48,842][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:49:18,921][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:49:48,461][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:50:18,981][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:50:49,150][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:51:19,220][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:51:49,174][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:52:19,634][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:52:50,242][root][INFO] - Processing question number 20
[2025-02-21 17:52:50,244][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:53:19,647][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:53:49,910][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:54:19,720][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:54:49,680][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:55:19,720][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:55:50,333][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:56:20,441][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:56:50,736][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:57:20,823][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:57:51,521][root][INFO] - Processing question number 30
[2025-02-21 17:57:51,524][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:58:21,691][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:58:51,655][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:59:21,587][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:59:52,242][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:00:22,296][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:00:52,472][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:01:22,564][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:01:53,313][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:02:23,596][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:02:53,893][root][INFO] - Processing question number 40
[2025-02-21 18:02:53,896][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:03:24,162][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:03:54,195][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:04:24,767][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:04:54,191][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:05:24,955][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:05:55,195][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:06:25,247][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:06:55,520][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:07:25,696][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:07:56,193][root][INFO] - Processing question number 50
[2025-02-21 18:07:56,196][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:08:26,956][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:08:56,672][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:09:27,439][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:09:57,817][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:10:27,613][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:10:57,628][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:11:28,535][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:11:59,195][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:12:29,865][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:13:00,296][root][INFO] - Processing question number 60
[2025-02-21 18:13:00,300][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:13:30,519][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:14:00,790][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:14:31,735][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:15:02,212][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:15:32,631][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:16:02,570][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:16:32,344][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:17:01,900][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:17:31,803][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:18:01,629][root][INFO] - Processing question number 70
[2025-02-21 18:18:01,633][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:18:32,025][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:19:02,305][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:19:32,789][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:20:03,823][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:20:33,647][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:21:04,079][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:21:35,571][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:22:06,022][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:22:35,464][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:23:05,330][root][INFO] - Processing question number 80
[2025-02-21 18:23:05,335][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:23:36,095][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:24:06,894][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:24:37,611][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:25:08,046][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:25:39,437][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:26:09,481][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:26:40,102][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:27:11,250][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:27:41,552][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:28:11,871][root][INFO] - Processing question number 90
[2025-02-21 18:28:11,876][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:28:42,220][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:29:12,909][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:29:43,374][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:30:13,643][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:30:44,550][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:31:15,343][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:31:45,819][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:32:15,867][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:32:45,446][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:33:16,260][root][INFO] - Inference complete
[2025-02-21 18:33:16,260][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,267][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,268][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:33:16,268][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,269][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:33:16,269][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,269][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:33:16,269][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,270][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:33:16,270][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,270][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:33:16,270][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,271][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:33:16,271][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,271][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:33:16,271][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,271][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,272][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:33:16,272][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 18:33:16,273][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:33:16,273][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 18:33:16,273][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:33:16,273][root][ERROR] - |Q. 42||D: Contracts| Failed to extract chosen option: 
[2025-02-21 18:33:16,273][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:33:16,274][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 18:33:16,274][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:33:16,274][root][ERROR] - |Q. 65||D: Contracts| Failed to extract chosen option: 
[2025-02-21 18:33:16,276][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:33:16,276][root][ERROR] - |Q. 80||D: Evidence| Failed to extract chosen option: 
[2025-02-21 18:33:16,276][root][ERROR] - |Q. 98||D: Evidence| Failed to extract chosen option: 
[2025-02-21 18:33:16,277][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:33:16,277][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 18:33:16,277][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 18:33:16,278][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:33:16,278][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 18:33:16,278][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:33:16,278][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 18:33:16,279][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 18:33:16,279][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-21 18:33:16,279][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 18:33:16,279][root][ERROR] - |Q. 36||D: Property| Failed to extract chosen option: 
[2025-02-21 18:33:16,280][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 18:33:16,280][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 18:33:16,281][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 18:33:16,281][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 18:33:16,281][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 18:33:16,281][root][ERROR] - |Q. 22||D: Torts| Failed to extract chosen option: 
[2025-02-21 18:33:16,283][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,288][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,288][root][INFO] - Saved parsed outputs
[2025-02-21 18:33:16,288][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,289][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,290][root][INFO] - Saved parsing metadata
[2025-02-21 18:33:16,290][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,292][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:33:16,294][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:33:16,330][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 18:33:16,330][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.19, 'malformed_label': 24, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.23, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 7, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 18:33:23,576][root][INFO] - Setting global seed to 989
[2025-02-21 18:33:23,581][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 18:33:23,582][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 18:33:23,583][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:33:23,585][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:33:23,587][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:33:23,588][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:33:23,737][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:33:24,029][root][INFO] - Full model selected, loading model
[2025-02-21 18:33:37,665][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 18:34:40,110][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 18:34:40,110][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 18:35:05,963][root][INFO] - Peft model loaded successfully
[2025-02-21 18:35:12,135][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:35:12,136][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:35:12,137][root][INFO] - Starting inference
[2025-02-21 18:35:12,338][root][INFO] - Processing question number 0
[2025-02-21 18:35:12,340][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:35:43,055][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:36:14,147][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:36:45,334][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:37:15,922][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:37:45,931][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:38:15,332][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:38:45,277][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:39:15,510][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:39:45,079][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:40:15,353][root][INFO] - Processing question number 10
[2025-02-21 18:40:15,355][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:40:44,838][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:41:14,783][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:41:44,855][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:42:14,437][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:42:44,956][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:43:15,093][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:43:45,165][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:44:15,086][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:44:45,730][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:45:16,497][root][INFO] - Processing question number 20
[2025-02-21 18:45:16,500][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:45:45,908][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:46:16,178][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:46:45,970][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:47:15,896][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:47:45,929][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:48:16,491][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:48:46,583][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:49:16,938][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:49:47,291][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:50:18,027][root][INFO] - Processing question number 30
[2025-02-21 18:50:18,030][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:50:48,200][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:51:18,209][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:51:48,121][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:52:18,766][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:52:48,825][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:53:18,955][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:53:49,146][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:54:20,083][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:54:50,456][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:55:20,754][root][INFO] - Processing question number 40
[2025-02-21 18:55:20,758][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:55:51,005][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:56:21,177][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:56:51,740][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:57:21,134][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:57:51,896][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:58:22,229][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:58:52,496][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:59:22,842][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:59:53,068][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:00:23,607][root][INFO] - Processing question number 50
[2025-02-21 19:00:23,611][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:00:54,381][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:01:24,080][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:01:54,836][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:02:25,195][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:02:55,030][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:03:25,279][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:03:56,433][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:04:27,153][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:04:57,824][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:05:28,309][root][INFO] - Processing question number 60
[2025-02-21 19:05:28,314][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:05:58,524][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:06:28,863][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:06:59,873][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:07:30,509][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:08:01,088][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:08:31,169][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:09:00,965][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:09:30,617][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:10:00,531][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:10:30,366][root][INFO] - Processing question number 70
[2025-02-21 19:10:30,370][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:11:00,779][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:11:31,079][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:12:01,717][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:12:32,883][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:13:02,875][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:13:33,363][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:14:04,876][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:14:35,429][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:15:04,868][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:15:34,746][root][INFO] - Processing question number 80
[2025-02-21 19:15:34,752][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:16:05,522][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:16:36,456][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:17:07,271][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:17:37,881][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:18:09,345][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:18:39,407][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:19:10,035][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:19:41,278][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:20:11,582][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:20:41,899][root][INFO] - Processing question number 90
[2025-02-21 19:20:41,905][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:21:12,367][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:21:43,096][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:22:13,729][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:22:43,967][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:23:14,899][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:23:45,674][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:24:16,239][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:24:46,301][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:25:15,923][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:25:46,812][root][INFO] - Inference complete
[2025-02-21 19:25:46,812][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,819][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,820][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 19:25:46,821][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 19:25:46,821][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 19:25:46,821][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 19:25:46,821][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 19:25:46,822][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 19:25:46,822][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 19:25:46,822][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 19:25:46,823][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 19:25:46,823][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 19:25:46,823][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 19:25:46,823][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 19:25:46,823][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 19:25:46,823][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 19:25:46,824][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 19:25:46,824][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 19:25:46,824][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 19:25:46,824][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 19:25:46,824][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 19:25:46,824][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 19:25:46,824][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 19:25:46,825][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 19:25:46,825][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 19:25:46,825][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 19:25:46,825][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 19:25:46,826][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 19:25:46,826][root][ERROR] - |Q. 43||D: Evidence| Failed to extract chosen option: 
[2025-02-21 19:25:46,826][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 19:25:46,826][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 19:25:46,826][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 19:25:46,827][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 19:25:46,827][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 19:25:46,828][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 19:25:46,828][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 19:25:46,828][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 19:25:46,828][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 19:25:46,829][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 19:25:46,829][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 19:25:46,829][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 19:25:46,829][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 19:25:46,829][root][ERROR] - |Q. 59||D: Property| Failed to extract chosen option: 
[2025-02-21 19:25:46,829][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 19:25:46,829][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 19:25:46,830][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 19:25:46,830][root][ERROR] - |Q. 39||D: Torts| Failed to extract chosen option: 
[2025-02-21 19:25:46,831][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 19:25:46,831][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 19:25:46,831][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 19:25:46,831][root][ERROR] - |Q. 79||D: Torts| Failed to extract chosen option: 
[2025-02-21 19:25:46,831][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 19:25:46,832][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,837][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,837][root][INFO] - Saved parsed outputs
[2025-02-21 19:25:46,837][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,838][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,838][root][INFO] - Saved parsing metadata
[2025-02-21 19:25:46,839][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,841][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:25:46,842][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:25:46,896][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 19:25:46,896][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.17, 'malformed_label': 15, 'malformed_domain': 57, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.04, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 18, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 27 to status running with exit code None
Eval status update completed for job 27
[2025-02-21 19:26:01,665][root][INFO] - Setting global seed to 989
[2025-02-21 19:26:01,674][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 19:26:01,674][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 19:26:01,676][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 19:26:01,677][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 19:26:01,682][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 19:26:01,682][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 19:26:01,840][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 19:26:02,121][root][INFO] - Full model selected, loading model
[2025-02-21 19:26:19,355][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 19:26:19,355][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 19:26:25,726][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 19:26:25,727][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:26:25,727][root][INFO] - Starting inference
[2025-02-21 19:26:25,917][root][INFO] - Processing question number 0
[2025-02-21 19:26:25,919][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 19:26:56,658][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 19:27:27,477][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 19:27:58,486][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 19:28:28,995][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 19:28:58,902][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 19:29:28,268][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 19:29:58,136][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 19:30:28,289][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 19:30:57,711][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 19:31:27,793][root][INFO] - Processing question number 10
[2025-02-21 19:31:27,796][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 19:31:57,085][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 19:32:26,958][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 19:32:56,925][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 19:33:26,356][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 19:33:56,752][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 19:34:26,879][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 19:34:56,904][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 19:35:26,798][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 19:35:57,149][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 19:36:27,674][root][INFO] - Processing question number 20
[2025-02-21 19:36:27,676][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 19:36:56,994][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 19:37:27,213][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 19:37:56,973][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 19:38:26,892][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 19:38:56,865][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 19:39:27,341][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 19:39:57,338][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 19:40:27,552][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 19:40:57,589][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 19:41:28,235][root][INFO] - Processing question number 30
[2025-02-21 19:41:28,238][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 19:41:58,358][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 19:42:28,295][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 19:42:58,194][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 19:43:28,827][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 19:43:58,830][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 19:44:28,885][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 19:44:58,857][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 19:45:29,524][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 19:45:59,790][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 19:46:30,055][root][INFO] - Processing question number 40
[2025-02-21 19:46:30,058][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 19:47:00,277][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 19:47:30,274][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 19:48:00,804][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 19:48:30,182][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 19:49:00,899][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 19:49:31,056][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 19:50:01,018][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 19:50:31,206][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 19:51:01,312][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:51:31,724][root][INFO] - Processing question number 50
[2025-02-21 19:51:31,728][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:52:02,436][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:52:32,108][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:53:02,820][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:53:33,155][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:54:02,872][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:54:32,805][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:55:03,630][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:55:34,201][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:56:04,808][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:56:35,159][root][INFO] - Processing question number 60
[2025-02-21 19:56:35,163][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:57:05,291][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:57:35,481][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:58:06,352][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:58:36,762][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:59:07,132][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:59:37,013][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 20:00:06,737][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 20:00:36,207][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 20:01:06,036][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 20:01:35,808][root][INFO] - Processing question number 70
[2025-02-21 20:01:35,813][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 20:02:06,160][root][INFO] - Domain : Property, Question : 9
[2025-02-21 20:02:36,394][root][INFO] - Domain : Property, Question : 17
[2025-02-21 20:03:06,831][root][INFO] - Domain : Property, Question : 25
[2025-02-21 20:03:37,797][root][INFO] - Domain : Property, Question : 30
[2025-02-21 20:04:07,569][root][INFO] - Domain : Property, Question : 36
[2025-02-21 20:04:37,960][root][INFO] - Domain : Property, Question : 46
[2025-02-21 20:05:09,402][root][INFO] - Domain : Property, Question : 53
[2025-02-21 20:05:39,775][root][INFO] - Domain : Property, Question : 59
[2025-02-21 20:06:09,153][root][INFO] - Domain : Property, Question : 66
[2025-02-21 20:06:38,945][root][INFO] - Processing question number 80
[2025-02-21 20:06:38,950][root][INFO] - Domain : Property, Question : 69
[2025-02-21 20:07:09,634][root][INFO] - Domain : Property, Question : 81
[2025-02-21 20:07:40,357][root][INFO] - Domain : Property, Question : 88
[2025-02-21 20:08:11,023][root][INFO] - Domain : Property, Question : 91
[2025-02-21 20:08:41,385][root][INFO] - Domain : Property, Question : 94
[2025-02-21 20:09:12,696][root][INFO] - Domain : Property, Question : 100
[2025-02-21 20:09:42,670][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 20:10:13,198][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 20:10:44,275][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 20:11:14,506][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 20:11:44,757][root][INFO] - Processing question number 90
[2025-02-21 20:11:44,762][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 20:12:14,993][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 20:12:45,595][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 20:13:15,970][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 20:13:46,175][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 20:14:17,046][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 20:14:47,806][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 20:15:18,167][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 20:15:48,134][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 20:16:17,621][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 20:16:48,344][root][INFO] - Inference complete
[2025-02-21 20:16:48,344][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,351][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,356][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 20:16:48,359][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 20:16:48,361][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 20:16:48,361][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 20:16:48,364][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,369][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,369][root][INFO] - Saved parsed outputs
[2025-02-21 20:16:48,369][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,370][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,370][root][INFO] - Saved parsing metadata
[2025-02-21 20:16:48,371][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,372][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 20:16:48,373][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 20:16:48,422][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 20:16:48,422][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.16, 'malformed_label': 2, 'malformed_domain': 43, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 13, 'both_wrong': 30}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '27', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 27 to status completed with exit code 0
Eval status update completed for job 27
Job 27 completed at Fri Feb 21 20:16:49 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n516
Job ID: 25309362
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 20:30:53
CPU Efficiency: 9.94% of 8-14:18:20 core-walltime
Job Wall-clock time: 20:37:50
Memory Utilized: 28.79 GB
Memory Efficiency: 79.98% of 36.00 GB
