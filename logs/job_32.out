Starting job 32 at Thu Mar  6 20:35:53 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_10_samples prompt=json_fact_first_zero_shot_unstructured train=json_fact_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '32', 'training']
Updating job 32 to status training with exit code None
Status update completed for job 32
[2025-03-06 20:36:01,155][root][INFO] - Global seed set to 314
[2025-03-06 20:36:01,156][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 20:36:01,156][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 20:36:01,156][root][INFO] - Running Fine-tuning on the all_domains_10_samples dataset
[2025-03-06 20:36:01,157][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:36:01,157][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-03-06 20:36:01,174][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:36:01,179][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 20:36:01,181][root][INFO] - Questions selected, dataset contains 70 questions with 10.0 questions per domain
[2025-03-06 20:36:01,185][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 20:36:01,917][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 20:36:25,734][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 20:36:54,242][root][INFO] - Model prepared for kbit training
[2025-03-06 20:36:54,242][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'v_proj', 'up_proj', 'down_proj', 'o_proj', 'gate_proj', 'k_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 20:36:55,936][root][INFO] - Lora adapter added to model
[2025-03-06 20:36:55,940][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_10_samples/llama3_json_fact_first_zero_shot_unstructured
[2025-03-06 20:36:56,256][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 2.0382, 'grad_norm': 0.560954213142395, 'learning_rate': 2e-05, 'epoch': 0.3}
{'loss': 2.1314, 'grad_norm': 0.7592820525169373, 'learning_rate': 4e-05, 'epoch': 0.6}
{'loss': 1.7542, 'grad_norm': 0.4101436138153076, 'learning_rate': 6e-05, 'epoch': 0.9}
{'loss': 1.7115, 'grad_norm': 0.5042944550514221, 'learning_rate': 8e-05, 'epoch': 1.2}
{'loss': 1.4184, 'grad_norm': 0.5541214942932129, 'learning_rate': 0.0001, 'epoch': 1.5}
{'loss': 1.2402, 'grad_norm': 0.4121038317680359, 'learning_rate': 9.951340343707852e-05, 'epoch': 1.8}
{'loss': 1.1961, 'grad_norm': 0.31391409039497375, 'learning_rate': 9.806308479691595e-05, 'epoch': 2.1}
{'loss': 1.0762, 'grad_norm': 0.38300564885139465, 'learning_rate': 9.567727288213005e-05, 'epoch': 2.4}
{'loss': 1.1235, 'grad_norm': 0.2849498391151428, 'learning_rate': 9.24024048078213e-05, 'epoch': 2.7}
{'loss': 1.1152, 'grad_norm': 0.3845689296722412, 'learning_rate': 8.83022221559489e-05, 'epoch': 3.0}
{'loss': 1.0573, 'grad_norm': 0.3589082360267639, 'learning_rate': 8.345653031794292e-05, 'epoch': 3.3}
{'loss': 0.9687, 'grad_norm': 0.5272167921066284, 'learning_rate': 7.795964517353735e-05, 'epoch': 3.6}
{'loss': 0.9619, 'grad_norm': 0.3690473437309265, 'learning_rate': 7.191855733945387e-05, 'epoch': 3.9}
{'loss': 0.9595, 'grad_norm': 0.4844887852668762, 'learning_rate': 6.545084971874738e-05, 'epoch': 4.2}
{'loss': 0.7774, 'grad_norm': 0.48263227939605713, 'learning_rate': 5.868240888334653e-05, 'epoch': 4.5}
{'loss': 0.8111, 'grad_norm': 0.4717477858066559, 'learning_rate': 5.174497483512506e-05, 'epoch': 4.8}
{'loss': 0.8477, 'grad_norm': 0.5050129890441895, 'learning_rate': 4.477357683661734e-05, 'epoch': 5.1}
{'loss': 0.6913, 'grad_norm': 0.5471243262290955, 'learning_rate': 3.790390522001662e-05, 'epoch': 5.4}
{'loss': 0.6892, 'grad_norm': 0.9044811725616455, 'learning_rate': 3.12696703292044e-05, 'epoch': 5.7}
{'loss': 0.6895, 'grad_norm': 0.6462012529373169, 'learning_rate': 2.500000000000001e-05, 'epoch': 6.0}
{'loss': 0.6695, 'grad_norm': 0.6481506824493408, 'learning_rate': 1.9216926233717085e-05, 'epoch': 6.3}
{'loss': 0.5126, 'grad_norm': 0.6386885046958923, 'learning_rate': 1.4033009983067452e-05, 'epoch': 6.6}
{'loss': 0.6334, 'grad_norm': 0.798280656337738, 'learning_rate': 9.549150281252633e-06, 'epoch': 6.9}
{'loss': 0.5553, 'grad_norm': 0.7425119876861572, 'learning_rate': 5.852620357053651e-06, 'epoch': 7.2}
{'loss': 0.5647, 'grad_norm': 0.6823862791061401, 'learning_rate': 3.0153689607045845e-06, 'epoch': 7.5}
{'loss': 0.5802, 'grad_norm': 0.6893282532691956, 'learning_rate': 1.0926199633097157e-06, 'epoch': 7.8}
{'loss': 0.5965, 'grad_norm': 0.6491647958755493, 'learning_rate': 1.2179748700879012e-07, 'epoch': 8.1}
{'loss': 0.511, 'grad_norm': 0.6295399069786072, 'learning_rate': 9.987820251299122e-05, 'epoch': 8.4}
{'loss': 0.5287, 'grad_norm': 1.189316749572754, 'learning_rate': 9.890738003669029e-05, 'epoch': 8.7}
{'loss': 0.4132, 'grad_norm': 1.0129963159561157, 'learning_rate': 9.698463103929542e-05, 'epoch': 9.0}
{'loss': 0.398, 'grad_norm': 1.9979679584503174, 'learning_rate': 9.414737964294636e-05, 'epoch': 9.3}
{'loss': 0.3033, 'grad_norm': 1.5079094171524048, 'learning_rate': 9.045084971874738e-05, 'epoch': 9.6}
{'loss': 0.3408, 'grad_norm': 1.172150731086731, 'learning_rate': 8.596699001693255e-05, 'epoch': 9.9}
{'loss': 0.1886, 'grad_norm': 0.9632847905158997, 'learning_rate': 8.07830737662829e-05, 'epoch': 10.2}
{'loss': 0.2299, 'grad_norm': 0.9799664616584778, 'learning_rate': 7.500000000000002e-05, 'epoch': 10.5}
{'loss': 0.1736, 'grad_norm': 1.7723138332366943, 'learning_rate': 6.873032967079561e-05, 'epoch': 10.8}
{'loss': 0.2578, 'grad_norm': 1.189557433128357, 'learning_rate': 6.209609477998338e-05, 'epoch': 11.1}
{'loss': 0.0941, 'grad_norm': 0.7857410907745361, 'learning_rate': 5.52264231633827e-05, 'epoch': 11.4}
{'loss': 0.1324, 'grad_norm': 0.9475474953651428, 'learning_rate': 4.825502516487497e-05, 'epoch': 11.7}
{'loss': 0.0882, 'grad_norm': 0.9385114312171936, 'learning_rate': 4.131759111665349e-05, 'epoch': 12.0}
{'loss': 0.0807, 'grad_norm': 0.8959440588951111, 'learning_rate': 3.454915028125262e-05, 'epoch': 12.3}
{'loss': 0.0472, 'grad_norm': 0.5072482824325562, 'learning_rate': 2.8081442660546142e-05, 'epoch': 12.6}
{'loss': 0.0576, 'grad_norm': 0.5745010375976562, 'learning_rate': 2.2040354826462668e-05, 'epoch': 12.9}
{'loss': 0.0377, 'grad_norm': 0.24889788031578064, 'learning_rate': 1.654346968205709e-05, 'epoch': 13.2}
{'loss': 0.0396, 'grad_norm': 0.6048104763031006, 'learning_rate': 1.1697777844051105e-05, 'epoch': 13.5}
{'loss': 0.0375, 'grad_norm': 0.43339577317237854, 'learning_rate': 7.597595192178702e-06, 'epoch': 13.8}
{'loss': 0.029, 'grad_norm': 0.30215778946876526, 'learning_rate': 4.322727117869951e-06, 'epoch': 14.1}
{'loss': 0.0287, 'grad_norm': 0.2096395492553711, 'learning_rate': 1.93691520308405e-06, 'epoch': 14.4}
{'loss': 0.0272, 'grad_norm': 0.26370564103126526, 'learning_rate': 4.865965629214875e-07, 'epoch': 14.7}
{'loss': 0.0246, 'grad_norm': 0.26419681310653687, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 2535.6792, 'train_samples_per_second': 0.414, 'train_steps_per_second': 0.059, 'train_loss': 0.6287998127937316, 'epoch': 15.0}
[2025-03-06 21:19:19,540][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_10_samples/llama3_json_fact_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '32', 'trained', '0']
Updating job 32 to status trained with exit code 0
Status update completed for job 32
Starting evaluations for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 21:19:33,200][root][INFO] - Setting global seed to 206
[2025-03-06 21:19:33,208][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 21:19:33,208][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:19:33,210][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 21:19:33,212][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:19:33,222][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:19:33,222][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 21:19:33,380][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 21:19:33,980][root][INFO] - Full model selected, loading model
[2025-03-06 21:19:53,696][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:21:42,554][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:21:42,555][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:22:15,565][root][INFO] - Peft model loaded successfully
[2025-03-06 21:22:23,284][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:22:23,286][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:22:23,287][root][INFO] - Starting inference
[2025-03-06 21:22:23,502][root][INFO] - Processing question number 0
[2025-03-06 21:22:23,504][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 21:22:28,421][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 21:22:40,837][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 21:22:56,649][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 21:23:16,477][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 21:23:33,056][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 21:23:45,471][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 21:24:14,530][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 21:24:36,710][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 21:24:45,557][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 21:24:52,360][root][INFO] - Processing question number 10
[2025-03-06 21:24:52,362][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 21:25:04,802][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 21:25:14,314][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 21:25:42,846][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 21:25:56,829][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 21:26:13,778][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 21:26:30,145][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 21:26:41,165][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 21:26:51,342][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 21:27:00,725][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 21:27:07,510][root][INFO] - Processing question number 20
[2025-03-06 21:27:07,513][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 21:27:15,097][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 21:27:21,246][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 21:27:26,737][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 21:27:31,913][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 21:27:37,689][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 21:27:50,877][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 21:27:55,975][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 21:28:08,002][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 21:28:18,753][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 21:28:25,357][root][INFO] - Processing question number 30
[2025-03-06 21:28:25,359][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:28:33,299][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 21:28:38,450][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 21:28:44,194][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 21:28:52,429][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 21:28:56,466][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 21:29:08,037][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 21:29:12,539][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 21:29:23,660][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:29:28,971][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 21:29:36,491][root][INFO] - Processing question number 40
[2025-03-06 21:29:36,494][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:29:45,811][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 21:29:57,117][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 21:30:07,663][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 21:30:21,130][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 21:30:30,387][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:30:38,118][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 21:30:46,991][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:30:52,598][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 21:31:05,480][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 21:31:18,152][root][INFO] - Processing question number 50
[2025-03-06 21:31:18,155][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:31:30,396][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 21:31:49,558][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 21:31:57,713][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 21:32:09,276][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 21:32:23,931][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:32:29,797][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 21:32:36,043][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 21:32:43,818][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 21:33:01,815][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 21:33:12,455][root][INFO] - Processing question number 60
[2025-03-06 21:33:12,458][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:33:22,986][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:33:33,433][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 21:33:40,434][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 21:33:53,944][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 21:34:15,328][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 21:34:26,561][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 21:34:40,421][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 21:34:54,738][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:35:02,524][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 21:35:14,623][root][INFO] - Processing question number 70
[2025-03-06 21:35:14,627][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 21:35:25,027][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 21:35:39,793][root][INFO] - Domain : Property, Question : 6
[2025-03-06 21:35:58,123][root][INFO] - Domain : Property, Question : 13
[2025-03-06 21:36:07,514][root][INFO] - Domain : Property, Question : 20
[2025-03-06 21:36:17,819][root][INFO] - Domain : Property, Question : 33
[2025-03-06 21:36:26,979][root][INFO] - Domain : Property, Question : 39
[2025-03-06 21:36:37,360][root][INFO] - Domain : Property, Question : 48
[2025-03-06 21:36:49,091][root][INFO] - Domain : Property, Question : 54
[2025-03-06 21:37:00,580][root][INFO] - Domain : Property, Question : 61
[2025-03-06 21:37:14,237][root][INFO] - Processing question number 80
[2025-03-06 21:37:14,241][root][INFO] - Domain : Property, Question : 67
[2025-03-06 21:37:24,299][root][INFO] - Domain : Property, Question : 75
[2025-03-06 21:37:34,523][root][INFO] - Domain : Property, Question : 83
[2025-03-06 21:37:48,545][root][INFO] - Domain : Property, Question : 89
[2025-03-06 21:37:55,662][root][INFO] - Domain : Property, Question : 97
[2025-03-06 21:38:02,145][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:38:12,362][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 21:38:17,374][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:38:27,353][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 21:38:35,829][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 21:38:46,516][root][INFO] - Processing question number 90
[2025-03-06 21:38:46,520][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 21:38:54,714][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 21:38:59,564][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 21:39:06,739][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 21:39:11,036][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:39:17,017][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 21:39:22,908][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 21:39:28,798][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 21:39:40,304][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 21:39:51,793][root][INFO] - Inference complete
[2025-03-06 21:39:51,793][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,800][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,801][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,801][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,801][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,802][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,802][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,802][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,802][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,803][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,803][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,803][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,804][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:39:51,804][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,804][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:39:51,804][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,804][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,804][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,805][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,805][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,805][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,805][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,805][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,805][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,806][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,806][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,806][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,806][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,807][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,807][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,807][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,807][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,807][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,807][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,808][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,808][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,808][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,808][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:39:51,808][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,808][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:39:51,809][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,809][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,809][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,809][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,809][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,809][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,812][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,813][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,813][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,813][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,813][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,813][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,814][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,814][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,815][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,815][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,815][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,815][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,816][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,816][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,816][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,816][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,816][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,816][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,817][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,818][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,818][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,818][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,818][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,818][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,819][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,819][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,819][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,819][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,820][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,820][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,820][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:39:51,821][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:39:51,821][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:39:51,823][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,827][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,827][root][INFO] - Saved parsed outputs
[2025-03-06 21:39:51,827][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,828][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,828][root][INFO] - Saved parsing metadata
[2025-03-06 21:39:51,830][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,832][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:39:51,833][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 21:39:51,864][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 21:39:51,864][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.46464646464646464, 'malformed_label': 2, 'malformed_domain': 7, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 2, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 21:40:18,551][root][INFO] - Setting global seed to 206
[2025-03-06 21:40:18,559][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 21:40:18,559][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:40:18,560][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 21:40:18,563][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:40:18,566][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:40:18,566][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 21:40:18,724][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 21:40:19,290][root][INFO] - Full model selected, loading model
[2025-03-06 21:40:43,477][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:42:27,732][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:42:27,756][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:43:01,448][root][INFO] - Peft model loaded successfully
[2025-03-06 21:43:08,750][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:43:08,751][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:43:08,751][root][INFO] - Starting inference
[2025-03-06 21:43:08,976][root][INFO] - Processing question number 0
[2025-03-06 21:43:08,979][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 21:43:16,488][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 21:43:26,476][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 21:43:43,515][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 21:44:03,418][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 21:44:17,195][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 21:44:28,247][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 21:44:50,070][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 21:45:00,219][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 21:45:20,127][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 21:45:34,597][root][INFO] - Processing question number 10
[2025-03-06 21:45:34,598][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 21:45:40,500][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 21:45:54,034][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 21:46:07,206][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 21:46:17,752][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 21:46:28,741][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 21:46:43,029][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 21:46:53,476][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 21:47:02,426][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 21:47:17,439][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 21:47:24,653][root][INFO] - Processing question number 20
[2025-03-06 21:47:24,655][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 21:47:40,535][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 21:47:44,364][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 21:47:50,313][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 21:48:02,203][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 21:48:07,207][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 21:48:19,296][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 21:48:26,549][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 21:48:38,641][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 21:48:49,496][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 21:48:55,569][root][INFO] - Processing question number 30
[2025-03-06 21:48:55,571][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:49:05,785][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 21:49:14,169][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 21:49:20,065][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 21:49:28,121][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 21:49:32,165][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 21:49:37,961][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 21:49:43,505][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 21:49:57,071][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:50:06,179][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 21:50:16,176][root][INFO] - Processing question number 40
[2025-03-06 21:50:16,179][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:50:25,021][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 21:50:33,677][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 21:50:41,184][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 21:50:51,218][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 21:51:01,944][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:51:07,277][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 21:51:16,232][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:51:22,404][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 21:51:31,855][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 21:51:45,386][root][INFO] - Processing question number 50
[2025-03-06 21:51:45,392][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:51:53,676][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 21:52:03,719][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 21:52:10,193][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 21:52:25,033][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 21:52:35,759][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:52:41,744][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 21:52:54,880][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 21:52:59,756][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 21:53:11,525][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 21:53:22,889][root][INFO] - Processing question number 60
[2025-03-06 21:53:22,892][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:53:33,293][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:53:43,694][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 21:53:49,298][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 21:54:01,900][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 21:54:20,437][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 21:54:39,151][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 21:54:49,695][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 21:55:01,852][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:55:10,130][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 21:55:28,557][root][INFO] - Processing question number 70
[2025-03-06 21:55:28,560][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 21:55:41,613][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 21:55:50,699][root][INFO] - Domain : Property, Question : 6
[2025-03-06 21:56:06,200][root][INFO] - Domain : Property, Question : 13
[2025-03-06 21:56:18,829][root][INFO] - Domain : Property, Question : 20
[2025-03-06 21:56:26,886][root][INFO] - Domain : Property, Question : 33
[2025-03-06 21:56:36,498][root][INFO] - Domain : Property, Question : 39
[2025-03-06 21:56:54,681][root][INFO] - Domain : Property, Question : 48
[2025-03-06 21:57:10,185][root][INFO] - Domain : Property, Question : 54
[2025-03-06 21:57:20,061][root][INFO] - Domain : Property, Question : 61
[2025-03-06 21:57:27,522][root][INFO] - Processing question number 80
[2025-03-06 21:57:27,525][root][INFO] - Domain : Property, Question : 67
[2025-03-06 21:57:38,938][root][INFO] - Domain : Property, Question : 75
[2025-03-06 21:57:47,713][root][INFO] - Domain : Property, Question : 83
[2025-03-06 21:57:56,850][root][INFO] - Domain : Property, Question : 89
[2025-03-06 21:58:13,158][root][INFO] - Domain : Property, Question : 97
[2025-03-06 21:58:27,975][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:58:37,246][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 21:58:44,653][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:58:50,369][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 21:58:55,657][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 21:59:05,832][root][INFO] - Processing question number 90
[2025-03-06 21:59:05,836][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 21:59:14,057][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 21:59:19,179][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 21:59:26,925][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 21:59:32,699][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:59:39,050][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 21:59:48,502][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 21:59:56,638][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 22:00:06,013][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 22:00:24,387][root][INFO] - Inference complete
[2025-03-06 22:00:24,387][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,392][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,393][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,393][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,393][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,394][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,394][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,394][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,395][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,395][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,395][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,395][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,396][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:00:24,396][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,396][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:00:24,396][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,397][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,397][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,397][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,397][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,397][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,398][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,398][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,398][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,398][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,398][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,398][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,399][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,399][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,399][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,399][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,399][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:00:24,400][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,400][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:00:24,400][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,400][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,400][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,400][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,401][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,401][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,403][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,403][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,403][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,404][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,404][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,404][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,405][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,405][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,405][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,405][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,406][root][WARNING] - |Q. 90||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,406][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,407][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,407][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,407][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,407][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,407][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,407][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,408][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,408][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,408][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,409][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,409][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:00:24,409][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,409][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:00:24,410][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,410][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,410][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,411][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:00:24,411][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:00:24,411][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:00:24,413][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,418][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,418][root][INFO] - Saved parsed outputs
[2025-03-06 22:00:24,419][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,420][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,420][root][INFO] - Saved parsing metadata
[2025-03-06 22:00:24,421][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,422][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:00:24,424][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 22:00:24,452][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 22:00:24,453][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.43434343434343436, 'malformed_label': 3, 'malformed_domain': 6, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 1, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 22:00:32,833][root][INFO] - Setting global seed to 206
[2025-03-06 22:00:32,841][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 22:00:32,841][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:00:32,842][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 22:00:32,856][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:00:32,909][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:00:32,909][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 22:00:33,098][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:00:33,841][root][INFO] - Full model selected, loading model
[2025-03-06 22:01:00,826][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:02:44,092][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:02:44,092][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:03:16,808][root][INFO] - Peft model loaded successfully
[2025-03-06 22:03:24,070][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:03:24,075][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:03:24,075][root][INFO] - Starting inference
[2025-03-06 22:03:24,295][root][INFO] - Processing question number 0
[2025-03-06 22:03:24,298][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 22:03:31,703][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 22:03:40,196][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 22:04:08,569][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 22:04:19,371][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 22:04:43,355][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 22:05:07,287][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 22:05:36,152][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 22:05:51,027][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 22:06:05,065][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 22:06:20,818][root][INFO] - Processing question number 10
[2025-03-06 22:06:20,820][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 22:06:32,537][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 22:06:46,343][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 22:06:58,952][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 22:07:11,385][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 22:07:29,563][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 22:07:40,842][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 22:07:50,139][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 22:07:59,636][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 22:08:09,040][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 22:08:15,117][root][INFO] - Processing question number 20
[2025-03-06 22:08:15,119][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 22:08:23,810][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 22:08:28,597][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 22:08:41,315][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 22:08:46,090][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 22:08:50,504][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 22:09:02,821][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 22:09:07,696][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 22:09:25,308][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 22:09:43,727][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 22:09:50,612][root][INFO] - Processing question number 30
[2025-03-06 22:09:50,615][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:09:59,023][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 22:10:07,269][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 22:10:11,877][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 22:10:21,798][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 22:10:26,277][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 22:10:41,318][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 22:10:46,988][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 22:10:55,864][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:11:11,546][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 22:11:25,420][root][INFO] - Processing question number 40
[2025-03-06 22:11:25,423][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:11:35,021][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 22:11:40,535][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 22:11:50,577][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 22:12:01,954][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 22:12:16,177][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:12:26,367][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 22:12:38,685][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:12:43,453][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 22:12:56,005][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 22:13:11,545][root][INFO] - Processing question number 50
[2025-03-06 22:13:11,548][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:13:26,227][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 22:13:40,596][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 22:13:46,339][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 22:13:57,054][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 22:14:07,048][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:14:12,848][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 22:14:19,064][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 22:14:24,922][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 22:14:40,345][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 22:14:50,049][root][INFO] - Processing question number 60
[2025-03-06 22:14:50,053][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:15:03,030][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:15:08,600][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 22:15:24,668][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 22:15:35,029][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 22:15:47,706][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 22:15:56,213][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 22:16:03,244][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 22:16:16,421][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:16:30,257][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 22:16:36,160][root][INFO] - Processing question number 70
[2025-03-06 22:16:36,164][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 22:16:39,197][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 22:16:47,904][root][INFO] - Domain : Property, Question : 6
[2025-03-06 22:16:53,390][root][INFO] - Domain : Property, Question : 13
[2025-03-06 22:17:02,223][root][INFO] - Domain : Property, Question : 20
[2025-03-06 22:17:10,568][root][INFO] - Domain : Property, Question : 33
[2025-03-06 22:17:16,842][root][INFO] - Domain : Property, Question : 39
[2025-03-06 22:17:27,460][root][INFO] - Domain : Property, Question : 48
[2025-03-06 22:17:43,446][root][INFO] - Domain : Property, Question : 54
[2025-03-06 22:17:53,994][root][INFO] - Domain : Property, Question : 61
[2025-03-06 22:18:07,098][root][INFO] - Processing question number 80
[2025-03-06 22:18:07,102][root][INFO] - Domain : Property, Question : 67
[2025-03-06 22:18:17,737][root][INFO] - Domain : Property, Question : 75
[2025-03-06 22:18:27,881][root][INFO] - Domain : Property, Question : 83
[2025-03-06 22:18:36,803][root][INFO] - Domain : Property, Question : 89
[2025-03-06 22:18:48,110][root][INFO] - Domain : Property, Question : 97
[2025-03-06 22:18:54,041][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:19:13,131][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 22:19:19,423][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:19:24,036][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 22:19:30,697][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 22:19:40,014][root][INFO] - Processing question number 90
[2025-03-06 22:19:40,019][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 22:19:45,516][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 22:19:50,401][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 22:20:01,734][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 22:20:06,686][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:20:12,612][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 22:20:19,101][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 22:20:30,962][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 22:20:46,964][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 22:20:58,288][root][INFO] - Inference complete
[2025-03-06 22:20:58,288][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,295][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,295][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,296][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,296][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,296][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,296][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,297][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,297][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,297][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:20:58,298][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,298][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:20:58,298][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,298][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,298][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,298][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,299][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:20:58,299][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,299][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:20:58,299][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,299][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,300][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,300][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,300][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:20:58,300][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,300][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:20:58,301][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,301][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:20:58,301][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,301][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:20:58,301][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,301][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,302][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,302][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,302][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,302][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,303][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,303][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,303][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,303][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,304][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:20:58,304][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,304][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:20:58,308][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,308][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,308][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,308][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,309][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,309][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,310][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,310][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,310][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,311][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,311][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,311][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,312][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,313][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,313][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,313][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,313][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,313][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,314][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,314][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,314][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,315][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,315][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,315][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,315][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:20:58,316][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:20:58,316][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:20:58,317][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,322][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,322][root][INFO] - Saved parsed outputs
[2025-03-06 22:20:58,322][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,323][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,324][root][INFO] - Saved parsing metadata
[2025-03-06 22:20:58,325][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,326][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:20:58,328][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 22:20:58,459][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 22:20:58,459][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.3838383838383838, 'malformed_label': 5, 'malformed_domain': 6, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 3, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 22:21:43,075][root][INFO] - Setting global seed to 989
[2025-03-06 22:21:43,146][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 22:21:43,146][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:21:43,147][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 22:21:43,150][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:21:43,162][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:21:43,162][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 22:21:43,378][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:21:44,159][root][INFO] - Full model selected, loading model
[2025-03-06 22:22:18,935][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:24:03,284][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:24:03,285][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:24:38,544][root][INFO] - Peft model loaded successfully
[2025-03-06 22:24:46,269][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:24:46,272][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:24:46,272][root][INFO] - Starting inference
[2025-03-06 22:24:46,510][root][INFO] - Processing question number 0
[2025-03-06 22:24:46,512][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 22:24:51,691][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 22:25:03,993][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 22:25:19,690][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 22:25:39,390][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 22:25:55,874][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 22:26:08,143][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 22:26:36,873][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 22:26:58,784][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 22:27:07,540][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 22:27:14,273][root][INFO] - Processing question number 10
[2025-03-06 22:27:14,275][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 22:27:26,602][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 22:27:36,025][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 22:28:04,313][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 22:28:18,171][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 22:28:34,977][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 22:28:51,204][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 22:29:02,132][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 22:29:12,226][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 22:29:21,535][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 22:29:28,267][root][INFO] - Processing question number 20
[2025-03-06 22:29:28,269][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 22:29:35,785][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 22:29:41,885][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 22:29:47,324][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 22:29:52,451][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 22:29:58,179][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 22:30:11,249][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 22:30:16,306][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 22:30:28,225][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 22:30:38,882][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 22:30:45,425][root][INFO] - Processing question number 30
[2025-03-06 22:30:45,428][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:30:53,295][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 22:30:58,390][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 22:31:04,090][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 22:31:12,247][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 22:31:16,251][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 22:31:27,719][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 22:31:32,182][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 22:31:43,233][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:31:48,517][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 22:31:55,991][root][INFO] - Processing question number 40
[2025-03-06 22:31:55,994][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:32:05,255][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 22:32:16,494][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 22:32:26,986][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 22:32:40,377][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 22:32:49,577][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:32:57,262][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 22:33:06,088][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:33:11,661][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 22:33:24,470][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 22:33:37,064][root][INFO] - Processing question number 50
[2025-03-06 22:33:37,067][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:33:49,243][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 22:34:08,289][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 22:34:16,394][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 22:34:27,897][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 22:34:42,471][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:34:48,306][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 22:34:54,515][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 22:35:02,251][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 22:35:20,150][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 22:35:30,745][root][INFO] - Processing question number 60
[2025-03-06 22:35:30,748][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:35:41,228][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:35:51,638][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 22:35:58,611][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 22:36:12,070][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 22:36:33,349][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 22:36:44,527][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 22:36:58,318][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 22:37:12,558][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:37:20,310][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 22:37:32,358][root][INFO] - Processing question number 70
[2025-03-06 22:37:32,361][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 22:37:42,709][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 22:37:57,348][root][INFO] - Domain : Property, Question : 6
[2025-03-06 22:38:15,464][root][INFO] - Domain : Property, Question : 13
[2025-03-06 22:38:24,753][root][INFO] - Domain : Property, Question : 20
[2025-03-06 22:38:34,945][root][INFO] - Domain : Property, Question : 33
[2025-03-06 22:38:44,000][root][INFO] - Domain : Property, Question : 39
[2025-03-06 22:38:54,314][root][INFO] - Domain : Property, Question : 48
[2025-03-06 22:39:06,017][root][INFO] - Domain : Property, Question : 54
[2025-03-06 22:39:17,467][root][INFO] - Domain : Property, Question : 61
[2025-03-06 22:39:31,098][root][INFO] - Processing question number 80
[2025-03-06 22:39:31,102][root][INFO] - Domain : Property, Question : 67
[2025-03-06 22:39:41,148][root][INFO] - Domain : Property, Question : 75
[2025-03-06 22:39:51,366][root][INFO] - Domain : Property, Question : 83
[2025-03-06 22:40:05,375][root][INFO] - Domain : Property, Question : 89
[2025-03-06 22:40:12,483][root][INFO] - Domain : Property, Question : 97
[2025-03-06 22:40:18,958][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:40:29,158][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 22:40:34,163][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:40:44,132][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 22:40:52,600][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 22:41:03,251][root][INFO] - Processing question number 90
[2025-03-06 22:41:03,255][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 22:41:11,440][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 22:41:16,282][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 22:41:23,454][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 22:41:27,745][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:41:33,711][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 22:41:39,597][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 22:41:45,477][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 22:41:56,964][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 22:42:08,431][root][INFO] - Inference complete
[2025-03-06 22:42:08,431][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,438][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,439][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,440][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,440][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,441][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,441][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,441][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,441][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,441][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,442][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,442][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,442][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:42:08,443][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,443][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:42:08,443][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,443][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,443][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,443][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,444][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,444][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,444][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,444][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,444][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,444][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,445][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,445][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,445][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,445][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,445][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,445][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,446][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,446][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,446][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,446][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,446][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,447][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,447][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:42:08,447][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,447][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:42:08,447][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,448][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,448][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,448][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,448][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,448][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,451][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,451][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,451][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,452][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,452][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,452][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,453][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,453][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,453][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,454][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,454][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,454][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,454][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,454][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,455][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,455][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,455][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,455][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,456][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,457][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,457][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,457][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,457][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,457][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,458][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,458][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,458][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,458][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,458][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,459][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,459][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:42:08,459][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:42:08,459][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:42:08,461][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,466][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,466][root][INFO] - Saved parsed outputs
[2025-03-06 22:42:08,466][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,467][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,467][root][INFO] - Saved parsing metadata
[2025-03-06 22:42:08,469][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,470][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:42:08,474][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 22:42:08,502][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 22:42:08,502][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.46464646464646464, 'malformed_label': 2, 'malformed_domain': 7, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 2, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 22:42:15,562][root][INFO] - Setting global seed to 989
[2025-03-06 22:42:15,569][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 22:42:15,569][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:42:15,571][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 22:42:15,573][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:42:15,576][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:42:15,576][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 22:42:15,729][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:42:16,301][root][INFO] - Full model selected, loading model
[2025-03-06 22:42:44,615][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:44:27,920][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:44:27,920][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:45:02,037][root][INFO] - Peft model loaded successfully
[2025-03-06 22:45:09,340][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:45:09,342][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 22:45:09,342][root][INFO] - Starting inference
[2025-03-06 22:45:09,540][root][INFO] - Processing question number 0
[2025-03-06 22:45:09,542][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 22:45:15,101][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 22:45:28,107][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 22:45:38,042][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 22:45:54,290][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 22:46:19,414][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 22:46:32,665][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 22:46:50,223][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 22:47:04,444][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 22:47:26,041][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 22:47:37,128][root][INFO] - Processing question number 10
[2025-03-06 22:47:37,130][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 22:47:43,318][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 22:47:57,739][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 22:48:18,392][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 22:48:26,976][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 22:48:35,022][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 22:48:51,435][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 22:49:03,913][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 22:49:12,124][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 22:49:24,038][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 22:49:31,343][root][INFO] - Processing question number 20
[2025-03-06 22:49:31,345][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 22:49:44,878][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 22:49:51,043][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 22:49:59,678][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 22:50:04,723][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 22:50:14,426][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 22:50:27,873][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 22:50:32,984][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 22:51:00,572][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 22:51:10,000][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 22:51:16,798][root][INFO] - Processing question number 30
[2025-03-06 22:51:16,800][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:51:25,445][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 22:51:30,687][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 22:51:38,149][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 22:51:59,747][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 22:52:03,793][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 22:52:21,238][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 22:52:25,742][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 22:52:37,046][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:52:42,654][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 22:52:56,018][root][INFO] - Processing question number 40
[2025-03-06 22:52:56,021][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:53:05,279][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 22:53:14,310][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 22:53:27,083][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 22:53:39,056][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 22:53:46,375][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:53:56,831][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 22:54:04,045][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:54:09,995][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 22:54:20,649][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 22:54:30,131][root][INFO] - Processing question number 50
[2025-03-06 22:54:30,134][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:54:40,731][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 22:54:54,161][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 22:55:00,006][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 22:55:10,569][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 22:55:18,892][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:55:24,696][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 22:55:35,655][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 22:55:43,153][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 22:56:02,349][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 22:56:12,904][root][INFO] - Processing question number 60
[2025-03-06 22:56:12,907][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:56:25,202][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:56:40,803][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 22:56:49,084][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 22:57:02,104][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 22:57:17,354][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 22:57:41,598][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 22:57:53,407][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 22:58:22,198][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:58:31,547][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 22:58:38,064][root][INFO] - Processing question number 70
[2025-03-06 22:58:38,067][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 22:58:43,021][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 22:58:51,724][root][INFO] - Domain : Property, Question : 6
[2025-03-06 22:59:01,947][root][INFO] - Domain : Property, Question : 13
[2025-03-06 22:59:12,692][root][INFO] - Domain : Property, Question : 20
[2025-03-06 22:59:21,218][root][INFO] - Domain : Property, Question : 33
[2025-03-06 22:59:29,322][root][INFO] - Domain : Property, Question : 39
[2025-03-06 22:59:45,297][root][INFO] - Domain : Property, Question : 48
[2025-03-06 22:59:56,189][root][INFO] - Domain : Property, Question : 54
[2025-03-06 23:00:06,631][root][INFO] - Domain : Property, Question : 61
[2025-03-06 23:00:18,628][root][INFO] - Processing question number 80
[2025-03-06 23:00:18,632][root][INFO] - Domain : Property, Question : 67
[2025-03-06 23:00:31,036][root][INFO] - Domain : Property, Question : 75
[2025-03-06 23:00:40,283][root][INFO] - Domain : Property, Question : 83
[2025-03-06 23:00:47,774][root][INFO] - Domain : Property, Question : 89
[2025-03-06 23:01:05,362][root][INFO] - Domain : Property, Question : 97
[2025-03-06 23:01:15,637][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:01:24,960][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 23:01:32,093][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:01:42,907][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 23:01:52,394][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 23:01:58,022][root][INFO] - Processing question number 90
[2025-03-06 23:01:58,026][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 23:02:06,299][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 23:02:11,379][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 23:02:15,523][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 23:02:21,433][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:02:30,009][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 23:02:40,013][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 23:02:45,959][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 23:02:53,261][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 23:03:22,327][root][INFO] - Inference complete
[2025-03-06 23:03:22,327][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,333][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,334][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,334][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,334][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,335][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,335][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,335][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,335][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,336][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,336][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,336][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,336][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,336][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,337][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,337][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:03:22,337][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,337][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:03:22,338][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,338][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,338][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,338][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,339][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,339][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,339][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,339][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,339][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,340][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,340][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,340][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,340][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,340][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:03:22,340][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,340][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:03:22,341][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,341][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,341][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,341][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,341][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,342][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,345][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,345][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,345][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,345][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,346][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,346][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,346][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,347][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,347][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,347][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,348][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,348][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,348][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,348][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,348][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,348][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,349][root][WARNING] - |Q. 53||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,349][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,349][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,349][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,349][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,350][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,350][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,351][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,351][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,351][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,351][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,351][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,352][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,352][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,353][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,353][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,353][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,354][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,354][root][WARNING] - |Q. 85||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:03:22,354][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,354][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:03:22,355][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:03:22,355][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:03:22,355][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:03:22,356][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,381][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,381][root][INFO] - Saved parsed outputs
[2025-03-06 23:03:22,381][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,382][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,382][root][INFO] - Saved parsing metadata
[2025-03-06 23:03:22,383][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,385][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:03:22,386][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 23:03:22,406][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 23:03:22,406][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.47474747474747475, 'malformed_label': 3, 'malformed_domain': 6, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 2, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 23:03:31,224][root][INFO] - Setting global seed to 989
[2025-03-06 23:03:31,231][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 23:03:31,232][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:03:31,233][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 23:03:31,235][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:03:31,237][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:03:31,238][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 23:03:31,531][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 23:03:32,122][root][INFO] - Full model selected, loading model
[2025-03-06 23:03:56,939][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:05:41,278][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:05:41,278][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:06:16,801][root][INFO] - Peft model loaded successfully
[2025-03-06 23:06:24,164][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:06:24,166][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:06:24,166][root][INFO] - Starting inference
[2025-03-06 23:06:24,394][root][INFO] - Processing question number 0
[2025-03-06 23:06:24,396][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 23:06:42,301][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 23:06:50,870][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 23:07:01,230][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 23:07:14,388][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 23:07:37,408][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 23:07:51,733][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 23:08:02,722][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 23:08:31,471][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 23:08:51,021][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 23:09:02,740][root][INFO] - Processing question number 10
[2025-03-06 23:09:02,742][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 23:09:21,590][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 23:09:35,119][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 23:09:48,287][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 23:10:02,083][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 23:10:13,659][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 23:10:27,711][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 23:10:39,436][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 23:10:48,905][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 23:11:05,489][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 23:11:11,052][root][INFO] - Processing question number 20
[2025-03-06 23:11:11,054][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 23:11:30,338][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 23:11:35,295][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 23:11:42,058][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 23:11:50,831][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 23:12:02,490][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 23:12:17,546][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 23:12:25,925][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 23:12:41,506][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 23:12:55,455][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 23:13:01,024][root][INFO] - Processing question number 30
[2025-03-06 23:13:01,027][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:13:08,797][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 23:13:14,068][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 23:13:19,631][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 23:13:38,015][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 23:13:41,406][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 23:13:47,653][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 23:13:55,353][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 23:14:01,998][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:14:07,730][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 23:14:16,507][root][INFO] - Processing question number 40
[2025-03-06 23:14:16,510][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:14:24,711][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 23:14:33,328][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 23:14:50,113][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 23:15:00,499][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 23:15:08,745][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:15:16,100][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 23:15:35,217][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:15:41,656][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 23:15:49,821][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 23:16:00,067][root][INFO] - Processing question number 50
[2025-03-06 23:16:00,070][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:16:11,250][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 23:16:29,228][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 23:16:35,107][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 23:16:46,598][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 23:16:53,172][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:17:01,826][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 23:17:12,619][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 23:17:17,979][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 23:17:36,746][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 23:17:48,232][root][INFO] - Processing question number 60
[2025-03-06 23:17:48,235][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:18:01,168][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:18:10,108][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 23:18:18,531][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 23:18:33,613][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 23:18:42,081][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 23:19:03,582][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 23:19:15,846][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 23:19:24,373][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:19:32,850][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 23:19:50,206][root][INFO] - Processing question number 70
[2025-03-06 23:19:50,210][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 23:20:05,579][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 23:20:19,771][root][INFO] - Domain : Property, Question : 6
[2025-03-06 23:20:30,339][root][INFO] - Domain : Property, Question : 13
[2025-03-06 23:20:42,480][root][INFO] - Domain : Property, Question : 20
[2025-03-06 23:20:50,361][root][INFO] - Domain : Property, Question : 33
[2025-03-06 23:20:59,759][root][INFO] - Domain : Property, Question : 39
[2025-03-06 23:21:18,742][root][INFO] - Domain : Property, Question : 48
[2025-03-06 23:21:30,842][root][INFO] - Domain : Property, Question : 54
[2025-03-06 23:21:40,355][root][INFO] - Domain : Property, Question : 61
[2025-03-06 23:21:47,732][root][INFO] - Processing question number 80
[2025-03-06 23:21:47,736][root][INFO] - Domain : Property, Question : 67
[2025-03-06 23:21:57,814][root][INFO] - Domain : Property, Question : 75
[2025-03-06 23:22:05,808][root][INFO] - Domain : Property, Question : 83
[2025-03-06 23:22:19,677][root][INFO] - Domain : Property, Question : 89
[2025-03-06 23:22:40,262][root][INFO] - Domain : Property, Question : 97
[2025-03-06 23:22:47,539][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:22:58,474][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 23:23:03,883][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:23:11,940][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 23:23:16,897][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 23:23:23,060][root][INFO] - Processing question number 90
[2025-03-06 23:23:23,064][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 23:23:34,135][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 23:23:39,428][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 23:23:43,822][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 23:23:47,652][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:23:57,408][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 23:24:08,175][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 23:24:16,970][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 23:24:27,625][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 23:24:37,485][root][INFO] - Inference complete
[2025-03-06 23:24:37,485][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,489][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,491][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,491][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:37,492][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,492][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:37,492][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,492][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,493][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,493][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,493][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,493][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,494][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,494][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,494][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,494][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,494][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:37,494][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,495][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:37,495][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,495][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,495][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,496][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,496][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,496][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,497][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,497][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:37,497][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,497][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:37,498][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,498][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,498][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,498][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,498][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,499][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,502][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,502][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,502][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,502][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,502][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,503][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,503][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,503][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,503][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,504][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,504][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,504][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,505][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,506][root][WARNING] - |Q. 78||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,506][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,506][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,506][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,506][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,507][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,507][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,507][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,509][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,509][root][WARNING] - |Q. 74||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,510][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,510][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:37,510][root][WARNING] - |Q. 92||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:37,510][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:37,511][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,515][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,515][root][INFO] - Saved parsed outputs
[2025-03-06 23:24:37,515][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,535][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,535][root][INFO] - Saved parsing metadata
[2025-03-06 23:24:37,536][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,537][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 23:24:37,539][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 23:24:37,569][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 23:24:37,569][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.46464646464646464, 'malformed_label': 3, 'malformed_domain': 6, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.15151515151515152, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 2, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 23:24:48,310][root][INFO] - Setting global seed to 206
[2025-03-06 23:24:48,317][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:24:48,318][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:24:48,319][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:24:48,320][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:24:48,325][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:24:48,326][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:24:48,481][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 23:24:49,064][root][INFO] - Full model selected, loading model
[2025-03-06 23:25:14,171][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:26:58,241][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:26:58,242][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:27:33,281][root][INFO] - Peft model loaded successfully
[2025-03-06 23:27:40,607][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:27:40,608][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:27:40,609][root][INFO] - Starting inference
[2025-03-06 23:27:40,820][root][INFO] - Processing question number 0
[2025-03-06 23:27:40,823][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:27:54,058][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:27:59,354][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:28:07,391][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:28:17,599][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:28:26,465][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:28:35,379][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:28:44,034][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:28:53,236][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:29:01,753][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:29:11,159][root][INFO] - Processing question number 10
[2025-03-06 23:29:11,161][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:29:23,544][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:29:30,376][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:29:36,806][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:29:48,641][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:30:02,772][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:30:14,554][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:30:24,289][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:30:34,831][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:30:53,126][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:31:04,645][root][INFO] - Processing question number 20
[2025-03-06 23:31:04,647][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:31:32,442][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:31:42,769][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:31:55,889][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:32:05,192][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:32:22,554][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:32:34,465][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:32:39,392][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:32:50,071][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:32:55,047][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:33:00,451][root][INFO] - Processing question number 30
[2025-03-06 23:33:00,454][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:33:05,360][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:33:12,511][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:33:18,805][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:33:22,781][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:33:34,678][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:33:43,788][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:33:50,667][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:34:19,572][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:34:27,394][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:34:34,600][root][INFO] - Processing question number 40
[2025-03-06 23:34:34,603][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:34:44,707][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:34:54,102][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:35:02,689][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:35:13,535][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:35:31,620][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:35:40,868][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:35:46,970][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:35:58,456][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:36:07,373][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:36:19,817][root][INFO] - Processing question number 50
[2025-03-06 23:36:19,820][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:36:36,103][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:36:43,408][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:37:03,825][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:37:13,731][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:37:22,362][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:37:36,898][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:37:43,691][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:37:56,819][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:38:13,459][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:38:29,698][root][INFO] - Processing question number 60
[2025-03-06 23:38:29,702][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:38:39,555][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:38:52,277][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:39:09,556][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:39:23,218][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:39:39,201][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:39:51,324][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:40:02,720][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:40:14,563][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:40:28,801][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:40:36,280][root][INFO] - Processing question number 70
[2025-03-06 23:40:36,283][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:41:01,000][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:41:08,829][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:41:21,695][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:41:34,261][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:41:42,398][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:41:52,024][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:41:59,436][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:42:17,806][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:42:24,737][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:42:31,344][root][INFO] - Processing question number 80
[2025-03-06 23:42:31,347][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:42:38,353][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:42:45,607][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:43:02,826][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:43:12,929][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:43:18,879][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:43:29,204][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:43:46,984][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:43:58,618][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:44:07,700][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:44:16,719][root][INFO] - Processing question number 90
[2025-03-06 23:44:16,723][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:44:28,639][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:44:37,209][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:44:46,674][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:44:53,489][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:45:01,245][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:45:10,564][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:45:18,769][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:45:27,982][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:45:37,786][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:45:49,922][root][INFO] - Inference complete
[2025-03-06 23:45:49,922][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,928][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,929][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,929][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,929][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,930][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,931][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,931][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,932][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,932][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,932][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,933][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,933][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,934][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,934][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,934][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,934][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,934][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,934][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,935][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,935][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,935][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,936][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,936][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,936][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:45:49,937][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,937][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:45:49,937][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,937][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,937][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,938][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,938][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,938][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,939][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,940][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,940][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,940][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,941][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,941][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,941][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,941][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,941][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,942][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,942][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,942][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,942][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,943][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,943][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,943][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,943][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,943][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,943][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,944][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,944][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,944][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,944][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,944][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,945][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,945][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,945][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,945][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,946][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,946][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,946][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,946][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,946][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,947][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:45:49,947][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:45:49,947][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:45:49,950][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,954][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,955][root][INFO] - Saved parsed outputs
[2025-03-06 23:45:49,955][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,956][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,956][root][INFO] - Saved parsing metadata
[2025-03-06 23:45:49,957][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,958][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:45:49,960][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:45:49,977][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:45:49,977][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.46, 'malformed_label': 1, 'malformed_domain': 10, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.6, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 8, 'both_wrong': 2}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-06 23:45:58,409][root][INFO] - Setting global seed to 206
[2025-03-06 23:45:58,417][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:45:58,417][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:45:58,419][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:45:58,420][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:45:58,422][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:45:58,422][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:45:58,583][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 23:45:59,147][root][INFO] - Full model selected, loading model
[2025-03-06 23:46:25,042][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:48:09,488][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:48:09,489][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:48:45,610][root][INFO] - Peft model loaded successfully
[2025-03-06 23:48:53,350][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:48:53,352][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:48:53,352][root][INFO] - Starting inference
[2025-03-06 23:48:53,551][root][INFO] - Processing question number 0
[2025-03-06 23:48:53,553][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:49:10,576][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:49:24,007][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:49:27,152][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:49:36,958][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:49:48,189][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:49:57,115][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:50:00,520][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:50:18,972][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:50:25,829][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:50:33,686][root][INFO] - Processing question number 10
[2025-03-06 23:50:33,688][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:50:40,782][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:50:54,793][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:51:00,234][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:51:14,074][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:51:41,400][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:51:57,429][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:52:07,046][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:52:15,356][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:52:33,012][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:52:41,566][root][INFO] - Processing question number 20
[2025-03-06 23:52:41,568][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:52:54,953][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:53:05,299][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:53:13,545][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:53:19,935][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:53:34,410][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:53:44,472][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:53:53,053][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:54:07,269][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:54:12,256][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:54:17,669][root][INFO] - Processing question number 30
[2025-03-06 23:54:17,671][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:54:24,003][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:54:31,117][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:54:40,815][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:54:45,029][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:54:57,934][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:55:10,454][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:55:28,098][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:55:43,843][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:55:51,315][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:56:02,141][root][INFO] - Processing question number 40
[2025-03-06 23:56:02,143][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:56:13,370][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:56:22,232][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:56:31,017][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:56:37,804][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:56:53,242][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:57:00,849][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:57:06,964][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:57:25,815][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:57:36,512][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:57:46,726][root][INFO] - Processing question number 50
[2025-03-06 23:57:46,729][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:58:06,335][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:58:11,497][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:58:33,829][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:58:48,083][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:58:55,275][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:59:05,932][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:59:11,540][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:59:32,927][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:59:42,011][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:59:54,888][root][INFO] - Processing question number 60
[2025-03-06 23:59:54,892][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 00:00:04,992][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 00:00:17,460][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 00:00:32,188][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 00:00:43,669][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 00:01:05,685][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 00:01:17,179][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 00:01:40,511][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 00:01:54,925][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 00:02:09,001][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 00:02:20,445][root][INFO] - Processing question number 70
[2025-03-07 00:02:20,449][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 00:02:32,818][root][INFO] - Domain : Property, Question : 9
[2025-03-07 00:02:45,873][root][INFO] - Domain : Property, Question : 17
[2025-03-07 00:02:53,808][root][INFO] - Domain : Property, Question : 25
[2025-03-07 00:03:03,530][root][INFO] - Domain : Property, Question : 30
[2025-03-07 00:03:21,002][root][INFO] - Domain : Property, Question : 36
[2025-03-07 00:03:25,847][root][INFO] - Domain : Property, Question : 46
[2025-03-07 00:03:34,548][root][INFO] - Domain : Property, Question : 53
[2025-03-07 00:03:53,636][root][INFO] - Domain : Property, Question : 59
[2025-03-07 00:04:00,493][root][INFO] - Domain : Property, Question : 66
[2025-03-07 00:04:10,276][root][INFO] - Processing question number 80
[2025-03-07 00:04:10,280][root][INFO] - Domain : Property, Question : 69
[2025-03-07 00:04:18,267][root][INFO] - Domain : Property, Question : 81
[2025-03-07 00:04:25,717][root][INFO] - Domain : Property, Question : 88
[2025-03-07 00:04:42,058][root][INFO] - Domain : Property, Question : 91
[2025-03-07 00:04:51,395][root][INFO] - Domain : Property, Question : 94
[2025-03-07 00:04:57,919][root][INFO] - Domain : Property, Question : 100
[2025-03-07 00:05:08,264][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 00:05:22,341][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 00:05:33,195][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 00:05:41,744][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 00:05:54,592][root][INFO] - Processing question number 90
[2025-03-07 00:05:54,596][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 00:06:03,685][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 00:06:13,072][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 00:06:18,256][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 00:06:26,417][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 00:06:37,152][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 00:06:46,583][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 00:06:53,649][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 00:07:03,065][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 00:07:14,355][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 00:07:30,128][root][INFO] - Inference complete
[2025-03-07 00:07:30,128][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,133][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,135][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,136][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,136][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,137][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,137][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,137][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,138][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,138][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,138][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,138][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,139][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,139][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,139][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,139][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,139][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,140][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,140][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,140][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,141][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,141][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,141][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,143][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,143][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,143][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,143][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,143][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,144][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,144][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,144][root][WARNING] - |Q. 80||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,144][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,145][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,145][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:07:30,145][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,145][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:07:30,145][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,146][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,146][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,146][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,146][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,146][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,147][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,147][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,147][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,147][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,148][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,148][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,148][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,148][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,148][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,148][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,149][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,149][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,149][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,149][root][WARNING] - |Q. 68||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,149][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,150][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,150][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,150][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,150][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,150][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,150][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,151][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,151][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,151][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,151][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,151][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,152][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,152][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,152][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,152][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,153][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,153][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,153][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,154][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:07:30,154][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:07:30,154][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:07:30,156][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,160][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,160][root][INFO] - Saved parsed outputs
[2025-03-07 00:07:30,160][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,162][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,162][root][INFO] - Saved parsing metadata
[2025-03-07 00:07:30,162][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,164][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:07:30,165][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 00:07:30,182][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 00:07:30,182][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.46, 'malformed_label': 1, 'malformed_domain': 10, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.6, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 6, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-07 00:07:39,697][root][INFO] - Setting global seed to 206
[2025-03-07 00:07:39,705][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 00:07:39,705][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-07 00:07:39,707][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 00:07:39,709][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 00:07:39,712][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 00:07:39,712][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 00:07:39,863][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-07 00:07:40,489][root][INFO] - Full model selected, loading model
[2025-03-07 00:08:13,858][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-07 00:09:56,657][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 00:09:56,658][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 00:10:31,664][root][INFO] - Peft model loaded successfully
[2025-03-07 00:10:39,571][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 00:10:39,573][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:10:39,573][root][INFO] - Starting inference
[2025-03-07 00:10:39,769][root][INFO] - Processing question number 0
[2025-03-07 00:10:39,771][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 00:10:51,580][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 00:10:59,500][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 00:11:03,061][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 00:11:21,009][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 00:11:28,072][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 00:11:35,335][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 00:11:42,601][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 00:11:52,895][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 00:12:01,623][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 00:12:16,565][root][INFO] - Processing question number 10
[2025-03-07 00:12:16,567][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 00:12:24,033][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 00:12:38,439][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 00:12:47,834][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 00:12:55,914][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 00:13:17,923][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 00:13:27,694][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 00:13:34,700][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 00:13:43,846][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 00:13:52,918][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 00:14:09,216][root][INFO] - Processing question number 20
[2025-03-07 00:14:09,218][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 00:14:21,705][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 00:14:31,177][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 00:14:37,969][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 00:14:44,688][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 00:14:57,494][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 00:15:11,007][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 00:15:25,786][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:15:35,622][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:15:42,298][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:15:52,032][root][INFO] - Processing question number 30
[2025-03-07 00:15:52,034][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:15:59,705][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:16:16,799][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:16:24,532][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:16:38,443][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 00:16:53,058][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 00:17:00,263][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 00:17:09,969][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 00:17:27,318][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 00:17:44,345][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 00:17:51,432][root][INFO] - Processing question number 40
[2025-03-07 00:17:51,434][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 00:18:03,611][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 00:18:09,644][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 00:18:17,517][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 00:18:24,453][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 00:18:42,706][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 00:18:52,399][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 00:19:00,585][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 00:19:09,547][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 00:19:23,304][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 00:19:33,061][root][INFO] - Processing question number 50
[2025-03-07 00:19:33,064][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 00:19:45,310][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 00:19:52,052][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 00:20:15,588][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 00:20:21,514][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 00:20:36,229][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 00:20:51,103][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 00:20:59,546][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 00:21:07,261][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 00:21:29,483][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 00:21:49,864][root][INFO] - Processing question number 60
[2025-03-07 00:21:49,867][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 00:21:59,705][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 00:22:13,179][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 00:22:27,775][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 00:22:48,964][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 00:23:13,563][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 00:23:23,872][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 00:23:47,524][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 00:23:58,765][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 00:24:09,233][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 00:24:19,677][root][INFO] - Processing question number 70
[2025-03-07 00:24:19,680][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 00:24:43,594][root][INFO] - Domain : Property, Question : 9
[2025-03-07 00:24:52,466][root][INFO] - Domain : Property, Question : 17
[2025-03-07 00:25:01,759][root][INFO] - Domain : Property, Question : 25
[2025-03-07 00:25:16,876][root][INFO] - Domain : Property, Question : 30
[2025-03-07 00:25:27,979][root][INFO] - Domain : Property, Question : 36
[2025-03-07 00:25:38,295][root][INFO] - Domain : Property, Question : 46
[2025-03-07 00:25:54,103][root][INFO] - Domain : Property, Question : 53
[2025-03-07 00:26:08,891][root][INFO] - Domain : Property, Question : 59
[2025-03-07 00:26:16,519][root][INFO] - Domain : Property, Question : 66
[2025-03-07 00:26:25,029][root][INFO] - Processing question number 80
[2025-03-07 00:26:25,033][root][INFO] - Domain : Property, Question : 69
[2025-03-07 00:26:30,540][root][INFO] - Domain : Property, Question : 81
[2025-03-07 00:26:40,903][root][INFO] - Domain : Property, Question : 88
[2025-03-07 00:26:59,973][root][INFO] - Domain : Property, Question : 91
[2025-03-07 00:27:06,599][root][INFO] - Domain : Property, Question : 94
[2025-03-07 00:27:14,780][root][INFO] - Domain : Property, Question : 100
[2025-03-07 00:27:25,512][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 00:27:42,833][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 00:27:54,177][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 00:28:00,480][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 00:28:10,732][root][INFO] - Processing question number 90
[2025-03-07 00:28:10,737][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 00:28:21,709][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 00:28:32,100][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 00:28:39,740][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 00:28:46,392][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 00:28:57,991][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 00:29:11,456][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 00:29:19,504][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 00:29:28,244][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 00:29:40,382][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 00:29:50,779][root][INFO] - Inference complete
[2025-03-07 00:29:50,779][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,784][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,785][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,786][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,786][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,787][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,787][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,787][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,787][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,788][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,788][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,789][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,789][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,789][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,790][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,790][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,790][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,790][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,791][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,791][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,794][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,794][root][WARNING] - |Q. 80||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,794][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,795][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,795][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,795][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,796][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,796][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,796][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,797][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,797][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,797][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,797][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,797][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,797][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,798][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,798][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,798][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,798][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,799][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,799][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,799][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,799][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,799][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,800][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,800][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,800][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,800][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,801][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,801][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,801][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,801][root][WARNING] - |Q. 46||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,801][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,802][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,802][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,802][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,803][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,803][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,803][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,805][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:29:50,805][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:29:50,805][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:29:50,806][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,810][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,810][root][INFO] - Saved parsed outputs
[2025-03-07 00:29:50,810][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,811][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,811][root][INFO] - Saved parsing metadata
[2025-03-07 00:29:50,812][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,814][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:29:50,815][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 00:29:50,833][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 00:29:50,833][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.48, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 48, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.6, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 7, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-07 00:30:00,969][root][INFO] - Setting global seed to 989
[2025-03-07 00:30:00,977][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 00:30:00,977][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-07 00:30:00,979][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 00:30:00,981][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 00:30:00,983][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 00:30:00,984][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 00:30:01,186][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-07 00:30:01,766][root][INFO] - Full model selected, loading model
[2025-03-07 00:30:34,287][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-07 00:32:17,840][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 00:32:17,841][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 00:32:53,619][root][INFO] - Peft model loaded successfully
[2025-03-07 00:33:01,405][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 00:33:01,407][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:33:01,407][root][INFO] - Starting inference
[2025-03-07 00:33:01,612][root][INFO] - Processing question number 0
[2025-03-07 00:33:01,614][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 00:33:15,002][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 00:33:20,305][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 00:33:28,351][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 00:33:38,560][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 00:33:47,424][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 00:33:56,337][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 00:34:04,996][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 00:34:14,195][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 00:34:22,710][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 00:34:32,108][root][INFO] - Processing question number 10
[2025-03-07 00:34:32,110][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 00:34:44,487][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 00:34:51,315][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 00:34:57,742][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 00:35:09,569][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 00:35:23,690][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 00:35:35,466][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 00:35:45,196][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 00:35:55,729][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 00:36:14,008][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 00:36:25,525][root][INFO] - Processing question number 20
[2025-03-07 00:36:25,528][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 00:36:53,300][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 00:37:03,622][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 00:37:16,726][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 00:37:26,028][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 00:37:43,382][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 00:37:55,290][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 00:38:00,217][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:38:10,894][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:38:15,870][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:38:21,276][root][INFO] - Processing question number 30
[2025-03-07 00:38:21,278][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:38:26,183][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:38:33,332][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:38:39,621][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:38:43,599][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 00:38:55,489][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 00:39:04,592][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 00:39:11,463][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 00:39:40,340][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 00:39:48,151][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 00:39:55,349][root][INFO] - Processing question number 40
[2025-03-07 00:39:55,351][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 00:40:05,440][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 00:40:14,827][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 00:40:23,402][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 00:40:34,236][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 00:40:52,309][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 00:41:01,552][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 00:41:07,650][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 00:41:19,125][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 00:41:28,039][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 00:41:40,472][root][INFO] - Processing question number 50
[2025-03-07 00:41:40,476][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 00:41:56,753][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 00:42:04,059][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 00:42:24,464][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 00:42:34,360][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 00:42:42,985][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 00:42:57,514][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 00:43:04,304][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 00:43:17,425][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 00:43:34,056][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 00:43:50,282][root][INFO] - Processing question number 60
[2025-03-07 00:43:50,285][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 00:44:00,130][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 00:44:12,842][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 00:44:30,106][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 00:44:43,757][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 00:44:59,729][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 00:45:11,841][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 00:45:23,230][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 00:45:35,067][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 00:45:49,292][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 00:45:56,766][root][INFO] - Processing question number 70
[2025-03-07 00:45:56,769][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 00:46:21,465][root][INFO] - Domain : Property, Question : 9
[2025-03-07 00:46:29,289][root][INFO] - Domain : Property, Question : 17
[2025-03-07 00:46:42,146][root][INFO] - Domain : Property, Question : 25
[2025-03-07 00:46:54,702][root][INFO] - Domain : Property, Question : 30
[2025-03-07 00:47:02,836][root][INFO] - Domain : Property, Question : 36
[2025-03-07 00:47:12,456][root][INFO] - Domain : Property, Question : 46
[2025-03-07 00:47:19,863][root][INFO] - Domain : Property, Question : 53
[2025-03-07 00:47:38,220][root][INFO] - Domain : Property, Question : 59
[2025-03-07 00:47:45,147][root][INFO] - Domain : Property, Question : 66
[2025-03-07 00:47:51,750][root][INFO] - Processing question number 80
[2025-03-07 00:47:51,754][root][INFO] - Domain : Property, Question : 69
[2025-03-07 00:47:58,757][root][INFO] - Domain : Property, Question : 81
[2025-03-07 00:48:06,003][root][INFO] - Domain : Property, Question : 88
[2025-03-07 00:48:23,206][root][INFO] - Domain : Property, Question : 91
[2025-03-07 00:48:33,303][root][INFO] - Domain : Property, Question : 94
[2025-03-07 00:48:39,252][root][INFO] - Domain : Property, Question : 100
[2025-03-07 00:48:49,575][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 00:49:07,342][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 00:49:18,971][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 00:49:28,048][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 00:49:37,066][root][INFO] - Processing question number 90
[2025-03-07 00:49:37,081][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 00:49:48,992][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 00:49:57,560][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 00:50:07,036][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 00:50:13,852][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 00:50:21,613][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 00:50:30,928][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 00:50:39,133][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 00:50:48,350][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 00:50:58,153][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 00:51:10,285][root][INFO] - Inference complete
[2025-03-07 00:51:10,285][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,291][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,292][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,292][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,293][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,294][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,294][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,294][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,295][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,295][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,295][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,296][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,297][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,297][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,297][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,297][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,297][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,298][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,298][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,298][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,299][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,299][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,299][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,299][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,300][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:51:10,300][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,300][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:51:10,300][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,300][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,301][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,301][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,301][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,301][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,303][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,303][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,303][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,304][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,304][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,304][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,304][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,304][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,304][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,305][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,305][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,305][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,306][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,306][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,306][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,306][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,306][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,306][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,307][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,307][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,307][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,307][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,307][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,307][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,308][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,308][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,308][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,309][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,309][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,309][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,309][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,310][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,310][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,310][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:51:10,310][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:51:10,310][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:51:10,314][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,318][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,318][root][INFO] - Saved parsed outputs
[2025-03-07 00:51:10,318][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,319][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,319][root][INFO] - Saved parsing metadata
[2025-03-07 00:51:10,320][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,322][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:51:10,323][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 00:51:10,371][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 00:51:10,371][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.46, 'malformed_label': 1, 'malformed_domain': 10, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.6, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 8, 'both_wrong': 2}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-07 00:51:21,589][root][INFO] - Setting global seed to 989
[2025-03-07 00:51:21,597][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 00:51:21,597][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-07 00:51:21,599][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 00:51:21,600][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 00:51:21,602][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 00:51:21,603][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 00:51:21,789][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-07 00:51:22,343][root][INFO] - Full model selected, loading model
[2025-03-07 00:51:48,880][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-07 00:53:39,604][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 00:53:39,605][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 00:54:16,162][root][INFO] - Peft model loaded successfully
[2025-03-07 00:54:23,523][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 00:54:23,525][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:54:23,525][root][INFO] - Starting inference
[2025-03-07 00:54:23,691][root][INFO] - Processing question number 0
[2025-03-07 00:54:23,694][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 00:54:39,994][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 00:55:00,453][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 00:55:09,539][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 00:55:19,426][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 00:55:27,804][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 00:55:36,579][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 00:55:40,312][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 00:55:48,083][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 00:56:00,196][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 00:56:07,849][root][INFO] - Processing question number 10
[2025-03-07 00:56:07,851][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 00:56:13,010][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 00:56:17,606][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 00:56:23,730][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 00:56:34,519][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 00:56:47,800][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 00:56:53,608][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 00:57:04,089][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 00:57:14,687][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 00:57:40,655][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 00:57:51,706][root][INFO] - Processing question number 20
[2025-03-07 00:57:51,708][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 00:57:58,768][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 00:58:08,384][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 00:58:13,891][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 00:58:21,151][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 00:58:39,616][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 00:58:49,225][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 00:58:54,241][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:59:11,932][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:59:18,503][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:59:26,315][root][INFO] - Processing question number 30
[2025-03-07 00:59:26,317][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:59:30,806][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:59:38,705][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:59:46,432][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:59:52,008][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 01:00:03,965][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 01:00:11,851][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 01:00:20,171][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 01:00:24,564][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 01:00:33,008][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 01:00:39,069][root][INFO] - Processing question number 40
[2025-03-07 01:00:39,072][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 01:00:49,257][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 01:01:01,518][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 01:01:13,887][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 01:01:20,408][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 01:01:39,233][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 01:01:50,793][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 01:01:56,447][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 01:02:05,913][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 01:02:18,561][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 01:02:33,004][root][INFO] - Processing question number 50
[2025-03-07 01:02:33,007][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 01:02:48,234][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 01:02:52,796][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 01:03:16,592][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 01:03:26,957][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 01:03:34,019][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 01:03:55,669][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 01:04:08,503][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 01:04:21,648][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 01:04:33,713][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 01:04:53,614][root][INFO] - Processing question number 60
[2025-03-07 01:04:53,617][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 01:05:04,203][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 01:05:17,182][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 01:05:38,444][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 01:05:54,220][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 01:06:06,590][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 01:06:15,191][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 01:06:43,564][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 01:06:52,825][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 01:07:08,882][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 01:07:16,429][root][INFO] - Processing question number 70
[2025-03-07 01:07:16,433][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 01:07:35,863][root][INFO] - Domain : Property, Question : 9
[2025-03-07 01:07:55,110][root][INFO] - Domain : Property, Question : 17
[2025-03-07 01:08:05,582][root][INFO] - Domain : Property, Question : 25
[2025-03-07 01:08:15,408][root][INFO] - Domain : Property, Question : 30
[2025-03-07 01:08:23,434][root][INFO] - Domain : Property, Question : 36
[2025-03-07 01:08:33,657][root][INFO] - Domain : Property, Question : 46
[2025-03-07 01:08:40,660][root][INFO] - Domain : Property, Question : 53
[2025-03-07 01:08:57,246][root][INFO] - Domain : Property, Question : 59
[2025-03-07 01:09:05,060][root][INFO] - Domain : Property, Question : 66
[2025-03-07 01:09:11,724][root][INFO] - Processing question number 80
[2025-03-07 01:09:11,728][root][INFO] - Domain : Property, Question : 69
[2025-03-07 01:09:20,792][root][INFO] - Domain : Property, Question : 81
[2025-03-07 01:09:26,427][root][INFO] - Domain : Property, Question : 88
[2025-03-07 01:09:44,806][root][INFO] - Domain : Property, Question : 91
[2025-03-07 01:09:53,787][root][INFO] - Domain : Property, Question : 94
[2025-03-07 01:10:08,043][root][INFO] - Domain : Property, Question : 100
[2025-03-07 01:10:19,200][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 01:10:33,222][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 01:10:41,495][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 01:10:49,588][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 01:11:06,271][root][INFO] - Processing question number 90
[2025-03-07 01:11:06,275][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 01:11:16,030][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 01:11:22,056][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 01:11:27,177][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 01:11:35,299][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 01:11:50,269][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 01:11:59,146][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 01:12:14,773][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 01:12:22,451][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 01:12:31,927][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 01:12:46,735][root][INFO] - Inference complete
[2025-03-07 01:12:46,736][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,741][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,742][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,743][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,743][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,743][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,743][root][WARNING] - |Q. 27||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,744][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,745][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,745][root][WARNING] - |Q. 21||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,745][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,746][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,746][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,746][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,747][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,747][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,747][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,747][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,747][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,748][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,748][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,748][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,748][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,748][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,749][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,749][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,750][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,750][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,750][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,750][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,751][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,751][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,751][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,751][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,752][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,752][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,753][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,753][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,754][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,754][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,754][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,754][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,754][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,754][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,755][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,755][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,755][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,755][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,755][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,756][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,756][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,756][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,756][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,756][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,757][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,757][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,757][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,757][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,757][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,757][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,758][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,758][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,758][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,758][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:12:46,759][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,759][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 01:12:46,759][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,760][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,760][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,760][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,760][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,760][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,760][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,760][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,761][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,761][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,761][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,761][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,761][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,762][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,762][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,763][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:12:46,763][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:12:46,763][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:12:46,766][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,770][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,770][root][INFO] - Saved parsed outputs
[2025-03-07 01:12:46,770][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,771][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,771][root][INFO] - Saved parsing metadata
[2025-03-07 01:12:46,772][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,773][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:12:46,775][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 01:12:46,800][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 01:12:46,800][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.47, 'malformed_label': 1, 'malformed_domain': 9, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.12, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 7, 'both_wrong': 2}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-03-07 01:12:55,199][root][INFO] - Setting global seed to 989
[2025-03-07 01:12:55,207][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 01:12:55,207][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-07 01:12:55,208][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 01:12:55,210][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 01:12:55,213][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 01:12:55,213][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 01:12:55,363][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-07 01:12:56,063][root][INFO] - Full model selected, loading model
[2025-03-07 01:13:21,756][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-07 01:15:05,131][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 01:15:05,132][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 01:15:40,429][root][INFO] - Peft model loaded successfully
[2025-03-07 01:15:48,193][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 01:15:48,194][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:15:48,194][root][INFO] - Starting inference
[2025-03-07 01:15:48,404][root][INFO] - Processing question number 0
[2025-03-07 01:15:48,406][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 01:15:53,854][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 01:16:04,189][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 01:16:07,956][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 01:16:19,724][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 01:16:27,615][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 01:16:36,389][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 01:16:49,283][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 01:16:59,272][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 01:17:15,405][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 01:17:25,276][root][INFO] - Processing question number 10
[2025-03-07 01:17:25,278][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 01:17:37,281][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 01:17:46,722][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 01:17:57,571][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 01:18:09,809][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 01:18:33,423][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 01:18:46,729][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 01:19:02,069][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 01:19:15,435][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 01:19:42,505][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 01:19:57,647][root][INFO] - Processing question number 20
[2025-03-07 01:19:57,649][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 01:20:10,731][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 01:20:17,015][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 01:20:23,350][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 01:20:28,516][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 01:20:43,012][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 01:20:56,035][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 01:21:01,693][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 01:21:12,386][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 01:21:18,276][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 01:21:25,030][root][INFO] - Processing question number 30
[2025-03-07 01:21:25,033][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 01:21:34,424][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 01:21:41,413][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 01:21:47,766][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 01:21:53,580][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 01:22:02,200][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 01:22:10,333][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 01:22:16,771][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 01:22:25,400][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 01:22:36,792][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 01:22:44,249][root][INFO] - Processing question number 40
[2025-03-07 01:22:44,252][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 01:22:55,525][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 01:22:58,786][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 01:23:10,081][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 01:23:18,831][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 01:23:43,797][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 01:23:54,484][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 01:23:59,870][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 01:24:14,829][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 01:24:24,911][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 01:24:30,909][root][INFO] - Processing question number 50
[2025-03-07 01:24:30,912][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 01:24:43,857][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 01:24:49,922][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 01:25:12,272][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 01:25:23,548][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 01:25:31,168][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 01:25:52,216][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 01:26:00,188][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 01:26:08,138][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 01:26:32,674][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 01:26:44,607][root][INFO] - Processing question number 60
[2025-03-07 01:26:44,610][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 01:26:57,138][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 01:27:08,102][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 01:27:26,036][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 01:27:33,117][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 01:27:48,642][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 01:27:57,439][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 01:28:12,137][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 01:28:26,052][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 01:28:47,251][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 01:28:58,645][root][INFO] - Processing question number 70
[2025-03-07 01:28:58,648][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 01:29:16,890][root][INFO] - Domain : Property, Question : 9
[2025-03-07 01:29:23,919][root][INFO] - Domain : Property, Question : 17
[2025-03-07 01:29:35,959][root][INFO] - Domain : Property, Question : 25
[2025-03-07 01:29:46,033][root][INFO] - Domain : Property, Question : 30
[2025-03-07 01:29:56,929][root][INFO] - Domain : Property, Question : 36
[2025-03-07 01:30:04,595][root][INFO] - Domain : Property, Question : 46
[2025-03-07 01:30:12,834][root][INFO] - Domain : Property, Question : 53
[2025-03-07 01:30:27,619][root][INFO] - Domain : Property, Question : 59
[2025-03-07 01:30:35,169][root][INFO] - Domain : Property, Question : 66
[2025-03-07 01:30:43,597][root][INFO] - Processing question number 80
[2025-03-07 01:30:43,600][root][INFO] - Domain : Property, Question : 69
[2025-03-07 01:30:55,600][root][INFO] - Domain : Property, Question : 81
[2025-03-07 01:31:07,169][root][INFO] - Domain : Property, Question : 88
[2025-03-07 01:31:15,756][root][INFO] - Domain : Property, Question : 91
[2025-03-07 01:31:25,773][root][INFO] - Domain : Property, Question : 94
[2025-03-07 01:31:31,875][root][INFO] - Domain : Property, Question : 100
[2025-03-07 01:31:41,562][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 01:31:53,315][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 01:32:03,681][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 01:32:11,509][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 01:32:17,929][root][INFO] - Processing question number 90
[2025-03-07 01:32:17,933][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 01:32:27,841][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 01:32:35,277][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 01:32:41,290][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 01:32:46,879][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 01:32:57,451][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 01:33:06,821][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 01:33:15,708][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 01:33:25,108][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 01:33:39,243][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 01:33:45,349][root][INFO] - Inference complete
[2025-03-07 01:33:45,350][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,355][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,357][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,357][root][WARNING] - |Q. 41||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,357][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,358][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,358][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,358][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,358][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,359][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,359][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,359][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,359][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,359][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,360][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,360][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:33:45,361][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,361][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 01:33:45,361][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,361][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,361][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,362][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,362][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,362][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,363][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,363][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,363][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,363][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,363][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,364][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,364][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,364][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,364][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,364][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,364][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,364][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,365][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,365][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,365][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,366][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,366][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,366][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,368][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,368][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,368][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,369][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,369][root][WARNING] - |Q. 85||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,369][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,370][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,370][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,370][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,370][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,371][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,371][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,371][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,371][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,371][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,372][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,372][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,372][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,372][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,372][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,372][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,373][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,373][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,373][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,373][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,373][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,373][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,374][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,374][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,374][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,374][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,374][root][WARNING] - |Q. 68||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,374][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,375][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,375][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,375][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,375][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,375][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,375][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,376][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,376][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,376][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,376][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,376][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,377][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,377][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,377][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,377][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,378][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,378][root][WARNING] - |Q. 69||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,378][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,378][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,378][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,379][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,380][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:33:45,380][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:33:45,381][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:33:45,382][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,386][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,386][root][INFO] - Saved parsed outputs
[2025-03-07 01:33:45,386][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,387][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,387][root][INFO] - Saved parsing metadata
[2025-03-07 01:33:45,388][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,389][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 01:33:45,391][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 01:33:45,476][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 01:33:45,476][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.44, 'malformed_label': 1, 'malformed_domain': 11, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 44, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.18, 'Torts_confidence': 0.15, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 8, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Job 32 completed at Fri Mar  7 01:33:48 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n509
Job ID: 25358407
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 04:52:36
CPU Efficiency: 9.80% of 2-01:44:30 core-walltime
Job Wall-clock time: 04:58:27
Memory Utilized: 35.27 GB
Memory Efficiency: 97.97% of 36.00 GB
