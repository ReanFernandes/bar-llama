Starting job 32 at Fri Feb 21 00:14:10 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=markdown_fact_first_zero_shot_unstructured train=markdown_fact_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '32', 'training']
Updating job 32 to status training with exit code None
Status update completed for job 32
[2025-02-21 00:14:30,632][root][INFO] - Global seed set to 314
[2025-02-21 00:14:30,633][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-21 00:14:30,633][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-21 00:14:30,633][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-21 00:14:30,633][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:14:30,634][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-21 00:14:30,665][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:14:30,674][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-21 00:14:30,676][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-21 00:14:30,687][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-21 00:14:31,492][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-21 00:14:56,912][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-21 00:15:24,885][root][INFO] - Model prepared for kbit training
[2025-02-21 00:15:24,886][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'k_proj', 'v_proj', 'o_proj', 'up_proj', 'down_proj', 'gate_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-21 00:15:26,581][root][INFO] - Lora adapter added to model
[2025-02-21 00:15:26,585][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_zero_shot_unstructured
[2025-02-21 00:15:26,801][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 2.0862, 'grad_norm': 0.6689242124557495, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.696, 'grad_norm': 0.42510318756103516, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.4751, 'grad_norm': 0.7672938704490662, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.3207, 'grad_norm': 0.4933934211730957, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0624, 'grad_norm': 0.4708423316478729, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 314.849, 'train_samples_per_second': 0.333, 'train_steps_per_second': 0.048, 'train_loss': 1.5280988852183024, 'epoch': 15.0}
[2025-02-21 00:20:49,004][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '32', 'trained', '0']
Updating job 32 to status trained with exit code 0
Status update completed for job 32
Starting evaluations for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 00:20:59,335][root][INFO] - Setting global seed to 206
[2025-02-21 00:20:59,341][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:20:59,341][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:20:59,343][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:20:59,345][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:20:59,349][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:20:59,350][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:20:59,491][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:21:00,022][root][INFO] - Full model selected, loading model
[2025-02-21 00:21:14,972][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:23:01,981][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:23:01,985][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:23:39,613][root][INFO] - Peft model loaded successfully
[2025-02-21 00:23:47,321][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:23:47,323][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:23:47,323][root][INFO] - Starting inference
[2025-02-21 00:23:47,485][root][INFO] - Processing question number 0
[2025-02-21 00:23:47,530][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:23:58,920][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:24:11,352][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:24:17,667][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:24:33,580][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:24:41,530][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:24:50,726][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:24:57,499][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:25:15,514][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:25:20,770][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:25:27,653][root][INFO] - Processing question number 10
[2025-02-21 00:25:27,655][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:25:34,029][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:25:39,625][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:25:50,037][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:25:57,835][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:26:26,675][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:26:31,920][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:26:42,831][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:26:49,875][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:27:12,526][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:27:24,565][root][INFO] - Processing question number 20
[2025-02-21 00:27:24,568][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:27:43,307][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:27:47,254][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:27:51,796][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:28:02,716][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:28:16,664][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:28:29,154][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:28:53,506][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:29:00,427][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:29:09,687][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:29:15,733][root][INFO] - Processing question number 30
[2025-02-21 00:29:15,735][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:29:44,307][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:29:49,423][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:29:57,673][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:30:04,177][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:30:10,537][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:30:17,213][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:30:26,186][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:30:36,545][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:30:43,586][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:31:12,716][root][INFO] - Processing question number 40
[2025-02-21 00:31:12,719][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:31:24,221][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:31:35,529][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:31:42,671][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:31:55,656][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:32:02,931][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:32:13,309][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:32:22,660][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:32:27,152][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:32:34,627][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:32:49,198][root][INFO] - Processing question number 50
[2025-02-21 00:32:49,201][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:33:02,349][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:33:17,137][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:33:27,088][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:33:56,535][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:34:15,128][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:34:32,244][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:34:40,131][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:34:47,959][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:34:56,405][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:35:02,183][root][INFO] - Processing question number 60
[2025-02-21 00:35:02,186][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:35:09,801][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:35:38,319][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:36:07,319][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:36:10,812][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:36:31,011][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:36:41,814][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:37:10,671][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:37:17,741][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:37:23,325][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:37:52,355][root][INFO] - Processing question number 70
[2025-02-21 00:37:52,360][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:37:58,268][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:38:07,634][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:38:12,091][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:38:22,867][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:38:51,881][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:38:55,420][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:39:24,572][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:39:53,531][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:40:03,810][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:40:13,654][root][INFO] - Processing question number 80
[2025-02-21 00:40:13,658][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:40:23,906][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:40:42,177][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:41:00,754][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:41:07,032][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:41:17,434][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:41:28,805][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:41:37,027][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:41:46,432][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:41:57,406][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:42:03,963][root][INFO] - Processing question number 90
[2025-02-21 00:42:03,968][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:42:10,438][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:42:15,398][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:42:27,525][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:42:36,447][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:42:49,633][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:42:52,996][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:42:58,403][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:43:13,610][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:43:19,075][root][INFO] - Inference complete
[2025-02-21 00:43:19,075][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,080][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,081][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:43:19,082][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:43:19,082][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:43:19,082][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:43:19,082][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:43:19,082][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:43:19,083][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:43:19,083][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:43:19,084][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:43:19,084][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:43:19,084][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:43:19,084][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:43:19,084][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:43:19,084][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:43:19,084][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:43:19,085][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:43:19,086][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:43:19,086][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:43:19,086][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:43:19,086][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:43:19,086][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:43:19,086][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:43:19,086][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:43:19,087][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:43:19,087][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:43:19,087][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:43:19,088][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:43:19,089][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:43:19,090][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:43:19,090][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:43:19,090][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:43:19,090][root][ERROR] - |Q. 90||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:43:19,090][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:43:19,090][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:43:19,090][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:43:19,090][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:43:19,091][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:43:19,091][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:43:19,091][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:43:19,091][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:43:19,091][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:43:19,091][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:43:19,091][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:43:19,092][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:43:19,092][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:43:19,092][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:43:19,092][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:43:19,092][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:43:19,092][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:43:19,092][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:43:19,092][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:43:19,092][root][ERROR] - |Q. 78||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:43:19,093][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:43:19,093][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 00:43:19,093][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:43:19,094][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:43:19,094][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:43:19,094][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 00:43:19,094][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:43:19,094][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 00:43:19,094][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-21 00:43:19,094][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:43:19,094][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:43:19,094][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:43:19,095][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:43:19,096][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:43:19,097][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:43:19,098][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,144][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,145][root][INFO] - Saved parsed outputs
[2025-02-21 00:43:19,145][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,197][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,197][root][INFO] - Saved parsing metadata
[2025-02-21 00:43:19,197][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,199][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:19,240][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:43:19,259][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 00:43:19,259][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 17, 'malformed_domain': 92, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 43, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 00:43:26,294][root][INFO] - Setting global seed to 206
[2025-02-21 00:43:26,299][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:43:26,299][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:43:26,301][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:43:26,302][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:43:26,304][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:43:26,304][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:43:26,472][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:43:27,089][root][INFO] - Full model selected, loading model
[2025-02-21 00:43:40,493][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:43:40,493][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:43:47,901][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:43:47,902][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:43:47,902][root][INFO] - Starting inference
[2025-02-21 00:43:48,129][root][INFO] - Processing question number 0
[2025-02-21 00:43:48,131][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:43:55,860][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:44:05,554][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:44:12,979][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:44:31,483][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:44:41,549][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:44:51,725][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:45:03,513][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:45:17,890][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:45:28,901][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:45:38,434][root][INFO] - Processing question number 10
[2025-02-21 00:45:38,436][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:45:47,836][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:45:58,624][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:46:05,573][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:46:15,026][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:46:29,704][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:46:47,134][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:47:04,135][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:47:15,855][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:47:26,820][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:47:37,710][root][INFO] - Processing question number 20
[2025-02-21 00:47:37,712][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:47:56,980][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:48:09,977][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:48:19,280][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:48:28,990][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:48:46,369][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:48:56,555][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:49:07,120][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:49:22,818][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:49:36,606][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:49:49,002][root][INFO] - Processing question number 30
[2025-02-21 00:49:49,004][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:50:08,782][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:50:28,756][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:50:40,553][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:50:49,545][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:51:00,036][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:51:12,051][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:51:27,084][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:51:34,822][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:51:45,945][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:51:58,426][root][INFO] - Processing question number 40
[2025-02-21 00:51:58,429][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:52:12,330][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:52:23,794][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:52:35,064][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:52:52,749][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:53:02,644][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:53:12,951][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:53:29,905][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:53:41,536][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:53:49,378][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:54:02,494][root][INFO] - Processing question number 50
[2025-02-21 00:54:02,497][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:54:12,778][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:54:27,262][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:54:34,860][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:55:01,612][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:55:12,519][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:55:23,909][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:55:42,554][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:55:52,509][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:56:06,875][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:56:17,221][root][INFO] - Processing question number 60
[2025-02-21 00:56:17,224][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:56:27,248][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:56:34,185][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:56:49,464][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:57:05,888][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:57:16,238][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:57:27,382][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:57:37,578][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:57:47,427][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:57:56,406][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:58:18,343][root][INFO] - Processing question number 70
[2025-02-21 00:58:18,347][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:58:27,405][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:58:49,039][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:58:59,583][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:59:13,338][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:59:34,925][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:59:46,729][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:00:05,236][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:00:19,327][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:00:36,049][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:00:49,716][root][INFO] - Processing question number 80
[2025-02-21 01:00:49,721][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:01:05,213][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:01:24,743][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:01:42,115][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:01:55,454][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:02:13,229][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:02:22,555][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:02:32,955][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:02:49,980][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:03:11,569][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:03:21,665][root][INFO] - Processing question number 90
[2025-02-21 01:03:21,669][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:03:42,211][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:03:56,140][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:04:18,168][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:04:31,928][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:04:43,942][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:04:51,328][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:05:09,760][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:05:21,871][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:05:35,444][root][INFO] - Inference complete
[2025-02-21 01:05:35,444][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,451][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,452][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:05:35,453][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:05:35,454][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:05:35,455][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:05:35,456][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:05:35,457][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:05:35,458][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:05:35,459][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:05:35,460][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:05:35,461][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:05:35,462][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:05:35,463][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:05:35,464][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:05:35,465][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:05:35,466][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:05:35,467][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:05:35,467][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:05:35,468][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,472][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,472][root][INFO] - Saved parsed outputs
[2025-02-21 01:05:35,472][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,473][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,473][root][INFO] - Saved parsing metadata
[2025-02-21 01:05:35,474][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,476][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:05:35,477][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:05:35,489][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:05:35,489][root][INFO] - Summary of metrics : {'label_accuracy': 0.050505050505050504, 'misclassification_rate': 0.9494949494949495, 'combined_accuracy': 0.0, 'malformed_label': 85, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 5, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 5, 'both_wrong': 94}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 01:05:44,689][root][INFO] - Setting global seed to 206
[2025-02-21 01:05:44,694][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:05:44,695][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:05:44,696][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:05:44,698][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:05:44,700][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:05:44,701][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:05:44,911][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:05:45,483][root][INFO] - Full model selected, loading model
[2025-02-21 01:06:08,047][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:07:52,208][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:07:52,218][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:08:22,622][root][INFO] - Peft model loaded successfully
[2025-02-21 01:08:29,830][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:08:29,832][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:08:29,832][root][INFO] - Starting inference
[2025-02-21 01:08:30,060][root][INFO] - Processing question number 0
[2025-02-21 01:08:30,062][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:08:39,494][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:08:45,685][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:09:14,237][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:09:26,639][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:09:36,716][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:09:48,438][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:10:03,295][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:10:09,746][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:10:16,224][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:10:20,622][root][INFO] - Processing question number 10
[2025-02-21 01:10:20,624][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:10:31,766][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:10:39,443][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:10:46,366][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:10:52,259][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:11:09,474][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:11:19,959][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:11:31,273][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:11:45,977][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:11:51,067][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:11:56,734][root][INFO] - Processing question number 20
[2025-02-21 01:11:56,736][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:12:02,362][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:12:10,564][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:12:17,210][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:12:23,900][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:12:52,836][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:12:58,606][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:13:05,121][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:13:12,689][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:13:22,942][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:13:51,217][root][INFO] - Processing question number 30
[2025-02-21 01:13:51,219][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:13:58,835][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:14:06,484][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:14:15,674][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:14:20,990][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:14:26,801][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:14:34,314][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:14:41,647][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:14:52,034][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:14:58,200][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:15:05,964][root][INFO] - Processing question number 40
[2025-02-21 01:15:05,966][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:15:21,475][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:15:33,586][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:16:02,804][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:16:09,138][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:16:19,263][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:16:24,741][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:16:54,660][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:16:59,231][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:17:05,343][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:17:12,468][root][INFO] - Processing question number 50
[2025-02-21 01:17:12,471][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:17:31,027][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:18:00,236][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:18:18,894][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:18:27,716][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:18:33,417][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:18:40,248][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:18:50,588][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:18:57,550][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:19:11,812][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:19:15,865][root][INFO] - Processing question number 60
[2025-02-21 01:19:15,868][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:19:22,018][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:19:27,406][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:19:46,368][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:19:53,757][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:20:10,226][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:20:38,969][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:20:45,088][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:20:58,798][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:21:12,954][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:21:31,882][root][INFO] - Processing question number 70
[2025-02-21 01:21:31,886][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:21:40,080][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:21:43,984][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:21:51,354][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:21:57,588][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:22:09,802][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:22:20,496][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:22:26,024][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:22:31,518][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:22:40,000][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:23:03,404][root][INFO] - Processing question number 80
[2025-02-21 01:23:03,409][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:23:11,675][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:23:25,977][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:23:33,885][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:23:42,909][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:23:51,272][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:23:59,294][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:24:11,353][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:24:18,990][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:24:27,464][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:24:35,287][root][INFO] - Processing question number 90
[2025-02-21 01:24:35,291][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:24:41,141][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:24:46,449][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:24:57,150][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:25:05,372][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:25:10,934][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:25:16,671][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:25:23,485][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:25:52,315][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:26:14,624][root][INFO] - Inference complete
[2025-02-21 01:26:14,624][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,629][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,630][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:26:14,630][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:26:14,631][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:26:14,631][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:26:14,631][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:26:14,631][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:26:14,631][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:26:14,631][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:26:14,631][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:26:14,632][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:26:14,633][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:26:14,634][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:26:14,634][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:26:14,634][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:26:14,634][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:26:14,634][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:26:14,634][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:26:14,635][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:26:14,635][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:26:14,635][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:26:14,636][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:26:14,636][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 01:26:14,636][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:26:14,637][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:26:14,637][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:26:14,637][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:26:14,637][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 01:26:14,637][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:26:14,637][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:26:14,637][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:26:14,638][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:26:14,638][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:26:14,638][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 01:26:14,638][root][ERROR] - |Q. 62||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:26:14,638][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:26:14,638][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:26:14,638][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:26:14,639][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:26:14,639][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:26:14,639][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:26:14,639][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:26:14,639][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:26:14,640][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:26:14,640][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:26:14,640][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:26:14,641][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:26:14,642][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:26:14,643][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:26:14,644][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:26:14,644][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:26:14,644][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:26:14,644][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:26:14,645][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,651][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,651][root][INFO] - Saved parsed outputs
[2025-02-21 01:26:14,651][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,653][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,653][root][INFO] - Saved parsing metadata
[2025-02-21 01:26:14,653][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,657][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:14,659][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:26:14,692][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:26:14,692][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.050505050505050504, 'malformed_label': 10, 'malformed_domain': 86, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 5, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.030303030303030304, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.030303030303030304, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 8, 'correct_label_wrong_domain': 40, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 01:26:23,997][root][INFO] - Setting global seed to 206
[2025-02-21 01:26:24,004][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:26:24,004][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:26:24,005][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:26:24,007][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:26:24,010][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:26:24,010][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:26:24,172][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:26:24,717][root][INFO] - Full model selected, loading model
[2025-02-21 01:26:42,720][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:26:42,720][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:26:50,118][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:26:50,119][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:26:50,119][root][INFO] - Starting inference
[2025-02-21 01:26:50,339][root][INFO] - Processing question number 0
[2025-02-21 01:26:50,341][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:26:58,525][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:27:06,994][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:27:22,414][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:27:38,244][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:27:48,362][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:27:58,957][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:28:11,657][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:28:29,316][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:28:36,243][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:28:58,406][root][INFO] - Processing question number 10
[2025-02-21 01:28:58,408][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:29:07,981][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:29:17,447][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:29:25,658][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:29:34,819][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:29:46,255][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:29:57,617][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:30:13,507][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:30:22,993][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:30:34,672][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:30:52,890][root][INFO] - Processing question number 20
[2025-02-21 01:30:52,894][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:31:11,341][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:31:27,884][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:31:36,316][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:31:43,918][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:32:00,496][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:32:10,126][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:32:23,613][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:32:37,566][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:32:55,535][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:33:11,000][root][INFO] - Processing question number 30
[2025-02-21 01:33:11,002][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:33:30,140][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:33:45,217][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:34:00,586][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:34:16,842][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:34:26,507][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:34:37,497][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:34:56,736][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:35:05,106][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:35:20,062][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:35:35,497][root][INFO] - Processing question number 40
[2025-02-21 01:35:35,501][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:35:48,424][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:36:00,815][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:36:19,807][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:36:37,783][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:36:49,085][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:36:59,245][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:37:16,011][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:37:28,011][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:37:36,449][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:37:58,491][root][INFO] - Processing question number 50
[2025-02-21 01:37:58,494][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:38:08,612][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:38:25,372][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:38:40,298][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:39:00,039][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:39:08,363][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:39:17,556][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:39:31,785][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:39:42,429][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:40:04,200][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:40:21,242][root][INFO] - Processing question number 60
[2025-02-21 01:40:21,246][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:40:35,109][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:40:44,674][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:40:56,164][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:41:03,312][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:41:16,658][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:41:28,419][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:41:40,262][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:41:53,469][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:42:03,989][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:42:15,499][root][INFO] - Processing question number 70
[2025-02-21 01:42:15,502][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:42:26,041][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:42:39,589][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:42:50,597][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:43:07,196][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:43:22,281][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:43:39,195][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:44:00,674][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:44:17,380][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:44:32,607][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:44:49,293][root][INFO] - Processing question number 80
[2025-02-21 01:44:49,298][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:45:02,499][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:45:22,885][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:45:40,413][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:45:55,241][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:46:11,992][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:46:22,783][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:46:31,869][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:46:51,484][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:47:07,271][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:47:16,229][root][INFO] - Processing question number 90
[2025-02-21 01:47:16,234][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:47:28,220][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:47:38,401][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:47:52,506][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:48:06,456][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:48:16,828][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:48:22,230][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:48:35,113][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:48:48,075][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:49:00,557][root][INFO] - Inference complete
[2025-02-21 01:49:00,557][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,562][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,563][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:49:00,563][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:49:00,564][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:49:00,565][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:49:00,566][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:49:00,567][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:49:00,568][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:49:00,569][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:49:00,570][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:49:00,571][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:49:00,572][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:49:00,573][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:49:00,574][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:49:00,575][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:49:00,576][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:49:00,577][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:49:00,578][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,583][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,583][root][INFO] - Saved parsed outputs
[2025-02-21 01:49:00,583][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,584][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,584][root][INFO] - Saved parsing metadata
[2025-02-21 01:49:00,584][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,586][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:49:00,587][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:49:00,594][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:49:00,595][root][INFO] - Summary of metrics : {'label_accuracy': 0.04040404040404041, 'misclassification_rate': 0.9595959595959596, 'combined_accuracy': 0.0, 'malformed_label': 89, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 4, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 4, 'both_wrong': 95}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 01:49:07,456][root][INFO] - Setting global seed to 206
[2025-02-21 01:49:07,461][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:49:07,461][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:49:07,462][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:49:07,464][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:49:07,466][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:49:07,466][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:49:07,618][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:49:08,184][root][INFO] - Full model selected, loading model
[2025-02-21 01:49:30,158][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:51:12,181][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:51:12,182][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:51:45,242][root][INFO] - Peft model loaded successfully
[2025-02-21 01:51:52,896][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:51:52,898][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:51:52,898][root][INFO] - Starting inference
[2025-02-21 01:51:53,086][root][INFO] - Processing question number 0
[2025-02-21 01:51:53,089][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:52:02,262][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:52:18,337][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:52:26,776][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:52:38,980][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:52:47,072][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:52:54,562][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:53:18,746][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:53:38,939][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:53:44,540][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:54:13,472][root][INFO] - Processing question number 10
[2025-02-21 01:54:13,474][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:54:29,852][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:54:37,613][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:54:46,972][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:54:51,890][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:54:59,421][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:55:05,911][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:55:20,097][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:55:30,186][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:55:36,554][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:55:40,496][root][INFO] - Processing question number 20
[2025-02-21 01:55:40,498][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:55:45,341][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:55:51,505][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:56:08,959][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:56:16,689][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:56:26,857][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:56:33,354][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:56:39,347][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:56:47,365][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:57:00,234][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:57:05,193][root][INFO] - Processing question number 30
[2025-02-21 01:57:05,196][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:57:13,681][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:57:34,956][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:57:44,153][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:57:51,537][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:57:56,666][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:58:09,018][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:58:15,469][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:58:23,780][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:58:44,239][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:58:54,631][root][INFO] - Processing question number 40
[2025-02-21 01:58:54,634][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:59:08,747][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:59:20,543][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:59:30,779][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:59:40,026][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:59:52,715][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:00:00,009][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:00:10,851][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:00:20,931][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:00:27,257][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:00:37,142][root][INFO] - Processing question number 50
[2025-02-21 02:00:37,146][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:00:56,352][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:01:08,350][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:01:13,119][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:01:23,787][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:01:29,695][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:01:43,553][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:01:52,477][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:02:21,036][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:02:37,659][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:02:42,958][root][INFO] - Processing question number 60
[2025-02-21 02:02:42,961][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:02:57,334][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:03:09,324][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:03:12,395][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:03:19,779][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:03:24,547][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:03:52,719][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:04:01,739][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:04:19,130][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:04:24,981][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:04:31,306][root][INFO] - Processing question number 70
[2025-02-21 02:04:31,310][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:04:43,353][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:04:52,379][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:04:59,104][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:05:17,061][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:05:27,393][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:05:31,738][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:05:42,076][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:05:46,932][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:05:56,119][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:06:05,294][root][INFO] - Processing question number 80
[2025-02-21 02:06:05,298][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:06:23,130][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:06:32,899][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:06:40,621][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:06:45,933][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:06:52,383][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:07:12,335][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:07:18,266][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:07:22,572][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:07:33,896][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:07:39,180][root][INFO] - Processing question number 90
[2025-02-21 02:07:39,184][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:07:53,425][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:07:59,224][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:08:09,599][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:08:14,488][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:08:19,687][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:08:25,562][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:08:32,195][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:08:50,676][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:09:16,245][root][INFO] - Inference complete
[2025-02-21 02:09:16,245][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,250][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,252][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:09:16,252][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:09:16,252][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:09:16,252][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:09:16,252][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:09:16,252][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:09:16,253][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:09:16,254][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:09:16,254][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:09:16,254][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:09:16,254][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:09:16,255][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:09:16,256][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:09:16,257][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:09:16,258][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:09:16,258][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:09:16,258][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:09:16,258][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:09:16,258][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:09:16,258][root][ERROR] - |Q. 5||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:09:16,259][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:09:16,259][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:09:16,259][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:09:16,259][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:09:16,259][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:09:16,259][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:09:16,260][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:09:16,260][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:09:16,261][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:09:16,262][root][ERROR] - |Q. 75||D: Property| Failed to extract chosen option: 
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:09:16,262][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:09:16,263][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:09:16,264][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:09:16,265][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,269][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,269][root][INFO] - Saved parsed outputs
[2025-02-21 02:09:16,269][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,270][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,270][root][INFO] - Saved parsing metadata
[2025-02-21 02:09:16,271][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,273][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:16,274][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:09:16,303][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:09:16,303][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.08080808080808081, 'malformed_label': 13, 'malformed_domain': 83, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.010101010101010102, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 8, 'correct_label_wrong_domain': 31, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 02:09:24,973][root][INFO] - Setting global seed to 206
[2025-02-21 02:09:24,980][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:09:24,980][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:09:24,981][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:09:24,983][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:09:24,986][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:09:24,986][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:09:25,129][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:09:25,680][root][INFO] - Full model selected, loading model
[2025-02-21 02:09:47,271][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:09:47,271][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:09:54,920][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:09:54,921][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:09:54,921][root][INFO] - Starting inference
[2025-02-21 02:09:55,070][root][INFO] - Processing question number 0
[2025-02-21 02:09:55,072][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:10:03,483][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:10:23,230][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:10:33,531][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:10:52,670][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:11:04,831][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:11:22,934][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:11:37,884][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:11:54,773][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:12:01,518][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:12:14,941][root][INFO] - Processing question number 10
[2025-02-21 02:12:14,942][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:12:34,892][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:12:48,794][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:12:57,557][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:13:04,843][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:13:18,835][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:13:32,280][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:13:46,282][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:13:52,864][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:14:05,712][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:14:25,445][root][INFO] - Processing question number 20
[2025-02-21 02:14:25,447][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:14:37,578][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:14:48,948][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:14:56,554][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:15:10,807][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:15:26,559][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:15:40,587][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:15:49,969][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:16:06,661][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:16:23,369][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:16:37,603][root][INFO] - Processing question number 30
[2025-02-21 02:16:37,605][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:16:47,110][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:17:04,054][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:17:23,301][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:17:33,483][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:17:46,086][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:18:00,734][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:18:16,892][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:18:30,860][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:18:48,389][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:19:10,014][root][INFO] - Processing question number 40
[2025-02-21 02:19:10,016][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:19:20,882][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:19:37,523][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:19:57,977][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:20:23,021][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:20:39,577][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:20:50,067][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:21:11,694][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:21:21,775][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:21:30,839][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:21:39,444][root][INFO] - Processing question number 50
[2025-02-21 02:21:39,446][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:21:47,082][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:22:01,932][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:22:12,855][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:22:28,420][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:22:38,631][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:22:45,204][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:23:04,130][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:23:14,854][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:23:34,028][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:23:58,366][root][INFO] - Processing question number 60
[2025-02-21 02:23:58,369][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:24:08,042][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:24:12,751][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:24:25,363][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:24:32,865][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:24:40,291][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:24:51,940][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:25:03,537][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:25:16,545][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:25:27,980][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:25:38,883][root][INFO] - Processing question number 70
[2025-02-21 02:25:38,887][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:25:59,391][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:26:19,641][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:26:35,166][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:26:56,535][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:27:13,231][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:27:22,399][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:27:42,867][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:28:02,857][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:28:21,341][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:28:33,828][root][INFO] - Processing question number 80
[2025-02-21 02:28:33,832][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:28:52,780][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:29:13,992][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:29:29,485][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:29:45,421][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:30:05,054][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:30:16,849][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:30:29,859][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:30:51,908][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:31:02,859][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:31:07,916][root][INFO] - Processing question number 90
[2025-02-21 02:31:07,920][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:31:28,250][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:31:43,174][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:31:55,228][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:32:05,644][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:32:20,440][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:32:28,229][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:32:43,461][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:32:50,034][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:33:06,964][root][INFO] - Inference complete
[2025-02-21 02:33:06,964][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:06,970][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:06,970][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:33:06,971][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:33:06,971][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:33:06,971][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:33:06,971][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:33:06,971][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:33:06,972][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:33:06,973][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:33:06,974][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:33:06,975][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:33:06,976][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:33:06,977][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:33:06,978][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:33:06,979][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:33:06,980][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:33:06,981][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:33:06,982][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:33:06,983][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:33:06,984][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:33:06,985][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:33:06,985][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:33:06,986][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:06,989][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:06,990][root][INFO] - Saved parsed outputs
[2025-02-21 02:33:06,990][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:07,007][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:07,007][root][INFO] - Saved parsing metadata
[2025-02-21 02:33:07,008][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:07,009][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:33:07,015][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:33:07,031][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:33:07,031][root][INFO] - Summary of metrics : {'label_accuracy': 0.10101010101010101, 'misclassification_rate': 0.898989898989899, 'combined_accuracy': 0.0, 'malformed_label': 82, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 10, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 10, 'both_wrong': 89}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 02:33:14,700][root][INFO] - Setting global seed to 989
[2025-02-21 02:33:14,707][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:33:14,707][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:33:14,708][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:33:14,712][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:33:14,714][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:33:14,714][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:33:14,861][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:33:15,401][root][INFO] - Full model selected, loading model
[2025-02-21 02:33:29,222][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:35:13,626][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:35:13,646][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:35:42,707][root][INFO] - Peft model loaded successfully
[2025-02-21 02:35:49,839][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:35:49,840][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:35:49,841][root][INFO] - Starting inference
[2025-02-21 02:35:50,033][root][INFO] - Processing question number 0
[2025-02-21 02:35:50,035][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:36:01,312][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:36:13,707][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:36:20,007][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:36:35,875][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:36:43,807][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:36:52,981][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:36:59,744][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:37:17,709][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:37:22,955][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:37:29,824][root][INFO] - Processing question number 10
[2025-02-21 02:37:29,826][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:37:36,199][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:37:41,782][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:37:52,173][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:37:59,952][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:38:28,771][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:38:34,009][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:38:44,904][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:38:51,938][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:39:14,559][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:39:26,570][root][INFO] - Processing question number 20
[2025-02-21 02:39:26,572][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:39:45,296][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:39:49,241][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:39:53,776][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:40:04,675][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:40:18,591][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:40:31,052][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:40:55,351][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:41:02,262][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:41:11,502][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:41:17,537][root][INFO] - Processing question number 30
[2025-02-21 02:41:17,539][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:41:46,088][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:41:51,199][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:41:59,450][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:42:05,965][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:42:12,329][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:42:19,009][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:42:27,988][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:42:38,338][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:42:45,367][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:43:14,457][root][INFO] - Processing question number 40
[2025-02-21 02:43:14,460][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:43:25,960][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:43:37,268][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:43:44,421][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:43:57,407][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:44:04,682][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:44:15,053][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:44:24,423][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:44:28,945][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:44:36,455][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:44:51,097][root][INFO] - Processing question number 50
[2025-02-21 02:44:51,100][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:45:04,250][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:45:19,106][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:45:29,070][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:45:58,612][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:46:17,234][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:46:34,293][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:46:42,163][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:46:49,972][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:46:58,397][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:47:04,164][root][INFO] - Processing question number 60
[2025-02-21 02:47:04,167][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:47:11,757][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:47:40,106][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:48:08,902][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:48:12,369][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:48:32,393][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:48:43,106][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:49:11,690][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:49:18,691][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:49:24,224][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:49:53,016][root][INFO] - Processing question number 70
[2025-02-21 02:49:53,020][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:49:58,904][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:50:08,204][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:50:12,623][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:50:23,303][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:50:52,064][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:50:55,578][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:51:24,469][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:51:53,174][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:52:03,376][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:52:13,146][root][INFO] - Processing question number 80
[2025-02-21 02:52:13,150][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:52:23,356][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:52:41,456][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:52:59,855][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:53:06,078][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:53:16,385][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:53:27,658][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:53:35,805][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:53:45,122][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:53:55,997][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:54:02,494][root][INFO] - Processing question number 90
[2025-02-21 02:54:02,498][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:54:08,919][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:54:13,832][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:54:25,851][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:54:34,724][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:54:47,868][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:54:51,222][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:54:56,605][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:55:11,748][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:55:17,200][root][INFO] - Inference complete
[2025-02-21 02:55:17,200][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,205][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,206][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:55:17,207][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:55:17,207][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:55:17,207][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:55:17,207][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:55:17,207][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:55:17,207][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:55:17,208][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:55:17,208][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:55:17,208][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:55:17,209][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:55:17,210][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:55:17,211][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:55:17,211][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:55:17,211][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:55:17,212][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:55:17,212][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:55:17,212][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:55:17,213][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:55:17,214][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 02:55:17,214][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:55:17,214][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:55:17,215][root][ERROR] - |Q. 90||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:55:17,215][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:55:17,215][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:55:17,215][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:55:17,215][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:55:17,215][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:55:17,216][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:55:17,216][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:55:17,216][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:55:17,216][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:55:17,216][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:55:17,216][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:55:17,216][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:55:17,216][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:55:17,217][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:55:17,217][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:55:17,217][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:55:17,217][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:55:17,217][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:55:17,217][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:55:17,217][root][ERROR] - |Q. 78||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:55:17,217][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:55:17,217][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:55:17,218][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:55:17,218][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:55:17,218][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:55:17,218][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:55:17,218][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-21 02:55:17,218][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:55:17,218][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:55:17,218][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 02:55:17,218][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:55:17,219][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 02:55:17,219][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:55:17,219][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:55:17,220][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:55:17,221][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:55:17,222][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,227][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,227][root][INFO] - Saved parsed outputs
[2025-02-21 02:55:17,227][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,228][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,228][root][INFO] - Saved parsing metadata
[2025-02-21 02:55:17,228][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,230][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:17,231][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:55:17,258][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:55:17,258][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 17, 'malformed_domain': 92, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 43, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 02:55:25,036][root][INFO] - Setting global seed to 989
[2025-02-21 02:55:25,043][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:55:25,043][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:55:25,045][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:55:25,046][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:55:25,049][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:55:25,049][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:55:25,189][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:55:25,768][root][INFO] - Full model selected, loading model
[2025-02-21 02:55:45,105][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:55:45,105][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:55:52,549][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:55:52,551][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:55:52,551][root][INFO] - Starting inference
[2025-02-21 02:55:52,741][root][INFO] - Processing question number 0
[2025-02-21 02:55:52,744][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:56:00,539][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:56:10,299][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:56:17,778][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:56:36,337][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:56:46,456][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:56:56,708][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:57:08,579][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:57:22,999][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:57:34,013][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:57:43,550][root][INFO] - Processing question number 10
[2025-02-21 02:57:43,552][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:57:52,955][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:58:03,741][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:58:10,691][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:58:20,146][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:58:34,821][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:58:52,267][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:59:09,314][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:59:21,035][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:59:32,004][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:59:42,895][root][INFO] - Processing question number 20
[2025-02-21 02:59:42,897][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:00:02,164][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:00:15,164][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:00:24,470][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:00:34,181][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:00:51,558][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:01:01,745][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:01:12,318][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:01:28,015][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:01:41,803][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:01:54,198][root][INFO] - Processing question number 30
[2025-02-21 03:01:54,200][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:02:13,977][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:02:33,960][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:02:45,774][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:02:54,765][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:03:05,271][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:03:17,313][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:03:32,354][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:03:40,091][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:03:51,214][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:04:03,705][root][INFO] - Processing question number 40
[2025-02-21 03:04:03,708][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:04:17,640][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:04:29,117][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:04:40,394][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:04:58,081][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:05:07,976][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:05:18,277][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:05:35,227][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:05:46,852][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:05:54,689][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:06:07,799][root][INFO] - Processing question number 50
[2025-02-21 03:06:07,802][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:06:18,083][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:06:32,561][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:06:40,157][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:07:06,900][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:07:17,801][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:07:29,183][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:07:47,749][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:07:57,687][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:08:12,010][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:08:22,318][root][INFO] - Processing question number 60
[2025-02-21 03:08:22,322][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:08:32,311][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:08:39,194][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:08:54,247][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:09:10,427][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:09:20,635][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:09:31,621][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:09:41,669][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:09:51,383][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:10:00,238][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:10:21,897][root][INFO] - Processing question number 70
[2025-02-21 03:10:21,900][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:10:30,837][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:10:52,191][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:11:02,592][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:11:16,156][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:11:37,455][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:11:49,096][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:12:07,352][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:12:21,265][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:12:37,761][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:12:51,247][root][INFO] - Processing question number 80
[2025-02-21 03:12:51,250][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:13:06,590][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:13:25,960][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:13:43,188][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:13:56,418][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:14:14,049][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:14:23,300][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:14:33,619][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:14:50,498][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:15:11,911][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:15:21,927][root][INFO] - Processing question number 90
[2025-02-21 03:15:21,931][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:15:42,373][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:15:56,235][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:16:18,170][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:16:31,866][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:16:43,827][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:16:51,175][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:17:09,512][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:17:21,554][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:17:35,071][root][INFO] - Inference complete
[2025-02-21 03:17:35,071][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,076][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,077][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:17:35,078][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:17:35,079][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:17:35,080][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:17:35,081][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:17:35,082][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:17:35,083][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:17:35,084][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:17:35,085][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:17:35,086][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:17:35,087][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:17:35,088][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:17:35,089][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:17:35,090][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:17:35,091][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:17:35,092][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:17:35,092][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:17:35,093][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,097][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,097][root][INFO] - Saved parsed outputs
[2025-02-21 03:17:35,097][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,098][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,098][root][INFO] - Saved parsing metadata
[2025-02-21 03:17:35,098][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:17:35,101][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:17:35,109][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 03:17:35,109][root][INFO] - Summary of metrics : {'label_accuracy': 0.050505050505050504, 'misclassification_rate': 0.9494949494949495, 'combined_accuracy': 0.0, 'malformed_label': 85, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 5, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 5, 'both_wrong': 94}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 03:17:41,808][root][INFO] - Setting global seed to 989
[2025-02-21 03:17:41,813][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:17:41,814][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:17:41,815][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:17:41,816][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:17:41,821][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:17:41,821][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:17:41,973][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:17:42,552][root][INFO] - Full model selected, loading model
[2025-02-21 03:18:02,838][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:19:44,264][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:19:44,284][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:20:16,431][root][INFO] - Peft model loaded successfully
[2025-02-21 03:20:23,741][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:20:23,743][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:20:23,743][root][INFO] - Starting inference
[2025-02-21 03:20:23,957][root][INFO] - Processing question number 0
[2025-02-21 03:20:23,958][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:20:30,140][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:20:36,056][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:20:59,481][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:21:14,016][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:21:21,466][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:21:29,893][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:21:35,832][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:21:56,330][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:22:01,759][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:22:08,181][root][INFO] - Processing question number 10
[2025-02-21 03:22:08,183][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:22:16,134][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:22:23,263][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:22:26,040][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:22:40,792][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:23:09,807][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:23:21,352][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:23:30,360][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:23:37,408][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:23:40,953][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:24:09,471][root][INFO] - Processing question number 20
[2025-02-21 03:24:09,473][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:24:25,903][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:24:29,376][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:24:40,102][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:24:47,203][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:24:56,816][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:25:09,019][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:25:20,069][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:25:27,775][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:25:38,589][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:25:48,562][root][INFO] - Processing question number 30
[2025-02-21 03:25:48,564][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:25:58,634][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:26:27,689][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:26:34,243][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:26:41,072][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:26:47,796][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:26:55,827][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:27:00,593][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:27:06,275][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:27:14,797][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:27:26,097][root][INFO] - Processing question number 40
[2025-02-21 03:27:26,099][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:27:34,920][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:27:44,289][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:27:54,786][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:28:05,689][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:28:12,054][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:28:40,808][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:28:48,326][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:28:52,851][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:28:57,075][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:29:03,995][root][INFO] - Processing question number 50
[2025-02-21 03:29:03,997][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:29:19,019][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:29:29,762][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:29:38,162][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:29:44,967][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:29:57,217][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:30:05,756][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:30:13,830][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:30:23,135][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:30:37,828][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:30:42,231][root][INFO] - Processing question number 60
[2025-02-21 03:30:42,234][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:30:47,390][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:31:15,967][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:31:25,190][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:31:31,845][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:31:37,301][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:32:06,028][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:32:16,174][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:32:23,283][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:32:29,412][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:32:37,358][root][INFO] - Processing question number 70
[2025-02-21 03:32:37,361][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:32:57,241][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:33:09,005][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:33:18,813][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:33:26,758][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:33:34,288][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:33:38,816][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:33:48,727][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:34:02,300][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:34:10,457][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:34:18,893][root][INFO] - Processing question number 80
[2025-02-21 03:34:18,896][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:34:26,792][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:34:38,112][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:34:48,783][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:34:58,641][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:35:27,742][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:35:39,053][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:35:49,087][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:35:54,891][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:36:23,756][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:36:33,002][root][INFO] - Processing question number 90
[2025-02-21 03:36:33,006][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:36:42,806][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:36:47,624][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:36:57,581][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:37:05,440][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:37:13,699][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:37:19,618][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:37:24,245][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:37:34,152][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:37:41,565][root][INFO] - Inference complete
[2025-02-21 03:37:41,566][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,571][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,571][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:37:41,572][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:37:41,573][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:37:41,573][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:37:41,574][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:37:41,574][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:37:41,574][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:37:41,575][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:37:41,576][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:37:41,576][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:37:41,576][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:37:41,576][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:37:41,576][root][ERROR] - |Q. 8||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:37:41,576][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:37:41,576][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:37:41,577][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:37:41,578][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 03:37:41,578][root][ERROR] - |Q. 11||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:37:41,578][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:37:41,579][root][ERROR] - |Q. 47||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:37:41,579][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:37:41,580][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:37:41,580][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:37:41,580][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:37:41,580][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:37:41,580][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:37:41,580][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:37:41,581][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:37:41,581][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:37:41,581][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:37:41,582][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:37:41,583][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:37:41,584][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:37:41,584][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:37:41,584][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:37:41,584][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 03:37:41,584][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:37:41,584][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:37:41,584][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:37:41,585][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:37:41,585][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:37:41,585][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:37:41,586][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:37:41,586][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,591][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,591][root][INFO] - Saved parsed outputs
[2025-02-21 03:37:41,591][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,592][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,592][root][INFO] - Saved parsing metadata
[2025-02-21 03:37:41,593][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,594][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:37:41,596][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:37:41,609][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 03:37:41,610][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.050505050505050504, 'malformed_label': 11, 'malformed_domain': 92, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 5, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 44, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 03:37:48,415][root][INFO] - Setting global seed to 989
[2025-02-21 03:37:48,420][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:37:48,420][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:37:48,421][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:37:48,423][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:37:48,425][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:37:48,425][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:37:48,575][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:37:50,407][root][INFO] - Full model selected, loading model
[2025-02-21 03:38:09,949][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:38:09,950][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:38:17,364][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:38:17,365][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:38:17,365][root][INFO] - Starting inference
[2025-02-21 03:38:17,538][root][INFO] - Processing question number 0
[2025-02-21 03:38:17,540][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:38:25,589][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:38:36,532][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:39:00,528][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:39:17,052][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:39:31,402][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:39:42,406][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:39:56,284][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:40:10,539][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:40:18,193][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:40:35,625][root][INFO] - Processing question number 10
[2025-02-21 03:40:35,627][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:40:48,107][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:40:55,750][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:41:03,524][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:41:13,009][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:41:24,761][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:41:37,543][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:41:48,743][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:41:58,175][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:42:14,841][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:42:30,746][root][INFO] - Processing question number 20
[2025-02-21 03:42:30,748][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:42:38,976][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:42:52,689][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:43:01,246][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:43:08,471][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:43:27,962][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:43:39,631][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:43:52,524][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:44:04,813][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:44:22,807][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:44:41,457][root][INFO] - Processing question number 30
[2025-02-21 03:44:41,459][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:44:55,081][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:45:13,654][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:45:24,279][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:45:41,037][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:45:46,881][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:46:04,112][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:46:14,848][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:46:29,712][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:46:44,931][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:47:03,003][root][INFO] - Processing question number 40
[2025-02-21 03:47:03,006][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:47:16,967][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:47:35,760][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:47:44,391][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:48:00,429][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:48:10,637][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:48:21,259][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:48:36,581][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:48:47,391][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:48:55,570][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:49:08,407][root][INFO] - Processing question number 50
[2025-02-21 03:49:08,410][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:49:15,473][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:49:34,149][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:49:41,675][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:49:56,761][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:50:07,220][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:50:22,373][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:50:39,311][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:50:50,085][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:51:10,398][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:51:28,105][root][INFO] - Processing question number 60
[2025-02-21 03:51:28,109][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:51:39,036][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:51:49,235][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:52:03,648][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:52:11,702][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:52:20,138][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:52:29,118][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:52:41,499][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:52:55,384][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:53:06,700][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:53:18,907][root][INFO] - Processing question number 70
[2025-02-21 03:53:18,910][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:53:30,193][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:53:47,638][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:54:02,246][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:54:29,306][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:54:45,077][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:55:05,077][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:55:24,895][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:55:47,317][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:56:06,022][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:56:18,091][root][INFO] - Processing question number 80
[2025-02-21 03:56:18,095][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:56:32,213][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:56:46,984][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:57:04,212][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:57:17,506][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:57:35,539][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:57:47,644][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:57:59,313][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:58:10,591][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:58:30,530][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:58:39,121][root][INFO] - Processing question number 90
[2025-02-21 03:58:39,126][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:58:58,105][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:59:08,872][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:59:17,243][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:59:28,267][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:59:44,122][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:59:51,769][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:00:04,783][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:00:17,174][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:00:27,664][root][INFO] - Inference complete
[2025-02-21 04:00:27,664][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,669][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,670][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:00:27,670][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:00:27,671][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:00:27,672][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:00:27,673][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:00:27,674][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:00:27,675][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:00:27,676][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:00:27,677][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:00:27,678][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:00:27,679][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:00:27,680][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:00:27,681][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:00:27,682][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:00:27,683][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:00:27,684][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:00:27,685][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,690][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,690][root][INFO] - Saved parsed outputs
[2025-02-21 04:00:27,690][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,693][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,693][root][INFO] - Saved parsing metadata
[2025-02-21 04:00:27,693][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,694][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:00:27,696][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:00:27,734][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 04:00:27,734][root][INFO] - Summary of metrics : {'label_accuracy': 0.050505050505050504, 'misclassification_rate': 0.9494949494949495, 'combined_accuracy': 0.0, 'malformed_label': 84, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 5, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 5, 'both_wrong': 94}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 04:00:36,015][root][INFO] - Setting global seed to 989
[2025-02-21 04:00:36,023][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 04:00:36,023][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:00:36,024][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:00:36,026][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:00:36,029][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:00:36,029][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:00:36,193][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:00:36,721][root][INFO] - Full model selected, loading model
[2025-02-21 04:00:57,743][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:02:43,284][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:02:43,307][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:03:14,501][root][INFO] - Peft model loaded successfully
[2025-02-21 04:03:22,080][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:03:22,081][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:03:22,081][root][INFO] - Starting inference
[2025-02-21 04:03:22,288][root][INFO] - Processing question number 0
[2025-02-21 04:03:22,290][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:03:29,142][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:03:38,687][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:03:46,232][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:04:04,663][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:04:17,765][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:04:33,963][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:04:39,903][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:04:51,786][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:04:56,402][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:05:04,816][root][INFO] - Processing question number 10
[2025-02-21 04:05:04,818][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:05:34,975][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:05:49,166][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:05:58,401][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:06:08,689][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:06:20,932][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:06:28,528][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:06:36,670][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:06:48,877][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:06:57,280][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:07:03,220][root][INFO] - Processing question number 20
[2025-02-21 04:07:03,222][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:07:07,893][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:07:16,377][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:07:36,529][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:07:47,117][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:07:53,537][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:07:59,039][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:08:06,780][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:08:19,279][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:08:33,530][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:08:45,025][root][INFO] - Processing question number 30
[2025-02-21 04:08:45,027][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:08:51,631][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:08:56,091][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:09:02,735][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:09:09,011][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:09:12,282][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:09:25,453][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:09:30,221][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:09:39,947][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:09:49,587][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:09:57,965][root][INFO] - Processing question number 40
[2025-02-21 04:09:57,967][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:10:05,299][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:10:14,812][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:10:25,525][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:10:43,173][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:10:50,499][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:10:56,556][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:11:02,383][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:11:11,695][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:11:16,425][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:11:26,347][root][INFO] - Processing question number 50
[2025-02-21 04:11:26,350][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:11:36,635][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:11:50,494][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:12:00,235][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:12:09,120][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:12:22,061][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:12:34,663][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:12:43,211][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:12:50,088][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:13:19,179][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:13:29,155][root][INFO] - Processing question number 60
[2025-02-21 04:13:29,158][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:13:34,090][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:13:42,244][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:13:58,021][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:14:02,507][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:14:16,726][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:14:27,450][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:14:31,966][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:14:58,199][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:15:14,433][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:15:35,214][root][INFO] - Processing question number 70
[2025-02-21 04:15:35,217][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:15:57,621][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:16:08,599][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:16:15,331][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:16:31,810][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:16:39,949][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:16:50,140][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:16:57,386][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:17:06,960][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:17:15,918][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:17:20,738][root][INFO] - Processing question number 80
[2025-02-21 04:17:20,742][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:17:39,513][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:17:50,605][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:18:08,196][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:18:17,106][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:18:25,474][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:18:33,313][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:18:40,351][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:18:47,442][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:18:54,725][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:19:01,362][root][INFO] - Processing question number 90
[2025-02-21 04:19:01,366][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:19:07,648][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:19:12,254][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:19:17,926][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:19:24,522][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:19:35,938][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:19:40,912][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:19:50,120][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:20:09,415][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:20:16,425][root][INFO] - Inference complete
[2025-02-21 04:20:16,425][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,430][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,431][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:20:16,431][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:20:16,431][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:20:16,432][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:20:16,432][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:20:16,432][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:20:16,432][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:20:16,432][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:20:16,432][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:20:16,433][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:20:16,433][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:20:16,433][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:20:16,433][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:20:16,433][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:20:16,434][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:20:16,434][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:20:16,434][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:20:16,434][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:20:16,435][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:20:16,436][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:20:16,437][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:20:16,438][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:20:16,438][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:20:16,438][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:20:16,438][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:20:16,438][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:20:16,439][root][ERROR] - |Q. 12||D: Evidence| Failed to extract chosen option: 
[2025-02-21 04:20:16,439][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:20:16,439][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:20:16,439][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:20:16,440][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:20:16,441][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:20:16,442][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:20:16,443][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:20:16,444][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,449][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,449][root][INFO] - Saved parsed outputs
[2025-02-21 04:20:16,449][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,450][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,450][root][INFO] - Saved parsing metadata
[2025-02-21 04:20:16,451][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,453][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:16,454][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:20:16,469][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 04:20:16,469][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.0707070707070707, 'malformed_label': 5, 'malformed_domain': 82, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 7, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.050505050505050504, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.010101010101010102, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 10, 'correct_label_wrong_domain': 38, 'both_wrong': 44}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 04:20:23,145][root][INFO] - Setting global seed to 989
[2025-02-21 04:20:23,150][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:20:23,150][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:20:23,152][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:20:23,153][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:20:23,155][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:20:23,155][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:20:23,308][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:20:23,828][root][INFO] - Full model selected, loading model
[2025-02-21 04:20:42,426][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:20:42,426][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:20:49,792][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:20:49,794][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:20:49,794][root][INFO] - Starting inference
[2025-02-21 04:20:49,960][root][INFO] - Processing question number 0
[2025-02-21 04:20:49,962][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:20:59,689][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:21:16,694][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:21:29,962][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:21:40,578][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:21:49,818][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:22:00,501][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:22:12,295][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:22:21,271][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:22:29,940][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:22:41,617][root][INFO] - Processing question number 10
[2025-02-21 04:22:41,619][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:22:52,695][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:23:04,595][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:23:11,743][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:23:37,283][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:23:48,713][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:24:03,332][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:24:16,775][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:24:24,598][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:24:44,451][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:24:54,636][root][INFO] - Processing question number 20
[2025-02-21 04:24:54,638][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:25:09,449][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:25:20,164][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:25:32,369][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:25:49,212][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:25:55,806][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:26:06,461][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:26:19,944][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:26:36,690][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:26:52,064][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:27:02,264][root][INFO] - Processing question number 30
[2025-02-21 04:27:02,267][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:27:13,501][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:27:36,690][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:27:51,337][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:28:07,063][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:28:12,818][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:28:25,079][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:28:33,650][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:28:41,360][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:28:55,870][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:29:03,970][root][INFO] - Processing question number 40
[2025-02-21 04:29:03,973][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:29:19,236][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:29:35,325][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:29:46,832][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:30:08,028][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:30:18,480][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:30:31,082][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:30:43,923][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:30:55,663][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:31:05,653][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:31:12,241][root][INFO] - Processing question number 50
[2025-02-21 04:31:12,244][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:31:25,623][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:31:45,184][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:31:50,192][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:32:11,594][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:32:21,868][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:32:28,171][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:32:35,210][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:32:43,128][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:33:03,770][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:33:21,471][root][INFO] - Processing question number 60
[2025-02-21 04:33:21,475][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:33:27,845][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:33:39,177][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:33:52,402][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:34:03,442][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:34:16,603][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:34:30,081][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:34:43,834][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:34:56,734][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:35:06,459][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:35:16,370][root][INFO] - Processing question number 70
[2025-02-21 04:35:16,374][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:35:25,299][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:35:32,193][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:35:47,993][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:36:09,985][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:36:24,424][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:36:36,824][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:37:02,411][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:37:14,089][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:37:27,325][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:37:51,944][root][INFO] - Processing question number 80
[2025-02-21 04:37:51,948][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:38:06,133][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:38:26,159][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:38:38,449][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:38:51,609][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:39:07,606][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:39:22,002][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:39:30,672][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:39:43,033][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:39:57,129][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:40:14,524][root][INFO] - Processing question number 90
[2025-02-21 04:40:14,528][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:40:32,933][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:40:38,951][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:40:45,715][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:40:51,000][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:41:06,790][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:41:16,868][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:41:34,745][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:41:51,204][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:42:15,269][root][INFO] - Inference complete
[2025-02-21 04:42:15,269][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,274][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,275][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:42:15,275][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:42:15,275][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:42:15,276][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:42:15,277][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:42:15,278][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:42:15,279][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:42:15,280][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:42:15,281][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:42:15,282][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:42:15,283][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:42:15,284][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:42:15,285][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:42:15,286][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:42:15,287][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:42:15,288][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:42:15,289][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:42:15,289][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:42:15,289][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:42:15,289][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:42:15,290][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,312][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,312][root][INFO] - Saved parsed outputs
[2025-02-21 04:42:15,312][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,318][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,318][root][INFO] - Saved parsing metadata
[2025-02-21 04:42:15,319][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,320][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 04:42:15,329][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:42:15,349][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-21 04:42:15,349][root][INFO] - Summary of metrics : {'label_accuracy': 0.0707070707070707, 'misclassification_rate': 0.9292929292929293, 'combined_accuracy': 0.0, 'malformed_label': 83, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 7, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 7, 'both_wrong': 92}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 04:42:22,963][root][INFO] - Setting global seed to 206
[2025-02-21 04:42:22,970][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:42:22,970][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:42:22,971][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:42:22,973][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:42:22,975][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:42:22,975][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:42:23,146][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:42:23,672][root][INFO] - Full model selected, loading model
[2025-02-21 04:42:40,162][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:44:21,115][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:44:21,137][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:44:52,788][root][INFO] - Peft model loaded successfully
[2025-02-21 04:45:00,060][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:45:00,062][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:45:00,062][root][INFO] - Starting inference
[2025-02-21 04:45:00,284][root][INFO] - Processing question number 0
[2025-02-21 04:45:00,537][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:45:10,395][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:45:19,658][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:45:34,662][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:45:42,044][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:45:57,269][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:46:05,175][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:46:13,236][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:46:16,827][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:46:23,292][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:46:28,958][root][INFO] - Processing question number 10
[2025-02-21 04:46:28,960][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:46:42,120][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:46:48,686][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:46:58,326][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:47:04,155][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:47:24,027][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:47:29,235][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:47:57,613][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:48:03,373][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:48:08,514][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:48:23,265][root][INFO] - Processing question number 20
[2025-02-21 04:48:23,267][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:48:35,852][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:48:41,388][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:48:47,906][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:48:53,491][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:48:58,437][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:49:09,367][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:49:21,623][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:49:29,216][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:49:35,244][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:49:42,870][root][INFO] - Processing question number 30
[2025-02-21 04:49:42,872][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:49:48,773][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:49:54,698][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:50:02,130][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:50:14,796][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:50:30,945][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:50:38,385][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:50:44,861][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:50:52,303][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:50:56,836][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:51:06,720][root][INFO] - Processing question number 40
[2025-02-21 04:51:06,723][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:51:14,579][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:51:22,325][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:51:30,100][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:51:33,610][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:52:02,577][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:52:12,688][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:52:17,406][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:52:24,385][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:52:52,859][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:52:59,082][root][INFO] - Processing question number 50
[2025-02-21 04:52:59,085][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:53:27,937][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:53:38,991][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:53:46,853][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:54:06,337][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:54:12,784][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:54:21,638][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:54:50,480][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:54:58,008][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:55:26,694][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:55:35,036][root][INFO] - Processing question number 60
[2025-02-21 04:55:35,039][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:55:43,257][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:56:11,672][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:56:35,554][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:56:44,567][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:56:52,475][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:57:05,648][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:57:20,140][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:57:28,018][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:57:41,487][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:57:49,253][root][INFO] - Processing question number 70
[2025-02-21 04:57:49,256][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:58:17,873][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:58:28,538][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:58:40,130][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:59:03,428][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:59:12,262][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:59:21,608][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:59:50,922][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:00:02,342][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:00:11,266][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:00:18,603][root][INFO] - Processing question number 80
[2025-02-21 05:00:18,607][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:00:25,110][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:00:54,016][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:01:02,969][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:01:09,860][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:01:26,210][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:01:37,632][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:01:53,337][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:02:09,356][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:02:19,227][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:02:31,510][root][INFO] - Processing question number 90
[2025-02-21 05:02:31,514][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:02:36,543][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:02:45,521][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:03:07,154][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:03:35,679][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:04:04,696][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:04:13,425][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:04:21,285][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:04:32,514][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:04:41,559][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:04:56,125][root][INFO] - Inference complete
[2025-02-21 05:04:56,126][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,131][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,132][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:04:56,132][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:04:56,132][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:04:56,133][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:04:56,134][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:04:56,134][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:04:56,134][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:04:56,134][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:04:56,134][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:04:56,134][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:04:56,134][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:04:56,135][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:04:56,136][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:04:56,137][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:04:56,138][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:04:56,138][root][ERROR] - |Q. 10||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:04:56,138][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:04:56,139][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:04:56,139][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:04:56,139][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:04:56,139][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:04:56,139][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:04:56,139][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:04:56,139][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:04:56,139][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:04:56,140][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:04:56,140][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:04:56,140][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:04:56,140][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:04:56,140][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:04:56,140][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:04:56,141][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:04:56,141][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:04:56,141][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:04:56,142][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:04:56,143][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:04:56,143][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:04:56,143][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:04:56,144][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 05:04:56,144][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:04:56,144][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:04:56,145][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 05:04:56,145][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:04:56,145][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:04:56,146][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:04:56,146][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:04:56,146][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:04:56,146][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:04:56,146][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:04:56,146][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 05:04:56,146][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:04:56,147][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 05:04:56,147][root][ERROR] - |Q. 63||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:04:56,147][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:04:56,147][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:04:56,147][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:04:56,147][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:04:56,147][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:04:56,148][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,171][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,171][root][INFO] - Saved parsed outputs
[2025-02-21 05:04:56,171][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,210][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,210][root][INFO] - Saved parsing metadata
[2025-02-21 05:04:56,211][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,212][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:04:56,242][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:04:56,270][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 05:04:56,270][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.01, 'malformed_label': 17, 'malformed_domain': 96, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 48, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 05:05:04,651][root][INFO] - Setting global seed to 206
[2025-02-21 05:05:04,658][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:05:04,658][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:05:04,660][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:05:04,661][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:05:04,664][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:05:04,664][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:05:04,831][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:05:05,380][root][INFO] - Full model selected, loading model
[2025-02-21 05:05:25,331][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:05:25,331][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:05:32,796][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:05:32,798][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:05:32,798][root][INFO] - Starting inference
[2025-02-21 05:05:32,988][root][INFO] - Processing question number 0
[2025-02-21 05:05:32,993][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:05:40,945][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:06:03,395][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:06:11,830][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:06:22,137][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:06:30,273][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:06:45,116][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:07:00,628][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:07:10,944][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:07:30,818][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:07:40,220][root][INFO] - Processing question number 10
[2025-02-21 05:07:40,222][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:07:47,489][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:08:00,573][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:08:11,177][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:08:25,415][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:08:35,020][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:08:44,966][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:08:52,161][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:09:04,079][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:09:16,824][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:09:25,270][root][INFO] - Processing question number 20
[2025-02-21 05:09:25,272][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:09:35,964][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:09:44,937][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:10:03,243][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:10:19,449][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:10:25,878][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:10:34,999][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:10:48,546][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:11:02,885][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:11:11,588][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:11:19,026][root][INFO] - Processing question number 30
[2025-02-21 05:11:19,029][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:11:32,179][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:11:43,352][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:11:55,998][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:12:15,054][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:12:25,560][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:12:49,173][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:13:03,191][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:13:18,141][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:13:29,959][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:13:40,867][root][INFO] - Processing question number 40
[2025-02-21 05:13:40,870][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:13:47,858][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:14:08,006][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:14:23,546][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:14:29,587][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:14:42,822][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:14:56,926][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:15:05,402][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:15:15,913][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:15:26,294][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:15:40,663][root][INFO] - Processing question number 50
[2025-02-21 05:15:40,666][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:15:54,582][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:16:04,312][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:16:15,016][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:16:27,608][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:16:42,555][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:16:54,799][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:17:05,187][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:17:14,427][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:17:23,224][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:17:32,492][root][INFO] - Processing question number 60
[2025-02-21 05:17:32,495][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:17:40,032][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:17:57,007][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:18:07,850][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:18:20,269][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:18:26,948][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:18:35,977][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:18:44,822][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:18:57,639][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:19:05,050][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:19:13,317][root][INFO] - Processing question number 70
[2025-02-21 05:19:13,320][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:19:25,493][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:19:42,544][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:19:57,585][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:20:20,223][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:20:31,894][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:20:49,349][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:20:57,827][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:21:13,564][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:21:22,771][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:21:31,064][root][INFO] - Processing question number 80
[2025-02-21 05:21:31,068][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:21:40,536][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:21:47,080][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:22:06,671][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:22:17,278][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:22:26,854][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:22:38,377][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:22:55,980][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:23:14,934][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:23:30,772][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:23:37,031][root][INFO] - Processing question number 90
[2025-02-21 05:23:37,036][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:23:46,650][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:23:57,032][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:24:20,254][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:24:30,715][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:24:39,105][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:24:55,363][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:25:12,310][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:25:20,244][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:25:39,671][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:25:50,157][root][INFO] - Inference complete
[2025-02-21 05:25:50,157][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,163][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,164][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:25:50,164][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:25:50,165][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:25:50,166][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:25:50,167][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:25:50,168][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:25:50,169][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:25:50,170][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:25:50,171][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:25:50,172][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:25:50,173][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:25:50,174][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:25:50,175][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:25:50,176][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:25:50,177][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:25:50,178][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:25:50,179][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,191][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,191][root][INFO] - Saved parsed outputs
[2025-02-21 05:25:50,191][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,193][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,193][root][INFO] - Saved parsing metadata
[2025-02-21 05:25:50,193][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,195][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:25:50,199][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:25:50,213][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 05:25:50,213][root][INFO] - Summary of metrics : {'label_accuracy': 0.07, 'misclassification_rate': 0.9299999999999999, 'combined_accuracy': 0.0, 'malformed_label': 86, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 7, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 7, 'both_wrong': 93}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 05:25:57,244][root][INFO] - Setting global seed to 206
[2025-02-21 05:25:57,249][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:25:57,249][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:25:57,250][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:25:57,251][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:25:57,254][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:25:57,254][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:25:57,393][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:25:57,987][root][INFO] - Full model selected, loading model
[2025-02-21 05:26:14,165][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:27:54,495][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:27:54,526][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:28:25,638][root][INFO] - Peft model loaded successfully
[2025-02-21 05:28:32,761][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:28:32,763][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:28:32,764][root][INFO] - Starting inference
[2025-02-21 05:28:33,009][root][INFO] - Processing question number 0
[2025-02-21 05:28:33,011][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:28:46,095][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:28:56,727][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:29:08,654][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:29:16,434][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:29:23,463][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:29:30,981][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:29:40,232][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:29:43,921][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:29:51,356][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:29:59,006][root][INFO] - Processing question number 10
[2025-02-21 05:29:59,008][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:30:06,084][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:30:22,601][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:30:33,361][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:30:39,294][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:30:56,909][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:31:02,760][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:31:10,463][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:31:17,048][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:31:22,546][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:31:29,386][root][INFO] - Processing question number 20
[2025-02-21 05:31:29,389][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:31:35,753][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:31:42,119][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:31:48,602][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:31:52,687][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:32:21,239][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:32:28,994][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:32:36,310][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:32:42,451][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:32:48,854][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:32:54,739][root][INFO] - Processing question number 30
[2025-02-21 05:32:54,742][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:33:04,253][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:33:08,193][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:33:15,241][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:33:21,801][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:33:36,073][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:33:44,743][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:33:49,771][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:33:56,593][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:34:03,375][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:34:11,634][root][INFO] - Processing question number 40
[2025-02-21 05:34:11,637][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:34:17,088][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:34:24,545][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:34:36,092][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:34:44,810][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:35:14,172][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:35:20,867][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:35:25,663][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:35:29,850][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:35:37,381][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:35:43,345][root][INFO] - Processing question number 50
[2025-02-21 05:35:43,349][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:35:48,330][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:35:54,862][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:36:04,392][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:36:14,987][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:36:21,123][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:36:49,669][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:37:01,378][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:37:08,476][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:37:32,821][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:37:50,120][root][INFO] - Processing question number 60
[2025-02-21 05:37:50,124][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:38:07,327][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:38:22,603][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:38:43,330][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:38:51,501][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:39:20,496][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:39:36,160][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:39:52,164][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:39:58,173][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:40:17,461][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:40:27,925][root][INFO] - Processing question number 70
[2025-02-21 05:40:27,929][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:40:33,930][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:40:47,431][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:41:01,076][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:41:10,134][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:41:29,455][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:41:35,823][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:41:46,185][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:42:01,439][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:42:10,003][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:42:19,713][root][INFO] - Processing question number 80
[2025-02-21 05:42:19,717][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:42:46,738][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:43:15,957][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:43:22,426][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:43:29,801][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:43:59,319][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:44:08,168][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:44:23,318][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:44:29,456][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:44:36,878][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:45:05,602][root][INFO] - Processing question number 90
[2025-02-21 05:45:05,606][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:45:13,037][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:45:26,797][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:45:38,808][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:45:43,506][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:46:02,038][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:46:09,736][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:46:16,936][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:46:25,870][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:46:30,557][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:46:59,652][root][INFO] - Inference complete
[2025-02-21 05:46:59,652][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,659][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,660][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:46:59,661][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:46:59,661][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:46:59,661][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:46:59,661][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:46:59,662][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:46:59,663][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:46:59,664][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:46:59,664][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:46:59,664][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:46:59,664][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:46:59,664][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:46:59,664][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:46:59,664][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:46:59,665][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:46:59,666][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:46:59,666][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:46:59,666][root][ERROR] - |Q. 10||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:46:59,667][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:46:59,668][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:46:59,668][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:46:59,668][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:46:59,668][root][ERROR] - |Q. 85||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:46:59,668][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:46:59,668][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:46:59,669][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:46:59,669][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:46:59,670][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:46:59,671][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:46:59,672][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:46:59,672][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:46:59,672][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 05:46:59,672][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 05:46:59,672][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:46:59,672][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:46:59,672][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:46:59,672][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 05:46:59,673][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:46:59,673][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:46:59,673][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:46:59,673][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:46:59,673][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 05:46:59,673][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:46:59,674][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:46:59,675][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:46:59,675][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 05:46:59,675][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:46:59,676][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,681][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,681][root][INFO] - Saved parsed outputs
[2025-02-21 05:46:59,682][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,686][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,686][root][INFO] - Saved parsing metadata
[2025-02-21 05:46:59,687][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,689][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:46:59,691][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:46:59,721][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 05:46:59,721][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.05, 'malformed_label': 13, 'malformed_domain': 93, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 5, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.02, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 47, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 05:47:07,716][root][INFO] - Setting global seed to 206
[2025-02-21 05:47:07,723][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:47:07,724][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:47:07,725][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:47:07,726][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:47:07,729][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:47:07,729][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:47:07,871][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:47:08,394][root][INFO] - Full model selected, loading model
[2025-02-21 05:47:28,395][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:47:28,395][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:47:35,933][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:47:35,935][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:47:35,935][root][INFO] - Starting inference
[2025-02-21 05:47:36,172][root][INFO] - Processing question number 0
[2025-02-21 05:47:36,178][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:47:44,366][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:48:00,659][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:48:07,484][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:48:19,965][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:48:28,134][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:48:37,433][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:48:43,923][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:48:53,545][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:49:07,434][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:49:19,123][root][INFO] - Processing question number 10
[2025-02-21 05:49:19,124][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:49:27,370][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:49:40,302][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:49:58,880][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:50:14,526][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:50:24,129][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:50:32,784][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:50:41,159][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:51:01,937][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:51:15,473][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:51:33,904][root][INFO] - Processing question number 20
[2025-02-21 05:51:33,906][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:51:45,372][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:51:58,037][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:52:09,726][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:52:18,882][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:52:27,530][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:52:35,847][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:52:50,003][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:53:10,910][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:53:20,254][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:53:34,179][root][INFO] - Processing question number 30
[2025-02-21 05:53:34,181][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:53:43,832][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:53:54,837][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:54:07,125][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:54:24,810][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:54:33,476][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:54:53,940][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:55:08,712][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:55:27,905][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:55:39,932][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:55:50,519][root][INFO] - Processing question number 40
[2025-02-21 05:55:50,521][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:56:00,485][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:56:18,041][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:56:35,363][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:56:44,169][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:57:00,410][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:57:09,630][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:57:17,406][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:57:25,364][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:57:36,733][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:57:46,655][root][INFO] - Processing question number 50
[2025-02-21 05:57:46,658][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:57:57,471][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:58:08,860][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:58:17,832][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:58:25,761][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:58:41,984][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:58:54,160][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:59:06,302][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:59:24,406][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:59:36,910][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:59:44,925][root][INFO] - Processing question number 60
[2025-02-21 05:59:44,928][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:59:53,508][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:00:05,868][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:00:20,463][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:00:37,383][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:00:45,885][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:00:54,773][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:01:10,970][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:01:19,809][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:01:31,338][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:01:38,778][root][INFO] - Processing question number 70
[2025-02-21 06:01:38,781][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:01:46,119][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:01:55,965][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:02:16,721][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:02:34,802][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:02:44,572][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:02:58,846][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:03:06,598][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:03:28,214][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:03:35,594][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:03:44,797][root][INFO] - Processing question number 80
[2025-02-21 06:03:44,801][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:03:54,543][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:04:04,429][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:04:22,316][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:04:36,940][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:04:50,488][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:05:03,461][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:05:24,295][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:05:32,400][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:05:47,231][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:06:02,281][root][INFO] - Processing question number 90
[2025-02-21 06:06:02,285][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:06:20,777][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:06:30,118][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:06:54,544][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:07:04,077][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:07:12,874][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:07:31,654][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:07:50,420][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:07:58,647][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:08:08,439][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:08:27,879][root][INFO] - Inference complete
[2025-02-21 06:08:27,880][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,886][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,887][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 06:08:27,887][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:08:27,887][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:08:27,887][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:08:27,887][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:08:27,888][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:08:27,889][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:08:27,890][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:08:27,891][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:08:27,892][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:08:27,893][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:08:27,894][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:08:27,895][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:08:27,896][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:08:27,897][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:08:27,898][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:08:27,899][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:08:27,900][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:08:27,901][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:08:27,901][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:08:27,901][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:08:27,902][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,906][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,907][root][INFO] - Saved parsed outputs
[2025-02-21 06:08:27,907][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,908][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,908][root][INFO] - Saved parsing metadata
[2025-02-21 06:08:27,909][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,910][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:08:27,918][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:08:27,932][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:08:27,932][root][INFO] - Summary of metrics : {'label_accuracy': 0.05, 'misclassification_rate': 0.95, 'combined_accuracy': 0.0, 'malformed_label': 89, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 5, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 5, 'both_wrong': 95}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 06:08:34,408][root][INFO] - Setting global seed to 206
[2025-02-21 06:08:34,413][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:08:34,413][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:08:34,414][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:08:34,415][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:08:34,417][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:08:34,417][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:08:34,562][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:08:35,084][root][INFO] - Full model selected, loading model
[2025-02-21 06:08:48,267][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:10:29,499][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:10:29,518][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:11:00,782][root][INFO] - Peft model loaded successfully
[2025-02-21 06:11:07,948][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:11:07,950][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:11:07,950][root][INFO] - Starting inference
[2025-02-21 06:11:08,180][root][INFO] - Processing question number 0
[2025-02-21 06:11:08,183][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:11:23,722][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:11:38,753][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:11:48,256][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:11:57,807][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:12:05,974][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:12:11,997][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:12:25,014][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:12:33,612][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:12:41,727][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:12:46,488][root][INFO] - Processing question number 10
[2025-02-21 06:12:46,490][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:12:55,283][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:13:04,159][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:13:10,342][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:13:21,097][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:13:29,762][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:13:33,252][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:13:51,540][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:14:10,992][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:14:21,757][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:14:32,560][root][INFO] - Processing question number 20
[2025-02-21 06:14:32,563][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:14:41,617][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:14:51,192][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:14:57,780][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:15:06,629][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:15:21,158][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:15:37,564][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:15:44,050][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:15:49,452][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:15:58,930][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:16:12,794][root][INFO] - Processing question number 30
[2025-02-21 06:16:12,796][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:16:18,937][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:16:26,293][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:16:33,429][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:16:42,219][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:16:53,432][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:17:06,530][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:17:15,731][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:17:22,777][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:17:28,909][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:17:37,901][root][INFO] - Processing question number 40
[2025-02-21 06:17:37,904][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:17:46,709][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:17:52,606][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:18:01,058][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:18:06,298][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:18:22,429][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:18:26,095][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:18:37,472][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:18:42,764][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:18:49,860][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:18:59,019][root][INFO] - Processing question number 50
[2025-02-21 06:18:59,022][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:19:07,990][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:19:15,931][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:19:30,527][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:19:39,762][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:19:46,165][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:19:51,285][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:19:59,322][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:20:04,304][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:20:12,244][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:20:20,622][root][INFO] - Processing question number 60
[2025-02-21 06:20:20,625][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:20:28,325][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:20:45,214][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:21:02,594][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:21:14,179][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:21:28,132][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:21:56,677][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:22:00,927][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:22:29,195][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:22:46,514][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:22:50,946][root][INFO] - Processing question number 70
[2025-02-21 06:22:50,950][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:23:16,861][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:23:24,612][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:23:37,209][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:23:47,568][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:24:00,742][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:24:10,363][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:24:16,693][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:24:35,211][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:24:42,539][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:24:48,484][root][INFO] - Processing question number 80
[2025-02-21 06:24:48,489][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:25:00,908][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:25:08,911][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:25:16,682][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:25:24,238][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:25:31,870][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:25:37,913][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:25:53,199][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:26:12,197][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:26:23,526][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:26:35,786][root][INFO] - Processing question number 90
[2025-02-21 06:26:35,791][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:26:42,340][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:26:47,519][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:27:02,186][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:27:07,610][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:27:25,554][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:27:54,812][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:28:01,598][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:28:07,733][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:28:13,867][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:28:29,022][root][INFO] - Inference complete
[2025-02-21 06:28:29,022][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,028][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,029][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:28:29,029][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:28:29,030][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:28:29,030][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:28:29,030][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:28:29,030][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:28:29,030][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:28:29,031][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:28:29,031][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:28:29,032][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:28:29,033][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:28:29,034][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:28:29,035][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:28:29,036][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:28:29,037][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:28:29,037][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:28:29,037][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:28:29,037][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:28:29,037][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:28:29,037][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:28:29,038][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:28:29,038][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:28:29,038][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:28:29,039][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:28:29,040][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:28:29,041][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:28:29,041][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:28:29,041][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:28:29,041][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:28:29,041][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:28:29,041][root][ERROR] - |Q. 67||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:28:29,042][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:28:29,042][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:28:29,042][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:28:29,042][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:28:29,043][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,047][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,047][root][INFO] - Saved parsed outputs
[2025-02-21 06:28:29,047][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,060][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,060][root][INFO] - Saved parsing metadata
[2025-02-21 06:28:29,060][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,062][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:28:29,064][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:28:29,078][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:28:29,078][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.08, 'malformed_label': 13, 'malformed_domain': 88, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.03, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 4, 'correct_label_wrong_domain': 41, 'both_wrong': 47}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 06:28:36,075][root][INFO] - Setting global seed to 206
[2025-02-21 06:28:36,082][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:28:36,082][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:28:36,084][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:28:36,085][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:28:36,087][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:28:36,088][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:28:36,229][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:28:36,855][root][INFO] - Full model selected, loading model
[2025-02-21 06:28:56,235][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:28:56,258][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:29:04,008][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:29:04,009][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:29:04,009][root][INFO] - Starting inference
[2025-02-21 06:29:04,240][root][INFO] - Processing question number 0
[2025-02-21 06:29:04,242][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:29:25,865][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:29:42,089][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:29:53,559][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:30:14,310][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:30:22,760][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:30:35,566][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:30:45,466][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:30:58,805][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:31:06,792][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:31:23,445][root][INFO] - Processing question number 10
[2025-02-21 06:31:23,447][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:31:36,567][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:31:49,460][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:32:06,602][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:32:19,127][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:32:28,882][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:32:35,885][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:32:43,822][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:33:01,314][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:33:27,947][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:33:37,306][root][INFO] - Processing question number 20
[2025-02-21 06:33:37,308][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:33:44,933][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:33:55,834][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:34:10,410][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:34:25,517][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:34:34,016][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:34:52,111][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:35:00,617][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:35:18,431][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:35:25,991][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:35:37,535][root][INFO] - Processing question number 30
[2025-02-21 06:35:37,538][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:35:47,795][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:35:58,088][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:36:05,698][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:36:23,879][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:36:37,589][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:36:58,505][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:37:17,843][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:37:29,606][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:37:39,624][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:37:51,487][root][INFO] - Processing question number 40
[2025-02-21 06:37:51,490][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:38:00,994][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:38:10,062][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:38:27,389][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:38:35,929][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:38:49,291][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:38:58,979][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:39:07,725][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:39:19,140][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:39:31,922][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:39:41,753][root][INFO] - Processing question number 50
[2025-02-21 06:39:41,756][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:39:54,566][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:40:12,522][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:40:26,756][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:40:35,763][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:40:45,518][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:41:05,920][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:41:15,849][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:41:29,938][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:41:41,971][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:41:49,661][root][INFO] - Processing question number 60
[2025-02-21 06:41:49,664][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:42:01,288][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:42:11,721][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:42:21,765][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:42:33,410][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:42:43,186][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:42:55,377][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:43:02,569][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:43:11,911][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:43:24,867][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:43:37,519][root][INFO] - Processing question number 70
[2025-02-21 06:43:37,523][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:43:47,141][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:44:03,740][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:44:23,859][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:44:44,547][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:44:54,172][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:45:15,592][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:45:24,907][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:45:42,151][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:45:53,894][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:46:04,121][root][INFO] - Processing question number 80
[2025-02-21 06:46:04,125][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:46:14,910][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:46:26,927][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:46:54,245][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:47:04,980][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:47:20,050][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:47:34,328][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:47:52,340][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:48:07,903][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:48:21,130][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:48:42,977][root][INFO] - Processing question number 90
[2025-02-21 06:48:42,981][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:48:58,215][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:49:14,053][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:49:24,710][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:49:32,025][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:49:45,969][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:50:00,555][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:50:23,560][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:50:33,465][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:50:46,064][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:51:02,858][root][INFO] - Inference complete
[2025-02-21 06:51:02,859][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,865][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,866][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 06:51:02,866][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:51:02,866][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:51:02,867][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:51:02,868][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:51:02,868][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:51:02,869][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:51:02,870][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:51:02,871][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:51:02,872][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:51:02,873][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:51:02,874][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:51:02,875][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:51:02,876][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:51:02,877][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:51:02,878][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:51:02,878][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:51:02,879][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:51:02,880][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:51:02,881][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,886][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,886][root][INFO] - Saved parsed outputs
[2025-02-21 06:51:02,886][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,888][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,888][root][INFO] - Saved parsing metadata
[2025-02-21 06:51:02,888][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,890][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:51:02,892][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:51:02,931][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:51:02,931][root][INFO] - Summary of metrics : {'label_accuracy': 0.08, 'misclassification_rate': 0.92, 'combined_accuracy': 0.0, 'malformed_label': 81, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 8, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 8, 'both_wrong': 92}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 06:51:10,123][root][INFO] - Setting global seed to 989
[2025-02-21 06:51:10,130][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:51:10,130][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:51:10,131][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:51:10,132][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:51:10,135][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:51:10,135][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:51:10,374][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:51:10,893][root][INFO] - Full model selected, loading model
[2025-02-21 06:51:29,308][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:53:11,601][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:53:11,601][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:53:42,666][root][INFO] - Peft model loaded successfully
[2025-02-21 06:53:49,821][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:53:49,823][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:53:49,823][root][INFO] - Starting inference
[2025-02-21 06:53:50,037][root][INFO] - Processing question number 0
[2025-02-21 06:53:50,052][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:53:59,889][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:54:09,116][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:54:24,026][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:54:31,364][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:54:46,514][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:54:54,410][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:55:02,432][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:55:05,998][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:55:12,415][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:55:18,040][root][INFO] - Processing question number 10
[2025-02-21 06:55:18,042][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:55:31,119][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:55:37,685][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:55:47,328][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:55:53,159][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:56:13,040][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:56:18,250][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:56:46,627][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:56:52,380][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:56:57,508][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:57:12,242][root][INFO] - Processing question number 20
[2025-02-21 06:57:12,245][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:57:24,828][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:57:30,361][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:57:36,875][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:57:42,456][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:57:47,398][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:57:58,334][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:58:10,585][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:58:18,171][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:58:24,195][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:58:31,820][root][INFO] - Processing question number 30
[2025-02-21 06:58:31,822][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:58:37,726][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:58:43,655][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:58:51,091][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:59:03,763][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:59:19,917][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:59:27,361][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:59:33,840][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:59:41,288][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:59:45,827][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:59:55,741][root][INFO] - Processing question number 40
[2025-02-21 06:59:55,744][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:00:03,661][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:00:11,505][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:00:19,346][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:00:22,883][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:00:51,836][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:01:01,938][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:01:06,652][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:01:13,623][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:01:42,088][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:01:48,316][root][INFO] - Processing question number 50
[2025-02-21 07:01:48,319][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:02:17,151][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:02:28,201][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:02:36,069][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:02:55,537][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:03:01,981][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:03:10,826][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:03:39,675][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:03:47,208][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:04:15,915][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:04:24,261][root][INFO] - Processing question number 60
[2025-02-21 07:04:24,265][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:04:32,491][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:05:00,931][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:05:24,835][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:05:33,859][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:05:41,773][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:05:54,956][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:06:09,457][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:06:17,343][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:06:30,825][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:06:38,601][root][INFO] - Processing question number 70
[2025-02-21 07:06:38,605][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:07:07,261][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:07:17,945][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:07:29,546][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:07:52,861][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:08:01,703][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:08:11,054][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:08:40,394][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:08:51,822][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:09:00,756][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:09:08,100][root][INFO] - Processing question number 80
[2025-02-21 07:09:08,104][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:09:14,613][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:09:43,541][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:09:52,504][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:09:59,404][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:10:15,769][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:10:27,200][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:10:42,916][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:10:58,947][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:11:08,828][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:11:21,122][root][INFO] - Processing question number 90
[2025-02-21 07:11:21,126][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:11:26,161][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:11:35,145][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:11:56,794][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:12:25,341][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:12:54,380][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:13:03,117][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:13:10,984][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:13:22,224][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:13:31,277][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:13:45,860][root][INFO] - Inference complete
[2025-02-21 07:13:45,860][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,866][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,867][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:13:45,868][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:13:45,868][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:13:45,868][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:13:45,868][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:13:45,869][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:13:45,870][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:13:45,870][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:13:45,870][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:13:45,870][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:13:45,870][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:13:45,870][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:13:45,870][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:13:45,871][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:13:45,872][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:13:45,873][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:13:45,874][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:13:45,874][root][ERROR] - |Q. 10||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:13:45,874][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:13:45,875][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:13:45,875][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:13:45,875][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:13:45,875][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:13:45,875][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:13:45,875][root][ERROR] - |Q. 50||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:13:45,875][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:13:45,875][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:13:45,876][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:13:45,876][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:13:45,876][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:13:45,876][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:13:45,876][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:13:45,877][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:13:45,877][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:13:45,877][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:13:45,878][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:13:45,879][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:13:45,879][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:13:45,879][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:13:45,879][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:13:45,879][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:13:45,879][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:13:45,879][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:13:45,880][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 07:13:45,880][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:13:45,880][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:13:45,881][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 07:13:45,881][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:13:45,881][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:13:45,882][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:13:45,882][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:13:45,882][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:13:45,882][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:13:45,882][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:13:45,882][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 07:13:45,882][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:13:45,883][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 07:13:45,883][root][ERROR] - |Q. 63||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:13:45,883][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:13:45,883][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:13:45,883][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:13:45,883][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:13:45,883][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:13:45,884][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,889][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,889][root][INFO] - Saved parsed outputs
[2025-02-21 07:13:45,889][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,891][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,891][root][INFO] - Saved parsing metadata
[2025-02-21 07:13:45,891][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,893][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:13:45,901][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:13:45,933][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:13:45,933][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.01, 'malformed_label': 17, 'malformed_domain': 96, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 48, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 07:13:53,106][root][INFO] - Setting global seed to 989
[2025-02-21 07:13:53,113][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:13:53,113][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:13:53,114][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:13:53,116][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:13:53,119][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:13:53,119][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:13:53,278][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:13:53,804][root][INFO] - Full model selected, loading model
[2025-02-21 07:14:11,923][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:14:11,923][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:14:19,323][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:14:19,324][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:14:19,324][root][INFO] - Starting inference
[2025-02-21 07:14:19,513][root][INFO] - Processing question number 0
[2025-02-21 07:14:19,515][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:14:27,459][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:14:49,929][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:14:58,380][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:15:08,713][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:15:16,860][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:15:31,734][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:15:47,260][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:15:57,585][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:16:17,474][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:16:26,884][root][INFO] - Processing question number 10
[2025-02-21 07:16:26,886][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:16:34,160][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:16:47,256][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:16:57,872][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:17:12,122][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:17:21,731][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:17:31,688][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:17:38,888][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:17:50,813][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:18:03,575][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:18:12,009][root][INFO] - Processing question number 20
[2025-02-21 07:18:12,011][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:18:22,639][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:18:31,562][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:18:49,834][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:19:06,055][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:19:12,488][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:19:21,613][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:19:35,168][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:19:49,531][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:19:58,261][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:20:05,733][root][INFO] - Processing question number 30
[2025-02-21 07:20:05,736][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:20:18,900][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:20:30,055][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:20:42,709][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:21:01,778][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:21:12,302][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:21:35,953][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:21:49,983][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:22:04,961][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:22:16,805][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:22:27,730][root][INFO] - Processing question number 40
[2025-02-21 07:22:27,733][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:22:34,726][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:22:54,886][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:23:10,435][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:23:16,472][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:23:29,711][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:23:43,823][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:23:52,303][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:24:02,820][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:24:13,203][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:24:27,580][root][INFO] - Processing question number 50
[2025-02-21 07:24:27,584][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:24:41,510][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:24:51,247][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:25:01,956][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:25:14,556][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:25:29,525][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:25:41,806][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:25:52,205][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:26:01,454][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:26:10,260][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:26:19,534][root][INFO] - Processing question number 60
[2025-02-21 07:26:19,538][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:26:27,080][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:26:44,065][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:26:54,914][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:27:07,340][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:27:14,022][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:27:23,057][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:27:31,905][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:27:44,729][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:27:52,146][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:28:00,416][root][INFO] - Processing question number 70
[2025-02-21 07:28:00,419][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:28:12,600][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:28:29,662][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:28:44,711][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:29:07,362][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:29:19,041][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:29:36,529][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:29:45,066][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:30:00,931][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:30:10,215][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:30:18,579][root][INFO] - Processing question number 80
[2025-02-21 07:30:18,583][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:30:28,121][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:30:34,723][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:30:54,356][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:31:04,974][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:31:14,589][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:31:26,205][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:31:43,858][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:32:02,882][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:32:18,833][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:32:25,110][root][INFO] - Processing question number 90
[2025-02-21 07:32:25,114][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:32:34,738][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:32:45,126][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:33:08,365][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:33:18,835][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:33:27,231][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:33:43,495][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:34:00,456][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:34:08,396][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:34:27,836][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:34:38,330][root][INFO] - Inference complete
[2025-02-21 07:34:38,330][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,336][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,337][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:34:38,337][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:34:38,337][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:34:38,337][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:34:38,337][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:34:38,338][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:34:38,339][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:34:38,340][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:34:38,341][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:34:38,342][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:34:38,343][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:34:38,344][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:34:38,345][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:34:38,346][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:34:38,347][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:34:38,348][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:34:38,349][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:34:38,350][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:34:38,351][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:34:38,351][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:34:38,351][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:34:38,352][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,356][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,356][root][INFO] - Saved parsed outputs
[2025-02-21 07:34:38,356][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,357][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,357][root][INFO] - Saved parsing metadata
[2025-02-21 07:34:38,358][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,359][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:34:38,360][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:34:38,378][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:34:38,378][root][INFO] - Summary of metrics : {'label_accuracy': 0.07, 'misclassification_rate': 0.9299999999999999, 'combined_accuracy': 0.0, 'malformed_label': 86, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 7, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 7, 'both_wrong': 93}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 07:34:45,412][root][INFO] - Setting global seed to 989
[2025-02-21 07:34:45,419][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:34:45,419][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:34:45,421][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:34:45,422][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:34:45,424][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:34:45,425][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:34:45,577][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:34:46,113][root][INFO] - Full model selected, loading model
[2025-02-21 07:35:05,980][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:36:47,849][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:36:47,873][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:37:22,027][root][INFO] - Peft model loaded successfully
[2025-02-21 07:37:29,520][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:37:29,522][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:37:29,522][root][INFO] - Starting inference
[2025-02-21 07:37:29,737][root][INFO] - Processing question number 0
[2025-02-21 07:37:29,740][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:37:58,993][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:38:05,488][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:38:15,895][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:38:21,268][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:38:41,580][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:38:51,844][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:39:12,639][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:39:21,012][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:39:26,462][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:39:37,309][root][INFO] - Processing question number 10
[2025-02-21 07:39:37,311][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:39:44,705][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:39:53,078][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:40:00,737][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:40:06,803][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:40:12,797][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:40:20,399][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:40:32,189][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:40:38,499][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:40:42,939][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:40:51,540][root][INFO] - Processing question number 20
[2025-02-21 07:40:51,543][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:40:58,309][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:41:04,720][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:41:11,202][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:41:23,054][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:41:33,688][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:42:02,656][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:42:10,199][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:42:18,040][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:42:24,305][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:42:33,873][root][INFO] - Processing question number 30
[2025-02-21 07:42:33,875][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:42:39,835][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:42:45,224][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:42:53,607][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:42:59,614][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:43:12,434][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:43:20,101][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:43:28,774][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:43:33,104][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:43:41,598][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:43:46,496][root][INFO] - Processing question number 40
[2025-02-21 07:43:46,499][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:43:51,312][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:43:58,955][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:44:06,075][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:44:13,483][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:44:26,508][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:44:31,912][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:44:36,856][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:44:40,690][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:44:53,062][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:44:58,244][root][INFO] - Processing question number 50
[2025-02-21 07:44:58,247][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:45:07,504][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:45:12,909][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:45:20,750][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:45:29,894][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:45:36,347][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:46:04,894][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:46:31,655][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:46:37,375][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:46:46,063][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:46:54,176][root][INFO] - Processing question number 60
[2025-02-21 07:46:54,180][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:47:01,065][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:47:20,756][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:47:31,032][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:47:37,498][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:47:44,519][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:48:13,087][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:48:16,484][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:48:25,413][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:48:32,811][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:48:42,034][root][INFO] - Processing question number 70
[2025-02-21 07:48:42,038][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:48:46,569][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:49:15,320][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:49:25,708][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:49:33,296][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:50:01,599][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:50:08,848][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:50:24,763][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:50:53,837][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:50:58,653][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:51:05,478][root][INFO] - Processing question number 80
[2025-02-21 07:51:05,482][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:51:12,189][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:51:41,398][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:51:51,623][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:51:57,665][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:52:27,192][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:52:38,318][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:52:49,750][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:52:57,437][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:53:02,011][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:53:10,085][root][INFO] - Processing question number 90
[2025-02-21 07:53:10,089][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:53:15,767][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:53:26,998][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:53:32,145][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:53:37,485][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:53:50,223][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:54:07,785][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:54:15,678][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:54:24,018][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:54:30,557][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:54:59,656][root][INFO] - Inference complete
[2025-02-21 07:54:59,656][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,662][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,663][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:54:59,663][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:54:59,664][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:54:59,664][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:54:59,664][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:54:59,664][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:54:59,664][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:54:59,665][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:54:59,665][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:54:59,665][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:54:59,665][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:54:59,665][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:54:59,666][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:54:59,667][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:54:59,667][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:54:59,667][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:54:59,667][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:54:59,667][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:54:59,667][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:54:59,668][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:54:59,668][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:54:59,669][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 07:54:59,669][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:54:59,670][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:54:59,671][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:54:59,672][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:54:59,672][root][ERROR] - |Q. 85||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:54:59,672][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:54:59,672][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:54:59,673][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:54:59,674][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:54:59,674][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:54:59,674][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:54:59,674][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:54:59,674][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:54:59,674][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:54:59,675][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:54:59,675][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:54:59,675][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:54:59,675][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 07:54:59,675][root][ERROR] - |Q. 30||D: Property| Failed to extract chosen option: 
[2025-02-21 07:54:59,675][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:54:59,675][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:54:59,676][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:54:59,676][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 07:54:59,676][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 07:54:59,676][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:54:59,676][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:54:59,676][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:54:59,676][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:54:59,677][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 07:54:59,677][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-21 07:54:59,677][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:54:59,677][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:54:59,677][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:54:59,677][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 07:54:59,677][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 07:54:59,677][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:54:59,678][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:54:59,679][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:54:59,680][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 07:54:59,680][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:54:59,680][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,685][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,685][root][INFO] - Saved parsed outputs
[2025-02-21 07:54:59,685][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,687][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,687][root][INFO] - Saved parsing metadata
[2025-02-21 07:54:59,687][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,689][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:54:59,690][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:54:59,703][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:54:59,703][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.02, 'malformed_label': 19, 'malformed_domain': 95, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.02, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 46, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 07:55:06,569][root][INFO] - Setting global seed to 989
[2025-02-21 07:55:06,573][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:55:06,574][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:55:06,575][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:55:06,576][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:55:06,578][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:55:06,578][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:55:06,720][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:55:07,356][root][INFO] - Full model selected, loading model
[2025-02-21 07:55:24,072][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:55:24,072][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:55:31,542][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:55:31,544][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:55:31,544][root][INFO] - Starting inference
[2025-02-21 07:55:31,750][root][INFO] - Processing question number 0
[2025-02-21 07:55:31,753][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:55:41,150][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:55:56,915][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:56:06,470][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:56:23,266][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:56:34,347][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:56:44,018][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:56:55,740][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:57:04,297][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:57:21,482][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:57:32,333][root][INFO] - Processing question number 10
[2025-02-21 07:57:32,335][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:57:48,858][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:58:04,813][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:58:18,586][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:58:27,702][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:58:37,965][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:58:45,885][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:58:54,319][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:59:13,459][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:59:25,188][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:59:34,055][root][INFO] - Processing question number 20
[2025-02-21 07:59:34,057][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:59:50,047][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:00:08,917][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:00:24,689][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:00:37,957][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:00:48,168][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:01:03,871][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:01:19,635][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:01:36,840][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:01:51,336][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:02:04,931][root][INFO] - Processing question number 30
[2025-02-21 08:02:04,933][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:02:19,762][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:02:34,390][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:02:49,697][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:03:09,860][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:03:23,903][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:03:40,959][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:03:55,925][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:04:11,743][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:04:19,996][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:04:31,247][root][INFO] - Processing question number 40
[2025-02-21 08:04:31,250][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:04:39,876][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:04:56,158][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:05:16,094][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:05:31,230][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:05:45,070][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:05:53,782][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:06:01,192][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:06:11,338][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:06:21,073][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:06:31,892][root][INFO] - Processing question number 50
[2025-02-21 08:06:31,895][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:06:46,488][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:06:56,822][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:07:08,719][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:07:20,587][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:07:36,204][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:07:48,105][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:08:01,874][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:08:11,535][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:08:25,225][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:08:33,792][root][INFO] - Processing question number 60
[2025-02-21 08:08:33,795][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:08:41,636][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:08:55,030][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:09:05,070][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:09:17,277][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:09:25,548][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:09:42,742][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:09:50,028][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:09:59,556][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:10:05,628][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:10:15,193][root][INFO] - Processing question number 70
[2025-02-21 08:10:15,197][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:10:30,409][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:10:40,454][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:11:00,153][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:11:27,067][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:11:35,873][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:11:52,161][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:12:01,046][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:12:12,785][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:12:21,492][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:12:28,672][root][INFO] - Processing question number 80
[2025-02-21 08:12:28,676][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:12:37,669][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:12:47,509][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:13:06,700][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:13:17,052][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:13:31,530][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:13:59,743][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:14:15,236][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:14:30,643][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:14:45,858][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:15:02,097][root][INFO] - Processing question number 90
[2025-02-21 08:15:02,101][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:15:12,885][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:15:22,323][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:15:32,832][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:15:41,943][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:15:58,677][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:16:09,572][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:16:20,272][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:16:28,604][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:16:41,152][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:16:51,466][root][INFO] - Inference complete
[2025-02-21 08:16:51,466][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,472][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,473][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:16:51,473][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:16:51,474][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:16:51,475][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:16:51,476][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 08:16:51,477][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:16:51,478][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 08:16:51,479][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:16:51,480][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:16:51,481][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 08:16:51,482][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:16:51,483][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 08:16:51,484][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 08:16:51,485][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 08:16:51,486][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 08:16:51,487][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:16:51,488][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 08:16:51,488][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,499][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,499][root][INFO] - Saved parsed outputs
[2025-02-21 08:16:51,499][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,501][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,501][root][INFO] - Saved parsing metadata
[2025-02-21 08:16:51,501][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,503][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:16:51,510][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:16:51,521][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 08:16:51,521][root][INFO] - Summary of metrics : {'label_accuracy': 0.05, 'misclassification_rate': 0.95, 'combined_accuracy': 0.0, 'malformed_label': 90, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 5, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 5, 'both_wrong': 95}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 08:16:58,183][root][INFO] - Setting global seed to 989
[2025-02-21 08:16:58,188][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 08:16:58,188][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:16:58,190][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:16:58,191][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:16:58,193][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:16:58,193][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:16:58,355][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:16:58,900][root][INFO] - Full model selected, loading model
[2025-02-21 08:17:19,971][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 08:19:02,404][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 08:19:02,406][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 08:19:34,821][root][INFO] - Peft model loaded successfully
[2025-02-21 08:19:42,111][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:19:42,113][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:19:42,113][root][INFO] - Starting inference
[2025-02-21 08:19:42,324][root][INFO] - Processing question number 0
[2025-02-21 08:19:42,326][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:19:49,756][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:20:05,615][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:20:26,064][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:20:48,400][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:21:01,951][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:21:08,426][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:21:13,912][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:21:20,028][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:21:28,376][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:21:32,141][root][INFO] - Processing question number 10
[2025-02-21 08:21:32,142][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:21:37,419][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:21:45,100][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:21:56,465][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:22:11,542][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:22:16,710][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:22:24,861][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:22:35,577][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:22:43,357][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:22:54,577][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:23:02,152][root][INFO] - Processing question number 20
[2025-02-21 08:23:02,154][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:23:07,438][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:23:14,544][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:23:24,656][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:23:29,691][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:23:36,001][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:23:46,896][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:23:53,113][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:24:04,718][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:24:14,476][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:24:18,886][root][INFO] - Processing question number 30
[2025-02-21 08:24:18,889][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:24:23,977][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:24:30,288][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:24:37,079][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:24:43,406][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:24:49,494][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:25:00,649][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:25:05,944][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:25:16,824][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:25:24,116][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:25:33,458][root][INFO] - Processing question number 40
[2025-02-21 08:25:33,461][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:25:38,025][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:25:44,209][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:25:56,190][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:26:01,246][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:26:12,584][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:26:21,972][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:26:24,581][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:26:30,899][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:26:45,888][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:27:15,075][root][INFO] - Processing question number 50
[2025-02-21 08:27:15,078][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:27:20,722][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:27:28,119][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:27:41,141][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:27:52,911][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:28:05,944][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:28:23,165][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:28:33,130][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:28:39,819][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:28:49,353][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:28:55,019][root][INFO] - Processing question number 60
[2025-02-21 08:28:55,022][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:29:22,861][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:29:37,244][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:29:45,823][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:29:54,603][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:30:03,201][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:30:17,923][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:30:43,879][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:30:50,291][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:30:57,731][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:31:05,394][root][INFO] - Processing question number 70
[2025-02-21 08:31:05,398][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:31:16,605][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:31:28,178][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:31:40,031][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:31:46,913][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:31:54,656][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:32:07,067][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:32:22,585][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:32:32,333][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:32:39,258][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:32:45,936][root][INFO] - Processing question number 80
[2025-02-21 08:32:45,940][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:32:56,715][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:33:02,622][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:33:09,788][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:33:18,039][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:33:28,042][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:33:34,315][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:33:41,003][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:33:57,372][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:34:05,345][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:34:13,505][root][INFO] - Processing question number 90
[2025-02-21 08:34:13,509][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:34:23,212][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:34:29,274][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:34:39,259][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:34:45,056][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:34:51,749][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:35:01,240][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:35:30,194][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:35:37,381][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:35:44,236][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:35:52,906][root][INFO] - Inference complete
[2025-02-21 08:35:52,906][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,911][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,912][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:35:52,912][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:35:52,912][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:35:52,913][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:35:52,913][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:35:52,913][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:35:52,913][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:35:52,914][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 08:35:52,915][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:35:52,916][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:35:52,917][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:35:52,918][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:35:52,918][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:35:52,918][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:35:52,918][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:35:52,918][root][ERROR] - |Q. 43||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:35:52,918][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:35:52,919][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:35:52,920][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 08:35:52,920][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:35:52,920][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 08:35:52,920][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:35:52,921][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:35:52,922][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:35:52,922][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:35:52,922][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 08:35:52,922][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:35:52,922][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 08:35:52,922][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:35:52,923][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 08:35:52,923][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:35:52,924][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:35:52,924][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 08:35:52,924][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 08:35:52,924][root][ERROR] - |Q. 74||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:35:52,924][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 08:35:52,925][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,941][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,941][root][INFO] - Saved parsed outputs
[2025-02-21 08:35:52,941][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,947][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,947][root][INFO] - Saved parsing metadata
[2025-02-21 08:35:52,948][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,949][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:35:52,968][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:35:52,976][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 08:35:52,976][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.07, 'malformed_label': 12, 'malformed_domain': 87, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 7, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.03, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 6, 'correct_label_wrong_domain': 44, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 32 to status running with exit code None
Eval status update completed for job 32
[2025-02-21 08:35:59,521][root][INFO] - Setting global seed to 989
[2025-02-21 08:35:59,527][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 08:35:59,527][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:35:59,528][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:35:59,530][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:35:59,532][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:35:59,532][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:35:59,676][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:36:00,197][root][INFO] - Full model selected, loading model
[2025-02-21 08:36:22,398][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:36:22,421][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:36:30,243][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:36:30,245][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:36:30,245][root][INFO] - Starting inference
[2025-02-21 08:36:30,438][root][INFO] - Processing question number 0
[2025-02-21 08:36:30,441][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:36:48,068][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:37:04,798][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:37:13,404][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:37:25,026][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:37:34,067][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:37:46,624][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:37:52,700][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:38:09,301][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:38:28,169][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:38:40,976][root][INFO] - Processing question number 10
[2025-02-21 08:38:40,978][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:38:48,860][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:39:03,666][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:39:18,604][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:39:33,446][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:39:41,971][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:39:48,367][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:39:55,539][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:40:13,183][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:40:26,470][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:40:37,877][root][INFO] - Processing question number 20
[2025-02-21 08:40:37,879][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:40:47,226][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:41:00,262][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:41:17,399][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:41:30,696][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:41:41,277][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:41:49,311][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:42:00,080][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:42:18,228][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:42:24,946][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:42:46,215][root][INFO] - Processing question number 30
[2025-02-21 08:42:46,217][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:43:02,080][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:43:17,068][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:43:33,978][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:43:42,212][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:43:54,690][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:44:11,154][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:44:28,670][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:44:44,330][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:44:52,805][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:45:09,836][root][INFO] - Processing question number 40
[2025-02-21 08:45:09,839][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:45:21,527][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:45:40,129][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:45:55,663][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:46:06,434][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:46:18,021][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:46:33,293][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:46:40,515][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:46:59,192][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:47:10,929][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:47:22,490][root][INFO] - Processing question number 50
[2025-02-21 08:47:22,493][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:47:33,632][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:47:44,417][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:47:54,986][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:48:08,777][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:48:16,732][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:48:28,761][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:48:41,468][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:48:51,117][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:49:02,013][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:49:08,540][root][INFO] - Processing question number 60
[2025-02-21 08:49:08,543][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:49:17,255][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:49:37,218][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:49:48,632][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:50:00,877][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:50:14,992][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:50:25,185][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:50:42,630][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:50:49,309][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:50:57,936][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:51:11,279][root][INFO] - Processing question number 70
[2025-02-21 08:51:11,282][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:51:23,047][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:51:36,871][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:52:02,320][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:52:24,582][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:52:34,604][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:52:53,179][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:53:05,649][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:53:28,779][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:53:41,293][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:53:56,900][root][INFO] - Processing question number 80
[2025-02-21 08:53:56,904][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:54:13,341][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:54:23,079][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:54:41,284][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:54:58,362][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:55:15,948][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:55:30,724][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:55:44,432][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:55:55,990][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:56:11,336][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:56:27,567][root][INFO] - Processing question number 90
[2025-02-21 08:56:27,571][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:56:36,287][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:56:46,568][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:56:56,787][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:57:06,963][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:57:18,301][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:57:31,469][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:57:38,061][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:57:55,567][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:58:06,992][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:58:19,025][root][INFO] - Inference complete
[2025-02-21 08:58:19,026][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,032][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,032][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 08:58:19,033][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:58:19,034][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:58:19,035][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:58:19,036][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:58:19,037][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:58:19,038][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:58:19,039][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:58:19,040][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:58:19,041][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:58:19,042][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:58:19,043][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 08:58:19,044][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:58:19,045][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 08:58:19,046][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 08:58:19,047][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 08:58:19,047][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:58:19,047][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 08:58:19,048][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,052][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,052][root][INFO] - Saved parsed outputs
[2025-02-21 08:58:19,053][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,060][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,060][root][INFO] - Saved parsing metadata
[2025-02-21 08:58:19,060][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,061][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 08:58:19,072][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:58:19,084][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-21 08:58:19,084][root][INFO] - Summary of metrics : {'label_accuracy': 0.08, 'misclassification_rate': 0.92, 'combined_accuracy': 0.0, 'malformed_label': 87, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 8, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 8, 'both_wrong': 92}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '32', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 32 to status completed with exit code 0
Eval status update completed for job 32
Job 32 completed at Fri Feb 21 08:58:20 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n517
Job ID: 25309367
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 08:40:02
CPU Efficiency: 9.91% of 3-15:26:50 core-walltime
Job Wall-clock time: 08:44:41
Memory Utilized: 35.00 GB
Memory Efficiency: 97.23% of 36.00 GB
