Unused kwargs: ['use_nested_quant']. These kwargs are not used in <class 'transformers.utils.quantization_config.BitsAndBytesConfig'>.
`low_cpu_mem_usage` was None, now default to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:05<00:17,  5.88s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:11<00:11,  5.71s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:17<00:05,  5.66s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:18<00:00,  3.98s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:18<00:00,  4.62s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
The new lm_head weights will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Map:   0%|          | 0/7 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:00<00:00, 232.04 examples/s]
wandb: Currently logged in as: rean-fernandes. Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.3
wandb: Run data is saved locally in /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/wandb/run-20250220_104020-uokn4i52
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fine_tune_markdown_fact_first_few_shot_unstructured_seed_314_llama3
wandb: â­ï¸ View project at https://wandb.ai/rean-fernandes/Final_runs_paper
wandb: ðŸš€ View run at https://wandb.ai/rean-fernandes/Final_runs_paper/runs/uokn4i52
  0%|          | 0/15 [00:00<?, ?it/s]  7%|â–‹         | 1/15 [00:27<06:31, 28.00s/it] 13%|â–ˆâ–Ž        | 2/15 [00:55<06:02, 27.88s/it] 20%|â–ˆâ–ˆ        | 3/15 [01:23<05:34, 27.87s/it] 27%|â–ˆâ–ˆâ–‹       | 4/15 [01:51<05:06, 27.88s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 5/15 [02:19<04:39, 27.90s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 6/15 [02:47<04:11, 27.94s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 7/15 [03:15<03:43, 27.97s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 8/15 [03:43<03:15, 27.99s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 9/15 [04:11<02:48, 28.00s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 10/15 [04:39<02:20, 28.02s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 10/15 [04:39<02:20, 28.02s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 11/15 [05:07<01:52, 28.03s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 12/15 [05:35<01:24, 28.05s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 13/15 [06:03<00:56, 28.06s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 14/15 [06:31<00:28, 28.07s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [07:00<00:00, 28.08s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [07:00<00:00, 28.08s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [07:00<00:00, 28.01s/it]
/pfs/data5/home/fr/fr_fr/fr_rf1031/llama-env/lib64/python3.11/site-packages/peft/utils/save_and_load.py:257: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:         train/epoch â–â–ˆ
wandb:   train/global_step â–â–ˆ
wandb:     train/grad_norm â–
wandb: train/learning_rate â–
wandb:          train/loss â–
wandb: 
wandb: Run summary:
wandb:               total_flos 4949812822671360.0
wandb:              train/epoch 15
wandb:        train/global_step 15
wandb:          train/grad_norm 0.40661
wandb:      train/learning_rate 3e-05
wandb:               train/loss 1.5221
wandb:               train_loss 1.32893
wandb:            train_runtime 421.7695
wandb: train_samples_per_second 0.249
wandb:   train_steps_per_second 0.036
wandb: 
wandb: ðŸš€ View run fine_tune_markdown_fact_first_few_shot_unstructured_seed_314_llama3 at: https://wandb.ai/rean-fernandes/Final_runs_paper/runs/uokn4i52
wandb: â­ï¸ View project at: https://wandb.ai/rean-fernandes/Final_runs_paper
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250220_104020-uokn4i52/logs
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.91s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.30s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.09s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.33s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
The new lm_head weights will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
/pfs/data5/home/fr/fr_fr/fr_rf1031/llama-env/lib64/python3.11/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/pfs/data5/home/fr/fr_fr/fr_rf1031/llama-env/lib64/python3.11/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_206

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Could not override 'seeds'. No match in the defaults list.
To append to your default list use +seeds=seed_42

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
