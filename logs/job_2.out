Starting job 2 at Thu Feb 20 22:36:39 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=number_list_answer_first_few_shot_structured train=number_list_answer_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '2', 'training']
Updating job 2 to status training with exit code None
Status update completed for job 2
[2025-02-20 22:37:18,677][root][INFO] - Global seed set to 314
[2025-02-20 22:37:18,679][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:37:18,679][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:37:18,679][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:37:18,679][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:37:18,679][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-02-20 22:37:18,699][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:37:18,713][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:37:18,716][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:37:18,722][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:37:19,664][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:37:48,017][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:38:15,587][root][INFO] - Model prepared for kbit training
[2025-02-20 22:38:15,588][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'gate_proj', 'q_proj', 'down_proj', 'k_proj', 'up_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:38:17,256][root][INFO] - Lora adapter added to model
[2025-02-20 22:38:17,261][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_answer_first_few_shot_structured
[2025-02-20 22:38:17,584][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6154, 'grad_norm': 0.4282730519771576, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.3067, 'grad_norm': 0.40203556418418884, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.1064, 'grad_norm': 0.36895284056663513, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 0.9451, 'grad_norm': 0.34529706835746765, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.6884, 'grad_norm': 0.3482295572757721, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 423.6339, 'train_samples_per_second': 0.248, 'train_steps_per_second': 0.035, 'train_loss': 1.1324214776357016, 'epoch': 15.0}
[2025-02-20 22:45:28,588][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_answer_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '2', 'trained', '0']
Updating job 2 to status trained with exit code 0
Status update completed for job 2
Starting evaluations for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-20 22:45:38,136][root][INFO] - Setting global seed to 206
[2025-02-20 22:45:38,142][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 22:45:38,142][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:45:38,143][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 22:45:38,146][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:45:38,148][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 22:45:38,148][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 22:45:38,315][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 22:45:38,861][root][INFO] - Full model selected, loading model
[2025-02-20 22:45:54,428][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 22:47:35,128][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 22:47:35,129][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 22:48:06,635][root][INFO] - Peft model loaded successfully
[2025-02-20 22:48:13,860][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 22:48:13,862][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 22:48:13,862][root][INFO] - Starting inference
[2025-02-20 22:48:14,072][root][INFO] - Processing question number 0
[2025-02-20 22:48:14,136][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 22:48:27,139][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 22:48:40,881][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 22:48:54,850][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 22:49:07,860][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 22:49:20,501][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 22:49:33,675][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 22:49:45,986][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 22:49:59,323][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 22:50:10,246][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 22:50:23,404][root][INFO] - Processing question number 10
[2025-02-20 22:50:23,406][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 22:50:39,208][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 22:50:52,246][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 22:51:03,727][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 22:51:17,020][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 22:51:29,299][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 22:51:45,204][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 22:51:58,295][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 22:52:10,111][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 22:52:23,622][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 22:52:37,531][root][INFO] - Processing question number 20
[2025-02-20 22:52:37,534][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 22:52:48,085][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 22:53:01,371][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 22:53:12,368][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 22:53:24,754][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 22:53:37,088][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 22:53:52,112][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 22:54:04,405][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 22:54:17,863][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 22:54:30,457][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 22:54:43,745][root][INFO] - Processing question number 30
[2025-02-20 22:54:43,748][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 22:54:58,841][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 22:55:10,633][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 22:55:26,379][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 22:55:40,222][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 22:55:50,527][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 22:56:03,767][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 22:56:16,816][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 22:56:32,556][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 22:56:46,035][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 22:56:59,337][root][INFO] - Processing question number 40
[2025-02-20 22:56:59,340][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 22:57:13,603][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 22:57:24,969][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 22:57:39,902][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 22:57:52,269][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 22:58:05,739][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 22:58:17,785][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 22:58:32,255][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 22:58:43,841][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 22:58:58,215][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 22:59:11,919][root][INFO] - Processing question number 50
[2025-02-20 22:59:11,923][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 22:59:24,212][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 22:59:39,358][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 22:59:49,559][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:00:03,865][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:00:16,622][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:00:27,947][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:00:42,456][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:00:56,584][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:01:10,579][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:01:22,593][root][INFO] - Processing question number 60
[2025-02-20 23:01:22,597][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:01:35,309][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:01:46,668][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:02:00,120][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:02:11,372][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:02:22,811][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:02:33,991][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:02:44,780][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:02:59,000][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:03:11,571][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:03:25,518][root][INFO] - Processing question number 70
[2025-02-20 23:03:25,523][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:03:38,350][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:03:50,866][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:04:02,714][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:04:16,301][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:04:30,434][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:04:45,062][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:04:59,938][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:05:11,917][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:05:26,864][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:05:40,063][root][INFO] - Processing question number 80
[2025-02-20 23:05:40,068][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:05:53,227][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:06:10,305][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:06:23,447][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:06:36,459][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:06:51,649][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:07:07,024][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:07:19,769][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:07:31,223][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:07:45,212][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:07:57,540][root][INFO] - Processing question number 90
[2025-02-20 23:07:57,545][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:08:13,292][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:08:23,201][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:08:34,035][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:08:45,978][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:09:00,949][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:09:13,837][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:09:25,775][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:09:40,001][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:09:53,871][root][INFO] - Inference complete
[2025-02-20 23:09:53,871][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,882][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,896][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,940][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,940][root][INFO] - Saved parsed outputs
[2025-02-20 23:09:53,940][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,964][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,964][root][INFO] - Saved parsing metadata
[2025-02-20 23:09:53,967][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:53,985][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:09:54,039][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:09:54,221][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-20 23:09:54,222][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 0, 'malformed_domain': 18, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 10, 'both_wrong': 8}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-20 23:10:02,417][root][INFO] - Setting global seed to 206
[2025-02-20 23:10:02,425][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:10:02,425][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:10:02,426][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:10:02,429][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:10:02,430][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:10:02,431][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:10:02,585][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:10:03,131][root][INFO] - Full model selected, loading model
[2025-02-20 23:10:31,946][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:10:31,946][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:10:39,282][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:10:39,284][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:10:39,284][root][INFO] - Starting inference
[2025-02-20 23:10:39,500][root][INFO] - Processing question number 0
[2025-02-20 23:10:39,554][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:10:52,033][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:11:03,941][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:11:17,604][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:11:30,566][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:11:45,132][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:11:58,553][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:12:16,906][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:12:30,891][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:12:41,613][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:12:54,412][root][INFO] - Processing question number 10
[2025-02-20 23:12:54,414][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:13:09,623][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:13:22,564][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:13:34,503][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:13:49,952][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:14:01,821][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:14:15,808][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:14:27,632][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:14:39,800][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:14:51,995][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:15:01,824][root][INFO] - Processing question number 20
[2025-02-20 23:15:01,826][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:15:14,090][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:15:28,290][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:15:40,483][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:15:52,219][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:16:06,946][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:16:19,936][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:16:35,905][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:16:53,336][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:17:06,277][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:17:19,002][root][INFO] - Processing question number 30
[2025-02-20 23:17:19,005][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:17:39,041][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:17:52,507][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:18:07,998][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:18:21,747][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:18:33,003][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:18:46,647][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:19:00,354][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:19:14,503][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:19:30,386][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:19:44,530][root][INFO] - Processing question number 40
[2025-02-20 23:19:44,533][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:19:57,682][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:20:13,785][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:20:27,325][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:20:42,215][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:20:53,713][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:21:08,551][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:21:26,905][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:21:39,348][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:21:53,478][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:22:07,184][root][INFO] - Processing question number 50
[2025-02-20 23:22:07,188][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:22:22,277][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:22:38,041][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:22:49,544][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:23:04,316][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:23:16,994][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:23:29,961][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:23:44,846][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:24:00,390][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:24:14,648][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:24:27,180][root][INFO] - Processing question number 60
[2025-02-20 23:24:27,184][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:24:40,555][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:24:50,109][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:25:04,383][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:25:15,385][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:25:28,545][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:25:41,088][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:25:55,688][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:26:07,420][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:26:19,996][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:26:31,347][root][INFO] - Processing question number 70
[2025-02-20 23:26:31,352][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:26:45,300][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:27:03,209][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:27:15,372][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:27:31,228][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:27:45,218][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:27:57,830][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:28:12,306][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:28:28,741][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:28:46,392][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:29:00,559][root][INFO] - Processing question number 80
[2025-02-20 23:29:00,564][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:29:13,525][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:29:29,069][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:29:41,764][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:29:54,281][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:30:09,120][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:30:22,709][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:30:37,052][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:30:50,433][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:31:06,582][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:31:20,523][root][INFO] - Processing question number 90
[2025-02-20 23:31:20,530][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:31:38,156][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:31:50,358][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:32:04,815][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:32:20,376][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:32:35,204][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:32:49,863][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:33:02,319][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:33:15,283][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:33:29,772][root][INFO] - Inference complete
[2025-02-20 23:33:29,772][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,779][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,794][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,825][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,825][root][INFO] - Saved parsed outputs
[2025-02-20 23:33:29,825][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,871][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,871][root][INFO] - Saved parsing metadata
[2025-02-20 23:33:29,872][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,874][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:33:29,902][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:33:29,940][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-20 23:33:29,940][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 17, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-20 23:33:38,432][root][INFO] - Setting global seed to 206
[2025-02-20 23:33:38,439][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:33:38,439][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:33:38,441][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:33:38,442][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:33:38,448][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:33:38,448][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:33:38,593][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:33:39,158][root][INFO] - Full model selected, loading model
[2025-02-20 23:34:02,461][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:35:42,322][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:35:42,322][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:36:12,272][root][INFO] - Peft model loaded successfully
[2025-02-20 23:36:19,468][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:36:19,470][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:19,470][root][INFO] - Starting inference
[2025-02-20 23:36:19,726][root][INFO] - Processing question number 0
[2025-02-20 23:36:19,773][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:36:33,584][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:36:46,508][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:37:03,504][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:37:18,270][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:37:32,699][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:37:45,970][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:37:57,970][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:38:12,080][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:38:23,395][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:38:35,686][root][INFO] - Processing question number 10
[2025-02-20 23:38:35,688][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:38:53,311][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:39:04,891][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:39:17,336][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:39:32,289][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:39:43,639][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:39:57,231][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:40:08,767][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:40:22,571][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:40:35,226][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:40:49,914][root][INFO] - Processing question number 20
[2025-02-20 23:40:49,917][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:41:00,557][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:41:14,874][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:41:27,972][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:41:39,656][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:41:52,603][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:42:09,958][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:42:22,769][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:42:36,544][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:42:50,415][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:43:02,707][root][INFO] - Processing question number 30
[2025-02-20 23:43:02,710][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:43:17,719][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:43:30,781][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:43:47,076][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:44:00,631][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:44:11,166][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:44:22,450][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:44:33,350][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:44:47,247][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:44:59,882][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:45:14,593][root][INFO] - Processing question number 40
[2025-02-20 23:45:14,597][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:45:27,904][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:45:41,154][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:45:55,421][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:46:07,377][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:46:19,528][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:46:32,027][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:46:44,835][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:46:57,820][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:47:11,798][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:47:26,394][root][INFO] - Processing question number 50
[2025-02-20 23:47:26,398][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:47:39,773][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:47:55,239][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:48:05,822][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:48:19,030][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:48:33,066][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:48:43,729][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:48:58,719][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:49:13,406][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:49:25,712][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:49:38,180][root][INFO] - Processing question number 60
[2025-02-20 23:49:38,184][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:49:50,336][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:50:01,985][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:50:20,533][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:50:31,215][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:50:42,793][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:50:55,586][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:51:07,581][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:51:21,398][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:51:35,408][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:51:49,311][root][INFO] - Processing question number 70
[2025-02-20 23:51:49,316][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:52:02,297][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:52:15,624][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:52:26,354][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:52:42,065][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:52:55,085][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:53:07,247][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:53:21,888][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:53:33,503][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:53:47,589][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:54:02,177][root][INFO] - Processing question number 80
[2025-02-20 23:54:02,182][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:54:16,167][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:54:32,289][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:54:44,829][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:54:58,406][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:55:13,298][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:55:29,470][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:55:42,990][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:55:57,291][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:56:11,965][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:56:24,389][root][INFO] - Processing question number 90
[2025-02-20 23:56:24,395][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:56:39,066][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:56:49,057][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:57:00,127][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:57:11,114][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:57:27,671][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:57:42,338][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:57:54,532][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:58:08,621][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:58:21,007][root][INFO] - Inference complete
[2025-02-20 23:58:21,007][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,014][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,028][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,063][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,063][root][INFO] - Saved parsed outputs
[2025-02-20 23:58:21,063][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,078][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,078][root][INFO] - Saved parsing metadata
[2025-02-20 23:58:21,079][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,082][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:58:21,099][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:58:21,132][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-20 23:58:21,133][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 8, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-20 23:58:32,181][root][INFO] - Setting global seed to 206
[2025-02-20 23:58:32,190][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:58:32,190][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:58:32,191][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:58:32,194][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:58:32,199][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:58:32,199][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:58:32,401][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:58:32,975][root][INFO] - Full model selected, loading model
[2025-02-20 23:58:59,349][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:58:59,366][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:59:07,425][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:59:07,426][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:59:07,426][root][INFO] - Starting inference
[2025-02-20 23:59:07,638][root][INFO] - Processing question number 0
[2025-02-20 23:59:07,691][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:59:21,003][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:59:37,037][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:59:51,170][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:00:02,952][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:00:18,567][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:00:32,612][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:00:48,614][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:01:02,374][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:01:14,954][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:01:27,966][root][INFO] - Processing question number 10
[2025-02-21 00:01:27,969][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:01:42,928][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:01:58,070][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:02:11,135][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:02:26,768][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:02:40,180][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:02:53,468][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:03:08,129][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:03:21,889][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:03:33,164][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:03:42,827][root][INFO] - Processing question number 20
[2025-02-21 00:03:42,829][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:03:55,046][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:04:12,059][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:04:24,502][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:04:36,339][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:04:52,285][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:05:05,741][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:05:21,687][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:05:34,493][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:05:48,215][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:06:03,693][root][INFO] - Processing question number 30
[2025-02-21 00:06:03,696][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:06:23,749][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:06:35,017][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:06:51,789][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:07:06,270][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:07:19,301][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:07:32,394][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:07:46,373][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:08:03,446][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:08:17,812][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:08:31,227][root][INFO] - Processing question number 40
[2025-02-21 00:08:31,230][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:08:46,029][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:09:00,773][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:09:16,092][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:09:30,898][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:09:45,304][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:09:58,371][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:10:11,809][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:10:25,160][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:10:40,230][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:10:53,222][root][INFO] - Processing question number 50
[2025-02-21 00:10:53,226][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:11:07,706][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:11:24,280][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:11:36,125][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:11:49,445][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:12:04,875][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:12:17,960][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:12:33,169][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:12:48,430][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:13:04,054][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:13:16,269][root][INFO] - Processing question number 60
[2025-02-21 00:13:16,273][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:13:29,244][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:13:38,623][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:13:53,587][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:14:06,342][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:14:21,407][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:14:34,308][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:14:48,104][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:15:00,136][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:15:13,072][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:15:26,261][root][INFO] - Processing question number 70
[2025-02-21 00:15:26,266][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:15:41,099][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:16:12,840][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:16:26,529][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:16:44,862][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:17:01,872][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:17:15,455][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:17:31,412][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:17:45,294][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:18:03,614][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:18:16,618][root][INFO] - Processing question number 80
[2025-02-21 00:18:16,624][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:18:32,118][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:18:47,942][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:19:00,029][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:19:13,002][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:19:26,974][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:19:40,680][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:19:55,192][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:20:08,328][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:20:24,455][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:20:36,787][root][INFO] - Processing question number 90
[2025-02-21 00:20:36,793][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:20:49,544][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:21:02,753][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:21:19,284][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:21:31,939][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:21:45,540][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:22:00,577][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:22:13,032][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:22:27,284][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:22:42,987][root][INFO] - Inference complete
[2025-02-21 00:22:42,987][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:42,994][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,004][root][WARNING] - No match found for 6. Legal Conclusion in question number 96 in domain Evidence
[2025-02-21 00:22:43,009][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,047][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,047][root][INFO] - Saved parsed outputs
[2025-02-21 00:22:43,047][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,070][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,070][root][INFO] - Saved parsing metadata
[2025-02-21 00:22:43,071][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,074][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:22:43,098][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:22:43,117][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 00:22:43,117][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 38, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 17, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 00:22:51,122][root][INFO] - Setting global seed to 206
[2025-02-21 00:22:51,130][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:22:51,130][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:22:51,132][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:22:51,134][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:22:51,136][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:22:51,136][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:22:51,278][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:22:51,882][root][INFO] - Full model selected, loading model
[2025-02-21 00:23:09,450][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:24:50,115][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:24:50,116][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:25:20,932][root][INFO] - Peft model loaded successfully
[2025-02-21 00:25:28,517][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:25:28,519][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:25:28,519][root][INFO] - Starting inference
[2025-02-21 00:25:28,759][root][INFO] - Processing question number 0
[2025-02-21 00:25:28,761][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:25:41,692][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:25:56,374][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:26:11,838][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:26:25,730][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:26:39,906][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:26:53,953][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:27:06,997][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:27:23,421][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:27:34,832][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:27:47,178][root][INFO] - Processing question number 10
[2025-02-21 00:27:47,180][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:28:02,943][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:28:16,236][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:28:28,883][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:28:42,375][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:28:55,933][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:29:09,671][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:29:22,414][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:29:34,734][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:29:46,211][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:29:57,329][root][INFO] - Processing question number 20
[2025-02-21 00:29:57,331][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:30:07,969][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:30:23,880][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:30:38,404][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:30:51,594][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:31:06,390][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:31:19,586][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:31:34,890][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:31:49,483][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:32:04,580][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:32:17,718][root][INFO] - Processing question number 30
[2025-02-21 00:32:17,721][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:32:30,982][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:32:42,961][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:32:58,217][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:33:12,582][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:33:23,219][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:33:35,472][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:33:49,022][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:34:03,900][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:34:18,353][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:34:32,844][root][INFO] - Processing question number 40
[2025-02-21 00:34:32,848][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:34:46,354][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:35:00,208][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:35:13,540][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:35:25,901][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:35:38,253][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:35:50,902][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:36:04,694][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:36:19,949][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:36:35,200][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:36:48,179][root][INFO] - Processing question number 50
[2025-02-21 00:36:48,182][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:37:02,860][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:37:16,888][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:37:27,766][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:37:42,545][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:37:57,345][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:38:08,207][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:38:23,766][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:38:36,213][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:38:49,901][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:39:13,477][root][INFO] - Processing question number 60
[2025-02-21 00:39:13,481][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:39:26,238][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:39:37,476][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:39:53,676][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:40:04,354][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:40:14,910][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:40:27,344][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:40:39,131][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:40:50,182][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:41:01,780][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:41:15,269][root][INFO] - Processing question number 70
[2025-02-21 00:41:15,274][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:41:29,629][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:41:42,850][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:41:54,793][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:42:08,333][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:42:20,325][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:42:32,728][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:42:47,471][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:43:05,149][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:43:20,346][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:43:36,656][root][INFO] - Processing question number 80
[2025-02-21 00:43:36,660][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:43:49,505][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:44:04,923][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:44:17,085][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:44:30,761][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:44:45,416][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:45:01,081][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:45:15,763][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:45:27,909][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:45:42,578][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:45:56,020][root][INFO] - Processing question number 90
[2025-02-21 00:45:56,025][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:46:10,908][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:46:22,500][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:46:34,743][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:46:47,633][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:47:02,046][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:47:16,048][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:47:28,290][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:47:41,043][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:47:56,948][root][INFO] - Inference complete
[2025-02-21 00:47:56,948][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,954][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,969][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,975][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,975][root][INFO] - Saved parsed outputs
[2025-02-21 00:47:56,975][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,977][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,977][root][INFO] - Saved parsing metadata
[2025-02-21 00:47:56,977][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,979][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:47:56,981][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:47:57,013][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 00:47:57,014][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.3939393939393939, 'malformed_label': 1, 'malformed_domain': 20, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 9, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 00:48:04,885][root][INFO] - Setting global seed to 206
[2025-02-21 00:48:04,891][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:48:04,891][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:48:04,893][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:48:04,894][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:48:04,897][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:48:04,897][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:48:05,045][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:48:05,598][root][INFO] - Full model selected, loading model
[2025-02-21 00:48:18,879][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:48:18,880][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:48:26,356][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:48:26,358][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:48:26,358][root][INFO] - Starting inference
[2025-02-21 00:48:26,530][root][INFO] - Processing question number 0
[2025-02-21 00:48:26,533][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:48:40,314][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:48:56,498][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:49:11,597][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:49:27,699][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:49:42,071][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:49:57,286][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:50:18,351][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:50:33,993][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:50:46,050][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:50:59,771][root][INFO] - Processing question number 10
[2025-02-21 00:50:59,773][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:51:18,992][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:51:32,381][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:51:45,945][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:51:59,745][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:52:14,740][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:52:28,422][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:52:42,149][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:52:55,174][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:53:08,638][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:53:21,284][root][INFO] - Processing question number 20
[2025-02-21 00:53:21,286][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:53:35,397][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:53:50,437][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:54:03,019][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:54:14,700][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:54:28,995][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:54:45,534][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:54:59,204][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:55:13,897][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:55:27,656][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:55:40,729][root][INFO] - Processing question number 30
[2025-02-21 00:55:40,731][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:55:54,249][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:56:08,387][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:56:25,930][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:56:42,145][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:56:54,096][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:57:07,228][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:57:23,344][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:57:39,156][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:57:53,303][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:58:07,376][root][INFO] - Processing question number 40
[2025-02-21 00:58:07,379][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:58:23,406][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:58:39,067][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:58:55,205][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:59:07,718][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:59:22,675][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:59:37,472][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:59:53,464][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:00:05,344][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:00:17,067][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:00:30,002][root][INFO] - Processing question number 50
[2025-02-21 01:00:30,005][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:00:43,481][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:00:58,948][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:01:11,237][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:01:27,741][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:01:39,824][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:01:51,589][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:02:05,377][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:02:19,553][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:02:35,533][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:02:49,406][root][INFO] - Processing question number 60
[2025-02-21 01:02:49,410][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:03:03,644][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:03:16,360][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:03:32,406][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:03:46,114][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:03:59,220][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:04:10,677][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:04:23,024][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:04:36,326][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:04:48,893][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:05:02,484][root][INFO] - Processing question number 70
[2025-02-21 01:05:02,489][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:05:17,156][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:05:31,549][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:05:43,342][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:05:59,159][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:06:15,222][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:06:28,896][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:06:44,112][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:06:56,030][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:07:11,672][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:07:26,460][root][INFO] - Processing question number 80
[2025-02-21 01:07:26,465][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:07:39,010][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:07:55,966][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:08:08,600][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:08:25,403][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:08:37,664][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:08:55,416][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:09:11,635][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:09:27,318][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:09:44,682][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:09:57,657][root][INFO] - Processing question number 90
[2025-02-21 01:09:57,662][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:10:17,374][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:10:31,531][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:10:45,325][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:10:58,423][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:11:14,922][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:11:30,663][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:11:43,359][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:11:57,602][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:12:12,458][root][INFO] - Inference complete
[2025-02-21 01:12:12,459][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,466][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,481][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,487][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,488][root][INFO] - Saved parsed outputs
[2025-02-21 01:12:12,488][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,489][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,489][root][INFO] - Saved parsing metadata
[2025-02-21 01:12:12,490][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,491][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:12:12,493][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:12:12,518][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 01:12:12,518][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.24242424242424243, 'malformed_label': 0, 'malformed_domain': 41, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 21, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 01:12:19,955][root][INFO] - Setting global seed to 989
[2025-02-21 01:12:19,962][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:12:19,962][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:12:19,963][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:12:19,965][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:12:19,968][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:12:19,968][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:12:20,161][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:12:20,715][root][INFO] - Full model selected, loading model
[2025-02-21 01:12:39,480][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:14:20,550][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:14:20,572][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:14:50,051][root][INFO] - Peft model loaded successfully
[2025-02-21 01:14:57,328][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:14:57,330][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:14:57,330][root][INFO] - Starting inference
[2025-02-21 01:14:57,554][root][INFO] - Processing question number 0
[2025-02-21 01:14:57,556][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:15:09,430][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:15:23,172][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:15:37,136][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:15:50,145][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:16:02,784][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:16:15,954][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:16:28,264][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:16:41,599][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:16:52,524][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:17:05,681][root][INFO] - Processing question number 10
[2025-02-21 01:17:05,683][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:17:21,481][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:17:34,523][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:17:46,005][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:17:59,294][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:18:11,572][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:18:27,484][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:18:40,572][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:18:52,386][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:19:05,898][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:19:19,808][root][INFO] - Processing question number 20
[2025-02-21 01:19:19,810][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:19:30,361][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:19:43,651][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:19:54,648][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:20:07,031][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:20:19,368][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:20:34,393][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:20:46,691][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:21:00,151][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:21:12,747][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:21:26,034][root][INFO] - Processing question number 30
[2025-02-21 01:21:26,037][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:21:41,134][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:21:52,929][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:22:08,678][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:22:22,526][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:22:32,835][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:22:46,074][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:22:59,123][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:23:14,865][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:23:28,346][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:23:41,651][root][INFO] - Processing question number 40
[2025-02-21 01:23:41,654][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:23:55,920][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:24:07,292][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:24:22,224][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:24:34,593][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:24:48,073][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:25:00,124][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:25:14,593][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:25:26,179][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:25:40,561][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:25:54,263][root][INFO] - Processing question number 50
[2025-02-21 01:25:54,267][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:26:06,557][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:26:21,709][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:26:31,910][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:26:46,215][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:26:58,971][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:27:10,298][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:27:24,813][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:27:38,938][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:27:52,938][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:28:04,952][root][INFO] - Processing question number 60
[2025-02-21 01:28:04,956][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:28:17,666][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:28:29,031][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:28:42,486][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:28:53,736][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:29:05,177][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:29:16,355][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:29:27,146][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:29:41,368][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:29:53,945][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:30:07,898][root][INFO] - Processing question number 70
[2025-02-21 01:30:07,902][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:30:20,733][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:30:33,252][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:30:45,109][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:30:58,700][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:31:12,841][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:31:27,476][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:31:42,359][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:31:54,344][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:32:09,298][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:32:22,498][root][INFO] - Processing question number 80
[2025-02-21 01:32:22,503][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:32:35,670][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:32:52,758][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:33:05,906][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:33:18,923][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:33:34,116][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:33:49,492][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:34:02,243][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:34:13,701][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:34:27,700][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:34:40,032][root][INFO] - Processing question number 90
[2025-02-21 01:34:40,038][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:34:55,795][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:35:05,724][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:35:16,580][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:35:28,557][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:35:43,539][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:35:56,439][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:36:08,397][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:36:22,633][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:36:36,518][root][INFO] - Inference complete
[2025-02-21 01:36:36,518][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,525][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,539][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,546][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,546][root][INFO] - Saved parsed outputs
[2025-02-21 01:36:36,546][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,548][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,548][root][INFO] - Saved parsing metadata
[2025-02-21 01:36:36,548][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,550][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:36:36,552][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:36:36,569][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 01:36:36,570][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 0, 'malformed_domain': 18, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 10, 'both_wrong': 8}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 01:36:44,011][root][INFO] - Setting global seed to 989
[2025-02-21 01:36:44,018][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:36:44,018][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:36:44,019][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:36:44,021][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:36:44,023][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:36:44,023][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:36:44,176][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:36:44,698][root][INFO] - Full model selected, loading model
[2025-02-21 01:37:02,826][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:37:02,826][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:37:10,307][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:37:10,309][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:10,309][root][INFO] - Starting inference
[2025-02-21 01:37:10,504][root][INFO] - Processing question number 0
[2025-02-21 01:37:10,506][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:37:23,004][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:37:34,913][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:37:48,576][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:38:01,528][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:38:16,156][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:38:29,708][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:38:48,202][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:39:02,166][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:39:12,965][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:39:25,806][root][INFO] - Processing question number 10
[2025-02-21 01:39:25,808][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:39:41,093][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:39:54,142][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:40:06,114][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:40:21,551][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:40:33,412][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:40:47,383][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:40:59,197][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:41:11,353][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:41:23,536][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:41:33,359][root][INFO] - Processing question number 20
[2025-02-21 01:41:33,361][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:41:45,617][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:41:59,806][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:42:11,984][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:42:23,712][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:42:38,427][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:42:51,406][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:43:07,363][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:43:24,782][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:43:37,714][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:43:50,431][root][INFO] - Processing question number 30
[2025-02-21 01:43:50,433][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:44:10,451][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:44:23,906][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:44:39,383][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:44:53,118][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:45:04,359][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:45:17,987][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:45:31,679][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:45:45,813][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:46:01,673][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:46:15,785][root][INFO] - Processing question number 40
[2025-02-21 01:46:15,789][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:46:28,921][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:46:45,007][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:46:58,531][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:47:13,399][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:47:24,886][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:47:39,711][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:47:58,074][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:48:10,509][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:48:24,616][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:48:38,308][root][INFO] - Processing question number 50
[2025-02-21 01:48:38,311][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:48:53,379][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:49:09,125][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:49:20,606][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:49:35,309][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:49:47,946][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:50:00,856][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:50:15,709][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:50:31,233][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:50:45,472][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:50:57,990][root][INFO] - Processing question number 60
[2025-02-21 01:50:57,994][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:51:11,348][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:51:20,890][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:51:35,144][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:51:46,131][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:51:59,278][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:52:11,835][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:52:26,472][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:52:38,270][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:52:50,910][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:53:02,306][root][INFO] - Processing question number 70
[2025-02-21 01:53:02,311][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:53:16,349][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:53:34,355][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:53:46,540][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:54:02,497][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:54:16,596][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:54:29,232][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:54:43,772][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:55:00,327][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:55:18,026][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:55:32,181][root][INFO] - Processing question number 80
[2025-02-21 01:55:32,186][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:55:45,135][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:56:00,659][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:56:13,342][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:56:25,843][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:56:40,665][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:56:54,242][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:57:08,577][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:57:21,961][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:57:38,139][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:57:52,079][root][INFO] - Processing question number 90
[2025-02-21 01:57:52,084][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:58:09,698][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:58:21,891][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:58:36,338][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:58:51,884][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:59:06,701][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:59:21,352][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:59:33,798][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:59:46,753][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:00:01,230][root][INFO] - Inference complete
[2025-02-21 02:00:01,230][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,236][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,251][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,257][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,257][root][INFO] - Saved parsed outputs
[2025-02-21 02:00:01,257][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,259][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,259][root][INFO] - Saved parsing metadata
[2025-02-21 02:00:01,259][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,261][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:00:01,262][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:00:01,288][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 02:00:01,288][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 17, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 02:00:08,221][root][INFO] - Setting global seed to 989
[2025-02-21 02:00:08,227][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:00:08,228][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:00:08,229][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:00:08,231][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:00:08,233][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:00:08,234][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:00:08,385][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:00:09,009][root][INFO] - Full model selected, loading model
[2025-02-21 02:00:28,292][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:02:22,660][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:02:22,675][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:02:53,836][root][INFO] - Peft model loaded successfully
[2025-02-21 02:03:01,394][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:03:01,395][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:03:01,395][root][INFO] - Starting inference
[2025-02-21 02:03:01,592][root][INFO] - Processing question number 0
[2025-02-21 02:03:01,594][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:03:12,097][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:03:25,801][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:03:41,482][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:03:55,531][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:04:09,716][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:04:24,078][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:04:37,070][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:04:53,040][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:05:05,316][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:05:16,949][root][INFO] - Processing question number 10
[2025-02-21 02:05:16,950][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:05:36,144][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:05:49,754][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:06:03,285][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:06:17,518][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:06:29,497][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:06:42,344][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:06:55,302][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:07:08,041][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:07:20,346][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:07:34,535][root][INFO] - Processing question number 20
[2025-02-21 02:07:34,537][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:07:45,798][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:07:59,873][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:08:15,386][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:08:27,681][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:08:41,822][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:08:59,035][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:09:10,867][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:09:24,960][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:09:38,230][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:09:51,644][root][INFO] - Processing question number 30
[2025-02-21 02:09:51,647][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:10:06,411][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:10:17,785][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:10:34,720][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:10:48,488][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:10:59,594][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:11:12,016][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:11:23,593][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:11:38,073][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:11:50,494][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:12:03,806][root][INFO] - Processing question number 40
[2025-02-21 02:12:03,809][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:12:16,612][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:12:29,048][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:12:43,228][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:12:55,242][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:13:07,967][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:13:21,502][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:13:35,946][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:13:47,884][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:14:01,591][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:14:15,469][root][INFO] - Processing question number 50
[2025-02-21 02:14:15,473][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:14:29,645][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:14:45,184][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:14:56,126][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:15:09,141][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:15:22,164][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:15:35,050][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:15:49,070][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:16:03,466][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:16:15,220][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:16:27,390][root][INFO] - Processing question number 60
[2025-02-21 02:16:27,393][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:16:40,116][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:16:51,726][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:17:09,304][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:17:20,907][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:17:33,315][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:17:46,174][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:17:59,110][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:18:11,252][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:18:25,535][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:18:38,011][root][INFO] - Processing question number 70
[2025-02-21 02:18:38,015][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:18:52,237][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:19:04,609][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:19:17,542][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:19:35,937][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:19:50,978][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:20:04,514][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:20:18,965][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:20:30,351][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:20:45,065][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:20:59,464][root][INFO] - Processing question number 80
[2025-02-21 02:20:59,469][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:21:11,624][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:21:28,136][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:21:39,121][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:21:53,384][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:22:07,783][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:22:24,556][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:22:39,345][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:22:52,747][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:23:08,208][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:23:21,056][root][INFO] - Processing question number 90
[2025-02-21 02:23:21,062][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:23:37,002][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:23:48,557][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:23:59,637][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:24:11,691][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:24:25,810][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:24:41,470][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:24:53,779][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:25:06,042][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:25:18,546][root][INFO] - Inference complete
[2025-02-21 02:25:18,546][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,552][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,567][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,573][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,573][root][INFO] - Saved parsed outputs
[2025-02-21 02:25:18,573][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,574][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,574][root][INFO] - Saved parsing metadata
[2025-02-21 02:25:18,575][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,576][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:18,578][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:25:18,591][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 02:25:18,591][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 18, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 8, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 02:25:24,866][root][INFO] - Setting global seed to 989
[2025-02-21 02:25:24,871][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:25:24,872][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:25:24,873][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:25:24,875][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:25:24,877][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:25:24,877][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:25:25,022][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:25:25,545][root][INFO] - Full model selected, loading model
[2025-02-21 02:25:41,550][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:25:41,550][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:25:48,873][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:25:48,875][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:25:48,875][root][INFO] - Starting inference
[2025-02-21 02:25:49,047][root][INFO] - Processing question number 0
[2025-02-21 02:25:49,049][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:26:05,574][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:26:20,737][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:26:35,552][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:26:48,218][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:27:01,845][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:27:15,136][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:27:31,453][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:27:45,730][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:27:57,402][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:28:13,106][root][INFO] - Processing question number 10
[2025-02-21 02:28:13,108][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:28:28,924][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:28:43,305][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:28:53,924][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:29:08,883][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:29:20,860][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:29:34,054][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:29:46,842][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:30:00,657][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:30:13,729][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:30:26,995][root][INFO] - Processing question number 20
[2025-02-21 02:30:26,997][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:30:39,527][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:30:52,951][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:31:06,966][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:31:19,831][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:31:34,898][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:31:50,816][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:32:04,663][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:32:16,890][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:32:30,809][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:32:46,917][root][INFO] - Processing question number 30
[2025-02-21 02:32:46,920][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:33:04,765][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:33:18,760][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:33:33,080][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:33:47,310][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:33:59,482][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:34:11,695][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:34:25,011][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:34:39,488][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:34:55,712][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:35:09,756][root][INFO] - Processing question number 40
[2025-02-21 02:35:09,759][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:35:22,609][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:35:38,755][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:35:57,691][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:36:13,070][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:36:25,281][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:36:39,227][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:36:53,609][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:37:06,160][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:37:20,770][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:37:35,223][root][INFO] - Processing question number 50
[2025-02-21 02:37:35,227][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:37:51,018][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:38:06,609][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:38:17,252][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:38:31,781][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:38:46,647][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:38:58,533][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:39:11,878][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:39:26,812][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:39:39,158][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:39:52,548][root][INFO] - Processing question number 60
[2025-02-21 02:39:52,553][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:40:04,695][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:40:14,325][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:40:29,597][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:40:40,717][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:40:53,408][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:41:05,764][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:41:17,924][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:41:31,503][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:41:46,452][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:42:03,381][root][INFO] - Processing question number 70
[2025-02-21 02:42:03,385][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:42:17,142][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:42:30,806][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:42:43,896][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:43:01,460][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:43:14,387][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:43:27,412][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:43:46,034][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:43:59,047][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:44:13,043][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:44:28,004][root][INFO] - Processing question number 80
[2025-02-21 02:44:28,009][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:44:41,599][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:44:56,805][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:45:08,592][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:45:20,649][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:45:36,342][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:45:49,846][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:46:02,813][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:46:13,003][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:46:31,377][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:46:44,623][root][INFO] - Processing question number 90
[2025-02-21 02:46:44,628][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:47:00,887][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:47:14,553][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:47:27,291][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:47:40,860][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:47:55,298][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:48:10,341][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:48:21,275][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:48:36,255][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:48:49,838][root][INFO] - Inference complete
[2025-02-21 02:48:49,839][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:48:49,845][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:48:49,860][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,442][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,442][root][INFO] - Saved parsed outputs
[2025-02-21 02:49:18,442][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,444][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,444][root][INFO] - Saved parsing metadata
[2025-02-21 02:49:18,444][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,446][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:49:18,447][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:49:18,462][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 02:49:18,462][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 17, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 02:49:24,755][root][INFO] - Setting global seed to 989
[2025-02-21 02:49:24,760][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:49:24,760][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:49:24,761][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:49:24,765][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:49:24,767][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:49:24,767][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:49:24,920][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:49:25,445][root][INFO] - Full model selected, loading model
[2025-02-21 02:49:39,187][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:51:21,736][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:51:21,753][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:51:55,743][root][INFO] - Peft model loaded successfully
[2025-02-21 02:52:02,936][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:52:02,937][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:52:02,937][root][INFO] - Starting inference
[2025-02-21 02:52:03,147][root][INFO] - Processing question number 0
[2025-02-21 02:52:03,150][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:52:14,578][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:52:28,376][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:52:46,000][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:53:02,474][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:53:17,315][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:53:31,818][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:53:44,488][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:54:00,449][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:54:12,058][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:54:23,683][root][INFO] - Processing question number 10
[2025-02-21 02:54:23,685][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:54:40,723][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:54:51,949][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:55:04,545][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:55:18,658][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:55:31,551][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:55:43,426][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:55:56,118][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:56:08,388][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:56:21,091][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:56:33,734][root][INFO] - Processing question number 20
[2025-02-21 02:56:33,740][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:56:45,241][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:57:00,022][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:57:12,059][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:57:22,431][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:57:37,947][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:57:52,067][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:58:07,380][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:58:22,124][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:58:34,464][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:58:47,662][root][INFO] - Processing question number 30
[2025-02-21 02:58:47,665][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:59:03,754][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:59:17,177][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:59:31,410][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:59:45,575][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:59:56,868][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:00:10,103][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:00:25,978][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:00:44,138][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:00:58,861][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:01:12,370][root][INFO] - Processing question number 40
[2025-02-21 03:01:12,373][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:01:25,780][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:01:40,412][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:01:56,034][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:02:10,308][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:02:22,869][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:02:36,700][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:02:50,097][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:03:02,404][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:03:17,243][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:03:28,435][root][INFO] - Processing question number 50
[2025-02-21 03:03:28,439][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:03:41,037][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:03:58,483][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:04:10,226][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:04:24,696][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:04:38,631][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:04:49,948][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:05:05,622][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:05:18,330][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:05:29,253][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:05:50,215][root][INFO] - Processing question number 60
[2025-02-21 03:05:50,219][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:06:01,669][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:06:11,502][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:06:25,099][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:06:36,410][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:06:49,894][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:07:01,217][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:07:13,173][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:07:24,441][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:07:37,837][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:07:52,111][root][INFO] - Processing question number 70
[2025-02-21 03:07:52,115][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:08:06,131][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:08:19,925][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:08:33,956][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:08:48,380][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:09:03,541][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:09:17,777][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:09:32,244][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:09:45,792][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:10:00,950][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:10:14,910][root][INFO] - Processing question number 80
[2025-02-21 03:10:14,915][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:10:26,823][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:10:42,571][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:10:56,729][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:11:13,910][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:11:27,367][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:11:39,555][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:11:55,253][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:12:08,488][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:12:26,221][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:12:37,442][root][INFO] - Processing question number 90
[2025-02-21 03:12:37,448][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:12:53,475][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:13:05,821][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:13:18,170][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:13:32,327][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:13:45,869][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:14:01,721][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:14:14,120][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:14:28,884][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:14:42,664][root][INFO] - Inference complete
[2025-02-21 03:14:42,664][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,671][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,686][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,692][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,692][root][INFO] - Saved parsed outputs
[2025-02-21 03:14:42,692][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,693][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,693][root][INFO] - Saved parsing metadata
[2025-02-21 03:14:42,694][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,695][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:42,696][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:14:42,714][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 03:14:42,714][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 1, 'malformed_domain': 20, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 9, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 03:14:49,413][root][INFO] - Setting global seed to 989
[2025-02-21 03:14:49,421][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:14:49,421][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:14:49,422][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:14:49,424][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:14:49,426][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:14:49,426][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:14:49,590][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:14:50,123][root][INFO] - Full model selected, loading model
[2025-02-21 03:15:09,623][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:15:09,623][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:15:16,954][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:15:16,955][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:15:16,955][root][INFO] - Starting inference
[2025-02-21 03:15:17,132][root][INFO] - Processing question number 0
[2025-02-21 03:15:17,134][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:15:30,642][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:15:45,273][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:16:01,674][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:16:13,053][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:16:27,387][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:16:42,610][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:17:00,068][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:17:16,033][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:17:29,066][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:17:41,562][root][INFO] - Processing question number 10
[2025-02-21 03:17:41,564][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:17:55,724][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:18:12,088][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:18:22,343][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:18:38,860][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:18:50,571][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:19:04,165][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:19:20,512][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:19:34,063][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:19:46,716][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:19:58,644][root][INFO] - Processing question number 20
[2025-02-21 03:19:58,647][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:20:11,114][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:20:23,691][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:20:36,486][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:20:50,599][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:21:03,292][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:21:17,874][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:21:32,825][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:21:46,652][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:22:00,833][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:22:15,034][root][INFO] - Processing question number 30
[2025-02-21 03:22:15,037][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:22:37,076][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:22:51,639][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:23:07,106][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:23:21,736][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:23:32,422][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:23:45,354][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:23:58,864][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:24:13,903][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:24:27,085][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:24:40,129][root][INFO] - Processing question number 40
[2025-02-21 03:24:40,133][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:24:54,467][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:25:08,487][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:25:21,882][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:25:36,837][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:25:50,013][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:26:04,822][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:26:21,196][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:26:35,554][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:26:47,391][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:27:00,121][root][INFO] - Processing question number 50
[2025-02-21 03:27:00,125][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:27:14,391][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:27:33,466][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:27:46,974][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:27:59,193][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:28:12,664][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:28:24,697][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:28:38,541][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:28:52,720][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:29:09,861][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:29:24,580][root][INFO] - Processing question number 60
[2025-02-21 03:29:24,584][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:29:39,849][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:29:50,385][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:30:07,486][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:30:18,977][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:30:33,119][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:30:44,278][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:30:56,176][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:31:10,365][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:31:23,244][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:31:34,944][root][INFO] - Processing question number 70
[2025-02-21 03:31:34,949][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:31:47,833][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:32:01,215][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:32:13,672][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:32:29,761][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:32:45,729][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:32:59,786][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:33:16,584][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:33:31,912][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:33:47,824][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:34:00,367][root][INFO] - Processing question number 80
[2025-02-21 03:34:00,371][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:34:16,172][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:34:31,056][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:34:43,189][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:34:56,568][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:35:13,244][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:35:29,846][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:35:45,463][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:35:58,094][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:36:15,775][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:36:29,277][root][INFO] - Processing question number 90
[2025-02-21 03:36:29,282][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:36:46,139][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:36:58,545][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:37:09,835][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:37:25,464][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:37:40,961][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:37:52,239][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:38:04,486][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:38:19,690][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:38:35,096][root][INFO] - Inference complete
[2025-02-21 03:38:35,096][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,103][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,118][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,125][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,125][root][INFO] - Saved parsed outputs
[2025-02-21 03:38:35,125][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,126][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,126][root][INFO] - Saved parsing metadata
[2025-02-21 03:38:35,127][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,128][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:35,130][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:38:35,169][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 03:38:35,169][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 0, 'malformed_domain': 38, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 20, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 03:38:42,956][root][INFO] - Setting global seed to 206
[2025-02-21 03:38:42,964][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:38:42,964][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:38:42,965][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:38:42,967][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:38:42,970][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:38:42,971][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:38:43,122][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:38:43,762][root][INFO] - Full model selected, loading model
[2025-02-21 03:39:03,298][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:40:49,973][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:40:49,996][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:41:20,583][root][INFO] - Peft model loaded successfully
[2025-02-21 03:41:27,782][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:41:27,783][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 03:41:27,783][root][INFO] - Starting inference
[2025-02-21 03:41:27,978][root][INFO] - Processing question number 0
[2025-02-21 03:41:27,980][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:41:41,208][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:41:54,045][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:42:08,651][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:42:24,118][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:42:37,204][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:42:49,024][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:43:01,031][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:43:12,412][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:43:24,684][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:43:38,346][root][INFO] - Processing question number 10
[2025-02-21 03:43:38,348][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:43:50,267][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:44:03,397][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:44:16,246][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:44:26,266][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:44:39,409][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:44:54,387][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:45:04,606][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:45:20,388][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:45:33,229][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:45:48,722][root][INFO] - Processing question number 20
[2025-02-21 03:45:48,724][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:45:59,260][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:46:13,893][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:46:26,019][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:46:36,657][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:46:51,608][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:47:06,838][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:47:19,811][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:47:32,404][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:47:45,035][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:47:58,000][root][INFO] - Processing question number 30
[2025-02-21 03:47:58,003][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:48:09,896][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:48:22,262][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:48:36,376][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:48:50,180][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:49:01,039][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:49:15,927][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:49:28,449][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:49:41,479][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:49:52,952][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:50:09,751][root][INFO] - Processing question number 40
[2025-02-21 03:50:09,754][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:50:22,802][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:50:36,067][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:50:50,368][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:51:01,810][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:51:20,063][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:51:29,660][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:51:41,768][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:51:54,027][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:52:08,857][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:52:21,331][root][INFO] - Processing question number 50
[2025-02-21 03:52:21,335][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:52:34,012][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:52:46,896][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:53:00,289][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:53:15,081][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:53:30,012][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:53:43,386][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:53:58,454][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:54:11,934][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:54:24,619][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:54:39,257][root][INFO] - Processing question number 60
[2025-02-21 03:54:39,261][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:54:52,754][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:55:09,248][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:55:23,978][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:55:41,105][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:55:56,682][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:56:12,835][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:56:24,795][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:56:35,780][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:56:49,380][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:57:02,451][root][INFO] - Processing question number 70
[2025-02-21 03:57:02,456][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:57:16,784][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:57:29,544][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:57:41,663][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:57:56,325][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:58:06,020][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:58:19,865][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:58:33,449][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:58:47,328][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:59:00,350][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:59:13,316][root][INFO] - Processing question number 80
[2025-02-21 03:59:13,321][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:59:26,578][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:59:40,244][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:59:54,165][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:00:07,363][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:00:21,299][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:00:38,408][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:00:52,947][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:01:08,814][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:01:21,098][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:01:34,203][root][INFO] - Processing question number 90
[2025-02-21 04:01:34,208][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:01:48,238][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:02:03,013][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:02:15,157][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:02:27,470][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:02:40,772][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:02:54,927][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:03:09,408][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:03:20,609][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:03:32,548][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:03:49,207][root][INFO] - Inference complete
[2025-02-21 04:03:49,207][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,213][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,228][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,234][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,234][root][INFO] - Saved parsed outputs
[2025-02-21 04:03:49,234][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,236][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,236][root][INFO] - Saved parsing metadata
[2025-02-21 04:03:49,237][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,238][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:03:49,240][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:03:49,267][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 04:03:49,267][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.42, 'malformed_label': 0, 'malformed_domain': 21, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 14, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 04:03:56,320][root][INFO] - Setting global seed to 206
[2025-02-21 04:03:56,327][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:03:56,327][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:03:56,328][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:03:56,331][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:03:56,334][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:03:56,334][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:03:56,511][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:03:57,133][root][INFO] - Full model selected, loading model
[2025-02-21 04:04:17,338][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:04:17,339][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:04:24,673][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:04:24,675][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:04:24,675][root][INFO] - Starting inference
[2025-02-21 04:04:24,861][root][INFO] - Processing question number 0
[2025-02-21 04:04:24,863][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:04:44,019][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:04:58,560][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:05:14,655][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:05:28,263][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:05:38,835][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:05:50,155][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:06:03,910][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:06:16,697][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:06:35,532][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:06:49,331][root][INFO] - Processing question number 10
[2025-02-21 04:06:49,333][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:07:00,464][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:07:12,924][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:07:25,515][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:07:38,331][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:07:52,130][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:08:04,346][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:08:19,383][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:08:34,724][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:08:48,853][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:09:04,474][root][INFO] - Processing question number 20
[2025-02-21 04:09:04,477][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:09:14,471][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:09:27,867][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:09:41,409][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:09:51,397][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:10:04,758][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:10:18,131][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:10:32,211][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:10:43,933][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:10:56,554][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:11:10,026][root][INFO] - Processing question number 30
[2025-02-21 04:11:10,029][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:11:23,083][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:11:35,941][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:11:48,459][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:12:02,455][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:12:16,100][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:12:30,355][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:12:44,893][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:13:01,627][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:13:15,220][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:13:29,727][root][INFO] - Processing question number 40
[2025-02-21 04:13:29,730][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:13:44,037][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:13:56,180][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:14:10,764][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:14:24,042][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:14:42,826][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:14:53,732][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:15:05,032][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:15:16,422][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:15:30,402][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:15:43,030][root][INFO] - Processing question number 50
[2025-02-21 04:15:43,034][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:15:55,497][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:16:09,635][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:16:24,350][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:16:39,016][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:16:53,801][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:17:06,652][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:17:21,946][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:17:39,077][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:17:49,654][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:18:01,555][root][INFO] - Processing question number 60
[2025-02-21 04:18:01,560][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:18:15,364][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:18:29,865][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:18:45,718][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:18:58,713][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:19:13,199][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:19:25,905][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:19:38,246][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:19:49,319][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:20:03,817][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:20:16,274][root][INFO] - Processing question number 70
[2025-02-21 04:20:16,278][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:20:30,078][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:20:45,210][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:20:59,463][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:21:16,917][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:21:28,848][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:21:43,139][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:21:57,906][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:22:12,803][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:22:23,976][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:22:37,286][root][INFO] - Processing question number 80
[2025-02-21 04:22:37,291][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:22:50,942][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:23:04,598][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:23:19,553][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:23:33,481][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:23:48,814][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:24:07,235][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:24:21,586][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:24:37,071][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:24:49,171][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:25:02,404][root][INFO] - Processing question number 90
[2025-02-21 04:25:02,409][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:25:13,522][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:25:30,364][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:25:42,026][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:25:54,151][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:26:06,856][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:26:20,383][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:26:35,621][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:26:48,176][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:27:00,959][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:27:15,005][root][INFO] - Inference complete
[2025-02-21 04:27:15,006][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,012][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,027][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,042][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,042][root][INFO] - Saved parsed outputs
[2025-02-21 04:27:15,042][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,044][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,044][root][INFO] - Saved parsing metadata
[2025-02-21 04:27:15,044][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,046][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:27:15,047][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:27:15,055][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 04:27:15,055][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.29, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.04, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.14, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 20, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 04:27:21,429][root][INFO] - Setting global seed to 206
[2025-02-21 04:27:21,435][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:27:21,435][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:27:21,436][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:27:21,438][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:27:21,440][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:27:21,440][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:27:21,576][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:27:22,161][root][INFO] - Full model selected, loading model
[2025-02-21 04:27:41,129][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:29:20,269][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:29:20,298][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:29:48,848][root][INFO] - Peft model loaded successfully
[2025-02-21 04:29:56,020][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:29:56,022][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:29:56,022][root][INFO] - Starting inference
[2025-02-21 04:29:56,191][root][INFO] - Processing question number 0
[2025-02-21 04:29:56,193][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:30:12,026][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:30:25,810][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:30:41,583][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:30:58,963][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:31:11,768][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:31:21,892][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:31:34,380][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:31:46,135][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:31:57,831][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:32:10,284][root][INFO] - Processing question number 10
[2025-02-21 04:32:10,286][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:32:21,520][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:32:37,076][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:32:51,486][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:33:00,909][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:33:16,649][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:33:29,141][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:33:39,313][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:33:50,714][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:34:04,210][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:34:19,988][root][INFO] - Processing question number 20
[2025-02-21 04:34:19,991][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:34:31,133][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:34:42,148][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:34:53,640][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:35:03,578][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:35:16,625][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:35:30,873][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:35:44,020][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:35:56,118][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:36:06,725][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:36:23,551][root][INFO] - Processing question number 30
[2025-02-21 04:36:23,554][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:36:35,148][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:36:48,193][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:37:19,993][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:37:33,613][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:37:45,714][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:37:59,963][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:38:13,219][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:38:27,827][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:38:39,314][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:38:54,594][root][INFO] - Processing question number 40
[2025-02-21 04:38:54,597][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:39:09,616][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:39:22,341][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:39:35,839][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:39:47,085][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:40:02,183][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:40:12,283][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:40:24,461][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:40:38,884][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:40:53,694][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:41:07,673][root][INFO] - Processing question number 50
[2025-02-21 04:41:07,677][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:41:20,368][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:41:31,908][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:41:48,385][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:42:05,585][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:42:20,262][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:42:31,764][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:42:46,691][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:42:59,962][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:43:14,189][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:43:28,317][root][INFO] - Processing question number 60
[2025-02-21 04:43:28,321][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:43:41,544][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:43:56,819][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:44:14,244][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:44:29,894][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:44:43,080][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:44:56,727][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:45:07,982][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:45:20,936][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:45:35,839][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:45:49,287][root][INFO] - Processing question number 70
[2025-02-21 04:45:49,292][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:46:03,953][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:46:19,291][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:46:35,248][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:46:51,040][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:47:02,283][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:47:16,668][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:47:29,589][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:47:42,973][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:47:56,675][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:48:10,481][root][INFO] - Processing question number 80
[2025-02-21 04:48:10,488][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:48:23,963][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:48:35,890][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:48:52,707][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:49:05,459][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:49:19,509][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:49:37,407][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:49:52,126][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:50:06,773][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:50:19,317][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:50:33,057][root][INFO] - Processing question number 90
[2025-02-21 04:50:33,062][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:50:47,057][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:51:00,670][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:51:11,643][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:51:23,206][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:51:36,998][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:51:52,111][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:52:07,085][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:52:18,947][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:52:30,339][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:52:45,682][root][INFO] - Inference complete
[2025-02-21 04:52:45,682][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,689][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,703][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,709][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,709][root][INFO] - Saved parsed outputs
[2025-02-21 04:52:45,709][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,710][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,710][root][INFO] - Saved parsing metadata
[2025-02-21 04:52:45,711][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,712][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:45,719][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:52:45,748][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 04:52:45,748][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.43, 'malformed_label': 0, 'malformed_domain': 20, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.6428571428571429, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 15, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 04:52:52,759][root][INFO] - Setting global seed to 206
[2025-02-21 04:52:52,766][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:52:52,766][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:52:52,767][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:52:52,769][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:52:52,771][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:52:52,772][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:52:52,925][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:52:53,449][root][INFO] - Full model selected, loading model
[2025-02-21 04:53:12,324][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:53:12,325][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:53:19,844][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:53:19,846][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 04:53:19,846][root][INFO] - Starting inference
[2025-02-21 04:53:20,052][root][INFO] - Processing question number 0
[2025-02-21 04:53:20,086][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:53:35,135][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:53:49,384][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:54:06,309][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:54:19,010][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:54:31,046][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:54:45,400][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:54:58,336][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:55:09,158][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:55:21,754][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:55:36,455][root][INFO] - Processing question number 10
[2025-02-21 04:55:36,457][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:55:46,386][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:56:03,373][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:56:17,312][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:56:28,284][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:56:45,994][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:57:00,274][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:57:17,300][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:57:30,492][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:57:42,847][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:57:55,462][root][INFO] - Processing question number 20
[2025-02-21 04:57:55,465][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:58:06,103][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:58:19,776][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:58:31,561][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:58:42,450][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:58:56,033][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:59:09,736][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:59:25,228][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:59:39,213][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:59:52,155][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:00:05,288][root][INFO] - Processing question number 30
[2025-02-21 05:00:05,291][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:00:18,131][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:00:31,270][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:00:45,487][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:01:01,420][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:01:14,684][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:01:29,442][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:01:42,704][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:02:01,394][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:02:14,116][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:02:29,425][root][INFO] - Processing question number 40
[2025-02-21 05:02:29,428][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:02:44,286][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:02:56,168][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:03:13,629][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:03:26,378][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:03:45,547][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:03:57,579][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:04:09,951][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:04:25,240][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:04:43,244][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:04:55,978][root][INFO] - Processing question number 50
[2025-02-21 05:04:55,982][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:05:09,187][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:05:23,711][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:05:39,394][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:05:53,889][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:06:07,030][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:06:19,649][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:06:31,969][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:06:48,271][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:07:00,277][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:07:13,059][root][INFO] - Processing question number 60
[2025-02-21 05:07:13,063][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:07:28,076][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:07:42,924][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:07:59,338][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:08:15,555][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:08:30,332][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:08:44,028][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:08:56,034][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:09:07,367][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:09:22,469][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:09:34,889][root][INFO] - Processing question number 70
[2025-02-21 05:09:34,895][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:09:47,900][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:10:05,768][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:10:20,257][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:10:37,137][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:10:48,522][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:11:05,394][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:11:19,299][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:11:35,011][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:11:49,213][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:12:01,830][root][INFO] - Processing question number 80
[2025-02-21 05:12:01,835][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:12:14,785][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:12:26,088][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:12:39,978][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:12:53,235][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:13:09,057][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:13:25,651][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:13:37,670][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:13:51,264][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:14:04,826][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:14:18,910][root][INFO] - Processing question number 90
[2025-02-21 05:14:18,915][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:14:31,201][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:14:47,718][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:15:01,145][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:15:12,787][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:15:27,351][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:15:39,959][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:15:55,653][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:16:08,119][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:16:19,357][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:16:33,527][root][INFO] - Inference complete
[2025-02-21 05:16:33,527][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,534][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,556][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,563][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,563][root][INFO] - Saved parsed outputs
[2025-02-21 05:16:33,563][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,564][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,564][root][INFO] - Saved parsing metadata
[2025-02-21 05:16:33,565][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,566][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:16:33,579][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:16:33,598][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 05:16:33,598][root][INFO] - Summary of metrics : {'label_accuracy': 0.5, 'misclassification_rate': 0.5, 'combined_accuracy': 0.3, 'malformed_label': 0, 'malformed_domain': 41, 'total_predictions': 100, 'correct_predictions': 50, 'correct_label_and_domain': 30, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 20, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 05:16:42,004][root][INFO] - Setting global seed to 206
[2025-02-21 05:16:42,010][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:16:42,010][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:16:42,011][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:16:42,013][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:16:42,014][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:16:42,015][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:16:42,166][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:16:42,712][root][INFO] - Full model selected, loading model
[2025-02-21 05:17:01,979][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:18:43,429][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:18:43,447][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:19:14,738][root][INFO] - Peft model loaded successfully
[2025-02-21 05:19:22,177][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:19:22,178][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:19:22,178][root][INFO] - Starting inference
[2025-02-21 05:19:22,369][root][INFO] - Processing question number 0
[2025-02-21 05:19:22,378][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:19:35,923][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:19:48,970][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:20:04,184][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:20:20,837][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:20:35,357][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:20:46,483][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:20:59,528][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:21:12,248][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:21:22,934][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:21:35,130][root][INFO] - Processing question number 10
[2025-02-21 05:21:35,132][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:21:46,065][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:21:59,161][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:22:12,853][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:22:24,680][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:22:35,387][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:22:46,905][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:22:58,601][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:23:10,047][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:23:22,050][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:23:34,416][root][INFO] - Processing question number 20
[2025-02-21 05:23:34,419][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:23:44,959][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:23:56,328][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:24:08,012][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:24:19,919][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:24:33,012][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:24:47,021][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:25:00,120][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:25:12,168][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:25:24,094][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:25:39,247][root][INFO] - Processing question number 30
[2025-02-21 05:25:39,251][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:25:53,104][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:26:05,381][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:26:20,400][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:26:35,268][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:26:48,803][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:27:04,346][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:27:17,704][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:27:32,356][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:27:46,495][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:28:01,618][root][INFO] - Processing question number 40
[2025-02-21 05:28:01,621][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:28:16,104][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:28:29,430][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:28:45,496][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:28:55,709][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:29:12,527][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:29:23,144][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:29:36,065][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:29:50,268][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:30:04,782][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:30:17,365][root][INFO] - Processing question number 50
[2025-02-21 05:30:17,368][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:30:30,312][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:30:41,195][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:30:57,195][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:31:10,096][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:31:22,737][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:31:37,295][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:31:52,108][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:32:05,010][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:32:19,179][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:32:33,092][root][INFO] - Processing question number 60
[2025-02-21 05:32:33,096][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:32:45,751][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:33:02,553][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:33:19,182][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:33:34,978][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:33:48,621][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:34:02,162][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:34:14,926][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:34:25,251][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:34:37,285][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:34:48,041][root][INFO] - Processing question number 70
[2025-02-21 05:34:48,046][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:35:01,361][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:35:16,895][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:35:28,408][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:35:42,730][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:35:56,140][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:36:11,758][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:36:25,455][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:36:41,059][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:36:53,637][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:37:05,063][root][INFO] - Processing question number 80
[2025-02-21 05:37:05,068][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:37:16,654][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:37:29,846][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:37:43,403][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:37:57,122][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:38:10,022][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:38:25,382][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:38:40,189][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:38:57,122][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:39:09,426][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:39:24,130][root][INFO] - Processing question number 90
[2025-02-21 05:39:24,136][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:39:38,635][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:39:53,275][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:40:04,603][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:40:17,730][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:40:34,963][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:40:49,550][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:41:04,516][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:41:15,257][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:41:27,145][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:41:42,994][root][INFO] - Inference complete
[2025-02-21 05:41:42,995][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,002][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,016][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,033][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,033][root][INFO] - Saved parsed outputs
[2025-02-21 05:41:43,033][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,035][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,035][root][INFO] - Saved parsing metadata
[2025-02-21 05:41:43,036][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,037][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:41:43,039][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:41:43,067][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 05:41:43,067][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.1, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 16, 'both_wrong': 9}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 05:41:50,376][root][INFO] - Setting global seed to 206
[2025-02-21 05:41:50,383][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:41:50,383][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:41:50,384][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:41:50,385][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:41:50,388][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:41:50,388][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:41:50,551][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:41:51,064][root][INFO] - Full model selected, loading model
[2025-02-21 05:42:14,183][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:42:14,183][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:42:21,796][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:42:21,799][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:21,799][root][INFO] - Starting inference
[2025-02-21 05:42:21,949][root][INFO] - Processing question number 0
[2025-02-21 05:42:21,956][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:42:37,022][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:42:49,593][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:43:06,292][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:43:20,218][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:43:34,799][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:43:44,912][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:43:57,687][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:44:10,395][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:44:21,025][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:44:33,054][root][INFO] - Processing question number 10
[2025-02-21 05:44:33,056][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:44:45,382][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:45:00,306][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:45:15,006][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:45:29,756][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:45:46,515][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:45:58,223][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:46:15,447][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:46:30,671][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:46:45,910][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:47:00,505][root][INFO] - Processing question number 20
[2025-02-21 05:47:00,508][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:47:11,089][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:47:23,421][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:47:36,831][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:47:47,311][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:47:59,670][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:48:13,313][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:48:27,161][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:48:41,807][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:48:54,845][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:49:10,206][root][INFO] - Processing question number 30
[2025-02-21 05:49:10,209][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:49:22,763][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:49:38,146][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:49:51,446][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:50:07,385][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:50:19,825][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:50:37,095][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:50:53,308][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:51:06,698][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:51:19,033][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:51:36,588][root][INFO] - Processing question number 40
[2025-02-21 05:51:36,591][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:51:51,409][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:52:02,898][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:52:16,328][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:52:28,622][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:52:47,317][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:52:57,201][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:53:10,899][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:53:23,976][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:53:37,997][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:53:53,223][root][INFO] - Processing question number 50
[2025-02-21 05:53:53,227][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:54:06,732][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:54:20,743][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:54:35,071][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:54:50,436][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:55:04,288][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:55:19,248][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:55:33,634][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:55:50,558][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:56:01,898][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:56:14,930][root][INFO] - Processing question number 60
[2025-02-21 05:56:14,934][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:56:28,759][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:56:42,776][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:56:58,976][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:57:13,167][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:57:28,037][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:57:39,738][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:57:51,483][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:58:03,410][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:58:15,996][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:58:28,211][root][INFO] - Processing question number 70
[2025-02-21 05:58:28,216][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:58:42,452][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:58:59,123][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:59:13,868][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:59:28,808][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:59:40,489][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:59:56,314][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:00:11,311][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:00:29,263][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:00:40,938][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:00:54,013][root][INFO] - Processing question number 80
[2025-02-21 06:00:54,018][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:01:07,737][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:01:20,835][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:01:36,336][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:01:50,926][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:02:07,743][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:02:23,560][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:02:41,194][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:02:58,024][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:03:13,380][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:03:28,643][root][INFO] - Processing question number 90
[2025-02-21 06:03:28,648][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:03:40,828][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:03:54,996][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:04:06,311][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:04:18,050][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:04:32,921][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:04:48,020][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:05:05,215][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:05:18,952][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:05:30,993][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:05:46,776][root][INFO] - Inference complete
[2025-02-21 06:05:46,776][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,785][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,800][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,815][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,815][root][INFO] - Saved parsed outputs
[2025-02-21 06:05:46,815][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,825][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,825][root][INFO] - Saved parsing metadata
[2025-02-21 06:05:46,826][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,827][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:05:46,831][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:05:46,858][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 06:05:46,858][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.27, 'malformed_label': 0, 'malformed_domain': 49, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 24, 'correct_label_wrong_domain': 26, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 06:05:54,582][root][INFO] - Setting global seed to 989
[2025-02-21 06:05:54,590][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:05:54,590][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:05:54,592][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:05:54,593][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:05:54,596][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:05:54,596][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:05:54,745][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:05:55,326][root][INFO] - Full model selected, loading model
[2025-02-21 06:06:13,733][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:07:54,192][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:07:54,241][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:08:26,148][root][INFO] - Peft model loaded successfully
[2025-02-21 06:08:33,319][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:08:33,321][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:33,321][root][INFO] - Starting inference
[2025-02-21 06:08:33,534][root][INFO] - Processing question number 0
[2025-02-21 06:08:33,537][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:08:46,533][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:08:59,308][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:09:13,835][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:09:29,230][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:09:42,250][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:09:54,013][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:10:05,965][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:10:17,294][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:10:29,514][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:10:43,111][root][INFO] - Processing question number 10
[2025-02-21 06:10:43,113][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:10:54,986][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:11:08,059][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:11:20,860][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:11:30,836][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:11:43,923][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:11:58,830][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:12:09,001][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:12:24,694][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:12:37,393][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:12:52,807][root][INFO] - Processing question number 20
[2025-02-21 06:12:52,810][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:13:03,295][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:13:17,856][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:13:29,927][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:13:40,514][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:13:55,390][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:14:10,547][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:14:23,458][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:14:35,986][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:14:48,548][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:15:01,444][root][INFO] - Processing question number 30
[2025-02-21 06:15:01,447][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:15:13,278][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:15:25,582][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:15:39,566][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:15:53,252][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:16:04,066][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:16:18,970][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:16:31,519][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:16:44,569][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:16:56,075][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:17:12,909][root][INFO] - Processing question number 40
[2025-02-21 06:17:12,913][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:17:25,937][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:17:39,231][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:17:53,572][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:18:05,024][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:18:23,263][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:18:32,890][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:18:45,043][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:18:57,286][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:19:12,050][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:19:24,464][root][INFO] - Processing question number 50
[2025-02-21 06:19:24,468][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:19:37,079][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:19:49,901][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:20:03,234][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:20:17,966][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:20:32,813][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:20:46,066][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:21:01,041][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:21:14,430][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:21:27,039][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:21:41,585][root][INFO] - Processing question number 60
[2025-02-21 06:21:41,589][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:21:54,991][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:22:11,376][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:22:26,030][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:22:43,024][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:22:58,480][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:23:14,531][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:23:26,477][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:23:37,449][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:23:51,031][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:24:04,087][root][INFO] - Processing question number 70
[2025-02-21 06:24:04,092][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:24:18,405][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:24:31,255][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:24:43,455][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:24:58,200][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:25:07,896][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:25:21,841][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:25:35,445][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:25:49,400][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:26:02,526][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:26:15,518][root][INFO] - Processing question number 80
[2025-02-21 06:26:15,523][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:26:28,765][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:26:42,413][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:26:56,316][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:27:09,495][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:27:23,406][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:27:40,494][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:27:55,011][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:28:10,850][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:28:23,114][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:28:36,196][root][INFO] - Processing question number 90
[2025-02-21 06:28:36,203][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:28:50,206][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:29:04,964][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:29:17,091][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:29:29,384][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:29:42,668][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:29:56,803][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:30:11,263][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:30:22,448][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:30:34,365][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:30:50,989][root][INFO] - Inference complete
[2025-02-21 06:30:50,989][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:50,996][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,010][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,016][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,017][root][INFO] - Saved parsed outputs
[2025-02-21 06:30:51,017][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,018][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,018][root][INFO] - Saved parsing metadata
[2025-02-21 06:30:51,019][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,020][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:30:51,022][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:30:51,048][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 06:30:51,048][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.42, 'malformed_label': 0, 'malformed_domain': 21, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.11, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 14, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 06:30:57,821][root][INFO] - Setting global seed to 989
[2025-02-21 06:30:57,828][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:30:57,828][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:30:57,829][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:30:57,830][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:30:57,833][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:30:57,833][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:30:57,990][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:30:58,637][root][INFO] - Full model selected, loading model
[2025-02-21 06:31:19,000][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:31:19,000][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:31:26,427][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:31:26,429][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:31:26,429][root][INFO] - Starting inference
[2025-02-21 06:31:26,627][root][INFO] - Processing question number 0
[2025-02-21 06:31:26,631][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:31:45,862][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:32:00,383][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:32:16,464][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:32:30,058][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:32:40,621][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:32:51,934][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:33:05,684][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:33:18,422][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:33:37,163][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:33:50,960][root][INFO] - Processing question number 10
[2025-02-21 06:33:50,963][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:34:02,082][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:34:14,537][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:34:27,122][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:34:39,932][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:34:53,720][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:35:05,928][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:35:20,950][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:35:36,277][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:35:50,395][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:36:06,009][root][INFO] - Processing question number 20
[2025-02-21 06:36:06,012][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:36:16,001][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:36:29,386][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:36:42,921][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:36:52,905][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:37:06,260][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:37:19,644][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:37:33,822][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:37:45,580][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:37:58,196][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:38:11,668][root][INFO] - Processing question number 30
[2025-02-21 06:38:11,672][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:38:24,717][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:38:37,573][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:38:50,092][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:39:04,087][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:39:17,734][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:39:31,986][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:39:46,523][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:40:03,254][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:40:16,845][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:40:31,351][root][INFO] - Processing question number 40
[2025-02-21 06:40:31,354][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:40:45,660][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:40:57,801][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:41:12,388][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:41:25,665][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:41:44,447][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:41:55,353][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:42:06,653][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:42:18,035][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:42:31,977][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:42:44,587][root][INFO] - Processing question number 50
[2025-02-21 06:42:44,594][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:42:57,061][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:43:11,191][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:43:25,899][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:43:40,557][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:43:55,338][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:44:08,186][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:44:23,473][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:44:40,597][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:44:51,171][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:45:03,066][root][INFO] - Processing question number 60
[2025-02-21 06:45:03,070][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:45:16,869][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:45:31,366][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:45:47,210][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:46:00,197][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:46:14,676][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:46:27,372][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:46:39,709][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:46:50,782][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:47:05,275][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:47:17,728][root][INFO] - Processing question number 70
[2025-02-21 06:47:17,745][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:47:31,537][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:47:46,666][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:48:00,916][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:48:18,470][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:48:30,393][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:48:44,679][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:48:59,441][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:49:14,330][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:49:25,496][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:49:38,800][root][INFO] - Processing question number 80
[2025-02-21 06:49:38,804][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:49:52,445][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:50:06,089][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:50:21,028][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:50:34,870][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:50:50,075][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:51:08,346][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:51:22,605][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:51:38,036][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:51:50,045][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:52:03,178][root][INFO] - Processing question number 90
[2025-02-21 06:52:03,184][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:52:14,233][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:52:31,005][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:52:42,571][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:52:54,604][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:53:07,275][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:53:20,792][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:53:36,017][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:53:48,563][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:54:01,337][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:54:15,369][root][INFO] - Inference complete
[2025-02-21 06:54:15,370][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,376][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,391][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,400][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,400][root][INFO] - Saved parsed outputs
[2025-02-21 06:54:15,400][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,402][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,402][root][INFO] - Saved parsing metadata
[2025-02-21 06:54:15,402][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,404][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:54:15,405][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:54:15,431][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 06:54:15,431][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.29, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.04, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.14, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 20, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 06:54:22,311][root][INFO] - Setting global seed to 989
[2025-02-21 06:54:22,318][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:54:22,318][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:54:22,319][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:54:22,320][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:54:22,323][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:54:22,323][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:54:22,484][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:54:23,052][root][INFO] - Full model selected, loading model
[2025-02-21 06:54:41,822][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:56:25,521][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:56:25,540][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:56:59,750][root][INFO] - Peft model loaded successfully
[2025-02-21 06:57:07,284][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:57:07,286][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 06:57:07,286][root][INFO] - Starting inference
[2025-02-21 06:57:07,516][root][INFO] - Processing question number 0
[2025-02-21 06:57:07,519][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:57:23,867][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:57:36,553][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:57:52,806][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:58:09,025][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:58:22,378][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:58:33,244][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:58:45,353][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:58:57,558][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:59:10,348][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:59:22,948][root][INFO] - Processing question number 10
[2025-02-21 06:59:22,950][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:59:35,576][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:59:52,097][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:00:05,925][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:00:15,534][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:00:30,422][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:00:44,329][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:00:55,039][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:01:09,939][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:01:23,463][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:01:36,939][root][INFO] - Processing question number 20
[2025-02-21 07:01:36,942][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:01:47,467][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:01:59,074][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:02:10,140][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:02:20,113][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:02:32,611][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:02:45,121][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:02:57,535][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:03:09,101][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:03:20,704][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:03:34,691][root][INFO] - Processing question number 30
[2025-02-21 07:03:34,693][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:03:46,220][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:03:59,191][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:04:12,487][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:04:26,760][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:04:38,437][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:04:53,535][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:05:06,360][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:05:19,849][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:05:31,721][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:05:46,566][root][INFO] - Processing question number 40
[2025-02-21 07:05:46,569][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:06:01,570][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:06:13,107][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:06:27,925][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:06:39,909][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:06:56,191][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:07:05,672][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:07:17,065][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:07:29,313][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:07:42,206][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:07:56,471][root][INFO] - Processing question number 50
[2025-02-21 07:07:56,475][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:08:09,771][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:08:22,961][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:08:36,505][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:08:50,223][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:09:05,035][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:09:17,076][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:09:31,145][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:09:47,178][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:10:00,564][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:10:13,336][root][INFO] - Processing question number 60
[2025-02-21 07:10:13,340][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:10:26,447][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:10:43,337][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:11:02,686][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:11:17,170][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:11:31,989][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:11:47,370][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:11:58,160][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:12:09,538][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:12:22,830][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:12:34,890][root][INFO] - Processing question number 70
[2025-02-21 07:12:34,895][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:12:49,324][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:13:04,902][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:13:20,008][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:13:35,386][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:13:46,270][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:13:59,966][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:14:12,870][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:14:27,467][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:14:38,476][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:14:50,518][root][INFO] - Processing question number 80
[2025-02-21 07:14:50,523][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:15:03,048][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:15:18,371][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:15:32,351][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:15:46,570][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:16:03,080][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:16:19,084][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:16:35,074][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:16:49,953][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:17:01,657][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:17:13,779][root][INFO] - Processing question number 90
[2025-02-21 07:17:13,784][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:17:28,327][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:17:41,412][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:17:53,463][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:18:05,892][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:18:20,626][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:18:34,341][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:18:49,525][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:19:00,727][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:19:13,493][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:19:28,217][root][INFO] - Inference complete
[2025-02-21 07:19:28,217][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,223][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,237][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,261][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,261][root][INFO] - Saved parsed outputs
[2025-02-21 07:19:28,261][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,263][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,263][root][INFO] - Saved parsing metadata
[2025-02-21 07:19:28,263][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,265][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:19:28,266][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:19:28,291][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 07:19:28,291][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.39, 'malformed_label': 0, 'malformed_domain': 22, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.12, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 16, 'both_wrong': 6}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 07:19:35,203][root][INFO] - Setting global seed to 989
[2025-02-21 07:19:35,209][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:19:35,210][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:19:35,211][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:19:35,212][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:19:35,215][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:19:35,215][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:19:35,383][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:19:35,944][root][INFO] - Full model selected, loading model
[2025-02-21 07:19:54,779][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:19:54,779][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:20:02,238][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:20:02,240][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:20:02,240][root][INFO] - Starting inference
[2025-02-21 07:20:02,417][root][INFO] - Processing question number 0
[2025-02-21 07:20:02,419][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:20:18,916][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:20:31,705][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:20:47,516][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:21:01,336][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:21:13,052][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:21:24,215][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:21:36,272][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:21:48,053][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:22:00,791][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:22:12,660][root][INFO] - Processing question number 10
[2025-02-21 07:22:12,662][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:22:24,081][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:22:41,259][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:22:54,929][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:23:08,099][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:23:23,088][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:23:34,944][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:23:46,362][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:24:00,199][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:24:14,546][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:24:29,255][root][INFO] - Processing question number 20
[2025-02-21 07:24:29,258][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:24:39,733][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:24:52,670][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:25:06,019][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:25:17,960][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:25:32,094][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:25:46,915][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:26:02,701][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:26:15,749][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:26:28,060][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:26:41,846][root][INFO] - Processing question number 30
[2025-02-21 07:26:41,848][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:26:54,343][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:27:09,566][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:27:22,088][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:27:37,342][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:27:50,287][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:28:05,433][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:28:20,351][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:28:35,970][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:28:48,399][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:29:04,065][root][INFO] - Processing question number 40
[2025-02-21 07:29:04,068][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:29:20,501][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:29:32,186][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:29:46,278][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:29:58,212][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:30:17,412][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:30:29,331][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:30:42,254][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:30:55,887][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:31:08,875][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:31:22,421][root][INFO] - Processing question number 50
[2025-02-21 07:31:22,424][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:31:36,756][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:31:50,503][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:32:02,660][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:32:16,319][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:32:30,875][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:32:44,006][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:32:59,676][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:33:16,843][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:33:27,730][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:33:41,202][root][INFO] - Processing question number 60
[2025-02-21 07:33:41,206][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:33:57,010][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:34:12,044][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:34:27,341][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:34:44,047][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:35:00,675][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:35:14,555][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:35:26,123][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:35:37,395][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:35:51,303][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:36:05,180][root][INFO] - Processing question number 70
[2025-02-21 07:36:05,184][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:36:19,350][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:36:34,962][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:36:53,755][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:37:12,452][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:37:24,881][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:37:39,081][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:37:55,853][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:38:11,542][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:38:24,464][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:38:38,034][root][INFO] - Processing question number 80
[2025-02-21 07:38:38,039][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:38:50,563][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:39:02,576][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:39:19,617][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:39:32,755][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:39:48,665][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:40:05,135][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:40:19,094][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:40:33,715][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:40:49,469][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:41:02,306][root][INFO] - Processing question number 90
[2025-02-21 07:41:02,311][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:41:14,377][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:41:31,540][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:41:42,980][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:41:55,944][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:42:11,176][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:42:24,912][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:42:38,828][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:42:51,281][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:43:04,418][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:43:19,766][root][INFO] - Inference complete
[2025-02-21 07:43:19,766][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,773][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,788][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,794][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,794][root][INFO] - Saved parsed outputs
[2025-02-21 07:43:19,794][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,795][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,796][root][INFO] - Saved parsing metadata
[2025-02-21 07:43:19,796][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,798][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:43:19,815][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:43:19,842][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 07:43:19,842][root][INFO] - Summary of metrics : {'label_accuracy': 0.5, 'misclassification_rate': 0.5, 'combined_accuracy': 0.32, 'malformed_label': 0, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 50, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 18, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 07:43:26,677][root][INFO] - Setting global seed to 989
[2025-02-21 07:43:26,683][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:43:26,684][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:43:26,685][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:43:26,686][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:43:26,689][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:43:26,689][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:43:26,836][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:43:27,397][root][INFO] - Full model selected, loading model
[2025-02-21 07:43:46,806][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:45:27,566][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:45:27,612][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:45:58,769][root][INFO] - Peft model loaded successfully
[2025-02-21 07:46:05,909][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:46:05,911][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 07:46:05,911][root][INFO] - Starting inference
[2025-02-21 07:46:06,111][root][INFO] - Processing question number 0
[2025-02-21 07:46:06,113][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:46:19,368][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:46:34,778][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:46:49,395][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:47:04,889][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:47:17,787][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:47:28,206][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:47:41,397][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:47:51,146][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:48:02,630][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:48:17,072][root][INFO] - Processing question number 10
[2025-02-21 07:48:17,074][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:48:27,255][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:48:44,291][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:48:57,461][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:49:10,295][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:49:25,460][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:49:38,609][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:49:50,050][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:50:03,122][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:50:14,502][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:50:26,402][root][INFO] - Processing question number 20
[2025-02-21 07:50:26,405][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:50:36,892][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:50:49,080][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:51:00,614][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:51:13,846][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:51:25,752][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:51:41,166][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:51:53,644][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:52:06,299][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:52:20,110][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:52:36,455][root][INFO] - Processing question number 30
[2025-02-21 07:52:36,458][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:52:48,814][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:53:00,524][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:53:14,753][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:53:27,860][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:53:40,769][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:53:57,473][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:54:10,976][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:54:23,137][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:54:34,254][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:54:48,000][root][INFO] - Processing question number 40
[2025-02-21 07:54:48,004][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:55:00,644][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:55:13,744][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:55:27,756][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:55:40,062][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:55:56,887][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:56:06,483][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:56:19,273][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:56:35,192][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:56:48,005][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:57:02,238][root][INFO] - Processing question number 50
[2025-02-21 07:57:02,241][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:57:15,660][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:57:32,130][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:57:45,381][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:57:59,010][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:58:12,518][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:58:26,109][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:58:41,295][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:58:56,625][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:59:10,492][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:59:24,775][root][INFO] - Processing question number 60
[2025-02-21 07:59:24,779][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:59:38,006][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:59:53,633][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:00:07,652][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:00:20,984][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:00:34,434][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:00:51,578][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:01:04,554][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:01:18,268][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:01:34,711][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:01:46,992][root][INFO] - Processing question number 70
[2025-02-21 08:01:46,997][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:01:58,787][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:02:14,382][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:02:28,778][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:02:44,153][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:02:54,139][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:03:08,886][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:03:22,226][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:03:36,075][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:03:49,173][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:04:01,292][root][INFO] - Processing question number 80
[2025-02-21 08:04:01,297][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:04:16,903][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:04:30,401][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:04:44,904][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:04:57,816][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:05:12,184][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:05:27,501][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:05:41,807][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:05:59,500][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:06:12,892][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:06:26,396][root][INFO] - Processing question number 90
[2025-02-21 08:06:26,401][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:06:39,272][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:06:57,168][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:07:08,139][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:07:19,431][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:07:34,265][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:07:46,573][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:08:03,162][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:08:16,914][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:08:28,610][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:08:43,534][root][INFO] - Inference complete
[2025-02-21 08:08:43,534][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,541][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,556][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,562][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,562][root][INFO] - Saved parsed outputs
[2025-02-21 08:08:43,562][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,563][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,563][root][INFO] - Saved parsing metadata
[2025-02-21 08:08:43,564][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,566][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:08:43,567][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:08:43,585][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 08:08:43,585][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.44, 'malformed_label': 0, 'malformed_domain': 20, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 44, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.15, 'Criminal_Law_confidence': 0.13, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 13, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-02-21 08:08:50,417][root][INFO] - Setting global seed to 989
[2025-02-21 08:08:50,424][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 08:08:50,424][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 08:08:50,426][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:08:50,427][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:08:50,429][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:08:50,429][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:08:50,579][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:08:51,123][root][INFO] - Full model selected, loading model
[2025-02-21 08:09:07,899][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:09:07,900][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:09:15,224][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:09:15,226][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:09:15,226][root][INFO] - Starting inference
[2025-02-21 08:09:15,428][root][INFO] - Processing question number 0
[2025-02-21 08:09:15,430][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:09:32,248][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:09:44,045][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:10:02,429][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:10:19,164][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:10:33,227][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:10:46,405][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:10:58,465][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:11:10,401][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:11:23,290][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:11:38,642][root][INFO] - Processing question number 10
[2025-02-21 08:11:38,644][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:11:50,332][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:12:03,963][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:12:20,510][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:12:31,702][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:12:49,480][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:13:03,909][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:13:17,934][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:13:32,118][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:13:45,512][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:14:00,158][root][INFO] - Processing question number 20
[2025-02-21 08:14:00,160][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:14:10,719][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:14:22,394][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:14:35,285][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:14:48,708][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:14:59,944][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:15:15,391][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:15:33,238][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:15:44,600][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:16:00,754][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:16:16,681][root][INFO] - Processing question number 30
[2025-02-21 08:16:16,683][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:16:31,587][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:16:43,386][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:16:57,857][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:17:11,768][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:17:25,685][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:17:40,782][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:17:55,755][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:18:09,812][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:18:22,192][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:18:39,005][root][INFO] - Processing question number 40
[2025-02-21 08:18:39,009][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:18:54,058][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:19:04,350][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:19:21,446][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:19:34,477][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:19:51,370][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:20:02,131][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:20:14,226][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:20:28,059][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:20:43,253][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:20:55,049][root][INFO] - Processing question number 50
[2025-02-21 08:20:55,053][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:21:10,208][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:21:26,096][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:21:40,936][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:21:55,157][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:22:11,702][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:22:22,931][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:22:34,834][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:22:52,369][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:23:04,464][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:23:15,647][root][INFO] - Processing question number 60
[2025-02-21 08:23:15,651][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:23:28,699][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:23:42,863][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:23:57,065][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:24:12,172][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:24:27,447][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:24:42,047][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:24:54,689][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:25:06,106][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:25:19,804][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:25:32,308][root][INFO] - Processing question number 70
[2025-02-21 08:25:32,312][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:25:44,941][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:26:02,942][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:26:20,536][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:26:39,560][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:26:51,434][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:27:06,724][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:27:24,614][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:27:39,217][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:27:50,632][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:28:03,951][root][INFO] - Processing question number 80
[2025-02-21 08:28:03,956][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:28:18,699][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:28:31,846][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:28:46,919][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:28:59,445][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:29:13,942][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:29:29,288][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:29:43,038][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:29:57,920][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:30:11,773][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:30:28,466][root][INFO] - Processing question number 90
[2025-02-21 08:30:28,471][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:30:39,360][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:30:50,983][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:31:03,023][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:31:13,905][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:31:29,879][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:31:42,796][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:31:58,061][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:32:09,450][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:32:21,891][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:32:38,930][root][INFO] - Inference complete
[2025-02-21 08:32:38,931][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,938][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,953][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,959][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,959][root][INFO] - Saved parsed outputs
[2025-02-21 08:32:38,959][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,971][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,971][root][INFO] - Saved parsing metadata
[2025-02-21 08:32:38,971][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,973][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 08:32:38,974][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:32:38,990][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 08:32:38,990][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 51, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.07, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 21, 'both_wrong': 30}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Job 2 completed at Fri Feb 21 08:32:40 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n518
Job ID: 25309337
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 09:50:17
CPU Efficiency: 9.90% of 4-03:25:10 core-walltime
Job Wall-clock time: 09:56:31
Memory Utilized: 35.65 GB
Memory Efficiency: 99.04% of 36.00 GB
