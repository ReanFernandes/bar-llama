Starting job 2 at Thu Mar  6 08:00:06 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_answer_first_few_shot_structured train=json_answer_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '2', 'training']
Updating job 2 to status training with exit code None
Status update completed for job 2
[2025-03-06 08:02:34,276][root][INFO] - Global seed set to 314
[2025-03-06 08:02:34,277][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 08:02:34,278][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 08:02:34,278][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 08:02:34,278][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:02:34,278][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 08:02:34,347][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:02:34,719][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 08:02:34,773][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 08:02:34,878][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 08:02:36,404][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 08:03:16,311][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 08:03:49,524][root][INFO] - Model prepared for kbit training
[2025-03-06 08:03:49,525][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'up_proj', 'v_proj', 'k_proj', 'gate_proj', 'down_proj', 'q_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 08:03:51,301][root][INFO] - Lora adapter added to model
[2025-03-06 08:03:51,305][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_few_shot_structured
[2025-03-06 08:03:51,555][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6065, 'grad_norm': 0.3812360465526581, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.2985, 'grad_norm': 0.33990541100502014, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.0932, 'grad_norm': 0.3559890687465668, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 0.9345, 'grad_norm': 0.35623493790626526, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.6869, 'grad_norm': 0.3575838506221771, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 430.3967, 'train_samples_per_second': 0.244, 'train_steps_per_second': 0.035, 'train_loss': 1.1239495277404785, 'epoch': 15.0}
[2025-03-06 08:11:09,815][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '2', 'trained', '0']
Updating job 2 to status trained with exit code 0
Status update completed for job 2
Starting evaluations for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 08:11:20,405][root][INFO] - Setting global seed to 206
[2025-03-06 08:11:20,412][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 08:11:20,412][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:11:20,414][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 08:11:20,415][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:11:20,420][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 08:11:20,421][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 08:11:20,572][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 08:11:21,198][root][INFO] - Full model selected, loading model
[2025-03-06 08:11:47,961][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 08:13:48,459][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 08:13:48,460][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 08:14:22,516][root][INFO] - Peft model loaded successfully
[2025-03-06 08:14:30,453][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 08:14:30,457][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:14:30,457][root][INFO] - Starting inference
[2025-03-06 08:14:30,642][root][INFO] - Processing question number 0
[2025-03-06 08:14:30,644][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 08:14:43,233][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 08:14:57,050][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 08:15:14,973][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 08:15:31,341][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 08:15:47,833][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 08:16:00,972][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 08:16:16,326][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 08:16:34,531][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 08:16:48,506][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 08:17:06,583][root][INFO] - Processing question number 10
[2025-03-06 08:17:06,585][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 08:17:21,337][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 08:17:36,577][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 08:17:51,079][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 08:18:05,493][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 08:18:18,141][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 08:18:32,323][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 08:18:47,460][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 08:19:04,009][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 08:19:17,700][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 08:19:29,352][root][INFO] - Processing question number 20
[2025-03-06 08:19:29,354][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 08:19:41,576][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 08:19:55,257][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 08:20:08,083][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 08:20:21,813][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 08:20:36,115][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 08:20:48,508][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 08:21:02,584][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 08:21:17,386][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 08:21:31,036][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 08:21:44,456][root][INFO] - Processing question number 30
[2025-03-06 08:21:44,459][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 08:22:00,788][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 08:22:15,871][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 08:22:32,534][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 08:22:46,343][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 08:22:58,726][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 08:23:14,176][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 08:23:27,853][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 08:23:44,768][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 08:23:59,575][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 08:24:12,945][root][INFO] - Processing question number 40
[2025-03-06 08:24:12,949][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 08:24:27,285][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 08:24:43,035][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 08:25:00,678][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 08:25:14,520][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 08:25:27,143][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 08:25:42,554][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 08:25:57,132][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 08:26:10,281][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 08:26:26,283][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 08:26:40,461][root][INFO] - Processing question number 50
[2025-03-06 08:26:40,465][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 08:26:56,133][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 08:27:11,756][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 08:27:25,258][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 08:27:41,123][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 08:27:55,562][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 08:28:07,163][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 08:28:22,104][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 08:28:33,849][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 08:28:47,291][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 08:28:59,704][root][INFO] - Processing question number 60
[2025-03-06 08:28:59,708][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 08:29:13,372][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 08:29:27,066][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 08:29:44,729][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 08:29:55,607][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 08:30:09,726][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 08:30:23,015][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 08:30:35,518][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 08:30:48,165][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 08:31:02,054][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 08:31:16,031][root][INFO] - Processing question number 70
[2025-03-06 08:31:16,036][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 08:31:29,481][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 08:31:44,358][root][INFO] - Domain : Property, Question : 6
[2025-03-06 08:31:57,539][root][INFO] - Domain : Property, Question : 13
[2025-03-06 08:32:14,355][root][INFO] - Domain : Property, Question : 20
[2025-03-06 08:32:29,384][root][INFO] - Domain : Property, Question : 33
[2025-03-06 08:32:42,180][root][INFO] - Domain : Property, Question : 39
[2025-03-06 08:32:58,893][root][INFO] - Domain : Property, Question : 48
[2025-03-06 08:33:11,445][root][INFO] - Domain : Property, Question : 54
[2025-03-06 08:33:26,827][root][INFO] - Domain : Property, Question : 61
[2025-03-06 08:33:41,062][root][INFO] - Processing question number 80
[2025-03-06 08:33:41,067][root][INFO] - Domain : Property, Question : 67
[2025-03-06 08:33:51,792][root][INFO] - Domain : Property, Question : 75
[2025-03-06 08:34:07,554][root][INFO] - Domain : Property, Question : 83
[2025-03-06 08:34:20,554][root][INFO] - Domain : Property, Question : 89
[2025-03-06 08:34:34,247][root][INFO] - Domain : Property, Question : 97
[2025-03-06 08:34:47,595][root][INFO] - Domain : Property, Question : 100
[2025-03-06 08:35:04,440][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 08:35:19,565][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 08:35:33,465][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 08:35:49,463][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 08:36:03,750][root][INFO] - Processing question number 90
[2025-03-06 08:36:03,757][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 08:36:20,000][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 08:36:35,985][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 08:36:49,154][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 08:37:03,403][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 08:37:19,732][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 08:37:36,163][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 08:37:48,678][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 08:38:03,629][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 08:38:20,734][root][INFO] - Inference complete
[2025-03-06 08:38:20,735][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,748][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,762][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,768][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,768][root][INFO] - Saved parsed outputs
[2025-03-06 08:38:20,768][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,770][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,770][root][INFO] - Saved parsing metadata
[2025-03-06 08:38:20,773][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,789][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:38:20,791][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 08:38:21,030][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 08:38:21,030][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 08:38:30,032][root][INFO] - Setting global seed to 206
[2025-03-06 08:38:30,039][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 08:38:30,040][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:38:30,041][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 08:38:30,043][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:38:30,046][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 08:38:30,046][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 08:38:30,208][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 08:38:30,785][root][INFO] - Full model selected, loading model
[2025-03-06 08:39:07,331][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 08:39:07,332][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 08:39:15,336][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 08:39:15,338][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 08:39:15,338][root][INFO] - Starting inference
[2025-03-06 08:39:15,525][root][INFO] - Processing question number 0
[2025-03-06 08:39:15,527][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 08:39:28,279][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 08:39:43,280][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 08:39:57,790][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 08:40:10,780][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 08:40:26,186][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 08:40:40,608][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 08:40:54,882][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 08:41:10,316][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 08:41:23,891][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 08:41:39,124][root][INFO] - Processing question number 10
[2025-03-06 08:41:39,126][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 08:41:53,887][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 08:42:08,363][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 08:42:21,303][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 08:42:34,299][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 08:42:48,651][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 08:43:02,838][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 08:43:18,184][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 08:43:29,302][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 08:43:41,223][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 08:43:52,350][root][INFO] - Processing question number 20
[2025-03-06 08:43:52,352][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 08:44:05,314][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 08:44:18,509][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 08:44:30,553][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 08:44:41,738][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 08:44:56,758][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 08:45:08,663][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 08:45:23,207][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 08:45:36,747][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 08:45:51,788][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 08:46:04,667][root][INFO] - Processing question number 30
[2025-03-06 08:46:04,670][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 08:46:21,149][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 08:46:34,340][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 08:46:50,561][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 08:47:03,170][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 08:47:13,558][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 08:47:26,083][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 08:47:38,647][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 08:47:54,002][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 08:48:08,300][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 08:48:20,137][root][INFO] - Processing question number 40
[2025-03-06 08:48:20,140][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 08:48:32,546][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 08:48:47,355][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 08:49:01,896][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 08:49:17,942][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 08:49:31,250][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 08:49:44,121][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 08:49:59,425][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 08:50:12,194][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 08:50:26,409][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 08:50:40,861][root][INFO] - Processing question number 50
[2025-03-06 08:50:40,865][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 08:50:55,199][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 08:51:10,728][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 08:51:23,688][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 08:51:39,247][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 08:51:55,065][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 08:52:07,277][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 08:52:23,467][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 08:52:34,479][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 08:52:48,377][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 08:53:00,914][root][INFO] - Processing question number 60
[2025-03-06 08:53:00,918][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 08:53:13,380][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 08:53:23,626][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 08:53:40,799][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 08:53:51,900][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 08:54:04,704][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 08:54:18,370][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 08:54:30,696][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 08:54:42,977][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 08:54:56,271][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 08:55:09,788][root][INFO] - Processing question number 70
[2025-03-06 08:55:09,793][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 08:55:25,336][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 08:55:38,836][root][INFO] - Domain : Property, Question : 6
[2025-03-06 08:55:50,780][root][INFO] - Domain : Property, Question : 13
[2025-03-06 08:56:04,008][root][INFO] - Domain : Property, Question : 20
[2025-03-06 08:56:18,085][root][INFO] - Domain : Property, Question : 33
[2025-03-06 08:56:30,202][root][INFO] - Domain : Property, Question : 39
[2025-03-06 08:56:47,215][root][INFO] - Domain : Property, Question : 48
[2025-03-06 08:57:01,102][root][INFO] - Domain : Property, Question : 54
[2025-03-06 08:57:15,160][root][INFO] - Domain : Property, Question : 61
[2025-03-06 08:57:29,520][root][INFO] - Processing question number 80
[2025-03-06 08:57:29,579][root][INFO] - Domain : Property, Question : 67
[2025-03-06 08:57:43,388][root][INFO] - Domain : Property, Question : 75
[2025-03-06 08:57:59,465][root][INFO] - Domain : Property, Question : 83
[2025-03-06 08:58:11,490][root][INFO] - Domain : Property, Question : 89
[2025-03-06 08:58:25,502][root][INFO] - Domain : Property, Question : 97
[2025-03-06 08:58:40,246][root][INFO] - Domain : Property, Question : 100
[2025-03-06 08:58:54,208][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 08:59:10,257][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 08:59:22,754][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 08:59:39,051][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 08:59:52,789][root][INFO] - Processing question number 90
[2025-03-06 08:59:52,795][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:00:09,921][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:00:24,399][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:00:39,294][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:00:50,070][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:01:05,099][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:01:20,658][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:01:34,100][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:01:47,631][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:02:00,849][root][INFO] - Inference complete
[2025-03-06 09:02:00,849][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,856][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,868][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,901][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,902][root][INFO] - Saved parsed outputs
[2025-03-06 09:02:00,902][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,921][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,921][root][INFO] - Saved parsing metadata
[2025-03-06 09:02:00,922][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,945][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:02:00,975][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:02:01,080][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 09:02:01,080][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 18, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 09:02:11,585][root][INFO] - Setting global seed to 206
[2025-03-06 09:02:11,593][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:02:11,593][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:02:11,594][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:02:11,596][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:02:11,598][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:02:11,598][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:02:11,775][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:02:12,365][root][INFO] - Full model selected, loading model
[2025-03-06 09:02:28,306][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:04:30,102][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:04:30,102][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:05:05,885][root][INFO] - Peft model loaded successfully
[2025-03-06 09:05:13,855][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:05:13,856][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:05:13,856][root][INFO] - Starting inference
[2025-03-06 09:05:14,060][root][INFO] - Processing question number 0
[2025-03-06 09:05:14,072][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:05:25,577][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:05:39,981][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:05:57,811][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:06:13,906][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:06:29,337][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:06:43,196][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:06:59,357][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:07:14,706][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:07:26,719][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:07:40,170][root][INFO] - Processing question number 10
[2025-03-06 09:07:40,215][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:08:01,614][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:08:17,447][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:08:30,943][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:08:46,165][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:08:59,284][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:09:12,664][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:09:29,368][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:09:42,855][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:09:57,957][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:10:10,716][root][INFO] - Processing question number 20
[2025-03-06 09:10:10,719][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:10:23,199][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:10:39,234][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:10:51,679][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:11:06,095][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:11:20,521][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:11:34,248][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:11:49,066][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:12:02,646][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:12:17,147][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:12:32,576][root][INFO] - Processing question number 30
[2025-03-06 09:12:32,581][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:13:04,606][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:13:18,561][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:13:36,049][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:13:51,735][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:14:03,814][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:14:19,240][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:14:35,295][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:14:50,158][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:15:05,362][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:15:19,824][root][INFO] - Processing question number 40
[2025-03-06 09:15:19,827][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:15:33,971][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:15:49,899][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:16:03,818][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:16:18,392][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:16:31,118][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:16:45,058][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:16:59,596][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:17:13,205][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:17:29,007][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:17:42,412][root][INFO] - Processing question number 50
[2025-03-06 09:17:42,416][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:17:57,505][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:18:14,479][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:18:28,207][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:18:43,828][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:18:58,215][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:19:09,095][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:19:25,568][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:19:38,012][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:19:51,197][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:20:03,500][root][INFO] - Processing question number 60
[2025-03-06 09:20:03,505][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:20:15,456][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:20:28,146][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:20:45,958][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:20:57,446][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:21:12,269][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:21:25,632][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:21:39,328][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:21:51,172][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:22:05,136][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:22:20,168][root][INFO] - Processing question number 70
[2025-03-06 09:22:20,173][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:22:34,465][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:22:48,950][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:23:03,581][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:23:19,589][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:23:35,314][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:23:48,175][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:24:03,967][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:24:19,989][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:24:35,870][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:24:50,941][root][INFO] - Processing question number 80
[2025-03-06 09:24:50,947][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:25:07,034][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:25:24,393][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:25:37,400][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:25:53,417][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:26:07,908][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:26:24,318][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:26:39,414][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:26:53,597][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:27:10,245][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:27:24,492][root][INFO] - Processing question number 90
[2025-03-06 09:27:24,498][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:27:42,152][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:27:57,724][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:28:11,827][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:28:27,071][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:28:45,751][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:29:01,604][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:29:14,329][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:29:29,666][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:29:44,932][root][INFO] - Inference complete
[2025-03-06 09:29:44,932][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,940][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,945][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:29:44,945][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:29:44,946][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:29:44,952][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:29:44,953][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:29:44,953][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:29:44,956][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,963][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,963][root][INFO] - Saved parsed outputs
[2025-03-06 09:29:44,963][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,964][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:44,965][root][INFO] - Saved parsing metadata
[2025-03-06 09:29:44,965][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:45,019][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:29:45,021][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:29:45,148][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 09:29:45,148][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 16, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 09:29:57,337][root][INFO] - Setting global seed to 206
[2025-03-06 09:29:57,359][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 09:29:57,359][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:29:57,360][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:29:57,428][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:29:57,433][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:29:57,433][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:29:57,615][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:29:58,266][root][INFO] - Full model selected, loading model
[2025-03-06 09:30:23,124][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 09:30:23,147][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 09:30:31,348][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:30:31,350][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:30:31,350][root][INFO] - Starting inference
[2025-03-06 09:30:31,516][root][INFO] - Processing question number 0
[2025-03-06 09:30:31,518][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:30:46,178][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:30:59,363][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:31:16,113][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:31:31,805][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:31:46,432][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:32:02,000][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:32:16,303][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:32:31,004][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:32:43,893][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:32:56,792][root][INFO] - Processing question number 10
[2025-03-06 09:32:56,794][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:33:11,895][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:33:25,941][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:33:37,729][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:33:50,704][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:34:05,110][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:34:18,140][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:34:33,207][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:34:44,548][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:34:56,239][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:35:07,938][root][INFO] - Processing question number 20
[2025-03-06 09:35:07,941][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:35:20,422][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:35:34,342][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:35:47,740][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:35:59,812][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:36:15,368][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:36:30,958][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:36:45,409][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:37:00,541][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:37:15,080][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:37:29,163][root][INFO] - Processing question number 30
[2025-03-06 09:37:29,166][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:37:45,640][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:37:58,819][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:38:11,057][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:38:26,181][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:38:39,022][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:38:51,645][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:39:05,279][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:39:20,300][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:39:34,312][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:39:48,048][root][INFO] - Processing question number 40
[2025-03-06 09:39:48,051][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:40:01,381][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:40:16,858][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:40:34,078][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:40:49,194][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:41:04,343][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:41:17,193][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:41:33,674][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:41:46,466][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:41:59,955][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:42:13,883][root][INFO] - Processing question number 50
[2025-03-06 09:42:13,887][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:42:26,806][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:42:41,893][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:42:53,332][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:43:08,537][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:43:24,286][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:43:35,676][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:43:50,902][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:44:07,976][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:44:24,397][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:44:35,336][root][INFO] - Processing question number 60
[2025-03-06 09:44:35,340][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:44:47,698][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:44:59,621][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:45:13,567][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:45:24,033][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:45:37,458][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:45:49,736][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:46:03,170][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:46:17,794][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:46:31,187][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:46:46,822][root][INFO] - Processing question number 70
[2025-03-06 09:46:46,827][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:47:01,994][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:47:16,527][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:47:28,747][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:47:43,458][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:47:57,325][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:48:10,087][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:48:26,198][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:48:39,375][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:48:53,635][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:49:08,874][root][INFO] - Processing question number 80
[2025-03-06 09:49:08,879][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:49:23,366][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:49:40,257][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:49:54,406][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:50:08,785][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:50:22,502][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:50:39,079][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:50:54,131][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:51:06,932][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:51:24,847][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:51:38,534][root][INFO] - Processing question number 90
[2025-03-06 09:51:38,540][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:51:53,915][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:52:06,390][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:52:19,113][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:52:30,469][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:52:44,311][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:52:58,735][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:53:12,770][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:53:26,143][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:53:38,643][root][INFO] - Inference complete
[2025-03-06 09:53:38,643][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,650][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,663][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,670][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,670][root][INFO] - Saved parsed outputs
[2025-03-06 09:53:38,670][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,671][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,672][root][INFO] - Saved parsing metadata
[2025-03-06 09:53:38,672][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,674][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:53:38,675][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:53:38,709][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 09:53:38,709][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 0, 'malformed_domain': 59, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.0707070707070707, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.06060606060606061, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.08080808080808081, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 29, 'both_wrong': 30}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 09:53:46,228][root][INFO] - Setting global seed to 206
[2025-03-06 09:53:46,234][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:53:46,234][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:53:46,235][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:53:46,237][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:53:46,240][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:53:46,240][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:53:46,388][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:53:47,101][root][INFO] - Full model selected, loading model
[2025-03-06 09:54:15,508][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:56:14,560][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:56:14,561][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:56:49,658][root][INFO] - Peft model loaded successfully
[2025-03-06 09:56:57,110][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:56:57,112][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 09:56:57,112][root][INFO] - Starting inference
[2025-03-06 09:56:57,303][root][INFO] - Processing question number 0
[2025-03-06 09:56:57,305][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:57:09,832][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:57:23,896][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:57:41,363][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:57:53,351][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:58:08,436][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:58:23,095][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:58:38,234][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:58:53,856][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:59:06,501][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:59:19,208][root][INFO] - Processing question number 10
[2025-03-06 09:59:19,210][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:59:39,563][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:59:55,093][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:00:10,350][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:00:25,020][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:00:38,840][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:00:53,311][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:01:08,748][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:01:22,062][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:01:37,476][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:01:51,544][root][INFO] - Processing question number 20
[2025-03-06 10:01:51,546][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:02:04,770][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:02:17,111][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:02:30,490][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:02:45,429][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:02:59,301][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:03:15,202][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:03:30,041][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:03:43,145][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:03:55,964][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:04:10,535][root][INFO] - Processing question number 30
[2025-03-06 10:04:10,537][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:04:24,493][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:04:39,056][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:04:54,627][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:05:12,034][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:05:23,540][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:05:38,107][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:05:55,161][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:06:11,331][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:06:24,951][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:06:41,068][root][INFO] - Processing question number 40
[2025-03-06 10:06:41,071][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:06:55,356][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:07:13,284][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:07:27,855][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:07:43,047][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:07:55,551][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:08:11,880][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:08:26,598][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:08:40,342][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:08:55,447][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:09:10,541][root][INFO] - Processing question number 50
[2025-03-06 10:09:10,545][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:09:24,911][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:09:40,289][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:09:53,640][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:10:07,247][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:10:21,676][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:10:35,618][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:10:50,027][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:11:03,371][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:11:20,070][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:11:32,879][root][INFO] - Processing question number 60
[2025-03-06 10:11:32,884][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:11:43,808][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:11:55,659][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:12:13,799][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:12:25,205][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:12:40,747][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:12:56,229][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:13:08,195][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:13:21,501][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:13:33,273][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:13:46,046][root][INFO] - Processing question number 70
[2025-03-06 10:13:46,051][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:14:00,302][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:14:16,490][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:14:29,192][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:14:45,828][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:15:00,702][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:15:15,884][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:15:31,128][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:15:45,253][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:15:59,272][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:16:14,658][root][INFO] - Processing question number 80
[2025-03-06 10:16:14,663][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:16:28,336][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:16:43,369][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:16:55,953][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:17:09,311][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:17:24,281][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:17:41,071][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:17:56,493][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:18:11,707][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:18:26,907][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:18:40,505][root][INFO] - Processing question number 90
[2025-03-06 10:18:40,510][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:18:55,318][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:19:09,364][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:19:24,251][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:19:38,183][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:19:53,608][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:20:08,892][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:20:20,873][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:20:38,374][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:20:52,974][root][INFO] - Inference complete
[2025-03-06 10:20:52,974][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:52,981][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:52,991][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:20:52,991][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:20:52,991][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:20:52,995][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,001][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,001][root][INFO] - Saved parsed outputs
[2025-03-06 10:20:53,001][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,002][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,002][root][INFO] - Saved parsing metadata
[2025-03-06 10:20:53,003][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,004][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:20:53,005][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:20:53,021][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 10:20:53,021][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 11, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 10:21:00,760][root][INFO] - Setting global seed to 206
[2025-03-06 10:21:00,767][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:21:00,767][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:21:00,768][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:21:00,770][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:21:00,772][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:21:00,772][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:21:00,924][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:21:01,512][root][INFO] - Full model selected, loading model
[2025-03-06 10:21:29,030][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:21:29,051][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:21:37,021][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:21:37,023][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:21:37,023][root][INFO] - Starting inference
[2025-03-06 10:21:37,198][root][INFO] - Processing question number 0
[2025-03-06 10:21:37,200][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:21:50,879][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:22:04,421][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:22:18,294][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:22:34,499][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:22:48,980][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:23:06,112][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:23:18,973][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:23:34,092][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:23:46,821][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:24:01,109][root][INFO] - Processing question number 10
[2025-03-06 10:24:01,111][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:24:15,144][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:24:29,397][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:24:43,320][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:24:55,718][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:25:08,703][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:25:21,141][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:25:36,056][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:25:50,905][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:26:04,106][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:26:16,338][root][INFO] - Processing question number 20
[2025-03-06 10:26:16,341][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:26:27,988][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:26:43,668][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:26:56,067][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:27:09,222][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:27:23,599][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:27:37,816][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:27:51,751][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:28:06,640][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:28:22,847][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:28:37,204][root][INFO] - Processing question number 30
[2025-03-06 10:28:37,207][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:28:52,753][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:29:04,929][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:29:18,631][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:29:33,201][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:29:44,698][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:29:57,910][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:30:13,146][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:30:26,781][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:30:40,909][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:30:53,730][root][INFO] - Processing question number 40
[2025-03-06 10:30:53,733][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:31:08,777][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:31:22,467][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:31:37,065][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:31:51,982][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:32:04,938][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:32:19,195][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:32:34,681][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:32:48,812][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:33:01,041][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:33:16,955][root][INFO] - Processing question number 50
[2025-03-06 10:33:16,958][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:33:29,376][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:33:45,706][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:33:57,170][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:34:14,695][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:34:28,338][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:34:42,779][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:34:57,539][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:35:11,232][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:35:27,546][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:35:40,872][root][INFO] - Processing question number 60
[2025-03-06 10:35:40,877][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:35:53,814][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:36:05,721][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:36:18,711][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:36:30,972][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:36:46,473][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:37:01,806][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:37:13,867][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:37:28,253][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:37:39,874][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:37:51,252][root][INFO] - Processing question number 70
[2025-03-06 10:37:51,257][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:38:07,144][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:38:22,003][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:38:34,200][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:38:50,835][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:39:05,952][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:39:21,692][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:39:39,109][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:39:52,915][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:40:08,590][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:40:24,037][root][INFO] - Processing question number 80
[2025-03-06 10:40:24,042][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:40:36,422][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:40:53,617][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:41:06,703][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:41:22,312][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:41:36,754][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:41:53,630][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:42:09,660][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:42:23,842][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:42:42,823][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:42:56,718][root][INFO] - Processing question number 90
[2025-03-06 10:42:56,723][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:43:09,438][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:43:21,923][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:43:35,018][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:43:48,238][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:44:01,379][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:44:15,030][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:44:28,352][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:44:41,675][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:44:52,924][root][INFO] - Inference complete
[2025-03-06 10:44:52,924][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,932][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,933][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,933][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,934][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,935][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,935][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,935][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,937][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,937][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,937][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,938][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,938][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,939][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,939][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,939][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,940][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,943][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,943][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,943][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,945][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,945][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,945][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,945][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,946][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,946][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,946][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:44:52,946][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:44:52,947][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:44:52,950][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,956][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,956][root][INFO] - Saved parsed outputs
[2025-03-06 10:44:52,956][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,957][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,957][root][INFO] - Saved parsing metadata
[2025-03-06 10:44:52,958][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,959][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:44:52,960][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:44:52,990][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 10:44:52,990][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.26262626262626265, 'malformed_label': 0, 'malformed_domain': 56, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.0707070707070707, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.06060606060606061, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 17, 'correct_label_wrong_domain': 23, 'both_wrong': 33}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 10:45:00,040][root][INFO] - Setting global seed to 989
[2025-03-06 10:45:00,045][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:45:00,046][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:45:00,047][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:45:00,048][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:45:00,052][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:45:00,052][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:45:00,198][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:45:00,786][root][INFO] - Full model selected, loading model
[2025-03-06 10:45:25,099][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:47:23,349][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:47:23,350][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:47:58,622][root][INFO] - Peft model loaded successfully
[2025-03-06 10:48:06,555][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:48:06,556][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 10:48:06,557][root][INFO] - Starting inference
[2025-03-06 10:48:06,753][root][INFO] - Processing question number 0
[2025-03-06 10:48:06,755][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:48:19,359][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:48:33,195][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:48:51,154][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:49:07,550][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:49:24,055][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:49:37,209][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:49:52,579][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:50:10,812][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:50:24,811][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:50:42,920][root][INFO] - Processing question number 10
[2025-03-06 10:50:42,923][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:50:57,690][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:51:12,944][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:51:27,464][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:51:41,907][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:51:54,571][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:52:08,772][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:52:23,933][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:52:40,512][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:52:54,213][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:53:05,874][root][INFO] - Processing question number 20
[2025-03-06 10:53:05,877][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:53:18,123][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:53:31,823][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:53:44,677][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:53:58,429][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:54:12,748][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:54:25,145][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:54:39,242][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:54:54,069][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:55:07,739][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:55:21,176][root][INFO] - Processing question number 30
[2025-03-06 10:55:21,179][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:55:37,529][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:55:52,628][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:56:09,317][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:56:23,148][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:56:35,550][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:56:51,027][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:57:04,722][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:57:21,655][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:57:36,476][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:57:49,856][root][INFO] - Processing question number 40
[2025-03-06 10:57:49,860][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:58:04,220][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:58:19,989][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:58:37,654][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:58:51,529][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:59:04,154][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:59:19,485][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:59:33,995][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:59:47,076][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:00:02,993][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:00:17,106][root][INFO] - Processing question number 50
[2025-03-06 11:00:17,110][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:00:32,721][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:00:48,272][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:01:01,720][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:01:17,520][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:01:31,886][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:01:43,425][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:01:58,302][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:02:10,000][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:02:23,385][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:02:35,749][root][INFO] - Processing question number 60
[2025-03-06 11:02:35,754][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:02:49,361][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:03:03,000][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:03:20,592][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:03:31,426][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:03:45,488][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:03:58,715][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:04:11,168][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:04:23,772][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:04:37,606][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:04:51,525][root][INFO] - Processing question number 70
[2025-03-06 11:04:51,530][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:05:04,924][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:05:19,734][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:05:32,846][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:05:49,589][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:06:04,570][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:06:17,323][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:06:33,966][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:06:46,460][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:07:01,763][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:07:15,928][root][INFO] - Processing question number 80
[2025-03-06 11:07:15,933][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:07:26,612][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:07:42,301][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:07:55,249][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:08:08,878][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:08:22,155][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:08:38,917][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:08:53,977][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:09:07,808][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:09:23,725][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:09:37,938][root][INFO] - Processing question number 90
[2025-03-06 11:09:37,944][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:09:54,110][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:10:10,016][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:10:23,116][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:10:37,294][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:10:53,544][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:11:09,905][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:11:22,366][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:11:37,255][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:11:54,296][root][INFO] - Inference complete
[2025-03-06 11:11:54,296][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,303][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,316][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,323][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,323][root][INFO] - Saved parsed outputs
[2025-03-06 11:11:54,323][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,324][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,324][root][INFO] - Saved parsing metadata
[2025-03-06 11:11:54,325][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,327][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:54,329][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:11:54,357][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 11:11:54,358][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 11:12:02,586][root][INFO] - Setting global seed to 989
[2025-03-06 11:12:02,593][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:12:02,594][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:12:02,595][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:12:02,597][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:12:02,602][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:12:02,602][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:12:02,752][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:12:03,310][root][INFO] - Full model selected, loading model
[2025-03-06 11:12:28,953][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:12:28,974][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:12:37,203][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:12:37,204][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:12:37,205][root][INFO] - Starting inference
[2025-03-06 11:12:37,405][root][INFO] - Processing question number 0
[2025-03-06 11:12:37,407][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:12:50,250][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:13:05,247][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:13:19,748][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:13:32,737][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:13:48,146][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:14:02,561][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:14:16,835][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:14:32,272][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:14:45,842][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:15:01,069][root][INFO] - Processing question number 10
[2025-03-06 11:15:01,071][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:15:15,823][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:15:30,298][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:15:43,230][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:15:56,228][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:16:10,573][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:16:24,756][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:16:40,085][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:16:51,202][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:17:03,117][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:17:14,240][root][INFO] - Processing question number 20
[2025-03-06 11:17:14,243][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:17:27,192][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:17:40,383][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:17:52,422][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:18:03,610][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:18:18,615][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:18:30,522][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:18:45,057][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:18:58,587][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:19:13,616][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:19:26,483][root][INFO] - Processing question number 30
[2025-03-06 11:19:26,494][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:19:42,955][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:19:56,129][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:20:12,350][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:20:24,955][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:20:35,354][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:20:47,876][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:21:00,432][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:21:15,773][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:21:30,060][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:21:41,890][root][INFO] - Processing question number 40
[2025-03-06 11:21:41,893][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:21:54,294][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:22:09,081][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:22:23,597][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:22:39,614][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:22:52,899][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:23:05,750][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:23:21,038][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:23:33,784][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:23:47,976][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:24:02,401][root][INFO] - Processing question number 50
[2025-03-06 11:24:02,405][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:24:16,728][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:24:32,256][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:24:45,206][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:25:00,759][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:25:16,563][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:25:28,770][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:25:44,947][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:25:55,957][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:26:09,863][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:26:22,384][root][INFO] - Processing question number 60
[2025-03-06 11:26:22,388][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:26:34,851][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:26:45,088][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:27:02,263][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:27:13,367][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:27:26,176][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:27:39,841][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:27:52,147][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:28:04,406][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:28:17,687][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:28:31,199][root][INFO] - Processing question number 70
[2025-03-06 11:28:31,203][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:28:46,741][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:29:00,242][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:29:12,172][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:29:25,380][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:29:39,435][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:29:51,547][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:30:08,541][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:30:22,427][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:30:36,463][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:30:50,802][root][INFO] - Processing question number 80
[2025-03-06 11:30:50,806][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:31:04,592][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:31:20,646][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:31:32,656][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:31:46,650][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:32:01,374][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:32:15,316][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:32:31,354][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:32:43,835][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:33:00,118][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:33:13,840][root][INFO] - Processing question number 90
[2025-03-06 11:33:13,845][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:33:30,952][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:33:45,414][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:34:00,276][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:34:11,042][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:34:26,060][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:34:41,683][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:34:55,228][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:35:08,838][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:35:22,087][root][INFO] - Inference complete
[2025-03-06 11:35:22,088][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,094][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,106][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,112][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,112][root][INFO] - Saved parsed outputs
[2025-03-06 11:35:22,112][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,113][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,113][root][INFO] - Saved parsing metadata
[2025-03-06 11:35:22,114][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,115][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:22,116][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:35:22,153][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 11:35:22,153][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 18, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 11:35:29,166][root][INFO] - Setting global seed to 989
[2025-03-06 11:35:29,171][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:35:29,171][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:35:29,173][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:35:29,174][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:35:29,177][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:35:29,178][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:35:29,330][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:35:29,908][root][INFO] - Full model selected, loading model
[2025-03-06 11:35:51,843][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:37:51,889][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:37:51,889][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:38:30,904][root][INFO] - Peft model loaded successfully
[2025-03-06 11:38:38,792][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:38:38,794][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:38:38,794][root][INFO] - Starting inference
[2025-03-06 11:38:38,983][root][INFO] - Processing question number 0
[2025-03-06 11:38:38,985][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:38:51,745][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:39:06,230][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:39:23,158][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:39:35,768][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:39:50,470][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:40:04,679][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:40:21,409][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:40:36,855][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:40:50,229][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:41:04,338][root][INFO] - Processing question number 10
[2025-03-06 11:41:04,339][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:41:21,879][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:41:35,450][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:41:48,931][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:42:04,302][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:42:17,771][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:42:32,472][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:42:48,339][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:43:01,667][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:43:15,863][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:43:27,755][root][INFO] - Processing question number 20
[2025-03-06 11:43:27,758][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:43:38,303][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:43:53,333][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:44:06,217][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:44:20,576][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:44:34,731][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:44:48,404][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:45:03,164][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:45:16,843][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:45:29,876][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:45:43,351][root][INFO] - Processing question number 30
[2025-03-06 11:45:43,355][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:45:59,914][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:46:13,608][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:46:30,750][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:46:46,016][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:46:57,835][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:47:11,635][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:47:24,328][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:47:40,535][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:47:54,212][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:48:10,344][root][INFO] - Processing question number 40
[2025-03-06 11:48:10,347][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:48:23,919][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:48:39,576][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:48:56,090][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:49:10,991][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:49:24,167][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:49:36,905][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:49:52,371][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:50:05,518][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:50:20,485][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:50:36,071][root][INFO] - Processing question number 50
[2025-03-06 11:50:36,075][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:50:51,935][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:51:07,227][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:51:21,352][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:51:34,924][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:51:47,964][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:52:00,966][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:52:15,340][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:52:29,358][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:52:44,454][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:52:56,953][root][INFO] - Processing question number 60
[2025-03-06 11:52:56,959][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:53:10,729][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:53:23,656][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:53:41,924][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:53:53,286][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:54:07,405][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:54:20,326][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:54:32,956][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:54:46,423][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:54:59,735][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:55:15,154][root][INFO] - Processing question number 70
[2025-03-06 11:55:15,159][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:55:29,674][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:55:45,625][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:55:58,952][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:56:16,826][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:56:32,431][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:56:45,223][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:56:59,544][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:57:13,787][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:57:29,122][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:57:46,138][root][INFO] - Processing question number 80
[2025-03-06 11:57:46,143][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:57:59,365][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:58:16,283][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:58:29,432][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:58:43,209][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:58:58,251][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:59:14,064][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:59:28,100][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:59:43,331][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:00:00,317][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:00:14,795][root][INFO] - Processing question number 90
[2025-03-06 12:00:14,800][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:00:32,065][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:00:45,738][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:00:59,930][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:01:12,821][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:01:30,311][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:01:46,604][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:01:59,049][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:02:14,927][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:02:31,162][root][INFO] - Inference complete
[2025-03-06 12:02:31,162][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,169][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,182][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,188][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,188][root][INFO] - Saved parsed outputs
[2025-03-06 12:02:31,188][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,190][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,190][root][INFO] - Saved parsing metadata
[2025-03-06 12:02:31,190][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,192][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:02:31,193][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:02:31,213][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 12:02:31,213][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 12, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 12:02:41,093][root][INFO] - Setting global seed to 989
[2025-03-06 12:02:41,101][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:02:41,101][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:02:41,103][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:02:41,105][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:02:41,107][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:02:41,107][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:02:41,281][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:02:41,864][root][INFO] - Full model selected, loading model
[2025-03-06 12:03:04,299][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:03:04,315][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:03:12,258][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:03:12,260][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:12,260][root][INFO] - Starting inference
[2025-03-06 12:03:12,446][root][INFO] - Processing question number 0
[2025-03-06 12:03:12,448][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:03:24,925][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:03:40,171][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:03:57,744][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:04:11,837][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:04:25,456][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:04:38,683][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:04:53,825][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:05:05,511][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:05:17,536][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:05:31,461][root][INFO] - Processing question number 10
[2025-03-06 12:05:31,463][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:05:46,683][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:06:01,907][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:06:14,087][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:06:27,733][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:06:39,704][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:06:54,184][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:07:07,497][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:07:19,189][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:07:33,539][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:07:44,361][root][INFO] - Processing question number 20
[2025-03-06 12:07:44,364][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:07:58,419][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:08:13,498][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:08:27,030][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:08:40,751][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:08:57,104][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:09:11,744][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:09:25,527][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:09:37,912][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:09:50,374][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:10:04,796][root][INFO] - Processing question number 30
[2025-03-06 12:10:04,798][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:10:19,834][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:10:33,724][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:10:48,116][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:11:01,315][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:11:13,890][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:11:27,329][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:11:40,186][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:11:56,741][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:12:11,981][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:12:25,345][root][INFO] - Processing question number 40
[2025-03-06 12:12:25,348][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:12:40,809][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:12:55,530][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:13:11,541][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:13:28,603][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:13:40,770][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:13:54,844][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:14:11,148][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:14:25,094][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:14:37,552][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:14:52,811][root][INFO] - Processing question number 50
[2025-03-06 12:14:52,824][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:15:06,408][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:15:23,340][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:15:34,976][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:15:47,589][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:16:04,193][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:16:15,779][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:16:35,075][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:16:45,904][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:17:01,052][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:17:13,355][root][INFO] - Processing question number 60
[2025-03-06 12:17:13,359][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:17:25,900][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:17:38,634][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:17:56,000][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:18:05,914][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:18:18,911][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:18:32,931][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:18:45,628][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:18:57,044][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:19:09,622][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:19:22,006][root][INFO] - Processing question number 70
[2025-03-06 12:19:22,011][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:19:34,863][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:19:50,484][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:20:03,011][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:20:17,666][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:20:32,722][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:20:46,602][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:21:04,194][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:21:18,709][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:21:33,956][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:21:48,824][root][INFO] - Processing question number 80
[2025-03-06 12:21:48,829][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:22:02,945][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:22:22,296][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:22:34,551][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:22:48,299][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:23:02,575][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:23:19,718][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:23:33,306][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:23:47,882][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:24:04,419][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:24:19,226][root][INFO] - Processing question number 90
[2025-03-06 12:24:19,232][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:24:36,183][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:24:50,324][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:25:05,674][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:25:18,675][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:25:32,834][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:25:46,528][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:25:58,734][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:26:13,087][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:26:26,629][root][INFO] - Inference complete
[2025-03-06 12:26:26,630][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,636][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,645][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:26:26,645][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:26:26,646][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:26:26,650][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,656][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,656][root][INFO] - Saved parsed outputs
[2025-03-06 12:26:26,656][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,657][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,657][root][INFO] - Saved parsing metadata
[2025-03-06 12:26:26,658][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,659][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:26:26,661][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:26:26,667][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 12:26:26,667][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.23232323232323232, 'malformed_label': 0, 'malformed_domain': 54, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 23, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.050505050505050504, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.06060606060606061, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 22, 'correct_label_wrong_domain': 26, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 12:26:33,895][root][INFO] - Setting global seed to 989
[2025-03-06 12:26:33,901][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:26:33,901][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:26:33,903][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:26:33,904][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:26:33,911][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:26:33,911][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:26:34,070][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:26:34,677][root][INFO] - Full model selected, loading model
[2025-03-06 12:26:58,724][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:28:58,144][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:28:58,145][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:29:32,615][root][INFO] - Peft model loaded successfully
[2025-03-06 12:29:40,071][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:29:40,073][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:29:40,073][root][INFO] - Starting inference
[2025-03-06 12:29:40,287][root][INFO] - Processing question number 0
[2025-03-06 12:29:40,289][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:29:55,781][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:30:09,766][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:30:28,048][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:30:42,784][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:30:58,428][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:31:13,929][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:31:27,282][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:31:44,280][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:31:55,724][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:32:13,311][root][INFO] - Processing question number 10
[2025-03-06 12:32:13,313][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:32:30,696][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:32:45,239][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:32:57,843][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:33:13,689][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:33:26,702][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:33:41,461][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:33:57,042][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:34:11,307][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:34:25,106][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:34:36,088][root][INFO] - Processing question number 20
[2025-03-06 12:34:36,090][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:34:48,867][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:35:02,350][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:35:14,770][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:35:28,262][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:35:44,276][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:36:00,899][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:36:15,601][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:36:29,387][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:36:41,651][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:36:55,435][root][INFO] - Processing question number 30
[2025-03-06 12:36:55,438][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:37:09,878][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:37:23,057][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:37:39,076][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:37:54,347][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:38:05,549][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:38:19,249][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:38:33,647][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:38:50,271][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:39:03,861][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:39:17,292][root][INFO] - Processing question number 40
[2025-03-06 12:39:17,296][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:39:31,913][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:39:48,985][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:40:03,122][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:40:18,187][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:40:29,832][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:40:45,214][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:41:03,290][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:41:15,178][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:41:31,654][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:41:46,144][root][INFO] - Processing question number 50
[2025-03-06 12:41:46,148][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:41:59,536][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:42:16,324][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:42:28,003][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:42:42,141][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:42:55,336][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:43:06,868][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:43:22,134][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:43:35,390][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:43:51,110][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:44:05,141][root][INFO] - Processing question number 60
[2025-03-06 12:44:05,145][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:44:19,218][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:44:31,938][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:44:49,416][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:45:01,593][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:45:16,181][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:45:30,716][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:45:43,876][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:45:57,613][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:46:11,712][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:46:24,556][root][INFO] - Processing question number 70
[2025-03-06 12:46:24,560][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:46:38,381][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:46:54,668][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:47:08,522][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:47:23,849][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:47:39,995][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:47:53,415][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:48:09,790][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:48:22,601][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:48:37,842][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:48:52,289][root][INFO] - Processing question number 80
[2025-03-06 12:48:52,294][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:49:09,048][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:49:26,247][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:49:40,384][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:49:58,153][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:50:14,884][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:50:32,018][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:50:47,311][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:51:03,288][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:51:18,056][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:51:31,434][root][INFO] - Processing question number 90
[2025-03-06 12:51:31,439][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:51:46,875][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:52:01,062][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:52:17,275][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:52:32,201][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:52:48,192][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:53:06,315][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:53:18,778][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:53:31,571][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:53:48,143][root][INFO] - Inference complete
[2025-03-06 12:53:48,143][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,150][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,160][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:53:48,160][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:53:48,161][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:53:48,164][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,171][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,171][root][INFO] - Saved parsed outputs
[2025-03-06 12:53:48,171][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,172][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,172][root][INFO] - Saved parsing metadata
[2025-03-06 12:53:48,173][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,175][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:53:48,176][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:53:48,206][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 12:53:48,206][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 16, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 12:53:56,392][root][INFO] - Setting global seed to 989
[2025-03-06 12:53:56,399][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:53:56,399][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:53:56,400][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:53:56,402][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:53:56,405][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:53:56,406][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:53:56,555][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:53:57,123][root][INFO] - Full model selected, loading model
[2025-03-06 12:54:21,146][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:54:21,172][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:54:29,231][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:54:29,232][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:29,232][root][INFO] - Starting inference
[2025-03-06 12:54:29,413][root][INFO] - Processing question number 0
[2025-03-06 12:54:29,415][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:54:43,634][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:54:57,293][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:55:12,266][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:55:26,792][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:55:41,138][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:55:57,003][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:56:12,475][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:56:27,459][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:56:41,329][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:56:54,708][root][INFO] - Processing question number 10
[2025-03-06 12:56:54,756][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:57:10,033][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:57:25,276][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:57:37,988][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:57:53,045][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:58:06,100][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:58:18,768][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:58:34,029][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:58:47,463][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:59:00,629][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:59:13,637][root][INFO] - Processing question number 20
[2025-03-06 12:59:13,640][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:59:26,522][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:59:40,786][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:59:55,043][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:00:06,141][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:00:20,747][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:00:34,923][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:00:49,252][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:01:04,018][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:01:18,546][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:01:32,111][root][INFO] - Processing question number 30
[2025-03-06 13:01:32,166][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:01:46,654][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:01:59,197][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:02:13,272][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:02:26,875][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:02:38,884][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:02:51,330][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:03:06,080][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:03:20,557][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:03:36,607][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:03:49,272][root][INFO] - Processing question number 40
[2025-03-06 13:03:49,275][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:04:03,354][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:04:18,712][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:04:34,222][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:04:47,918][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:05:03,052][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:05:17,686][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:05:32,621][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:05:47,380][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:06:04,618][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:06:17,123][root][INFO] - Processing question number 50
[2025-03-06 13:06:17,127][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:06:31,364][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:06:46,483][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:06:59,418][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:07:17,498][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:07:30,120][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:07:43,209][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:07:58,407][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:08:12,359][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:08:25,212][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:08:35,976][root][INFO] - Processing question number 60
[2025-03-06 13:08:35,980][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:08:50,298][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:09:01,738][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:09:19,362][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:09:31,428][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:09:44,563][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:09:58,103][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:10:11,605][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:10:24,548][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:10:39,001][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:10:53,417][root][INFO] - Processing question number 70
[2025-03-06 13:10:53,421][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:11:06,555][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:11:20,652][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:11:33,819][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:11:50,103][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:12:05,856][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:12:19,258][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:12:34,505][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:12:49,368][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:13:03,247][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:13:18,865][root][INFO] - Processing question number 80
[2025-03-06 13:13:18,870][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:13:35,506][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:13:53,157][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:14:04,432][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:14:19,102][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:14:34,408][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:14:53,042][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:15:08,113][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:15:22,530][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:15:39,623][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:15:52,679][root][INFO] - Processing question number 90
[2025-03-06 13:15:52,684][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:16:08,506][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:16:21,170][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:16:39,360][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:16:52,232][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:17:06,304][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:17:22,067][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:17:33,571][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:17:47,625][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:18:03,067][root][INFO] - Inference complete
[2025-03-06 13:18:03,067][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,074][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,078][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,079][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:18:03,080][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,081][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,082][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:18:03,082][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,083][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,083][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:18:03,083][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,085][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,086][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:18:03,086][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,087][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,087][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:18:03,087][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,089][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:18:03,089][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:18:03,089][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:18:03,091][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,097][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,098][root][INFO] - Saved parsed outputs
[2025-03-06 13:18:03,098][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,109][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,109][root][INFO] - Saved parsing metadata
[2025-03-06 13:18:03,110][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,112][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:18:03,113][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:18:03,126][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 13:18:03,127][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 0, 'malformed_domain': 56, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.04040404040404041, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.08080808080808081, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 28, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 13:18:10,667][root][INFO] - Setting global seed to 206
[2025-03-06 13:18:10,674][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:18:10,674][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:18:10,675][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:18:10,690][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:18:10,693][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:18:10,693][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:18:10,853][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:18:11,478][root][INFO] - Full model selected, loading model
[2025-03-06 13:18:35,266][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:20:34,283][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:20:34,284][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:21:08,878][root][INFO] - Peft model loaded successfully
[2025-03-06 13:21:16,271][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:21:16,274][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:21:16,274][root][INFO] - Starting inference
[2025-03-06 13:21:16,470][root][INFO] - Processing question number 0
[2025-03-06 13:21:16,472][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:21:32,420][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:21:46,219][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:22:02,510][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:22:16,689][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:22:28,170][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:22:40,383][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:22:55,522][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:23:08,152][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:23:21,269][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:23:35,012][root][INFO] - Processing question number 10
[2025-03-06 13:23:35,014][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:23:45,685][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:23:57,790][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:24:11,762][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:24:25,667][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:24:41,361][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:24:53,803][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:25:09,593][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:25:22,283][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:25:36,413][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:25:50,654][root][INFO] - Processing question number 20
[2025-03-06 13:25:50,656][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:26:02,967][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:26:15,862][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:26:26,540][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:26:38,235][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:26:53,826][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:27:08,539][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:27:24,038][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:27:36,598][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:27:50,167][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:28:04,503][root][INFO] - Processing question number 30
[2025-03-06 13:28:04,507][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:28:18,139][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:28:32,160][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:28:48,387][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:29:03,984][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:29:16,911][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:29:33,182][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:29:46,598][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:29:59,448][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:30:10,831][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:30:25,796][root][INFO] - Processing question number 40
[2025-03-06 13:30:25,800][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:30:39,653][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:30:52,438][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:31:07,085][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:31:18,915][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:31:39,515][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:31:52,222][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:32:05,533][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:32:21,374][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:32:35,150][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:32:49,100][root][INFO] - Processing question number 50
[2025-03-06 13:32:49,104][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:33:04,020][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:33:17,900][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:33:33,166][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:33:47,580][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:34:02,320][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:34:18,513][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:34:31,582][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:34:45,535][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:34:58,404][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:35:14,252][root][INFO] - Processing question number 60
[2025-03-06 13:35:14,256][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:35:27,884][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:35:44,974][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:35:59,524][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:36:15,068][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:36:29,954][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:36:45,028][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:36:57,395][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:37:09,988][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:37:24,829][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:37:36,554][root][INFO] - Processing question number 70
[2025-03-06 13:37:36,558][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:37:51,524][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:38:06,769][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:38:22,084][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:38:38,707][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:38:51,209][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:39:06,623][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:39:23,288][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:39:38,321][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:39:51,022][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:40:06,396][root][INFO] - Processing question number 80
[2025-03-06 13:40:06,401][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:40:20,050][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:40:34,462][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:40:49,970][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:41:03,977][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:41:19,259][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:41:35,307][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:41:49,798][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:42:05,595][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:42:19,515][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:42:32,627][root][INFO] - Processing question number 90
[2025-03-06 13:42:32,632][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:42:46,857][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:43:00,325][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:43:12,969][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:43:26,911][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:43:42,319][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:44:00,489][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:44:15,067][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:44:28,114][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:44:40,536][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:44:57,110][root][INFO] - Inference complete
[2025-03-06 13:44:57,110][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,119][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,124][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:44:57,125][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:44:57,126][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:44:57,126][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:44:57,127][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:44:57,127][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:44:57,134][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,140][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,140][root][INFO] - Saved parsed outputs
[2025-03-06 13:44:57,140][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,142][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,142][root][INFO] - Saved parsing metadata
[2025-03-06 13:44:57,144][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,145][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:44:57,146][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:44:57,200][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 13:44:57,200][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 18, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 13:45:08,176][root][INFO] - Setting global seed to 206
[2025-03-06 13:45:08,185][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 13:45:08,185][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:45:08,187][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:45:08,200][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:45:08,203][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:45:08,203][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:45:08,446][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:45:09,102][root][INFO] - Full model selected, loading model
[2025-03-06 13:45:36,570][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:45:36,583][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:45:44,652][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:45:44,654][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 13:45:44,654][root][INFO] - Starting inference
[2025-03-06 13:45:44,875][root][INFO] - Processing question number 0
[2025-03-06 13:45:44,878][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:46:01,734][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:46:15,071][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:46:31,894][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:46:45,048][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:46:58,832][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:47:11,254][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:47:24,566][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:47:37,338][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:47:49,207][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:48:02,334][root][INFO] - Processing question number 10
[2025-03-06 13:48:02,336][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:48:13,898][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:48:28,485][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:48:39,802][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:48:53,007][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:49:04,811][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:49:20,152][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:49:33,395][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:49:48,471][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:50:03,006][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:50:17,898][root][INFO] - Processing question number 20
[2025-03-06 13:50:17,901][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:50:30,122][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:50:43,926][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:50:57,210][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:51:09,054][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:51:20,845][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:51:34,676][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:51:48,351][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:52:01,117][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:52:14,799][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:52:32,293][root][INFO] - Processing question number 30
[2025-03-06 13:52:32,296][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:52:45,581][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:52:58,951][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:53:13,397][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:53:30,023][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:53:43,305][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:53:55,555][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:54:09,883][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:54:25,045][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:54:37,340][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:54:51,747][root][INFO] - Processing question number 40
[2025-03-06 13:54:51,751][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:55:04,683][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:55:16,626][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:55:31,673][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:55:43,849][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:56:02,424][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:56:14,260][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:56:27,628][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:56:38,591][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:56:52,365][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:57:06,210][root][INFO] - Processing question number 50
[2025-03-06 13:57:06,214][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:57:22,062][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:57:36,400][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:57:49,155][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:58:01,844][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:58:14,893][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:58:28,453][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:58:44,619][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:58:57,762][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:59:10,749][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:59:26,375][root][INFO] - Processing question number 60
[2025-03-06 13:59:26,379][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:59:40,162][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:59:53,315][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:00:09,788][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:00:23,244][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:00:36,097][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:00:51,593][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:01:03,209][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:01:15,806][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:01:28,532][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:01:42,519][root][INFO] - Processing question number 70
[2025-03-06 14:01:42,524][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:01:57,086][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:02:11,521][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:02:28,020][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:02:44,018][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:02:55,407][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:03:09,485][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:03:26,563][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:03:43,605][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:03:54,812][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:04:08,514][root][INFO] - Processing question number 80
[2025-03-06 14:04:08,519][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:04:22,260][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:04:35,842][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:04:52,002][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:05:04,970][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:05:19,471][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:05:35,538][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:05:49,882][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:06:03,245][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:06:17,634][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:06:30,584][root][INFO] - Processing question number 90
[2025-03-06 14:06:30,590][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:06:43,209][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:06:57,598][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:07:09,208][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:07:22,082][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:07:36,388][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:07:49,280][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:08:03,713][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:08:15,834][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:08:29,240][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:08:44,048][root][INFO] - Inference complete
[2025-03-06 14:08:44,048][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,055][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,068][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,074][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,074][root][INFO] - Saved parsed outputs
[2025-03-06 14:08:44,074][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,076][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,076][root][INFO] - Saved parsing metadata
[2025-03-06 14:08:44,076][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,078][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:08:44,079][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:08:44,100][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 14:08:44,101][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.27, 'malformed_label': 0, 'malformed_domain': 45, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 22, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 14:08:51,316][root][INFO] - Setting global seed to 206
[2025-03-06 14:08:51,322][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:08:51,322][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:08:51,324][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:08:51,335][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:08:51,339][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:08:51,339][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:08:51,507][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:08:52,357][root][INFO] - Full model selected, loading model
[2025-03-06 14:09:17,154][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:11:20,277][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:11:20,278][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:11:58,102][root][INFO] - Peft model loaded successfully
[2025-03-06 14:12:05,904][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:12:05,905][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:12:05,906][root][INFO] - Starting inference
[2025-03-06 14:12:06,073][root][INFO] - Processing question number 0
[2025-03-06 14:12:06,075][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:12:22,990][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:12:37,606][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:12:52,241][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:13:08,467][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:13:21,794][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:13:35,341][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:13:48,202][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:14:01,976][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:14:14,262][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:14:29,680][root][INFO] - Processing question number 10
[2025-03-06 14:14:29,682][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:14:40,045][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:14:52,721][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:15:05,631][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:15:18,115][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:15:33,135][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:15:45,647][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:16:00,758][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:16:15,473][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:16:29,119][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:16:43,398][root][INFO] - Processing question number 20
[2025-03-06 14:16:43,400][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:16:55,291][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:17:08,564][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:17:21,462][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:17:32,249][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:17:46,386][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:18:00,101][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:18:18,019][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:18:30,796][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:18:44,752][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:19:00,822][root][INFO] - Processing question number 30
[2025-03-06 14:19:00,825][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:19:14,896][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:19:28,942][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:19:41,619][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:19:54,154][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:20:06,275][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:20:22,208][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:20:36,976][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:20:49,953][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:21:00,939][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:21:17,759][root][INFO] - Processing question number 40
[2025-03-06 14:21:17,763][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:21:32,765][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:21:46,303][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:22:01,983][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:22:13,782][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:22:29,522][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:22:41,120][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:22:53,651][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:23:07,656][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:23:23,012][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:23:38,210][root][INFO] - Processing question number 50
[2025-03-06 14:23:38,214][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:23:51,629][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:24:05,309][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:24:20,636][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:24:35,620][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:24:50,583][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:25:03,966][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:25:17,896][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:25:32,824][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:25:47,115][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:26:02,574][root][INFO] - Processing question number 60
[2025-03-06 14:26:02,579][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:26:16,192][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:26:31,237][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:26:44,255][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:26:59,654][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:27:15,394][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:27:30,844][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:27:43,643][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:27:56,519][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:28:11,830][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:28:24,642][root][INFO] - Processing question number 70
[2025-03-06 14:28:24,647][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:28:39,835][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:28:54,639][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:29:12,968][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:29:28,978][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:29:42,113][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:29:59,001][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:30:15,951][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:30:31,566][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:30:44,157][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:30:59,913][root][INFO] - Processing question number 80
[2025-03-06 14:30:59,918][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:31:14,855][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:31:30,932][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:31:47,124][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:32:01,737][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:32:18,936][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:32:36,376][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:32:50,929][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:33:07,462][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:33:21,315][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:33:36,219][root][INFO] - Processing question number 90
[2025-03-06 14:33:36,224][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:33:52,763][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:34:07,459][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:34:20,428][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:34:33,534][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:34:50,631][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:35:07,625][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:35:22,815][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:35:35,434][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:35:47,937][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:36:01,364][root][INFO] - Inference complete
[2025-03-06 14:36:01,364][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,372][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,375][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:36:01,375][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:36:01,376][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:36:01,387][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,393][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,393][root][INFO] - Saved parsed outputs
[2025-03-06 14:36:01,394][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,395][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,395][root][INFO] - Saved parsing metadata
[2025-03-06 14:36:01,395][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,415][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:01,417][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:36:01,442][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 14:36:01,442][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.35, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.02, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 19, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 14:36:12,672][root][INFO] - Setting global seed to 206
[2025-03-06 14:36:12,680][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:36:12,680][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:36:12,681][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:36:12,695][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:36:12,698][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:36:12,698][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:36:12,851][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:36:13,499][root][INFO] - Full model selected, loading model
[2025-03-06 14:36:39,224][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:36:39,244][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:36:47,201][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:36:47,202][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 14:36:47,202][root][INFO] - Starting inference
[2025-03-06 14:36:47,369][root][INFO] - Processing question number 0
[2025-03-06 14:36:47,372][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:37:03,745][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:37:17,710][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:37:32,461][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:37:45,806][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:38:00,223][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:38:12,435][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:38:26,725][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:38:39,294][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:38:51,207][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:39:03,884][root][INFO] - Processing question number 10
[2025-03-06 14:39:03,886][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:39:16,243][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:39:30,607][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:39:44,949][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:39:57,870][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:40:12,096][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:40:25,978][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:40:37,444][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:40:56,015][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:41:09,441][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:41:24,425][root][INFO] - Processing question number 20
[2025-03-06 14:41:24,428][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:41:38,570][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:41:51,505][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:42:03,525][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:42:15,045][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:42:27,688][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:42:39,218][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:42:52,391][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:43:04,848][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:43:19,159][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:43:33,560][root][INFO] - Processing question number 30
[2025-03-06 14:43:33,563][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:43:47,621][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:43:59,459][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:44:12,648][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:44:27,343][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:44:38,334][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:44:51,759][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:45:06,208][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:45:21,336][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:45:34,600][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:45:48,087][root][INFO] - Processing question number 40
[2025-03-06 14:45:48,090][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:46:00,873][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:46:14,224][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:46:29,925][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:46:41,752][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:46:57,251][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:47:11,754][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:47:24,416][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:47:36,225][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:47:51,404][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:48:06,610][root][INFO] - Processing question number 50
[2025-03-06 14:48:06,613][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:48:22,706][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:48:38,350][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:48:53,377][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:49:07,915][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:49:21,579][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:49:34,020][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:49:52,686][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:50:06,705][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:50:20,861][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:50:34,527][root][INFO] - Processing question number 60
[2025-03-06 14:50:34,532][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:50:50,127][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:51:05,868][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:51:22,802][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:51:39,263][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:51:54,443][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:52:10,539][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:52:23,365][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:52:39,796][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:52:52,322][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:53:06,437][root][INFO] - Processing question number 70
[2025-03-06 14:53:06,442][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:53:22,492][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:53:39,387][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:53:56,690][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:54:11,308][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:54:22,850][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:54:37,786][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:54:54,384][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:55:10,021][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:55:25,284][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:55:38,549][root][INFO] - Processing question number 80
[2025-03-06 14:55:38,555][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:55:52,215][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:56:05,972][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:56:20,203][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:56:34,063][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:56:50,166][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:57:07,786][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:57:21,634][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:57:37,726][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:57:49,470][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:58:03,789][root][INFO] - Processing question number 90
[2025-03-06 14:58:03,795][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:58:16,770][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:58:34,020][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:58:45,932][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:58:59,162][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:59:14,417][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:59:28,242][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:59:41,700][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:59:56,962][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:00:11,374][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:00:26,265][root][INFO] - Inference complete
[2025-03-06 15:00:26,265][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,272][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,285][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,291][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,291][root][INFO] - Saved parsed outputs
[2025-03-06 15:00:26,291][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,292][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,292][root][INFO] - Saved parsing metadata
[2025-03-06 15:00:26,293][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,294][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:00:26,296][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:00:26,303][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 15:00:26,303][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.21, 'malformed_label': 0, 'malformed_domain': 59, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.07, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.08, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 20, 'correct_label_wrong_domain': 28, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 15:00:33,521][root][INFO] - Setting global seed to 206
[2025-03-06 15:00:33,527][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:00:33,527][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:00:33,529][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:00:33,530][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:00:33,533][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:00:33,533][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:00:33,684][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:00:34,269][root][INFO] - Full model selected, loading model
[2025-03-06 15:01:06,585][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:03:06,056][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:03:06,057][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:03:41,615][root][INFO] - Peft model loaded successfully
[2025-03-06 15:03:49,072][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:03:49,074][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:03:49,074][root][INFO] - Starting inference
[2025-03-06 15:03:49,277][root][INFO] - Processing question number 0
[2025-03-06 15:03:49,279][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:04:03,665][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:04:19,030][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:04:35,243][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:04:51,224][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:05:04,083][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:05:14,960][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:05:27,606][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:05:41,400][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:05:53,099][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:06:08,033][root][INFO] - Processing question number 10
[2025-03-06 15:06:08,035][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:06:19,980][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:06:33,286][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:06:48,225][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:07:00,213][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:07:13,543][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:07:27,354][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:07:41,826][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:07:56,667][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:08:10,379][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:08:24,881][root][INFO] - Processing question number 20
[2025-03-06 15:08:24,884][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:08:36,934][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:08:50,323][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:09:03,598][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:09:15,256][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:09:32,053][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:09:46,350][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:10:00,268][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:10:14,404][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:10:27,196][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:10:41,837][root][INFO] - Processing question number 30
[2025-03-06 15:10:41,841][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:10:55,315][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:11:11,393][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:11:25,857][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:11:41,206][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:11:56,131][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:12:11,610][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:12:25,378][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:12:39,461][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:12:52,927][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:13:08,072][root][INFO] - Processing question number 40
[2025-03-06 15:13:08,095][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:13:19,822][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:13:32,754][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:13:48,445][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:14:00,096][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:14:17,356][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:14:27,377][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:14:39,810][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:14:54,380][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:15:07,737][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:15:23,236][root][INFO] - Processing question number 50
[2025-03-06 15:15:23,240][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:15:37,507][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:15:56,233][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:16:14,211][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:16:27,276][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:16:42,635][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:17:00,596][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:17:14,313][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:17:30,629][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:17:44,345][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:17:59,585][root][INFO] - Processing question number 60
[2025-03-06 15:17:59,590][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:18:14,932][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:18:32,698][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:18:46,925][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:19:03,791][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:19:17,400][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:19:32,764][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:19:44,411][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:20:00,383][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:20:14,738][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:20:29,263][root][INFO] - Processing question number 70
[2025-03-06 15:20:29,268][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:20:47,074][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:21:01,070][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:21:16,470][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:21:32,440][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:21:45,891][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:22:01,071][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:22:19,473][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:22:33,657][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:22:48,649][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:23:04,060][root][INFO] - Processing question number 80
[2025-03-06 15:23:04,066][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:23:19,841][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:23:33,947][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:23:51,471][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:24:04,955][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:24:22,319][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:24:39,219][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:24:55,511][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:25:09,606][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:25:24,574][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:25:38,614][root][INFO] - Processing question number 90
[2025-03-06 15:25:38,620][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:25:54,651][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:26:11,358][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:26:23,298][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:26:37,509][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:26:52,789][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:27:08,743][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:27:23,171][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:27:36,632][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:27:48,988][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:28:04,346][root][INFO] - Inference complete
[2025-03-06 15:28:04,346][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,354][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,364][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:28:04,365][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:28:04,365][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:28:04,369][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,375][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,375][root][INFO] - Saved parsed outputs
[2025-03-06 15:28:04,375][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,377][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,377][root][INFO] - Saved parsing metadata
[2025-03-06 15:28:04,378][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,387][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:04,388][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:28:04,497][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 15:28:04,497][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.32, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.6428571428571429, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 21, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 15:28:14,496][root][INFO] - Setting global seed to 206
[2025-03-06 15:28:14,505][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:28:14,506][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:28:14,507][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:28:14,532][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:28:14,535][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:28:14,535][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:28:14,706][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:28:15,283][root][INFO] - Full model selected, loading model
[2025-03-06 15:28:41,751][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:28:41,776][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:28:51,863][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:28:51,865][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:28:51,865][root][INFO] - Starting inference
[2025-03-06 15:28:52,019][root][INFO] - Processing question number 0
[2025-03-06 15:28:52,021][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:29:07,132][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:29:22,401][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:29:39,258][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:29:52,752][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:30:05,613][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:30:17,550][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:30:29,982][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:30:43,973][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:30:56,575][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:31:09,490][root][INFO] - Processing question number 10
[2025-03-06 15:31:09,493][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:31:22,393][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:31:38,300][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:31:51,872][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:32:03,332][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:32:17,208][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:32:30,479][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:32:42,370][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:32:55,129][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:33:08,981][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:33:23,464][root][INFO] - Processing question number 20
[2025-03-06 15:33:23,466][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:33:36,049][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:33:49,977][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:34:04,506][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:34:17,879][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:34:29,624][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:34:41,882][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:34:56,157][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:35:08,374][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:35:22,708][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:35:36,148][root][INFO] - Processing question number 30
[2025-03-06 15:35:36,151][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:35:50,031][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:36:03,533][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:36:15,212][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:36:29,301][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:36:41,894][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:36:57,831][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:37:11,863][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:37:28,457][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:37:40,986][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:37:55,546][root][INFO] - Processing question number 40
[2025-03-06 15:37:55,550][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:38:09,179][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:38:22,973][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:38:38,859][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:38:53,491][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:39:07,232][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:39:22,439][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:39:35,690][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:39:49,577][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:40:01,536][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:40:14,542][root][INFO] - Processing question number 50
[2025-03-06 15:40:14,546][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:40:31,089][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:40:44,980][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:40:57,247][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:41:11,671][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:41:28,029][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:41:40,084][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:41:53,185][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:42:11,453][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:42:24,138][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:42:38,298][root][INFO] - Processing question number 60
[2025-03-06 15:42:38,311][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:42:53,370][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:43:07,535][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:43:23,500][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:43:36,419][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:43:52,409][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:44:06,729][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:44:19,945][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:44:33,849][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:44:47,528][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:45:02,867][root][INFO] - Processing question number 70
[2025-03-06 15:45:02,871][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:45:16,663][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:45:32,355][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:45:48,956][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:46:01,933][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:46:14,108][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:46:27,415][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:46:44,214][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:46:58,943][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:47:10,723][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:47:23,810][root][INFO] - Processing question number 80
[2025-03-06 15:47:23,816][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:47:36,889][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:47:50,205][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:48:03,061][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:48:15,563][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:48:30,170][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:48:47,153][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:49:04,173][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:49:17,787][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:49:31,427][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:49:45,856][root][INFO] - Processing question number 90
[2025-03-06 15:49:45,862][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:49:59,071][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:50:16,571][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:50:28,820][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:50:43,067][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:50:59,178][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:51:14,982][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:51:30,284][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:51:43,728][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:51:57,001][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:52:15,758][root][INFO] - Inference complete
[2025-03-06 15:52:15,758][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,792][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,794][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,794][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,795][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,796][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,796][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,796][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,796][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,797][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,797][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,798][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,798][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,798][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,801][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,802][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,802][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,806][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,806][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,806][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,806][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,807][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,807][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,808][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,808][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,809][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,810][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:52:15,810][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:52:15,810][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:52:15,812][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,818][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,818][root][INFO] - Saved parsed outputs
[2025-03-06 15:52:15,818][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,820][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,820][root][INFO] - Saved parsing metadata
[2025-03-06 15:52:15,821][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,822][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:52:15,824][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:52:15,906][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 15:52:15,906][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.16, 'malformed_label': 0, 'malformed_domain': 66, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.02, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.05, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 18, 'correct_label_wrong_domain': 36, 'both_wrong': 30}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 15:52:23,466][root][INFO] - Setting global seed to 989
[2025-03-06 15:52:23,471][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:52:23,472][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:52:23,473][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:52:23,475][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:52:23,478][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:52:23,478][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:52:23,625][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:52:24,176][root][INFO] - Full model selected, loading model
[2025-03-06 15:52:49,963][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:54:48,460][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:54:48,460][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:55:25,465][root][INFO] - Peft model loaded successfully
[2025-03-06 15:55:33,003][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:55:33,005][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 15:55:33,005][root][INFO] - Starting inference
[2025-03-06 15:55:33,236][root][INFO] - Processing question number 0
[2025-03-06 15:55:33,238][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:55:49,228][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:56:03,113][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:56:19,503][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:56:33,765][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:56:45,302][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:56:57,579][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:57:12,806][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:57:25,501][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:57:38,693][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:57:52,510][root][INFO] - Processing question number 10
[2025-03-06 15:57:52,512][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:58:03,243][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:58:15,408][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:58:29,450][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:58:43,436][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:58:59,218][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:59:11,732][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:59:27,616][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:59:40,380][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:59:54,590][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:00:08,910][root][INFO] - Processing question number 20
[2025-03-06 16:00:08,913][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:00:21,303][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:00:34,270][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:00:45,007][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:00:56,762][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:01:12,446][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:01:27,237][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:01:42,832][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:01:55,468][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:02:09,125][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:02:23,540][root][INFO] - Processing question number 30
[2025-03-06 16:02:23,543][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:02:37,277][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:02:51,379][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:03:07,700][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:03:23,378][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:03:36,388][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:03:52,745][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:04:06,245][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:04:19,170][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:04:30,626][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:04:45,683][root][INFO] - Processing question number 40
[2025-03-06 16:04:45,687][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:04:59,611][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:05:12,474][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:05:27,200][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:05:39,095][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:05:59,823][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:06:12,598][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:06:25,996][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:06:41,933][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:06:55,800][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:07:09,833][root][INFO] - Processing question number 50
[2025-03-06 16:07:09,837][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:07:24,845][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:07:38,803][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:07:54,156][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:08:08,653][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:08:23,492][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:08:39,778][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:08:52,928][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:09:06,961][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:09:19,906][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:09:35,844][root][INFO] - Processing question number 60
[2025-03-06 16:09:35,848][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:09:49,556][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:10:06,732][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:10:21,355][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:10:36,984][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:10:51,969][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:11:07,141][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:11:19,584][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:11:32,253][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:11:47,188][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:11:58,988][root][INFO] - Processing question number 70
[2025-03-06 16:11:58,993][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:12:14,060][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:12:29,402][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:12:44,809][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:13:01,507][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:13:14,080][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:13:29,582][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:13:46,336][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:14:01,453][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:14:14,234][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:14:29,694][root][INFO] - Processing question number 80
[2025-03-06 16:14:29,700][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:14:43,423][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:14:57,915][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:15:13,499][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:15:27,579][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:15:42,954][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:15:59,099][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:16:13,672][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:16:29,554][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:16:43,546][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:16:56,720][root][INFO] - Processing question number 90
[2025-03-06 16:16:56,726][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:17:11,019][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:17:24,550][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:17:37,253][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:17:51,272][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:18:06,768][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:18:25,033][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:18:39,705][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:18:52,822][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:19:05,310][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:19:21,978][root][INFO] - Inference complete
[2025-03-06 16:19:21,979][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:21,987][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:21,993][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:21,993][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:21,994][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:21,994][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:21,995][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:21,995][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:22,002][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,009][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,009][root][INFO] - Saved parsed outputs
[2025-03-06 16:19:22,009][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,010][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,010][root][INFO] - Saved parsing metadata
[2025-03-06 16:19:22,012][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,013][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:19:22,015][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:19:22,045][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 16:19:22,045][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 18, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 16:19:30,460][root][INFO] - Setting global seed to 989
[2025-03-06 16:19:30,467][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:19:30,467][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:19:30,468][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:19:30,470][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:19:30,474][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:19:30,474][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:19:30,641][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:19:31,225][root][INFO] - Full model selected, loading model
[2025-03-06 16:19:56,337][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:19:56,352][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:20:04,429][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:20:04,431][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:20:04,431][root][INFO] - Starting inference
[2025-03-06 16:20:04,621][root][INFO] - Processing question number 0
[2025-03-06 16:20:04,623][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:20:21,567][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:20:34,968][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:20:51,857][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:21:05,063][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:21:18,915][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:21:31,378][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:21:44,757][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:21:57,586][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:22:09,507][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:22:22,697][root][INFO] - Processing question number 10
[2025-03-06 16:22:22,705][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:22:34,314][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:22:48,963][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:23:00,330][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:23:13,587][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:23:25,443][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:23:40,843][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:23:54,138][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:24:09,274][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:24:23,866][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:24:38,823][root][INFO] - Processing question number 20
[2025-03-06 16:24:38,826][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:24:51,104][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:25:04,969][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:25:18,311][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:25:30,205][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:25:42,052][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:25:55,948][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:26:09,685][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:26:22,494][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:26:36,232][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:26:53,791][root][INFO] - Processing question number 30
[2025-03-06 16:26:53,794][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:27:07,125][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:27:20,546][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:27:35,042][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:27:51,727][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:28:05,061][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:28:17,353][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:28:31,742][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:28:46,958][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:28:59,302][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:29:13,764][root][INFO] - Processing question number 40
[2025-03-06 16:29:13,767][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:29:26,752][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:29:38,745][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:29:53,863][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:30:06,101][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:30:24,756][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:30:36,653][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:30:50,083][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:31:01,083][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:31:14,916][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:31:28,824][root][INFO] - Processing question number 50
[2025-03-06 16:31:28,827][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:31:44,744][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:31:59,139][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:32:11,943][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:32:24,674][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:32:37,775][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:32:51,389][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:33:07,618][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:33:20,815][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:33:33,894][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:33:49,554][root][INFO] - Processing question number 60
[2025-03-06 16:33:49,558][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:34:03,403][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:34:16,613][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:34:33,156][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:34:46,659][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:34:59,566][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:35:15,117][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:35:26,782][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:35:39,437][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:35:52,216][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:36:06,270][root][INFO] - Processing question number 70
[2025-03-06 16:36:06,275][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:36:20,902][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:36:35,402][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:36:51,981][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:37:08,041][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:37:19,500][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:37:33,639][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:37:50,815][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:38:07,940][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:38:19,209][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:38:32,976][root][INFO] - Processing question number 80
[2025-03-06 16:38:32,981][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:38:46,786][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:39:00,427][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:39:16,666][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:39:29,691][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:39:44,333][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:40:00,594][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:40:15,099][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:40:28,534][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:40:43,078][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:40:56,149][root][INFO] - Processing question number 90
[2025-03-06 16:40:56,154][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:41:08,853][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:41:23,417][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:41:35,170][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:41:48,128][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:42:02,508][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:42:15,454][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:42:29,877][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:42:41,964][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:42:55,399][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:43:10,267][root][INFO] - Inference complete
[2025-03-06 16:43:10,267][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,275][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,288][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,294][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,294][root][INFO] - Saved parsed outputs
[2025-03-06 16:43:10,294][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,296][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,296][root][INFO] - Saved parsing metadata
[2025-03-06 16:43:10,297][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,298][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:43:10,300][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:43:10,313][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 16:43:10,313][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.27, 'malformed_label': 0, 'malformed_domain': 45, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 22, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 16:43:17,716][root][INFO] - Setting global seed to 989
[2025-03-06 16:43:17,722][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:43:17,723][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:43:17,724][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:43:17,726][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:43:17,729][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:43:17,729][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:43:17,888][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:43:18,437][root][INFO] - Full model selected, loading model
[2025-03-06 16:43:42,973][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:45:41,014][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:45:41,015][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:46:18,015][root][INFO] - Peft model loaded successfully
[2025-03-06 16:46:25,379][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:46:25,381][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:25,381][root][INFO] - Starting inference
[2025-03-06 16:46:25,631][root][INFO] - Processing question number 0
[2025-03-06 16:46:25,634][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:46:41,122][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:46:56,014][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:47:12,428][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:47:25,771][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:47:38,033][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:47:52,148][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:48:07,357][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:48:20,946][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:48:31,914][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:48:46,157][root][INFO] - Processing question number 10
[2025-03-06 16:48:46,159][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:48:58,513][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:49:12,852][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:49:26,197][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:49:39,978][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:49:55,767][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:50:07,594][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:50:24,626][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:50:39,229][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:50:52,611][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:51:07,137][root][INFO] - Processing question number 20
[2025-03-06 16:51:07,140][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:51:19,676][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:51:34,547][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:51:47,702][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:51:59,549][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:52:13,130][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:52:29,432][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:52:44,882][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:52:59,423][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:53:13,539][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:53:29,415][root][INFO] - Processing question number 30
[2025-03-06 16:53:29,418][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:53:43,238][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:53:56,680][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:54:12,763][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:54:27,593][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:54:42,192][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:55:00,918][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:55:17,507][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:55:30,793][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:55:43,200][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:55:59,246][root][INFO] - Processing question number 40
[2025-03-06 16:55:59,250][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:56:11,581][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:56:24,545][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:56:39,652][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:56:51,747][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:57:09,728][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:57:22,548][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:57:34,455][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:57:47,504][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:58:03,938][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:58:17,402][root][INFO] - Processing question number 50
[2025-03-06 16:58:17,406][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:58:30,028][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:58:46,652][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:59:02,913][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:59:17,778][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:59:31,822][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:59:46,430][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:00:00,089][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:00:15,266][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:00:27,431][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:00:42,041][root][INFO] - Processing question number 60
[2025-03-06 17:00:42,047][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:00:55,959][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:01:11,564][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:01:27,468][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:01:42,704][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:01:59,351][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:02:13,348][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:02:26,538][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:02:39,504][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:02:54,193][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:03:07,657][root][INFO] - Processing question number 70
[2025-03-06 17:03:07,662][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:03:21,906][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:03:39,877][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:03:55,409][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:04:11,568][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:04:24,435][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:04:40,476][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:04:56,938][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:05:12,013][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:05:25,856][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:05:40,567][root][INFO] - Processing question number 80
[2025-03-06 17:05:40,572][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:05:54,423][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:06:10,139][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:06:24,175][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:06:37,949][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:06:54,396][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:07:11,617][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:07:26,162][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:07:42,849][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:07:57,056][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:08:12,149][root][INFO] - Processing question number 90
[2025-03-06 17:08:12,155][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:08:26,717][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:08:40,575][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:08:53,382][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:09:07,980][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:09:23,855][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:09:39,787][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:09:55,175][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:10:07,689][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:10:21,154][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:10:35,098][root][INFO] - Inference complete
[2025-03-06 17:10:35,098][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,105][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,118][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,125][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,125][root][INFO] - Saved parsed outputs
[2025-03-06 17:10:35,125][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,126][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,126][root][INFO] - Saved parsing metadata
[2025-03-06 17:10:35,127][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,129][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:10:35,131][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:10:35,163][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 17:10:35,163][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 20, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 17:10:44,480][root][INFO] - Setting global seed to 989
[2025-03-06 17:10:44,488][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:10:44,488][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:10:44,489][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:10:44,492][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:10:44,495][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:10:44,495][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:10:44,648][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:10:45,231][root][INFO] - Full model selected, loading model
[2025-03-06 17:11:11,157][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:11:11,172][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:11:19,428][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:11:19,430][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:11:19,430][root][INFO] - Starting inference
[2025-03-06 17:11:19,602][root][INFO] - Processing question number 0
[2025-03-06 17:11:19,604][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:11:36,445][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:11:49,712][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:12:06,994][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:12:21,702][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:12:32,716][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:12:44,522][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:12:58,112][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:13:13,116][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:13:24,734][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:13:36,957][root][INFO] - Processing question number 10
[2025-03-06 17:13:36,961][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:13:49,840][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:14:03,064][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:14:17,338][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:14:30,957][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:14:43,578][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:14:56,796][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:15:10,820][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:15:23,521][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:15:36,893][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:15:51,148][root][INFO] - Processing question number 20
[2025-03-06 17:15:51,150][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:16:05,039][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:16:18,592][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:16:31,932][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:16:42,795][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:16:54,474][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:17:06,563][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:17:22,548][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:17:34,829][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:17:47,838][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:18:04,632][root][INFO] - Processing question number 30
[2025-03-06 17:18:04,635][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:18:18,531][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:18:31,998][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:18:44,662][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:19:00,490][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:19:12,899][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:19:28,637][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:19:42,215][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:19:56,723][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:20:07,682][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:20:23,398][root][INFO] - Processing question number 40
[2025-03-06 17:20:23,401][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:20:35,463][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:20:46,922][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:21:00,845][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:21:12,503][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:21:29,398][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:21:38,977][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:21:52,139][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:22:03,627][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:22:19,925][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:22:33,098][root][INFO] - Processing question number 50
[2025-03-06 17:22:33,102][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:22:48,038][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:23:02,083][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:23:16,288][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:23:32,069][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:23:49,171][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:24:01,709][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:24:15,822][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:24:29,072][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:24:44,322][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:24:59,021][root][INFO] - Processing question number 60
[2025-03-06 17:24:59,025][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:25:13,643][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:25:28,085][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:25:45,598][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:25:59,726][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:26:12,786][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:26:27,276][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:26:40,305][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:26:51,689][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:27:05,377][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:27:18,109][root][INFO] - Processing question number 70
[2025-03-06 17:27:18,114][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:27:32,546][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:27:48,246][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:28:03,552][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:28:19,173][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:28:32,483][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:28:46,952][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:29:00,435][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:29:16,473][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:29:28,110][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:29:40,940][root][INFO] - Processing question number 80
[2025-03-06 17:29:40,945][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:29:52,065][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:30:03,584][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:30:18,475][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:30:31,238][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:30:46,327][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:31:02,469][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:31:16,250][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:31:32,753][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:31:46,293][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:32:00,275][root][INFO] - Processing question number 90
[2025-03-06 17:32:00,280][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:32:13,417][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:32:27,042][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:32:42,000][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:32:55,490][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:33:09,663][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:33:23,998][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:33:37,603][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:33:49,379][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:34:02,521][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:34:17,300][root][INFO] - Inference complete
[2025-03-06 17:34:17,300][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,308][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,316][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:17,317][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:17,318][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:17,322][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,328][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,328][root][INFO] - Saved parsed outputs
[2025-03-06 17:34:17,328][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,329][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,329][root][INFO] - Saved parsing metadata
[2025-03-06 17:34:17,330][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,332][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:34:17,333][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:34:17,357][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 17:34:17,357][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.22, 'malformed_label': 0, 'malformed_domain': 58, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.06, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.08, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 20, 'correct_label_wrong_domain': 29, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 17:34:24,324][root][INFO] - Setting global seed to 989
[2025-03-06 17:34:24,329][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:34:24,329][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:34:24,331][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:34:24,333][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:34:24,336][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:34:24,336][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:34:24,493][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:34:25,068][root][INFO] - Full model selected, loading model
[2025-03-06 17:34:51,288][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:36:50,621][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:36:50,621][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:37:26,628][root][INFO] - Peft model loaded successfully
[2025-03-06 17:37:34,114][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:37:34,116][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:37:34,116][root][INFO] - Starting inference
[2025-03-06 17:37:34,342][root][INFO] - Processing question number 0
[2025-03-06 17:37:34,344][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:37:49,925][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:38:03,915][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:38:20,157][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:38:33,430][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:38:47,508][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:39:00,140][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:39:15,185][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:39:29,777][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:39:40,651][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:39:56,593][root][INFO] - Processing question number 10
[2025-03-06 17:39:56,595][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:40:09,475][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:40:23,797][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:40:38,146][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:40:50,573][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:41:05,435][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:41:18,869][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:41:31,770][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:41:48,547][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:42:01,730][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:42:15,021][root][INFO] - Processing question number 20
[2025-03-06 17:42:15,023][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:42:27,209][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:42:42,246][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:42:54,290][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:43:05,376][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:43:18,968][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:43:33,874][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:43:48,409][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:44:02,844][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:44:14,154][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:44:29,623][root][INFO] - Processing question number 30
[2025-03-06 17:44:29,626][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:44:43,450][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:44:56,132][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:45:11,402][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:45:25,447][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:45:38,868][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:45:54,379][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:46:10,214][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:46:23,455][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:46:34,846][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:46:48,735][root][INFO] - Processing question number 40
[2025-03-06 17:46:48,739][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:47:01,029][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:47:15,502][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:47:30,302][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:47:42,302][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:47:58,767][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:48:08,940][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:48:23,530][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:48:36,394][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:48:51,402][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:49:07,059][root][INFO] - Processing question number 50
[2025-03-06 17:49:07,063][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:49:20,893][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:49:38,514][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:49:54,458][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:50:07,164][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:50:20,703][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:50:33,727][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:50:46,833][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:51:03,424][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:51:16,566][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:51:31,140][root][INFO] - Processing question number 60
[2025-03-06 17:51:31,144][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:51:43,775][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:51:59,955][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:52:15,811][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:52:31,315][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:52:45,895][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:53:00,925][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:53:15,857][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:53:28,473][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:53:43,981][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:53:56,683][root][INFO] - Processing question number 70
[2025-03-06 17:53:56,688][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:54:10,160][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:54:23,247][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:54:37,853][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:54:54,477][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:55:06,840][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:55:23,303][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:55:39,295][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:55:57,048][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:56:10,939][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:56:28,072][root][INFO] - Processing question number 80
[2025-03-06 17:56:28,077][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:56:41,907][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:56:57,190][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:57:11,275][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:57:24,835][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:57:39,950][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:57:56,024][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:58:11,027][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:58:29,564][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:58:43,623][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:58:57,189][root][INFO] - Processing question number 90
[2025-03-06 17:58:57,195][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:59:11,490][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:59:25,495][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:59:39,173][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:59:54,905][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:00:10,251][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:00:25,193][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:00:39,752][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:00:52,209][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:01:03,278][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:01:20,976][root][INFO] - Inference complete
[2025-03-06 18:01:20,977][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:20,985][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:20,994][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:01:20,994][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:01:20,995][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:01:20,999][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,005][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,005][root][INFO] - Saved parsed outputs
[2025-03-06 18:01:21,005][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,007][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,007][root][INFO] - Saved parsing metadata
[2025-03-06 18:01:21,008][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,009][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:01:21,011][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:01:21,053][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 18:01:21,053][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.32, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 21, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 2 to status running with exit code None
Eval status update completed for job 2
[2025-03-06 18:01:44,550][root][INFO] - Setting global seed to 989
[2025-03-06 18:01:44,557][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:01:44,557][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:01:44,559][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:01:44,561][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:01:44,578][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:01:44,578][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:01:44,743][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:01:45,319][root][INFO] - Full model selected, loading model
[2025-03-06 18:02:15,563][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:02:15,581][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:02:23,703][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:02:23,704][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:02:23,704][root][INFO] - Starting inference
[2025-03-06 18:02:23,895][root][INFO] - Processing question number 0
[2025-03-06 18:02:23,897][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:02:39,213][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:02:52,820][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:03:09,826][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:03:26,764][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:03:40,832][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:03:53,175][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:04:05,958][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:04:18,807][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:04:31,556][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:04:45,080][root][INFO] - Processing question number 10
[2025-03-06 18:04:45,082][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:04:59,500][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:05:14,186][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:05:26,583][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:05:41,243][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:05:55,592][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:06:09,028][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:06:24,589][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:06:38,187][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:06:52,060][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:07:06,597][root][INFO] - Processing question number 20
[2025-03-06 18:07:06,600][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:07:18,889][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:07:32,988][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:07:47,485][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:07:58,675][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:08:11,390][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:08:25,624][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:08:39,431][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:08:51,745][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:09:04,268][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:09:18,431][root][INFO] - Processing question number 30
[2025-03-06 18:09:18,434][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:09:31,893][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:09:45,131][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:09:57,922][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:10:14,100][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:10:26,685][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:10:44,275][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:10:59,842][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:11:13,559][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:11:32,100][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:11:48,529][root][INFO] - Processing question number 40
[2025-03-06 18:11:48,532][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:12:00,668][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:12:15,132][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:12:32,482][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:12:42,454][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:12:56,509][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:13:09,441][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:13:21,203][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:13:36,068][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:13:51,326][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:14:05,363][root][INFO] - Processing question number 50
[2025-03-06 18:14:05,367][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:14:19,869][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:14:34,621][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:14:48,802][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:15:02,232][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:15:17,294][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:15:31,606][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:15:47,833][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:16:03,010][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:16:16,262][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:16:31,549][root][INFO] - Processing question number 60
[2025-03-06 18:16:31,553][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:16:44,547][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:17:00,667][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:17:16,677][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:17:30,777][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:17:44,434][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:17:59,782][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:18:11,511][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:18:26,317][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:18:39,167][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:18:53,616][root][INFO] - Processing question number 70
[2025-03-06 18:18:53,621][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:19:05,660][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:19:17,936][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:19:34,795][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:19:51,233][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:20:06,365][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:20:19,204][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:20:36,729][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:20:51,198][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:21:03,794][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:21:19,896][root][INFO] - Processing question number 80
[2025-03-06 18:21:19,902][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:21:35,281][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:21:47,641][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:22:02,427][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:22:16,147][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:22:31,546][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:22:48,195][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:23:06,825][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:23:20,143][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:23:34,344][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:23:47,868][root][INFO] - Processing question number 90
[2025-03-06 18:23:47,873][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:24:01,205][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:24:15,595][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:24:27,326][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:24:40,691][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:24:55,628][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:25:08,764][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:25:24,230][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:25:36,350][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:25:49,991][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:26:05,853][root][INFO] - Inference complete
[2025-03-06 18:26:05,853][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,860][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,861][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,862][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,863][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,863][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,863][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,863][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,865][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,865][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,866][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,866][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,866][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,866][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,867][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,868][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,868][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,870][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,870][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,870][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,871][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,871][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,871][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,874][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,875][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:26:05,875][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,875][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:26:05,876][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:26:05,876][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:26:05,879][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,885][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,886][root][INFO] - Saved parsed outputs
[2025-03-06 18:26:05,886][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,887][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,887][root][INFO] - Saved parsing metadata
[2025-03-06 18:26:05,888][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,889][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:26:05,891][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:26:05,903][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 18:26:05,903][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.15, 'malformed_label': 0, 'malformed_domain': 62, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.07, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.08, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 37, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '2', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 2 to status completed with exit code 0
Eval status update completed for job 2
Job 2 completed at Thu Mar  6 18:26:07 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n515
Job ID: 25358377
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 10:15:40
CPU Efficiency: 9.83% of 4-08:25:50 core-walltime
Job Wall-clock time: 10:26:35
Memory Utilized: 35.90 GB
Memory Efficiency: 99.72% of 36.00 GB
