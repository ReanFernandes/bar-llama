Starting job 1 at Thu Feb 20 15:44:08 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=markdown_fact_first_zero_shot_unstructured train=markdown_fact_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '1', 'training']
Updating job 1 to status training with exit code None
Status update completed for job 1
[2025-02-20 15:46:38,922][root][INFO] - Global seed set to 314
[2025-02-20 15:46:38,925][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 15:46:38,925][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 15:46:38,925][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 15:46:38,926][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 15:46:38,926][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 15:46:38,985][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 15:46:39,380][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 15:46:39,448][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 15:46:39,471][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 15:46:41,106][root][INFO] - Tokenizer meta-llama/Meta-Llama-3-8B-Instruct loaded successfully
[2025-02-20 15:47:17,975][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 15:47:55,094][root][INFO] - Model prepared for kbit training
[2025-02-20 15:47:55,097][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'q_proj', 'o_proj', 'up_proj', 'k_proj', 'down_proj', 'gate_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 15:47:56,858][root][INFO] - Lora adapter added to model
[2025-02-20 15:47:56,861][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_zero_shot_unstructured
[2025-02-20 15:47:57,476][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6634, 'grad_norm': 0.5059434771537781, 'learning_rate': 3.226975564787322e-05, 'epoch': 10.0}
{'train_runtime': 327.8409, 'train_samples_per_second': 0.32, 'train_steps_per_second': 0.046, 'train_loss': 1.465696652730306, 'epoch': 15.0}
[2025-02-20 15:53:33,606][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '1', 'trained', '0']
Updating job 1 to status trained with exit code 0
Status update completed for job 1
Starting evaluations for job 1
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
[2025-02-20 15:53:53,828][root][INFO] - Setting global seed to 206
[2025-02-20 15:53:53,836][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 15:53:53,836][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 15:53:53,838][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 15:53:53,846][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 15:53:53,853][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 15:53:53,853][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 15:53:54,004][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 15:53:54,607][root][INFO] - Full model selected, loading model
[2025-02-20 15:54:23,246][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 15:56:05,322][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 15:56:05,325][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 15:56:37,894][root][INFO] - Peft model loaded successfully
[2025-02-20 15:56:45,637][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 15:56:45,640][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 15:56:45,640][root][INFO] - Starting inference
[2025-02-20 15:56:46,016][root][INFO] - Processing question number 0
[2025-02-20 15:56:46,018][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 15:56:53,649][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 15:57:10,153][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 15:57:16,266][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 15:57:29,482][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 15:57:38,086][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 15:58:02,968][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 15:58:12,177][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 15:58:32,518][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 15:58:38,340][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 15:58:45,204][root][INFO] - Processing question number 10
[2025-02-20 15:58:45,206][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 15:58:52,755][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 15:59:20,724][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 15:59:25,448][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 15:59:30,421][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 15:59:56,412][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 16:00:04,079][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 16:00:32,048][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 16:00:38,983][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 16:01:00,573][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 16:01:06,362][root][INFO] - Processing question number 20
[2025-02-20 16:01:06,364][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 16:01:15,837][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 16:01:29,942][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 16:01:34,064][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 16:01:40,909][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 16:01:50,428][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 16:02:03,292][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 16:02:10,626][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 16:02:17,479][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 16:02:45,910][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 16:02:50,913][root][INFO] - Processing question number 30
[2025-02-20 16:02:50,915][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 16:03:19,369][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 16:03:28,887][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 16:03:35,465][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 16:03:41,810][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 16:03:48,103][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 16:03:54,896][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 16:04:00,698][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 16:04:09,351][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 16:04:25,044][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 16:04:33,898][root][INFO] - Processing question number 40
[2025-02-20 16:04:33,901][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 16:04:39,795][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 16:04:50,324][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 16:05:02,840][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 16:05:21,701][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 16:05:28,951][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 16:05:42,504][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 16:06:11,858][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 16:06:16,206][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 16:06:23,744][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 16:06:27,901][root][INFO] - Processing question number 50
[2025-02-20 16:06:27,904][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 16:06:38,093][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 16:06:57,455][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 16:07:03,879][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 16:07:23,158][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 16:07:42,422][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 16:07:58,890][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 16:08:06,297][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 16:08:11,320][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 16:08:40,172][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 16:08:48,830][root][INFO] - Processing question number 60
[2025-02-20 16:08:48,834][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 16:08:59,390][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 16:09:27,736][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 16:09:56,506][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 16:10:01,265][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 16:10:19,437][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 16:10:36,685][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 16:10:43,442][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 16:10:49,766][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 16:11:01,148][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 16:11:10,339][root][INFO] - Processing question number 70
[2025-02-20 16:11:10,343][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 16:11:16,106][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 16:11:19,982][root][INFO] - Domain : Property, Question : 6
[2025-02-20 16:11:24,350][root][INFO] - Domain : Property, Question : 13
[2025-02-20 16:11:37,608][root][INFO] - Domain : Property, Question : 20
[2025-02-20 16:12:06,330][root][INFO] - Domain : Property, Question : 33
[2025-02-20 16:12:12,922][root][INFO] - Domain : Property, Question : 39
[2025-02-20 16:12:21,776][root][INFO] - Domain : Property, Question : 48
[2025-02-20 16:12:50,463][root][INFO] - Domain : Property, Question : 54
[2025-02-20 16:12:59,528][root][INFO] - Domain : Property, Question : 61
[2025-02-20 16:13:14,666][root][INFO] - Processing question number 80
[2025-02-20 16:13:14,670][root][INFO] - Domain : Property, Question : 67
[2025-02-20 16:13:25,239][root][INFO] - Domain : Property, Question : 75
[2025-02-20 16:13:48,164][root][INFO] - Domain : Property, Question : 83
[2025-02-20 16:13:55,545][root][INFO] - Domain : Property, Question : 89
[2025-02-20 16:14:02,717][root][INFO] - Domain : Property, Question : 97
[2025-02-20 16:14:31,573][root][INFO] - Domain : Property, Question : 100
[2025-02-20 16:14:40,908][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 16:14:49,143][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 16:14:58,453][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 16:15:27,096][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 16:15:32,245][root][INFO] - Processing question number 90
[2025-02-20 16:15:32,249][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 16:15:45,001][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 16:15:49,911][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 16:15:57,856][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 16:16:10,191][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 16:16:15,665][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 16:16:19,038][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 16:16:23,582][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 16:16:52,159][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 16:17:01,151][root][INFO] - Inference complete
[2025-02-20 16:17:01,152][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,158][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,158][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-20 16:17:01,159][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-20 16:17:01,159][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-20 16:17:01,159][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-20 16:17:01,160][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-20 16:17:01,160][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-20 16:17:01,160][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-20 16:17:01,160][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-20 16:17:01,160][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-20 16:17:01,161][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-20 16:17:01,161][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-20 16:17:01,161][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-20 16:17:01,161][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 16:17:01,161][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-20 16:17:01,162][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-20 16:17:01,162][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-20 16:17:01,162][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-20 16:17:01,162][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-20 16:17:01,162][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-20 16:17:01,163][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-20 16:17:01,163][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-20 16:17:01,163][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-20 16:17:01,163][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-20 16:17:01,163][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-20 16:17:01,164][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-20 16:17:01,164][root][ERROR] - |Q. 3||D: Contracts| Failed to extract chosen option: 
[2025-02-20 16:17:01,164][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-20 16:17:01,164][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-20 16:17:01,164][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-20 16:17:01,164][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-20 16:17:01,165][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-20 16:17:01,166][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-20 16:17:01,166][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-20 16:17:01,166][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-20 16:17:01,166][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-20 16:17:01,166][root][ERROR] - |Q. 24||D: Torts| Failed to extract chosen option: 
[2025-02-20 16:17:01,166][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-20 16:17:01,167][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-20 16:17:01,167][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-20 16:17:01,167][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-20 16:17:01,167][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-20 16:17:01,167][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-20 16:17:01,168][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-20 16:17:01,168][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-20 16:17:01,168][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-20 16:17:01,168][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-20 16:17:01,168][root][ERROR] - |Q. 12||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:17:01,169][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-20 16:17:01,169][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-20 16:17:01,169][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:17:01,169][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-20 16:17:01,169][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-20 16:17:01,169][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:17:01,169][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-20 16:17:01,170][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-20 16:17:01,171][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-20 16:17:01,171][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-20 16:17:01,171][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-20 16:17:01,171][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-20 16:17:01,171][root][ERROR] - |Q. 20||D: Property| Failed to extract chosen option: 
[2025-02-20 16:17:01,171][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-20 16:17:01,171][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-20 16:17:01,172][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-20 16:17:01,172][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-20 16:17:01,172][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-20 16:17:01,173][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-20 16:17:01,173][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-20 16:17:01,173][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-20 16:17:01,173][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-20 16:17:01,173][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-20 16:17:01,173][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-20 16:17:01,174][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-20 16:17:01,174][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 16:17:01,174][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract chosen option: 
[2025-02-20 16:17:01,174][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-20 16:17:01,174][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-20 16:17:01,174][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-20 16:17:01,175][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-20 16:17:01,175][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-20 16:17:01,175][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract chosen option: 
[2025-02-20 16:17:01,176][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,180][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,180][root][INFO] - Saved parsed outputs
[2025-02-20 16:17:01,180][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,181][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,181][root][INFO] - Saved parsing metadata
[2025-02-20 16:17:01,182][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,197][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 16:17:01,198][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 16:17:01,495][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_1
[2025-02-20 16:17:01,495][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.06060606060606061, 'malformed_label': 23, 'malformed_domain': 84, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 6, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.04040404040404041, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.030303030303030304, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 9, 'correct_label_wrong_domain': 34, 'both_wrong': 50}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-20 16:17:49,225][root][INFO] - Setting global seed to 206
[2025-02-20 16:17:49,297][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-20 16:17:49,297][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 16:17:49,298][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-20 16:17:49,310][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 16:17:49,329][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 16:17:49,329][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-20 16:17:49,491][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 16:17:50,255][root][INFO] - Full model selected, loading model
[2025-02-20 16:18:17,166][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 16:20:00,655][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 16:20:00,657][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 16:20:34,430][root][INFO] - Peft model loaded successfully
[2025-02-20 16:20:41,644][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 16:20:41,646][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:20:41,646][root][INFO] - Starting inference
[2025-02-20 16:20:42,077][root][INFO] - Processing question number 0
[2025-02-20 16:20:42,079][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-20 16:20:58,602][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-20 16:21:27,710][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-20 16:21:39,031][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-20 16:21:50,243][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-20 16:22:03,514][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-20 16:22:12,832][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-20 16:22:18,142][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-20 16:22:24,530][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-20 16:22:35,739][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-20 16:23:04,151][root][INFO] - Processing question number 10
[2025-02-20 16:23:04,153][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-20 16:23:11,175][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-20 16:23:39,540][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-20 16:23:44,186][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-20 16:23:50,073][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-20 16:23:56,800][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-20 16:24:02,057][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 16:24:06,698][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-20 16:24:12,236][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-20 16:24:19,250][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-20 16:24:27,183][root][INFO] - Processing question number 20
[2025-02-20 16:24:27,185][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-20 16:24:39,791][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-20 16:24:44,286][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 16:24:51,127][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-20 16:24:56,711][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-20 16:25:01,662][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-20 16:25:09,359][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-20 16:25:16,523][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-20 16:25:26,367][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 16:25:35,641][root][INFO] - Domain : Contracts, Question : 7
[2025-02-20 16:25:42,302][root][INFO] - Processing question number 30
[2025-02-20 16:25:42,304][root][INFO] - Domain : Contracts, Question : 14
[2025-02-20 16:25:48,220][root][INFO] - Domain : Contracts, Question : 24
[2025-02-20 16:25:53,523][root][INFO] - Domain : Contracts, Question : 28
[2025-02-20 16:26:03,353][root][INFO] - Domain : Contracts, Question : 34
[2025-02-20 16:26:15,859][root][INFO] - Domain : Contracts, Question : 42
[2025-02-20 16:26:28,007][root][INFO] - Domain : Contracts, Question : 48
[2025-02-20 16:26:36,195][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 16:26:43,091][root][INFO] - Domain : Contracts, Question : 65
[2025-02-20 16:26:55,540][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 16:27:02,911][root][INFO] - Domain : Contracts, Question : 77
[2025-02-20 16:27:07,630][root][INFO] - Processing question number 40
[2025-02-20 16:27:07,633][root][INFO] - Domain : Contracts, Question : 84
[2025-02-20 16:27:15,504][root][INFO] - Domain : Contracts, Question : 87
[2025-02-20 16:27:23,447][root][INFO] - Domain : Contracts, Question : 97
[2025-02-20 16:27:31,933][root][INFO] - Domain : Evidence, Question : 4
[2025-02-20 16:27:59,799][root][INFO] - Domain : Evidence, Question : 10
[2025-02-20 16:28:18,258][root][INFO] - Domain : Evidence, Question : 16
[2025-02-20 16:28:32,381][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 16:28:40,552][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 16:28:45,987][root][INFO] - Domain : Evidence, Question : 38
[2025-02-20 16:29:14,453][root][INFO] - Domain : Evidence, Question : 43
[2025-02-20 16:29:19,998][root][INFO] - Processing question number 50
[2025-02-20 16:29:20,000][root][INFO] - Domain : Evidence, Question : 50
[2025-02-20 16:29:27,269][root][INFO] - Domain : Evidence, Question : 51
[2025-02-20 16:29:30,273][root][INFO] - Domain : Evidence, Question : 60
[2025-02-20 16:29:40,982][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 16:29:56,692][root][INFO] - Domain : Evidence, Question : 80
[2025-02-20 16:30:03,267][root][INFO] - Domain : Evidence, Question : 85
[2025-02-20 16:30:18,085][root][INFO] - Domain : Evidence, Question : 90
[2025-02-20 16:30:46,969][root][INFO] - Domain : Evidence, Question : 98
[2025-02-20 16:30:56,220][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-20 16:31:05,304][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-20 16:31:12,242][root][INFO] - Processing question number 60
[2025-02-20 16:31:12,245][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-20 16:31:20,474][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-20 16:31:31,737][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-20 16:32:00,869][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-20 16:32:09,386][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-20 16:32:15,890][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-20 16:32:29,307][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-20 16:32:35,897][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-20 16:32:43,741][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-20 16:32:57,221][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-20 16:33:06,866][root][INFO] - Processing question number 70
[2025-02-20 16:33:06,869][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-20 16:33:35,547][root][INFO] - Domain : Property, Question : 9
[2025-02-20 16:33:46,920][root][INFO] - Domain : Property, Question : 17
[2025-02-20 16:34:01,729][root][INFO] - Domain : Property, Question : 25
[2025-02-20 16:34:30,827][root][INFO] - Domain : Property, Question : 30
[2025-02-20 16:34:58,868][root][INFO] - Domain : Property, Question : 36
[2025-02-20 16:35:07,616][root][INFO] - Domain : Property, Question : 46
[2025-02-20 16:35:36,988][root][INFO] - Domain : Property, Question : 53
[2025-02-20 16:35:51,008][root][INFO] - Domain : Property, Question : 59
[2025-02-20 16:35:58,273][root][INFO] - Domain : Property, Question : 66
[2025-02-20 16:36:04,437][root][INFO] - Processing question number 80
[2025-02-20 16:36:04,441][root][INFO] - Domain : Property, Question : 69
[2025-02-20 16:36:13,775][root][INFO] - Domain : Property, Question : 81
[2025-02-20 16:36:42,700][root][INFO] - Domain : Property, Question : 88
[2025-02-20 16:36:50,035][root][INFO] - Domain : Property, Question : 91
[2025-02-20 16:36:57,120][root][INFO] - Domain : Property, Question : 94
[2025-02-20 16:37:14,083][root][INFO] - Domain : Property, Question : 100
[2025-02-20 16:37:28,966][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 16:37:45,069][root][INFO] - Domain : Torts, Question : 18
[2025-02-20 16:38:00,104][root][INFO] - Domain : Torts, Question : 22
[2025-02-20 16:38:12,365][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 16:38:24,755][root][INFO] - Processing question number 90
[2025-02-20 16:38:24,759][root][INFO] - Domain : Torts, Question : 39
[2025-02-20 16:38:32,765][root][INFO] - Domain : Torts, Question : 45
[2025-02-20 16:38:43,146][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 16:38:49,896][root][INFO] - Domain : Torts, Question : 57
[2025-02-20 16:38:54,284][root][INFO] - Domain : Torts, Question : 63
[2025-02-20 16:39:03,752][root][INFO] - Domain : Torts, Question : 67
[2025-02-20 16:39:17,893][root][INFO] - Domain : Torts, Question : 74
[2025-02-20 16:39:35,275][root][INFO] - Domain : Torts, Question : 79
[2025-02-20 16:39:45,035][root][INFO] - Domain : Torts, Question : 92
[2025-02-20 16:39:54,451][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 16:40:23,321][root][INFO] - Inference complete
[2025-02-20 16:40:23,321][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,326][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,326][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-20 16:40:23,327][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-20 16:40:23,327][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 16:40:23,327][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-20 16:40:23,327][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-20 16:40:23,327][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-20 16:40:23,327][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-20 16:40:23,328][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-20 16:40:23,328][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-20 16:40:23,328][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-20 16:40:23,328][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 16:40:23,328][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-20 16:40:23,328][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-20 16:40:23,329][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-20 16:40:23,329][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-20 16:40:23,329][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-20 16:40:23,329][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-20 16:40:23,329][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-20 16:40:23,329][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-20 16:40:23,330][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-20 16:40:23,331][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-20 16:40:23,332][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-20 16:40:23,332][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-20 16:40:23,333][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-20 16:40:23,333][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-20 16:40:23,333][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-20 16:40:23,333][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-20 16:40:23,333][root][ERROR] - |Q. 4||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:40:23,333][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-20 16:40:23,334][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-20 16:40:23,334][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-20 16:40:23,334][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-20 16:40:23,334][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-20 16:40:23,334][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-20 16:40:23,334][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:40:23,334][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-20 16:40:23,335][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-20 16:40:23,335][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-20 16:40:23,335][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-20 16:40:23,335][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-20 16:40:23,336][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-20 16:40:23,336][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-20 16:40:23,336][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-20 16:40:23,336][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-20 16:40:23,336][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-20 16:40:23,337][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 16:40:23,337][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-20 16:40:23,337][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-20 16:40:23,337][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-20 16:40:23,337][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-20 16:40:23,337][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-20 16:40:23,337][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-20 16:40:23,338][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-20 16:40:23,338][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-20 16:40:23,338][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-20 16:40:23,338][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-20 16:40:23,338][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-20 16:40:23,338][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-20 16:40:23,338][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-20 16:40:23,339][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-20 16:40:23,339][root][ERROR] - |Q. 25||D: Property| Failed to extract chosen option: 
[2025-02-20 16:40:23,339][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-20 16:40:23,339][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-20 16:40:23,339][root][ERROR] - |Q. 30||D: Property| Failed to extract chosen option: 
[2025-02-20 16:40:23,339][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-20 16:40:23,339][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-20 16:40:23,339][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-20 16:40:23,340][root][ERROR] - |Q. 46||D: Property| Failed to extract chosen option: 
[2025-02-20 16:40:23,340][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-20 16:40:23,340][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-20 16:40:23,340][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-20 16:40:23,340][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-20 16:40:23,340][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-20 16:40:23,340][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-20 16:40:23,341][root][ERROR] - |Q. 81||D: Property| Failed to extract chosen option: 
[2025-02-20 16:40:23,341][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-20 16:40:23,341][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-20 16:40:23,341][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-20 16:40:23,341][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-20 16:40:23,341][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-20 16:40:23,342][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-20 16:40:23,343][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-20 16:40:23,343][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-20 16:40:23,343][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-20 16:40:23,343][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-20 16:40:23,343][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-20 16:40:23,343][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-20 16:40:23,344][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-20 16:40:23,344][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,348][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,349][root][INFO] - Saved parsed outputs
[2025-02-20 16:40:23,349][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,350][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,350][root][INFO] - Saved parsing metadata
[2025-02-20 16:40:23,350][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,352][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
[2025-02-20 16:40:23,353][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-20 16:40:23,462][root][INFO] - Evaluation completed for markdown_fact_first_zero_shot_unstructured, on test_set_2
[2025-02-20 16:40:23,462][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.04, 'malformed_label': 26, 'malformed_domain': 93, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.02, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 3, 'correct_label_wrong_domain': 43, 'both_wrong': 50}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Job 1 completed at Thu Feb 20 16:40:32 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n507
Job ID: 25308709
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 00:51:24
CPU Efficiency: 9.03% of 09:29:10 core-walltime
Job Wall-clock time: 00:56:55
Memory Utilized: 34.56 GB
Memory Efficiency: 96.00% of 36.00 GB
