Starting job 1 at Thu Feb 20 22:32:38 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=number_list_answer_first_few_shot_structured train=number_list_answer_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '1', 'training']
Updating job 1 to status training with exit code None
Status update completed for job 1
[2025-02-20 22:35:11,590][root][INFO] - Global seed set to 314
[2025-02-20 22:35:11,592][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:35:11,592][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:35:11,593][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:35:11,593][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:35:11,593][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-02-20 22:35:11,648][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:35:12,124][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:35:12,199][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:35:12,252][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:35:13,540][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:35:44,558][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:36:20,084][root][INFO] - Model prepared for kbit training
[2025-02-20 22:36:20,085][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'down_proj', 'up_proj', 'v_proj', 'o_proj', 'k_proj', 'gate_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:36:21,929][root][INFO] - Lora adapter added to model
[2025-02-20 22:36:21,935][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_answer_first_few_shot_structured
[2025-02-20 22:36:22,328][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4348, 'grad_norm': 0.14793196320533752, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.2731, 'grad_norm': 0.2192729413509369, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.1372, 'grad_norm': 0.20875732600688934, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.025, 'grad_norm': 0.26266446709632874, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8308, 'grad_norm': 0.23516549170017242, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 380.4042, 'train_samples_per_second': 0.276, 'train_steps_per_second': 0.039, 'train_loss': 1.1401761531829835, 'epoch': 15.0}
[2025-02-20 22:42:46,785][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_answer_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '1', 'trained', '0']
Updating job 1 to status trained with exit code 0
Status update completed for job 1
Starting evaluations for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-20 22:43:01,854][root][INFO] - Setting global seed to 206
[2025-02-20 22:43:01,859][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 22:43:01,860][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:43:01,861][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 22:43:01,895][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:43:01,897][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 22:43:01,898][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 22:43:02,047][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 22:43:02,299][root][INFO] - Full model selected, loading model
[2025-02-20 22:43:17,848][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 22:44:19,992][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 22:44:19,993][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 22:45:01,090][root][INFO] - Peft model loaded successfully
[2025-02-20 22:45:10,394][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 22:45:10,396][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 22:45:10,396][root][INFO] - Starting inference
[2025-02-20 22:45:10,700][root][INFO] - Processing question number 0
[2025-02-20 22:45:10,711][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 22:45:42,236][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 22:46:13,610][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 22:46:44,528][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 22:47:15,969][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 22:47:46,755][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 22:48:20,921][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 22:48:52,416][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 22:49:23,380][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 22:49:53,918][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 22:50:25,211][root][INFO] - Processing question number 10
[2025-02-20 22:50:25,214][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 22:50:57,867][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 22:51:28,224][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 22:51:59,116][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 22:52:30,609][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 22:53:02,085][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 22:53:32,503][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 22:54:02,865][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 22:54:33,727][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 22:55:04,553][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 22:55:35,121][root][INFO] - Processing question number 20
[2025-02-20 22:55:35,124][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 22:56:05,937][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 22:56:36,943][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 22:57:07,403][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 22:57:37,791][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 22:58:08,867][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 22:58:39,732][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 22:59:11,375][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 22:59:42,203][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:00:13,156][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:00:43,381][root][INFO] - Processing question number 30
[2025-02-20 23:00:43,385][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:01:14,514][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:01:45,967][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:02:16,902][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:02:47,776][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:03:18,542][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:03:50,089][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:04:20,923][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:04:52,110][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:05:23,047][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:05:54,698][root][INFO] - Processing question number 40
[2025-02-20 23:05:54,702][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:06:25,678][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:06:56,640][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:07:28,111][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:07:59,531][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:08:30,153][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:09:01,099][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:09:33,351][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:10:03,364][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:10:34,197][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:11:05,704][root][INFO] - Processing question number 50
[2025-02-20 23:11:05,709][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:11:37,412][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:12:08,484][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:12:38,736][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:13:10,723][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:13:41,758][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:14:11,795][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:14:43,472][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:15:13,925][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:15:45,441][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:16:17,741][root][INFO] - Processing question number 60
[2025-02-20 23:16:17,746][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:16:48,175][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:17:18,954][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:17:50,369][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:18:20,766][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:18:51,688][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:19:22,692][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:19:53,812][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:20:25,270][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:20:56,452][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:21:28,176][root][INFO] - Processing question number 70
[2025-02-20 23:21:28,182][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:21:59,026][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:22:29,859][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:23:00,471][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:23:31,768][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:24:03,005][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:24:33,508][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:25:04,854][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:25:35,944][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:26:07,309][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:26:38,075][root][INFO] - Processing question number 80
[2025-02-20 23:26:38,081][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:27:09,213][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:27:40,361][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:28:11,005][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:28:41,702][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:29:13,195][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:29:44,515][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:30:15,906][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:30:46,546][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:31:17,626][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:31:48,022][root][INFO] - Processing question number 90
[2025-02-20 23:31:48,028][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:32:19,887][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:32:49,809][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:33:20,621][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:33:50,690][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:34:22,076][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:34:52,459][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:35:23,155][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:35:54,173][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:36:25,691][root][INFO] - Inference complete
[2025-02-20 23:36:25,691][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,700][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,717][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,724][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,724][root][INFO] - Saved parsed outputs
[2025-02-20 23:36:25,724][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,726][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,726][root][INFO] - Saved parsing metadata
[2025-02-20 23:36:25,727][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,729][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:25,732][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:36:25,746][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-20 23:36:25,746][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 11, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-20 23:36:32,039][root][INFO] - Setting global seed to 206
[2025-02-20 23:36:32,044][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:36:32,045][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:36:32,046][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:36:32,048][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:36:32,050][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:36:32,050][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:36:32,195][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:36:32,575][root][INFO] - Full model selected, loading model
[2025-02-20 23:36:48,778][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:36:48,779][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:36:58,288][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:36:58,290][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-20 23:36:58,291][root][INFO] - Starting inference
[2025-02-20 23:36:58,491][root][INFO] - Processing question number 0
[2025-02-20 23:36:58,493][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:37:29,057][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:38:00,271][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:38:30,991][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:39:02,104][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:39:32,628][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:40:03,100][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:40:34,401][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:41:05,201][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:41:35,626][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:42:06,695][root][INFO] - Processing question number 10
[2025-02-20 23:42:06,697][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:42:39,158][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:43:09,347][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:43:40,114][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:44:11,486][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:44:42,837][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:45:13,149][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:45:43,324][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:46:13,997][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:46:44,636][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:47:15,056][root][INFO] - Processing question number 20
[2025-02-20 23:47:15,060][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:47:45,687][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:48:16,556][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:48:46,859][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:49:17,052][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:49:48,004][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:50:18,691][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:50:50,207][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:51:20,833][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:51:51,670][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:52:21,784][root][INFO] - Processing question number 30
[2025-02-20 23:52:21,787][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:52:52,815][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:53:24,262][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:53:55,224][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:54:25,967][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:54:56,588][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:55:27,941][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:55:58,529][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:56:29,529][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:57:00,325][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:57:31,842][root][INFO] - Processing question number 40
[2025-02-20 23:57:31,846][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:58:02,686][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:58:33,532][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:59:04,881][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:59:36,185][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:00:06,697][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:00:37,524][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:01:09,647][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:01:39,550][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:02:10,195][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:02:41,594][root][INFO] - Processing question number 50
[2025-02-21 00:02:41,600][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:03:13,171][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:03:44,107][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:04:14,232][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:04:46,095][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:05:17,001][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:05:46,924][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:06:18,457][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:06:48,774][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:07:20,166][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:07:52,343][root][INFO] - Processing question number 60
[2025-02-21 00:07:52,348][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:08:22,655][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:08:53,275][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:09:24,586][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:09:54,888][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:10:25,837][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:10:56,834][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:11:27,852][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:11:59,140][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:12:30,161][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:13:01,675][root][INFO] - Processing question number 70
[2025-02-21 00:13:01,680][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:13:32,260][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:14:02,876][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:14:33,378][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:15:04,475][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:15:35,528][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:16:05,910][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:16:37,165][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:17:08,172][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:17:39,425][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:18:10,014][root][INFO] - Processing question number 80
[2025-02-21 00:18:10,020][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:18:41,061][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:19:12,094][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:19:42,601][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:20:13,160][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:20:44,550][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:21:15,666][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:21:46,949][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:22:17,488][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:22:48,485][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:23:18,738][root][INFO] - Processing question number 90
[2025-02-21 00:23:18,746][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:23:50,503][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:24:20,267][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:24:50,904][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:25:20,873][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:25:52,146][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:26:22,390][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:26:52,983][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:27:23,989][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:27:55,478][root][INFO] - Inference complete
[2025-02-21 00:27:55,479][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,486][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,487][root][WARNING] - No match found for 5. Rule Application in question number 7 in domain Civil_procedure
[2025-02-21 00:27:55,487][root][WARNING] - No match found for 6. Legal Conclusion in question number 7 in domain Civil_procedure
[2025-02-21 00:27:55,502][root][WARNING] - No match found for 6. Legal Conclusion in question number 100 in domain Property
[2025-02-21 00:27:55,506][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,512][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,512][root][INFO] - Saved parsed outputs
[2025-02-21 00:27:55,512][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,514][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,514][root][INFO] - Saved parsing metadata
[2025-02-21 00:27:55,515][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,516][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:27:55,517][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:27:55,529][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 00:27:55,529][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 0, 'malformed_domain': 21, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5714285714285714, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.5, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 8, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 00:28:02,015][root][INFO] - Setting global seed to 206
[2025-02-21 00:28:02,021][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:28:02,021][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:28:02,022][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:28:02,024][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:28:02,026][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:28:02,026][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:28:02,176][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:28:02,448][root][INFO] - Full model selected, loading model
[2025-02-21 00:28:19,176][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:29:18,426][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:29:18,426][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:29:53,347][root][INFO] - Peft model loaded successfully
[2025-02-21 00:30:01,473][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:30:01,475][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 00:30:01,475][root][INFO] - Starting inference
[2025-02-21 00:30:01,716][root][INFO] - Processing question number 0
[2025-02-21 00:30:01,718][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:30:32,627][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:31:03,971][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:31:34,844][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:32:06,218][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:32:36,958][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:33:07,623][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:33:39,161][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:34:10,196][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:34:40,851][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:35:12,244][root][INFO] - Processing question number 10
[2025-02-21 00:35:12,246][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:35:44,965][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:36:15,420][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:36:46,412][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:37:17,981][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:37:49,542][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:38:20,066][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:38:50,514][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:39:21,465][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:39:52,377][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:40:23,016][root][INFO] - Processing question number 20
[2025-02-21 00:40:23,019][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:40:53,915][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:41:25,012][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:41:55,543][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:42:26,083][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:42:57,264][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:43:28,219][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:43:59,958][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:44:30,904][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:45:01,923][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:45:32,216][root][INFO] - Processing question number 30
[2025-02-21 00:45:32,220][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:46:03,402][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:46:35,060][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:47:06,222][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:47:37,121][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:48:07,806][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:48:39,265][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:49:10,015][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:49:41,186][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:50:12,164][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:50:43,884][root][INFO] - Processing question number 40
[2025-02-21 00:50:43,888][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:51:14,934][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:51:45,969][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:52:17,501][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:52:48,974][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:53:19,654][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:53:50,651][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:54:22,934][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:54:53,024][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:55:23,911][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:55:55,474][root][INFO] - Processing question number 50
[2025-02-21 00:55:55,477][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:56:27,239][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:56:58,359][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:57:28,662][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:58:00,720][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:58:31,812][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:59:01,923][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:59:33,649][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:00:04,162][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:00:35,737][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:01:08,097][root][INFO] - Processing question number 60
[2025-02-21 01:01:08,102][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:01:38,579][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:02:09,436][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:02:40,918][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:03:11,388][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:03:42,363][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:04:13,390][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:04:44,443][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:05:15,832][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:05:46,952][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:06:18,612][root][INFO] - Processing question number 70
[2025-02-21 01:06:18,618][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:06:49,436][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:07:20,296][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:07:50,975][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:08:22,335][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:08:53,652][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:09:24,204][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:09:55,619][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:10:26,787][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:10:58,197][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:11:29,004][root][INFO] - Processing question number 80
[2025-02-21 01:11:29,011][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:12:00,208][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:12:31,391][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:13:02,081][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:13:32,813][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:14:04,360][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:14:35,726][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:15:07,152][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:15:37,837][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:16:08,977][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:16:39,440][root][INFO] - Processing question number 90
[2025-02-21 01:16:39,446][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:17:11,346][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:17:41,323][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:18:12,188][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:18:42,312][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:19:13,741][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:19:44,196][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:20:14,975][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:20:46,044][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:21:17,617][root][INFO] - Inference complete
[2025-02-21 01:21:17,617][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,624][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,641][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,647][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,647][root][INFO] - Saved parsed outputs
[2025-02-21 01:21:17,647][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,648][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,648][root][INFO] - Saved parsing metadata
[2025-02-21 01:21:17,649][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,650][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:17,652][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:21:17,678][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 01:21:17,679][root][INFO] - Summary of metrics : {'label_accuracy': 0.32323232323232326, 'misclassification_rate': 0.6767676767676767, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 4, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 32, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 7, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 01:21:25,060][root][INFO] - Setting global seed to 206
[2025-02-21 01:21:25,066][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:21:25,067][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:21:25,068][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:21:25,069][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:21:25,072][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:21:25,072][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:21:25,222][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:21:25,470][root][INFO] - Full model selected, loading model
[2025-02-21 01:21:42,978][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:21:42,978][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:21:49,490][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:21:49,491][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 01:21:49,491][root][INFO] - Starting inference
[2025-02-21 01:21:49,669][root][INFO] - Processing question number 0
[2025-02-21 01:21:49,671][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:22:20,258][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:22:51,373][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:23:22,045][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:23:53,281][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:24:24,055][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:24:54,621][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:25:26,037][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:25:56,899][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:26:27,387][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:26:58,525][root][INFO] - Processing question number 10
[2025-02-21 01:26:58,527][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:27:31,048][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:28:01,328][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:28:32,159][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:29:03,622][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:29:35,034][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:30:05,408][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:30:35,714][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:31:06,654][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:31:37,591][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:32:08,207][root][INFO] - Processing question number 20
[2025-02-21 01:32:08,209][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:32:39,092][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:33:10,162][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:33:40,745][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:34:11,015][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:34:42,178][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:35:13,058][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:35:44,761][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:36:15,645][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:36:46,556][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:37:16,746][root][INFO] - Processing question number 30
[2025-02-21 01:37:16,749][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:37:47,853][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:38:19,319][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:38:50,212][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:39:20,886][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:39:51,459][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:40:22,820][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:40:53,472][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:41:24,554][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:41:55,438][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:42:27,069][root][INFO] - Processing question number 40
[2025-02-21 01:42:27,072][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:42:58,028][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:43:28,955][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:44:00,389][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:44:31,797][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:45:02,417][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:45:33,317][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:46:05,521][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:46:35,503][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:47:06,283][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:47:37,769][root][INFO] - Processing question number 50
[2025-02-21 01:47:37,773][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:48:09,413][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:48:40,423][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:49:10,625][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:49:42,570][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:50:13,555][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:50:43,565][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:51:15,185][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:51:45,689][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:52:17,328][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:52:49,590][root][INFO] - Processing question number 60
[2025-02-21 01:52:49,595][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:53:19,985][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:53:50,717][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:54:22,243][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:54:52,565][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:55:23,434][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:55:54,389][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:56:25,386][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:56:56,593][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:57:27,626][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:57:59,181][root][INFO] - Processing question number 70
[2025-02-21 01:57:59,185][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:58:29,846][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:59:00,545][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:59:31,124][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:00:02,288][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:00:33,448][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:01:03,928][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:01:35,245][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:02:06,314][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:02:37,628][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:03:08,275][root][INFO] - Processing question number 80
[2025-02-21 02:03:08,280][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:03:39,383][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:04:10,476][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:04:41,068][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:05:11,759][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:05:43,215][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:06:14,391][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:06:45,720][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:07:16,301][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:07:47,356][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:08:17,917][root][INFO] - Processing question number 90
[2025-02-21 02:08:17,922][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:08:49,943][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:09:19,912][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:09:50,838][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:10:21,024][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:10:52,423][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:11:22,730][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:11:53,365][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:12:24,323][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:12:55,839][root][INFO] - Inference complete
[2025-02-21 02:12:55,840][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,846][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,849][root][WARNING] - No match found for 4. Fact Analysis in question number 69 in domain Civil_procedure
[2025-02-21 02:12:55,849][root][WARNING] - No match found for 5. Rule Application in question number 69 in domain Civil_procedure
[2025-02-21 02:12:55,849][root][WARNING] - No match found for 6. Legal Conclusion in question number 69 in domain Civil_procedure
[2025-02-21 02:12:55,855][root][WARNING] - No match found for 6. Legal Conclusion in question number 66 in domain Contracts
[2025-02-21 02:12:55,867][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,873][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,873][root][INFO] - Saved parsed outputs
[2025-02-21 02:12:55,873][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,875][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,875][root][INFO] - Saved parsing metadata
[2025-02-21 02:12:55,875][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,876][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:12:55,878][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:12:55,914][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 02:12:55,914][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 0, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 5, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 02:13:02,805][root][INFO] - Setting global seed to 206
[2025-02-21 02:13:02,812][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:13:02,812][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:13:02,813][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:13:02,815][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:13:02,818][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:13:02,818][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:13:02,962][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:13:03,202][root][INFO] - Full model selected, loading model
[2025-02-21 02:13:21,440][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:14:23,374][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:14:23,374][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:14:49,237][root][INFO] - Peft model loaded successfully
[2025-02-21 02:14:55,427][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:14:55,429][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 02:14:55,429][root][INFO] - Starting inference
[2025-02-21 02:14:55,639][root][INFO] - Processing question number 0
[2025-02-21 02:14:55,641][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:15:26,076][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:15:57,399][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:16:28,238][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:16:59,595][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:17:30,304][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:18:00,950][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:18:32,449][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:19:03,443][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:19:34,061][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:20:05,417][root][INFO] - Processing question number 10
[2025-02-21 02:20:05,420][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:20:38,093][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:21:08,519][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:21:39,476][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:22:11,019][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:22:42,541][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:23:13,020][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:23:43,436][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:24:14,335][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:24:45,224][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:25:15,833][root][INFO] - Processing question number 20
[2025-02-21 02:25:15,835][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:25:46,692][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:26:17,772][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:26:48,286][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:27:18,752][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:27:49,892][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:28:20,921][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:28:52,817][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:29:23,723][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:29:54,737][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:30:25,071][root][INFO] - Processing question number 30
[2025-02-21 02:30:25,074][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:30:56,296][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:31:27,856][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:31:58,886][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:32:29,759][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:33:00,453][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:33:31,956][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:34:02,752][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:34:33,939][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:35:04,935][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:35:36,692][root][INFO] - Processing question number 40
[2025-02-21 02:35:36,695][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:36:07,780][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:36:38,838][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:37:10,560][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:37:42,167][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:38:12,996][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:38:44,135][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:39:16,445][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:39:46,541][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:40:17,437][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:40:49,017][root][INFO] - Processing question number 50
[2025-02-21 02:40:49,021][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:41:20,784][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:41:51,940][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:42:22,269][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:42:54,335][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:43:25,537][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:43:55,893][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:44:27,813][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:44:58,524][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:45:30,247][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:46:02,817][root][INFO] - Processing question number 60
[2025-02-21 02:46:02,822][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:46:33,330][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:47:04,207][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:47:35,723][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:48:06,218][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:48:37,208][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:49:08,258][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:49:39,337][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:50:10,810][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:50:41,962][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:51:13,660][root][INFO] - Processing question number 70
[2025-02-21 02:51:13,665][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:51:44,520][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:52:15,409][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:52:46,109][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:53:17,512][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:53:48,874][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:54:19,478][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:54:50,929][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:55:22,125][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:55:53,555][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:56:24,387][root][INFO] - Processing question number 80
[2025-02-21 02:56:24,393][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:56:55,610][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:57:26,827][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:57:57,696][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:58:28,454][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:59:00,024][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:59:31,411][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:00:02,860][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:00:33,567][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:01:04,729][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:01:35,214][root][INFO] - Processing question number 90
[2025-02-21 03:01:35,220][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:02:07,146][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:02:37,146][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:03:08,031][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:03:38,185][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:04:09,641][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:04:40,116][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:05:10,897][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:05:42,178][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:06:13,768][root][INFO] - Inference complete
[2025-02-21 03:06:13,768][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,775][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 1. Chosen Domain in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 2. Chosen Option Label in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 3. Legal Concept in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 4. Fact Analysis in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 5. Rule Application in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,780][root][WARNING] - No match found for 6. Legal Conclusion in question number 56 in domain Civil_procedure
[2025-02-21 03:06:13,785][root][WARNING] - No match found for 6. Legal Conclusion in question number 8 in domain Contracts
[2025-02-21 03:06:13,799][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,805][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,805][root][INFO] - Saved parsed outputs
[2025-02-21 03:06:13,805][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,807][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,807][root][INFO] - Saved parsing metadata
[2025-02-21 03:06:13,808][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,809][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:13,811][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:06:13,838][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 03:06:13,838][root][INFO] - Summary of metrics : {'label_accuracy': 0.1414141414141414, 'misclassification_rate': 0.8585858585858586, 'combined_accuracy': 0.1111111111111111, 'malformed_label': 22, 'malformed_domain': 44, 'total_predictions': 99, 'correct_predictions': 14, 'correct_label_and_domain': 11, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.0707070707070707, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 3, 'both_wrong': 41}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 03:06:20,741][root][INFO] - Setting global seed to 206
[2025-02-21 03:06:20,748][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:06:20,748][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:06:20,749][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:06:20,751][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:06:20,753][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:06:20,754][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:06:20,895][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:06:21,156][root][INFO] - Full model selected, loading model
[2025-02-21 03:06:39,572][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:06:39,572][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:06:45,987][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:06:45,988][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:06:45,989][root][INFO] - Starting inference
[2025-02-21 03:06:46,192][root][INFO] - Processing question number 0
[2025-02-21 03:06:46,195][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:07:16,374][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:07:47,493][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:08:18,161][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:08:49,292][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:09:19,873][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:09:50,405][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:10:08,664][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:10:39,530][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:11:10,023][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:11:41,162][root][INFO] - Processing question number 10
[2025-02-21 03:11:41,164][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:12:13,674][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:12:43,925][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:13:14,752][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:13:46,174][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:14:17,575][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:14:47,942][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:15:18,185][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:15:48,919][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:16:19,630][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:16:50,112][root][INFO] - Processing question number 20
[2025-02-21 03:16:50,114][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:17:20,797][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:17:51,719][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:18:22,084][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:18:52,332][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:19:23,372][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:19:54,116][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:20:25,687][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:20:56,396][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:21:27,423][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:21:57,798][root][INFO] - Processing question number 30
[2025-02-21 03:21:57,801][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:22:28,995][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:23:00,542][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:23:31,578][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:24:02,306][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:24:32,878][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:25:04,237][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:25:34,883][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:26:05,961][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:26:36,841][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:27:08,441][root][INFO] - Processing question number 40
[2025-02-21 03:27:08,445][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:27:39,420][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:28:10,356][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:28:41,796][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:29:13,189][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:29:43,774][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:30:14,659][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:30:46,845][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:31:16,815][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:31:47,536][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:32:18,994][root][INFO] - Processing question number 50
[2025-02-21 03:32:18,998][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:32:50,628][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:33:21,625][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:33:51,819][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:34:23,752][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:34:54,722][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:35:24,710][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:35:56,298][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:36:26,687][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:36:58,133][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:37:30,374][root][INFO] - Processing question number 60
[2025-02-21 03:37:30,378][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:38:00,750][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:38:31,426][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:39:02,815][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:39:33,306][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:40:04,284][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:40:35,317][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:41:06,322][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:41:37,507][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:42:08,630][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:42:40,265][root][INFO] - Processing question number 70
[2025-02-21 03:42:40,270][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:43:10,921][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:43:41,622][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:44:12,203][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:44:36,315][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:45:07,449][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:45:37,896][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:46:09,220][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:46:40,299][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:47:11,622][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:47:42,272][root][INFO] - Processing question number 80
[2025-02-21 03:47:42,277][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:48:13,391][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:48:44,492][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:49:15,088][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:49:45,721][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:50:17,175][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:50:48,360][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:51:19,686][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:51:50,265][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:52:21,305][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:52:51,611][root][INFO] - Processing question number 90
[2025-02-21 03:52:51,616][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:53:23,410][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:53:53,239][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:54:23,945][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:54:53,963][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:55:25,291][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:55:55,590][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:56:26,220][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:56:57,180][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:57:28,628][root][INFO] - Inference complete
[2025-02-21 03:57:28,628][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,636][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,637][root][WARNING] - No match found for 4. Fact Analysis in question number 14 in domain Civil_procedure
[2025-02-21 03:57:28,638][root][WARNING] - No match found for 5. Rule Application in question number 14 in domain Civil_procedure
[2025-02-21 03:57:28,638][root][WARNING] - No match found for 6. Legal Conclusion in question number 14 in domain Civil_procedure
[2025-02-21 03:57:28,658][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,664][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,664][root][INFO] - Saved parsed outputs
[2025-02-21 03:57:28,664][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,666][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,666][root][INFO] - Saved parsing metadata
[2025-02-21 03:57:28,667][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,668][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:57:28,669][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:57:28,697][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 03:57:28,698][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.23232323232323232, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 23, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 6, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 03:57:35,514][root][INFO] - Setting global seed to 989
[2025-02-21 03:57:35,521][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:57:35,521][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:57:35,522][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:57:35,524][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:57:35,527][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:57:35,527][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:57:35,678][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:57:35,935][root][INFO] - Full model selected, loading model
[2025-02-21 03:57:53,542][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:58:55,569][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:58:55,569][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:59:21,980][root][INFO] - Peft model loaded successfully
[2025-02-21 03:59:28,197][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:59:28,198][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 03:59:28,199][root][INFO] - Starting inference
[2025-02-21 03:59:28,365][root][INFO] - Processing question number 0
[2025-02-21 03:59:28,367][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:59:58,636][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:00:29,857][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:01:00,492][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:01:31,636][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:02:02,125][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:02:32,583][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:03:03,873][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:03:34,660][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:04:05,064][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:04:36,200][root][INFO] - Processing question number 10
[2025-02-21 04:04:36,203][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:05:08,677][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:05:38,882][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:06:09,636][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:06:41,033][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:07:12,363][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:07:42,641][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:08:12,843][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:08:43,542][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:09:14,220][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:09:44,614][root][INFO] - Processing question number 20
[2025-02-21 04:09:44,620][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:10:15,268][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:10:46,092][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:11:16,362][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:11:46,570][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:12:17,499][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:12:48,198][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:13:19,694][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:13:50,374][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:14:21,181][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:14:51,272][root][INFO] - Processing question number 30
[2025-02-21 04:14:51,276][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:15:22,267][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:15:53,592][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:16:24,393][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:16:55,031][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:17:25,521][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:17:56,796][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:18:27,378][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:18:58,612][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:19:29,403][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:20:00,956][root][INFO] - Processing question number 40
[2025-02-21 04:20:00,960][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:20:31,826][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:21:02,648][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:21:33,988][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:22:05,271][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:22:35,771][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:23:06,566][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:23:38,649][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:24:08,507][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:24:39,189][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:25:10,551][root][INFO] - Processing question number 50
[2025-02-21 04:25:10,555][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:25:42,108][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:26:13,020][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:26:43,194][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:27:15,192][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:27:46,194][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:28:16,244][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:28:47,804][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:29:18,094][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:29:49,457][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:30:21,601][root][INFO] - Processing question number 60
[2025-02-21 04:30:21,606][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:30:51,876][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:31:22,500][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:31:53,767][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:32:24,030][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:32:54,789][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:33:25,600][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:33:56,462][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:34:27,750][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:34:58,816][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:35:30,382][root][INFO] - Processing question number 70
[2025-02-21 04:35:30,387][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:36:01,162][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:36:31,920][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:37:02,514][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:37:33,682][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:38:04,775][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:38:35,133][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:39:06,339][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:39:37,300][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:40:08,519][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:40:39,137][root][INFO] - Processing question number 80
[2025-02-21 04:40:39,142][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:41:10,130][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:41:41,110][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:42:11,595][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:42:42,159][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:43:13,529][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:43:44,715][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:44:15,984][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:44:46,472][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:45:17,408][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:45:47,674][root][INFO] - Processing question number 90
[2025-02-21 04:45:47,680][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:46:19,488][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:46:49,266][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:47:19,927][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:47:49,854][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:48:21,085][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:48:51,335][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:49:21,876][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:49:52,741][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:50:24,093][root][INFO] - Inference complete
[2025-02-21 04:50:24,093][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,100][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,116][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,122][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,122][root][INFO] - Saved parsed outputs
[2025-02-21 04:50:24,122][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,144][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,144][root][INFO] - Saved parsing metadata
[2025-02-21 04:50:24,145][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,146][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:24,148][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:50:24,160][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 04:50:24,160][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 11, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 04:50:30,190][root][INFO] - Setting global seed to 989
[2025-02-21 04:50:30,195][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:50:30,196][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:50:30,197][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:50:30,198][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:50:30,200][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:50:30,200][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:50:30,376][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:50:30,609][root][INFO] - Full model selected, loading model
[2025-02-21 04:50:42,345][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:50:42,345][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:50:48,747][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:50:48,749][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 04:50:48,749][root][INFO] - Starting inference
[2025-02-21 04:50:48,925][root][INFO] - Processing question number 0
[2025-02-21 04:50:48,927][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:51:18,806][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:51:49,736][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:52:20,211][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:52:51,151][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:53:21,546][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:53:51,899][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:54:23,143][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:54:54,016][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:55:24,331][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:55:55,274][root][INFO] - Processing question number 10
[2025-02-21 04:55:55,276][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:56:27,603][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:56:57,671][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:57:28,315][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:57:59,561][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:58:30,785][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:59:00,972][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:59:31,032][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:00:01,575][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:00:32,091][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:01:02,385][root][INFO] - Processing question number 20
[2025-02-21 05:01:02,387][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:01:32,879][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:02:03,624][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:02:33,810][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:03:03,879][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:03:34,707][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:04:05,254][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:04:36,647][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:05:07,169][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:05:37,877][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:06:07,863][root][INFO] - Processing question number 30
[2025-02-21 05:06:07,866][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:06:38,762][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:07:10,039][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:07:40,758][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:08:11,247][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:08:41,622][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:09:12,792][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:09:43,245][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:10:14,136][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:10:44,882][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:11:16,489][root][INFO] - Processing question number 40
[2025-02-21 05:11:16,493][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:11:47,379][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:12:18,314][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:12:49,672][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:13:21,028][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:13:51,430][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:14:22,137][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:14:54,143][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:15:23,916][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:15:54,442][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:16:25,724][root][INFO] - Processing question number 50
[2025-02-21 05:16:25,728][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:16:57,180][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:17:27,999][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:17:58,006][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:18:29,761][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:19:00,551][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:19:30,348][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:20:01,768][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:20:31,981][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:21:03,257][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:21:35,322][root][INFO] - Processing question number 60
[2025-02-21 05:21:35,326][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:22:05,502][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:22:36,005][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:23:07,195][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:23:37,305][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:24:07,976][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:24:38,695][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:25:09,438][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:25:40,441][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:26:11,265][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:26:42,614][root][INFO] - Processing question number 70
[2025-02-21 05:26:42,618][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:27:13,062][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:27:43,564][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:28:13,939][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:28:44,983][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:29:16,054][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:29:46,419][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:30:17,672][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:30:48,603][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:31:19,727][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:31:50,174][root][INFO] - Processing question number 80
[2025-02-21 05:31:50,180][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:32:21,075][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:32:51,974][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:33:22,489][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:33:52,977][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:34:24,278][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:34:55,278][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:35:26,430][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:35:56,831][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:36:27,678][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:36:57,790][root][INFO] - Processing question number 90
[2025-02-21 05:36:57,795][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:37:29,403][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:37:59,028][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:38:29,539][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:38:59,361][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:39:30,496][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:40:00,600][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:40:31,033][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:41:01,804][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:41:33,054][root][INFO] - Inference complete
[2025-02-21 05:41:33,054][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,062][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,063][root][WARNING] - No match found for 5. Rule Application in question number 7 in domain Civil_procedure
[2025-02-21 05:41:33,064][root][WARNING] - No match found for 6. Legal Conclusion in question number 7 in domain Civil_procedure
[2025-02-21 05:41:33,078][root][WARNING] - No match found for 6. Legal Conclusion in question number 100 in domain Property
[2025-02-21 05:41:33,081][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,092][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,092][root][INFO] - Saved parsed outputs
[2025-02-21 05:41:33,092][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,094][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,094][root][INFO] - Saved parsing metadata
[2025-02-21 05:41:33,094][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,096][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:41:33,098][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:41:33,110][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 05:41:33,110][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 0, 'malformed_domain': 21, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5714285714285714, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.5, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 8, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 05:41:39,258][root][INFO] - Setting global seed to 989
[2025-02-21 05:41:39,263][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 05:41:39,263][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:41:39,265][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:41:39,267][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:41:39,270][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:41:39,270][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:41:39,428][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:41:39,678][root][INFO] - Full model selected, loading model
[2025-02-21 05:41:51,782][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:42:51,257][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:42:51,258][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:43:16,334][root][INFO] - Peft model loaded successfully
[2025-02-21 05:43:22,557][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:43:22,559][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 05:43:22,559][root][INFO] - Starting inference
[2025-02-21 05:43:22,750][root][INFO] - Processing question number 0
[2025-02-21 05:43:22,760][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:43:53,156][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:44:24,466][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:44:55,301][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:45:26,646][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:45:57,340][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:46:27,974][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:46:59,466][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:47:30,457][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:48:01,127][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:48:32,480][root][INFO] - Processing question number 10
[2025-02-21 05:48:32,482][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:49:05,256][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:49:35,842][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:50:07,087][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:50:38,760][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:51:10,459][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:51:41,084][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:52:11,593][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:52:42,510][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:53:13,403][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:53:44,000][root][INFO] - Processing question number 20
[2025-02-21 05:53:44,003][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:54:14,870][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:54:45,936][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:55:16,430][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:55:46,867][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:56:18,015][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:56:48,940][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:57:20,647][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:57:51,543][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:58:22,566][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:58:52,873][root][INFO] - Processing question number 30
[2025-02-21 05:58:52,877][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:59:24,077][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:59:55,618][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:00:26,634][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:00:57,486][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:01:28,186][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:01:59,668][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:02:30,443][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:03:01,634][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:03:32,634][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:04:04,374][root][INFO] - Processing question number 40
[2025-02-21 06:04:04,377][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:04:35,437][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:05:06,510][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:05:38,079][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:06:09,577][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:06:40,290][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:07:11,300][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:07:43,613][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:08:13,707][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:08:44,601][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:09:16,174][root][INFO] - Processing question number 50
[2025-02-21 06:09:16,177][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:09:47,946][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:10:19,097][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:10:49,617][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:11:21,675][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:11:52,771][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:12:22,880][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:12:54,609][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:13:25,112][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:13:56,685][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:14:29,032][root][INFO] - Processing question number 60
[2025-02-21 06:14:29,036][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:14:59,527][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:15:30,382][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:16:01,869][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:16:32,336][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:17:03,309][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:17:34,338][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:18:05,392][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:18:36,786][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:19:07,916][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:19:39,575][root][INFO] - Processing question number 70
[2025-02-21 06:19:39,580][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:20:10,395][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:20:41,252][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:21:11,930][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:21:43,296][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:22:14,620][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:22:45,180][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:23:16,604][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:23:47,774][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:24:19,193][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:24:50,013][root][INFO] - Processing question number 80
[2025-02-21 06:24:50,018][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:25:21,220][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:25:52,407][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:26:23,091][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:26:53,942][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:27:25,669][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:27:57,155][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:28:28,734][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:28:59,551][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:29:30,770][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:30:01,235][root][INFO] - Processing question number 90
[2025-02-21 06:30:01,241][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:30:33,153][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:31:03,146][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:31:34,167][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:32:04,367][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:32:35,836][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:33:06,339][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:33:37,107][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:34:08,203][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:34:39,799][root][INFO] - Inference complete
[2025-02-21 06:34:39,800][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,807][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,810][root][WARNING] - No match found for 6. Legal Conclusion in question number 69 in domain Civil_procedure
[2025-02-21 06:34:39,811][root][WARNING] - No match found for 6. Legal Conclusion in question number 91 in domain Civil_procedure
[2025-02-21 06:34:39,822][root][WARNING] - No match found for 6. Legal Conclusion in question number 74 in domain Criminal_law
[2025-02-21 06:34:39,824][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,831][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,831][root][INFO] - Saved parsed outputs
[2025-02-21 06:34:39,831][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,839][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,840][root][INFO] - Saved parsing metadata
[2025-02-21 06:34:39,840][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,842][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:34:39,843][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:34:39,864][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 06:34:39,864][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.15151515151515152, 'malformed_label': 7, 'malformed_domain': 39, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 11, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 06:34:46,274][root][INFO] - Setting global seed to 989
[2025-02-21 06:34:46,279][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 06:34:46,280][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:34:46,281][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:34:46,283][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:34:46,286][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:34:46,286][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:34:46,429][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:34:46,682][root][INFO] - Full model selected, loading model
[2025-02-21 06:34:59,119][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:34:59,120][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:35:05,569][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:35:05,571][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 06:35:05,571][root][INFO] - Starting inference
[2025-02-21 06:35:05,759][root][INFO] - Processing question number 0
[2025-02-21 06:35:05,761][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:35:35,893][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:36:07,025][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:36:37,695][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:37:08,831][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:37:39,425][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:38:09,964][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:38:41,351][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:39:12,234][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:39:42,727][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:40:13,873][root][INFO] - Processing question number 10
[2025-02-21 06:40:13,876][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:40:46,397][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:41:16,652][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:41:47,492][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:42:18,928][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:42:50,340][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:43:20,719][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:43:50,982][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:44:21,728][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:44:52,457][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:45:22,945][root][INFO] - Processing question number 20
[2025-02-21 06:45:22,948][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:45:53,650][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:46:24,586][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:46:54,955][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:47:25,224][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:47:56,256][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:48:27,017][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:48:58,622][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:49:29,346][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:50:00,254][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:50:30,439][root][INFO] - Processing question number 30
[2025-02-21 06:50:30,443][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:51:01,543][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:51:32,971][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:52:03,864][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:52:34,546][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:53:05,127][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:53:36,488][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:54:07,144][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:54:38,226][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:55:09,105][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:55:40,710][root][INFO] - Processing question number 40
[2025-02-21 06:55:40,715][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:56:11,657][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:56:42,585][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:57:14,016][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:57:45,399][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:58:15,996][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:58:46,898][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:59:19,108][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:59:49,097][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:00:19,844][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:00:51,328][root][INFO] - Processing question number 50
[2025-02-21 07:00:51,332][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:01:22,983][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:01:54,012][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:02:24,229][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:02:56,177][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:03:27,175][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:03:57,198][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:04:28,829][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:04:59,255][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:05:30,770][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:06:03,071][root][INFO] - Processing question number 60
[2025-02-21 07:06:03,076][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:06:33,488][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:07:04,206][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:07:35,612][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:08:05,955][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:08:36,838][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:09:07,783][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:09:38,758][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:10:09,982][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:10:41,034][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:11:12,616][root][INFO] - Processing question number 70
[2025-02-21 07:11:12,620][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:11:43,306][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:12:14,035][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:12:44,638][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:13:15,832][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:13:46,994][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:14:17,481][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:14:48,826][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:15:19,934][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:15:51,288][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:16:21,971][root][INFO] - Processing question number 80
[2025-02-21 07:16:21,976][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:16:53,114][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:17:24,245][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:17:54,867][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:18:25,531][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:18:57,019][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:19:28,227][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:19:59,591][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:20:30,207][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:21:01,275][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:21:31,611][root][INFO] - Processing question number 90
[2025-02-21 07:21:31,617][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:22:03,450][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:22:33,305][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:23:04,040][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:23:34,096][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:24:05,452][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:24:35,787][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:25:06,455][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:25:37,446][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:26:08,930][root][INFO] - Inference complete
[2025-02-21 07:26:08,931][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,938][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,942][root][WARNING] - No match found for 4. Fact Analysis in question number 77 in domain Civil_procedure
[2025-02-21 07:26:08,942][root][WARNING] - No match found for 5. Rule Application in question number 77 in domain Civil_procedure
[2025-02-21 07:26:08,942][root][WARNING] - No match found for 6. Legal Conclusion in question number 77 in domain Civil_procedure
[2025-02-21 07:26:08,948][root][WARNING] - No match found for 6. Legal Conclusion in question number 72 in domain Contracts
[2025-02-21 07:26:08,958][root][WARNING] - No match found for 6. Legal Conclusion in question number 74 in domain Criminal_law
[2025-02-21 07:26:08,960][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,966][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,966][root][INFO] - Saved parsed outputs
[2025-02-21 07:26:08,966][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,967][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,967][root][INFO] - Saved parsing metadata
[2025-02-21 07:26:08,968][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,969][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:26:08,971][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:26:08,994][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 07:26:08,994][root][INFO] - Summary of metrics : {'label_accuracy': 0.37373737373737376, 'misclassification_rate': 0.6262626262626263, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 37, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 8, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 07:26:15,355][root][INFO] - Setting global seed to 989
[2025-02-21 07:26:15,360][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 07:26:15,360][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:26:15,362][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:26:15,363][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:26:15,365][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:26:15,365][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:26:15,521][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:26:15,811][root][INFO] - Full model selected, loading model
[2025-02-21 07:26:27,745][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:27:27,766][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:27:27,767][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:27:54,857][root][INFO] - Peft model loaded successfully
[2025-02-21 07:28:01,185][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:28:01,187][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 07:28:01,187][root][INFO] - Starting inference
[2025-02-21 07:28:01,398][root][INFO] - Processing question number 0
[2025-02-21 07:28:01,400][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:28:31,818][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:29:03,157][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:29:33,986][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:30:05,338][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:30:36,038][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:30:54,820][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:31:26,320][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:31:57,311][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:32:27,926][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:32:59,284][root][INFO] - Processing question number 10
[2025-02-21 07:32:59,286][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:33:31,983][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:34:02,417][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:34:33,375][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:35:04,929][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:35:36,460][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:36:06,958][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:36:37,382][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:37:08,424][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:37:39,332][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:38:09,944][root][INFO] - Processing question number 20
[2025-02-21 07:38:09,947][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:38:40,807][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:39:11,867][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:39:42,355][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:40:12,788][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:40:43,932][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:41:14,866][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:41:46,573][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:42:17,468][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:42:48,488][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:43:18,802][root][INFO] - Processing question number 30
[2025-02-21 07:43:18,805][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:43:50,046][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:44:21,758][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:44:52,900][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:45:23,911][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:45:54,698][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:46:26,350][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:46:57,122][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:47:28,307][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:47:59,297][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:48:31,027][root][INFO] - Processing question number 40
[2025-02-21 07:48:31,031][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:49:02,087][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:49:33,136][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:50:04,679][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:50:36,164][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:51:06,868][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:51:37,874][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:52:10,181][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:52:40,276][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:53:11,161][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:53:42,731][root][INFO] - Processing question number 50
[2025-02-21 07:53:42,736][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:54:14,517][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:54:45,659][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:55:15,981][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:55:48,062][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:56:19,165][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:56:49,265][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:57:20,974][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:57:51,464][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:58:23,016][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:58:55,367][root][INFO] - Processing question number 60
[2025-02-21 07:58:55,371][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:59:25,867][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:59:56,738][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:00:28,234][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:00:58,727][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:01:29,688][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:02:00,702][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:02:31,745][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:03:03,130][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:03:34,246][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:04:05,899][root][INFO] - Processing question number 70
[2025-02-21 08:04:05,903][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:04:36,704][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:05:07,596][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:05:38,378][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:06:09,742][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:06:41,057][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:07:11,613][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:07:43,031][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:08:14,197][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:08:45,610][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:09:16,424][root][INFO] - Processing question number 80
[2025-02-21 08:09:16,429][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:09:47,624][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:10:18,811][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:10:49,502][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:11:20,236][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:11:51,788][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:12:23,158][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:12:54,584][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:13:25,278][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:13:56,412][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:14:26,878][root][INFO] - Processing question number 90
[2025-02-21 08:14:26,883][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:14:58,787][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:15:28,764][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:15:59,627][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:16:29,755][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:17:01,184][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:17:31,641][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:18:02,380][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:18:33,486][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:19:05,088][root][INFO] - Inference complete
[2025-02-21 08:19:05,088][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,095][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,104][root][WARNING] - No match found for 5. Rule Application in question number 72 in domain Contracts
[2025-02-21 08:19:05,104][root][WARNING] - No match found for 6. Legal Conclusion in question number 72 in domain Contracts
[2025-02-21 08:19:05,106][root][WARNING] - No match found for 6. Legal Conclusion in question number 82 in domain Torts
[2025-02-21 08:19:05,115][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,137][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,137][root][INFO] - Saved parsed outputs
[2025-02-21 08:19:05,137][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,138][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,139][root][INFO] - Saved parsing metadata
[2025-02-21 08:19:05,139][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,141][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:05,146][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:19:05,163][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 08:19:05,163][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 15, 'malformed_domain': 40, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 6, 'both_wrong': 34}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 08:19:11,304][root][INFO] - Setting global seed to 989
[2025-02-21 08:19:11,309][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 08:19:11,309][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 08:19:11,311][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:19:11,312][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:19:11,314][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:19:11,314][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:19:11,499][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:19:11,743][root][INFO] - Full model selected, loading model
[2025-02-21 08:19:25,604][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:19:25,604][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:19:32,030][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:19:32,032][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 08:19:32,032][root][INFO] - Starting inference
[2025-02-21 08:19:32,246][root][INFO] - Processing question number 0
[2025-02-21 08:19:32,265][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:20:02,668][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:20:33,924][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:21:04,722][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:21:36,058][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:22:06,854][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:22:37,562][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:23:09,123][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:23:40,123][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:24:10,849][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:24:42,049][root][INFO] - Processing question number 10
[2025-02-21 08:24:42,051][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:25:14,595][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:25:44,882][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:26:15,743][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:26:47,201][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:27:18,641][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:27:49,045][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:28:19,330][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:28:50,097][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:29:20,845][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:29:51,373][root][INFO] - Processing question number 20
[2025-02-21 08:29:51,375][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:30:22,098][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:30:53,056][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:31:23,464][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:31:53,753][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:32:24,801][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:32:55,579][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:33:27,188][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:33:57,929][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:34:28,855][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:34:59,065][root][INFO] - Processing question number 30
[2025-02-21 08:34:59,070][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:35:30,190][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:36:01,645][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:36:32,571][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:37:03,280][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:37:33,892][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:37:54,724][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:38:25,401][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:38:56,503][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:39:27,547][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:39:59,179][root][INFO] - Processing question number 40
[2025-02-21 08:39:59,183][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:40:30,146][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:41:01,098][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:41:32,554][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:42:03,960][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:42:34,582][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:43:05,502][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:43:37,743][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:44:07,928][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:44:38,716][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:45:10,213][root][INFO] - Processing question number 50
[2025-02-21 08:45:10,217][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:45:41,892][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:46:12,930][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:46:43,163][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:47:15,135][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:47:46,139][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:48:16,171][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:48:47,804][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:49:18,237][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:49:49,728][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:50:22,008][root][INFO] - Processing question number 60
[2025-02-21 08:50:22,013][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:50:52,428][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:51:23,142][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:51:54,551][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:52:24,932][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:52:55,841][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:53:26,796][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:53:57,795][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:54:29,020][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:55:00,060][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:55:31,623][root][INFO] - Processing question number 70
[2025-02-21 08:55:31,628][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:56:02,300][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:56:33,014][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:57:03,612][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:57:34,799][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:58:05,948][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:58:36,423][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:59:07,769][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:59:38,866][root][INFO] - Domain : Property, Question : 54
[2025-02-21 09:00:10,209][root][INFO] - Domain : Property, Question : 61
[2025-02-21 09:00:40,890][root][INFO] - Processing question number 80
[2025-02-21 09:00:40,895][root][INFO] - Domain : Property, Question : 67
[2025-02-21 09:01:12,071][root][INFO] - Domain : Property, Question : 75
[2025-02-21 09:01:43,180][root][INFO] - Domain : Property, Question : 83
[2025-02-21 09:02:13,821][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:02:44,484][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:03:15,965][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:03:47,193][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:04:18,528][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:04:49,114][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:05:20,170][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:05:50,491][root][INFO] - Processing question number 90
[2025-02-21 09:05:50,497][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:06:22,306][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:06:52,150][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:07:22,871][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:07:52,907][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:08:24,254][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:08:54,578][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:09:25,239][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:09:56,219][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:10:27,692][root][INFO] - Inference complete
[2025-02-21 09:10:27,692][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,699][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,705][root][WARNING] - No match found for 6. Legal Conclusion in question number 2 in domain Constitutional_law
[2025-02-21 09:10:27,706][root][WARNING] - No match found for 5. Rule Application in question number 60 in domain Constitutional_law
[2025-02-21 09:10:27,707][root][WARNING] - No match found for 6. Legal Conclusion in question number 60 in domain Constitutional_law
[2025-02-21 09:10:27,720][root][WARNING] - No match found for 6. Legal Conclusion in question number 15 in domain Criminal_law
[2025-02-21 09:10:27,722][root][WARNING] - No match found for 4. Fact Analysis in question number 85 in domain Criminal_law
[2025-02-21 09:10:27,722][root][WARNING] - No match found for 5. Rule Application in question number 85 in domain Criminal_law
[2025-02-21 09:10:27,722][root][WARNING] - No match found for 6. Legal Conclusion in question number 85 in domain Criminal_law
[2025-02-21 09:10:27,723][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,735][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,735][root][INFO] - Saved parsed outputs
[2025-02-21 09:10:27,735][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,737][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,737][root][INFO] - Saved parsing metadata
[2025-02-21 09:10:27,737][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,739][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
[2025-02-21 09:10:27,758][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:10:27,776][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_1
[2025-02-21 09:10:27,776][root][INFO] - Summary of metrics : {'label_accuracy': 0.32323232323232326, 'misclassification_rate': 0.6767676767676767, 'combined_accuracy': 0.21212121212121213, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 32, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 11, 'both_wrong': 26}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 09:10:35,386][root][INFO] - Setting global seed to 206
[2025-02-21 09:10:35,393][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:10:35,394][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 09:10:35,395][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:10:35,397][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:10:35,400][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:10:35,400][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:10:35,561][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:10:35,829][root][INFO] - Full model selected, loading model
[2025-02-21 09:10:51,623][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:11:51,411][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:11:51,411][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:12:15,957][root][INFO] - Peft model loaded successfully
[2025-02-21 09:12:22,107][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:12:22,109][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 09:12:22,109][root][INFO] - Starting inference
[2025-02-21 09:12:22,298][root][INFO] - Processing question number 0
[2025-02-21 09:12:22,301][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:12:53,292][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:13:24,833][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:13:56,533][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:14:27,747][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:14:58,314][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:15:28,358][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:15:58,897][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:16:29,732][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:16:59,850][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:17:30,599][root][INFO] - Processing question number 10
[2025-02-21 09:17:30,601][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 09:18:00,549][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 09:18:31,069][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 09:19:01,754][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 09:19:31,884][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 09:20:03,048][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 09:20:33,782][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:21:04,457][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 09:21:35,088][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 09:22:06,227][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 09:22:37,554][root][INFO] - Processing question number 20
[2025-02-21 09:22:37,557][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 09:23:07,723][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 09:23:38,631][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:24:09,001][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 09:24:39,526][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 09:25:10,169][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 09:25:41,378][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 09:26:12,081][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 09:26:43,021][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:27:13,714][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 09:27:45,027][root][INFO] - Processing question number 30
[2025-02-21 09:27:45,030][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 09:28:15,781][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 09:28:46,326][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 09:29:16,847][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 09:29:48,125][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 09:30:18,802][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 09:30:49,584][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:31:20,279][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 09:31:51,648][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:32:22,517][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 09:32:53,407][root][INFO] - Processing question number 40
[2025-02-21 09:32:53,411][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 09:33:24,270][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 09:33:54,936][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 09:34:26,132][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 09:34:56,141][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 09:35:27,530][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 09:35:58,364][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:36:29,033][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:36:59,877][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 09:37:30,614][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 09:38:01,761][root][INFO] - Processing question number 50
[2025-02-21 09:38:01,765][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 09:38:33,136][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 09:39:03,406][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 09:39:34,788][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:40:05,729][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 09:40:36,073][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 09:41:06,714][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 09:41:38,272][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 09:42:09,545][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 09:42:40,820][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 09:43:11,815][root][INFO] - Processing question number 60
[2025-02-21 09:43:11,819][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 09:43:42,615][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 09:44:13,476][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 09:44:45,042][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 09:45:16,180][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 09:45:47,132][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 09:46:17,610][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 09:46:47,928][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 09:47:18,123][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 09:47:48,581][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 09:48:18,976][root][INFO] - Processing question number 70
[2025-02-21 09:48:18,981][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 09:48:49,943][root][INFO] - Domain : Property, Question : 9
[2025-02-21 09:49:20,812][root][INFO] - Domain : Property, Question : 17
[2025-02-21 09:49:51,964][root][INFO] - Domain : Property, Question : 25
[2025-02-21 09:50:23,538][root][INFO] - Domain : Property, Question : 30
[2025-02-21 09:50:53,919][root][INFO] - Domain : Property, Question : 36
[2025-02-21 09:51:24,926][root][INFO] - Domain : Property, Question : 46
[2025-02-21 09:51:56,996][root][INFO] - Domain : Property, Question : 53
[2025-02-21 09:52:28,111][root][INFO] - Domain : Property, Question : 59
[2025-02-21 09:52:58,154][root][INFO] - Domain : Property, Question : 66
[2025-02-21 09:53:28,593][root][INFO] - Processing question number 80
[2025-02-21 09:53:28,598][root][INFO] - Domain : Property, Question : 69
[2025-02-21 09:53:59,982][root][INFO] - Domain : Property, Question : 81
[2025-02-21 09:54:31,394][root][INFO] - Domain : Property, Question : 88
[2025-02-21 09:55:02,736][root][INFO] - Domain : Property, Question : 91
[2025-02-21 09:55:33,730][root][INFO] - Domain : Property, Question : 94
[2025-02-21 09:56:05,742][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:56:36,380][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:57:07,604][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 09:57:39,334][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 09:58:10,208][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:58:41,111][root][INFO] - Processing question number 90
[2025-02-21 09:58:41,117][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 09:59:12,015][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 09:59:43,307][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:00:14,428][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:00:45,258][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:01:16,757][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:01:48,141][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:02:19,262][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:02:49,923][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:03:20,139][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:03:51,560][root][INFO] - Inference complete
[2025-02-21 10:03:51,560][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,568][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,575][root][WARNING] - No match found for 6. Legal Conclusion in question number 97 in domain Contracts
[2025-02-21 10:03:51,581][root][WARNING] - No match found for 6. Legal Conclusion in question number 94 in domain Property
[2025-02-21 10:03:51,585][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,591][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,591][root][INFO] - Saved parsed outputs
[2025-02-21 10:03:51,591][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,603][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,604][root][INFO] - Saved parsing metadata
[2025-02-21 10:03:51,604][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,606][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:03:51,608][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:03:51,615][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 10:03:51,615][root][INFO] - Summary of metrics : {'label_accuracy': 0.36, 'misclassification_rate': 0.64, 'combined_accuracy': 0.27, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 36, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 9, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 10:03:57,815][root][INFO] - Setting global seed to 206
[2025-02-21 10:03:57,820][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 10:03:57,820][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 10:03:57,822][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:03:57,824][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:03:57,826][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:03:57,826][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:03:58,104][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:03:58,386][root][INFO] - Full model selected, loading model
[2025-02-21 10:04:17,966][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 10:04:17,966][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 10:04:24,400][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:04:24,402][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:04:24,402][root][INFO] - Starting inference
[2025-02-21 10:04:24,606][root][INFO] - Processing question number 0
[2025-02-21 10:04:24,614][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:04:55,463][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:05:26,925][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:05:58,588][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:06:29,752][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:07:00,230][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:07:30,206][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:08:00,638][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:08:31,376][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:09:01,393][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:09:32,214][root][INFO] - Processing question number 10
[2025-02-21 10:09:32,217][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:10:02,177][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:10:32,701][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:11:03,319][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:11:33,355][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:12:04,317][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:12:34,901][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:13:05,415][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:13:35,826][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:14:06,758][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:14:37,793][root][INFO] - Processing question number 20
[2025-02-21 10:14:37,796][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:15:07,689][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:15:38,445][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:16:08,726][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:16:39,157][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:17:09,648][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:17:40,680][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:18:11,232][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:18:42,006][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:19:12,556][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:19:43,794][root][INFO] - Processing question number 30
[2025-02-21 10:19:43,798][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:20:14,449][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:20:44,905][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:21:15,317][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:21:46,523][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:22:17,048][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:22:47,704][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:23:18,260][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:23:49,553][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:24:20,324][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:24:51,128][root][INFO] - Processing question number 40
[2025-02-21 10:24:51,132][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:25:21,893][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:25:52,419][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:26:23,442][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:26:53,376][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:27:24,676][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:27:55,427][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:28:26,147][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:28:56,973][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:29:27,624][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:29:58,592][root][INFO] - Processing question number 50
[2025-02-21 10:29:58,596][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:30:29,877][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:31:00,072][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:31:31,360][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:32:02,233][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:32:32,474][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:33:02,937][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:33:34,334][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:34:05,517][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:34:36,711][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:35:07,653][root][INFO] - Processing question number 60
[2025-02-21 10:35:07,657][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:35:38,354][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:36:09,111][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:36:40,573][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:37:11,527][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:37:42,392][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:38:12,778][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:38:42,995][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:39:13,048][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:39:43,410][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:40:13,715][root][INFO] - Processing question number 70
[2025-02-21 10:40:13,720][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:40:44,595][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:41:15,368][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:41:46,331][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:42:17,815][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:42:48,103][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:43:19,026][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:43:50,927][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:44:21,864][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:44:51,802][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:45:22,152][root][INFO] - Processing question number 80
[2025-02-21 10:45:22,157][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:45:53,449][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:46:24,777][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:46:56,029][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:47:26,947][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:47:58,792][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:48:29,285][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:49:00,423][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:49:32,050][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:50:02,863][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:50:33,676][root][INFO] - Processing question number 90
[2025-02-21 10:50:33,681][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:51:04,486][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:51:35,686][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:52:06,623][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:52:37,352][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:53:08,748][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:53:40,052][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:54:11,056][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:54:41,765][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:55:11,895][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:55:43,228][root][INFO] - Inference complete
[2025-02-21 10:55:43,229][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,236][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,238][root][WARNING] - No match found for 6. Legal Conclusion in question number 13 in domain Constitutional_law
[2025-02-21 10:55:43,240][root][WARNING] - No match found for 6. Legal Conclusion in question number 78 in domain Constitutional_law
[2025-02-21 10:55:43,243][root][WARNING] - No match found for 6. Legal Conclusion in question number 34 in domain Contracts
[2025-02-21 10:55:43,244][root][WARNING] - No match found for 6. Legal Conclusion in question number 72 in domain Contracts
[2025-02-21 10:55:43,247][root][WARNING] - No match found for 4. Fact Analysis in question number 80 in domain Evidence
[2025-02-21 10:55:43,247][root][WARNING] - No match found for 5. Rule Application in question number 80 in domain Evidence
[2025-02-21 10:55:43,247][root][WARNING] - No match found for 6. Legal Conclusion in question number 80 in domain Evidence
[2025-02-21 10:55:43,256][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,263][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,263][root][INFO] - Saved parsed outputs
[2025-02-21 10:55:43,263][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,265][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,265][root][INFO] - Saved parsing metadata
[2025-02-21 10:55:43,265][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,267][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:55:43,269][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:55:43,296][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 10:55:43,296][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.19, 'malformed_label': 0, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 9, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 10:55:51,513][root][INFO] - Setting global seed to 206
[2025-02-21 10:55:51,521][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 10:55:51,522][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 10:55:51,523][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:55:51,524][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:55:51,528][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:55:51,528][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:55:51,678][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:55:51,918][root][INFO] - Full model selected, loading model
[2025-02-21 10:56:07,406][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 10:57:07,514][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 10:57:07,514][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 10:57:32,454][root][INFO] - Peft model loaded successfully
[2025-02-21 10:57:38,641][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:57:38,643][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 10:57:38,643][root][INFO] - Starting inference
[2025-02-21 10:57:38,836][root][INFO] - Processing question number 0
[2025-02-21 10:57:38,838][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:58:10,160][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:58:41,887][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:59:13,757][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:59:45,140][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:00:15,864][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:00:46,049][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:01:16,740][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:01:47,733][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:02:17,996][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:02:48,898][root][INFO] - Processing question number 10
[2025-02-21 11:02:48,900][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:03:19,003][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:03:49,676][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:04:20,524][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:04:50,815][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:05:22,137][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:05:53,037][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:06:23,878][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:06:54,546][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:07:25,741][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:07:57,122][root][INFO] - Processing question number 20
[2025-02-21 11:07:57,124][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:08:27,279][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:08:58,319][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:09:28,853][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:09:59,545][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:10:30,352][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:11:01,788][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:11:32,796][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:12:03,950][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:12:34,959][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:13:06,481][root][INFO] - Processing question number 30
[2025-02-21 11:13:06,484][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:13:37,399][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:14:08,104][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:14:38,768][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:15:10,233][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:15:41,064][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:16:11,969][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:16:42,900][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:17:14,476][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:17:45,542][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:18:16,628][root][INFO] - Processing question number 40
[2025-02-21 11:18:16,632][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:18:47,719][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:19:18,547][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:19:49,910][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:20:20,086][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:20:51,643][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:21:22,647][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:21:53,492][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:22:24,506][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:22:55,419][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:23:26,739][root][INFO] - Processing question number 50
[2025-02-21 11:23:26,744][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:23:58,291][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:24:28,739][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:25:00,295][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:25:31,417][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:26:01,916][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:26:32,646][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:27:04,321][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:27:35,760][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:28:07,212][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:28:38,374][root][INFO] - Processing question number 60
[2025-02-21 11:28:38,378][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:29:09,339][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:29:40,363][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:30:12,101][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:30:43,405][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:31:14,532][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:31:45,297][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:32:15,770][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:32:46,122][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:33:16,739][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:33:47,294][root][INFO] - Processing question number 70
[2025-02-21 11:33:47,299][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:34:18,423][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:34:49,455][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:35:20,768][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:35:52,520][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:36:23,055][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:36:54,221][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:37:26,445][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:37:57,721][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:38:27,908][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:38:58,514][root][INFO] - Processing question number 80
[2025-02-21 11:38:58,520][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:39:30,058][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:40:01,640][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:40:33,188][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:41:04,341][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:41:36,520][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:42:07,313][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:42:38,700][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:43:10,589][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:43:41,629][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:44:12,683][root][INFO] - Processing question number 90
[2025-02-21 11:44:12,688][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:44:43,748][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:45:15,194][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:45:46,469][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:46:17,452][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:46:49,108][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:47:20,659][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:47:51,952][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:48:22,780][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:48:53,156][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:49:24,731][root][INFO] - Inference complete
[2025-02-21 11:49:24,732][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,741][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,748][root][WARNING] - No match found for 6. Legal Conclusion in question number 97 in domain Contracts
[2025-02-21 11:49:24,758][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,764][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,764][root][INFO] - Saved parsed outputs
[2025-02-21 11:49:24,764][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,766][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,767][root][INFO] - Saved parsing metadata
[2025-02-21 11:49:24,768][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,769][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:24,771][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:49:24,802][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 11:49:24,802][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.15, 'malformed_label': 3, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 12, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 11:49:31,789][root][INFO] - Setting global seed to 206
[2025-02-21 11:49:31,796][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 11:49:31,796][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 11:49:31,797][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:49:31,798][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:49:31,801][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:49:31,801][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:49:31,954][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:49:32,208][root][INFO] - Full model selected, loading model
[2025-02-21 11:49:48,818][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 11:49:48,819][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 11:49:55,247][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:49:55,248][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 11:49:55,249][root][INFO] - Starting inference
[2025-02-21 11:49:55,432][root][INFO] - Processing question number 0
[2025-02-21 11:49:55,435][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:50:26,651][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:50:58,279][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:51:30,063][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:52:01,379][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:52:32,032][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:53:02,144][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:53:32,762][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:54:03,682][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:54:33,878][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:55:04,709][root][INFO] - Processing question number 10
[2025-02-21 11:55:04,712][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:55:34,739][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:56:05,344][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:56:36,059][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:57:06,264][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:57:37,417][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:58:08,183][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:58:38,890][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:59:09,489][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:59:40,614][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:00:11,824][root][INFO] - Processing question number 20
[2025-02-21 12:00:11,828][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:00:41,903][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:01:12,838][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:01:43,296][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:02:13,945][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:02:44,642][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:03:15,864][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:03:46,650][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:04:17,611][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:04:48,354][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:05:19,769][root][INFO] - Processing question number 30
[2025-02-21 12:05:19,772][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:05:50,606][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:06:21,237][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:06:51,830][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:07:23,206][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:07:53,920][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:08:24,765][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:08:55,519][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:09:27,038][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:09:57,996][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:10:28,971][root][INFO] - Processing question number 40
[2025-02-21 12:10:28,977][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:10:59,921][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:11:30,622][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:12:01,821][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:12:31,926][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:13:03,469][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:13:34,630][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:14:05,561][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:14:36,658][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:15:07,661][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:15:38,970][root][INFO] - Processing question number 50
[2025-02-21 12:15:38,977][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:16:10,505][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:16:40,875][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:17:12,348][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:17:43,400][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:18:13,822][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:18:44,463][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:19:16,051][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:19:47,413][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:20:18,781][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:20:49,876][root][INFO] - Processing question number 60
[2025-02-21 12:20:49,881][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:21:20,764][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:21:51,705][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:22:23,347][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:22:54,483][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:23:25,533][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:23:56,098][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:24:26,497][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:24:56,723][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:25:27,265][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:25:57,742][root][INFO] - Processing question number 70
[2025-02-21 12:25:57,750][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:26:28,869][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:26:59,807][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:27:30,942][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:28:02,589][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:28:33,046][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:29:04,148][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:29:36,211][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:30:07,314][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:30:37,420][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:31:07,939][root][INFO] - Processing question number 80
[2025-02-21 12:31:07,944][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:31:39,398][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:32:10,891][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:32:42,309][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:33:13,391][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:33:45,399][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:34:16,060][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:34:47,378][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:35:19,343][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:35:50,395][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:36:21,373][root][INFO] - Processing question number 90
[2025-02-21 12:36:21,379][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:36:52,362][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:37:23,740][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:37:54,858][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:38:25,763][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:38:57,341][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:39:28,811][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:39:59,940][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:40:30,628][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:41:00,877][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:41:32,376][root][INFO] - Inference complete
[2025-02-21 12:41:32,376][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,384][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,393][root][WARNING] - No match found for 6. Legal Conclusion in question number 50 in domain Evidence
[2025-02-21 12:41:32,403][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,410][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,410][root][INFO] - Saved parsed outputs
[2025-02-21 12:41:32,410][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,413][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,413][root][INFO] - Saved parsing metadata
[2025-02-21 12:41:32,414][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,417][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:41:32,419][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:41:32,445][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 12:41:32,445][root][INFO] - Summary of metrics : {'label_accuracy': 0.33, 'misclassification_rate': 0.6699999999999999, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 33, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 7, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 12:41:39,962][root][INFO] - Setting global seed to 206
[2025-02-21 12:41:39,969][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 12:41:39,969][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 12:41:39,970][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:41:39,972][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:41:39,975][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:41:39,975][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:41:40,135][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:41:40,393][root][INFO] - Full model selected, loading model
[2025-02-21 12:41:57,783][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 12:42:58,032][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 12:42:58,034][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 12:43:30,790][root][INFO] - Peft model loaded successfully
[2025-02-21 12:43:37,115][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:43:37,117][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 12:43:37,117][root][INFO] - Starting inference
[2025-02-21 12:43:37,280][root][INFO] - Processing question number 0
[2025-02-21 12:43:37,283][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:44:08,713][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:44:40,493][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:45:12,417][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:45:43,860][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:46:14,627][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:46:44,858][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:47:15,593][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:47:46,633][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:48:16,946][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:48:47,893][root][INFO] - Processing question number 10
[2025-02-21 12:48:47,895][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:49:18,043][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:49:48,771][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:50:19,788][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:50:30,953][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:51:02,316][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:51:33,261][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:52:04,165][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:52:34,877][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:53:06,109][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:53:37,521][root][INFO] - Processing question number 20
[2025-02-21 12:53:37,525][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:54:07,712][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:54:38,759][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:55:09,334][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:55:40,054][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:56:10,899][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:56:42,309][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:57:13,213][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:57:44,280][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:58:15,170][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:58:46,692][root][INFO] - Processing question number 30
[2025-02-21 12:58:46,696][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:59:17,648][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:59:48,401][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:00:19,117][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:00:50,606][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:01:21,484][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:01:52,431][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:02:23,334][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:02:54,923][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:03:26,000][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:03:57,096][root][INFO] - Processing question number 40
[2025-02-21 13:03:57,100][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:04:28,164][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:04:59,043][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:05:30,453][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:06:00,683][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:06:32,304][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:07:03,347][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:07:34,239][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:08:05,295][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:08:36,256][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:08:54,301][root][INFO] - Processing question number 50
[2025-02-21 13:08:54,307][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:09:25,897][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:09:56,414][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:10:28,081][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:10:59,282][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:11:29,889][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:12:00,700][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:12:32,475][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:13:03,966][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:13:35,460][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:14:06,662][root][INFO] - Processing question number 60
[2025-02-21 13:14:06,667][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:14:37,671][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:15:08,733][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:15:40,516][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:16:11,863][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:16:43,024][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:17:13,715][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:17:44,231][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:18:14,635][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:18:45,302][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:19:15,895][root][INFO] - Processing question number 70
[2025-02-21 13:19:15,905][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:19:47,079][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:20:18,154][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:20:49,515][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:21:21,311][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:21:51,901][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:22:23,118][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:22:55,390][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:23:26,723][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:23:56,971][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:24:27,622][root][INFO] - Processing question number 80
[2025-02-21 13:24:27,627][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:24:59,219][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:25:30,852][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:26:02,402][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:26:33,606][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:27:05,841][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:27:36,685][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:28:08,129][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:28:40,070][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:29:11,171][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:29:42,312][root][INFO] - Processing question number 90
[2025-02-21 13:29:42,319][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:30:13,434][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:30:44,967][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:31:16,359][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:31:47,391][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:32:19,100][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:32:50,693][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:33:22,040][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:33:52,913][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:34:23,327][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:34:54,968][root][INFO] - Inference complete
[2025-02-21 13:34:54,969][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:54,977][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:54,982][root][WARNING] - No match found for 6. Legal Conclusion in question number 15 in domain Criminal_law
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 1. Chosen Domain in question number 51 in domain Evidence
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 2. Chosen Option Label in question number 51 in domain Evidence
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 3. Legal Concept in question number 51 in domain Evidence
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 4. Fact Analysis in question number 51 in domain Evidence
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 5. Rule Application in question number 51 in domain Evidence
[2025-02-21 13:34:54,991][root][WARNING] - No match found for 6. Legal Conclusion in question number 51 in domain Evidence
[2025-02-21 13:34:54,997][root][WARNING] - No match found for 6. Legal Conclusion in question number 100 in domain Property
[2025-02-21 13:34:55,000][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,007][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,007][root][INFO] - Saved parsed outputs
[2025-02-21 13:34:55,007][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,009][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,009][root][INFO] - Saved parsing metadata
[2025-02-21 13:34:55,010][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,012][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:34:55,014][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:34:55,036][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 13:34:55,036][root][INFO] - Summary of metrics : {'label_accuracy': 0.2, 'misclassification_rate': 0.8, 'combined_accuracy': 0.12, 'malformed_label': 21, 'malformed_domain': 49, 'total_predictions': 100, 'correct_predictions': 20, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.06, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.18, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 8, 'both_wrong': 41}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 13:35:03,561][root][INFO] - Setting global seed to 206
[2025-02-21 13:35:03,569][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 13:35:03,569][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 13:35:03,571][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:35:03,573][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:35:03,575][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:35:03,575][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:35:03,752][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:35:03,997][root][INFO] - Full model selected, loading model
[2025-02-21 13:35:21,556][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 13:35:21,556][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 13:35:28,059][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:35:28,061][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 13:35:28,061][root][INFO] - Starting inference
[2025-02-21 13:35:28,251][root][INFO] - Processing question number 0
[2025-02-21 13:35:28,253][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:35:59,458][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:36:31,097][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:37:02,892][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:37:34,220][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:38:04,877][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:38:34,996][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:39:05,622][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:39:36,547][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:40:06,751][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:40:37,591][root][INFO] - Processing question number 10
[2025-02-21 13:40:37,593][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:41:07,630][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:41:38,240][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:42:08,959][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:42:39,175][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:43:10,336][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:43:24,941][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:43:55,654][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:44:26,258][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:44:45,911][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:45:17,131][root][INFO] - Processing question number 20
[2025-02-21 13:45:17,134][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:45:47,214][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:46:18,154][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:46:48,622][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:47:19,237][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:47:49,974][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:48:21,208][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:48:51,967][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:49:22,958][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:49:53,710][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:50:25,310][root][INFO] - Processing question number 30
[2025-02-21 13:50:25,314][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:50:56,192][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:51:26,831][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:51:57,425][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:52:28,804][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:52:59,555][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:53:30,419][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:54:01,179][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:54:32,708][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:55:03,668][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:55:34,674][root][INFO] - Processing question number 40
[2025-02-21 13:55:34,678][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:56:05,620][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:56:36,318][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:57:07,517][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:57:37,624][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:58:09,100][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:58:40,013][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:59:10,719][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:59:41,648][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:00:12,476][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:00:43,620][root][INFO] - Processing question number 50
[2025-02-21 14:00:43,624][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:01:15,088][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:01:45,456][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:02:16,932][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:02:47,987][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:03:18,414][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:03:49,066][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:04:20,658][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:04:52,027][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:05:23,402][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:05:54,525][root][INFO] - Processing question number 60
[2025-02-21 14:05:54,530][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:06:25,542][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:06:56,655][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:07:28,414][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:07:59,686][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:08:30,896][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:09:01,531][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:09:31,947][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:10:02,183][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:10:32,743][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:11:03,249][root][INFO] - Processing question number 70
[2025-02-21 14:11:03,255][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:11:34,319][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:12:05,293][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:12:36,442][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:13:08,112][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:13:38,586][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:14:09,695][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:14:41,784][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:15:12,913][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:15:43,045][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:16:13,586][root][INFO] - Processing question number 80
[2025-02-21 14:16:13,591][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:16:45,073][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:17:16,592][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:17:48,054][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:18:19,169][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:18:51,200][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:19:21,873][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:19:53,192][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:20:25,003][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:20:55,960][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:21:26,940][root][INFO] - Processing question number 90
[2025-02-21 14:21:26,945][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:21:57,927][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:22:29,305][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:23:00,423][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:23:31,326][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:24:02,906][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:24:34,377][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:25:05,501][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:25:36,191][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:26:06,495][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:26:38,155][root][INFO] - Inference complete
[2025-02-21 14:26:38,156][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,162][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,183][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,190][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,190][root][INFO] - Saved parsed outputs
[2025-02-21 14:26:38,190][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,192][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,192][root][INFO] - Saved parsing metadata
[2025-02-21 14:26:38,192][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,194][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:26:38,196][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:26:38,214][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 14:26:38,215][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.24, 'malformed_label': 0, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 52, 'correct_label_wrong_domain': 5, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 14:26:45,792][root][INFO] - Setting global seed to 989
[2025-02-21 14:26:45,799][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 14:26:45,800][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 14:26:45,801][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:26:45,803][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:26:45,806][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:26:45,806][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:26:45,952][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:26:46,219][root][INFO] - Full model selected, loading model
[2025-02-21 14:27:02,082][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 14:28:03,460][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 14:28:03,460][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 14:28:30,297][root][INFO] - Peft model loaded successfully
[2025-02-21 14:28:36,529][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:28:36,531][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 14:28:36,531][root][INFO] - Starting inference
[2025-02-21 14:28:36,709][root][INFO] - Processing question number 0
[2025-02-21 14:28:36,712][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:29:07,832][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:29:39,375][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:30:11,077][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:30:42,282][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:31:12,831][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:31:42,874][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:32:13,392][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:32:44,202][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:33:14,297][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:33:45,028][root][INFO] - Processing question number 10
[2025-02-21 14:33:45,030][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:34:14,962][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:34:45,460][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:35:16,126][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:35:46,234][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:36:17,378][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:36:48,089][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:37:18,748][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:37:49,243][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:38:20,246][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:38:51,451][root][INFO] - Processing question number 20
[2025-02-21 14:38:51,454][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:39:21,434][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:39:52,276][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:40:22,636][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:40:53,157][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:41:23,792][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:41:54,994][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:42:25,686][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:42:56,548][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:43:27,232][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:43:58,537][root][INFO] - Processing question number 30
[2025-02-21 14:43:58,540][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:44:29,381][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:45:00,064][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:45:30,694][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:46:02,199][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:46:32,969][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:47:03,835][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:47:34,522][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:48:05,882][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:48:36,780][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:49:07,682][root][INFO] - Processing question number 40
[2025-02-21 14:49:07,686][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:49:38,551][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:50:09,218][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:50:40,406][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:51:10,401][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:51:41,781][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:52:12,617][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:52:43,294][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:53:14,126][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:53:44,859][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:54:15,997][root][INFO] - Processing question number 50
[2025-02-21 14:54:16,001][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:54:47,366][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:55:17,630][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:55:49,009][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:56:19,943][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:56:50,275][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:57:20,833][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:57:52,329][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:58:23,596][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:58:54,867][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:59:25,854][root][INFO] - Processing question number 60
[2025-02-21 14:59:25,859][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:59:56,651][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:00:27,534][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:00:59,171][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:01:30,478][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:02:01,605][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:02:32,210][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:03:02,613][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:03:32,961][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:04:03,428][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:04:33,800][root][INFO] - Processing question number 70
[2025-02-21 15:04:33,806][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:05:04,749][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:05:35,592][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:06:06,714][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:06:38,275][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:07:08,762][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:07:39,811][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:08:11,875][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:08:42,974][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:09:13,015][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:09:43,442][root][INFO] - Processing question number 80
[2025-02-21 15:09:43,448][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:10:14,824][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:10:46,229][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:11:17,570][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:11:48,585][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:12:20,601][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:12:51,228][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:13:22,447][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:13:54,173][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:14:25,042][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:14:55,935][root][INFO] - Processing question number 90
[2025-02-21 15:14:55,941][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:15:26,833][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:15:58,122][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:16:29,237][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:17:00,060][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:17:31,556][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:18:02,935][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:18:34,053][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:19:04,705][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:19:34,915][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:20:06,335][root][INFO] - Inference complete
[2025-02-21 15:20:06,336][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,343][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,350][root][WARNING] - No match found for 6. Legal Conclusion in question number 97 in domain Contracts
[2025-02-21 15:20:06,357][root][WARNING] - No match found for 6. Legal Conclusion in question number 94 in domain Property
[2025-02-21 15:20:06,360][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,370][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,370][root][INFO] - Saved parsed outputs
[2025-02-21 15:20:06,370][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,385][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,385][root][INFO] - Saved parsing metadata
[2025-02-21 15:20:06,386][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,388][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:06,403][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:20:06,431][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 15:20:06,431][root][INFO] - Summary of metrics : {'label_accuracy': 0.36, 'misclassification_rate': 0.64, 'combined_accuracy': 0.27, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 36, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 9, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 15:20:13,132][root][INFO] - Setting global seed to 989
[2025-02-21 15:20:13,139][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:20:13,139][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 15:20:13,140][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:20:13,142][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:20:13,144][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:20:13,144][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:20:13,299][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:20:13,544][root][INFO] - Full model selected, loading model
[2025-02-21 15:20:27,332][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:20:27,332][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:20:33,729][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:20:33,731][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 15:20:33,731][root][INFO] - Starting inference
[2025-02-21 15:20:33,900][root][INFO] - Processing question number 0
[2025-02-21 15:20:33,919][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:21:04,713][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:21:36,200][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:22:07,987][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:22:39,180][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:23:09,827][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:23:39,907][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:24:10,520][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:24:41,390][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:25:11,606][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:25:42,304][root][INFO] - Processing question number 10
[2025-02-21 15:25:42,307][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:26:12,198][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:26:42,633][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:27:13,183][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:27:43,235][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:28:14,228][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:28:44,830][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:29:15,377][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:29:45,808][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:30:16,766][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:30:47,814][root][INFO] - Processing question number 20
[2025-02-21 15:30:47,817][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:31:17,734][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:31:48,505][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:32:18,811][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:32:49,259][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:33:19,771][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:33:50,815][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:34:21,386][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:34:52,172][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:35:22,746][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:35:53,995][root][INFO] - Processing question number 30
[2025-02-21 15:35:53,998][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:36:24,672][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:36:55,256][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:37:25,870][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:37:57,372][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:38:28,085][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:38:58,868][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:39:29,566][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:40:00,902][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:40:31,721][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:41:02,593][root][INFO] - Processing question number 40
[2025-02-21 15:41:02,597][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:41:33,405][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:42:03,975][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:42:35,050][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:43:05,022][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:43:36,376][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:44:07,177][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:44:37,761][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:45:08,566][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:45:39,370][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:46:10,486][root][INFO] - Processing question number 50
[2025-02-21 15:46:10,490][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:46:41,846][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:47:12,113][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:47:43,478][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:48:14,399][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:48:44,691][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:49:15,205][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:49:46,658][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:50:17,892][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:50:49,127][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:51:20,081][root][INFO] - Processing question number 60
[2025-02-21 15:51:20,086][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:51:50,828][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:52:21,660][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:52:53,157][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:53:24,174][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:53:55,100][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:54:25,557][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:54:55,805][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:55:25,881][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:55:56,331][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:56:26,798][root][INFO] - Processing question number 70
[2025-02-21 15:56:26,803][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:56:57,719][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:57:28,522][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:57:59,525][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:58:31,042][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:59:01,367][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:59:32,324][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:00:04,266][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:00:35,237][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:01:05,211][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:01:35,591][root][INFO] - Processing question number 80
[2025-02-21 16:01:35,596][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:02:07,043][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:02:38,536][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:03:09,915][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:03:40,964][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:04:12,968][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:04:43,539][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:05:14,736][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:05:46,443][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:06:17,282][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:06:48,150][root][INFO] - Processing question number 90
[2025-02-21 16:06:48,156][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:07:19,022][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:07:50,258][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:08:21,242][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:08:52,011][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:09:23,456][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:09:54,786][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:10:25,766][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:10:56,310][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:11:26,419][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:11:57,786][root][INFO] - Inference complete
[2025-02-21 16:11:57,788][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,795][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,796][root][WARNING] - No match found for 6. Legal Conclusion in question number 13 in domain Constitutional_law
[2025-02-21 16:11:57,798][root][WARNING] - No match found for 6. Legal Conclusion in question number 78 in domain Constitutional_law
[2025-02-21 16:11:57,802][root][WARNING] - No match found for 6. Legal Conclusion in question number 34 in domain Contracts
[2025-02-21 16:11:57,803][root][WARNING] - No match found for 6. Legal Conclusion in question number 72 in domain Contracts
[2025-02-21 16:11:57,806][root][WARNING] - No match found for 4. Fact Analysis in question number 80 in domain Evidence
[2025-02-21 16:11:57,806][root][WARNING] - No match found for 5. Rule Application in question number 80 in domain Evidence
[2025-02-21 16:11:57,806][root][WARNING] - No match found for 6. Legal Conclusion in question number 80 in domain Evidence
[2025-02-21 16:11:57,815][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,822][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,822][root][INFO] - Saved parsed outputs
[2025-02-21 16:11:57,822][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,823][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,823][root][INFO] - Saved parsing metadata
[2025-02-21 16:11:57,824][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,825][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:11:57,826][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:11:57,832][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 16:11:57,832][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.19, 'malformed_label': 0, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 9, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 16:12:04,103][root][INFO] - Setting global seed to 989
[2025-02-21 16:12:04,108][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 16:12:04,108][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 16:12:04,110][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:12:04,111][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:12:04,113][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:12:04,113][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:12:04,269][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:12:04,530][root][INFO] - Full model selected, loading model
[2025-02-21 16:12:21,284][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 16:13:22,702][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 16:13:22,709][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 16:13:49,696][root][INFO] - Peft model loaded successfully
[2025-02-21 16:13:55,948][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:13:55,950][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 16:13:55,950][root][INFO] - Starting inference
[2025-02-21 16:13:56,195][root][INFO] - Processing question number 0
[2025-02-21 16:13:56,197][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:14:28,004][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:14:59,859][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:15:31,802][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:16:03,282][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:16:34,067][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:17:04,304][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:17:35,056][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:18:06,118][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:18:36,470][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:19:07,471][root][INFO] - Processing question number 10
[2025-02-21 16:19:07,473][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:19:37,635][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:20:08,368][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:20:39,268][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:21:09,607][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:21:40,990][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:22:11,939][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:22:42,830][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:23:13,553][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:23:44,799][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:24:16,228][root][INFO] - Processing question number 20
[2025-02-21 16:24:16,237][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:24:46,442][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:25:17,509][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:25:48,199][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:26:19,174][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:26:50,045][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:27:21,486][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:27:52,420][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:28:23,521][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:28:54,447][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:29:26,004][root][INFO] - Processing question number 30
[2025-02-21 16:29:26,014][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:29:56,997][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:30:27,800][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:30:58,562][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:31:30,189][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:32:01,184][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:32:32,152][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:33:03,109][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:33:34,735][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:34:05,843][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:34:36,981][root][INFO] - Processing question number 40
[2025-02-21 16:34:36,985][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:35:08,099][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:35:39,015][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:36:10,454][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:36:40,718][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:37:12,401][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:37:43,487][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:38:14,420][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:38:45,503][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:39:16,487][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:39:47,876][root][INFO] - Processing question number 50
[2025-02-21 16:39:47,882][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:40:19,503][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:40:50,015][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:41:21,642][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:41:52,864][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:42:23,744][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:42:54,678][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:43:26,535][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:43:58,141][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:44:29,799][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:45:01,042][root][INFO] - Processing question number 60
[2025-02-21 16:45:01,047][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:45:32,072][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:46:03,153][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:46:34,978][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:47:06,502][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:47:37,836][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:48:08,640][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:48:39,293][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:49:09,853][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:49:40,601][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:50:11,220][root][INFO] - Processing question number 70
[2025-02-21 16:50:11,226][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:50:42,416][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:51:13,515][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:51:44,897][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:52:16,719][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:52:47,325][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:53:18,554][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:53:50,847][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:54:22,187][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:54:52,443][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:55:23,126][root][INFO] - Processing question number 80
[2025-02-21 16:55:23,136][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:55:54,762][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:56:26,417][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:56:58,010][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:57:29,219][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:58:01,456][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:58:32,312][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:59:03,766][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:59:35,734][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:00:06,854][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:00:37,978][root][INFO] - Processing question number 90
[2025-02-21 17:00:37,983][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:01:09,116][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:01:40,641][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:02:11,999][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:02:43,050][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:03:14,779][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:03:46,399][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:04:17,837][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:04:48,844][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:05:19,294][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:05:50,953][root][INFO] - Inference complete
[2025-02-21 17:05:50,954][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,961][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,968][root][WARNING] - No match found for 4. Fact Analysis in question number 84 in domain Contracts
[2025-02-21 17:05:50,968][root][WARNING] - No match found for 5. Rule Application in question number 84 in domain Contracts
[2025-02-21 17:05:50,968][root][WARNING] - No match found for 6. Legal Conclusion in question number 84 in domain Contracts
[2025-02-21 17:05:50,972][root][WARNING] - No match found for 6. Legal Conclusion in question number 9 in domain Property
[2025-02-21 17:05:50,974][root][WARNING] - No match found for 6. Legal Conclusion in question number 81 in domain Property
[2025-02-21 17:05:50,978][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,984][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,984][root][INFO] - Saved parsed outputs
[2025-02-21 17:05:50,984][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,986][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,986][root][INFO] - Saved parsing metadata
[2025-02-21 17:05:50,986][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,988][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:05:50,989][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:05:51,003][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 17:05:51,003][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.2, 'malformed_label': 4, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.11, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 17:05:58,210][root][INFO] - Setting global seed to 989
[2025-02-21 17:05:58,216][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 17:05:58,217][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 17:05:58,218][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:05:58,220][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:05:58,222][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:05:58,223][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:05:58,389][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:05:58,674][root][INFO] - Full model selected, loading model
[2025-02-21 17:06:16,236][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 17:06:16,237][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 17:06:22,680][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:06:22,682][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:06:22,682][root][INFO] - Starting inference
[2025-02-21 17:06:22,851][root][INFO] - Processing question number 0
[2025-02-21 17:06:22,853][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:06:54,001][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:07:25,773][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:07:57,664][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:08:29,028][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:08:59,703][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:09:29,846][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:10:00,491][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:10:31,437][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:11:01,663][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:11:32,523][root][INFO] - Processing question number 10
[2025-02-21 17:11:32,525][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:12:02,584][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:12:33,215][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:13:03,957][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:13:34,196][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:14:05,376][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:14:36,175][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:15:06,914][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:15:37,538][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:16:08,688][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:16:39,927][root][INFO] - Processing question number 20
[2025-02-21 17:16:39,929][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:17:10,030][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:17:40,993][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:18:11,481][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:18:42,116][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:19:12,822][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:19:44,056][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:20:14,827][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:20:45,952][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:21:16,855][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:21:48,398][root][INFO] - Processing question number 30
[2025-02-21 17:21:48,401][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:22:19,416][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:22:50,192][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:23:21,014][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:23:52,578][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:24:23,423][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:24:54,396][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:25:25,321][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:25:56,858][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:26:27,843][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:26:58,853][root][INFO] - Processing question number 40
[2025-02-21 17:26:58,857][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:27:29,830][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:28:00,563][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:28:31,796][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:29:01,937][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:29:33,454][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:30:04,412][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:30:35,160][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:31:06,129][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:31:36,999][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:32:08,187][root][INFO] - Processing question number 50
[2025-02-21 17:32:08,191][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:32:39,692][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:33:10,103][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:33:41,614][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:34:12,704][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:34:43,166][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:35:13,852][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:35:45,474][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:36:16,879][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:36:48,287][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:37:19,443][root][INFO] - Processing question number 60
[2025-02-21 17:37:19,448][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:37:50,401][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:38:21,399][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:38:53,109][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:39:24,292][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:39:55,387][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:40:25,998][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:40:56,441][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:41:26,717][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:41:57,308][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:42:27,832][root][INFO] - Processing question number 70
[2025-02-21 17:42:27,837][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:42:59,040][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:43:30,166][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:44:01,354][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:44:33,058][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:45:03,567][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:45:34,712][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:46:06,833][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:46:37,990][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:47:08,151][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:47:38,723][root][INFO] - Processing question number 80
[2025-02-21 17:47:38,728][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:48:10,237][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:48:41,783][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:49:13,257][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:49:44,390][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:50:16,458][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:50:47,172][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:51:18,529][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:51:50,380][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:52:21,382][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:52:52,405][root][INFO] - Processing question number 90
[2025-02-21 17:52:52,411][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:53:23,436][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:53:54,856][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:54:26,023][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:54:56,969][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:55:28,592][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:56:00,107][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:56:31,275][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:57:02,002][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:57:32,294][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:58:03,824][root][INFO] - Inference complete
[2025-02-21 17:58:03,824][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,831][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,833][root][WARNING] - No match found for 6. Legal Conclusion in question number 13 in domain Constitutional_law
[2025-02-21 17:58:03,844][root][WARNING] - No match found for 4. Fact Analysis in question number 75 in domain Civil_procedure
[2025-02-21 17:58:03,844][root][WARNING] - No match found for 5. Rule Application in question number 75 in domain Civil_procedure
[2025-02-21 17:58:03,844][root][WARNING] - No match found for 6. Legal Conclusion in question number 75 in domain Civil_procedure
[2025-02-21 17:58:03,851][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,857][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,857][root][INFO] - Saved parsed outputs
[2025-02-21 17:58:03,857][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,858][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,858][root][INFO] - Saved parsing metadata
[2025-02-21 17:58:03,859][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,860][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 17:58:03,861][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:58:03,873][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 17:58:03,873][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.19, 'malformed_label': 0, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 8, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 17:58:10,053][root][INFO] - Setting global seed to 989
[2025-02-21 17:58:10,058][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 17:58:10,058][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 17:58:10,060][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:58:10,061][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:58:10,063][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:58:10,063][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:58:10,221][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:58:10,496][root][INFO] - Full model selected, loading model
[2025-02-21 17:58:28,186][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 17:59:29,567][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 17:59:29,567][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 17:59:56,630][root][INFO] - Peft model loaded successfully
[2025-02-21 18:00:02,974][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:00:02,975][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:00:02,975][root][INFO] - Starting inference
[2025-02-21 18:00:03,173][root][INFO] - Processing question number 0
[2025-02-21 18:00:03,175][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:00:35,032][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:01:07,039][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:01:39,175][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:02:10,749][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:02:41,729][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:03:12,012][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:03:42,791][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:04:13,887][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:04:44,224][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:05:15,202][root][INFO] - Processing question number 10
[2025-02-21 18:05:15,204][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:05:45,381][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:06:16,129][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:06:47,033][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:07:17,376][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:07:48,753][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:08:19,707][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:08:50,606][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:09:21,338][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:09:52,591][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:10:24,025][root][INFO] - Processing question number 20
[2025-02-21 18:10:24,028][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:10:54,237][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:11:25,308][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:11:55,902][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:12:26,650][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:12:57,513][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:13:28,943][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:13:59,864][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:14:30,954][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:15:01,866][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:15:33,404][root][INFO] - Processing question number 30
[2025-02-21 18:15:33,407][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:16:04,375][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:16:35,140][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:17:05,869][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:17:37,376][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:18:08,267][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:18:39,238][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:19:10,287][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:19:41,908][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:20:13,024][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:20:44,143][root][INFO] - Processing question number 40
[2025-02-21 18:20:44,146][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:21:15,227][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:21:46,114][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:22:17,539][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:22:47,773][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:23:19,395][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:23:50,474][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:24:21,501][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:24:52,572][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:25:23,546][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:25:54,920][root][INFO] - Processing question number 50
[2025-02-21 18:25:54,924][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:26:26,529][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:26:57,033][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:27:28,678][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:27:59,891][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:28:30,455][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:29:01,246][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:29:32,981][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:30:04,481][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:30:35,996][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:31:07,222][root][INFO] - Processing question number 60
[2025-02-21 18:31:07,227][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:31:38,254][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:32:09,343][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:32:41,152][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:33:12,521][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:33:43,709][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:34:14,421][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:34:44,967][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:35:15,487][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:35:46,303][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:36:17,043][root][INFO] - Processing question number 70
[2025-02-21 18:36:17,048][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:36:48,407][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:37:19,616][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:37:51,101][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:38:22,932][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:38:53,557][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:39:24,799][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:39:57,107][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:40:28,524][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:40:58,806][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:41:29,476][root][INFO] - Processing question number 80
[2025-02-21 18:41:29,483][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:42:01,107][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:42:32,766][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:43:04,343][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:43:35,567][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:44:07,821][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:44:38,696][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:45:10,155][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:45:42,119][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:46:13,234][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:46:44,362][root][INFO] - Processing question number 90
[2025-02-21 18:46:44,369][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:47:15,511][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:47:47,044][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:48:18,404][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:48:49,459][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:49:21,194][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:49:52,828][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:50:24,208][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:50:55,100][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:51:25,560][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:51:57,222][root][INFO] - Inference complete
[2025-02-21 18:51:57,222][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,234][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,243][root][WARNING] - No match found for 6. Legal Conclusion in question number 97 in domain Contracts
[2025-02-21 18:51:57,254][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,260][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,260][root][INFO] - Saved parsed outputs
[2025-02-21 18:51:57,260][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,262][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,262][root][INFO] - Saved parsing metadata
[2025-02-21 18:51:57,262][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,264][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:51:57,266][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:51:57,292][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 18:51:57,293][root][INFO] - Summary of metrics : {'label_accuracy': 0.21, 'misclassification_rate': 0.79, 'combined_accuracy': 0.15, 'malformed_label': 19, 'malformed_domain': 48, 'total_predictions': 100, 'correct_predictions': 21, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.18, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 6, 'both_wrong': 42}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 1 to status running with exit code None
Eval status update completed for job 1
[2025-02-21 18:52:07,700][root][INFO] - Setting global seed to 989
[2025-02-21 18:52:07,708][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 18:52:07,708][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 18:52:07,709][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:52:07,711][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:52:07,714][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:52:07,714][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:52:07,872][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:52:08,128][root][INFO] - Full model selected, loading model
[2025-02-21 18:52:24,832][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 18:52:24,832][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 18:52:31,239][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:52:31,240][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 18:52:31,241][root][INFO] - Starting inference
[2025-02-21 18:52:31,431][root][INFO] - Processing question number 0
[2025-02-21 18:52:31,434][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:53:02,505][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:53:34,160][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:54:05,940][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:54:37,242][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:55:07,881][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:55:38,083][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:56:08,781][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:56:39,692][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:57:09,874][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:57:40,688][root][INFO] - Processing question number 10
[2025-02-21 18:57:40,690][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:58:10,707][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:58:41,295][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:59:11,994][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:59:42,186][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 19:00:13,335][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 19:00:44,112][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 19:01:14,809][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 19:01:45,389][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 19:02:16,533][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 19:02:47,866][root][INFO] - Processing question number 20
[2025-02-21 19:02:47,869][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 19:03:17,929][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 19:03:48,845][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 19:04:19,285][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 19:04:49,901][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 19:05:20,573][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 19:05:51,776][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 19:06:22,540][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 19:06:53,479][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 19:07:24,186][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 19:07:55,579][root][INFO] - Processing question number 30
[2025-02-21 19:07:55,582][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 19:08:26,393][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 19:08:57,000][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 19:09:27,567][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 19:09:58,923][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 19:10:29,602][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 19:11:00,406][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 19:11:31,148][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 19:12:02,753][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 19:12:33,826][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 19:13:04,904][root][INFO] - Processing question number 40
[2025-02-21 19:13:04,907][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 19:13:35,922][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 19:14:06,736][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 19:14:37,945][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 19:15:08,025][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 19:15:39,486][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 19:16:10,382][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 19:16:41,075][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 19:17:11,983][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 19:17:42,801][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:18:13,928][root][INFO] - Processing question number 50
[2025-02-21 19:18:13,931][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:18:45,397][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:18:58,974][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:19:30,589][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:20:01,726][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:20:32,285][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:21:02,999][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:21:34,704][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:22:06,054][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:22:37,404][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:23:08,479][root][INFO] - Processing question number 60
[2025-02-21 19:23:08,483][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:23:39,351][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:24:10,275][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:24:41,906][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:25:13,029][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:25:44,071][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:26:14,659][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:26:45,069][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:27:15,301][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:27:45,859][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:28:16,325][root][INFO] - Processing question number 70
[2025-02-21 19:28:16,330][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:28:47,379][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:29:08,342][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:29:39,476][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:30:11,136][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:30:41,613][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:31:12,700][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:31:44,833][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:32:16,022][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:32:46,128][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:33:16,642][root][INFO] - Processing question number 80
[2025-02-21 19:33:16,647][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:33:48,101][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:34:19,595][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:34:51,012][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:35:22,088][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:35:54,101][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:36:24,760][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:36:56,065][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:37:19,789][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:37:50,738][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:38:21,705][root][INFO] - Processing question number 90
[2025-02-21 19:38:21,711][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:38:52,684][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:39:24,048][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:39:55,154][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:40:26,046][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:40:57,616][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:41:29,075][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:42:00,245][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:42:30,991][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:43:01,233][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:43:32,717][root][INFO] - Inference complete
[2025-02-21 19:43:32,717][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,724][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,727][root][WARNING] - No match found for 6. Legal Conclusion in question number 62 in domain Constitutional_law
[2025-02-21 19:43:32,735][root][WARNING] - No match found for 6. Legal Conclusion in question number 72 in domain Contracts
[2025-02-21 19:43:32,740][root][WARNING] - No match found for 4. Fact Analysis in question number 12 in domain Civil_procedure
[2025-02-21 19:43:32,740][root][WARNING] - No match found for 5. Rule Application in question number 12 in domain Civil_procedure
[2025-02-21 19:43:32,740][root][WARNING] - No match found for 6. Legal Conclusion in question number 12 in domain Civil_procedure
[2025-02-21 19:43:32,743][root][WARNING] - No match found for 6. Legal Conclusion in question number 53 in domain Property
[2025-02-21 19:43:32,749][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,755][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,755][root][INFO] - Saved parsed outputs
[2025-02-21 19:43:32,756][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,759][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,759][root][INFO] - Saved parsing metadata
[2025-02-21 19:43:32,760][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,761][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
[2025-02-21 19:43:32,763][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:43:32,775][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_structured, on test_set_2
[2025-02-21 19:43:32,776][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.21, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 6, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '1', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 1 to status completed with exit code 0
Eval status update completed for job 1
Job 1 completed at Fri Feb 21 19:43:33 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n508
Job ID: 25309336
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 21:02:17
CPU Efficiency: 9.93% of 8-19:54:30 core-walltime
Job Wall-clock time: 21:11:27
Memory Utilized: 28.08 GB
Memory Efficiency: 78.00% of 36.00 GB
