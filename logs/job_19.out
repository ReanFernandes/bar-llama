Starting job 19 at Thu Feb 20 23:07:07 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=markdown_answer_first_few_shot_unstructured train=markdown_answer_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '19', 'training']
Updating job 19 to status training with exit code None
Status update completed for job 19
[2025-02-20 23:07:21,803][root][INFO] - Global seed set to 314
[2025-02-20 23:07:21,805][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 23:07:21,805][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 23:07:21,805][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 23:07:21,805][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:07:21,805][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 23:07:21,822][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:07:21,837][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 23:07:21,839][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 23:07:21,887][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 23:07:22,307][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 23:07:35,725][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 23:08:03,919][root][INFO] - Model prepared for kbit training
[2025-02-20 23:08:03,920][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'down_proj', 'k_proj', 'v_proj', 'up_proj', 'o_proj', 'gate_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 23:08:05,581][root][INFO] - Lora adapter added to model
[2025-02-20 23:08:05,584][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_markdown_answer_first_few_shot_unstructured
[2025-02-20 23:08:05,723][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.5924, 'grad_norm': 0.14559721946716309, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4399, 'grad_norm': 0.1760195642709732, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3204, 'grad_norm': 0.1791071891784668, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.2235, 'grad_norm': 0.21688756346702576, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0473, 'grad_norm': 0.2451438158750534, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 382.0222, 'train_samples_per_second': 0.275, 'train_steps_per_second': 0.039, 'train_loss': 1.3247057596842449, 'epoch': 15.0}
[2025-02-20 23:14:31,238][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_markdown_answer_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '19', 'trained', '0']
Updating job 19 to status trained with exit code 0
Status update completed for job 19
Starting evaluations for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-20 23:14:40,312][root][INFO] - Setting global seed to 206
[2025-02-20 23:14:40,317][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:14:40,318][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:14:40,319][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:14:40,320][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:14:40,322][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:14:40,322][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:14:40,472][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:14:40,791][root][INFO] - Full model selected, loading model
[2025-02-20 23:14:54,950][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:15:56,729][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:15:56,730][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:16:23,099][root][INFO] - Peft model loaded successfully
[2025-02-20 23:16:29,471][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:16:29,473][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:16:29,473][root][INFO] - Starting inference
[2025-02-20 23:16:29,667][root][INFO] - Processing question number 0
[2025-02-20 23:16:29,687][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:16:59,118][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:17:29,548][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:17:59,533][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:18:29,912][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:18:59,568][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:19:29,179][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:19:59,585][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:20:29,500][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:20:59,081][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:21:29,334][root][INFO] - Processing question number 10
[2025-02-20 23:21:29,336][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:22:00,930][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:22:30,311][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:23:00,211][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:23:30,676][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:24:01,114][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:24:30,566][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:24:59,945][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:25:29,803][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:25:59,637][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:26:29,206][root][INFO] - Processing question number 20
[2025-02-20 23:26:29,209][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:26:59,021][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:27:29,015][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:27:58,453][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:28:27,838][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:28:57,924][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:29:27,803][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:29:58,476][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:30:28,295][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:30:58,257][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:31:27,577][root][INFO] - Processing question number 30
[2025-02-20 23:31:27,580][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:31:57,786][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:32:28,236][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:32:58,200][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:33:27,989][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:33:57,651][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:34:28,034][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:34:57,798][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:35:28,000][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:35:57,950][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:36:28,629][root][INFO] - Processing question number 40
[2025-02-20 23:36:28,632][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:36:58,650][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:37:28,645][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:37:59,103][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:38:29,508][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:38:59,196][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:39:29,156][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:40:00,434][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:40:29,483][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:40:59,393][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:41:29,899][root][INFO] - Processing question number 50
[2025-02-20 23:41:29,903][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:42:00,631][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:42:30,707][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:43:00,036][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:43:31,033][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:44:01,075][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:44:30,128][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:45:00,822][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:45:30,304][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:46:00,801][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:46:32,138][root][INFO] - Processing question number 60
[2025-02-20 23:46:32,143][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:47:01,606][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:47:31,419][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:48:01,825][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:48:31,273][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:49:01,376][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:49:31,361][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:50:01,379][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:50:31,698][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:51:01,784][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:51:32,418][root][INFO] - Processing question number 70
[2025-02-20 23:51:32,423][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:52:02,213][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:52:32,031][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:53:01,688][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:53:31,972][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:54:02,217][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:54:31,747][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:55:02,084][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:55:32,275][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:56:02,623][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:56:32,400][root][INFO] - Processing question number 80
[2025-02-20 23:56:32,405][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:57:02,629][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:57:32,841][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:58:02,519][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:58:32,272][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:59:02,758][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:59:33,059][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:00:03,419][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:00:33,085][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:01:03,201][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:01:32,642][root][INFO] - Processing question number 90
[2025-02-21 00:01:32,647][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:02:03,516][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:02:32,454][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:03:02,269][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:03:31,333][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:04:01,694][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:04:31,135][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:05:00,897][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:05:30,922][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:06:01,416][root][INFO] - Inference complete
[2025-02-21 00:06:01,416][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,424][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,424][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,425][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,426][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,427][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,428][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,429][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,430][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,431][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,432][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,433][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,434][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,435][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,435][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,435][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:06:01,435][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,435][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,436][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,437][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,437][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,437][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,437][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:06:01,437][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,438][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,439][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,439][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,439][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,439][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:06:01,440][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,493][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,493][root][INFO] - Saved parsed outputs
[2025-02-21 00:06:01,493][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,520][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,520][root][INFO] - Saved parsing metadata
[2025-02-21 00:06:01,521][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,523][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:01,544][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:06:01,578][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:06:01,578][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.25252525252525254, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 00:06:08,283][root][INFO] - Setting global seed to 206
[2025-02-21 00:06:08,288][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:06:08,288][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:06:08,290][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:06:08,291][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:06:08,294][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:06:08,294][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:06:08,468][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:06:08,735][root][INFO] - Full model selected, loading model
[2025-02-21 00:06:26,146][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:06:26,146][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:06:32,590][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:06:32,592][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:06:32,592][root][INFO] - Starting inference
[2025-02-21 00:06:32,807][root][INFO] - Processing question number 0
[2025-02-21 00:06:32,809][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:07:02,037][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:07:32,182][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:08:02,059][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:08:32,375][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:09:02,112][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:09:31,782][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:10:02,308][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:10:32,540][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:11:02,043][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:11:32,179][root][INFO] - Processing question number 10
[2025-02-21 00:11:32,182][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:12:03,723][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:12:33,016][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:13:02,841][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:13:33,202][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:14:03,661][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:14:33,099][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:15:02,417][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:15:32,231][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:16:01,948][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:16:31,437][root][INFO] - Processing question number 20
[2025-02-21 00:16:31,439][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:17:01,122][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:17:31,036][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:18:00,403][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:18:29,624][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:18:59,617][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:19:29,405][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:19:59,928][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:20:29,636][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:20:59,531][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:21:28,688][root][INFO] - Processing question number 30
[2025-02-21 00:21:28,691][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:21:58,765][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:22:29,133][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:22:59,009][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:23:28,690][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:23:58,262][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:24:28,571][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:24:58,219][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:25:28,287][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:25:58,151][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:26:28,701][root][INFO] - Processing question number 40
[2025-02-21 00:26:28,704][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:26:58,633][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:27:28,545][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:27:58,923][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:28:29,252][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:28:58,838][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:29:28,722][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:29:59,921][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:30:28,887][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:30:58,661][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:31:29,079][root][INFO] - Processing question number 50
[2025-02-21 00:31:29,082][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:31:59,670][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:32:29,671][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:32:58,827][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:33:29,765][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:33:59,726][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:34:28,720][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:34:59,274][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:35:28,691][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:35:59,135][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:36:30,411][root][INFO] - Processing question number 60
[2025-02-21 00:36:30,415][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:36:59,940][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:37:29,639][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:37:59,964][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:38:29,329][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:38:59,178][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:39:29,088][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:39:59,024][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:40:29,268][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:40:59,284][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:41:29,787][root][INFO] - Processing question number 70
[2025-02-21 00:41:29,791][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:41:59,450][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:42:29,156][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:42:58,734][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:43:28,959][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:43:59,088][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:44:28,552][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:44:58,821][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:45:28,891][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:45:59,159][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:46:28,820][root][INFO] - Processing question number 80
[2025-02-21 00:46:28,826][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:46:58,923][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:47:29,010][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:47:58,594][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:48:28,225][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:48:58,625][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:49:28,846][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:49:59,126][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:50:28,706][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:50:58,744][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:51:28,099][root][INFO] - Processing question number 90
[2025-02-21 00:51:28,104][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:51:58,897][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:52:27,760][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:52:57,468][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:53:26,482][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:53:56,761][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:54:26,122][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:54:55,766][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:55:25,742][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:55:56,328][root][INFO] - Inference complete
[2025-02-21 00:55:56,329][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,335][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,336][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,337][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,337][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,337][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,338][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,338][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,339][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:55:56,339][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:56,340][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:55:56,341][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,341][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,341][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,341][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,342][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,342][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,342][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:55:56,343][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:56,343][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:56,344][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:56,344][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:55:56,345][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:56,345][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:56,346][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:56,346][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:55:56,347][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:56,348][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:55:56,348][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:56,349][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:56,349][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:56,349][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:55:56,351][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,356][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,356][root][INFO] - Saved parsed outputs
[2025-02-21 00:55:56,356][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,357][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,358][root][INFO] - Saved parsing metadata
[2025-02-21 00:55:56,358][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,360][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:55:56,361][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:55:56,368][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:55:56,368][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.24242424242424243, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.2222222222222222, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 12, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 00:56:03,301][root][INFO] - Setting global seed to 206
[2025-02-21 00:56:03,306][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:56:03,307][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:56:03,308][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:56:03,310][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:56:03,312][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:56:03,312][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:56:03,458][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:56:03,705][root][INFO] - Full model selected, loading model
[2025-02-21 00:56:21,115][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:57:22,304][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:57:22,305][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:57:48,405][root][INFO] - Peft model loaded successfully
[2025-02-21 00:57:54,621][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:57:54,623][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:54,623][root][INFO] - Starting inference
[2025-02-21 00:57:54,840][root][INFO] - Processing question number 0
[2025-02-21 00:57:54,842][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:58:24,415][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:58:54,801][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:59:24,802][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:59:55,238][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:00:25,083][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:00:54,897][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:01:25,480][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:01:55,593][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:02:25,341][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:02:55,780][root][INFO] - Processing question number 10
[2025-02-21 01:02:55,782][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:03:27,576][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:03:57,131][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:04:27,211][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:04:57,847][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:05:28,490][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:05:58,133][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:06:27,699][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:06:57,746][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:07:27,776][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:07:57,536][root][INFO] - Processing question number 20
[2025-02-21 01:07:57,539][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:08:27,533][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:08:57,698][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:09:27,311][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:09:56,862][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:10:27,112][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:10:57,152][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:11:27,997][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:11:58,005][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:12:28,149][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:12:57,636][root][INFO] - Processing question number 30
[2025-02-21 01:12:57,639][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:13:28,022][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:13:58,648][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:14:28,783][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:14:58,753][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:15:28,594][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:15:59,152][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:16:29,098][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:16:59,467][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:17:29,588][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:18:00,446][root][INFO] - Processing question number 40
[2025-02-21 01:18:00,449][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:18:30,651][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:19:01,021][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:19:31,996][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:20:02,700][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:20:32,694][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:21:02,820][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:21:34,262][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:22:03,480][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:22:33,502][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:23:04,175][root][INFO] - Processing question number 50
[2025-02-21 01:23:04,179][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:23:35,071][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:24:05,330][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:24:34,836][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:25:06,012][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:25:36,235][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:26:05,459][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:26:36,367][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:27:06,038][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:27:36,715][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:28:08,225][root][INFO] - Processing question number 60
[2025-02-21 01:28:08,230][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:28:37,865][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:29:07,854][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:29:38,438][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:30:08,056][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:30:38,169][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:31:08,394][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:31:38,592][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:32:09,086][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:32:39,347][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:33:10,163][root][INFO] - Processing question number 70
[2025-02-21 01:33:10,167][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:33:40,127][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:34:10,123][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:34:39,958][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:35:10,425][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:35:40,847][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:36:10,565][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:36:41,096][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:37:11,459][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:37:41,985][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:38:11,958][root][INFO] - Processing question number 80
[2025-02-21 01:38:11,964][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:38:42,544][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:39:13,105][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:39:43,110][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:40:13,157][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:40:44,008][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:41:14,511][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:41:45,045][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:42:14,890][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:42:45,187][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:43:14,800][root][INFO] - Processing question number 90
[2025-02-21 01:43:14,806][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:43:45,865][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:44:14,985][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:44:44,993][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:45:14,243][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:45:44,777][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:46:14,382][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:46:44,321][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:47:14,524][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:47:45,182][root][INFO] - Inference complete
[2025-02-21 01:47:45,182][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,190][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,190][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,190][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,191][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,192][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,193][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,194][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,195][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,196][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,196][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,196][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,196][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,196][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:47:45,196][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,197][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,198][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,199][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,199][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,199][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:47:45,199][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 01:47:45,199][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,199][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,200][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,201][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,202][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,203][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,204][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,204][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,204][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,204][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,204][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,205][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,205][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,205][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,205][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,205][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:47:45,206][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,210][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,210][root][INFO] - Saved parsed outputs
[2025-02-21 01:47:45,211][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,212][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,212][root][INFO] - Saved parsing metadata
[2025-02-21 01:47:45,213][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,214][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:47:45,216][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:47:45,229][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:47:45,229][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 0, 'malformed_domain': 36, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.23232323232323232, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 11, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 01:47:51,849][root][INFO] - Setting global seed to 206
[2025-02-21 01:47:51,854][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:47:51,854][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:47:51,855][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:47:51,857][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:47:51,859][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:47:51,859][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:47:52,009][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:47:52,277][root][INFO] - Full model selected, loading model
[2025-02-21 01:48:08,658][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:48:08,658][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:48:15,099][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:48:15,101][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:48:15,101][root][INFO] - Starting inference
[2025-02-21 01:48:15,277][root][INFO] - Processing question number 0
[2025-02-21 01:48:15,280][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:48:44,749][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:49:15,051][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:49:44,947][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:50:15,274][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:50:45,058][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:51:14,793][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:51:45,334][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:52:15,385][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:52:45,086][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:53:15,419][root][INFO] - Processing question number 10
[2025-02-21 01:53:15,421][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:53:47,123][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:54:16,538][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:54:46,552][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:55:17,123][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:55:47,673][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:56:17,238][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:56:46,643][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:57:16,616][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:57:46,569][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:58:16,282][root][INFO] - Processing question number 20
[2025-02-21 01:58:16,284][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:58:46,166][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:59:16,278][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:59:45,850][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:00:15,293][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:00:45,498][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:01:15,496][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:01:46,280][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:02:16,178][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:02:46,264][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:03:15,593][root][INFO] - Processing question number 30
[2025-02-21 02:03:15,596][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:03:45,850][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:04:16,396][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:04:46,455][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:05:16,318][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:05:46,079][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:06:16,574][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:06:46,414][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:07:16,667][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:07:46,718][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:08:17,456][root][INFO] - Processing question number 40
[2025-02-21 02:08:17,469][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:08:47,586][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:09:17,687][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:09:48,274][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:10:18,799][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:10:48,587][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:11:18,703][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:11:50,284][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:12:19,505][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:12:49,469][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:13:20,075][root][INFO] - Processing question number 50
[2025-02-21 02:13:20,079][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:13:50,859][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:14:21,045][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:14:50,400][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:15:21,523][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:15:51,680][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:16:20,853][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:16:51,599][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:17:21,182][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:17:51,778][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:18:23,211][root][INFO] - Processing question number 60
[2025-02-21 02:18:23,215][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:18:52,785][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:19:22,664][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:19:53,176][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:20:22,723][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:20:52,752][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:21:22,838][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:21:52,955][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:22:23,377][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:22:53,570][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:23:24,251][root][INFO] - Processing question number 70
[2025-02-21 02:23:24,255][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:23:54,091][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:24:23,970][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:24:53,728][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:25:24,152][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:25:54,469][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:26:24,146][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:26:54,622][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:27:24,905][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:27:55,351][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:28:25,240][root][INFO] - Processing question number 80
[2025-02-21 02:28:25,245][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:28:55,554][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:29:25,845][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:29:55,614][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:30:25,564][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:30:56,330][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:31:26,859][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:31:57,494][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:32:27,405][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:32:57,774][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:33:27,376][root][INFO] - Processing question number 90
[2025-02-21 02:33:27,381][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:33:58,403][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:34:27,491][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:34:57,391][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:35:26,586][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:35:57,048][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:36:26,579][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:36:56,398][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:37:26,523][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:37:57,101][root][INFO] - Inference complete
[2025-02-21 02:37:57,101][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,108][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,109][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:37:57,109][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:37:57,110][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:37:57,111][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:37:57,111][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:37:57,113][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:37:57,114][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 02:37:57,114][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 02:37:57,115][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 02:37:57,115][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 02:37:57,116][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:37:57,116][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:37:57,118][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,118][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,118][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,118][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,119][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,119][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:37:57,119][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:37:57,120][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:37:57,120][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:37:57,121][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:37:57,122][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,140][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,140][root][INFO] - Saved parsed outputs
[2025-02-21 02:37:57,140][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,142][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,142][root][INFO] - Saved parsing metadata
[2025-02-21 02:37:57,142][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,144][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:37:57,157][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:37:57,173][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:37:57,173][root][INFO] - Summary of metrics : {'label_accuracy': 0.3434343434343434, 'misclassification_rate': 0.6565656565656566, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 99, 'correct_predictions': 34, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.2222222222222222, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 02:38:04,600][root][INFO] - Setting global seed to 206
[2025-02-21 02:38:04,605][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:38:04,606][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:38:04,607][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:38:04,609][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:38:04,611][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:38:04,611][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:38:04,809][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:38:05,058][root][INFO] - Full model selected, loading model
[2025-02-21 02:38:22,810][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:39:22,873][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:39:22,874][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:39:48,744][root][INFO] - Peft model loaded successfully
[2025-02-21 02:39:54,929][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:39:54,931][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:39:54,931][root][INFO] - Starting inference
[2025-02-21 02:39:55,116][root][INFO] - Processing question number 0
[2025-02-21 02:39:55,119][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:40:24,845][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:40:55,222][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:41:25,161][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:41:55,625][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:42:25,485][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:42:55,283][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:43:25,897][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:43:56,029][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:44:25,805][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:44:56,268][root][INFO] - Processing question number 10
[2025-02-21 02:44:56,270][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:45:28,054][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:45:57,655][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:46:27,766][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:46:58,394][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:47:28,996][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:47:58,680][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:48:28,213][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:48:58,236][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:49:28,237][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:49:57,971][root][INFO] - Processing question number 20
[2025-02-21 02:49:57,973][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:50:27,945][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:50:58,153][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:51:27,802][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:51:57,427][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:52:27,688][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:52:57,720][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:53:28,550][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:53:58,545][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:54:28,678][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:54:58,180][root][INFO] - Processing question number 30
[2025-02-21 02:54:58,183][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:55:28,564][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:55:59,188][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:56:29,302][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:56:59,252][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:57:29,082][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:57:59,611][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:58:29,530][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:58:59,963][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:59:30,115][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:00:00,951][root][INFO] - Processing question number 40
[2025-02-21 03:00:00,958][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:00:31,119][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:01:01,262][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:01:31,875][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:02:02,440][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:02:32,274][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:03:02,401][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:03:34,009][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:04:03,322][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:04:33,449][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:05:04,198][root][INFO] - Processing question number 50
[2025-02-21 03:05:04,202][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:05:35,078][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:06:05,315][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:06:34,789][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:07:05,945][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:07:36,142][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:08:05,335][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:08:36,180][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:09:05,799][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:09:36,448][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:10:07,925][root][INFO] - Processing question number 60
[2025-02-21 03:10:07,929][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:10:37,540][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:11:07,500][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:11:38,055][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:12:07,647][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:12:37,729][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:13:07,863][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:13:38,031][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:14:08,497][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:14:38,736][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:15:09,523][root][INFO] - Processing question number 70
[2025-02-21 03:15:09,527][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:15:39,454][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:16:09,426][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:16:39,232][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:17:09,673][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:17:40,151][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:18:10,038][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:18:40,667][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:19:11,176][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:19:41,783][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:20:11,905][root][INFO] - Processing question number 80
[2025-02-21 03:20:11,910][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:20:42,312][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:21:12,659][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:21:42,472][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:22:12,360][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:22:42,981][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:23:13,421][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:23:43,921][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:24:13,738][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:24:44,008][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:25:13,592][root][INFO] - Processing question number 90
[2025-02-21 03:25:13,597][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:25:44,622][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:26:13,710][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:26:43,684][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:27:12,909][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:27:43,419][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:28:12,996][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:28:42,898][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:29:13,079][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:29:43,715][root][INFO] - Inference complete
[2025-02-21 03:29:43,715][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,721][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,722][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,722][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,722][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,723][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:29:43,723][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,724][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:29:43,724][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:29:43,725][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,725][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:29:43,726][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,727][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,728][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,728][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,728][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,729][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:29:43,730][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:29:43,731][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,731][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:29:43,732][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,733][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,734][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,735][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,736][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,736][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,736][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,736][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:29:43,737][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,741][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,741][root][INFO] - Saved parsed outputs
[2025-02-21 03:29:43,741][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,743][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,743][root][INFO] - Saved parsing metadata
[2025-02-21 03:29:43,743][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,745][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:29:43,746][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:29:43,774][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:29:43,774][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 0, 'malformed_domain': 52, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 20, 'both_wrong': 32}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 03:29:51,006][root][INFO] - Setting global seed to 206
[2025-02-21 03:29:51,013][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:29:51,013][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:29:51,015][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:29:51,016][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:29:51,018][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:29:51,019][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:29:51,186][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:29:51,432][root][INFO] - Full model selected, loading model
[2025-02-21 03:30:04,759][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:30:04,759][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:30:11,206][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:30:11,208][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:30:11,208][root][INFO] - Starting inference
[2025-02-21 03:30:11,371][root][INFO] - Processing question number 0
[2025-02-21 03:30:11,376][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:30:40,739][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:31:11,017][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:31:40,863][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:32:11,173][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:32:40,940][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:33:10,657][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:33:41,166][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:34:11,202][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:34:40,885][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:35:11,208][root][INFO] - Processing question number 10
[2025-02-21 03:35:11,210][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:35:42,904][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:36:12,313][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:36:42,322][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:37:12,884][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:37:43,430][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:38:13,038][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:38:42,442][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:39:12,404][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:39:42,306][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:40:12,001][root][INFO] - Processing question number 20
[2025-02-21 03:40:12,004][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:40:41,901][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:41:12,034][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:41:41,612][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:42:11,037][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:42:41,245][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:43:11,231][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:43:41,968][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:44:11,884][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:44:41,978][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:45:11,336][root][INFO] - Processing question number 30
[2025-02-21 03:45:11,339][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:45:41,621][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:46:12,192][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:46:42,276][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:47:12,153][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:47:41,934][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:48:12,449][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:48:42,305][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:49:12,575][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:49:42,647][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:50:13,408][root][INFO] - Processing question number 40
[2025-02-21 03:50:13,412][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:50:43,534][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:51:13,644][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:51:44,213][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:52:14,734][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:52:44,534][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:53:14,608][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:53:45,992][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:54:15,150][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:54:45,121][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:55:15,733][root][INFO] - Processing question number 50
[2025-02-21 03:55:15,737][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:55:46,521][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:56:16,727][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:56:46,107][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:57:17,244][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:57:47,444][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:58:16,640][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:58:47,413][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:59:17,037][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:59:47,663][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:00:19,126][root][INFO] - Processing question number 60
[2025-02-21 04:00:19,130][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:00:48,741][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:01:18,704][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:01:49,246][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:02:18,807][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:02:48,856][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:03:18,950][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:03:49,072][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:04:19,506][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:04:49,707][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:05:20,390][root][INFO] - Processing question number 70
[2025-02-21 04:05:20,395][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:05:50,242][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:06:20,126][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:06:49,900][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:07:20,305][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:07:50,615][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:08:20,269][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:08:50,724][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:09:20,982][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:09:51,440][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:10:21,299][root][INFO] - Processing question number 80
[2025-02-21 04:10:21,304][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:10:51,589][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:11:21,869][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:11:51,660][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:12:21,485][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:12:52,080][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:13:22,495][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:13:52,975][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:14:22,755][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:14:52,992][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:15:22,566][root][INFO] - Processing question number 90
[2025-02-21 04:15:22,572][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:15:53,563][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:16:22,618][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:16:52,526][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:17:21,735][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:17:52,330][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:18:21,966][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:18:51,878][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:19:22,106][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:19:52,702][root][INFO] - Inference complete
[2025-02-21 04:19:52,703][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,709][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,711][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:19:52,715][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:19:52,719][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 04:19:52,720][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 04:19:52,722][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,735][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,735][root][INFO] - Saved parsed outputs
[2025-02-21 04:19:52,735][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,737][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,737][root][INFO] - Saved parsing metadata
[2025-02-21 04:19:52,737][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,739][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:19:52,749][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:19:52,778][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:19:52,778][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.18181818181818182, 'malformed_label': 0, 'malformed_domain': 45, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.24242424242424243, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 21, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 04:20:00,185][root][INFO] - Setting global seed to 989
[2025-02-21 04:20:00,192][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 04:20:00,192][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:20:00,193][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:20:00,194][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:20:00,197][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:20:00,198][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:20:00,352][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:20:00,651][root][INFO] - Full model selected, loading model
[2025-02-21 04:20:13,718][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:21:14,748][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:21:14,749][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:21:41,060][root][INFO] - Peft model loaded successfully
[2025-02-21 04:21:47,276][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:21:47,278][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:21:47,278][root][INFO] - Starting inference
[2025-02-21 04:21:47,505][root][INFO] - Processing question number 0
[2025-02-21 04:21:47,516][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:22:16,784][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:22:47,004][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:23:16,797][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:23:47,071][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:24:16,752][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:24:46,394][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:25:16,840][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:25:46,783][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:26:16,385][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:26:46,662][root][INFO] - Processing question number 10
[2025-02-21 04:26:46,664][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:27:18,269][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:27:47,678][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:28:17,599][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:28:48,086][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:29:18,578][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:29:48,062][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:30:17,469][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:30:47,367][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:31:17,222][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:31:46,837][root][INFO] - Processing question number 20
[2025-02-21 04:31:46,840][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:32:16,870][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:32:46,897][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:33:16,358][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:33:45,758][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:34:15,868][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:34:45,768][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:35:16,454][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:35:46,286][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:36:16,261][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:36:45,614][root][INFO] - Processing question number 30
[2025-02-21 04:36:45,618][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:37:15,843][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:37:46,312][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:38:16,298][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:38:46,110][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:39:15,788][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:39:46,200][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:40:15,976][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:40:46,205][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:41:16,174][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:41:46,871][root][INFO] - Processing question number 40
[2025-02-21 04:41:46,875][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:42:16,914][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:42:47,003][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:43:17,494][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:43:47,932][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:44:17,677][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:44:47,710][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:45:18,996][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:45:48,060][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:46:17,926][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:46:48,446][root][INFO] - Processing question number 50
[2025-02-21 04:46:48,450][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:47:19,177][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:47:49,265][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:48:18,753][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:48:49,872][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:49:20,031][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:49:49,235][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:50:19,933][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:50:49,419][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:51:19,912][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:51:51,295][root][INFO] - Processing question number 60
[2025-02-21 04:51:51,300][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:52:20,929][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:52:50,906][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:53:21,470][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:53:51,047][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:54:21,167][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:54:51,193][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:55:21,287][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:55:51,620][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:56:21,723][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:56:52,381][root][INFO] - Processing question number 70
[2025-02-21 04:56:52,386][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:57:22,183][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:57:52,009][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:58:21,687][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:58:51,998][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:59:22,255][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:59:51,810][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:00:22,167][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:00:52,373][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:01:22,735][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:01:52,528][root][INFO] - Processing question number 80
[2025-02-21 05:01:52,536][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:02:22,771][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:02:52,999][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:03:22,689][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:03:52,452][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:04:22,959][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:04:53,278][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:05:23,671][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:05:53,363][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:06:23,486][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:06:52,949][root][INFO] - Processing question number 90
[2025-02-21 05:06:52,955][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:07:23,838][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:07:52,789][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:08:22,625][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:08:51,701][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:09:22,074][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:09:51,551][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:10:21,329][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:10:51,360][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:11:21,877][root][INFO] - Inference complete
[2025-02-21 05:11:21,877][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,884][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,885][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,885][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,885][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,885][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,885][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,886][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,887][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,888][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,889][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,890][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,891][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,891][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,891][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:21,891][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,891][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,892][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,893][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,893][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:21,893][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:11:21,893][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,893][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,893][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,894][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:21,895][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,896][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,897][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,898][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,899][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:21,900][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,905][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,905][root][INFO] - Saved parsed outputs
[2025-02-21 05:11:21,905][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,906][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,906][root][INFO] - Saved parsing metadata
[2025-02-21 05:11:21,907][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,909][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:21,910][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:11:21,927][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 05:11:21,928][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.25252525252525254, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 05:11:28,484][root][INFO] - Setting global seed to 989
[2025-02-21 05:11:28,489][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 05:11:28,490][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:11:28,491][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:11:28,493][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:11:28,495][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:11:28,495][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:11:28,844][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:11:29,131][root][INFO] - Full model selected, loading model
[2025-02-21 05:11:46,158][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:11:46,159][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:11:52,624][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:11:52,625][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:11:52,625][root][INFO] - Starting inference
[2025-02-21 05:11:52,834][root][INFO] - Processing question number 0
[2025-02-21 05:11:52,836][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:12:21,952][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:12:52,044][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:13:21,700][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:13:51,826][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:14:21,399][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:14:50,929][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:15:21,248][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:15:51,095][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:16:20,586][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:16:50,719][root][INFO] - Processing question number 10
[2025-02-21 05:16:50,721][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:17:22,221][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:17:51,439][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:18:21,251][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:18:51,621][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:19:21,964][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:19:51,331][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:20:20,526][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:20:50,302][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:21:20,011][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:21:49,496][root][INFO] - Processing question number 20
[2025-02-21 05:21:49,498][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:22:19,225][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:22:49,146][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:23:18,685][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:23:47,922][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:24:17,916][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:24:47,697][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:25:18,218][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:25:47,916][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:26:17,837][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:26:46,987][root][INFO] - Processing question number 30
[2025-02-21 05:26:46,990][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:27:17,060][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:27:47,425][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:28:17,302][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:28:46,978][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:29:16,540][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:29:46,832][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:30:16,466][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:30:46,520][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:31:16,372][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:31:46,907][root][INFO] - Processing question number 40
[2025-02-21 05:31:46,911][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:32:16,822][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:32:46,722][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:33:17,083][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:33:47,398][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:34:16,978][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:34:46,849][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:35:18,025][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:35:46,980][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:36:16,737][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:36:47,134][root][INFO] - Processing question number 50
[2025-02-21 05:36:47,137][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:37:17,710][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:37:47,695][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:38:16,842][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:38:47,764][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:39:17,746][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:39:46,748][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:40:17,296][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:40:46,707][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:41:17,185][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:41:48,524][root][INFO] - Processing question number 60
[2025-02-21 05:41:48,533][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:42:17,892][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:42:47,568][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:43:18,036][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:43:47,560][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:44:17,501][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:44:47,547][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:45:17,583][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:45:47,923][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:46:17,912][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:46:48,383][root][INFO] - Processing question number 70
[2025-02-21 05:46:48,387][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:47:18,038][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:47:47,757][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:48:17,305][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:48:47,489][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:49:17,579][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:49:47,013][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:50:17,251][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:50:47,291][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:51:17,530][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:51:47,162][root][INFO] - Processing question number 80
[2025-02-21 05:51:47,167][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:52:17,235][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:52:47,294][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:53:16,849][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:53:46,453][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:54:16,822][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:54:47,018][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:55:17,271][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:55:46,827][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:56:16,836][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:56:46,174][root][INFO] - Processing question number 90
[2025-02-21 05:56:46,179][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:57:16,949][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:57:45,785][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:58:15,467][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:58:44,457][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:59:14,706][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:59:44,050][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:00:13,666][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:00:43,598][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:01:13,971][root][INFO] - Inference complete
[2025-02-21 06:01:13,971][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:13,978][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:13,979][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,979][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,980][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,980][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,980][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,980][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,981][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:01:13,982][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:01:13,983][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:01:13,983][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,983][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,984][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,984][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,984][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,985][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,985][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:01:13,985][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 06:01:13,985][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 06:01:13,986][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 06:01:13,987][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 06:01:13,987][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:01:13,988][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:01:13,988][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:01:13,989][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:01:13,989][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 06:01:13,990][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 06:01:13,991][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:01:13,991][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:01:13,991][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:01:13,992][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:01:13,993][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:13,998][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:13,998][root][INFO] - Saved parsed outputs
[2025-02-21 06:01:13,998][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:14,007][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:14,007][root][INFO] - Saved parsing metadata
[2025-02-21 06:01:14,007][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:14,009][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:01:14,010][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:01:14,037][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 06:01:14,037][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.24242424242424243, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.2222222222222222, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 12, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 06:01:21,207][root][INFO] - Setting global seed to 989
[2025-02-21 06:01:21,214][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 06:01:21,214][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:01:21,215][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:01:21,217][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:01:21,220][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:01:21,220][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:01:21,368][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:01:21,603][root][INFO] - Full model selected, loading model
[2025-02-21 06:01:34,570][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:02:35,221][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:02:35,222][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:03:01,484][root][INFO] - Peft model loaded successfully
[2025-02-21 06:03:07,719][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:03:07,720][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:03:07,720][root][INFO] - Starting inference
[2025-02-21 06:03:07,930][root][INFO] - Processing question number 0
[2025-02-21 06:03:07,939][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:03:37,468][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:04:07,851][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:04:37,797][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:05:08,231][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:05:38,047][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:06:07,828][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:06:38,390][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:07:08,484][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:07:38,220][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:08:08,786][root][INFO] - Processing question number 10
[2025-02-21 06:08:08,789][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:08:40,574][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:09:10,140][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:09:40,210][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:10:10,842][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:10:41,444][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:11:11,058][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:11:40,589][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:12:10,604][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:12:40,592][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:13:10,311][root][INFO] - Processing question number 20
[2025-02-21 06:13:10,313][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:13:40,285][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:14:10,456][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:14:40,067][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:15:09,618][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:15:39,872][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:16:09,903][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:16:40,727][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:17:10,712][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:17:40,833][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:18:10,300][root][INFO] - Processing question number 30
[2025-02-21 06:18:10,303][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:18:40,663][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:19:11,271][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:19:41,388][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:20:11,343][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:20:41,165][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:21:11,713][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:21:41,647][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:22:11,995][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:22:42,094][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:23:12,937][root][INFO] - Processing question number 40
[2025-02-21 06:23:12,940][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:23:43,104][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:24:13,250][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:24:43,867][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:25:14,434][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:25:44,264][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:26:14,372][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:26:45,798][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:27:15,002][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:27:45,180][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:28:16,011][root][INFO] - Processing question number 50
[2025-02-21 06:28:16,015][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:28:47,033][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:29:17,469][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:29:47,067][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:30:18,357][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:30:48,566][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:31:17,775][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:31:48,624][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:32:18,261][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:32:49,167][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:33:20,776][root][INFO] - Processing question number 60
[2025-02-21 06:33:20,780][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:33:50,512][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:34:20,653][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:34:51,242][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:35:20,846][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:35:50,937][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:36:21,074][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:36:51,249][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:37:21,727][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:37:51,958][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:38:22,739][root][INFO] - Processing question number 70
[2025-02-21 06:38:22,743][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:38:52,670][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:39:22,638][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:39:52,440][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:40:22,876][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:40:53,263][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:41:22,944][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:41:53,435][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:42:23,773][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:42:54,266][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:43:24,192][root][INFO] - Processing question number 80
[2025-02-21 06:43:24,197][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:43:54,556][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:44:24,908][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:44:54,730][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:45:24,630][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:45:55,261][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:46:25,706][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:46:56,212][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:47:26,033][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:47:56,301][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:48:25,887][root][INFO] - Processing question number 90
[2025-02-21 06:48:25,892][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:48:56,909][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:49:25,993][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:49:55,966][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:50:25,187][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:50:55,685][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:51:25,274][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:51:55,194][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:52:25,376][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:52:56,025][root][INFO] - Inference complete
[2025-02-21 06:52:56,025][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,039][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,039][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,040][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,041][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,042][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,043][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,044][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,045][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,046][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,047][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,048][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,049][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:52:56,050][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,050][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,050][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:52:56,050][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,050][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,050][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,051][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,052][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:52:56,052][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,052][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,052][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,052][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,053][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:52:56,054][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,074][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,074][root][INFO] - Saved parsed outputs
[2025-02-21 06:52:56,074][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,078][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,078][root][INFO] - Saved parsing metadata
[2025-02-21 06:52:56,080][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,087][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:52:56,090][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:52:56,135][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 06:52:56,135][root][INFO] - Summary of metrics : {'label_accuracy': 0.3434343434343434, 'misclassification_rate': 0.6565656565656566, 'combined_accuracy': 0.20202020202020202, 'malformed_label': 0, 'malformed_domain': 32, 'total_predictions': 99, 'correct_predictions': 34, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.23232323232323232, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 14, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 06:53:03,073][root][INFO] - Setting global seed to 989
[2025-02-21 06:53:03,080][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 06:53:03,080][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:53:03,082][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:53:03,083][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:53:03,085][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:53:03,085][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:53:03,252][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:53:03,500][root][INFO] - Full model selected, loading model
[2025-02-21 06:53:20,345][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:53:20,345][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:53:26,826][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:53:26,828][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:53:26,828][root][INFO] - Starting inference
[2025-02-21 06:53:27,030][root][INFO] - Processing question number 0
[2025-02-21 06:53:27,032][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:53:56,542][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:54:26,796][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:54:56,616][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:55:26,898][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:55:56,631][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:56:26,318][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:56:56,798][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:57:26,812][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:57:56,461][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:58:26,752][root][INFO] - Processing question number 10
[2025-02-21 06:58:26,754][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:58:58,414][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:59:27,793][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:59:57,804][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:00:28,532][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:00:59,053][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:01:28,585][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:01:57,955][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:02:27,896][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:02:57,765][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:03:27,415][root][INFO] - Processing question number 20
[2025-02-21 07:03:27,417][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:03:57,268][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:04:27,344][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:04:56,877][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:05:26,263][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:05:56,421][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:06:26,373][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:06:57,054][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:07:26,935][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:07:56,976][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:08:26,288][root][INFO] - Processing question number 30
[2025-02-21 07:08:26,291][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:08:56,525][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:09:27,046][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:09:57,081][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:10:26,915][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:10:56,644][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:11:27,109][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:11:56,914][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:12:27,135][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:12:57,153][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:13:27,853][root][INFO] - Processing question number 40
[2025-02-21 07:13:27,856][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:13:57,946][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:14:28,016][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:14:58,555][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:15:29,134][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:15:58,882][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:16:28,918][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:17:00,252][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:17:29,371][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:17:59,299][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:18:29,869][root][INFO] - Processing question number 50
[2025-02-21 07:18:29,873][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:19:00,605][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:19:30,747][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:20:00,074][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:20:31,167][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:21:01,291][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:21:30,436][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:22:01,152][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:22:30,708][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:23:01,273][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:23:32,674][root][INFO] - Processing question number 60
[2025-02-21 07:23:32,678][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:24:02,216][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:24:32,068][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:25:02,548][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:25:32,080][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:26:02,085][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:26:32,149][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:27:02,235][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:27:32,633][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:28:02,796][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:28:33,449][root][INFO] - Processing question number 70
[2025-02-21 07:28:33,453][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:29:03,267][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:29:33,124][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:30:02,859][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:30:33,222][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:31:03,489][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:31:33,094][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:32:03,506][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:32:33,727][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:33:04,133][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:33:33,938][root][INFO] - Processing question number 80
[2025-02-21 07:33:33,943][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:34:04,179][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:34:34,407][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:35:04,161][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:35:33,958][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:36:04,518][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:36:34,900][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:37:05,341][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:37:35,090][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:38:05,286][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:38:34,813][root][INFO] - Processing question number 90
[2025-02-21 07:38:34,819][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:39:05,767][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:39:34,789][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:40:04,653][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:40:33,830][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:41:04,276][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:41:33,798][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:42:03,597][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:42:33,715][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:43:04,276][root][INFO] - Inference complete
[2025-02-21 07:43:04,276][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,282][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,284][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:43:04,284][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:43:04,285][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:43:04,285][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:43:04,285][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:43:04,286][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:43:04,287][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:43:04,287][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:43:04,287][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:43:04,288][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:43:04,289][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:43:04,289][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:43:04,290][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:43:04,291][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 07:43:04,293][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 07:43:04,293][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 07:43:04,294][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 07:43:04,294][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 07:43:04,295][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,296][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,296][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,296][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,296][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,296][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:43:04,297][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,302][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,302][root][INFO] - Saved parsed outputs
[2025-02-21 07:43:04,302][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,304][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,304][root][INFO] - Saved parsing metadata
[2025-02-21 07:43:04,304][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,306][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:43:04,307][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:43:04,338][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 07:43:04,338][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.04040404040404041, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 10, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 07:43:11,495][root][INFO] - Setting global seed to 989
[2025-02-21 07:43:11,502][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 07:43:11,502][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:43:11,503][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:43:11,505][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:43:11,507][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:43:11,507][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:43:11,654][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:43:11,889][root][INFO] - Full model selected, loading model
[2025-02-21 07:43:29,366][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:44:29,904][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:44:29,905][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:44:56,185][root][INFO] - Peft model loaded successfully
[2025-02-21 07:45:02,383][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:45:02,384][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:45:02,384][root][INFO] - Starting inference
[2025-02-21 07:45:02,605][root][INFO] - Processing question number 0
[2025-02-21 07:45:02,607][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:45:32,136][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:46:02,543][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:46:32,518][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:47:02,960][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:47:32,811][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:48:02,626][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:48:33,221][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:49:03,353][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:49:33,122][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:50:03,577][root][INFO] - Processing question number 10
[2025-02-21 07:50:03,579][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:50:35,401][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:51:04,992][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:51:35,099][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:52:05,766][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:52:36,403][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:53:06,045][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:53:35,619][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:54:05,680][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:54:35,719][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:55:05,501][root][INFO] - Processing question number 20
[2025-02-21 07:55:05,503][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:55:35,535][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:56:05,727][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:56:35,371][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:57:04,948][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:57:35,233][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:58:05,295][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:58:36,162][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:59:06,202][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:59:36,368][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:00:05,862][root][INFO] - Processing question number 30
[2025-02-21 08:00:05,865][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:00:36,256][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:01:06,888][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:01:37,029][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:02:07,009][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:02:36,845][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:03:07,410][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:03:37,362][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:04:07,739][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:04:37,871][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:05:08,829][root][INFO] - Processing question number 40
[2025-02-21 08:05:08,834][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:05:39,093][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:06:09,344][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:06:40,096][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:07:10,685][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:07:40,540][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:08:10,674][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:08:42,130][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:09:11,354][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:09:41,385][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:10:12,081][root][INFO] - Processing question number 50
[2025-02-21 08:10:12,084][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:10:43,024][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:11:13,290][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:11:42,807][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:12:14,000][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:12:44,236][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:13:13,474][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:13:44,353][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:14:14,020][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:14:44,712][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:15:16,233][root][INFO] - Processing question number 60
[2025-02-21 08:15:16,237][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:15:45,886][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:16:15,890][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:16:46,494][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:17:16,150][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:17:46,275][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:18:16,448][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:18:46,653][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:19:17,152][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:19:47,434][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:20:18,252][root][INFO] - Processing question number 70
[2025-02-21 08:20:18,257][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:20:48,221][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:21:18,228][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:21:48,073][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:22:18,544][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:22:48,971][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:23:18,688][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:23:49,224][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:24:19,602][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:24:50,151][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:25:20,201][root][INFO] - Processing question number 80
[2025-02-21 08:25:20,206][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:25:50,602][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:26:20,991][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:26:50,845][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:27:20,777][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:27:51,433][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:28:21,900][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:28:52,430][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:29:22,271][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:29:52,574][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:30:22,191][root][INFO] - Processing question number 90
[2025-02-21 08:30:22,197][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:30:53,263][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:31:22,389][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:31:52,495][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:32:21,787][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:32:52,336][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:33:21,949][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:33:51,892][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:34:22,106][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:34:52,778][root][INFO] - Inference complete
[2025-02-21 08:34:52,778][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,785][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,786][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,786][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:34:52,787][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:34:52,787][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,787][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,788][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 25||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,789][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:34:52,789][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,790][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,790][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:34:52,790][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,790][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:34:52,790][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,790][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:34:52,790][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,790][root][ERROR] - |Q. 65||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,791][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 08:34:52,791][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 16||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 27||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 46||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,792][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 66||D: Contracts| Failed to extract chosen option: 
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 08:34:52,793][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 08:34:52,793][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,794][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 76||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 08:34:52,795][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:34:52,795][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,796][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:34:52,797][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:34:52,797][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,798][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:34:52,798][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 08:34:52,799][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,800][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,801][root][ERROR] - |Q. 74||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,801][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,801][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,801][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:34:52,801][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 08:34:52,802][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,814][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,814][root][INFO] - Saved parsed outputs
[2025-02-21 08:34:52,814][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,848][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,849][root][INFO] - Saved parsing metadata
[2025-02-21 08:34:52,849][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,851][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:34:52,858][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:34:52,878][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 08:34:52,878][root][INFO] - Summary of metrics : {'label_accuracy': 0.3333333333333333, 'misclassification_rate': 0.6666666666666667, 'combined_accuracy': 0.13131313131313133, 'malformed_label': 2, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 33, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.0707070707070707, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 20, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 08:34:59,592][root][INFO] - Setting global seed to 989
[2025-02-21 08:34:59,597][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 08:34:59,597][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:34:59,598][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:34:59,600][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:34:59,602][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:34:59,602][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:34:59,742][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:34:59,986][root][INFO] - Full model selected, loading model
[2025-02-21 08:35:11,962][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:35:11,962][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:35:18,434][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:35:18,435][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:35:18,435][root][INFO] - Starting inference
[2025-02-21 08:35:18,582][root][INFO] - Processing question number 0
[2025-02-21 08:35:18,584][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:35:47,931][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:36:18,216][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:36:48,154][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:37:18,495][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:37:48,233][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:38:17,927][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:38:48,410][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:39:18,426][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:39:48,073][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:40:18,370][root][INFO] - Processing question number 10
[2025-02-21 08:40:18,372][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:40:50,041][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:41:19,422][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:41:49,402][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:42:19,935][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:42:50,443][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:43:19,976][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:43:49,350][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:44:19,282][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:44:49,151][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:45:18,796][root][INFO] - Processing question number 20
[2025-02-21 08:45:18,798][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:45:48,645][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:46:18,720][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:46:48,251][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:47:17,633][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:47:47,792][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:48:17,739][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:48:48,427][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:49:18,293][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:49:48,334][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:50:17,651][root][INFO] - Processing question number 30
[2025-02-21 08:50:17,654][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:50:47,911][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:51:18,429][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:51:48,458][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:52:18,289][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:52:48,042][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:53:18,502][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:53:48,301][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:54:18,520][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:54:48,538][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:55:19,235][root][INFO] - Processing question number 40
[2025-02-21 08:55:19,239][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:55:49,312][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:56:19,383][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:56:49,898][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:57:20,367][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:57:50,102][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:58:20,131][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:58:51,467][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:59:20,571][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:59:50,481][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 09:00:21,035][root][INFO] - Processing question number 50
[2025-02-21 09:00:21,039][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:00:51,767][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 09:01:21,923][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 09:01:51,230][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 09:02:22,309][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 09:02:52,417][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 09:03:21,550][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 09:03:52,249][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 09:04:21,797][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 09:04:52,356][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 09:05:23,749][root][INFO] - Processing question number 60
[2025-02-21 09:05:23,753][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:05:53,273][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:06:23,111][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 09:06:53,579][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 09:07:23,088][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 09:07:53,081][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 09:08:23,128][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 09:08:53,203][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 09:09:23,580][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:09:53,733][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 09:10:24,517][root][INFO] - Processing question number 70
[2025-02-21 09:10:24,521][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 09:10:54,331][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 09:11:24,176][root][INFO] - Domain : Property, Question : 6
[2025-02-21 09:11:53,897][root][INFO] - Domain : Property, Question : 13
[2025-02-21 09:12:24,249][root][INFO] - Domain : Property, Question : 20
[2025-02-21 09:12:54,510][root][INFO] - Domain : Property, Question : 33
[2025-02-21 09:13:24,112][root][INFO] - Domain : Property, Question : 39
[2025-02-21 09:13:54,520][root][INFO] - Domain : Property, Question : 48
[2025-02-21 09:14:24,720][root][INFO] - Domain : Property, Question : 54
[2025-02-21 09:14:55,123][root][INFO] - Domain : Property, Question : 61
[2025-02-21 09:15:24,922][root][INFO] - Processing question number 80
[2025-02-21 09:15:24,945][root][INFO] - Domain : Property, Question : 67
[2025-02-21 09:15:55,182][root][INFO] - Domain : Property, Question : 75
[2025-02-21 09:16:25,407][root][INFO] - Domain : Property, Question : 83
[2025-02-21 09:16:55,139][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:17:24,907][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:17:55,447][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:18:25,810][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:18:56,231][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:19:25,961][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:19:56,138][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:20:25,674][root][INFO] - Processing question number 90
[2025-02-21 09:20:25,680][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:20:56,651][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:21:25,661][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:21:55,533][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:22:24,697][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:22:55,147][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:23:24,645][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:23:54,415][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:24:24,500][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:24:55,028][root][INFO] - Inference complete
[2025-02-21 09:24:55,029][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,035][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,040][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 09:24:55,043][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 09:24:55,044][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 09:24:55,046][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 09:24:55,048][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,052][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,052][root][INFO] - Saved parsed outputs
[2025-02-21 09:24:55,052][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,054][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,054][root][INFO] - Saved parsing metadata
[2025-02-21 09:24:55,054][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,055][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:24:55,057][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:24:55,094][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 09:24:55,094][root][INFO] - Summary of metrics : {'label_accuracy': 0.3333333333333333, 'misclassification_rate': 0.6666666666666667, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 0, 'malformed_domain': 41, 'total_predictions': 99, 'correct_predictions': 33, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.15151515151515152, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 11, 'both_wrong': 30}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 09:25:02,601][root][INFO] - Setting global seed to 206
[2025-02-21 09:25:02,607][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:25:02,608][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 09:25:02,609][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:25:02,610][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:25:02,613][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:25:02,613][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:25:02,764][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:25:03,066][root][INFO] - Full model selected, loading model
[2025-02-21 09:25:16,593][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:26:16,088][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:26:16,088][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:26:41,649][root][INFO] - Peft model loaded successfully
[2025-02-21 09:26:47,849][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:26:47,851][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:26:47,851][root][INFO] - Starting inference
[2025-02-21 09:26:48,051][root][INFO] - Processing question number 0
[2025-02-21 09:26:48,053][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:27:18,153][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:27:48,834][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:28:19,651][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:28:49,959][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:29:19,685][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:29:48,830][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:30:18,507][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:30:48,475][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:31:17,778][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:31:47,654][root][INFO] - Processing question number 10
[2025-02-21 09:31:47,656][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 09:32:16,719][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 09:32:46,383][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 09:33:16,186][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 09:33:45,517][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 09:34:15,769][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 09:34:45,639][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:35:15,447][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 09:35:45,099][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 09:36:15,312][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 09:36:45,617][root][INFO] - Processing question number 20
[2025-02-21 09:36:45,619][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 09:37:14,719][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 09:37:44,711][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:38:14,227][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 09:38:43,895][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 09:39:13,672][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 09:39:43,967][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 09:40:13,778][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 09:40:43,782][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:41:13,614][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 09:41:44,028][root][INFO] - Processing question number 30
[2025-02-21 09:41:44,032][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 09:42:13,915][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 09:42:43,670][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 09:43:13,328][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 09:43:43,708][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 09:44:13,503][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 09:44:43,421][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:45:13,277][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 09:45:43,796][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:46:13,828][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 09:46:43,839][root][INFO] - Processing question number 40
[2025-02-21 09:46:43,843][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 09:47:13,833][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 09:47:43,632][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 09:48:13,926][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 09:48:43,064][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 09:49:13,552][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 09:49:43,523][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:50:13,347][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:50:43,392][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 09:51:13,282][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 09:51:43,524][root][INFO] - Processing question number 50
[2025-02-21 09:51:43,527][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 09:52:14,006][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 09:52:43,446][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 09:53:13,933][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:53:44,040][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 09:54:13,521][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 09:54:43,268][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 09:55:13,919][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 09:55:44,292][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 09:56:14,673][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 09:56:44,865][root][INFO] - Processing question number 60
[2025-02-21 09:56:44,869][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 09:57:14,790][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 09:57:44,777][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 09:58:15,481][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 09:58:45,716][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 09:59:15,821][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 09:59:45,444][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:00:14,901][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:00:44,247][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:01:13,856][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:01:43,438][root][INFO] - Processing question number 70
[2025-02-21 10:01:43,443][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:02:13,727][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:02:43,868][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:03:14,269][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:03:45,056][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:04:14,565][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:04:44,771][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:05:15,995][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:05:46,192][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:06:15,336][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:06:44,922][root][INFO] - Processing question number 80
[2025-02-21 10:06:44,927][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:07:15,406][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:07:45,924][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:08:16,366][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:08:46,550][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:09:17,701][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:09:47,471][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:10:17,789][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:10:48,650][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:11:18,653][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:11:48,691][root][INFO] - Processing question number 90
[2025-02-21 10:11:48,696][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:12:18,711][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:12:49,092][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:13:19,306][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:13:49,259][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:14:19,915][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:14:50,390][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:15:20,601][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:15:50,391][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:16:19,743][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:16:50,244][root][INFO] - Inference complete
[2025-02-21 10:16:50,244][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,251][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,252][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,253][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,254][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,255][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,256][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,257][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,258][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,259][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,260][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,261][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,262][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,263][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,264][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,265][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,266][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,266][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,266][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 10:16:50,267][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,283][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,283][root][INFO] - Saved parsed outputs
[2025-02-21 10:16:50,283][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,285][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,285][root][INFO] - Saved parsing metadata
[2025-02-21 10:16:50,285][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,287][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:16:50,298][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:16:50,310][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 10:16:50,310][root][INFO] - Summary of metrics : {'label_accuracy': 0.3, 'misclassification_rate': 0.7, 'combined_accuracy': 0.21, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 30, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.25, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 9, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 10:16:56,945][root][INFO] - Setting global seed to 206
[2025-02-21 10:16:56,950][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 10:16:56,950][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 10:16:56,951][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:16:56,953][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:16:56,954][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:16:56,955][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:16:57,094][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:16:57,349][root][INFO] - Full model selected, loading model
[2025-02-21 10:17:09,097][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 10:17:09,097][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 10:17:15,515][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:17:15,517][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:17:15,517][root][INFO] - Starting inference
[2025-02-21 10:17:15,680][root][INFO] - Processing question number 0
[2025-02-21 10:17:15,689][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:17:45,624][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:18:16,165][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:18:46,904][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:19:17,137][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:19:46,753][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:20:15,804][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:20:45,390][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:21:15,258][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:21:44,383][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:22:14,166][root][INFO] - Processing question number 10
[2025-02-21 10:22:14,168][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:22:43,145][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:23:12,715][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:23:42,396][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:24:11,542][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:24:41,647][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:25:11,414][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:25:41,091][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:26:10,650][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:26:40,719][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:27:10,935][root][INFO] - Processing question number 20
[2025-02-21 10:27:10,937][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:27:39,960][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:28:09,841][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:28:39,265][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:29:08,845][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:29:38,486][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:30:08,689][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:30:38,421][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:31:08,345][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:31:38,079][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:32:08,398][root][INFO] - Processing question number 30
[2025-02-21 10:32:08,401][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:32:38,187][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:33:07,788][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:33:37,342][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:34:07,633][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:34:37,305][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:35:07,089][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:35:36,824][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:36:07,203][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:36:37,108][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:37:07,037][root][INFO] - Processing question number 40
[2025-02-21 10:37:07,040][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:37:36,937][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:38:06,657][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:38:36,859][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:39:05,916][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:39:36,312][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:40:06,194][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:40:35,880][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:41:05,776][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:41:35,570][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:42:05,687][root][INFO] - Processing question number 50
[2025-02-21 10:42:05,691][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:42:36,070][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:43:05,421][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:43:35,805][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:44:05,815][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:44:35,213][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:45:04,848][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:45:35,354][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:46:05,642][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:46:35,933][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:47:06,005][root][INFO] - Processing question number 60
[2025-02-21 10:47:06,010][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:47:35,860][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:48:05,791][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:48:36,438][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:49:06,785][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:49:37,288][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:50:07,108][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:50:36,703][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:51:06,135][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:51:35,913][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:52:05,621][root][INFO] - Processing question number 70
[2025-02-21 10:52:05,626][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:52:35,887][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:53:06,061][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:53:36,442][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:54:07,316][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:54:37,006][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:55:07,447][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:55:38,892][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:56:09,203][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:56:38,512][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:57:08,245][root][INFO] - Processing question number 80
[2025-02-21 10:57:08,250][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:57:38,894][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:58:09,538][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:58:40,118][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:59:10,421][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:59:41,634][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:00:11,502][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:00:41,986][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:01:12,974][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:01:43,147][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:02:13,319][root][INFO] - Processing question number 90
[2025-02-21 11:02:13,324][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:02:43,480][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:03:13,997][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:03:44,305][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:04:14,390][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:04:45,114][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:05:15,765][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:05:46,124][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:06:16,001][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:06:45,433][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:07:16,072][root][INFO] - Inference complete
[2025-02-21 11:07:16,073][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,080][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,081][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,081][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,082][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,082][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,082][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,083][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,083][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:07:16,083][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,084][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,084][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,084][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,085][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,085][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,085][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,085][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:07:16,086][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:07:16,086][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:07:16,087][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:07:16,087][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:07:16,087][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:07:16,088][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:07:16,089][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:07:16,089][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,090][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,090][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,090][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,091][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,091][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:07:16,091][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 11:07:16,092][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 11:07:16,092][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 11:07:16,092][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 11:07:16,093][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 11:07:16,093][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,093][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,094][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,094][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,094][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,095][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,095][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 11:07:16,096][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,101][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,101][root][INFO] - Saved parsed outputs
[2025-02-21 11:07:16,102][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,103][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,103][root][INFO] - Saved parsing metadata
[2025-02-21 11:07:16,104][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,105][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:07:16,107][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:07:16,119][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 11:07:16,119][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.16, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.22, 'Criminal_Law_confidence': 0.24, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 11:07:22,752][root][INFO] - Setting global seed to 206
[2025-02-21 11:07:22,758][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 11:07:22,758][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 11:07:22,759][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:07:22,761][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:07:22,763][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:07:22,763][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:07:23,000][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:07:23,430][root][INFO] - Full model selected, loading model
[2025-02-21 11:07:36,114][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 11:08:41,133][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 11:08:41,134][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 11:09:07,953][root][INFO] - Peft model loaded successfully
[2025-02-21 11:09:14,470][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:09:14,472][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:09:14,472][root][INFO] - Starting inference
[2025-02-21 11:09:14,686][root][INFO] - Processing question number 0
[2025-02-21 11:09:14,688][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:09:45,374][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:10:16,489][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:10:47,750][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:11:18,495][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:11:48,665][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:12:18,211][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:12:48,290][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:13:18,649][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:13:48,354][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:14:18,642][root][INFO] - Processing question number 10
[2025-02-21 11:14:18,645][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:14:48,128][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:15:18,163][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:15:48,398][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:16:18,115][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:16:48,778][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:17:19,067][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:17:49,275][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:18:19,329][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:18:49,964][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:19:20,679][root][INFO] - Processing question number 20
[2025-02-21 11:19:20,682][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:19:50,187][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:20:20,590][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:20:50,524][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:21:20,628][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:21:50,794][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:22:21,493][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:22:51,713][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:23:22,086][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:23:52,352][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:24:23,167][root][INFO] - Processing question number 30
[2025-02-21 11:24:23,171][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:24:53,476][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:25:23,622][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:25:53,699][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:26:24,484][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:26:54,714][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:27:25,017][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:27:55,268][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:28:26,184][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:28:56,581][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:29:27,003][root][INFO] - Processing question number 40
[2025-02-21 11:29:27,007][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:29:57,420][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:30:27,684][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:30:58,428][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:31:27,996][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:31:58,922][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:32:29,292][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:32:59,546][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:33:29,921][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:34:00,201][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:34:30,860][root][INFO] - Processing question number 50
[2025-02-21 11:34:30,864][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:35:01,744][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:35:31,578][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:36:02,489][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:36:33,002][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:37:02,890][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:37:33,047][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:38:04,131][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:38:34,934][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:39:05,706][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:39:36,321][root][INFO] - Processing question number 60
[2025-02-21 11:39:36,427][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:40:06,770][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:40:37,190][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:41:08,301][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:41:38,962][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:42:09,483][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:42:39,517][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:43:09,432][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:43:39,228][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:44:09,263][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:44:39,214][root][INFO] - Processing question number 70
[2025-02-21 11:44:39,219][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:45:09,754][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:45:40,216][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:46:10,904][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:46:42,141][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:47:12,269][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:47:43,051][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:48:14,870][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:48:45,566][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:49:15,144][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:49:45,121][root][INFO] - Processing question number 80
[2025-02-21 11:49:45,127][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:50:16,064][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:50:47,024][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:51:17,879][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:51:48,486][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:52:20,093][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:52:50,316][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:53:21,056][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:53:52,332][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:54:22,771][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:54:53,206][root][INFO] - Processing question number 90
[2025-02-21 11:54:53,212][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:55:23,664][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:55:54,505][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:56:25,181][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:56:55,565][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:57:26,623][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:57:57,549][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:58:28,173][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:58:58,373][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:59:28,165][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:59:59,096][root][INFO] - Inference complete
[2025-02-21 11:59:59,122][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,131][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,132][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,132][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,132][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,133][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,134][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,135][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,136][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,137][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,138][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,139][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,140][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,141][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,142][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,143][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,144][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,145][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,146][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,146][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,146][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,146][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,146][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,147][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,147][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,147][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,147][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 11:59:59,148][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,155][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,155][root][INFO] - Saved parsed outputs
[2025-02-21 11:59:59,155][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,157][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,157][root][INFO] - Saved parsing metadata
[2025-02-21 11:59:59,158][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,160][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:59:59,161][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:59:59,206][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 11:59:59,207][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.2, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.21, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 8, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 12:00:06,109][root][INFO] - Setting global seed to 206
[2025-02-21 12:00:06,116][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 12:00:06,116][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 12:00:06,118][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:00:06,120][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:00:06,122][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:00:06,122][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:00:06,282][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:00:06,552][root][INFO] - Full model selected, loading model
[2025-02-21 12:00:20,984][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 12:00:20,984][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 12:00:27,702][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:00:27,704][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:00:27,704][root][INFO] - Starting inference
[2025-02-21 12:00:27,892][root][INFO] - Processing question number 0
[2025-02-21 12:00:27,894][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:00:58,313][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:01:29,242][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:02:00,379][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:02:31,043][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:03:01,057][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:03:30,471][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:04:00,452][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:04:30,709][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:05:00,223][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:05:30,422][root][INFO] - Processing question number 10
[2025-02-21 12:05:30,425][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:05:59,812][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:06:29,748][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:06:59,836][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:07:29,353][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:07:59,858][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:08:30,026][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:09:00,097][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:09:30,030][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:10:00,514][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:10:31,139][root][INFO] - Processing question number 20
[2025-02-21 12:10:31,142][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:11:00,573][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:11:30,843][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:12:00,647][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:12:30,609][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:13:00,660][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:13:31,250][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:14:01,388][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:14:31,720][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:15:01,839][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:15:32,555][root][INFO] - Processing question number 30
[2025-02-21 12:15:32,559][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:16:02,743][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:16:32,738][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:17:02,695][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:17:33,377][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:18:03,441][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:18:33,635][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:19:03,790][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:19:34,568][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:20:04,889][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:20:35,200][root][INFO] - Processing question number 40
[2025-02-21 12:20:35,203][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:21:05,516][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:21:35,607][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:22:06,186][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:22:35,651][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:23:06,453][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:23:36,750][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:24:06,846][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:24:37,180][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:25:07,374][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:25:37,876][root][INFO] - Processing question number 50
[2025-02-21 12:25:37,881][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:26:08,715][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:26:38,446][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:27:09,244][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:27:39,658][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:28:09,472][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:28:39,496][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:29:10,417][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:29:41,123][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:30:11,808][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:30:42,277][root][INFO] - Processing question number 60
[2025-02-21 12:30:42,282][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:31:12,556][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:31:42,890][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:32:13,841][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:32:44,330][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:33:14,761][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:33:44,687][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:34:14,509][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:34:44,104][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:35:14,013][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:35:43,895][root][INFO] - Processing question number 70
[2025-02-21 12:35:43,902][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:36:14,311][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:36:44,622][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:37:15,117][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:37:46,149][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:38:15,988][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:38:46,452][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:39:18,002][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:39:48,491][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:40:18,009][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:40:48,050][root][INFO] - Processing question number 80
[2025-02-21 12:40:48,056][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:41:18,864][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:41:49,690][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:42:20,445][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:42:50,893][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:43:22,300][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:43:52,377][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:44:23,035][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:44:54,197][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:45:24,502][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:45:54,849][root][INFO] - Processing question number 90
[2025-02-21 12:45:54,855][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:46:25,196][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:46:55,895][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:47:26,344][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:47:56,649][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:48:27,578][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:48:58,356][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:49:28,827][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:49:58,904][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:50:28,467][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:50:59,289][root][INFO] - Inference complete
[2025-02-21 12:50:59,289][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,298][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,299][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:50:59,299][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:50:59,300][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:50:59,300][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:50:59,300][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 12:50:59,301][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,301][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,301][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,302][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,302][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,302][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 12:50:59,303][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:50:59,303][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:50:59,303][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:50:59,304][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 12:50:59,305][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:50:59,306][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:50:59,306][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 12:50:59,306][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 12:50:59,307][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 12:50:59,308][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 12:50:59,308][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 12:50:59,309][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 12:50:59,310][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 12:50:59,311][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 12:50:59,311][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 12:50:59,311][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 12:50:59,312][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,318][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,318][root][INFO] - Saved parsed outputs
[2025-02-21 12:50:59,318][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,320][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,320][root][INFO] - Saved parsing metadata
[2025-02-21 12:50:59,321][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,323][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:50:59,324][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:50:59,339][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 12:50:59,339][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.13, 'malformed_label': 0, 'malformed_domain': 40, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.26, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 11, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 12:51:06,011][root][INFO] - Setting global seed to 206
[2025-02-21 12:51:06,016][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 12:51:06,016][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 12:51:06,017][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:51:06,019][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:51:06,021][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:51:06,021][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:51:06,203][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:51:06,497][root][INFO] - Full model selected, loading model
[2025-02-21 12:51:18,233][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 12:52:23,026][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 12:52:23,026][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 12:52:50,381][root][INFO] - Peft model loaded successfully
[2025-02-21 12:52:56,792][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:52:56,794][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:52:56,794][root][INFO] - Starting inference
[2025-02-21 12:52:57,016][root][INFO] - Processing question number 0
[2025-02-21 12:52:57,018][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:53:27,706][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:53:58,809][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:54:30,070][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:55:00,846][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:55:31,084][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:56:00,698][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:56:30,844][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:57:01,302][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:57:31,064][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:58:01,412][root][INFO] - Processing question number 10
[2025-02-21 12:58:01,415][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:58:30,961][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:59:01,079][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:59:31,370][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:00:01,145][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:00:31,867][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:01:02,175][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:01:32,443][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:02:02,565][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:02:33,242][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:03:03,990][root][INFO] - Processing question number 20
[2025-02-21 13:03:03,993][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:03:33,564][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:04:04,000][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:04:33,991][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:05:04,110][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:05:34,357][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:06:05,130][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:06:35,429][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:07:05,866][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:07:36,158][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:08:07,047][root][INFO] - Processing question number 30
[2025-02-21 13:08:07,055][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:08:37,431][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:09:07,617][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:09:37,726][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:10:08,566][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:10:38,840][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:11:09,152][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:11:39,459][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:12:10,390][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:12:40,926][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:13:11,535][root][INFO] - Processing question number 40
[2025-02-21 13:13:11,538][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:13:42,058][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:14:12,408][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:14:43,239][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:15:12,811][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:15:43,753][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:16:14,171][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:16:44,434][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:17:14,882][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:17:45,229][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:18:15,966][root][INFO] - Processing question number 50
[2025-02-21 13:18:15,970][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:18:46,941][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:19:16,836][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:19:47,794][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:20:18,369][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:20:48,284][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:21:18,501][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:21:49,653][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:22:20,490][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:22:51,335][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:23:21,993][root][INFO] - Processing question number 60
[2025-02-21 13:23:22,006][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:23:52,445][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:24:22,933][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:24:54,133][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:25:24,853][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:25:55,441][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:26:25,551][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:26:55,499][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:27:25,343][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:27:55,405][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:28:25,443][root][INFO] - Processing question number 70
[2025-02-21 13:28:25,448][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:28:55,986][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:29:26,503][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:29:57,208][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:30:28,396][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:30:58,389][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:31:29,054][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:32:00,751][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:32:31,447][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:33:01,041][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:33:31,105][root][INFO] - Processing question number 80
[2025-02-21 13:33:31,114][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:34:02,094][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:34:33,060][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:35:03,972][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:35:34,621][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:36:06,255][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:36:36,496][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:37:07,285][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:37:38,630][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:38:09,102][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:38:39,639][root][INFO] - Processing question number 90
[2025-02-21 13:38:39,644][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:39:10,156][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:39:41,008][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:40:11,696][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:40:42,216][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:41:13,344][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:41:44,336][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:42:15,033][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:42:45,272][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:43:15,106][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:43:46,108][root][INFO] - Inference complete
[2025-02-21 13:43:46,108][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,118][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,120][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,120][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 13:43:46,120][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,120][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,120][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,120][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,121][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 13:43:46,121][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,121][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 13:43:46,121][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,121][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,121][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,121][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,122][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 13:43:46,123][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,123][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 13:43:46,123][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,124][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 13:43:46,124][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,125][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,126][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 13:43:46,126][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,127][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,128][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,129][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,130][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,131][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,132][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,133][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,134][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 13:43:46,135][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,143][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,143][root][INFO] - Saved parsed outputs
[2025-02-21 13:43:46,144][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,147][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,147][root][INFO] - Saved parsing metadata
[2025-02-21 13:43:46,148][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,150][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:43:46,151][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:43:46,174][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 13:43:46,174][root][INFO] - Summary of metrics : {'label_accuracy': 0.38, 'misclassification_rate': 0.62, 'combined_accuracy': 0.17, 'malformed_label': 0, 'malformed_domain': 58, 'total_predictions': 100, 'correct_predictions': 38, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.01, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 25, 'correct_label_wrong_domain': 21, 'both_wrong': 37}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 13:43:53,337][root][INFO] - Setting global seed to 206
[2025-02-21 13:43:53,343][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 13:43:53,343][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 13:43:53,344][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:43:53,345][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:43:53,347][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:43:53,347][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:43:53,519][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:43:53,784][root][INFO] - Full model selected, loading model
[2025-02-21 13:44:07,252][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 13:44:07,252][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 13:44:13,902][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:44:13,905][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:44:13,905][root][INFO] - Starting inference
[2025-02-21 13:44:14,086][root][INFO] - Processing question number 0
[2025-02-21 13:44:14,089][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:44:44,550][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:45:15,556][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:45:46,770][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:46:17,449][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:46:47,547][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:47:17,080][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:47:47,178][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:48:17,485][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:48:47,064][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:49:17,318][root][INFO] - Processing question number 10
[2025-02-21 13:49:17,322][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:49:46,751][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:50:16,784][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:50:46,942][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:51:16,571][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:51:47,153][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:52:17,382][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:52:47,574][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:53:17,599][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:53:48,111][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:54:18,735][root][INFO] - Processing question number 20
[2025-02-21 13:54:18,739][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:54:48,219][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:55:18,557][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:55:48,427][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:56:18,463][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:56:48,526][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:57:19,195][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:57:49,368][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:58:19,742][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:58:49,967][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:59:20,735][root][INFO] - Processing question number 30
[2025-02-21 13:59:20,739][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:59:50,969][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:00:21,005][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:00:51,015][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:01:21,770][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:01:51,909][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:02:22,128][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:02:52,344][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:03:23,180][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:03:53,558][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:04:23,997][root][INFO] - Processing question number 40
[2025-02-21 14:04:24,000][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:04:54,356][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:05:24,440][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:05:55,084][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:06:24,589][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:06:55,437][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:07:25,786][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:07:55,949][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:08:26,282][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:08:56,586][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:09:27,177][root][INFO] - Processing question number 50
[2025-02-21 14:09:27,182][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:09:58,027][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:10:27,827][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:10:58,709][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:11:29,191][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:11:59,044][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:12:29,096][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:13:00,065][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:13:30,815][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:14:01,575][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:14:32,105][root][INFO] - Processing question number 60
[2025-02-21 14:14:32,110][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:15:02,441][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:15:32,804][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:16:03,835][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:16:34,406][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:17:04,896][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:17:34,889][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:18:04,734][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:18:34,361][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:19:04,335][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:19:34,199][root][INFO] - Processing question number 70
[2025-02-21 14:19:34,206][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:20:04,662][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:20:35,029][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:21:05,595][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:21:36,662][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:22:06,532][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:22:37,052][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:23:08,652][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:23:39,185][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:24:08,715][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:24:38,680][root][INFO] - Processing question number 80
[2025-02-21 14:24:38,686][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:25:09,525][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:25:40,386][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:26:11,249][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:26:41,902][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:27:13,322][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:27:43,421][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:28:14,141][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:28:45,386][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:29:15,768][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:29:46,197][root][INFO] - Processing question number 90
[2025-02-21 14:29:46,202][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:30:16,606][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:30:47,337][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:31:17,893][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:31:48,244][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:32:19,217][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:32:50,090][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:33:20,624][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:33:50,710][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:34:20,355][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:34:51,251][root][INFO] - Inference complete
[2025-02-21 14:34:51,251][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,257][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,262][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 14:34:51,262][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 14:34:51,267][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 14:34:51,267][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 14:34:51,270][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,286][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,286][root][INFO] - Saved parsed outputs
[2025-02-21 14:34:51,286][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,288][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,288][root][INFO] - Saved parsing metadata
[2025-02-21 14:34:51,288][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,290][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:34:51,291][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:34:51,303][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 14:34:51,303][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.12, 'malformed_label': 0, 'malformed_domain': 50, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.24, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 14, 'both_wrong': 36}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 14:34:57,918][root][INFO] - Setting global seed to 989
[2025-02-21 14:34:57,924][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 14:34:57,924][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 14:34:57,925][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:34:57,926][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:34:57,928][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:34:57,928][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:34:58,095][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:34:58,383][root][INFO] - Full model selected, loading model
[2025-02-21 14:35:10,205][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 14:36:12,230][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 14:36:12,231][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 14:36:38,387][root][INFO] - Peft model loaded successfully
[2025-02-21 14:36:44,968][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:36:44,970][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:36:44,970][root][INFO] - Starting inference
[2025-02-21 14:36:45,154][root][INFO] - Processing question number 0
[2025-02-21 14:36:45,156][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:37:15,534][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:37:46,428][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:38:17,476][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:38:48,030][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:39:18,019][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:39:47,388][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:40:17,269][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:40:47,468][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:41:17,012][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:41:47,120][root][INFO] - Processing question number 10
[2025-02-21 14:41:47,123][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:42:16,424][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:42:46,282][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:43:16,322][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:43:45,880][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:44:16,379][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:44:46,511][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:45:16,535][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:45:46,429][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:46:16,887][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:46:47,435][root][INFO] - Processing question number 20
[2025-02-21 14:46:47,438][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:47:16,773][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:47:46,990][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:48:16,757][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:48:46,655][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:49:16,668][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:49:47,214][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:50:17,267][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:50:47,490][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:51:17,536][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:51:48,179][root][INFO] - Processing question number 30
[2025-02-21 14:51:48,184][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:52:18,275][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:52:48,211][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:53:18,090][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:53:48,680][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:54:18,721][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:54:48,839][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:55:18,951][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:55:49,715][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:56:19,920][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:56:50,170][root][INFO] - Processing question number 40
[2025-02-21 14:56:50,173][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:57:20,376][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:57:50,396][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:58:20,914][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:58:50,262][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:59:20,973][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:59:51,165][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:00:21,226][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:00:51,418][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:01:21,540][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:01:52,014][root][INFO] - Processing question number 50
[2025-02-21 15:01:52,018][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:02:22,744][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:02:52,398][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:03:23,176][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:03:53,531][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:04:23,317][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:04:53,307][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:05:24,214][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:05:54,825][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:06:25,436][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:06:55,858][root][INFO] - Processing question number 60
[2025-02-21 15:06:55,863][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:07:26,006][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:07:56,247][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:08:27,170][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:08:57,650][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:09:27,986][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:09:57,824][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:10:27,515][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:10:57,037][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:11:26,884][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:11:56,668][root][INFO] - Processing question number 70
[2025-02-21 15:11:56,673][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:12:27,018][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:12:57,261][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:13:27,766][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:13:58,725][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:14:28,484][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:14:58,933][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:15:30,402][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:16:00,810][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:16:30,218][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:17:00,022][root][INFO] - Processing question number 80
[2025-02-21 15:17:00,028][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:17:30,770][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:18:01,504][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:18:32,240][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:19:02,834][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:19:34,336][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:20:04,535][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:20:35,115][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:21:06,187][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:21:36,400][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:22:06,639][root][INFO] - Processing question number 90
[2025-02-21 15:22:06,644][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:22:36,889][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:23:07,493][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:23:37,948][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:24:08,124][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:24:39,013][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:25:09,720][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:25:40,171][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:26:10,198][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:26:39,804][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:27:10,573][root][INFO] - Inference complete
[2025-02-21 15:27:10,573][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,580][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,581][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,581][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,581][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,582][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,583][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,584][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,585][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,586][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,587][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,588][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,589][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,590][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,591][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,592][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,593][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 15:27:10,594][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,594][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,594][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,594][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,594][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,595][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,596][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 15:27:10,596][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,601][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,601][root][INFO] - Saved parsed outputs
[2025-02-21 15:27:10,602][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,625][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,625][root][INFO] - Saved parsing metadata
[2025-02-21 15:27:10,625][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,627][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:10,628][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:27:10,640][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:27:10,640][root][INFO] - Summary of metrics : {'label_accuracy': 0.3, 'misclassification_rate': 0.7, 'combined_accuracy': 0.21, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 30, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.25, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 9, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 15:27:17,362][root][INFO] - Setting global seed to 989
[2025-02-21 15:27:17,367][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:27:17,368][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 15:27:17,369][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:27:17,370][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:27:17,372][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:27:17,372][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:27:17,519][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:27:17,817][root][INFO] - Full model selected, loading model
[2025-02-21 15:27:29,661][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:27:29,661][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:27:36,295][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:27:36,296][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:27:36,296][root][INFO] - Starting inference
[2025-02-21 15:27:36,465][root][INFO] - Processing question number 0
[2025-02-21 15:27:36,477][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:28:06,589][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:28:37,341][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:29:08,306][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:29:38,741][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:30:08,588][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:30:37,846][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:31:07,671][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:31:37,736][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:32:07,078][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:32:37,054][root][INFO] - Processing question number 10
[2025-02-21 15:32:37,056][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:33:06,238][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:33:36,019][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:34:05,911][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:34:35,269][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:35:05,599][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:35:35,606][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:36:05,504][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:36:35,345][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:37:05,623][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:37:36,066][root][INFO] - Processing question number 20
[2025-02-21 15:37:36,069][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:38:05,306][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:38:35,390][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:39:05,069][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:39:34,893][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:40:04,753][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:40:35,185][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:41:05,142][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:41:35,294][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:42:05,243][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:42:35,793][root][INFO] - Processing question number 30
[2025-02-21 15:42:35,797][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:43:05,799][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:43:35,640][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:44:05,403][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:44:35,887][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:45:05,752][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:45:35,762][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:46:05,749][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:46:36,359][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:47:06,509][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:47:36,686][root][INFO] - Processing question number 40
[2025-02-21 15:47:36,689][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:48:06,773][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:48:36,654][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:49:07,071][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:49:36,354][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:50:06,953][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:50:37,030][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:51:06,942][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:51:37,063][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:52:07,089][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:52:37,454][root][INFO] - Processing question number 50
[2025-02-21 15:52:37,458][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:53:08,064][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:53:37,636][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:54:08,223][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:54:38,449][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:55:08,059][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:55:37,891][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:56:08,612][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:56:39,163][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:57:09,679][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:57:39,984][root][INFO] - Processing question number 60
[2025-02-21 15:57:39,988][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:58:10,080][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:58:40,198][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:59:10,985][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:59:41,324][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:00:11,570][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:00:41,326][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:01:10,918][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:01:40,300][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:02:10,021][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:02:39,707][root][INFO] - Processing question number 70
[2025-02-21 16:02:39,713][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:03:09,947][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:03:40,044][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:04:10,354][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:04:41,221][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:05:10,922][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:05:41,189][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:06:12,524][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:06:42,804][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:07:12,108][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:07:41,843][root][INFO] - Processing question number 80
[2025-02-21 16:07:41,849][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:08:12,466][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:08:43,090][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:09:13,661][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:09:43,926][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:10:15,131][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:10:44,983][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:11:15,440][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:11:46,444][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:12:16,597][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:12:46,897][root][INFO] - Processing question number 90
[2025-02-21 16:12:46,903][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:13:17,078][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:13:47,577][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:14:17,877][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:14:47,953][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:15:18,693][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:15:49,281][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:16:19,597][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:16:49,484][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:17:18,883][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:17:49,503][root][INFO] - Inference complete
[2025-02-21 16:17:49,504][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,512][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,513][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,513][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,514][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,514][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,514][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,514][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,515][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 16:17:49,515][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,516][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,516][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,516][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,516][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,517][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,517][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,517][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 16:17:49,518][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:17:49,518][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:17:49,519][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:17:49,519][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:17:49,519][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 16:17:49,520][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:17:49,520][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 16:17:49,521][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,522][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,522][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,522][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,522][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,523][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 16:17:49,523][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 16:17:49,523][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 16:17:49,524][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 16:17:49,524][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 16:17:49,524][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 16:17:49,525][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,525][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,525][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,526][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,526][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,526][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,526][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 16:17:49,528][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,533][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,533][root][INFO] - Saved parsed outputs
[2025-02-21 16:17:49,533][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,535][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,535][root][INFO] - Saved parsing metadata
[2025-02-21 16:17:49,535][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,537][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:17:49,538][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:17:49,551][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 16:17:49,551][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.16, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.22, 'Criminal_Law_confidence': 0.24, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 16:17:56,020][root][INFO] - Setting global seed to 989
[2025-02-21 16:17:56,025][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 16:17:56,025][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 16:17:56,027][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:17:56,028][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:17:56,030][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:17:56,030][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:17:56,197][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:17:56,559][root][INFO] - Full model selected, loading model
[2025-02-21 16:18:08,417][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 16:19:10,900][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 16:19:10,900][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 16:19:35,921][root][INFO] - Peft model loaded successfully
[2025-02-21 16:19:42,439][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:19:42,441][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:19:42,441][root][INFO] - Starting inference
[2025-02-21 16:19:42,667][root][INFO] - Processing question number 0
[2025-02-21 16:19:42,669][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:20:13,293][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:20:44,373][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:21:15,572][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:21:46,268][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:22:16,405][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:22:45,934][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:23:15,990][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:23:46,332][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:24:16,022][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:24:46,294][root][INFO] - Processing question number 10
[2025-02-21 16:24:46,297][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:25:15,740][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:25:45,806][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:26:16,034][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:26:45,723][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:27:16,399][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:27:46,663][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:28:16,856][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:28:46,900][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:29:17,534][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:29:48,239][root][INFO] - Processing question number 20
[2025-02-21 16:29:48,242][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:30:17,717][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:30:48,067][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:31:17,965][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:31:48,026][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:32:18,213][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:32:48,895][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:33:19,125][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:33:49,515][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:34:19,744][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:34:50,547][root][INFO] - Processing question number 30
[2025-02-21 16:34:50,550][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:35:20,841][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:35:50,946][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:36:20,994][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:36:51,747][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:37:21,940][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:37:52,200][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:38:22,428][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:38:53,290][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:39:23,696][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:39:54,100][root][INFO] - Processing question number 40
[2025-02-21 16:39:54,104][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:40:24,474][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:40:54,684][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:41:25,396][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:41:54,916][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:42:25,819][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:42:56,167][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:43:26,369][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:43:56,725][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:44:27,019][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:44:57,696][root][INFO] - Processing question number 50
[2025-02-21 16:44:57,700][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:45:28,572][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:45:58,371][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:46:29,221][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:46:59,722][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:47:29,583][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:47:59,745][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:48:30,777][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:49:01,524][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:49:32,329][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:50:02,977][root][INFO] - Processing question number 60
[2025-02-21 16:50:02,982][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:50:33,362][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:51:03,795][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:51:34,908][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:52:05,526][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:52:36,017][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:53:06,026][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:53:35,873][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:54:05,638][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:54:35,616][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:55:05,553][root][INFO] - Processing question number 70
[2025-02-21 16:55:05,558][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:55:36,045][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:56:06,429][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:56:37,063][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:57:08,216][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:57:38,136][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:58:08,745][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:58:40,353][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:59:10,967][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:59:40,521][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:00:10,495][root][INFO] - Processing question number 80
[2025-02-21 17:00:10,501][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:00:41,389][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:01:12,312][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:01:43,150][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:02:13,737][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:02:45,274][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:03:15,446][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:03:46,161][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:04:17,519][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:04:48,100][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:05:18,658][root][INFO] - Processing question number 90
[2025-02-21 17:05:18,663][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:05:49,275][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:06:20,120][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:06:50,756][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:07:21,115][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:07:52,146][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:08:23,026][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:08:53,625][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:09:23,833][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:09:53,598][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:10:24,525][root][INFO] - Inference complete
[2025-02-21 17:10:24,525][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,531][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,532][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,532][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,532][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,533][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,534][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,534][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,534][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,534][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,534][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,535][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 17:10:24,536][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,537][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 17:10:24,538][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,539][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,540][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,541][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,542][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,543][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,544][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 17:10:24,544][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,544][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,544][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,544][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,544][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 17:10:24,544][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,545][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,546][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,547][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,547][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 17:10:24,547][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,552][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,552][root][INFO] - Saved parsed outputs
[2025-02-21 17:10:24,552][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,553][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,553][root][INFO] - Saved parsing metadata
[2025-02-21 17:10:24,554][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,555][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:24,557][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:10:24,614][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 17:10:24,614][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.2, 'malformed_label': 1, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.26, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 12, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 17:10:31,185][root][INFO] - Setting global seed to 989
[2025-02-21 17:10:31,190][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 17:10:31,191][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 17:10:31,192][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:10:31,193][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:10:31,195][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:10:31,195][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:10:31,353][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:10:31,618][root][INFO] - Full model selected, loading model
[2025-02-21 17:10:43,386][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 17:10:43,386][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 17:10:50,194][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:10:50,195][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:10:50,195][root][INFO] - Starting inference
[2025-02-21 17:10:50,378][root][INFO] - Processing question number 0
[2025-02-21 17:10:50,384][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:11:20,842][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:11:51,800][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:12:23,009][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:12:53,649][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:13:23,682][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:13:53,111][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:14:23,113][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:14:53,397][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:15:22,935][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:15:53,125][root][INFO] - Processing question number 10
[2025-02-21 17:15:53,138][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:16:22,550][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:16:52,512][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:17:22,605][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:17:52,149][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:18:22,669][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:18:52,854][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:19:22,940][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:19:52,907][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:20:23,403][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:20:54,027][root][INFO] - Processing question number 20
[2025-02-21 17:20:54,029][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:21:23,494][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:21:53,770][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:22:23,595][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:22:53,568][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:23:23,629][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:23:54,237][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:24:24,370][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:24:54,699][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:25:24,819][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:25:55,517][root][INFO] - Processing question number 30
[2025-02-21 17:25:55,520][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:26:25,723][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:26:55,725][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:27:25,723][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:27:56,458][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:28:26,538][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:28:56,741][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:29:26,878][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:29:57,665][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:30:27,984][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:30:58,302][root][INFO] - Processing question number 40
[2025-02-21 17:30:58,305][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:31:28,653][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:31:58,742][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:32:29,367][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:32:58,820][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:33:29,621][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:33:59,883][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:34:29,991][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:35:00,267][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:35:30,494][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:36:01,007][root][INFO] - Processing question number 50
[2025-02-21 17:36:01,011][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:36:31,829][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:37:01,585][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:37:32,402][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:38:02,850][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:38:32,662][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:39:02,701][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:39:33,616][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:40:04,317][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:40:34,999][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:41:05,449][root][INFO] - Processing question number 60
[2025-02-21 17:41:05,453][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:41:35,700][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:42:05,997][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:42:36,965][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:43:07,463][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:43:37,891][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:44:07,898][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:44:37,696][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:45:07,266][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:45:37,205][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:46:07,073][root][INFO] - Processing question number 70
[2025-02-21 17:46:07,078][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:46:37,497][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:47:07,796][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:47:38,330][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:48:09,367][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:48:39,207][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:49:09,685][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:49:41,233][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:50:11,714][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:50:41,161][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:51:11,067][root][INFO] - Processing question number 80
[2025-02-21 17:51:11,072][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:51:41,865][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:52:12,729][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:52:43,515][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:53:13,983][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:53:45,405][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:54:15,517][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:54:46,154][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:55:17,335][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:55:47,689][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:56:18,034][root][INFO] - Processing question number 90
[2025-02-21 17:56:18,040][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:56:48,396][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:57:19,085][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:57:49,623][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:58:20,002][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:58:50,929][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:59:21,747][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:59:52,241][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:00:22,297][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:00:51,881][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:01:22,697][root][INFO] - Inference complete
[2025-02-21 18:01:22,697][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,704][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,705][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:01:22,705][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:01:22,707][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:01:22,707][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:01:22,708][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:01:22,708][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:01:22,709][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:01:22,709][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:01:22,709][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:01:22,711][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:01:22,711][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:01:22,712][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:01:22,713][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:01:22,713][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:01:22,713][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:01:22,714][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 18:01:22,714][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 18:01:22,715][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 18:01:22,716][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 18:01:22,717][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 18:01:22,718][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,723][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,723][root][INFO] - Saved parsed outputs
[2025-02-21 18:01:22,723][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,725][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,725][root][INFO] - Saved parsing metadata
[2025-02-21 18:01:22,726][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,727][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:01:22,729][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:01:22,741][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 18:01:22,741][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.16, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.25, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 11, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 18:01:29,545][root][INFO] - Setting global seed to 989
[2025-02-21 18:01:29,550][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 18:01:29,550][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 18:01:29,552][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:01:29,553][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:01:29,555][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:01:29,555][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:01:29,706][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:01:29,968][root][INFO] - Full model selected, loading model
[2025-02-21 18:01:41,521][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 18:02:43,705][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 18:02:43,706][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 18:03:10,570][root][INFO] - Peft model loaded successfully
[2025-02-21 18:03:16,984][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:03:16,985][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:03:16,985][root][INFO] - Starting inference
[2025-02-21 18:03:17,179][root][INFO] - Processing question number 0
[2025-02-21 18:03:17,181][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:03:47,805][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:04:18,878][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:04:50,097][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:05:20,787][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:05:50,943][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:06:20,493][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:06:50,571][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:07:20,933][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:07:50,622][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:08:20,894][root][INFO] - Processing question number 10
[2025-02-21 18:08:20,898][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:08:50,382][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:09:20,418][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:09:50,616][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:10:20,357][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:10:51,009][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:11:21,225][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:11:51,441][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:12:21,509][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:12:52,121][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:13:22,800][root][INFO] - Processing question number 20
[2025-02-21 18:13:22,803][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:13:52,289][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:14:22,680][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:14:52,599][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:15:22,653][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:15:52,843][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:16:23,514][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:16:53,735][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:17:24,127][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:17:54,376][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:18:25,196][root][INFO] - Processing question number 30
[2025-02-21 18:18:25,200][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:18:55,442][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:19:25,568][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:19:55,600][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:20:26,329][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:20:56,301][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:21:26,342][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:21:56,325][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:22:26,946][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:22:57,097][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:23:27,274][root][INFO] - Processing question number 40
[2025-02-21 18:23:27,277][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:23:57,423][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:24:27,385][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:24:57,837][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:25:27,131][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:25:57,786][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:26:27,950][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:26:58,067][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:27:28,548][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:27:58,907][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:28:29,785][root][INFO] - Processing question number 50
[2025-02-21 18:28:29,789][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:29:00,450][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:29:30,049][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:30:00,716][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:30:30,996][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:31:00,656][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:31:30,588][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:32:01,429][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:32:31,981][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:33:02,553][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:33:32,945][root][INFO] - Processing question number 60
[2025-02-21 18:33:32,949][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:34:03,079][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:34:33,269][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:35:04,181][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:35:34,620][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:36:04,914][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:36:34,758][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:37:04,444][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:37:34,013][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:38:03,837][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:38:33,608][root][INFO] - Processing question number 70
[2025-02-21 18:38:33,612][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:39:03,918][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:39:34,125][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:40:04,568][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:40:35,498][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:41:05,234][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:41:35,632][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:42:07,049][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:42:31,416][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:43:00,758][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:43:30,544][root][INFO] - Processing question number 80
[2025-02-21 18:43:30,549][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:44:01,228][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:44:31,943][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:45:02,589][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:45:32,969][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:46:04,329][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:46:34,288][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:47:04,795][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:47:35,856][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:48:06,052][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:48:36,275][root][INFO] - Processing question number 90
[2025-02-21 18:48:36,300][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:49:06,524][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:49:37,125][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:50:07,730][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:50:38,007][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:51:08,985][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:51:39,769][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:52:10,184][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:52:40,156][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:53:09,704][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:53:40,432][root][INFO] - Inference complete
[2025-02-21 18:53:40,433][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,440][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,441][root][ERROR] - |Q. 1||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,441][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 18:53:40,441][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,441][root][ERROR] - |Q. 13||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,442][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,443][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 18:53:40,443][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - |Q. 71||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,444][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,445][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 18:53:40,445][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,446][root][ERROR] - |Q. 28||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,446][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 18:53:40,446][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,446][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,446][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 18:53:40,446][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,446][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 18:53:40,446][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,447][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 18:53:40,447][root][ERROR] - |Q. 10||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,448][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 18:53:40,448][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,449][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 47||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,450][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,451][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 18:53:40,451][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,452][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 18:53:40,452][root][ERROR] - |Q. 36||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,452][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,452][root][ERROR] - |Q. 59||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,452][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 18:53:40,452][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,452][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,453][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,454][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,455][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,455][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,455][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,455][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 18:53:40,455][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 18:53:40,456][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,461][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,461][root][INFO] - Saved parsed outputs
[2025-02-21 18:53:40,461][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,462][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,463][root][INFO] - Saved parsing metadata
[2025-02-21 18:53:40,463][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,465][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:53:40,467][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:53:40,479][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 18:53:40,479][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.12, 'malformed_label': 0, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.15, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 10, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 19 to status running with exit code None
Eval status update completed for job 19
[2025-02-21 18:53:46,781][root][INFO] - Setting global seed to 989
[2025-02-21 18:53:46,786][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 18:53:46,786][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 18:53:46,787][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:53:46,789][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:53:46,790][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:53:46,791][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:53:46,949][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:53:47,220][root][INFO] - Full model selected, loading model
[2025-02-21 18:53:59,262][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 18:53:59,262][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 18:54:05,840][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:54:05,841][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:54:05,841][root][INFO] - Starting inference
[2025-02-21 18:54:06,013][root][INFO] - Processing question number 0
[2025-02-21 18:54:06,015][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:54:36,193][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:55:06,918][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:55:37,845][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:56:08,264][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:56:38,067][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:57:07,311][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:57:37,082][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:58:07,142][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:58:36,465][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:59:06,430][root][INFO] - Processing question number 10
[2025-02-21 18:59:06,432][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:59:35,597][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 19:00:05,352][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 19:00:35,214][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 19:01:04,550][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 19:01:34,848][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 19:02:04,808][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 19:02:34,671][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 19:03:04,419][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 19:03:34,678][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 19:04:05,080][root][INFO] - Processing question number 20
[2025-02-21 19:04:05,083][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 19:04:34,293][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 19:05:04,362][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 19:05:33,974][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 19:06:03,735][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 19:06:33,563][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 19:07:03,959][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 19:07:33,886][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 19:08:03,977][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 19:08:33,905][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 19:09:04,415][root][INFO] - Processing question number 30
[2025-02-21 19:09:04,418][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 19:09:34,391][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 19:10:04,175][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 19:10:33,922][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 19:11:04,392][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 19:11:34,255][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 19:12:04,224][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 19:12:34,150][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 19:13:04,718][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 19:13:34,811][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 19:14:04,926][root][INFO] - Processing question number 40
[2025-02-21 19:14:04,929][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 19:14:35,011][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 19:15:04,867][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 19:15:35,260][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 19:16:04,507][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 19:16:35,092][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 19:17:05,160][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 19:17:35,035][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 19:18:05,112][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 19:18:35,095][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:19:05,398][root][INFO] - Processing question number 50
[2025-02-21 19:19:05,401][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:19:35,973][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:20:05,503][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:20:36,081][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:21:06,277][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:21:35,863][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:22:05,672][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:22:36,370][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:23:06,841][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:23:37,313][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:24:07,558][root][INFO] - Processing question number 60
[2025-02-21 19:24:07,562][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:24:37,596][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:25:07,687][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:25:38,443][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:26:08,735][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:26:38,940][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:27:08,667][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:27:38,235][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:28:07,598][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:28:37,308][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:29:06,956][root][INFO] - Processing question number 70
[2025-02-21 19:29:06,961][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:29:37,173][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:30:07,278][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:30:37,582][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:31:08,454][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:31:38,090][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:32:08,342][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:32:39,663][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:33:09,932][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:33:39,189][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:34:08,886][root][INFO] - Processing question number 80
[2025-02-21 19:34:08,891][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:34:39,472][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:35:10,091][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:35:40,631][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:36:10,872][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:36:42,059][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:37:11,898][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:37:42,326][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:38:13,294][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:38:43,411][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:39:13,550][root][INFO] - Processing question number 90
[2025-02-21 19:39:13,556][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:39:43,701][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:40:14,192][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:40:44,470][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:41:14,536][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:41:45,239][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:42:15,826][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:42:46,107][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:43:15,971][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:43:45,520][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:44:16,122][root][INFO] - Inference complete
[2025-02-21 19:44:16,122][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,129][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,133][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 19:44:16,136][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 19:44:16,137][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 19:44:16,139][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 19:44:16,139][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 19:44:16,142][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,147][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,147][root][INFO] - Saved parsed outputs
[2025-02-21 19:44:16,147][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,148][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,148][root][INFO] - Saved parsing metadata
[2025-02-21 19:44:16,149][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,150][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:44:16,151][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:44:16,178][root][INFO] - Evaluation completed for markdown_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 19:44:16,178][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.1, 'malformed_label': 0, 'malformed_domain': 46, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 10, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.24, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 12, 'both_wrong': 34}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '19', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 19 to status completed with exit code 0
Eval status update completed for job 19
Job 19 completed at Fri Feb 21 19:44:17 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n517
Job ID: 25309354
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 20:32:07
CPU Efficiency: 9.95% of 8-14:17:20 core-walltime
Job Wall-clock time: 20:37:44
Memory Utilized: 27.87 GB
Memory Efficiency: 77.43% of 36.00 GB
