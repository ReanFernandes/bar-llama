Starting job 12 at Do 20. Feb 10:02:33 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=number_list_fact_first_few_shot_unstructured train=number_list_fact_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
[2025-02-20 10:02:50,181][root][INFO] - Global seed set to 314
[2025-02-20 10:02:50,183][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 10:02:50,183][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 10:02:50,183][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 10:02:50,183][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 10:02:50,183][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 10:02:50,200][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 10:02:50,253][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 10:02:50,256][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 10:02:50,292][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 10:02:51,025][root][INFO] - Tokenizer meta-llama/Meta-Llama-3-8B-Instruct loaded successfully
[2025-02-20 10:03:15,648][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 10:03:43,796][root][INFO] - Model prepared for kbit training
[2025-02-20 10:03:43,797][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'up_proj', 'v_proj', 'down_proj', 'k_proj', 'gate_proj', 'o_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 10:03:45,538][root][INFO] - Lora adapter added to model
[2025-02-20 10:03:45,542][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_unstructured
[2025-02-20 10:03:45,775][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.5058, 'grad_norm': 0.3599128723144531, 'learning_rate': 3.226975564787322e-05, 'epoch': 10.0}
{'train_runtime': 416.1142, 'train_samples_per_second': 0.252, 'train_steps_per_second': 0.036, 'train_loss': 1.3215726216634114, 'epoch': 15.0}
[2025-02-20 10:10:50,420][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_unstructured
Starting evaluations for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
[2025-02-20 10:10:59,663][root][INFO] - Setting global seed to 206
[2025-02-20 10:10:59,669][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 10:10:59,670][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 10:10:59,671][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 10:10:59,673][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 10:10:59,675][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 10:10:59,675][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 10:10:59,819][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 10:11:00,478][root][INFO] - Full model selected, loading model
[2025-02-20 10:11:23,734][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 10:13:12,676][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 10:13:12,677][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 10:13:46,605][root][INFO] - Peft model loaded successfully
[2025-02-20 10:13:56,880][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 10:13:56,881][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:13:56,881][root][INFO] - Starting inference
[2025-02-20 10:13:57,034][root][INFO] - Processing question number 0
[2025-02-20 10:13:57,036][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 10:14:05,579][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 10:14:36,853][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 10:14:50,156][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 10:15:00,929][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 10:15:12,696][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 10:15:21,263][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 10:15:52,633][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 10:15:58,586][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 10:16:09,941][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 10:16:41,091][root][INFO] - Processing question number 10
[2025-02-20 10:16:41,093][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 10:16:55,671][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 10:17:08,151][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 10:17:12,453][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 10:17:18,695][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 10:17:25,562][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 10:17:56,173][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 10:18:26,769][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 10:18:31,801][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 10:18:43,313][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 10:18:57,865][root][INFO] - Processing question number 20
[2025-02-20 10:18:57,868][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 10:19:03,480][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 10:19:11,445][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 10:19:17,708][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 10:19:26,679][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 10:19:37,635][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 10:19:48,512][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 10:19:59,089][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 10:20:06,808][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 10:20:37,874][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 10:20:49,469][root][INFO] - Processing question number 30
[2025-02-20 10:20:49,472][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 10:20:58,980][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 10:21:04,972][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 10:21:17,101][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 10:21:25,241][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 10:21:34,691][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 10:21:43,865][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 10:21:51,031][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 10:22:03,520][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 10:22:13,734][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 10:22:20,072][root][INFO] - Processing question number 40
[2025-02-20 10:22:20,075][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 10:22:30,110][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 10:22:42,578][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 10:22:53,598][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 10:23:08,755][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 10:23:18,400][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 10:23:29,496][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 10:23:39,829][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 10:23:46,056][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 10:23:52,648][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 10:23:59,343][root][INFO] - Processing question number 50
[2025-02-20 10:23:59,347][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 10:24:08,857][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 10:24:39,992][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 10:24:48,456][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 10:25:20,251][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 10:25:29,910][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 10:26:00,210][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 10:26:08,514][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 10:26:17,745][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 10:26:29,709][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 10:26:48,169][root][INFO] - Processing question number 60
[2025-02-20 10:26:48,173][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 10:26:54,043][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 10:27:24,930][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 10:27:34,288][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 10:27:40,687][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 10:27:49,846][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 10:28:02,078][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 10:28:15,874][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 10:28:26,912][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 10:28:36,439][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 10:28:45,191][root][INFO] - Processing question number 70
[2025-02-20 10:28:45,195][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 10:28:52,065][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 10:29:00,978][root][INFO] - Domain : Property, Question : 6
[2025-02-20 10:29:07,400][root][INFO] - Domain : Property, Question : 13
[2025-02-20 10:29:20,097][root][INFO] - Domain : Property, Question : 20
[2025-02-20 10:29:29,784][root][INFO] - Domain : Property, Question : 33
[2025-02-20 10:30:00,489][root][INFO] - Domain : Property, Question : 39
[2025-02-20 10:30:10,112][root][INFO] - Domain : Property, Question : 48
[2025-02-20 10:30:23,840][root][INFO] - Domain : Property, Question : 54
[2025-02-20 10:30:34,397][root][INFO] - Domain : Property, Question : 61
[2025-02-20 10:31:05,344][root][INFO] - Processing question number 80
[2025-02-20 10:31:05,348][root][INFO] - Domain : Property, Question : 67
[2025-02-20 10:31:10,933][root][INFO] - Domain : Property, Question : 75
[2025-02-20 10:31:21,918][root][INFO] - Domain : Property, Question : 83
[2025-02-20 10:31:30,343][root][INFO] - Domain : Property, Question : 89
[2025-02-20 10:31:39,550][root][INFO] - Domain : Property, Question : 97
[2025-02-20 10:31:47,582][root][INFO] - Domain : Property, Question : 100
[2025-02-20 10:31:59,443][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 10:32:06,477][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 10:32:22,246][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 10:32:38,530][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 10:32:49,841][root][INFO] - Processing question number 90
[2025-02-20 10:32:49,846][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 10:33:00,962][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 10:33:08,073][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 10:33:39,037][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 10:33:44,454][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 10:33:52,778][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 10:34:23,436][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 10:34:33,661][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 10:34:43,025][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 10:35:14,429][root][INFO] - Inference complete
[2025-02-20 10:35:14,429][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,436][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,438][root][WARNING] - No match found for 3. Chosen Option Label in question number 7 in domain Civil_procedure
[2025-02-20 10:35:14,439][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-20 10:35:14,439][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-20 10:35:14,440][root][WARNING] - No match found for 3. Chosen Option Label in question number 98 in domain Civil_procedure
[2025-02-20 10:35:14,440][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-20 10:35:14,442][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-20 10:35:14,445][root][WARNING] - No match found for 3. Chosen Option Label in question number 62 in domain Torts
[2025-02-20 10:35:14,446][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-20 10:35:14,446][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-20 10:35:14,447][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-20 10:35:14,449][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Property
[2025-02-20 10:35:14,450][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Property
[2025-02-20 10:35:14,451][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-20 10:35:14,452][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Criminal_law
[2025-02-20 10:35:14,453][root][WARNING] - No match found for 3. Chosen Option Label in question number 92 in domain Criminal_law
[2025-02-20 10:35:14,453][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,459][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,459][root][INFO] - Saved parsed outputs
[2025-02-20 10:35:14,459][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,461][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,461][root][INFO] - Saved parsing metadata
[2025-02-20 10:35:14,462][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,464][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:14,466][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 10:35:14,502][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 10:35:14,503][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.43434343434343436, 'malformed_label': 15, 'malformed_domain': 16, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 5, 'both_wrong': 11}
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
[2025-02-20 10:35:21,206][root][INFO] - Setting global seed to 206
[2025-02-20 10:35:21,211][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 10:35:21,211][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 10:35:21,213][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 10:35:21,214][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 10:35:21,216][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 10:35:21,216][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 10:35:21,358][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 10:35:21,925][root][INFO] - Full model selected, loading model
[2025-02-20 10:35:46,838][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 10:35:46,839][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 10:35:54,398][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 10:35:54,400][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:35:54,400][root][INFO] - Starting inference
[2025-02-20 10:35:54,594][root][INFO] - Processing question number 0
[2025-02-20 10:35:54,596][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 10:36:01,484][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 10:36:08,628][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 10:36:19,676][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 10:36:31,280][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 10:36:40,620][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 10:36:50,719][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 10:36:59,482][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 10:37:09,384][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 10:37:16,905][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 10:37:24,940][root][INFO] - Processing question number 10
[2025-02-20 10:37:24,942][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 10:37:33,331][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 10:37:43,543][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 10:37:53,258][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 10:38:02,865][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 10:38:09,580][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 10:38:16,293][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 10:38:25,191][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 10:38:33,139][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 10:38:40,353][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 10:38:49,602][root][INFO] - Processing question number 20
[2025-02-20 10:38:49,604][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 10:38:59,591][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 10:39:08,809][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 10:39:17,381][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 10:39:24,636][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 10:39:33,575][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 10:39:44,367][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 10:39:50,926][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 10:40:04,862][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 10:40:18,325][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 10:40:28,540][root][INFO] - Processing question number 30
[2025-02-20 10:40:28,543][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 10:40:36,413][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 10:40:44,576][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 10:40:55,300][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 10:41:05,544][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 10:41:14,007][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 10:41:24,160][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 10:41:35,152][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 10:41:45,926][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 10:41:52,873][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 10:42:02,550][root][INFO] - Processing question number 40
[2025-02-20 10:42:02,553][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 10:42:13,920][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 10:42:23,495][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 10:42:38,180][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 10:43:09,535][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 10:43:20,010][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 10:43:31,144][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 10:43:40,604][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 10:43:49,674][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 10:44:01,524][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 10:44:09,599][root][INFO] - Processing question number 50
[2025-02-20 10:44:09,602][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 10:44:19,751][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 10:44:30,176][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 10:44:42,836][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 10:44:56,600][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 10:45:08,182][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 10:45:38,452][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 10:45:49,290][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 10:45:58,798][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 10:46:30,133][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 10:46:38,568][root][INFO] - Processing question number 60
[2025-02-20 10:46:38,572][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 10:46:44,483][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 10:46:55,856][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 10:47:05,792][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 10:47:12,909][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 10:47:20,728][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 10:47:29,327][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 10:47:38,784][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 10:47:47,921][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 10:47:58,232][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 10:48:08,261][root][INFO] - Processing question number 70
[2025-02-20 10:48:08,265][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 10:48:16,540][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 10:48:26,522][root][INFO] - Domain : Property, Question : 6
[2025-02-20 10:48:33,959][root][INFO] - Domain : Property, Question : 13
[2025-02-20 10:48:43,990][root][INFO] - Domain : Property, Question : 20
[2025-02-20 10:48:55,655][root][INFO] - Domain : Property, Question : 33
[2025-02-20 10:49:04,391][root][INFO] - Domain : Property, Question : 39
[2025-02-20 10:49:16,505][root][INFO] - Domain : Property, Question : 48
[2025-02-20 10:49:26,239][root][INFO] - Domain : Property, Question : 54
[2025-02-20 10:49:35,884][root][INFO] - Domain : Property, Question : 61
[2025-02-20 10:49:44,659][root][INFO] - Processing question number 80
[2025-02-20 10:49:44,663][root][INFO] - Domain : Property, Question : 67
[2025-02-20 10:49:52,498][root][INFO] - Domain : Property, Question : 75
[2025-02-20 10:50:01,777][root][INFO] - Domain : Property, Question : 83
[2025-02-20 10:50:11,319][root][INFO] - Domain : Property, Question : 89
[2025-02-20 10:50:18,414][root][INFO] - Domain : Property, Question : 97
[2025-02-20 10:50:26,732][root][INFO] - Domain : Property, Question : 100
[2025-02-20 10:50:40,998][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 10:50:51,943][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 10:51:03,066][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 10:51:11,940][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 10:51:19,289][root][INFO] - Processing question number 90
[2025-02-20 10:51:19,294][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 10:51:29,740][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 10:51:38,147][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 10:51:50,100][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 10:51:57,094][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 10:52:06,599][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 10:52:16,096][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 10:52:46,910][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 10:52:56,461][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 10:53:07,788][root][INFO] - Inference complete
[2025-02-20 10:53:07,788][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,794][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,801][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-20 10:53:07,802][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-20 10:53:07,803][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-20 10:53:07,808][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-20 10:53:07,809][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,814][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,814][root][INFO] - Saved parsed outputs
[2025-02-20 10:53:07,814][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,815][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,816][root][INFO] - Saved parsing metadata
[2025-02-20 10:53:07,816][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,818][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:53:07,820][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 10:53:07,836][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 10:53:07,837][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 4, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 8, 'both_wrong': 17}
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
[2025-02-20 10:53:14,415][root][INFO] - Setting global seed to 206
[2025-02-20 10:53:14,420][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 10:53:14,421][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 10:53:14,422][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 10:53:14,423][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 10:53:14,425][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 10:53:14,425][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 10:53:14,569][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 10:53:15,100][root][INFO] - Full model selected, loading model
[2025-02-20 10:53:28,540][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 10:55:12,078][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 10:55:12,109][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 10:55:47,530][root][INFO] - Peft model loaded successfully
[2025-02-20 10:55:54,702][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 10:55:54,704][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 10:55:54,704][root][INFO] - Starting inference
[2025-02-20 10:55:54,911][root][INFO] - Processing question number 0
[2025-02-20 10:55:54,914][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 10:56:04,517][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 10:56:16,961][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 10:56:34,118][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 10:56:41,128][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 10:56:49,335][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 10:57:02,468][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 10:57:13,740][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 10:57:33,337][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 10:57:39,466][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 10:57:46,993][root][INFO] - Processing question number 10
[2025-02-20 10:57:46,996][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 10:58:19,658][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 10:58:29,879][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 10:58:36,426][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 10:58:50,080][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 10:58:57,861][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 10:59:04,203][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 10:59:35,102][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 10:59:44,123][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 10:59:54,540][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 11:00:01,565][root][INFO] - Processing question number 20
[2025-02-20 11:00:01,569][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 11:00:08,249][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 11:00:15,076][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 11:00:25,034][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 11:00:34,318][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 11:00:43,539][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 11:00:51,040][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 11:01:23,083][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 11:01:34,490][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 11:02:05,995][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 11:02:37,104][root][INFO] - Processing question number 30
[2025-02-20 11:02:37,106][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 11:02:48,468][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 11:02:58,024][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 11:03:09,648][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 11:03:22,133][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 11:03:30,292][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 11:03:38,897][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 11:03:45,042][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 11:03:53,836][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 11:04:06,862][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 11:04:16,243][root][INFO] - Processing question number 40
[2025-02-20 11:04:16,246][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 11:04:25,590][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 11:04:37,557][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 11:04:48,124][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 11:04:59,301][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 11:05:08,836][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 11:05:23,432][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 11:05:34,514][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 11:05:39,944][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 11:05:45,833][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 11:05:51,706][root][INFO] - Processing question number 50
[2025-02-20 11:05:51,709][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 11:06:01,911][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 11:06:13,127][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 11:06:21,799][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 11:06:29,487][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 11:06:40,345][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 11:07:11,007][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 11:07:20,079][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 11:07:30,830][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 11:07:43,067][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 11:07:50,034][root][INFO] - Processing question number 60
[2025-02-20 11:07:50,038][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 11:07:55,919][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 11:08:04,432][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 11:08:15,194][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 11:08:20,236][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 11:08:40,618][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 11:08:48,615][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 11:09:00,792][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 11:09:32,250][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 11:09:41,024][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 11:09:50,011][root][INFO] - Processing question number 70
[2025-02-20 11:09:50,016][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 11:09:57,051][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 11:10:05,549][root][INFO] - Domain : Property, Question : 6
[2025-02-20 11:10:10,409][root][INFO] - Domain : Property, Question : 13
[2025-02-20 11:10:22,617][root][INFO] - Domain : Property, Question : 20
[2025-02-20 11:10:30,148][root][INFO] - Domain : Property, Question : 33
[2025-02-20 11:10:38,735][root][INFO] - Domain : Property, Question : 39
[2025-02-20 11:11:10,438][root][INFO] - Domain : Property, Question : 48
[2025-02-20 11:11:19,825][root][INFO] - Domain : Property, Question : 54
[2025-02-20 11:11:31,241][root][INFO] - Domain : Property, Question : 61
[2025-02-20 11:11:51,336][root][INFO] - Processing question number 80
[2025-02-20 11:11:51,340][root][INFO] - Domain : Property, Question : 67
[2025-02-20 11:11:57,968][root][INFO] - Domain : Property, Question : 75
[2025-02-20 11:12:12,812][root][INFO] - Domain : Property, Question : 83
[2025-02-20 11:12:20,733][root][INFO] - Domain : Property, Question : 89
[2025-02-20 11:12:29,039][root][INFO] - Domain : Property, Question : 97
[2025-02-20 11:12:41,285][root][INFO] - Domain : Property, Question : 100
[2025-02-20 11:12:48,435][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 11:12:59,204][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 11:13:10,146][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 11:13:41,541][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 11:13:53,260][root][INFO] - Processing question number 90
[2025-02-20 11:13:53,265][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 11:14:03,269][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 11:14:11,135][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 11:14:42,419][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 11:14:51,838][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 11:15:04,481][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 11:15:35,436][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 11:16:06,597][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 11:16:37,945][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 11:16:44,794][root][INFO] - Inference complete
[2025-02-20 11:16:44,795][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,801][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,803][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-20 11:16:44,804][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-20 11:16:44,805][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-20 11:16:44,806][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-20 11:16:44,806][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Constitutional_law
[2025-02-20 11:16:44,809][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-20 11:16:44,811][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-20 11:16:44,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-20 11:16:44,814][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Criminal_law
[2025-02-20 11:16:44,815][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-20 11:16:44,815][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Criminal_law
[2025-02-20 11:16:44,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-20 11:16:44,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Criminal_law
[2025-02-20 11:16:44,817][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,822][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,822][root][INFO] - Saved parsed outputs
[2025-02-20 11:16:44,822][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,823][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,823][root][INFO] - Saved parsing metadata
[2025-02-20 11:16:44,824][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,838][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 11:16:44,839][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 11:16:44,852][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 11:16:44,853][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.45454545454545453, 'malformed_label': 13, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 45, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 4, 'both_wrong': 10}
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Evaluation failed with config: seeds=seed_42 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Job 12 completed at Do 20. Feb 11:18:54 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n507
Job ID: 25296017
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 01:15:15
CPU Efficiency: 9.78% of 12:49:10 core-walltime
Job Wall-clock time: 01:16:55
Memory Utilized: 34.49 GB
Memory Efficiency: 95.82% of 36.00 GB
