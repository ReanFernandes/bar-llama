Starting job 12 at Thu Feb 20 22:57:00 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=number_list_fact_first_few_shot_unstructured train=number_list_fact_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '12', 'training']
Updating job 12 to status training with exit code None
Status update completed for job 12
[2025-02-20 22:57:15,200][root][INFO] - Global seed set to 314
[2025-02-20 22:57:15,201][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:57:15,202][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:57:15,202][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:57:15,202][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:57:15,202][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 22:57:15,219][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:57:15,232][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:57:15,234][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:57:15,240][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:57:15,998][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:57:42,367][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:58:10,483][root][INFO] - Model prepared for kbit training
[2025-02-20 22:58:10,484][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'down_proj', 'k_proj', 'gate_proj', 'v_proj', 'up_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:58:12,236][root][INFO] - Lora adapter added to model
[2025-02-20 22:58:12,238][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_unstructured
[2025-02-20 22:58:12,464][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.8721, 'grad_norm': 0.45496147871017456, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.5551, 'grad_norm': 0.35006165504455566, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3546, 'grad_norm': 0.3515847623348236, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1934, 'grad_norm': 0.38946402072906494, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.9253, 'grad_norm': 0.38374394178390503, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 415.2674, 'train_samples_per_second': 0.253, 'train_steps_per_second': 0.036, 'train_loss': 1.3800904432932535, 'epoch': 15.0}
[2025-02-20 23:05:17,953][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '12', 'trained', '0']
Updating job 12 to status trained with exit code 0
Status update completed for job 12
Starting evaluations for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-20 23:05:34,876][root][INFO] - Setting global seed to 206
[2025-02-20 23:05:34,885][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:05:34,885][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:05:34,887][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:05:34,889][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:05:34,899][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:05:34,899][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:05:35,045][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:05:35,728][root][INFO] - Full model selected, loading model
[2025-02-20 23:06:03,546][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:07:52,196][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:07:52,197][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:08:28,708][root][INFO] - Peft model loaded successfully
[2025-02-20 23:08:36,860][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:08:36,861][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:08:36,861][root][INFO] - Starting inference
[2025-02-20 23:08:37,061][root][INFO] - Processing question number 0
[2025-02-20 23:08:37,083][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:08:45,324][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:08:53,520][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:09:06,724][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:09:17,504][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:09:29,490][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:09:38,061][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:10:09,469][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:10:15,429][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:10:21,166][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:10:52,341][root][INFO] - Processing question number 10
[2025-02-20 23:10:52,344][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:11:04,028][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:11:15,096][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:11:21,536][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:11:30,262][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:11:39,265][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:11:47,451][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:12:02,536][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:12:07,568][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:12:18,888][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:12:32,113][root][INFO] - Processing question number 20
[2025-02-20 23:12:32,122][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:12:37,720][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:12:46,308][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:12:52,314][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:12:58,707][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:13:09,650][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:13:20,510][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:13:30,177][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:13:37,889][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:14:08,921][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:14:15,643][root][INFO] - Processing question number 30
[2025-02-20 23:14:15,646][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:14:28,588][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:14:35,023][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:14:47,159][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:14:55,303][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:15:04,770][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:15:14,739][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:15:23,377][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:15:34,024][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:15:39,461][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:15:51,506][root][INFO] - Processing question number 40
[2025-02-20 23:15:51,509][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:16:02,547][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:16:14,281][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:16:23,484][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:16:33,043][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:16:41,831][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:16:52,410][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:17:02,771][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:17:09,014][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:17:15,621][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:17:22,335][root][INFO] - Processing question number 50
[2025-02-20 23:17:22,339][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:17:31,873][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:17:44,795][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:17:53,331][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:18:25,220][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:18:34,705][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:18:45,699][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:18:54,027][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:19:02,741][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:19:18,545][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:19:34,102][root][INFO] - Processing question number 60
[2025-02-20 23:19:34,107][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:19:39,994][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:20:10,957][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:20:23,689][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:20:30,445][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:20:40,478][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:20:50,753][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:21:02,444][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:21:33,692][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:22:04,947][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:22:13,658][root][INFO] - Processing question number 70
[2025-02-20 23:22:13,663][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:22:20,568][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:22:29,504][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:22:36,427][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:22:49,502][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:22:59,220][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:23:14,176][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:23:28,770][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:23:38,085][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:23:44,537][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:24:15,561][root][INFO] - Processing question number 80
[2025-02-20 23:24:15,566][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:24:24,577][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:24:41,759][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:24:50,256][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:24:59,481][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:25:07,936][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:25:20,429][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:25:27,477][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:25:58,454][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:26:19,743][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:26:27,804][root][INFO] - Processing question number 90
[2025-02-20 23:26:27,809][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:26:36,345][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:26:44,103][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:27:15,175][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:27:20,460][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:27:31,154][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:27:39,025][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:27:51,319][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:28:00,714][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:28:10,050][root][INFO] - Inference complete
[2025-02-20 23:28:10,050][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,056][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,058][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-20 23:28:10,059][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-20 23:28:10,061][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-20 23:28:10,065][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-20 23:28:10,066][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-20 23:28:10,067][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-20 23:28:10,067][root][WARNING] - No match found for 3. Chosen Option Label in question number 73 in domain Evidence
[2025-02-20 23:28:10,069][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Property
[2025-02-20 23:28:10,070][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-20 23:28:10,071][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-20 23:28:10,072][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,123][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,123][root][INFO] - Saved parsed outputs
[2025-02-20 23:28:10,123][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,134][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,134][root][INFO] - Saved parsing metadata
[2025-02-20 23:28:10,135][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,137][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:10,162][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:28:10,184][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:28:10,184][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.45454545454545453, 'malformed_label': 10, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 45, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 5, 'both_wrong': 9}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-20 23:28:18,396][root][INFO] - Setting global seed to 206
[2025-02-20 23:28:18,404][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:28:18,404][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:28:18,405][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:28:18,407][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:28:18,409][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:28:18,409][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:28:18,596][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:28:19,131][root][INFO] - Full model selected, loading model
[2025-02-20 23:28:35,339][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:28:35,339][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:28:42,802][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:28:42,803][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:28:42,803][root][INFO] - Starting inference
[2025-02-20 23:28:43,029][root][INFO] - Processing question number 0
[2025-02-20 23:28:43,059][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:28:49,733][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:28:56,893][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:29:07,964][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:29:19,589][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:29:28,945][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:29:39,035][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:29:47,754][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:29:57,584][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:30:05,069][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:30:13,106][root][INFO] - Processing question number 10
[2025-02-20 23:30:13,109][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:30:21,505][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:30:31,731][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:30:41,455][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:30:51,076][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:30:57,792][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:31:04,510][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:31:13,419][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:31:21,377][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:31:28,597][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:31:37,865][root][INFO] - Processing question number 20
[2025-02-20 23:31:37,867][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:31:47,864][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:31:57,094][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:32:05,672][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:32:12,935][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:32:21,888][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:32:32,693][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:32:39,254][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:32:53,206][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:33:06,682][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:33:16,909][root][INFO] - Processing question number 30
[2025-02-20 23:33:16,912][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:33:24,788][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:33:32,955][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:33:43,688][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:33:53,946][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:34:02,420][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:34:12,581][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:34:23,585][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:34:34,368][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:34:41,319][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:34:51,008][root][INFO] - Processing question number 40
[2025-02-20 23:34:51,011][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:35:02,394][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:35:11,978][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:35:26,676][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:35:59,725][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:36:10,223][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:36:21,370][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:36:30,839][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:36:39,912][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:36:51,766][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:36:59,841][root][INFO] - Processing question number 50
[2025-02-20 23:36:59,845][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:37:09,994][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:37:20,422][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:37:33,087][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:37:46,857][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:37:58,437][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:38:28,726][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:38:39,561][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:38:49,070][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:39:20,414][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:39:28,873][root][INFO] - Processing question number 60
[2025-02-20 23:39:28,877][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:39:34,812][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:39:46,268][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:39:56,264][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:40:03,383][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:40:11,208][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:40:19,811][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:40:29,279][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:40:38,431][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:40:48,742][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:40:58,771][root][INFO] - Processing question number 70
[2025-02-20 23:40:58,776][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:41:07,060][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:41:17,052][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:41:24,496][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:41:34,536][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:41:46,246][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:41:55,033][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:42:07,227][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:42:16,961][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:42:26,608][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:42:35,379][root][INFO] - Processing question number 80
[2025-02-20 23:42:35,384][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:42:43,217][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:42:52,495][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:43:02,036][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:43:09,124][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:43:17,437][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:43:31,706][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:43:42,650][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:43:53,782][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:44:02,654][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:44:10,000][root][INFO] - Processing question number 90
[2025-02-20 23:44:10,005][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:44:20,462][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:44:28,871][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:44:40,828][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:44:47,824][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:44:57,331][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:45:06,825][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:45:37,668][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:45:47,226][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:45:58,554][root][INFO] - Inference complete
[2025-02-20 23:45:58,554][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,560][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,566][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-20 23:45:58,568][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-20 23:45:58,569][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-20 23:45:58,573][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-20 23:45:58,575][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,588][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,588][root][INFO] - Saved parsed outputs
[2025-02-20 23:45:58,588][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,605][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,605][root][INFO] - Saved parsing metadata
[2025-02-20 23:45:58,606][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,607][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:45:58,638][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:45:58,666][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:45:58,666][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 4, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 8, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-20 23:46:06,928][root][INFO] - Setting global seed to 206
[2025-02-20 23:46:06,940][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:46:06,940][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:46:06,942][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:46:06,943][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:46:06,947][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:46:06,947][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:46:07,096][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:46:07,682][root][INFO] - Full model selected, loading model
[2025-02-20 23:46:28,192][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:48:10,885][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:48:10,924][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:48:41,672][root][INFO] - Peft model loaded successfully
[2025-02-20 23:48:48,871][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:48:48,873][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:48:48,873][root][INFO] - Starting inference
[2025-02-20 23:48:49,089][root][INFO] - Processing question number 0
[2025-02-20 23:48:49,132][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:48:58,443][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:49:10,577][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:49:18,215][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:49:25,815][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:49:56,884][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:50:28,085][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:50:59,799][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:51:09,237][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:51:15,004][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:51:23,783][root][INFO] - Processing question number 10
[2025-02-20 23:51:23,785][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:51:34,323][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:51:49,238][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:51:59,111][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:52:07,114][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:52:14,051][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:52:24,827][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:52:38,746][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:52:43,875][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:52:49,832][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:53:03,033][root][INFO] - Processing question number 20
[2025-02-20 23:53:03,035][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:53:12,537][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:53:21,760][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:53:32,455][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:53:40,479][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:53:49,121][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:53:56,059][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:54:28,017][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:54:37,989][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:54:47,334][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:54:58,509][root][INFO] - Processing question number 30
[2025-02-20 23:54:58,512][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:55:10,520][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:55:18,220][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:55:28,212][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:55:38,525][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:55:46,989][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:55:55,145][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:56:06,269][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:56:16,665][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:56:23,641][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:56:34,270][root][INFO] - Processing question number 40
[2025-02-20 23:56:34,273][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:56:46,124][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:56:57,163][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:57:08,040][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:57:16,550][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:57:23,819][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:57:36,239][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:57:52,884][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:58:02,401][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:58:11,132][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:58:18,543][root][INFO] - Processing question number 50
[2025-02-20 23:58:18,546][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:58:29,786][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:58:41,844][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:58:50,153][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:58:59,150][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:59:11,015][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:59:20,913][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:59:29,251][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:59:37,539][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:59:48,115][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:59:57,668][root][INFO] - Processing question number 60
[2025-02-20 23:59:57,671][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:00:05,175][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:00:15,129][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:00:25,985][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:00:32,008][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:00:42,117][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:01:13,468][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:01:44,863][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:02:06,151][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:02:11,797][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:02:24,723][root][INFO] - Processing question number 70
[2025-02-21 00:02:24,728][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:02:31,860][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:02:43,010][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:02:52,956][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:03:08,993][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:03:40,571][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:03:51,137][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:04:07,019][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:04:38,489][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:04:46,889][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:04:57,664][root][INFO] - Processing question number 80
[2025-02-21 00:04:57,669][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:05:06,697][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:05:17,594][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:05:34,327][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:05:42,919][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:05:51,467][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:06:03,014][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:06:11,211][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:06:25,429][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:06:40,913][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:06:47,899][root][INFO] - Processing question number 90
[2025-02-21 00:06:47,904][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:06:58,211][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:07:05,296][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:07:18,193][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:07:32,063][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:07:43,797][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:07:52,023][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:08:02,107][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:08:13,598][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:08:25,774][root][INFO] - Inference complete
[2025-02-21 00:08:25,774][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,780][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,782][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Civil_procedure
[2025-02-21 00:08:25,782][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Civil_procedure
[2025-02-21 00:08:25,783][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 00:08:25,786][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-21 00:08:25,791][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Evidence
[2025-02-21 00:08:25,791][root][WARNING] - No match found for 3. Chosen Option Label in question number 59 in domain Evidence
[2025-02-21 00:08:25,792][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Property
[2025-02-21 00:08:25,793][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Property
[2025-02-21 00:08:25,796][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,857][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,857][root][INFO] - Saved parsed outputs
[2025-02-21 00:08:25,857][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,885][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,885][root][INFO] - Saved parsing metadata
[2025-02-21 00:08:25,886][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,887][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:08:25,909][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:08:25,929][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:08:25,929][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.3838383838383838, 'malformed_label': 8, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 3, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 00:08:32,916][root][INFO] - Setting global seed to 206
[2025-02-21 00:08:32,921][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:08:32,921][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:08:32,923][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:08:32,924][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:08:32,926][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:08:32,926][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:08:33,066][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:08:33,697][root][INFO] - Full model selected, loading model
[2025-02-21 00:08:52,639][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:08:52,639][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:09:00,058][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:09:00,060][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:09:00,060][root][INFO] - Starting inference
[2025-02-21 00:09:00,267][root][INFO] - Processing question number 0
[2025-02-21 00:09:00,269][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:09:09,264][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:09:19,027][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:09:29,985][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:09:42,511][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:09:54,634][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:10:06,908][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:10:18,465][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:10:27,975][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:10:35,321][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:10:44,220][root][INFO] - Processing question number 10
[2025-02-21 00:10:44,222][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:10:53,503][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:11:04,404][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:11:11,383][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:11:19,618][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:11:27,588][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:11:37,313][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:11:45,951][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:11:53,724][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:12:01,993][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:12:11,325][root][INFO] - Processing question number 20
[2025-02-21 00:12:11,327][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:12:20,809][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:12:31,117][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:12:40,307][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:12:49,101][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:12:56,881][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:13:08,284][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:13:17,880][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:13:30,119][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:13:41,347][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:13:50,428][root][INFO] - Processing question number 30
[2025-02-21 00:13:50,430][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:14:02,520][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:14:10,050][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:14:19,518][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:14:30,759][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:14:36,984][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:14:44,765][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:14:53,020][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:15:04,696][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:15:12,843][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:15:23,670][root][INFO] - Processing question number 40
[2025-02-21 00:15:23,674][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:15:33,792][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:15:45,259][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:15:54,802][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:16:03,092][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:16:16,618][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:16:26,806][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:16:35,280][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:16:45,469][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:16:52,942][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:17:04,209][root][INFO] - Processing question number 50
[2025-02-21 00:17:04,212][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:17:13,644][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:17:24,973][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:17:36,118][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:17:45,350][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:17:56,687][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:18:08,982][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:18:20,682][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:18:30,626][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:18:40,517][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:18:49,325][root][INFO] - Processing question number 60
[2025-02-21 00:18:49,328][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:18:57,150][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:19:04,898][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:19:14,365][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:19:20,859][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:19:28,925][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:19:37,358][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:19:45,591][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:19:55,419][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:20:02,430][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:20:13,268][root][INFO] - Processing question number 70
[2025-02-21 00:20:13,272][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:20:21,959][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:20:28,221][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:20:34,976][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:20:47,838][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:20:57,652][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:21:08,065][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:21:21,641][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:21:32,009][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:21:39,531][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:21:49,782][root][INFO] - Processing question number 80
[2025-02-21 00:21:49,787][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:22:01,004][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:22:10,674][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:22:20,011][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:22:29,731][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:22:38,870][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:22:49,939][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:23:01,139][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:23:09,350][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:23:19,758][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:23:27,219][root][INFO] - Processing question number 90
[2025-02-21 00:23:27,224][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:23:39,506][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:23:51,903][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:24:03,792][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:24:09,746][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:24:19,392][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:24:26,035][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:24:36,734][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:24:47,083][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:24:58,216][root][INFO] - Inference complete
[2025-02-21 00:24:58,216][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,223][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,237][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,242][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,242][root][INFO] - Saved parsed outputs
[2025-02-21 00:24:58,242][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,244][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,244][root][INFO] - Saved parsing metadata
[2025-02-21 00:24:58,244][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,246][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:24:58,247][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:24:58,272][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:24:58,272][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.43434343434343436, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.1111111111111111, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 7, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 00:25:06,157][root][INFO] - Setting global seed to 206
[2025-02-21 00:25:06,164][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:25:06,164][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:25:06,166][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:25:06,167][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:25:06,171][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:25:06,171][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:25:06,318][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:25:06,875][root][INFO] - Full model selected, loading model
[2025-02-21 00:25:29,757][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:27:12,743][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:27:12,744][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:27:43,620][root][INFO] - Peft model loaded successfully
[2025-02-21 00:27:51,270][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:27:51,271][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:27:51,272][root][INFO] - Starting inference
[2025-02-21 00:27:51,479][root][INFO] - Processing question number 0
[2025-02-21 00:27:51,481][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:28:03,268][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:28:12,431][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:28:25,484][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:28:35,638][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:28:46,351][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:28:56,018][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:29:06,064][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:29:16,871][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:29:23,431][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:29:33,150][root][INFO] - Processing question number 10
[2025-02-21 00:29:33,151][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:29:41,410][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:29:58,149][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:30:06,215][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:30:19,247][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:30:26,270][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:30:34,270][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:30:47,408][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:31:14,780][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:31:22,204][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:31:35,474][root][INFO] - Processing question number 20
[2025-02-21 00:31:35,477][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:31:47,655][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:31:55,807][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:32:05,537][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:32:14,916][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:32:21,893][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:32:32,535][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:32:38,904][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:32:53,748][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:33:02,981][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:33:09,021][root][INFO] - Processing question number 30
[2025-02-21 00:33:09,024][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:33:17,657][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:33:31,953][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:33:44,984][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:33:54,971][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:34:02,033][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:34:10,220][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:34:19,967][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:34:34,844][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:34:43,490][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:34:53,286][root][INFO] - Processing question number 40
[2025-02-21 00:34:53,289][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:35:04,106][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:35:14,520][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:35:35,281][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:35:45,138][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:35:52,749][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:36:02,087][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:36:10,916][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:36:19,132][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:36:25,427][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:36:42,724][root][INFO] - Processing question number 50
[2025-02-21 00:36:42,727][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:36:54,555][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:37:03,524][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:37:11,126][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:37:24,459][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:37:36,309][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:37:49,147][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:37:59,796][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:38:07,213][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:38:15,262][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:38:24,752][root][INFO] - Processing question number 60
[2025-02-21 00:38:24,756][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:38:37,528][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:38:42,612][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:38:56,723][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:39:03,246][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:39:17,904][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:39:39,911][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:39:47,073][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:40:00,219][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:40:10,333][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:40:20,963][root][INFO] - Processing question number 70
[2025-02-21 00:40:20,967][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:40:31,612][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:41:02,732][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:41:13,599][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:41:26,329][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:41:32,547][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:41:42,290][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:41:50,077][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:42:00,889][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:42:09,067][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:42:19,454][root][INFO] - Processing question number 80
[2025-02-21 00:42:19,459][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:42:27,808][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:42:38,172][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:42:46,315][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:42:53,957][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:43:04,051][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:43:12,283][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:43:21,764][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:43:29,267][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:43:43,286][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:43:51,185][root][INFO] - Processing question number 90
[2025-02-21 00:43:51,190][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:44:02,285][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:44:09,063][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:44:22,477][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:44:32,416][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:44:41,605][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:44:51,873][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:44:58,873][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:45:09,610][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:45:22,563][root][INFO] - Inference complete
[2025-02-21 00:45:22,563][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,570][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,580][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Evidence
[2025-02-21 00:45:22,584][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,589][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,589][root][INFO] - Saved parsed outputs
[2025-02-21 00:45:22,590][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,591][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,591][root][INFO] - Saved parsing metadata
[2025-02-21 00:45:22,592][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,593][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:45:22,595][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:45:22,611][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:45:22,611][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 2, 'malformed_domain': 17, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.7692307692307693, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 4, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 00:45:29,118][root][INFO] - Setting global seed to 206
[2025-02-21 00:45:29,123][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:45:29,123][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:45:29,125][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:45:29,126][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:45:29,128][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:45:29,128][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:45:29,277][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:45:29,825][root][INFO] - Full model selected, loading model
[2025-02-21 00:45:54,641][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:45:54,643][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:46:02,513][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:46:02,514][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:46:02,515][root][INFO] - Starting inference
[2025-02-21 00:46:02,720][root][INFO] - Processing question number 0
[2025-02-21 00:46:02,723][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:46:14,162][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:46:25,239][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:46:34,324][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:46:44,098][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:46:51,517][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:47:00,599][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:47:18,915][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:47:31,689][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:47:39,182][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:47:46,436][root][INFO] - Processing question number 10
[2025-02-21 00:47:46,438][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:47:57,376][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:48:06,257][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:48:13,635][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:48:20,569][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:48:28,590][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:48:38,217][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:48:47,349][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:48:55,767][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:49:03,988][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:49:12,828][root][INFO] - Processing question number 20
[2025-02-21 00:49:12,830][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:49:21,469][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:49:29,724][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:49:43,840][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:49:50,720][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:50:02,053][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:50:10,850][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:50:19,577][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:50:30,883][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:50:40,258][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:50:48,799][root][INFO] - Processing question number 30
[2025-02-21 00:50:48,803][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:51:00,039][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:51:08,570][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:51:18,790][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:51:30,232][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:51:37,393][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:51:46,178][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:51:58,128][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:52:07,493][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:52:16,089][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:52:26,007][root][INFO] - Processing question number 40
[2025-02-21 00:52:26,010][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:52:35,677][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:52:47,500][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:52:58,356][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:53:09,013][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:53:17,351][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:53:26,838][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:53:36,847][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:53:44,485][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:53:56,396][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:54:07,513][root][INFO] - Processing question number 50
[2025-02-21 00:54:07,519][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:54:14,830][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:54:26,463][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:54:37,960][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:54:47,689][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:55:00,485][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:55:12,661][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:55:23,650][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:55:31,276][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:55:44,921][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:55:54,809][root][INFO] - Processing question number 60
[2025-02-21 00:55:54,813][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:56:04,717][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:56:13,903][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:56:27,827][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:56:33,145][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:56:44,034][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:56:54,610][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:57:05,512][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:57:17,092][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:57:24,302][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:57:34,644][root][INFO] - Processing question number 70
[2025-02-21 00:57:34,649][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:57:44,552][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:57:55,237][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:58:02,937][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:58:13,613][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:58:22,426][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:58:31,290][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:58:39,682][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:58:47,405][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:58:55,239][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:59:05,992][root][INFO] - Processing question number 80
[2025-02-21 00:59:05,997][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:59:14,701][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:59:23,766][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:59:32,457][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:59:41,692][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:59:52,047][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:00:01,387][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:00:09,466][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:00:17,961][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:00:28,223][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:00:39,278][root][INFO] - Processing question number 90
[2025-02-21 01:00:39,284][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:00:48,718][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:00:54,584][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:01:08,006][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:01:17,071][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:01:27,423][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:01:36,965][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:01:44,069][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:01:55,770][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:02:06,140][root][INFO] - Inference complete
[2025-02-21 01:02:06,140][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,146][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,159][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,164][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,164][root][INFO] - Saved parsed outputs
[2025-02-21 01:02:06,164][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,165][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,165][root][INFO] - Saved parsing metadata
[2025-02-21 01:02:06,166][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,167][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:02:06,169][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:02:06,181][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:02:06,181][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.37373737373737376, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 37, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.1111111111111111, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 13, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 01:02:12,622][root][INFO] - Setting global seed to 989
[2025-02-21 01:02:12,628][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:02:12,629][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:02:12,630][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:02:12,632][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:02:12,634][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:02:12,635][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:02:12,802][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:02:13,332][root][INFO] - Full model selected, loading model
[2025-02-21 01:02:27,847][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:04:06,902][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:04:06,919][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:04:35,930][root][INFO] - Peft model loaded successfully
[2025-02-21 01:04:43,023][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:04:43,025][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:04:43,025][root][INFO] - Starting inference
[2025-02-21 01:04:43,190][root][INFO] - Processing question number 0
[2025-02-21 01:04:43,192][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:04:51,256][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:04:59,443][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:05:12,644][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:05:23,412][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:05:35,387][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:05:43,949][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:06:15,325][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:06:21,277][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:06:27,008][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:06:58,166][root][INFO] - Processing question number 10
[2025-02-21 01:06:58,168][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:07:09,849][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:07:20,910][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:07:27,347][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:07:36,066][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:07:45,067][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:07:53,243][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:08:08,319][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:08:13,344][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:08:24,659][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:08:37,866][root][INFO] - Processing question number 20
[2025-02-21 01:08:37,868][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:08:43,463][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:08:52,041][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:08:58,043][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:09:04,425][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:09:15,359][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:09:26,207][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:09:35,869][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:09:43,571][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:10:14,589][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:10:21,306][root][INFO] - Processing question number 30
[2025-02-21 01:10:21,308][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:10:34,244][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:10:40,677][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:10:52,806][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:11:00,941][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:11:10,398][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:11:20,354][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:11:28,988][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:11:39,622][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:11:45,058][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:11:57,095][root][INFO] - Processing question number 40
[2025-02-21 01:11:57,099][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:12:08,132][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:12:19,849][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:12:29,021][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:12:38,543][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:12:47,303][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:12:57,848][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:13:08,177][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:13:14,401][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:13:20,988][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:13:27,679][root][INFO] - Processing question number 50
[2025-02-21 01:13:27,683][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:13:37,189][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:13:50,067][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:13:58,577][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:14:30,362][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:14:39,821][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:14:50,778][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:14:59,084][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:15:07,771][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:15:23,533][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:15:39,039][root][INFO] - Processing question number 60
[2025-02-21 01:15:39,043][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:15:44,915][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:16:15,786][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:16:28,479][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:16:35,210][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:16:45,214][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:16:55,458][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:17:07,118][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:17:38,260][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:18:09,353][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:18:17,999][root][INFO] - Processing question number 70
[2025-02-21 01:18:18,002][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:18:24,862][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:18:33,768][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:18:40,685][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:18:53,724][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:19:03,412][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:19:18,323][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:19:32,875][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:19:42,164][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:19:48,600][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:20:19,528][root][INFO] - Processing question number 80
[2025-02-21 01:20:19,533][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:20:28,522][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:20:45,650][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:20:54,126][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:21:03,322][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:21:11,745][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:21:24,203][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:21:31,230][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:22:02,104][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:22:23,335][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:22:31,368][root][INFO] - Processing question number 90
[2025-02-21 01:22:31,373][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:22:39,875][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:22:47,604][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:23:18,582][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:23:23,849][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:23:34,515][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:23:42,360][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:23:54,624][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:24:03,988][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:24:13,302][root][INFO] - Inference complete
[2025-02-21 01:24:13,302][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,309][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,311][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 01:24:13,311][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 01:24:13,314][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 01:24:13,317][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-21 01:24:13,319][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 01:24:13,320][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-21 01:24:13,320][root][WARNING] - No match found for 3. Chosen Option Label in question number 73 in domain Evidence
[2025-02-21 01:24:13,322][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Property
[2025-02-21 01:24:13,323][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 01:24:13,324][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 01:24:13,325][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,330][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,330][root][INFO] - Saved parsed outputs
[2025-02-21 01:24:13,330][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,331][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,332][root][INFO] - Saved parsing metadata
[2025-02-21 01:24:13,332][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,334][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:13,336][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:24:13,363][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:24:13,363][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.45454545454545453, 'malformed_label': 10, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 45, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 5, 'both_wrong': 9}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 01:24:20,463][root][INFO] - Setting global seed to 989
[2025-02-21 01:24:20,469][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:24:20,469][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:24:20,471][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:24:20,473][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:24:20,475][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:24:20,475][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:24:20,653][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:24:21,192][root][INFO] - Full model selected, loading model
[2025-02-21 01:24:41,047][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:24:41,055][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:24:48,782][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:24:48,785][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:48,785][root][INFO] - Starting inference
[2025-02-21 01:24:48,998][root][INFO] - Processing question number 0
[2025-02-21 01:24:49,011][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:24:55,709][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:25:02,863][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:25:13,929][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:25:25,563][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:25:34,953][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:25:45,107][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:25:53,881][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:26:03,784][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:26:11,330][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:26:19,432][root][INFO] - Processing question number 10
[2025-02-21 01:26:19,434][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:26:27,883][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:26:38,123][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:26:47,914][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:26:57,596][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:27:04,357][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:27:11,128][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:27:20,079][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:27:28,047][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:27:35,306][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:27:44,633][root][INFO] - Processing question number 20
[2025-02-21 01:27:44,635][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:27:54,713][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:28:03,998][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:28:12,588][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:28:19,846][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:28:28,801][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:28:39,605][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:28:46,183][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:29:00,225][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:29:13,824][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:29:24,125][root][INFO] - Processing question number 30
[2025-02-21 01:29:24,129][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:29:32,019][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:29:40,210][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:29:51,026][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:30:01,320][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:30:09,812][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:30:20,043][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:30:31,133][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:30:41,972][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:30:48,926][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:30:58,615][root][INFO] - Processing question number 40
[2025-02-21 01:30:58,618][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:31:10,007][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:31:19,589][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:31:34,299][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:32:05,708][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:32:16,198][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:32:27,346][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:32:36,822][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:32:45,909][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:32:57,781][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:33:05,863][root][INFO] - Processing question number 50
[2025-02-21 01:33:05,866][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:33:16,034][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:33:26,481][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:33:39,167][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:33:52,957][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:34:04,560][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:34:34,889][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:34:45,746][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:34:55,267][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:35:26,672][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:35:35,120][root][INFO] - Processing question number 60
[2025-02-21 01:35:35,123][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:35:41,045][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:35:52,437][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:36:02,392][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:36:09,520][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:36:17,353][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:36:25,963][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:36:35,436][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:36:44,585][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:36:54,913][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:37:04,953][root][INFO] - Processing question number 70
[2025-02-21 01:37:04,957][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:37:13,243][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:37:23,238][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:37:30,683][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:37:40,719][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:37:52,404][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:38:01,150][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:38:13,281][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:38:23,025][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:38:32,685][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:38:41,468][root][INFO] - Processing question number 80
[2025-02-21 01:38:41,473][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:38:49,317][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:38:58,611][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:39:08,169][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:39:15,271][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:39:23,602][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:39:37,889][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:39:48,855][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:39:59,995][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:40:08,884][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:40:16,241][root][INFO] - Processing question number 90
[2025-02-21 01:40:16,246][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:40:26,712][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:40:35,136][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:40:47,110][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:40:54,114][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:41:03,637][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:41:13,150][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:41:44,185][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:41:53,817][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:42:05,250][root][INFO] - Inference complete
[2025-02-21 01:42:05,250][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,257][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,263][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-21 01:42:05,265][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-21 01:42:05,265][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 01:42:05,270][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-21 01:42:05,271][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,277][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,277][root][INFO] - Saved parsed outputs
[2025-02-21 01:42:05,277][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,279][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,279][root][INFO] - Saved parsing metadata
[2025-02-21 01:42:05,279][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,281][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:42:05,283][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:42:05,298][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:42:05,298][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 4, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 8, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 01:42:14,620][root][INFO] - Setting global seed to 989
[2025-02-21 01:42:14,625][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:42:14,625][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:42:14,626][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:42:14,628][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:42:14,630][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:42:14,630][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:42:14,809][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:42:15,350][root][INFO] - Full model selected, loading model
[2025-02-21 01:42:38,944][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:44:23,634][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:44:23,634][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:44:54,231][root][INFO] - Peft model loaded successfully
[2025-02-21 01:45:01,463][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:45:01,464][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:01,465][root][INFO] - Starting inference
[2025-02-21 01:45:01,663][root][INFO] - Processing question number 0
[2025-02-21 01:45:01,665][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:45:09,421][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:45:17,431][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:45:30,179][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:45:37,480][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:45:44,934][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:45:58,248][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:46:12,653][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:46:23,355][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:46:29,815][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:47:01,229][root][INFO] - Processing question number 10
[2025-02-21 01:47:01,231][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:47:14,270][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:47:29,894][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:47:34,737][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:47:40,736][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:48:12,343][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:48:22,263][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:48:32,278][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:49:03,509][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:49:34,727][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:49:41,695][root][INFO] - Processing question number 20
[2025-02-21 01:49:41,698][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:49:47,190][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:49:55,899][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:50:03,762][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:50:10,297][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:50:19,667][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:50:28,762][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:50:38,396][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:50:48,347][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:51:19,608][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:51:27,067][root][INFO] - Processing question number 30
[2025-02-21 01:51:27,070][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:51:40,061][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:51:50,050][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:52:00,218][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:52:11,608][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:52:20,890][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:52:31,639][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:53:02,829][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:53:11,946][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:53:19,102][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:53:28,191][root][INFO] - Processing question number 40
[2025-02-21 01:53:28,194][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:53:41,932][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:53:54,860][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:54:06,417][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:54:14,355][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:54:35,658][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:54:46,994][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:55:03,022][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:55:16,163][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:55:25,024][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:55:32,322][root][INFO] - Processing question number 50
[2025-02-21 01:55:32,326][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:55:41,502][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:55:52,469][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:56:03,812][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:56:14,416][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:56:26,103][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:56:37,792][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:56:48,430][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:56:55,373][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:57:05,720][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:57:37,748][root][INFO] - Processing question number 60
[2025-02-21 01:57:37,752][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:57:45,335][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:57:50,579][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:58:01,411][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:58:07,713][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:58:18,400][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:58:31,430][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:58:42,371][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:58:50,582][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:58:57,402][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:59:06,185][root][INFO] - Processing question number 70
[2025-02-21 01:59:06,190][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:59:14,388][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:59:21,200][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:59:26,880][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:59:41,705][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:59:50,012][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:59:59,513][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:00:31,151][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:00:40,559][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:01:12,154][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:01:25,748][root][INFO] - Processing question number 80
[2025-02-21 02:01:25,754][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:01:37,617][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:01:48,546][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:01:55,420][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:02:04,605][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:02:36,287][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:02:47,942][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:02:55,773][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:03:27,014][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:03:38,400][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:04:09,280][root][INFO] - Processing question number 90
[2025-02-21 02:04:09,285][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:04:18,004][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:04:25,607][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:04:56,833][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:05:09,196][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:05:18,436][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:05:26,301][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:05:36,563][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:05:46,467][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:06:03,791][root][INFO] - Inference complete
[2025-02-21 02:06:03,791][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,797][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,799][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 02:06:03,800][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-21 02:06:03,801][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Constitutional_law
[2025-02-21 02:06:03,801][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 02:06:03,803][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 02:06:03,804][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Contracts
[2025-02-21 02:06:03,807][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 02:06:03,810][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-21 02:06:03,810][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-21 02:06:03,811][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 02:06:03,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 02:06:03,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-21 02:06:03,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 02:06:03,814][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,819][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,819][root][INFO] - Saved parsed outputs
[2025-02-21 02:06:03,819][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,821][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,821][root][INFO] - Saved parsing metadata
[2025-02-21 02:06:03,821][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,823][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:03,824][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:06:03,832][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:06:03,832][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 13, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 9, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 02:06:10,110][root][INFO] - Setting global seed to 989
[2025-02-21 02:06:10,115][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:06:10,115][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:06:10,116][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:06:10,118][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:06:10,120][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:06:10,120][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:06:10,273][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:06:10,825][root][INFO] - Full model selected, loading model
[2025-02-21 02:06:24,712][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:06:24,712][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:06:32,134][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:06:32,135][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:32,135][root][INFO] - Starting inference
[2025-02-21 02:06:32,342][root][INFO] - Processing question number 0
[2025-02-21 02:06:32,345][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:06:38,465][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:06:47,774][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:06:54,474][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:07:03,020][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:07:13,585][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:07:29,281][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:07:37,290][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:07:47,119][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:07:55,150][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:08:05,563][root][INFO] - Processing question number 10
[2025-02-21 02:08:05,565][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:08:15,616][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:08:27,004][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:08:36,058][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:08:44,794][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:08:53,312][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:09:00,963][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:09:13,900][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:09:21,869][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:09:29,094][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:09:38,620][root][INFO] - Processing question number 20
[2025-02-21 02:09:38,623][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:09:47,704][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:09:58,355][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:10:07,986][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:10:15,693][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:10:26,013][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:10:36,798][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:10:49,898][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:11:04,360][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:11:15,282][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:11:25,294][root][INFO] - Processing question number 30
[2025-02-21 02:11:25,297][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:11:39,143][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:11:46,589][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:11:57,775][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:12:08,091][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:12:17,971][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:12:27,563][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:12:34,524][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:12:44,749][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:12:55,306][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:13:05,273][root][INFO] - Processing question number 40
[2025-02-21 02:13:05,277][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:13:15,147][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:13:27,997][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:13:38,686][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:13:51,444][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:14:02,425][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:14:12,070][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:14:21,206][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:14:31,073][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:14:44,035][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:14:50,421][root][INFO] - Processing question number 50
[2025-02-21 02:14:50,425][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:15:00,254][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:15:10,370][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:15:20,228][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:15:29,502][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:15:40,385][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:15:49,913][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:15:59,481][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:16:06,858][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:16:14,339][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:16:22,895][root][INFO] - Processing question number 60
[2025-02-21 02:16:22,898][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:16:30,278][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:16:39,457][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:16:50,437][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:16:57,816][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:17:06,101][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:17:18,426][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:17:28,265][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:17:39,234][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:17:49,735][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:18:00,098][root][INFO] - Processing question number 70
[2025-02-21 02:18:00,102][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:18:09,087][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:18:18,659][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:18:26,155][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:18:38,742][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:18:47,948][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:18:55,919][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:19:05,861][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:19:17,935][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:19:27,512][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:19:38,505][root][INFO] - Processing question number 80
[2025-02-21 02:19:38,509][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:19:47,658][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:19:58,120][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:20:08,936][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:20:18,161][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:20:28,912][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:20:37,940][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:20:49,334][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:20:56,784][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:21:06,133][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:21:14,278][root][INFO] - Processing question number 90
[2025-02-21 02:21:14,283][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:21:26,668][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:21:37,085][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:21:52,857][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:22:01,774][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:22:12,774][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:22:21,279][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:22:29,708][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:22:42,356][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:22:53,584][root][INFO] - Inference complete
[2025-02-21 02:22:53,585][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,590][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,603][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,609][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,609][root][INFO] - Saved parsed outputs
[2025-02-21 02:22:53,609][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,610][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,610][root][INFO] - Saved parsing metadata
[2025-02-21 02:22:53,612][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,613][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:53,622][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:22:53,634][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:22:53,634][root][INFO] - Summary of metrics : {'label_accuracy': 0.5454545454545454, 'misclassification_rate': 0.4545454545454546, 'combined_accuracy': 0.4444444444444444, 'malformed_label': 0, 'malformed_domain': 22, 'total_predictions': 99, 'correct_predictions': 54, 'correct_label_and_domain': 44, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 10, 'both_wrong': 12}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 02:23:00,336][root][INFO] - Setting global seed to 989
[2025-02-21 02:23:00,342][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:23:00,342][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:23:00,344][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:23:00,345][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:23:00,347][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:23:00,347][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:23:00,491][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:23:01,114][root][INFO] - Full model selected, loading model
[2025-02-21 02:23:20,083][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:25:01,161][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:25:01,184][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:25:30,674][root][INFO] - Peft model loaded successfully
[2025-02-21 02:25:37,878][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:25:37,879][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:25:37,879][root][INFO] - Starting inference
[2025-02-21 02:25:38,092][root][INFO] - Processing question number 0
[2025-02-21 02:25:38,111][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:25:47,294][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:25:56,610][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:26:09,319][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:26:18,727][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:26:29,499][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:26:38,777][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:26:54,625][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:27:12,414][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:27:21,092][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:27:27,176][root][INFO] - Processing question number 10
[2025-02-21 02:27:27,178][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:27:40,092][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:27:46,959][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:27:54,141][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:28:01,333][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:28:14,342][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:28:25,504][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:28:36,515][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:28:44,544][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:28:53,709][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:29:02,308][root][INFO] - Processing question number 20
[2025-02-21 02:29:02,311][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:29:07,514][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:29:16,022][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:29:23,598][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:29:31,460][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:29:40,337][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:29:52,039][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:30:04,490][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:30:16,803][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:30:24,643][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:30:33,099][root][INFO] - Processing question number 30
[2025-02-21 02:30:33,102][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:30:42,341][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:30:52,137][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:31:03,418][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:31:17,025][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:31:28,505][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:31:40,908][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:31:50,976][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:31:59,234][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:32:07,800][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:32:21,794][root][INFO] - Processing question number 40
[2025-02-21 02:32:21,797][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:32:30,867][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:32:45,214][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:32:56,627][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:33:04,222][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:33:19,112][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:33:29,753][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:33:37,373][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:33:46,775][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:33:52,678][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:34:01,697][root][INFO] - Processing question number 50
[2025-02-21 02:34:01,700][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:34:08,982][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:34:17,349][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:34:27,016][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:34:36,968][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:34:47,009][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:34:57,232][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:35:06,060][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:35:14,481][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:35:26,248][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:35:37,520][root][INFO] - Processing question number 60
[2025-02-21 02:35:37,523][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:35:44,329][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:35:51,303][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:36:22,902][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:36:28,964][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:36:40,611][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:36:54,259][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:37:06,767][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:37:17,498][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:37:23,676][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:37:33,802][root][INFO] - Processing question number 70
[2025-02-21 02:37:33,806][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:37:50,947][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:38:04,432][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:38:09,873][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:38:20,656][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:38:35,686][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:38:50,083][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:39:07,691][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:39:17,163][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:39:28,219][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:39:39,020][root][INFO] - Processing question number 80
[2025-02-21 02:39:39,024][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:39:45,987][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:39:54,410][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:40:01,527][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:40:14,108][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:40:22,659][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:40:30,248][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:40:38,690][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:40:47,535][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:40:58,599][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:41:08,871][root][INFO] - Processing question number 90
[2025-02-21 02:41:08,876][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:41:18,057][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:41:27,574][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:41:38,289][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:41:42,777][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:41:49,620][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:41:58,523][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:42:10,340][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:42:24,019][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:42:32,796][root][INFO] - Inference complete
[2025-02-21 02:42:32,797][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,802][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Evidence
[2025-02-21 02:42:32,817][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,828][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,828][root][INFO] - Saved parsed outputs
[2025-02-21 02:42:32,828][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,829][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,829][root][INFO] - Saved parsing metadata
[2025-02-21 02:42:32,830][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,832][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:42:32,833][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:42:32,851][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:42:32,851][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 2, 'malformed_domain': 16, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 7, 'both_wrong': 9}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 02:42:39,282][root][INFO] - Setting global seed to 989
[2025-02-21 02:42:39,287][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:42:39,287][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:42:39,288][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:42:39,290][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:42:39,292][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:42:39,292][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:42:39,441][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:42:39,991][root][INFO] - Full model selected, loading model
[2025-02-21 02:43:01,298][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:43:01,311][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:43:08,870][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:43:08,872][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:43:08,872][root][INFO] - Starting inference
[2025-02-21 02:43:09,075][root][INFO] - Processing question number 0
[2025-02-21 02:43:09,078][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:43:18,274][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:43:27,641][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:43:37,108][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:43:49,734][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:43:59,515][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:44:14,508][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:44:26,223][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:44:34,940][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:44:42,979][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:44:48,250][root][INFO] - Processing question number 10
[2025-02-21 02:44:48,252][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:44:59,031][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:45:10,676][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:45:17,360][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:45:26,403][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:45:33,274][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:45:43,443][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:45:53,219][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:46:01,153][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:46:07,943][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:46:17,630][root][INFO] - Processing question number 20
[2025-02-21 02:46:17,633][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:46:27,770][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:46:37,381][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:46:44,958][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:46:54,841][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:47:02,017][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:47:11,665][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:47:22,987][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:47:37,212][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:47:47,795][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:47:55,747][root][INFO] - Processing question number 30
[2025-02-21 02:47:55,750][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:48:05,186][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:48:12,942][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:48:23,801][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:48:34,502][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:48:45,189][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:48:52,725][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:49:02,775][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:49:13,651][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:49:23,752][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:49:33,068][root][INFO] - Processing question number 40
[2025-02-21 02:49:33,074][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:49:41,842][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:49:51,906][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:50:05,505][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:50:14,299][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:50:22,490][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:50:29,791][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:50:38,220][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:50:47,332][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:50:55,799][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:51:03,144][root][INFO] - Processing question number 50
[2025-02-21 02:51:03,148][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:51:11,621][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:51:22,547][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:51:32,066][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:51:42,781][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:51:55,279][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:52:05,458][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:52:17,376][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:52:26,143][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:52:40,817][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:52:49,430][root][INFO] - Processing question number 60
[2025-02-21 02:52:49,434][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:52:58,892][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:53:06,451][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:53:15,082][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:53:23,101][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:53:33,443][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:53:43,731][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:53:54,686][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:54:03,307][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:54:10,913][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:54:22,197][root][INFO] - Processing question number 70
[2025-02-21 02:54:22,201][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:54:29,317][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:54:38,401][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:54:46,541][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:55:00,706][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:55:11,267][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:55:21,756][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:55:31,959][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:55:43,436][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:55:51,462][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:56:00,215][root][INFO] - Processing question number 80
[2025-02-21 02:56:00,220][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:56:09,471][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:56:19,586][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:56:28,277][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:56:36,221][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:56:45,717][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:56:54,451][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:57:04,942][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:57:13,485][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:57:22,936][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:57:29,467][root][INFO] - Processing question number 90
[2025-02-21 02:57:29,472][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:57:41,291][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:57:51,446][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:57:59,368][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:58:07,989][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:58:19,319][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:58:27,780][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:58:35,525][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:58:43,912][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:58:56,274][root][INFO] - Inference complete
[2025-02-21 02:58:56,274][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,280][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,293][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,298][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,299][root][INFO] - Saved parsed outputs
[2025-02-21 02:58:56,299][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,300][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,300][root][INFO] - Saved parsing metadata
[2025-02-21 02:58:56,301][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,302][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:58:56,304][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:58:56,347][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:58:56,348][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.30303030303030304, 'malformed_label': 1, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 30, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 11, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 02:59:03,764][root][INFO] - Setting global seed to 206
[2025-02-21 02:59:03,771][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 02:59:03,771][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:59:03,772][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 02:59:03,775][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:59:03,777][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:59:03,778][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 02:59:03,931][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:59:04,525][root][INFO] - Full model selected, loading model
[2025-02-21 02:59:24,286][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:01:07,460][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:01:07,478][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:01:43,886][root][INFO] - Peft model loaded successfully
[2025-02-21 03:01:51,241][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:01:51,242][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:01:51,242][root][INFO] - Starting inference
[2025-02-21 03:01:51,421][root][INFO] - Processing question number 0
[2025-02-21 03:01:51,423][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:02:00,740][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:02:10,724][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:02:42,298][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:02:55,671][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:03:03,313][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:03:12,876][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:03:43,756][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:03:53,019][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:03:58,952][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:04:06,605][root][INFO] - Processing question number 10
[2025-02-21 03:04:06,607][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:04:17,367][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:04:30,734][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:04:41,903][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:04:47,731][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:05:18,846][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:05:26,995][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:05:38,456][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:05:46,330][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:05:56,555][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:06:04,894][root][INFO] - Processing question number 20
[2025-02-21 03:06:04,896][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:06:35,220][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:06:44,417][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:06:53,720][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:07:01,252][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:07:09,177][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:07:16,980][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:07:26,867][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:07:35,187][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:07:44,600][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:07:53,412][root][INFO] - Processing question number 30
[2025-02-21 03:07:53,414][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:08:00,753][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:08:31,626][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:09:02,526][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:09:13,613][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:09:22,049][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:09:29,763][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:09:38,436][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:09:46,556][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:09:54,422][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:10:07,488][root][INFO] - Processing question number 40
[2025-02-21 03:10:07,491][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:10:15,391][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:10:25,572][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:10:35,207][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:11:05,553][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:11:19,223][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:11:26,550][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:11:37,985][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:11:47,255][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:11:58,435][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:12:11,175][root][INFO] - Processing question number 50
[2025-02-21 03:12:11,179][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:12:18,390][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:12:49,194][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:13:07,096][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:13:18,925][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:13:28,293][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:13:43,985][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:13:58,399][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:14:09,259][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:14:27,668][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:14:42,705][root][INFO] - Processing question number 60
[2025-02-21 03:14:42,709][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:14:50,253][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:15:03,528][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:15:17,888][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:15:49,026][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:15:59,197][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:16:10,264][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:16:20,215][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:16:27,661][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:16:39,224][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:16:50,860][root][INFO] - Processing question number 70
[2025-02-21 03:16:50,864][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:17:21,986][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:17:32,129][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:17:47,948][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:18:01,945][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:18:11,789][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:18:22,168][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:18:36,822][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:19:08,159][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:19:17,386][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:19:25,505][root][INFO] - Processing question number 80
[2025-02-21 03:19:25,510][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:19:32,128][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:19:39,520][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:19:55,815][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:20:26,926][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:20:39,775][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:20:48,019][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:21:00,863][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 03:21:07,330][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 03:21:18,315][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:21:49,323][root][INFO] - Processing question number 90
[2025-02-21 03:21:49,328][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 03:21:56,300][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 03:22:06,866][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:22:17,374][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 03:22:24,618][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 03:22:34,605][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 03:22:48,123][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 03:22:57,606][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 03:23:10,616][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 03:23:24,234][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:23:35,921][root][INFO] - Inference complete
[2025-02-21 03:23:35,921][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,928][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,930][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 03:23:35,931][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Constitutional_law
[2025-02-21 03:23:35,932][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 03:23:35,933][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Criminal_law
[2025-02-21 03:23:35,934][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 03:23:35,935][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 03:23:35,936][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Evidence
[2025-02-21 03:23:35,937][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Evidence
[2025-02-21 03:23:35,939][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Civil_procedure
[2025-02-21 03:23:35,941][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 03:23:35,942][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 03:23:35,943][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 03:23:35,944][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 03:23:35,946][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,951][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,951][root][INFO] - Saved parsed outputs
[2025-02-21 03:23:35,951][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,952][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,952][root][INFO] - Saved parsing metadata
[2025-02-21 03:23:35,953][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,955][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:23:35,957][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 03:23:35,987][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 03:23:35,988][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.42, 'malformed_label': 14, 'malformed_domain': 12, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 7, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 03:23:42,503][root][INFO] - Setting global seed to 206
[2025-02-21 03:23:42,508][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 03:23:42,509][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:23:42,510][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:23:42,512][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:23:42,514][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:23:42,514][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:23:42,658][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:23:43,203][root][INFO] - Full model selected, loading model
[2025-02-21 03:24:06,199][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:24:06,199][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:24:13,871][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:24:13,874][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:24:13,874][root][INFO] - Starting inference
[2025-02-21 03:24:14,067][root][INFO] - Processing question number 0
[2025-02-21 03:24:14,069][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:24:26,532][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:24:37,613][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:24:47,590][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:24:57,686][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:25:06,144][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:25:14,678][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:25:22,750][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:25:31,160][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:25:38,150][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:25:49,292][root][INFO] - Processing question number 10
[2025-02-21 03:25:49,294][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:25:58,696][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:26:14,148][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:26:27,204][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:26:35,131][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:26:44,176][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:26:53,649][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:27:01,349][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:27:10,242][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:27:19,362][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:27:27,848][root][INFO] - Processing question number 20
[2025-02-21 03:27:27,850][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:27:39,305][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:27:46,806][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:27:57,224][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:28:05,432][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:28:14,910][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:28:23,346][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:28:34,415][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:28:42,419][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:28:52,603][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:29:02,058][root][INFO] - Processing question number 30
[2025-02-21 03:29:02,061][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:29:11,755][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:29:21,389][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:29:31,182][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:29:40,817][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:29:49,536][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:30:01,153][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:30:11,831][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:30:22,786][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:30:30,594][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:30:43,254][root][INFO] - Processing question number 40
[2025-02-21 03:30:43,257][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:30:52,668][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:31:02,197][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:31:15,758][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:31:25,025][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:31:38,118][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:31:46,269][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:31:55,563][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:32:26,602][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:32:39,312][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:32:49,145][root][INFO] - Processing question number 50
[2025-02-21 03:32:49,148][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:32:59,361][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:33:06,213][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:33:19,023][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:33:30,693][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:33:42,577][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:33:50,296][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:34:00,012][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:34:08,548][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:34:20,618][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:34:32,814][root][INFO] - Processing question number 60
[2025-02-21 03:34:32,818][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:34:43,890][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:34:52,575][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:35:05,401][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:35:14,341][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:35:23,516][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:35:32,412][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:35:40,746][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:35:47,513][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:35:58,275][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:36:09,309][root][INFO] - Processing question number 70
[2025-02-21 03:36:09,313][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:36:19,900][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:36:26,701][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:36:40,457][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:36:52,983][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:37:03,754][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:37:15,182][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:37:25,902][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:37:39,511][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:37:48,684][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:37:59,010][root][INFO] - Processing question number 80
[2025-02-21 03:37:59,015][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:38:05,396][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:38:13,035][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:38:25,979][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:38:35,852][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:38:44,380][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:38:51,969][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:39:03,431][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 03:39:14,788][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 03:39:24,605][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:39:35,832][root][INFO] - Processing question number 90
[2025-02-21 03:39:35,838][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 03:39:43,733][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 03:39:57,093][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:40:08,284][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 03:40:14,734][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 03:40:23,904][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 03:40:33,290][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 03:40:47,157][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 03:40:55,657][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 03:41:05,860][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:41:14,933][root][INFO] - Inference complete
[2025-02-21 03:41:14,934][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,942][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,949][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 03:41:14,956][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,961][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,961][root][INFO] - Saved parsed outputs
[2025-02-21 03:41:14,961][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,963][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,963][root][INFO] - Saved parsing metadata
[2025-02-21 03:41:14,964][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,965][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:41:14,967][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 03:41:14,986][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 03:41:14,986][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.39, 'malformed_label': 2, 'malformed_domain': 27, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.16, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 17, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 03:41:21,386][root][INFO] - Setting global seed to 206
[2025-02-21 03:41:21,391][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:41:21,391][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:41:21,393][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:41:21,394][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:41:21,396][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:41:21,396][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:41:21,545][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:41:22,075][root][INFO] - Full model selected, loading model
[2025-02-21 03:41:36,608][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:43:16,795][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:43:16,796][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:43:49,714][root][INFO] - Peft model loaded successfully
[2025-02-21 03:43:56,885][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:43:56,887][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:43:56,887][root][INFO] - Starting inference
[2025-02-21 03:43:57,109][root][INFO] - Processing question number 0
[2025-02-21 03:43:57,111][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:44:10,058][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:44:20,020][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:44:51,880][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:45:06,533][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:45:16,668][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:45:47,719][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:45:54,591][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:46:00,131][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:46:08,461][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:46:17,123][root][INFO] - Processing question number 10
[2025-02-21 03:46:17,125][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:46:24,025][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:46:33,918][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:46:41,079][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:46:47,628][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:46:56,858][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:47:09,214][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:47:20,590][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:47:31,500][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:47:37,773][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:47:47,892][root][INFO] - Processing question number 20
[2025-02-21 03:47:47,894][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:47:56,416][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:48:08,628][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:48:23,906][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:48:34,025][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:48:43,938][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:48:51,652][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:48:59,653][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:49:07,586][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:49:13,521][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:49:24,367][root][INFO] - Processing question number 30
[2025-02-21 03:49:24,369][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:49:32,804][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:49:41,047][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:49:51,587][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:50:00,656][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:50:09,459][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:50:17,341][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:50:25,937][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:50:41,786][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:50:51,860][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:50:59,776][root][INFO] - Processing question number 40
[2025-02-21 03:50:59,779][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:51:09,179][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:51:16,825][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:51:23,834][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:51:32,256][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:51:45,071][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:51:54,144][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:52:02,788][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:52:34,122][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:52:44,943][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:52:51,020][root][INFO] - Processing question number 50
[2025-02-21 03:52:51,023][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:52:59,422][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:53:04,151][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:53:15,815][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:53:26,596][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:53:35,291][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:53:44,273][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:53:54,637][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:54:03,907][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:54:14,884][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:54:28,815][root][INFO] - Processing question number 60
[2025-02-21 03:54:28,819][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:54:36,266][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:55:07,543][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:55:18,033][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:55:29,830][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:55:41,677][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:56:12,939][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:56:22,461][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:56:29,652][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:56:41,905][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:56:50,238][root][INFO] - Processing question number 70
[2025-02-21 03:56:50,243][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:57:05,681][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:57:11,159][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:57:42,739][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:57:50,455][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:58:00,139][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:58:08,955][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:58:22,960][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:58:40,594][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:58:51,629][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:59:00,366][root][INFO] - Processing question number 80
[2025-02-21 03:59:00,370][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:59:08,752][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:59:15,959][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:59:26,737][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:59:36,305][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:59:46,242][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:59:54,846][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:00:06,120][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:00:13,341][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:00:21,706][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:00:52,992][root][INFO] - Processing question number 90
[2025-02-21 04:00:52,997][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:00:59,183][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:01:11,710][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:01:24,127][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:01:31,927][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:01:38,533][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:01:46,954][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:01:58,031][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:02:14,130][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:02:21,245][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:02:29,864][root][INFO] - Inference complete
[2025-02-21 04:02:29,864][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,870][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,872][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 04:02:29,872][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 04:02:29,878][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 04:02:29,880][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Civil_procedure
[2025-02-21 04:02:29,881][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 04:02:29,882][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 04:02:29,884][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 04:02:29,886][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,899][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,899][root][INFO] - Saved parsed outputs
[2025-02-21 04:02:29,899][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,901][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,901][root][INFO] - Saved parsing metadata
[2025-02-21 04:02:29,902][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,904][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:02:29,905][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:02:29,930][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:02:29,930][root][INFO] - Summary of metrics : {'label_accuracy': 0.45, 'misclassification_rate': 0.55, 'combined_accuracy': 0.38, 'malformed_label': 7, 'malformed_domain': 13, 'total_predictions': 100, 'correct_predictions': 45, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.18, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 7, 'both_wrong': 6}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 04:02:36,239][root][INFO] - Setting global seed to 206
[2025-02-21 04:02:36,245][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:02:36,245][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:02:36,246][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:02:36,247][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:02:36,250][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:02:36,250][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:02:36,437][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:02:36,988][root][INFO] - Full model selected, loading model
[2025-02-21 04:02:59,514][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:02:59,514][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:03:07,326][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:03:07,328][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:03:07,329][root][INFO] - Starting inference
[2025-02-21 04:03:07,521][root][INFO] - Processing question number 0
[2025-02-21 04:03:07,535][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:03:20,463][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:03:28,987][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:03:38,026][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:03:48,223][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:03:56,475][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:04:06,820][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:04:14,580][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:04:21,047][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:04:30,069][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:04:39,321][root][INFO] - Processing question number 10
[2025-02-21 04:04:39,324][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:04:47,899][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:04:59,662][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:05:08,983][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:05:17,562][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:05:25,082][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:05:34,747][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:05:44,655][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:05:55,220][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:06:05,184][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:06:14,248][root][INFO] - Processing question number 20
[2025-02-21 04:06:14,250][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:06:24,588][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:06:35,268][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:06:45,099][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:06:55,388][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:07:03,073][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:07:12,901][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:07:23,318][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:07:31,699][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:07:38,909][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:07:48,249][root][INFO] - Processing question number 30
[2025-02-21 04:07:48,251][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:07:58,541][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:08:06,093][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:08:17,334][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:08:29,178][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:08:37,635][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:08:47,309][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:08:59,515][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:09:10,428][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:09:18,706][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:09:30,134][root][INFO] - Processing question number 40
[2025-02-21 04:09:30,137][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:09:38,695][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:09:50,411][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:10:01,486][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:10:12,123][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:10:25,348][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:10:31,158][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:10:40,744][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:10:50,993][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:11:03,730][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:11:14,159][root][INFO] - Processing question number 50
[2025-02-21 04:11:14,163][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:11:22,262][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:11:32,622][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:12:04,287][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:12:15,416][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:12:27,119][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:12:38,837][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:12:47,140][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:12:54,412][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:13:04,991][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:13:17,411][root][INFO] - Processing question number 60
[2025-02-21 04:13:17,414][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:13:29,101][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:13:41,931][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:13:53,196][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:14:03,677][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:14:11,337][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:14:21,362][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:14:29,679][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:14:40,248][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:14:51,670][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:15:04,566][root][INFO] - Processing question number 70
[2025-02-21 04:15:04,570][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:15:35,994][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:15:44,180][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:16:04,219][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:16:16,656][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:16:27,428][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:16:35,891][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:16:45,893][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:16:56,384][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:17:06,038][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:17:14,180][root][INFO] - Processing question number 80
[2025-02-21 04:17:14,184][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:17:22,414][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:17:31,527][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:17:43,572][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:17:51,640][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:18:00,859][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:18:11,605][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:18:23,890][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:18:33,170][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:18:42,381][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:18:53,011][root][INFO] - Processing question number 90
[2025-02-21 04:18:53,015][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:19:02,138][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:19:13,595][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:19:29,123][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:19:37,018][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:19:47,598][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:19:58,793][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:20:12,042][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:20:22,221][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:20:35,986][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:20:48,343][root][INFO] - Inference complete
[2025-02-21 04:20:48,344][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,350][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,357][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Evidence
[2025-02-21 04:20:48,360][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 04:20:48,364][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,370][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,370][root][INFO] - Saved parsed outputs
[2025-02-21 04:20:48,370][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,381][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,381][root][INFO] - Saved parsing metadata
[2025-02-21 04:20:48,381][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,383][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:20:48,384][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:20:48,392][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:20:48,392][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.35, 'malformed_label': 2, 'malformed_domain': 30, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 13, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 04:20:54,682][root][INFO] - Setting global seed to 206
[2025-02-21 04:20:54,687][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:20:54,687][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:20:54,688][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:20:54,689][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:20:54,691][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:20:54,691][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:20:54,829][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:20:55,409][root][INFO] - Full model selected, loading model
[2025-02-21 04:21:09,203][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:22:49,997][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:22:50,015][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:23:20,981][root][INFO] - Peft model loaded successfully
[2025-02-21 04:23:28,161][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:23:28,163][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:23:28,163][root][INFO] - Starting inference
[2025-02-21 04:23:28,407][root][INFO] - Processing question number 0
[2025-02-21 04:23:28,417][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:23:43,431][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:23:52,734][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:24:11,375][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:24:22,764][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:24:30,608][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:24:37,258][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:24:48,228][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:24:56,167][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:25:03,759][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:25:14,197][root][INFO] - Processing question number 10
[2025-02-21 04:25:14,199][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:25:33,903][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:25:45,574][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:25:57,579][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:26:07,371][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:26:15,532][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:26:24,692][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:26:37,101][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:26:51,269][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:27:02,730][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:27:19,330][root][INFO] - Processing question number 20
[2025-02-21 04:27:19,332][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:27:28,526][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:27:38,494][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:27:50,304][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:27:58,148][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:28:08,011][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:28:20,192][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:28:30,115][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:28:40,284][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:28:50,758][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:29:00,442][root][INFO] - Processing question number 30
[2025-02-21 04:29:00,444][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:29:09,175][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:29:20,446][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:29:32,078][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:29:42,495][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:29:51,591][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:30:01,556][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:30:08,421][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:30:17,425][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:30:25,544][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:30:36,590][root][INFO] - Processing question number 40
[2025-02-21 04:30:36,593][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:30:43,900][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:30:53,864][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:31:00,540][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:31:05,930][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:31:23,091][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:31:32,414][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:31:41,307][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:31:49,049][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:32:11,301][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:32:20,423][root][INFO] - Processing question number 50
[2025-02-21 04:32:20,426][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:32:28,366][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:32:42,435][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:32:54,648][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:33:02,679][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:33:10,272][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:33:19,805][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:33:28,812][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:33:36,468][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:33:45,139][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:33:58,956][root][INFO] - Processing question number 60
[2025-02-21 04:33:58,960][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:34:10,988][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:34:28,880][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:34:46,353][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:34:55,166][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:35:10,839][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:35:24,104][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:35:33,053][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:35:40,908][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:35:52,674][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:36:06,965][root][INFO] - Processing question number 70
[2025-02-21 04:36:06,969][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:36:14,635][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:36:25,767][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:36:44,541][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:36:59,632][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:37:07,836][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:37:16,950][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:37:30,586][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:37:39,668][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:37:45,933][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:37:56,145][root][INFO] - Processing question number 80
[2025-02-21 04:37:56,150][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:38:08,143][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:38:15,792][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:38:24,846][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:38:39,037][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:38:47,998][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:38:54,870][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:39:07,500][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:39:20,343][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:39:26,816][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:39:37,842][root][INFO] - Processing question number 90
[2025-02-21 04:39:37,847][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:39:44,079][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:39:55,474][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:40:04,957][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:40:10,039][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:40:21,687][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:40:31,516][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:40:43,588][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:40:55,905][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:41:06,703][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:41:20,670][root][INFO] - Inference complete
[2025-02-21 04:41:20,670][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,677][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,691][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,697][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,697][root][INFO] - Saved parsed outputs
[2025-02-21 04:41:20,697][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,767][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,767][root][INFO] - Saved parsing metadata
[2025-02-21 04:41:20,768][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,769][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:20,776][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:41:20,807][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:41:20,807][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.39, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.7857142857142857, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.14, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 16, 'both_wrong': 9}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 04:41:28,855][root][INFO] - Setting global seed to 206
[2025-02-21 04:41:28,863][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:41:28,863][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:41:28,865][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:41:28,866][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:41:28,869][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:41:28,869][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:41:29,017][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:41:29,532][root][INFO] - Full model selected, loading model
[2025-02-21 04:41:47,210][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:41:47,210][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:41:54,621][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:41:54,623][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:41:54,623][root][INFO] - Starting inference
[2025-02-21 04:41:54,844][root][INFO] - Processing question number 0
[2025-02-21 04:41:54,846][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:42:04,375][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:42:16,319][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:42:25,426][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:42:35,610][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:42:44,437][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:42:55,066][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:43:06,638][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:43:16,171][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:43:24,250][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:43:31,415][root][INFO] - Processing question number 10
[2025-02-21 04:43:31,417][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:43:40,560][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:43:50,244][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:44:00,352][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:44:06,813][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:44:16,828][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:44:27,833][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:44:36,785][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:44:44,080][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:44:55,293][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:45:08,127][root][INFO] - Processing question number 20
[2025-02-21 04:45:08,129][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:45:19,196][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:45:28,512][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:45:35,720][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:45:44,545][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:45:54,603][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:46:03,014][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:46:12,391][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:46:22,360][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:46:31,341][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:46:41,325][root][INFO] - Processing question number 30
[2025-02-21 04:46:41,328][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:46:53,363][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:47:01,009][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:47:09,061][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:47:20,995][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:47:29,889][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:47:39,303][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:47:50,879][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:48:00,574][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:48:11,342][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:48:22,156][root][INFO] - Processing question number 40
[2025-02-21 04:48:22,159][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:48:31,301][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:48:39,631][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:48:52,306][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:48:58,047][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:49:15,209][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:49:23,777][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:49:33,005][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:49:44,551][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:49:55,217][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:50:06,190][root][INFO] - Processing question number 50
[2025-02-21 04:50:06,194][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:50:14,337][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:50:24,440][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:50:36,507][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:50:47,680][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:50:59,818][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:51:09,184][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:51:19,390][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:51:29,906][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:51:37,727][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:51:50,624][root][INFO] - Processing question number 60
[2025-02-21 04:51:50,628][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:51:57,817][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:52:04,598][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:52:13,169][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:52:22,701][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:52:32,531][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:52:43,215][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:52:54,105][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:53:02,312][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:53:11,304][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:53:23,866][root][INFO] - Processing question number 70
[2025-02-21 04:53:23,870][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:53:34,203][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:53:43,584][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:54:00,026][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:54:13,137][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:54:22,224][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:54:33,144][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:54:42,679][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:54:55,895][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:55:06,079][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:55:15,691][root][INFO] - Processing question number 80
[2025-02-21 04:55:15,696][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:55:23,765][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:55:31,860][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:55:42,930][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:55:52,236][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:56:00,478][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:56:09,813][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:56:23,263][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:56:37,790][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:56:47,446][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:56:58,116][root][INFO] - Processing question number 90
[2025-02-21 04:56:58,121][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:57:08,387][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:57:18,113][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:57:28,348][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:57:35,991][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:57:47,228][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:57:58,722][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:58:11,766][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:58:19,903][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:58:28,979][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:58:40,254][root][INFO] - Inference complete
[2025-02-21 04:58:40,254][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,262][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,275][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,290][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,291][root][INFO] - Saved parsed outputs
[2025-02-21 04:58:40,291][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,294][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,294][root][INFO] - Saved parsing metadata
[2025-02-21 04:58:40,294][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,296][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:58:40,305][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:58:40,337][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:58:40,337][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.27, 'malformed_label': 1, 'malformed_domain': 44, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 26, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 04:58:47,784][root][INFO] - Setting global seed to 989
[2025-02-21 04:58:47,792][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:58:47,792][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:58:47,793][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:58:47,795][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:58:47,798][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:58:47,798][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:58:47,959][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:58:48,564][root][INFO] - Full model selected, loading model
[2025-02-21 04:59:06,849][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:00:49,629][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:00:49,641][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:01:22,450][root][INFO] - Peft model loaded successfully
[2025-02-21 05:01:32,394][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:01:32,396][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:01:32,396][root][INFO] - Starting inference
[2025-02-21 05:01:32,552][root][INFO] - Processing question number 0
[2025-02-21 05:01:32,557][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:01:41,878][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:01:51,882][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:02:23,496][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:02:36,902][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:02:44,569][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:02:54,164][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:03:25,090][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:03:34,375][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:03:40,315][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:03:47,975][root][INFO] - Processing question number 10
[2025-02-21 05:03:47,977][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:03:58,744][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:04:12,111][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:04:23,275][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:04:29,106][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:05:00,257][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:05:08,419][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:05:19,879][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:05:27,759][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:05:37,992][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:05:46,336][root][INFO] - Processing question number 20
[2025-02-21 05:05:46,338][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:06:16,693][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:06:25,916][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:06:35,213][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:06:42,747][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:06:50,668][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:06:58,471][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:07:08,358][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:07:16,669][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:07:26,072][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:07:34,879][root][INFO] - Processing question number 30
[2025-02-21 05:07:34,882][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:07:42,219][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:08:13,087][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:08:44,002][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:08:55,097][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:09:03,532][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:09:11,247][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:09:19,914][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:09:28,038][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:09:35,905][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:09:48,977][root][INFO] - Processing question number 40
[2025-02-21 05:09:48,980][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:09:56,879][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:10:07,053][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:10:16,684][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:10:47,015][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:11:00,681][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:11:08,005][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:11:19,429][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:11:28,693][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:11:39,864][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:11:52,594][root][INFO] - Processing question number 50
[2025-02-21 05:11:52,598][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:11:59,777][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:12:30,344][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:12:48,088][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:12:59,817][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:13:09,159][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:13:24,756][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:13:39,049][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:13:49,821][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:14:08,165][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:14:23,079][root][INFO] - Processing question number 60
[2025-02-21 05:14:23,084][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:14:30,566][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:14:43,769][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:14:58,132][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:15:29,261][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:15:39,435][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:15:50,501][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:16:00,449][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:16:07,893][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:16:19,453][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:16:31,081][root][INFO] - Processing question number 70
[2025-02-21 05:16:31,085][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:17:02,223][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:17:12,435][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:17:28,356][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:17:42,354][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:17:52,189][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:18:02,562][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:18:17,209][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:18:48,543][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:18:57,761][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:19:05,875][root][INFO] - Processing question number 80
[2025-02-21 05:19:05,880][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:19:12,497][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:19:19,887][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:19:36,173][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:20:07,271][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:20:20,120][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:20:28,351][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:20:41,178][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:20:47,639][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:20:58,602][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:21:29,590][root][INFO] - Processing question number 90
[2025-02-21 05:21:29,596][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:21:36,560][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:21:47,102][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:21:57,604][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:22:04,841][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:22:14,824][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:22:28,344][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:22:37,825][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:22:50,826][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:23:04,429][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:23:16,107][root][INFO] - Inference complete
[2025-02-21 05:23:16,107][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,113][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,115][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 05:23:16,116][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Constitutional_law
[2025-02-21 05:23:16,117][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 05:23:16,118][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Criminal_law
[2025-02-21 05:23:16,119][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 05:23:16,120][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 05:23:16,121][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Evidence
[2025-02-21 05:23:16,123][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Evidence
[2025-02-21 05:23:16,124][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Civil_procedure
[2025-02-21 05:23:16,126][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 05:23:16,127][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 05:23:16,128][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 05:23:16,129][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 05:23:16,131][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,136][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,136][root][INFO] - Saved parsed outputs
[2025-02-21 05:23:16,136][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,142][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,142][root][INFO] - Saved parsing metadata
[2025-02-21 05:23:16,143][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,145][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:16,146][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:23:16,164][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:23:16,164][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.42, 'malformed_label': 14, 'malformed_domain': 12, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 7, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 05:23:23,071][root][INFO] - Setting global seed to 989
[2025-02-21 05:23:23,077][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:23:23,078][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:23:23,079][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:23:23,081][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:23:23,083][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:23:23,083][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:23:23,238][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:23:23,777][root][INFO] - Full model selected, loading model
[2025-02-21 05:23:45,536][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:23:45,537][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:23:53,135][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:23:53,137][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:23:53,137][root][INFO] - Starting inference
[2025-02-21 05:23:53,298][root][INFO] - Processing question number 0
[2025-02-21 05:23:53,300][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:24:05,878][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:24:16,963][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:24:26,950][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:24:37,062][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:24:45,560][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:24:54,105][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:25:02,180][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:25:10,594][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:25:17,591][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:25:28,736][root][INFO] - Processing question number 10
[2025-02-21 05:25:28,739][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:25:38,146][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:25:53,606][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:26:06,653][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:26:14,560][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:26:23,593][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:26:33,070][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:26:40,772][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:26:49,668][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:26:58,798][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:27:07,288][root][INFO] - Processing question number 20
[2025-02-21 05:27:07,291][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:27:18,754][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:27:26,259][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:27:36,686][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:27:44,900][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:27:54,386][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:28:02,823][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:28:13,905][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:28:21,916][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:28:32,109][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:28:41,570][root][INFO] - Processing question number 30
[2025-02-21 05:28:41,573][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:28:51,277][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:29:00,919][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:29:10,722][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:29:20,362][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:29:29,090][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:29:40,717][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:29:51,408][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:30:02,368][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:30:10,183][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:30:22,856][root][INFO] - Processing question number 40
[2025-02-21 05:30:22,859][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:30:32,277][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:30:41,811][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:30:55,384][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:31:04,658][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:31:17,767][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:31:25,920][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:31:35,222][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:32:06,296][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:32:19,106][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:32:28,999][root][INFO] - Processing question number 50
[2025-02-21 05:32:29,003][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:32:39,231][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:32:46,086][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:32:58,912][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:33:10,594][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:33:22,489][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:33:30,213][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:33:39,943][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:33:48,512][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:34:00,621][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:34:12,829][root][INFO] - Processing question number 60
[2025-02-21 05:34:12,832][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:34:23,919][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:34:32,611][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:34:45,453][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:34:54,398][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:35:03,580][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:35:12,485][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:35:20,829][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:35:27,597][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:35:38,372][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:35:49,415][root][INFO] - Processing question number 70
[2025-02-21 05:35:49,420][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:36:00,007][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:36:06,801][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:36:20,554][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:36:33,081][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:36:43,857][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:36:55,285][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:37:06,015][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:37:19,631][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:37:28,809][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:37:39,138][root][INFO] - Processing question number 80
[2025-02-21 05:37:39,143][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:37:45,517][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:37:53,159][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:38:06,110][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:38:15,991][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:38:24,530][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:38:32,139][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:38:43,677][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:38:55,118][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:39:04,988][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:39:16,219][root][INFO] - Processing question number 90
[2025-02-21 05:39:16,224][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:39:24,129][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:39:37,504][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:39:48,714][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:39:55,168][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:40:04,356][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:40:13,752][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:40:27,659][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:40:36,333][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:40:46,627][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:40:55,748][root][INFO] - Inference complete
[2025-02-21 05:40:55,748][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,755][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,762][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 05:40:55,769][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,778][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,778][root][INFO] - Saved parsed outputs
[2025-02-21 05:40:55,778][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,779][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,779][root][INFO] - Saved parsing metadata
[2025-02-21 05:40:55,780][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,781][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:40:55,796][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:40:55,825][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:40:55,825][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.39, 'malformed_label': 2, 'malformed_domain': 27, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.16, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 17, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 05:41:03,270][root][INFO] - Setting global seed to 989
[2025-02-21 05:41:03,278][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:41:03,278][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:41:03,280][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:41:03,281][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:41:03,285][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:41:03,286][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:41:03,427][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:41:03,971][root][INFO] - Full model selected, loading model
[2025-02-21 05:41:21,881][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:43:05,594][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:43:05,623][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:43:38,686][root][INFO] - Peft model loaded successfully
[2025-02-21 05:43:48,308][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:43:48,310][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:43:48,310][root][INFO] - Starting inference
[2025-02-21 05:43:48,460][root][INFO] - Processing question number 0
[2025-02-21 05:43:48,465][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:44:02,511][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:44:10,501][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:44:19,551][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:44:33,511][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:44:40,611][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:44:49,266][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:45:20,388][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:45:31,366][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:45:40,326][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:45:48,526][root][INFO] - Processing question number 10
[2025-02-21 05:45:48,528][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:46:01,009][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:46:10,580][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:46:18,984][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:46:29,508][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:46:39,663][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:46:51,615][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:47:01,814][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:47:11,327][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:47:21,075][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:47:30,580][root][INFO] - Processing question number 20
[2025-02-21 05:47:30,582][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:47:38,696][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:47:46,010][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:47:59,067][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:48:06,419][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:48:16,775][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:48:26,895][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:48:38,170][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:48:46,047][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:48:53,156][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:49:04,754][root][INFO] - Processing question number 30
[2025-02-21 05:49:04,757][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:49:13,587][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:49:21,280][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:49:33,212][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:50:04,753][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:50:14,390][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:50:21,527][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:50:28,882][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:50:38,166][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:50:46,141][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:51:03,542][root][INFO] - Processing question number 40
[2025-02-21 05:51:03,546][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:51:14,036][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:51:23,154][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:51:30,206][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:51:40,725][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:51:54,443][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:52:00,693][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:52:10,514][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:52:17,124][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:52:48,360][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:52:55,873][root][INFO] - Processing question number 50
[2025-02-21 05:52:55,877][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:53:03,317][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:53:08,282][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:53:21,408][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:53:32,977][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:53:43,236][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:53:50,631][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:54:07,759][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:54:17,174][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:54:23,195][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:54:54,519][root][INFO] - Processing question number 60
[2025-02-21 05:54:54,523][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:55:06,347][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:55:14,369][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:55:27,729][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:55:37,944][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:56:09,444][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:56:21,406][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:56:28,932][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:56:34,922][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:56:50,541][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:57:00,489][root][INFO] - Processing question number 70
[2025-02-21 05:57:00,493][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:57:31,879][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:57:45,122][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:57:56,756][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:58:14,163][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:58:23,644][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:58:31,854][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:58:44,508][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:58:55,799][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:59:06,329][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:59:37,440][root][INFO] - Processing question number 80
[2025-02-21 05:59:37,445][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:59:46,413][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:00:04,949][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:00:19,427][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:00:29,736][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:00:39,915][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:00:48,358][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:01:02,773][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:01:34,636][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:01:43,636][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:02:14,906][root][INFO] - Processing question number 90
[2025-02-21 06:02:14,912][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:02:21,011][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:02:52,813][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:03:06,640][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:03:12,309][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:03:44,154][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:03:55,593][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:04:04,053][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:04:18,669][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:04:27,151][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:04:35,368][root][INFO] - Inference complete
[2025-02-21 06:04:35,368][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,374][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,376][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Constitutional_law
[2025-02-21 06:04:35,380][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 06:04:35,382][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Evidence
[2025-02-21 06:04:35,384][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 06:04:35,384][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 06:04:35,385][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 06:04:35,387][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 06:04:35,388][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Torts
[2025-02-21 06:04:35,389][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 06:04:35,389][root][WARNING] - No match found for 3. Chosen Option Label in question number 45 in domain Torts
[2025-02-21 06:04:35,390][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 06:04:35,391][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,412][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,412][root][INFO] - Saved parsed outputs
[2025-02-21 06:04:35,412][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,424][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,425][root][INFO] - Saved parsing metadata
[2025-02-21 06:04:35,425][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,426][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:04:35,428][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:04:35,451][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:04:35,451][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.38, 'malformed_label': 11, 'malformed_domain': 13, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 06:04:42,697][root][INFO] - Setting global seed to 989
[2025-02-21 06:04:42,704][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:04:42,704][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:04:42,705][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:04:42,707][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:04:42,709][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:04:42,709][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:04:43,759][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:04:44,296][root][INFO] - Full model selected, loading model
[2025-02-21 06:05:00,698][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:05:00,698][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:05:08,172][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:05:08,174][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:05:08,174][root][INFO] - Starting inference
[2025-02-21 06:05:08,344][root][INFO] - Processing question number 0
[2025-02-21 06:05:08,354][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:05:20,609][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:05:29,615][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:05:38,129][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:05:47,162][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:05:57,582][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:06:05,901][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:06:13,701][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:06:20,750][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:06:27,912][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:06:38,060][root][INFO] - Processing question number 10
[2025-02-21 06:06:38,062][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:06:45,791][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:06:56,269][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:07:06,021][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:07:16,703][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:07:26,667][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:07:35,831][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:07:45,885][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:07:55,158][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:08:02,671][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:08:11,986][root][INFO] - Processing question number 20
[2025-02-21 06:08:11,989][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:08:20,112][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:08:29,386][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:08:38,322][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:08:45,770][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:08:54,249][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:09:04,369][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:09:15,846][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:09:24,821][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:09:34,206][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:09:43,246][root][INFO] - Processing question number 30
[2025-02-21 06:09:43,248][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:09:54,537][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:10:01,693][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:10:12,880][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:10:24,924][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:10:35,619][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:10:49,864][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:11:01,144][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:11:11,398][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:11:19,922][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:11:28,088][root][INFO] - Processing question number 40
[2025-02-21 06:11:28,091][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:11:36,992][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:11:44,781][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:11:58,377][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:12:06,602][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:12:21,105][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:12:28,735][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:12:37,919][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:13:09,253][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:13:19,824][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:13:29,096][root][INFO] - Processing question number 50
[2025-02-21 06:13:29,099][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:13:42,194][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:13:51,431][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:14:05,476][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:14:16,905][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:14:47,937][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:15:00,943][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:15:12,298][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:15:21,178][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:15:32,938][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:15:41,942][root][INFO] - Processing question number 60
[2025-02-21 06:15:41,946][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:15:52,876][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:16:04,594][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:16:14,883][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:16:23,054][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:16:31,216][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:16:43,636][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:16:51,899][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:17:00,048][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:17:12,866][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:17:26,709][root][INFO] - Processing question number 70
[2025-02-21 06:17:26,713][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:17:36,890][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:17:46,123][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:18:02,144][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:18:17,526][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:18:26,082][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:18:37,822][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:18:47,825][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:19:01,006][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:19:07,616][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:19:19,234][root][INFO] - Processing question number 80
[2025-02-21 06:19:19,239][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:19:26,316][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:19:36,238][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:19:48,285][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:19:57,950][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:20:06,659][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:20:17,605][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:20:29,440][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:20:39,640][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:20:48,706][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:20:58,436][root][INFO] - Processing question number 90
[2025-02-21 06:20:58,441][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:21:08,564][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:21:19,559][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:21:33,601][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:21:39,468][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:21:52,344][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:22:03,841][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:22:17,899][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:22:26,681][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:22:36,738][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:22:48,513][root][INFO] - Inference complete
[2025-02-21 06:22:48,514][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,521][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,528][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 06:22:48,529][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Evidence
[2025-02-21 06:22:48,535][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,540][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,540][root][INFO] - Saved parsed outputs
[2025-02-21 06:22:48,540][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,546][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,546][root][INFO] - Saved parsing metadata
[2025-02-21 06:22:48,547][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,548][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:22:48,550][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:22:48,583][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:22:48,583][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.35, 'malformed_label': 2, 'malformed_domain': 32, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 18, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 06:22:56,415][root][INFO] - Setting global seed to 989
[2025-02-21 06:22:56,423][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:22:56,423][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:22:56,424][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:22:56,425][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:22:56,428][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:22:56,429][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:22:56,767][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:22:57,367][root][INFO] - Full model selected, loading model
[2025-02-21 06:23:17,662][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:25:04,698][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:25:04,699][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:25:38,267][root][INFO] - Peft model loaded successfully
[2025-02-21 06:25:48,243][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:25:48,245][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:25:48,246][root][INFO] - Starting inference
[2025-02-21 06:25:48,424][root][INFO] - Processing question number 0
[2025-02-21 06:25:48,427][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:25:59,056][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:26:06,940][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:26:16,340][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:26:27,462][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:26:39,706][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:26:48,209][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:27:19,313][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:27:25,078][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:27:35,870][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:27:46,665][root][INFO] - Processing question number 10
[2025-02-21 06:27:46,668][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:27:55,210][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:28:03,397][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:28:14,488][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:28:27,576][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:28:39,082][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:28:46,456][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:28:53,284][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:29:03,634][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:29:16,153][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:29:25,351][root][INFO] - Processing question number 20
[2025-02-21 06:29:25,353][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:29:36,166][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:29:48,985][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:30:02,490][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:30:09,932][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:30:20,485][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:30:28,846][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:30:39,980][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:30:50,363][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:30:58,361][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:31:08,257][root][INFO] - Processing question number 30
[2025-02-21 06:31:08,260][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:31:19,739][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:31:30,430][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:31:40,376][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:31:47,939][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:31:57,741][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:32:05,662][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:32:12,528][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:32:22,007][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:32:28,195][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:32:35,907][root][INFO] - Processing question number 40
[2025-02-21 06:32:35,911][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:32:46,225][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:32:52,918][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:33:00,428][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:33:07,905][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:33:22,893][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:33:32,352][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:33:45,565][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:33:54,546][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:34:12,537][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:34:18,358][root][INFO] - Processing question number 50
[2025-02-21 06:34:18,362][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:34:28,100][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:34:34,617][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:34:47,879][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:34:57,532][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:35:03,078][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:35:10,418][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:35:28,776][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:35:38,483][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:35:53,135][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:36:04,326][root][INFO] - Processing question number 60
[2025-02-21 06:36:04,331][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:36:15,349][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:36:28,259][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:36:44,731][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:36:54,540][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:37:05,491][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:37:13,086][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:37:20,704][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:37:29,191][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:37:41,691][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:37:56,067][root][INFO] - Processing question number 70
[2025-02-21 06:37:56,071][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:38:03,039][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:38:12,013][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:38:26,112][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:38:35,228][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:38:45,834][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:38:57,048][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:39:10,773][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:39:30,493][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:39:37,049][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:39:47,654][root][INFO] - Processing question number 80
[2025-02-21 06:39:47,658][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:39:57,528][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:40:05,070][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:40:14,372][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:40:25,886][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:40:36,166][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:40:42,985][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:40:53,487][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:40:59,343][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:41:06,652][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:41:21,035][root][INFO] - Processing question number 90
[2025-02-21 06:41:21,041][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:41:29,699][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:41:41,188][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:41:55,315][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:42:08,261][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:42:18,834][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:42:29,515][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:42:39,072][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:42:46,376][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:42:52,799][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:43:02,209][root][INFO] - Inference complete
[2025-02-21 06:43:02,210][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,216][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,218][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Constitutional_law
[2025-02-21 06:43:02,230][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,236][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,236][root][INFO] - Saved parsed outputs
[2025-02-21 06:43:02,236][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,237][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,237][root][INFO] - Saved parsing metadata
[2025-02-21 06:43:02,238][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,239][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:02,243][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:43:02,273][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:43:02,273][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.41, 'malformed_label': 1, 'malformed_domain': 20, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.14, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 13, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 12 to status running with exit code None
Eval status update completed for job 12
[2025-02-21 06:43:10,586][root][INFO] - Setting global seed to 989
[2025-02-21 06:43:10,594][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:43:10,594][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:43:10,595][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:43:10,597][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:43:10,599][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:43:10,600][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:43:10,749][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:43:11,285][root][INFO] - Full model selected, loading model
[2025-02-21 06:43:29,943][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:43:29,943][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:43:37,360][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:43:37,362][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:43:37,362][root][INFO] - Starting inference
[2025-02-21 06:43:37,552][root][INFO] - Processing question number 0
[2025-02-21 06:43:37,555][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:43:48,253][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:43:59,688][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:44:11,598][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:44:19,833][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:44:28,665][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:44:34,878][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:44:51,543][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:45:00,378][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:45:07,382][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:45:15,144][root][INFO] - Processing question number 10
[2025-02-21 06:45:15,146][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:45:23,354][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:45:29,870][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:45:40,269][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:45:51,884][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:46:02,496][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:46:12,154][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:46:23,807][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:46:35,815][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:46:45,573][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:46:54,885][root][INFO] - Processing question number 20
[2025-02-21 06:46:54,887][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:47:01,350][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:47:09,267][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:47:17,263][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:47:25,002][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:47:34,421][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:47:43,886][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:47:52,326][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:48:01,600][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:48:10,039][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:48:20,854][root][INFO] - Processing question number 30
[2025-02-21 06:48:20,857][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:48:30,351][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:48:37,159][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:48:51,385][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:49:02,280][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:49:17,293][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:49:29,240][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:49:37,868][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:49:47,926][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:49:58,610][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:50:08,237][root][INFO] - Processing question number 40
[2025-02-21 06:50:08,240][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:50:17,900][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:50:24,325][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:50:36,369][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:50:46,574][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:50:57,969][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:51:10,107][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:51:19,784][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:51:30,175][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:51:44,609][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:51:54,429][root][INFO] - Processing question number 50
[2025-02-21 06:51:54,432][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:52:02,674][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:52:14,452][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:52:27,273][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:52:40,259][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:52:48,893][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:52:57,813][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:53:07,062][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:53:15,536][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:53:24,085][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:53:31,939][root][INFO] - Processing question number 60
[2025-02-21 06:53:31,943][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:53:40,425][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:53:48,562][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:53:59,920][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:54:10,895][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:54:22,512][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:54:32,679][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:54:40,002][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:54:45,307][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:54:55,769][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:55:06,753][root][INFO] - Processing question number 70
[2025-02-21 06:55:06,758][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:55:17,580][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:55:24,475][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:55:38,543][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:55:55,699][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:56:04,656][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:56:14,319][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:56:26,055][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:56:37,395][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:56:45,271][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:56:56,582][root][INFO] - Processing question number 80
[2025-02-21 06:56:56,586][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:57:04,159][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:57:11,458][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:57:20,710][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:57:30,824][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:57:41,006][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:57:53,290][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:58:07,970][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:58:19,992][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:58:29,197][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:58:40,464][root][INFO] - Processing question number 90
[2025-02-21 06:58:40,469][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:58:51,337][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:58:58,598][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:59:06,326][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:59:14,115][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:59:24,231][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:59:35,113][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:59:43,375][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:59:53,338][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:00:03,932][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:00:13,730][root][INFO] - Inference complete
[2025-02-21 07:00:13,731][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,737][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,750][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,755][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,756][root][INFO] - Saved parsed outputs
[2025-02-21 07:00:13,756][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,758][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,758][root][INFO] - Saved parsing metadata
[2025-02-21 07:00:13,758][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,760][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:00:13,761][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:00:13,775][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:00:13,775][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.33, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.08, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 19, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '12', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 12 to status completed with exit code 0
Eval status update completed for job 12
Job 12 completed at Fri Feb 21 07:00:14 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n510
Job ID: 25309347
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 07:59:11
CPU Efficiency: 9.90% of 3-08:38:10 core-walltime
Job Wall-clock time: 08:03:49
Memory Utilized: 34.50 GB
Memory Efficiency: 95.84% of 36.00 GB
