Starting job 10 at Thu Mar  6 09:43:19 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_fact_first_few_shot_structured train=json_fact_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '10', 'training']
Updating job 10 to status training with exit code None
Status update completed for job 10
[2025-03-06 09:43:26,435][root][INFO] - Global seed set to 314
[2025-03-06 09:43:26,436][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 09:43:26,437][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 09:43:26,437][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 09:43:26,437][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:43:26,437][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 09:43:26,459][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:43:26,466][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 09:43:26,468][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 09:43:26,518][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 09:43:27,260][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 09:43:46,939][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 09:44:15,510][root][INFO] - Model prepared for kbit training
[2025-03-06 09:44:15,511][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'up_proj', 'down_proj', 'o_proj', 'gate_proj', 'k_proj', 'v_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 09:44:17,269][root][INFO] - Lora adapter added to model
[2025-03-06 09:44:17,272][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_few_shot_structured
[2025-03-06 09:44:17,537][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6133, 'grad_norm': 0.36817729473114014, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.3084, 'grad_norm': 0.3452197015285492, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.0972, 'grad_norm': 0.3520616590976715, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 0.9382, 'grad_norm': 0.37874847650527954, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.6856, 'grad_norm': 0.3664920926094055, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 423.2393, 'train_samples_per_second': 0.248, 'train_steps_per_second': 0.035, 'train_loss': 1.1285356044769288, 'epoch': 15.0}
[2025-03-06 09:51:28,573][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '10', 'trained', '0']
Updating job 10 to status trained with exit code 0
Status update completed for job 10
Starting evaluations for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 09:51:40,640][root][INFO] - Setting global seed to 206
[2025-03-06 09:51:40,662][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:51:40,663][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:51:40,664][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:51:40,665][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:51:40,668][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:51:40,668][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:51:40,833][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:51:41,393][root][INFO] - Full model selected, loading model
[2025-03-06 09:52:07,724][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:53:50,975][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:53:50,991][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:54:24,957][root][INFO] - Peft model loaded successfully
[2025-03-06 09:54:32,476][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:54:32,477][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 09:54:32,477][root][INFO] - Starting inference
[2025-03-06 09:54:32,672][root][INFO] - Processing question number 0
[2025-03-06 09:54:32,675][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:54:45,116][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:55:00,370][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:55:16,237][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:55:33,742][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:55:46,967][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:56:01,996][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:56:16,630][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:56:33,031][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:56:45,310][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:56:59,883][root][INFO] - Processing question number 10
[2025-03-06 09:56:59,885][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:57:18,894][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:57:34,939][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:57:48,961][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:58:04,472][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:58:19,341][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:58:34,334][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:58:48,012][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:59:05,268][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:59:18,363][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:59:31,433][root][INFO] - Processing question number 20
[2025-03-06 09:59:31,435][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:59:44,743][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:59:57,576][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:00:12,837][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:00:26,530][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:00:41,092][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:00:58,694][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:01:14,129][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:01:28,523][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:01:44,524][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:01:57,747][root][INFO] - Processing question number 30
[2025-03-06 10:01:57,750][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:02:14,423][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:02:27,753][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:02:44,292][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:02:59,586][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:03:11,367][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:03:28,713][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:03:46,048][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:03:59,856][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:04:12,517][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:04:28,006][root][INFO] - Processing question number 40
[2025-03-06 10:04:28,009][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:04:43,920][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:04:59,851][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:05:16,383][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:05:30,347][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:05:44,459][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:05:58,835][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:06:14,349][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:06:27,254][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:06:44,444][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:06:57,953][root][INFO] - Processing question number 50
[2025-03-06 10:06:57,956][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:07:11,775][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:07:26,882][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:07:39,541][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:07:54,975][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:08:07,367][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:08:20,714][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:08:37,621][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:08:51,037][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:09:05,094][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:09:17,781][root][INFO] - Processing question number 60
[2025-03-06 10:09:17,786][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:09:30,849][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:09:43,140][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:09:58,755][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:10:10,801][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:10:24,007][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:10:38,016][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:10:50,777][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:11:05,431][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:11:19,368][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:11:33,854][root][INFO] - Processing question number 70
[2025-03-06 10:11:33,858][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:11:48,328][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:12:03,182][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:12:17,280][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:12:32,900][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:12:50,647][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:13:05,383][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:13:22,821][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:13:36,843][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:13:55,843][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:14:09,899][root][INFO] - Processing question number 80
[2025-03-06 10:14:09,904][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:14:23,786][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:14:42,798][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:14:57,934][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:15:15,103][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:15:31,536][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:15:45,264][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:16:00,013][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:16:14,360][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:16:29,573][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:16:41,040][root][INFO] - Processing question number 90
[2025-03-06 10:16:41,045][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:16:57,225][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:17:09,990][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:17:25,850][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:17:38,998][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:17:56,227][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:18:10,511][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:18:24,336][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:18:40,037][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:18:55,407][root][INFO] - Inference complete
[2025-03-06 10:18:55,407][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,413][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,426][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,431][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,431][root][INFO] - Saved parsed outputs
[2025-03-06 10:18:55,431][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,433][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,433][root][INFO] - Saved parsing metadata
[2025-03-06 10:18:55,433][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,435][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:18:55,436][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:18:55,469][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 10:18:55,469][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 14, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 10:19:02,045][root][INFO] - Setting global seed to 206
[2025-03-06 10:19:02,050][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:19:02,051][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:19:02,052][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:19:02,053][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:19:02,055][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:19:02,055][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:19:02,203][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:19:02,738][root][INFO] - Full model selected, loading model
[2025-03-06 10:19:16,451][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:19:16,452][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:19:24,125][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:19:24,126][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:19:24,126][root][INFO] - Starting inference
[2025-03-06 10:19:24,331][root][INFO] - Processing question number 0
[2025-03-06 10:19:24,332][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:19:35,266][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:19:49,978][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:20:07,867][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:20:24,256][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:20:44,711][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:20:59,049][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:21:11,913][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:21:27,366][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:21:38,996][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:21:51,596][root][INFO] - Processing question number 10
[2025-03-06 10:21:51,598][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:22:06,587][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:22:21,693][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:22:34,848][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:22:49,352][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:23:02,954][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:23:15,254][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:23:29,714][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:23:43,031][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:23:55,679][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:24:06,766][root][INFO] - Processing question number 20
[2025-03-06 10:24:06,768][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:24:20,351][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:24:38,742][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:24:53,823][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:25:05,986][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:25:19,592][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:25:34,411][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:25:49,234][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:26:02,944][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:26:19,229][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:26:32,531][root][INFO] - Processing question number 30
[2025-03-06 10:26:32,533][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:26:48,567][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:27:02,086][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:27:16,396][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:27:32,078][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:27:43,940][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:27:57,257][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:28:15,087][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:28:31,647][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:28:44,959][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:29:00,483][root][INFO] - Processing question number 40
[2025-03-06 10:29:00,487][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:29:14,133][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:29:28,596][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:29:44,278][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:30:01,013][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:30:16,599][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:30:32,139][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:30:47,775][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:31:00,948][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:31:13,543][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:31:26,464][root][INFO] - Processing question number 50
[2025-03-06 10:31:26,467][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:31:41,128][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:31:57,376][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:32:10,828][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:32:25,127][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:32:39,125][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:32:52,102][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:33:07,100][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:33:21,077][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:33:36,191][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:33:48,946][root][INFO] - Processing question number 60
[2025-03-06 10:33:48,950][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:34:05,099][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:34:14,782][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:34:29,718][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:34:41,424][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:34:54,617][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:35:09,267][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:35:23,174][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:35:37,699][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:35:51,974][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:36:08,067][root][INFO] - Processing question number 70
[2025-03-06 10:36:08,071][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:36:20,279][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:36:33,397][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:36:48,039][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:37:03,825][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:37:20,571][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:37:34,921][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:37:51,542][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:38:05,505][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:38:22,459][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:38:38,451][root][INFO] - Processing question number 80
[2025-03-06 10:38:38,456][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:38:51,815][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:39:11,067][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:39:24,561][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:39:39,704][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:39:55,389][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:40:08,799][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:40:25,023][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:40:39,928][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:40:57,635][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:41:10,895][root][INFO] - Processing question number 90
[2025-03-06 10:41:10,901][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:41:27,271][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:41:42,271][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:41:55,636][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:42:09,621][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:42:24,424][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:42:38,894][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:42:52,558][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:43:07,178][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:43:20,444][root][INFO] - Inference complete
[2025-03-06 10:43:20,444][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,451][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,462][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,469][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,469][root][INFO] - Saved parsed outputs
[2025-03-06 10:43:20,469][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,470][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,470][root][INFO] - Saved parsing metadata
[2025-03-06 10:43:20,471][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,472][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:43:20,474][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:43:20,480][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 10:43:20,480][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 16, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 10:43:27,036][root][INFO] - Setting global seed to 206
[2025-03-06 10:43:27,041][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:43:27,042][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:43:27,043][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:43:27,045][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:43:27,047][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:43:27,047][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:43:27,209][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:43:27,813][root][INFO] - Full model selected, loading model
[2025-03-06 10:43:41,638][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:45:21,543][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:45:21,544][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:45:53,271][root][INFO] - Peft model loaded successfully
[2025-03-06 10:46:00,669][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:46:00,671][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:46:00,671][root][INFO] - Starting inference
[2025-03-06 10:46:00,860][root][INFO] - Processing question number 0
[2025-03-06 10:46:00,862][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:46:13,340][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:46:28,901][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:46:48,903][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:47:05,255][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:47:20,405][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:47:34,344][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:47:49,428][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:48:06,509][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:48:19,519][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:48:33,467][root][INFO] - Processing question number 10
[2025-03-06 10:48:33,469][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:48:50,561][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:49:05,644][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:49:19,524][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:49:35,454][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:49:49,543][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:50:04,842][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:50:20,178][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:50:36,940][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:50:52,421][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:51:04,716][root][INFO] - Processing question number 20
[2025-03-06 10:51:04,719][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:51:18,470][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:51:33,181][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:51:48,244][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:52:00,511][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:52:15,220][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:52:29,184][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:52:45,086][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:52:59,989][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:53:15,485][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:53:28,498][root][INFO] - Processing question number 30
[2025-03-06 10:53:28,501][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:53:46,022][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:54:00,686][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:54:17,304][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:54:33,329][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:54:45,755][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:55:01,264][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:55:18,476][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:55:33,782][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:55:47,667][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:56:01,687][root][INFO] - Processing question number 40
[2025-03-06 10:56:01,691][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:56:17,309][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:56:31,842][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:56:51,325][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:57:05,543][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:57:20,204][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:57:36,487][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:57:54,106][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:58:07,501][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:58:20,408][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:58:37,117][root][INFO] - Processing question number 50
[2025-03-06 10:58:37,121][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:58:51,132][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:59:07,390][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:59:20,700][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:59:32,743][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:59:47,226][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:00:01,235][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:00:18,172][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:00:32,799][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:00:49,716][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:01:02,383][root][INFO] - Processing question number 60
[2025-03-06 11:01:02,387][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:01:15,650][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:01:27,389][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:01:46,440][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:01:59,295][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:02:16,038][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:02:33,136][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:02:46,292][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:02:59,823][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:03:13,607][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:03:32,055][root][INFO] - Processing question number 70
[2025-03-06 11:03:32,060][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:03:46,891][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:04:00,695][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:04:14,845][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:04:29,479][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:04:46,080][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:04:59,032][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:05:15,174][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:05:28,752][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:05:43,601][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:05:57,567][root][INFO] - Processing question number 80
[2025-03-06 11:05:57,572][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:06:12,289][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:06:30,615][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:06:44,229][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:06:58,682][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:07:14,243][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:07:31,825][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:07:47,930][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:08:04,910][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:08:21,271][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:08:37,286][root][INFO] - Processing question number 90
[2025-03-06 11:08:37,292][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:08:54,959][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:09:10,816][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:09:23,986][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:09:37,897][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:09:54,077][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:10:10,364][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:10:22,973][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:10:37,202][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:10:53,367][root][INFO] - Inference complete
[2025-03-06 11:10:53,367][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,373][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,386][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,392][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,393][root][INFO] - Saved parsed outputs
[2025-03-06 11:10:53,393][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,394][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,394][root][INFO] - Saved parsing metadata
[2025-03-06 11:10:53,395][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,396][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:10:53,398][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:10:53,444][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 11:10:53,445][root][INFO] - Summary of metrics : {'label_accuracy': 0.5555555555555556, 'misclassification_rate': 0.4444444444444444, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 55, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.7692307692307693, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 14, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 11:11:01,311][root][INFO] - Setting global seed to 206
[2025-03-06 11:11:01,326][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:11:01,326][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:11:01,328][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:11:01,329][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:11:01,332][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:11:01,332][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:11:01,488][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:11:02,036][root][INFO] - Full model selected, loading model
[2025-03-06 11:11:23,978][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:11:23,979][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:11:31,932][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:11:31,933][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:11:31,933][root][INFO] - Starting inference
[2025-03-06 11:11:32,117][root][INFO] - Processing question number 0
[2025-03-06 11:11:32,119][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:11:43,255][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:11:56,420][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:12:17,436][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:12:37,425][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:12:50,657][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:13:06,002][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:13:20,360][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:13:36,523][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:13:49,255][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:14:03,923][root][INFO] - Processing question number 10
[2025-03-06 11:14:03,925][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:14:21,650][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:14:34,319][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:14:50,375][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:15:05,183][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:15:19,216][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:15:30,624][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:15:44,417][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:15:56,318][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:16:09,526][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:16:20,852][root][INFO] - Processing question number 20
[2025-03-06 11:16:20,855][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:16:34,298][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:16:52,203][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:17:05,235][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:17:18,355][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:17:32,913][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:17:46,163][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:17:58,889][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:18:13,609][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:18:27,643][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:18:41,838][root][INFO] - Processing question number 30
[2025-03-06 11:18:41,841][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:18:55,267][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:19:06,710][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:19:20,404][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:19:36,600][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:19:48,034][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:20:01,333][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:20:20,064][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:20:35,593][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:20:51,095][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:21:05,775][root][INFO] - Processing question number 40
[2025-03-06 11:21:05,778][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:21:18,954][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:21:32,280][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:21:49,425][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:22:03,405][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:22:16,299][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:22:31,112][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:22:45,859][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:23:01,196][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:23:12,608][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:23:27,789][root][INFO] - Processing question number 50
[2025-03-06 11:23:27,792][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:23:40,322][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:23:56,459][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:24:09,838][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:24:24,053][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:24:37,340][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:24:51,674][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:25:05,452][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:25:17,976][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:25:34,766][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:25:48,293][root][INFO] - Processing question number 60
[2025-03-06 11:25:48,297][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:26:03,476][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:26:14,614][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:26:28,734][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:26:41,502][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:26:54,585][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:27:09,506][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:27:23,061][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:27:37,852][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:27:51,324][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:28:07,492][root][INFO] - Processing question number 70
[2025-03-06 11:28:07,496][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:28:20,674][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:28:35,787][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:28:50,644][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:29:05,779][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:29:21,475][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:29:34,762][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:29:52,245][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:30:07,298][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:30:21,945][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:30:37,700][root][INFO] - Processing question number 80
[2025-03-06 11:30:37,704][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:30:51,893][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:31:09,519][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:31:21,604][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:31:35,990][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:31:49,162][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:32:04,382][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:32:20,535][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:32:35,712][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:32:55,279][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:33:08,678][root][INFO] - Processing question number 90
[2025-03-06 11:33:08,684][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:33:25,760][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:33:42,186][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:33:55,801][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:34:07,726][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:34:23,203][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:34:38,039][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:34:51,495][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:35:06,122][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:35:19,923][root][INFO] - Inference complete
[2025-03-06 11:35:19,923][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,929][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,931][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:35:19,932][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:35:19,933][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:35:19,943][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,949][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,949][root][INFO] - Saved parsed outputs
[2025-03-06 11:35:19,950][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,951][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,951][root][INFO] - Saved parsing metadata
[2025-03-06 11:35:19,951][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,953][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:35:19,954][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:35:19,989][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 11:35:19,990][root][INFO] - Summary of metrics : {'label_accuracy': 0.5858585858585859, 'misclassification_rate': 0.41414141414141414, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 1, 'malformed_domain': 32, 'total_predictions': 99, 'correct_predictions': 58, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.6666666666666666, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 18, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 11:35:26,831][root][INFO] - Setting global seed to 206
[2025-03-06 11:35:26,838][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:35:26,839][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:35:26,840][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:35:26,841][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:35:26,844][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:35:26,844][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:35:27,000][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:35:27,565][root][INFO] - Full model selected, loading model
[2025-03-06 11:35:43,913][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:37:24,559][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:37:24,589][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:37:58,769][root][INFO] - Peft model loaded successfully
[2025-03-06 11:38:06,193][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:38:06,195][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:38:06,195][root][INFO] - Starting inference
[2025-03-06 11:38:06,380][root][INFO] - Processing question number 0
[2025-03-06 11:38:06,382][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:38:19,763][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:38:35,176][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:38:55,890][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:39:11,131][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:39:26,753][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:39:41,737][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:39:56,883][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:40:12,529][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:40:25,255][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:40:39,731][root][INFO] - Processing question number 10
[2025-03-06 11:40:39,733][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:40:59,538][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:41:16,570][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:41:31,078][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:41:46,854][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:42:02,183][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:42:18,364][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:42:32,409][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:42:45,754][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:42:58,687][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:43:12,879][root][INFO] - Processing question number 20
[2025-03-06 11:43:12,881][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:43:25,724][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:43:42,147][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:43:55,036][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:44:10,258][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:44:27,701][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:44:42,944][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:44:57,484][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:45:11,646][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:45:24,892][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:45:39,438][root][INFO] - Processing question number 30
[2025-03-06 11:45:39,441][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:45:58,483][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:46:14,126][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:46:28,932][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:46:45,393][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:46:59,396][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:47:14,071][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:47:32,506][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:47:47,908][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:48:06,128][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:48:21,372][root][INFO] - Processing question number 40
[2025-03-06 11:48:21,375][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:48:35,920][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:48:51,726][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:49:09,523][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:49:26,177][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:49:40,381][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:49:52,872][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:50:10,926][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:50:23,930][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:50:42,707][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:50:56,726][root][INFO] - Processing question number 50
[2025-03-06 11:50:56,729][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:51:13,098][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:51:29,978][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:51:41,329][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:51:55,845][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:52:11,264][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:52:23,572][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:52:41,346][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:52:54,603][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:53:10,579][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:53:26,127][root][INFO] - Processing question number 60
[2025-03-06 11:53:26,131][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:53:39,395][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:53:52,488][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:54:08,697][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:54:21,144][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:54:35,374][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:54:50,871][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:55:03,932][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:55:17,573][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:55:31,007][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:55:45,658][root][INFO] - Processing question number 70
[2025-03-06 11:55:45,662][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:56:00,194][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:56:12,171][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:56:27,608][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:56:43,647][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:56:58,385][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:57:13,236][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:57:28,032][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:57:43,029][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:57:59,148][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:58:14,643][root][INFO] - Processing question number 80
[2025-03-06 11:58:14,647][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:58:30,460][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:58:50,773][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:59:04,395][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:59:18,593][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:59:31,715][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:59:50,394][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:00:07,551][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:00:21,969][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:00:37,538][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:00:50,859][root][INFO] - Processing question number 90
[2025-03-06 12:00:50,864][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:01:08,263][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:01:24,451][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:01:39,310][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:01:54,476][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:02:12,161][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:02:32,069][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:02:44,812][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:03:00,063][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:03:15,522][root][INFO] - Inference complete
[2025-03-06 12:03:15,522][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,528][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,541][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,547][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,547][root][INFO] - Saved parsed outputs
[2025-03-06 12:03:15,547][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,548][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,549][root][INFO] - Saved parsing metadata
[2025-03-06 12:03:15,549][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,551][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:15,552][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:03:15,590][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 12:03:15,590][root][INFO] - Summary of metrics : {'label_accuracy': 0.5656565656565656, 'misclassification_rate': 0.43434343434343436, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 29, 'total_predictions': 99, 'correct_predictions': 56, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.6923076923076923, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 15, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 12:03:22,916][root][INFO] - Setting global seed to 206
[2025-03-06 12:03:22,923][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:03:22,923][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:03:22,924][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:03:22,926][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:03:22,928][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:03:22,928][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:03:23,087][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:03:23,624][root][INFO] - Full model selected, loading model
[2025-03-06 12:03:44,990][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:03:44,990][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:03:52,612][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:03:52,614][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:03:52,614][root][INFO] - Starting inference
[2025-03-06 12:03:52,767][root][INFO] - Processing question number 0
[2025-03-06 12:03:52,769][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:04:04,024][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:04:16,138][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:04:36,584][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:04:49,863][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:05:04,617][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:05:18,355][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:05:34,807][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:05:49,010][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:06:00,387][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:06:13,917][root][INFO] - Processing question number 10
[2025-03-06 12:06:13,919][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:06:30,901][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:06:43,754][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:06:58,979][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:07:14,393][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:07:27,041][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:07:40,569][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:07:54,955][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:08:08,301][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:08:20,047][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:08:31,991][root][INFO] - Processing question number 20
[2025-03-06 12:08:31,993][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:08:44,928][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:08:59,651][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:09:12,228][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:09:25,252][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:09:44,695][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:10:00,624][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:10:15,950][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:10:29,219][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:10:45,137][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:10:56,585][root][INFO] - Processing question number 30
[2025-03-06 12:10:56,588][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:11:10,868][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:11:23,574][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:11:38,072][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:11:53,124][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:12:04,734][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:12:18,376][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:12:33,593][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:12:48,551][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:13:03,218][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:13:16,782][root][INFO] - Processing question number 40
[2025-03-06 12:13:16,785][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:13:31,072][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:13:43,860][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:13:59,735][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:14:14,232][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:14:28,138][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:14:41,583][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:14:54,516][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:15:09,173][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:15:20,990][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:15:37,436][root][INFO] - Processing question number 50
[2025-03-06 12:15:37,440][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:15:51,852][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:16:08,625][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:16:22,854][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:16:36,866][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:16:49,853][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:17:01,986][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:17:14,329][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:17:27,321][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:17:39,516][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:17:51,332][root][INFO] - Processing question number 60
[2025-03-06 12:17:51,336][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:18:04,132][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:18:18,751][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:18:39,100][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:18:51,889][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:19:04,627][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:19:19,007][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:19:33,326][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:19:44,059][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:19:56,439][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:20:10,325][root][INFO] - Processing question number 70
[2025-03-06 12:20:10,330][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:20:24,364][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:20:40,189][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:20:53,549][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:21:09,807][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:21:23,786][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:21:38,132][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:21:56,019][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:22:11,728][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:22:30,134][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:22:45,717][root][INFO] - Processing question number 80
[2025-03-06 12:22:45,903][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:23:00,800][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:23:16,384][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:23:29,367][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:23:42,268][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:23:55,175][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:24:10,434][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:24:24,449][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:24:40,742][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:24:57,188][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:25:09,678][root][INFO] - Processing question number 90
[2025-03-06 12:25:09,683][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:25:26,160][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:25:41,921][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:25:57,536][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:26:13,087][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:26:27,734][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:26:40,587][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:26:52,820][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:27:09,137][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:27:23,551][root][INFO] - Inference complete
[2025-03-06 12:27:23,551][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,558][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,560][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,560][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,561][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,562][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,562][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,562][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,564][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,564][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,564][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,566][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,566][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,567][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,567][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,567][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,567][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,569][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,570][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,570][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,571][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,571][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,571][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,571][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:27:23,571][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:27:23,571][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:27:23,575][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,581][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,581][root][INFO] - Saved parsed outputs
[2025-03-06 12:27:23,581][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,582][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,582][root][INFO] - Saved parsing metadata
[2025-03-06 12:27:23,583][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,584][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:27:23,585][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:27:23,600][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 12:27:23,600][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 8, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.08080808080808081, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.050505050505050504, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 24, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 12:27:30,323][root][INFO] - Setting global seed to 989
[2025-03-06 12:27:30,330][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:27:30,331][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:27:30,332][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:27:30,333][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:27:30,335][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:27:30,335][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:27:30,483][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:27:31,026][root][INFO] - Full model selected, loading model
[2025-03-06 12:27:49,862][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:29:30,649][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:29:30,668][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:30:07,474][root][INFO] - Peft model loaded successfully
[2025-03-06 12:30:14,862][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:30:14,864][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:30:14,864][root][INFO] - Starting inference
[2025-03-06 12:30:14,980][root][INFO] - Processing question number 0
[2025-03-06 12:30:14,982][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:30:27,353][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:30:42,591][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:30:58,446][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:31:15,932][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:31:29,147][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:31:44,161][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:31:58,783][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:32:15,167][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:32:27,435][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:32:41,991][root][INFO] - Processing question number 10
[2025-03-06 12:32:41,992][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:33:00,979][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:33:17,015][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:33:31,001][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:33:46,498][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:34:01,352][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:34:16,333][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:34:30,029][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:34:47,400][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:35:00,546][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:35:13,605][root][INFO] - Processing question number 20
[2025-03-06 12:35:13,607][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:35:26,893][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:35:39,718][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:35:54,963][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:36:08,645][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:36:23,192][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:36:40,783][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:36:56,280][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:37:10,563][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:37:26,398][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:37:39,615][root][INFO] - Processing question number 30
[2025-03-06 12:37:39,618][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:37:56,278][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:38:09,614][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:38:26,148][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:38:41,436][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:38:53,217][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:39:10,572][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:39:27,913][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:39:41,723][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:39:54,381][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:40:09,874][root][INFO] - Processing question number 40
[2025-03-06 12:40:09,877][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:40:25,789][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:40:41,731][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:40:58,260][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:41:12,221][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:41:26,379][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:41:40,890][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:41:56,489][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:42:09,495][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:42:26,796][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:42:40,351][root][INFO] - Processing question number 50
[2025-03-06 12:42:40,355][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:42:54,272][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:43:09,495][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:43:22,204][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:43:37,685][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:43:50,175][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:44:03,630][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:44:20,568][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:44:33,979][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:44:48,033][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:45:00,722][root][INFO] - Processing question number 60
[2025-03-06 12:45:00,726][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:45:13,788][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:45:26,083][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:45:41,697][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:45:53,748][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:46:06,948][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:46:21,003][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:46:33,866][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:46:48,620][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:47:02,673][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:47:17,266][root][INFO] - Processing question number 70
[2025-03-06 12:47:17,271][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:47:31,786][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:47:46,742][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:48:00,940][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:48:16,586][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:48:34,282][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:48:49,013][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:49:06,453][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:49:20,396][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:49:39,268][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:49:53,234][root][INFO] - Processing question number 80
[2025-03-06 12:49:53,239][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:50:07,069][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:50:26,013][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:50:41,035][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:50:58,117][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:51:14,549][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:51:28,281][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:51:43,036][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:51:57,389][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:52:12,611][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:52:24,089][root][INFO] - Processing question number 90
[2025-03-06 12:52:24,095][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:52:40,279][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:52:53,052][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:53:08,924][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:53:22,075][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:53:39,313][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:53:53,598][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:54:07,429][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:54:23,139][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:54:38,510][root][INFO] - Inference complete
[2025-03-06 12:54:38,510][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,517][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,529][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,535][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,535][root][INFO] - Saved parsed outputs
[2025-03-06 12:54:38,535][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,537][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,537][root][INFO] - Saved parsing metadata
[2025-03-06 12:54:38,537][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,539][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:54:38,540][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:54:38,566][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 12:54:38,567][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 14, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 12:54:45,557][root][INFO] - Setting global seed to 989
[2025-03-06 12:54:45,564][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:54:45,564][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:54:45,566][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:54:45,567][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:54:45,570][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:54:45,570][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:54:45,725][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:54:46,288][root][INFO] - Full model selected, loading model
[2025-03-06 12:55:11,665][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:55:11,665][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:55:19,501][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:55:19,502][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:55:19,502][root][INFO] - Starting inference
[2025-03-06 12:55:19,622][root][INFO] - Processing question number 0
[2025-03-06 12:55:19,624][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:55:30,550][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:55:45,203][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:56:03,023][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:56:19,343][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:56:39,722][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:56:53,997][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:57:06,831][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:57:22,231][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:57:33,812][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:57:46,353][root][INFO] - Processing question number 10
[2025-03-06 12:57:46,365][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:58:01,297][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:58:16,330][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:58:29,429][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:58:43,866][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:58:57,409][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:59:09,652][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:59:24,044][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:59:37,297][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:59:49,891][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:00:00,931][root][INFO] - Processing question number 20
[2025-03-06 13:00:00,944][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:00:14,471][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:00:32,779][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:00:47,795][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:00:59,897][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:01:13,443][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:01:28,195][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:01:42,956][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:01:56,611][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:02:12,823][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:02:26,057][root][INFO] - Processing question number 30
[2025-03-06 13:02:26,107][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:02:42,074][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:02:55,532][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:03:09,783][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:03:25,388][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:03:37,204][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:03:50,459][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:04:08,213][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:04:24,698][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:04:37,945][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:04:53,399][root][INFO] - Processing question number 40
[2025-03-06 13:04:53,431][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:05:07,060][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:05:21,460][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:05:37,110][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:05:53,883][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:06:09,541][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:06:25,053][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:06:40,623][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:06:53,736][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:07:06,277][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:07:19,136][root][INFO] - Processing question number 50
[2025-03-06 13:07:19,140][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:07:33,739][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:07:49,882][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:08:03,209][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:08:17,370][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:08:31,258][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:08:44,128][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:08:59,028][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:09:12,898][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:09:27,921][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:09:40,573][root][INFO] - Processing question number 60
[2025-03-06 13:09:40,577][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:09:56,643][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:10:06,259][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:10:21,081][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:10:32,703][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:10:45,838][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:11:00,421][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:11:14,276][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:11:28,740][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:11:42,957][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:11:58,987][root][INFO] - Processing question number 70
[2025-03-06 13:11:58,991][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:12:11,162][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:12:24,221][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:12:38,793][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:12:54,515][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:13:11,200][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:13:25,492][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:13:42,047][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:13:55,955][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:14:12,844][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:14:28,763][root][INFO] - Processing question number 80
[2025-03-06 13:14:28,768][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:14:42,078][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:15:01,250][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:15:14,697][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:15:29,779][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:15:45,405][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:15:58,759][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:16:14,925][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:16:29,762][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:16:47,417][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:17:00,703][root][INFO] - Processing question number 90
[2025-03-06 13:17:00,708][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:17:17,177][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:17:32,250][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:17:45,670][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:17:59,632][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:18:14,477][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:18:29,000][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:18:42,695][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:18:57,286][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:19:10,528][root][INFO] - Inference complete
[2025-03-06 13:19:10,528][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,535][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,547][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,553][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,553][root][INFO] - Saved parsed outputs
[2025-03-06 13:19:10,553][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,557][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,558][root][INFO] - Saved parsing metadata
[2025-03-06 13:19:10,558][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,559][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:19:10,574][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:19:10,610][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 13:19:10,611][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 16, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 13:19:19,266][root][INFO] - Setting global seed to 989
[2025-03-06 13:19:19,273][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:19:19,273][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:19:19,275][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:19:19,276][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:19:19,278][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:19:19,279][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:19:19,938][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:19:20,661][root][INFO] - Full model selected, loading model
[2025-03-06 13:19:42,979][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:21:24,795][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:21:24,796][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:22:02,156][root][INFO] - Peft model loaded successfully
[2025-03-06 13:22:10,035][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:22:10,036][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:22:10,036][root][INFO] - Starting inference
[2025-03-06 13:22:10,154][root][INFO] - Processing question number 0
[2025-03-06 13:22:10,156][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:22:23,203][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:22:38,874][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:22:54,344][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:23:13,372][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:23:28,426][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:23:44,218][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:24:00,513][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:24:16,050][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:24:27,257][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:24:40,798][root][INFO] - Processing question number 10
[2025-03-06 13:24:40,800][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:24:59,394][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:25:15,763][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:25:28,290][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:25:44,095][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:25:57,368][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:26:13,397][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:26:31,338][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:26:44,468][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:26:57,147][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:27:09,552][root][INFO] - Processing question number 20
[2025-03-06 13:27:09,555][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:27:21,878][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:27:39,436][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:27:54,141][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:28:07,742][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:28:22,718][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:28:37,670][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:28:53,264][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:29:08,955][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:29:23,278][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:29:36,398][root][INFO] - Processing question number 30
[2025-03-06 13:29:36,400][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:29:51,086][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:30:04,938][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:30:21,652][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:30:37,314][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:30:48,485][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:31:04,207][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:31:21,000][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:31:36,516][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:31:50,502][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:32:04,185][root][INFO] - Processing question number 40
[2025-03-06 13:32:04,188][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:32:18,587][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:32:35,113][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:32:52,191][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:33:04,360][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:33:18,152][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:33:34,031][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:33:48,870][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:34:02,622][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:34:16,869][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:34:32,552][root][INFO] - Processing question number 50
[2025-03-06 13:34:32,556][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:34:48,397][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:35:04,399][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:35:16,753][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:35:33,206][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:35:46,978][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:35:59,734][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:36:14,212][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:36:27,164][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:36:43,466][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:36:56,190][root][INFO] - Processing question number 60
[2025-03-06 13:36:56,194][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:37:07,028][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:37:18,657][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:37:35,330][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:37:47,419][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:38:00,413][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:38:16,423][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:38:28,356][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:38:42,552][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:38:56,702][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:39:11,138][root][INFO] - Processing question number 70
[2025-03-06 13:39:11,142][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:39:25,304][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:39:39,456][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:39:56,881][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:40:12,603][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:40:26,972][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:40:42,368][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:40:59,696][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:41:13,943][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:41:30,984][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:41:47,984][root][INFO] - Processing question number 80
[2025-03-06 13:41:47,988][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:42:02,711][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:42:19,253][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:42:35,830][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:42:48,598][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:43:03,693][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:43:20,074][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:43:36,242][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:43:50,499][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:44:09,129][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:44:21,492][root][INFO] - Processing question number 90
[2025-03-06 13:44:21,500][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:44:39,740][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:44:55,723][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:45:10,478][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:45:25,291][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:45:42,878][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:46:01,155][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:46:14,070][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:46:30,760][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:46:47,550][root][INFO] - Inference complete
[2025-03-06 13:46:47,550][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,557][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,569][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,576][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,576][root][INFO] - Saved parsed outputs
[2025-03-06 13:46:47,576][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,577][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,577][root][INFO] - Saved parsing metadata
[2025-03-06 13:46:47,578][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,594][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:46:47,596][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:46:47,635][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 13:46:47,635][root][INFO] - Summary of metrics : {'label_accuracy': 0.5656565656565656, 'misclassification_rate': 0.43434343434343436, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 1, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 56, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.6666666666666666, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 14, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 13:46:58,649][root][INFO] - Setting global seed to 989
[2025-03-06 13:46:58,657][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:46:58,657][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:46:58,658][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:46:58,660][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:46:58,662][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:46:58,662][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:46:58,810][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:46:59,339][root][INFO] - Full model selected, loading model
[2025-03-06 13:47:17,000][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:47:17,001][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:47:24,589][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:47:24,591][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:47:24,591][root][INFO] - Starting inference
[2025-03-06 13:47:24,707][root][INFO] - Processing question number 0
[2025-03-06 13:47:24,709][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:47:37,021][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:47:51,241][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:48:07,016][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:48:38,939][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:48:52,157][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:49:05,511][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:49:20,251][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:49:34,678][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:49:47,539][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:49:57,673][root][INFO] - Processing question number 10
[2025-03-06 13:49:57,675][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:50:13,054][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:50:27,531][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:50:41,719][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:50:55,341][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:51:08,335][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:51:21,346][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:51:37,629][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:51:50,162][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:52:04,398][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:52:18,064][root][INFO] - Processing question number 20
[2025-03-06 13:52:18,066][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:52:30,134][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:52:45,095][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:52:57,966][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:53:08,520][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:53:22,346][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:53:34,935][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:53:49,203][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:54:02,029][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:54:16,084][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:54:29,646][root][INFO] - Processing question number 30
[2025-03-06 13:54:29,648][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:54:44,224][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:54:56,418][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:55:10,801][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:55:23,793][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:55:35,762][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:55:48,682][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:56:03,013][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:56:20,850][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:56:36,786][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:56:49,728][root][INFO] - Processing question number 40
[2025-03-06 13:56:49,731][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:57:02,986][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:57:17,613][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:57:32,286][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:57:46,808][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:58:01,626][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:58:17,285][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:58:31,484][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:58:45,879][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:59:00,787][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:59:13,870][root][INFO] - Processing question number 50
[2025-03-06 13:59:13,873][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:59:28,920][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:59:43,829][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:59:57,937][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:00:13,322][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:00:28,417][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:00:39,909][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:00:52,929][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:01:08,415][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:01:22,262][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:01:34,929][root][INFO] - Processing question number 60
[2025-03-06 14:01:34,933][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:01:48,750][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:02:02,354][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:02:18,090][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:02:30,276][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:02:44,716][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:02:59,757][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:03:14,248][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:03:28,950][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:03:41,511][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:03:54,704][root][INFO] - Processing question number 70
[2025-03-06 14:03:54,709][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:04:08,107][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:04:22,919][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:04:35,841][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:04:49,650][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:05:03,342][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:05:18,374][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:05:34,971][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:05:50,079][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:06:06,649][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:06:19,240][root][INFO] - Processing question number 80
[2025-03-06 14:06:19,245][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:06:35,547][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:06:51,403][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:07:03,648][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:07:18,857][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:07:34,303][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:07:47,829][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:08:04,345][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:08:20,223][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:08:36,425][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:08:51,180][root][INFO] - Processing question number 90
[2025-03-06 14:08:51,185][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:09:04,711][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:09:20,055][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:09:36,971][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:09:51,810][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:10:05,381][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:10:20,726][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:10:34,277][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:10:51,080][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:11:02,560][root][INFO] - Inference complete
[2025-03-06 14:11:02,560][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,567][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,568][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:11:02,568][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:11:02,569][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:11:02,570][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:11:02,570][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:11:02,570][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:11:02,581][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,587][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,587][root][INFO] - Saved parsed outputs
[2025-03-06 14:11:02,587][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,589][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,589][root][INFO] - Saved parsing metadata
[2025-03-06 14:11:02,590][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,591][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:11:02,592][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:11:02,610][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 14:11:02,611][root][INFO] - Summary of metrics : {'label_accuracy': 0.5858585858585859, 'misclassification_rate': 0.41414141414141414, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 2, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 58, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 24, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 14:11:11,681][root][INFO] - Setting global seed to 989
[2025-03-06 14:11:11,689][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 14:11:11,689][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:11:11,690][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:11:11,692][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:11:11,694][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:11:11,694][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:11:11,863][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:11:12,481][root][INFO] - Full model selected, loading model
[2025-03-06 14:11:30,157][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:13:13,021][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:13:13,070][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:13:49,135][root][INFO] - Peft model loaded successfully
[2025-03-06 14:13:56,546][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:13:56,548][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:13:56,548][root][INFO] - Starting inference
[2025-03-06 14:13:56,721][root][INFO] - Processing question number 0
[2025-03-06 14:13:56,723][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:14:08,967][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:14:23,341][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:14:39,468][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:14:53,106][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:15:08,049][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:15:22,654][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:15:38,102][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:15:52,548][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:16:04,700][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:16:20,701][root][INFO] - Processing question number 10
[2025-03-06 14:16:20,702][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:16:36,772][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:16:52,057][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:17:04,764][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:17:19,180][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:17:31,419][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:17:45,802][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:17:59,574][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:18:13,025][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:18:27,885][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:18:42,010][root][INFO] - Processing question number 20
[2025-03-06 14:18:42,012][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:18:55,714][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:19:11,194][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:19:24,228][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:19:38,315][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:19:54,202][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:20:07,660][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:20:21,006][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:20:37,162][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:20:55,245][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:21:09,689][root][INFO] - Processing question number 30
[2025-03-06 14:21:09,691][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:21:26,450][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:21:43,081][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:21:57,161][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:22:13,446][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:22:26,190][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:22:41,468][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:22:57,438][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:23:12,600][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:23:27,035][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:23:42,204][root][INFO] - Processing question number 40
[2025-03-06 14:23:42,207][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:23:57,662][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:24:13,400][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:24:29,676][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:24:44,247][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:24:59,665][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:25:15,828][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:25:30,500][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:25:43,538][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:25:56,135][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:26:12,324][root][INFO] - Processing question number 50
[2025-03-06 14:26:12,327][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:26:26,705][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:26:44,249][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:26:58,410][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:27:13,751][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:27:26,949][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:27:40,341][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:27:56,376][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:28:10,386][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:28:24,289][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:28:36,543][root][INFO] - Processing question number 60
[2025-03-06 14:28:36,547][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:28:49,404][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:29:02,342][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:29:18,493][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:29:31,286][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:29:44,434][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:30:00,387][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:30:13,394][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:30:26,880][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:30:40,413][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:30:55,717][root][INFO] - Processing question number 70
[2025-03-06 14:30:55,721][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:31:08,964][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:31:23,068][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:31:37,580][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:31:54,649][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:32:09,120][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:32:22,894][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:32:37,322][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:32:52,340][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:33:09,806][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:33:23,730][root][INFO] - Processing question number 80
[2025-03-06 14:33:23,735][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:33:36,818][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:33:53,743][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:34:08,236][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:34:24,401][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:34:41,110][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:34:56,601][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:35:13,968][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:35:30,475][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:35:49,734][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:36:01,443][root][INFO] - Processing question number 90
[2025-03-06 14:36:01,449][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:36:18,065][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:36:33,142][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:36:46,620][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:37:01,632][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:37:18,066][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:37:33,066][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:37:46,137][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:38:02,881][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:38:21,178][root][INFO] - Inference complete
[2025-03-06 14:38:21,178][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,185][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,197][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,203][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,203][root][INFO] - Saved parsed outputs
[2025-03-06 14:38:21,203][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,205][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,205][root][INFO] - Saved parsing metadata
[2025-03-06 14:38:21,205][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,207][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:21,209][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:38:21,226][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 14:38:21,226][root][INFO] - Summary of metrics : {'label_accuracy': 0.5454545454545454, 'misclassification_rate': 0.4545454545454546, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 54, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.6923076923076923, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 24, 'correct_label_wrong_domain': 13, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 14:38:28,177][root][INFO] - Setting global seed to 989
[2025-03-06 14:38:28,182][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:38:28,182][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:38:28,183][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:38:28,214][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:38:28,217][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:38:28,217][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:38:28,375][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:38:28,923][root][INFO] - Full model selected, loading model
[2025-03-06 14:38:48,780][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:38:48,780][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:38:56,426][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:38:56,428][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:38:56,428][root][INFO] - Starting inference
[2025-03-06 14:38:56,633][root][INFO] - Processing question number 0
[2025-03-06 14:38:56,635][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:39:11,259][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:39:25,018][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:39:45,290][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:40:00,796][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:40:13,816][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:40:28,379][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:40:40,893][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:40:55,655][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:41:10,837][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:41:26,060][root][INFO] - Processing question number 10
[2025-03-06 14:41:26,062][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:41:40,536][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:41:52,936][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:42:05,188][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:42:20,224][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:42:34,926][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:42:49,658][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:43:06,024][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:43:17,471][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:43:30,502][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:43:42,753][root][INFO] - Processing question number 20
[2025-03-06 14:43:42,756][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:43:55,689][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:44:10,249][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:44:24,037][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:44:36,710][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:44:49,877][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:45:02,314][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:45:15,283][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:45:29,724][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:45:44,246][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:45:56,399][root][INFO] - Processing question number 30
[2025-03-06 14:45:56,401][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:46:10,418][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:46:23,076][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:46:38,609][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:46:55,035][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:47:08,020][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:47:21,044][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:47:32,880][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:47:47,197][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:48:00,822][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:48:14,953][root][INFO] - Processing question number 40
[2025-03-06 14:48:14,956][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:48:27,855][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:48:42,332][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:48:58,302][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:49:12,054][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:49:25,133][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:49:40,791][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:49:56,194][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:50:09,336][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:50:23,219][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:50:36,468][root][INFO] - Processing question number 50
[2025-03-06 14:50:36,472][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:50:50,233][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:51:07,271][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:51:18,724][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:51:30,996][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:51:48,161][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:52:01,832][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:52:17,510][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:52:30,802][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:52:45,140][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:52:59,256][root][INFO] - Processing question number 60
[2025-03-06 14:52:59,260][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:53:15,596][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:53:26,671][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:53:42,340][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:53:53,364][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:54:05,423][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:54:17,662][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:54:31,695][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:54:46,437][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:54:58,510][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:55:17,946][root][INFO] - Processing question number 70
[2025-03-06 14:55:17,951][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:55:29,804][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:55:43,184][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:55:58,046][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:56:12,685][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:56:28,440][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:56:40,331][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:56:55,883][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:57:11,296][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:57:27,861][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:57:44,797][root][INFO] - Processing question number 80
[2025-03-06 14:57:44,802][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:58:00,432][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:58:16,962][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:58:29,864][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:58:42,475][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:58:55,913][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:59:08,822][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:59:22,650][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:59:37,054][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:59:58,290][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:00:12,007][root][INFO] - Processing question number 90
[2025-03-06 15:00:12,013][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:00:27,720][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:00:45,770][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:01:03,912][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:01:16,003][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:01:32,478][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:01:46,608][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:02:03,250][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:02:19,472][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:02:33,803][root][INFO] - Inference complete
[2025-03-06 15:02:33,804][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,810][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,814][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:02:33,814][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:02:33,815][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:02:33,818][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:02:33,818][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:02:33,818][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:02:33,819][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:02:33,819][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:02:33,819][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:02:33,820][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:02:33,821][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:02:33,821][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:02:33,825][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,830][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,830][root][INFO] - Saved parsed outputs
[2025-03-06 15:02:33,831][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,832][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,832][root][INFO] - Saved parsing metadata
[2025-03-06 15:02:33,833][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,834][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:02:33,836][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:02:33,852][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 15:02:33,852][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 4, 'malformed_domain': 49, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.06060606060606061, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 22, 'correct_label_wrong_domain': 21, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 15:02:43,451][root][INFO] - Setting global seed to 206
[2025-03-06 15:02:43,459][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:02:43,460][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:02:43,461][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:02:43,463][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:02:43,465][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:02:43,465][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:02:43,642][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:02:44,230][root][INFO] - Full model selected, loading model
[2025-03-06 15:03:15,615][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:04:58,010][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:04:58,010][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:05:36,261][root][INFO] - Peft model loaded successfully
[2025-03-06 15:05:43,688][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:05:43,689][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:05:43,689][root][INFO] - Starting inference
[2025-03-06 15:05:43,802][root][INFO] - Processing question number 0
[2025-03-06 15:05:43,804][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:06:00,571][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:06:16,454][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:06:32,194][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:06:48,532][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:07:01,326][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:07:13,347][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:07:26,790][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:07:39,170][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:07:50,911][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:08:04,053][root][INFO] - Processing question number 10
[2025-03-06 15:08:04,055][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:08:15,735][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:08:28,311][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:08:41,528][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:08:54,952][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:09:12,602][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:09:25,212][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:09:41,162][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:09:55,996][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:10:11,107][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:10:27,458][root][INFO] - Processing question number 20
[2025-03-06 15:10:27,461][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:10:39,835][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:10:53,548][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:11:04,469][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:11:18,131][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:11:30,999][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:11:46,328][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:12:02,295][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:12:17,094][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:12:30,332][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:12:47,556][root][INFO] - Processing question number 30
[2025-03-06 15:12:47,559][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:13:01,516][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:13:14,687][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:13:28,887][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:13:42,345][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:13:55,648][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:14:12,228][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:14:27,590][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:14:43,540][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:14:55,759][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:15:11,302][root][INFO] - Processing question number 40
[2025-03-06 15:15:11,306][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:15:23,444][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:15:40,047][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:15:55,364][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:16:08,300][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:16:27,033][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:16:39,765][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:16:52,700][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:17:06,464][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:17:21,372][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:17:36,709][root][INFO] - Processing question number 50
[2025-03-06 15:17:36,713][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:17:51,226][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:18:06,686][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:18:23,226][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:18:40,543][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:18:55,738][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:19:14,440][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:19:30,151][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:19:45,805][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:20:00,733][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:20:14,048][root][INFO] - Processing question number 60
[2025-03-06 15:20:14,052][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:20:27,650][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:20:42,448][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:20:59,195][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:21:15,781][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:21:32,020][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:21:48,898][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:22:02,686][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:22:17,448][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:22:30,301][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:22:42,501][root][INFO] - Processing question number 70
[2025-03-06 15:22:42,506][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:22:57,602][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:23:13,085][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:23:27,254][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:23:45,364][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:23:57,703][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:24:13,655][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:24:31,479][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:24:45,998][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:25:01,770][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:25:17,275][root][INFO] - Processing question number 80
[2025-03-06 15:25:17,281][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:25:33,442][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:25:49,662][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:26:04,858][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:26:19,885][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:26:37,636][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:26:55,231][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:27:10,833][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:27:25,909][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:27:39,184][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:27:55,561][root][INFO] - Processing question number 90
[2025-03-06 15:27:55,566][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:28:10,303][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:28:26,146][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:28:39,010][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:28:52,664][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:29:09,641][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:29:26,053][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:29:47,704][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:30:00,169][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:30:12,070][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:30:26,289][root][INFO] - Inference complete
[2025-03-06 15:30:26,289][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,296][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,309][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,315][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,315][root][INFO] - Saved parsed outputs
[2025-03-06 15:30:26,315][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,330][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,330][root][INFO] - Saved parsing metadata
[2025-03-06 15:30:26,330][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,346][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:30:26,357][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:30:26,373][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 15:30:26,373][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.31, 'malformed_label': 0, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 25, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 15:30:36,548][root][INFO] - Setting global seed to 206
[2025-03-06 15:30:36,555][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:30:36,555][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:30:36,557][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:30:36,559][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:30:36,561][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:30:36,561][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:30:36,881][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:30:37,441][root][INFO] - Full model selected, loading model
[2025-03-06 15:30:55,184][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:30:55,184][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:31:02,821][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:31:02,822][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:31:02,822][root][INFO] - Starting inference
[2025-03-06 15:31:02,979][root][INFO] - Processing question number 0
[2025-03-06 15:31:02,981][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:31:20,137][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:31:32,351][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:31:49,061][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:32:02,560][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:32:14,944][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:32:26,812][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:32:42,308][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:32:55,136][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:33:06,525][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:33:18,444][root][INFO] - Processing question number 10
[2025-03-06 15:33:18,446][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:33:30,169][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:33:43,434][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:33:57,188][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:34:10,346][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:34:23,847][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:34:38,316][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:34:49,448][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:35:02,599][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:35:15,870][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:35:32,095][root][INFO] - Processing question number 20
[2025-03-06 15:35:32,097][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:35:44,328][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:35:59,812][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:36:13,808][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:36:25,905][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:36:40,428][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:36:51,674][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:37:06,160][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:37:17,964][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:37:31,494][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:37:47,514][root][INFO] - Processing question number 30
[2025-03-06 15:37:47,517][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:37:59,185][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:38:13,378][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:38:29,222][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:38:44,116][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:38:56,238][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:39:09,507][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:39:24,105][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:39:38,430][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:39:50,834][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:40:04,889][root][INFO] - Processing question number 40
[2025-03-06 15:40:04,892][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:40:18,370][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:40:32,227][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:40:46,176][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:40:58,469][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:41:14,634][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:41:30,577][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:41:43,200][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:41:53,808][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:42:07,541][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:42:20,433][root][INFO] - Processing question number 50
[2025-03-06 15:42:20,437][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:42:34,379][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:42:47,163][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:43:03,100][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:43:17,730][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:43:30,933][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:43:47,116][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:43:59,587][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:44:16,037][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:44:27,948][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:44:42,971][root][INFO] - Processing question number 60
[2025-03-06 15:44:42,975][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:44:56,757][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:45:11,988][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:45:26,751][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:45:43,772][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:45:57,037][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:46:11,049][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:46:23,626][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:46:37,227][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:46:48,657][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:47:03,551][root][INFO] - Processing question number 70
[2025-03-06 15:47:03,555][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:47:18,185][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:47:33,896][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:47:48,508][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:48:04,498][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:48:16,610][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:48:30,390][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:48:44,976][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:49:01,193][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:49:11,867][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:49:24,658][root][INFO] - Processing question number 80
[2025-03-06 15:49:24,662][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:49:37,042][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:49:50,681][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:50:08,091][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:50:21,420][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:50:37,330][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:50:54,811][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:51:08,398][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:51:24,453][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:51:36,439][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:51:51,223][root][INFO] - Processing question number 90
[2025-03-06 15:51:51,228][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:52:03,609][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:52:18,099][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:52:28,562][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:52:41,437][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:52:56,332][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:53:11,177][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:53:26,303][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:53:41,469][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:53:53,161][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:54:06,232][root][INFO] - Inference complete
[2025-03-06 15:54:06,233][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,239][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,251][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,267][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,267][root][INFO] - Saved parsed outputs
[2025-03-06 15:54:06,267][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,268][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,268][root][INFO] - Saved parsing metadata
[2025-03-06 15:54:06,269][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,270][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:54:06,272][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:54:06,283][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 15:54:06,284][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 18, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 15:54:13,113][root][INFO] - Setting global seed to 206
[2025-03-06 15:54:13,120][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:54:13,121][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:54:13,122][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:54:13,123][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:54:13,126][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:54:13,126][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:54:13,271][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:54:13,813][root][INFO] - Full model selected, loading model
[2025-03-06 15:54:38,691][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:56:22,335][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:56:22,336][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:57:00,505][root][INFO] - Peft model loaded successfully
[2025-03-06 15:57:08,484][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:57:08,485][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 15:57:08,486][root][INFO] - Starting inference
[2025-03-06 15:57:08,735][root][INFO] - Processing question number 0
[2025-03-06 15:57:08,742][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:57:24,510][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:57:40,664][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:57:56,225][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:58:12,043][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:58:24,308][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:58:36,068][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:58:49,757][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:59:02,278][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:59:15,008][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:59:29,437][root][INFO] - Processing question number 10
[2025-03-06 15:59:29,439][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:59:43,719][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:59:57,663][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:00:11,069][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:00:25,657][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:00:40,550][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:00:53,915][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:01:09,736][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:01:22,530][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:01:37,230][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:01:52,723][root][INFO] - Processing question number 20
[2025-03-06 16:01:52,725][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:02:06,107][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:02:20,852][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:02:32,128][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:02:46,106][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:02:59,735][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:03:14,004][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:03:29,933][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:03:42,884][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:03:56,512][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:04:13,600][root][INFO] - Processing question number 30
[2025-03-06 16:04:13,603][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:04:27,964][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:04:40,717][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:04:55,065][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:05:11,441][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:05:26,467][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:05:42,967][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:05:58,079][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:06:14,338][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:06:28,465][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:06:43,657][root][INFO] - Processing question number 40
[2025-03-06 16:06:43,660][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:06:55,875][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:07:11,785][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:07:29,232][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:07:42,152][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:07:58,506][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:08:10,438][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:08:23,596][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:08:36,108][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:08:51,370][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:09:05,470][root][INFO] - Processing question number 50
[2025-03-06 16:09:05,478][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:09:19,627][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:09:36,274][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:09:52,614][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:10:08,471][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:10:22,572][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:10:39,147][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:10:53,961][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:11:10,076][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:11:25,197][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:11:41,369][root][INFO] - Processing question number 60
[2025-03-06 16:11:41,373][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:11:56,740][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:12:11,167][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:12:27,968][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:12:43,936][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:12:58,678][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:13:15,413][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:13:29,849][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:13:42,841][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:13:58,720][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:14:10,439][root][INFO] - Processing question number 70
[2025-03-06 16:14:10,444][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:14:25,322][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:14:39,823][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:14:54,597][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:15:13,127][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:15:25,415][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:15:41,461][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:16:00,059][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:16:16,395][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:16:30,011][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:16:44,278][root][INFO] - Processing question number 80
[2025-03-06 16:16:44,285][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:17:02,125][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:17:18,204][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:17:34,450][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:17:49,424][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:18:05,663][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:18:22,166][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:18:36,876][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:18:52,478][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:19:06,343][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:19:21,039][root][INFO] - Processing question number 90
[2025-03-06 16:19:21,044][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:19:35,561][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:19:49,530][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:20:03,750][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:20:18,054][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:20:35,038][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:20:50,509][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:21:07,569][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:21:20,454][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:21:33,578][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:21:48,551][root][INFO] - Inference complete
[2025-03-06 16:21:48,551][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,563][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,575][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,582][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,582][root][INFO] - Saved parsed outputs
[2025-03-06 16:21:48,582][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,584][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,584][root][INFO] - Saved parsing metadata
[2025-03-06 16:21:48,586][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,587][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:21:48,589][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:21:48,629][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 16:21:48,629][root][INFO] - Summary of metrics : {'label_accuracy': 0.59, 'misclassification_rate': 0.41000000000000003, 'combined_accuracy': 0.32, 'malformed_label': 0, 'malformed_domain': 41, 'total_predictions': 100, 'correct_predictions': 59, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.02, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 27, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 16:21:55,887][root][INFO] - Setting global seed to 206
[2025-03-06 16:21:55,894][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:21:55,894][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:21:55,895][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:21:55,897][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:21:55,899][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:21:55,899][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:21:56,052][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:21:56,587][root][INFO] - Full model selected, loading model
[2025-03-06 16:22:16,346][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:22:16,346][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:22:24,298][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:22:24,301][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:22:24,301][root][INFO] - Starting inference
[2025-03-06 16:22:24,463][root][INFO] - Processing question number 0
[2025-03-06 16:22:24,465][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:22:38,137][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:22:54,399][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:23:26,959][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:23:42,367][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:23:56,266][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:24:08,134][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:24:21,786][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:24:35,049][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:24:47,347][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:24:59,561][root][INFO] - Processing question number 10
[2025-03-06 16:24:59,563][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:25:12,045][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:25:26,391][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:25:41,469][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:25:54,922][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:26:08,766][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:26:21,854][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:26:33,261][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:26:46,867][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:27:00,700][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:27:16,429][root][INFO] - Processing question number 20
[2025-03-06 16:27:16,431][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:27:27,533][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:27:42,462][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:27:55,079][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:28:08,833][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:28:20,149][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:28:33,208][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:28:48,614][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:29:00,849][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:29:15,799][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:29:30,385][root][INFO] - Processing question number 30
[2025-03-06 16:29:30,388][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:29:42,735][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:29:56,293][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:30:10,227][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:30:25,462][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:30:39,662][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:30:54,164][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:31:07,371][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:31:23,161][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:31:34,018][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:31:49,818][root][INFO] - Processing question number 40
[2025-03-06 16:31:49,821][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:32:04,895][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:32:16,867][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:32:32,076][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:32:44,839][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:33:04,338][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:33:16,980][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:33:30,647][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:33:41,114][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:33:55,129][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:34:10,254][root][INFO] - Processing question number 50
[2025-03-06 16:34:10,258][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:34:25,172][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:34:40,885][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:34:57,881][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:35:13,482][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:35:26,167][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:35:39,917][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:35:52,523][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:36:09,463][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:36:21,656][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:36:34,892][root][INFO] - Processing question number 60
[2025-03-06 16:36:34,897][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:36:48,262][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:37:04,438][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:37:20,607][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:37:34,824][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:37:50,396][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:38:05,544][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:38:17,804][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:38:32,161][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:38:42,603][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:38:56,036][root][INFO] - Processing question number 70
[2025-03-06 16:38:56,040][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:39:08,096][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:39:24,088][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:39:40,422][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:39:55,597][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:40:08,141][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:40:23,005][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:40:38,689][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:40:58,387][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:41:11,091][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:41:25,310][root][INFO] - Processing question number 80
[2025-03-06 16:41:25,315][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:41:40,044][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:41:54,454][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:42:10,441][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:42:23,207][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:42:37,822][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:42:56,233][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:43:11,419][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:43:26,757][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:43:38,596][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:43:52,835][root][INFO] - Processing question number 90
[2025-03-06 16:43:52,840][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:44:07,824][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:44:24,523][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:44:36,225][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:44:49,711][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:45:04,973][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:45:19,312][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:45:43,945][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:45:55,772][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:46:06,792][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:46:22,022][root][INFO] - Inference complete
[2025-03-06 16:46:22,023][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,030][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,031][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:46:22,032][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:46:22,033][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:46:22,040][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:46:22,040][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:46:22,041][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:46:22,045][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,051][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,051][root][INFO] - Saved parsed outputs
[2025-03-06 16:46:22,051][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,052][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,052][root][INFO] - Saved parsing metadata
[2025-03-06 16:46:22,053][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,054][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:46:22,056][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:46:22,084][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 16:46:22,084][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.34, 'malformed_label': 2, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 24, 'correct_label_wrong_domain': 18, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 16:46:30,671][root][INFO] - Setting global seed to 206
[2025-03-06 16:46:30,679][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:46:30,679][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:46:30,681][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:46:30,682][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:46:30,687][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:46:30,687][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:46:31,633][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:46:32,225][root][INFO] - Full model selected, loading model
[2025-03-06 16:46:56,592][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:48:42,834][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:48:42,834][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:49:20,346][root][INFO] - Peft model loaded successfully
[2025-03-06 16:49:27,828][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:49:27,831][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 16:49:27,831][root][INFO] - Starting inference
[2025-03-06 16:49:28,021][root][INFO] - Processing question number 0
[2025-03-06 16:49:28,023][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:49:41,671][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:49:57,147][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:50:12,373][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:50:30,138][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:50:45,570][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:50:58,480][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:51:12,720][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:51:29,351][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:51:40,764][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:51:55,535][root][INFO] - Processing question number 10
[2025-03-06 16:51:55,537][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:52:06,743][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:52:21,133][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:52:35,608][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:52:47,006][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:53:01,943][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:53:14,785][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:53:29,313][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:53:42,714][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:53:56,595][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:54:15,825][root][INFO] - Processing question number 20
[2025-03-06 16:54:15,827][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:54:29,202][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:54:45,124][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:54:56,744][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:55:09,944][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:55:24,474][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:55:39,397][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:55:55,380][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:56:09,420][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:56:23,150][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:56:39,831][root][INFO] - Processing question number 30
[2025-03-06 16:56:39,834][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:56:55,171][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:57:07,416][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:57:23,359][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:57:40,110][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:57:53,911][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:58:11,862][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:58:27,185][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:58:42,574][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:58:58,932][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:59:14,277][root][INFO] - Processing question number 40
[2025-03-06 16:59:14,280][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:59:28,653][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:59:40,991][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:59:56,685][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:00:07,710][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:00:28,062][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:00:40,051][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:00:51,900][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:01:06,583][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:01:20,572][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:01:36,337][root][INFO] - Processing question number 50
[2025-03-06 17:01:36,341][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:01:51,892][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:02:06,393][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:02:21,680][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:02:40,467][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:02:54,885][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:03:10,292][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:03:24,399][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:03:40,171][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:03:57,963][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:04:12,119][root][INFO] - Processing question number 60
[2025-03-06 17:04:12,123][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:04:28,339][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:04:44,687][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:05:00,719][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:05:17,076][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:05:31,074][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:05:45,974][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:06:03,140][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:06:18,536][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:06:35,992][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:06:48,595][root][INFO] - Processing question number 70
[2025-03-06 17:06:48,600][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:07:05,314][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:07:19,243][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:07:33,899][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:07:50,911][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:08:04,032][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:08:20,051][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:08:37,591][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:08:57,221][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:09:10,975][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:09:27,334][root][INFO] - Processing question number 80
[2025-03-06 17:09:27,339][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:09:48,635][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:10:06,460][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:10:21,825][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:10:35,225][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:10:54,196][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:11:12,948][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:11:27,632][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:11:46,085][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:12:00,383][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:12:17,391][root][INFO] - Processing question number 90
[2025-03-06 17:12:17,397][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:12:32,042][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:12:47,546][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:13:01,882][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:13:15,578][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:13:33,213][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:13:49,226][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:14:06,094][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:14:21,502][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:14:33,373][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:14:47,799][root][INFO] - Inference complete
[2025-03-06 17:14:47,799][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,806][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,815][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:14:47,816][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:14:47,817][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:14:47,821][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,828][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,828][root][INFO] - Saved parsed outputs
[2025-03-06 17:14:47,828][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,829][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,829][root][INFO] - Saved parsing metadata
[2025-03-06 17:14:47,830][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,832][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:14:47,833][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:14:47,895][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 17:14:47,895][root][INFO] - Summary of metrics : {'label_accuracy': 0.63, 'misclassification_rate': 0.37, 'combined_accuracy': 0.33, 'malformed_label': 1, 'malformed_domain': 45, 'total_predictions': 100, 'correct_predictions': 63, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.6428571428571429, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 22, 'correct_label_wrong_domain': 30, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 17:14:55,825][root][INFO] - Setting global seed to 206
[2025-03-06 17:14:55,832][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:14:55,832][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:14:55,834][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:14:55,835][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:14:55,839][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:14:55,839][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:14:56,223][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:14:56,817][root][INFO] - Full model selected, loading model
[2025-03-06 17:15:23,691][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:15:23,715][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:15:32,084][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:15:32,086][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:15:32,086][root][INFO] - Starting inference
[2025-03-06 17:15:32,266][root][INFO] - Processing question number 0
[2025-03-06 17:15:32,268][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:15:46,157][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:16:01,533][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:16:16,926][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:16:30,484][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:16:43,514][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:16:56,177][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:17:11,811][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:17:25,618][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:17:39,912][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:17:52,901][root][INFO] - Processing question number 10
[2025-03-06 17:17:52,903][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:18:05,215][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:18:17,770][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:18:30,967][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:18:42,473][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:18:59,841][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:19:11,263][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:19:23,234][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:19:40,598][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:19:54,173][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:20:09,400][root][INFO] - Processing question number 20
[2025-03-06 17:20:09,402][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:20:21,426][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:20:34,620][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:20:48,117][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:21:02,247][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:21:21,312][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:21:33,254][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:21:48,679][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:22:01,084][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:22:14,157][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:22:28,703][root][INFO] - Processing question number 30
[2025-03-06 17:22:28,706][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:22:40,298][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:22:52,792][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:23:05,560][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:23:18,541][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:23:31,320][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:23:46,072][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:24:01,651][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:24:16,158][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:24:31,177][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:24:44,775][root][INFO] - Processing question number 40
[2025-03-06 17:24:44,778][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:25:00,379][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:25:11,650][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:25:26,772][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:25:38,896][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:25:57,572][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:26:09,508][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:26:22,011][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:26:35,713][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:26:49,444][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:27:02,526][root][INFO] - Processing question number 50
[2025-03-06 17:27:02,530][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:27:15,961][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:27:31,183][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:27:46,153][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:28:00,082][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:28:13,452][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:28:27,700][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:28:43,991][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:29:00,239][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:29:14,198][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:29:28,131][root][INFO] - Processing question number 60
[2025-03-06 17:29:28,135][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:29:41,276][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:29:55,194][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:30:13,544][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:30:32,027][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:30:48,119][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:31:06,991][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:31:19,646][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:31:34,748][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:31:47,149][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:32:01,425][root][INFO] - Processing question number 70
[2025-03-06 17:32:01,430][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:32:17,527][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:32:31,541][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:32:48,948][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:33:05,308][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:33:17,539][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:33:32,955][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:33:50,516][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:34:06,327][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:34:20,278][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:34:34,023][root][INFO] - Processing question number 80
[2025-03-06 17:34:34,028][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:34:49,209][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:35:03,557][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:35:18,798][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:35:31,603][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:35:46,360][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:36:02,285][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:36:17,140][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:36:33,620][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:36:49,602][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:37:03,717][root][INFO] - Processing question number 90
[2025-03-06 17:37:03,723][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:37:17,093][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:37:32,669][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:37:45,023][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:37:57,721][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:38:13,544][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:38:28,436][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:38:45,317][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:38:59,466][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:39:16,643][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:39:32,109][root][INFO] - Inference complete
[2025-03-06 17:39:32,110][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,116][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,117][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,117][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:39:32,118][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,119][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,119][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:39:32,119][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,125][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,125][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:39:32,125][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,126][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,126][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:39:32,127][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,129][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,129][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:39:32,129][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,130][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:39:32,131][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:39:32,131][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:39:32,132][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,138][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,138][root][INFO] - Saved parsed outputs
[2025-03-06 17:39:32,139][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,140][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,140][root][INFO] - Saved parsing metadata
[2025-03-06 17:39:32,141][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,142][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:39:32,143][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:39:32,178][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 17:39:32,178][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.29, 'malformed_label': 6, 'malformed_domain': 51, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.08, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 20, 'correct_label_wrong_domain': 28, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 17:39:42,538][root][INFO] - Setting global seed to 989
[2025-03-06 17:39:42,546][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:39:42,546][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:39:42,548][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:39:42,549][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:39:42,552][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:39:42,552][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:39:42,703][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:39:43,254][root][INFO] - Full model selected, loading model
[2025-03-06 17:40:05,390][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:41:47,557][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:41:47,574][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:42:25,091][root][INFO] - Peft model loaded successfully
[2025-03-06 17:42:32,572][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:42:32,574][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 17:42:32,574][root][INFO] - Starting inference
[2025-03-06 17:42:32,758][root][INFO] - Processing question number 0
[2025-03-06 17:42:32,760][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:42:49,458][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:43:05,338][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:43:21,064][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:43:37,398][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:43:50,195][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:44:02,259][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:44:15,722][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:44:28,100][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:44:39,831][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:44:52,967][root][INFO] - Processing question number 10
[2025-03-06 17:44:52,969][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:45:04,642][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:45:17,212][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:45:30,413][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:45:43,828][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:46:01,469][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:46:14,071][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:46:30,011][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:46:44,838][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:46:59,939][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:47:16,277][root][INFO] - Processing question number 20
[2025-03-06 17:47:16,279][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:47:28,610][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:47:42,214][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:47:53,055][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:48:06,665][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:48:19,520][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:48:34,837][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:48:50,799][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:49:05,595][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:49:18,827][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:49:36,043][root][INFO] - Processing question number 30
[2025-03-06 17:49:36,045][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:49:49,989][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:50:03,153][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:50:17,341][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:50:30,791][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:50:44,088][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:51:00,663][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:51:16,009][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:51:31,950][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:51:44,163][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:51:59,700][root][INFO] - Processing question number 40
[2025-03-06 17:51:59,703][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:52:11,838][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:52:28,434][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:52:43,740][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:52:56,669][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:53:15,381][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:53:28,098][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:53:41,018][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:53:54,777][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:54:09,675][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:54:25,009][root][INFO] - Processing question number 50
[2025-03-06 17:54:25,013][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:54:39,523][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:54:54,978][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:55:11,486][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:55:28,665][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:55:43,720][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:56:02,410][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:56:18,106][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:56:33,759][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:56:48,688][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:57:02,009][root][INFO] - Processing question number 60
[2025-03-06 17:57:02,014][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:57:15,602][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:57:30,399][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:57:47,142][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:58:03,731][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:58:19,968][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:58:36,848][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:58:50,631][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:59:05,400][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:59:18,238][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:59:30,392][root][INFO] - Processing question number 70
[2025-03-06 17:59:30,397][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:59:45,385][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:00:00,761][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:00:14,829][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:00:32,869][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:00:45,148][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:01:00,993][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:01:18,723][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:01:33,212][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:01:48,892][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:02:04,292][root][INFO] - Processing question number 80
[2025-03-06 18:02:04,297][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:02:20,423][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:02:36,658][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:02:51,867][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:03:06,904][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:03:24,664][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:03:42,279][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:03:57,892][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:04:12,980][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:04:26,259][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:04:42,645][root][INFO] - Processing question number 90
[2025-03-06 18:04:42,650][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:04:57,419][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:05:13,272][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:05:26,140][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:05:39,801][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:05:56,785][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:06:13,200][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:06:34,857][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:06:47,326][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:06:59,229][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:07:13,454][root][INFO] - Inference complete
[2025-03-06 18:07:13,454][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,460][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,473][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,480][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,480][root][INFO] - Saved parsed outputs
[2025-03-06 18:07:13,480][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,481][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,481][root][INFO] - Saved parsing metadata
[2025-03-06 18:07:13,482][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,483][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:13,485][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:07:13,499][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 18:07:13,500][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.31, 'malformed_label': 0, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 25, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 18:07:22,313][root][INFO] - Setting global seed to 989
[2025-03-06 18:07:22,320][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:07:22,320][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:07:22,322][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:07:22,323][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:07:22,328][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:07:22,328][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:07:22,496][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:07:23,060][root][INFO] - Full model selected, loading model
[2025-03-06 18:07:48,246][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:07:48,257][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:07:56,614][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:07:56,616][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:07:56,616][root][INFO] - Starting inference
[2025-03-06 18:07:56,798][root][INFO] - Processing question number 0
[2025-03-06 18:07:56,800][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:08:14,004][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:08:26,230][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:08:42,950][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:08:56,466][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:09:08,862][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:09:20,742][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:09:36,251][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:09:49,087][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:10:00,479][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:10:12,410][root][INFO] - Processing question number 10
[2025-03-06 18:10:12,412][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:10:24,143][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:10:37,422][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:10:51,184][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:11:04,355][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:11:17,857][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:11:32,344][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:11:43,483][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:11:56,645][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:12:09,918][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:12:26,156][root][INFO] - Processing question number 20
[2025-03-06 18:12:26,159][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:12:38,396][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:12:53,893][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:13:08,009][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:13:20,120][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:13:34,652][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:13:45,907][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:14:00,403][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:14:12,217][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:14:25,758][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:14:41,797][root][INFO] - Processing question number 30
[2025-03-06 18:14:41,800][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:14:53,471][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:15:07,663][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:15:23,442][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:15:38,273][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:15:50,309][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:16:03,493][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:16:18,041][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:16:32,293][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:16:44,612][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:16:58,581][root][INFO] - Processing question number 40
[2025-03-06 18:16:58,584][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:17:12,058][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:17:25,883][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:17:39,720][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:17:51,963][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:18:08,054][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:18:23,925][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:18:36,553][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:18:47,123][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:19:00,759][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:19:13,598][root][INFO] - Processing question number 50
[2025-03-06 18:19:13,602][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:19:27,555][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:19:40,357][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:19:56,309][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:20:10,944][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:20:24,163][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:20:40,373][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:20:52,853][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:21:09,332][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:21:21,256][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:21:36,299][root][INFO] - Processing question number 60
[2025-03-06 18:21:36,303][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:21:50,096][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:22:05,353][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:22:20,129][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:22:37,181][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:22:50,476][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:23:04,522][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:23:17,128][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:23:30,757][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:23:42,209][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:23:57,139][root][INFO] - Processing question number 70
[2025-03-06 18:23:57,144][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:24:11,790][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:24:27,539][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:24:42,179][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:24:58,192][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:25:10,360][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:25:24,164][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:25:38,761][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:25:54,997][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:26:05,683][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:26:18,497][root][INFO] - Processing question number 80
[2025-03-06 18:26:18,502][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:26:30,890][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:26:44,547][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:27:01,973][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:27:15,322][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:27:31,247][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:27:48,761][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:28:02,358][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:28:18,429][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:28:30,403][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:28:45,205][root][INFO] - Processing question number 90
[2025-03-06 18:28:45,211][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:28:57,602][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:29:12,117][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:29:22,588][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:29:35,480][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:29:50,389][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:30:05,257][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:30:20,405][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:30:35,606][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:30:47,306][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:31:00,389][root][INFO] - Inference complete
[2025-03-06 18:31:00,389][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,396][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,408][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,416][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,416][root][INFO] - Saved parsed outputs
[2025-03-06 18:31:00,416][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,418][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,418][root][INFO] - Saved parsing metadata
[2025-03-06 18:31:00,419][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,421][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:31:00,422][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:31:00,450][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 18:31:00,450][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 18, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 18:31:07,676][root][INFO] - Setting global seed to 989
[2025-03-06 18:31:07,682][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:31:07,683][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:31:07,684][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:31:07,685][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:31:07,690][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:31:07,690][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:31:07,844][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:31:08,504][root][INFO] - Full model selected, loading model
[2025-03-06 18:31:47,213][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:33:30,562][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:33:30,562][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:34:06,410][root][INFO] - Peft model loaded successfully
[2025-03-06 18:34:14,375][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:34:14,378][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:34:14,378][root][INFO] - Starting inference
[2025-03-06 18:34:14,516][root][INFO] - Processing question number 0
[2025-03-06 18:34:14,519][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:34:27,870][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:34:42,579][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:34:59,644][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:35:15,795][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:35:28,690][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:35:40,817][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:35:54,664][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:36:08,176][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:36:20,064][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:36:35,061][root][INFO] - Processing question number 10
[2025-03-06 18:36:35,062][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:36:47,295][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:36:59,867][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:37:12,680][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:37:24,603][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:37:41,870][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:37:54,585][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:38:09,853][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:38:25,995][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:38:41,390][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:38:56,995][root][INFO] - Processing question number 20
[2025-03-06 18:38:56,998][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:39:09,436][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:39:23,167][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:39:34,456][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:39:47,070][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:40:01,103][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:40:17,597][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:40:32,523][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:40:47,614][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:40:59,891][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:41:18,832][root][INFO] - Processing question number 30
[2025-03-06 18:41:18,835][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:41:31,472][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:41:45,526][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:42:01,133][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:42:14,498][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:42:27,245][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:42:44,334][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:42:59,931][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:43:14,299][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:43:27,433][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:43:43,160][root][INFO] - Processing question number 40
[2025-03-06 18:43:43,164][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:43:55,261][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:44:09,861][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:44:25,102][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:44:36,450][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:44:52,938][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:45:04,440][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:45:16,872][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:45:29,469][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:45:43,985][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:45:58,840][root][INFO] - Processing question number 50
[2025-03-06 18:45:58,843][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:46:12,449][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:46:26,159][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:46:44,116][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:47:00,522][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:47:15,466][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:47:31,661][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:47:47,448][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:48:04,887][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:48:20,146][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:48:34,908][root][INFO] - Processing question number 60
[2025-03-06 18:48:34,912][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:48:49,139][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:49:05,763][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:49:22,647][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:49:38,190][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:49:51,632][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:50:06,961][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:50:20,211][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:50:32,582][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:50:45,941][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:50:57,596][root][INFO] - Processing question number 70
[2025-03-06 18:50:57,600][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:51:13,701][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:51:29,830][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:51:45,982][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:52:03,180][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:52:16,167][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:52:31,013][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:52:48,047][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:53:03,024][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:53:16,108][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:53:29,393][root][INFO] - Processing question number 80
[2025-03-06 18:53:29,398][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:53:45,505][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:54:02,657][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:54:17,261][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:54:31,136][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:54:46,937][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:55:02,541][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:55:18,274][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:55:34,584][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:55:49,874][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:56:05,316][root][INFO] - Processing question number 90
[2025-03-06 18:56:05,322][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:56:19,363][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:56:35,953][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:56:50,121][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:57:04,458][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:57:22,255][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:57:38,690][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:57:54,959][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:58:07,173][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:58:20,278][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:58:35,598][root][INFO] - Inference complete
[2025-03-06 18:58:35,598][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,606][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,618][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,625][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,625][root][INFO] - Saved parsed outputs
[2025-03-06 18:58:35,625][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,626][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,626][root][INFO] - Saved parsing metadata
[2025-03-06 18:58:35,627][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,629][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:58:35,630][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:58:35,669][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 18:58:35,669][root][INFO] - Summary of metrics : {'label_accuracy': 0.62, 'misclassification_rate': 0.38, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 41, 'total_predictions': 100, 'correct_predictions': 62, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 25, 'correct_label_wrong_domain': 28, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 18:58:43,301][root][INFO] - Setting global seed to 989
[2025-03-06 18:58:43,307][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:58:43,307][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:58:43,308][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:58:43,310][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:58:43,315][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:58:43,315][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:58:43,478][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 18:58:44,169][root][INFO] - Full model selected, loading model
[2025-03-06 18:59:12,305][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:59:12,320][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:59:20,750][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:59:20,751][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 18:59:20,751][root][INFO] - Starting inference
[2025-03-06 18:59:20,903][root][INFO] - Processing question number 0
[2025-03-06 18:59:20,906][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:59:37,029][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:59:52,003][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:00:05,060][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:00:19,724][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:00:33,852][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:00:45,937][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:00:59,743][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:01:12,594][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:01:23,885][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:01:37,259][root][INFO] - Processing question number 10
[2025-03-06 19:01:37,261][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:01:48,792][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:02:00,157][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:02:14,502][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:02:26,984][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:02:40,658][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:02:54,554][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:03:05,084][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:03:19,378][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:03:38,360][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:03:53,658][root][INFO] - Processing question number 20
[2025-03-06 19:03:53,660][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:04:05,051][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:04:18,781][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:04:32,806][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:04:44,466][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:05:01,177][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:05:13,653][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:05:27,763][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:05:41,677][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:05:55,178][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:06:11,458][root][INFO] - Processing question number 30
[2025-03-06 19:06:11,461][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:06:22,675][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:06:36,884][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:06:50,238][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:07:04,115][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:07:17,888][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:07:30,154][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:07:45,600][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:08:02,938][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:08:16,951][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:08:32,786][root][INFO] - Processing question number 40
[2025-03-06 19:08:32,789][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:08:45,958][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:08:59,237][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:09:16,660][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:09:30,720][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:09:46,588][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:10:03,009][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:10:15,134][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:10:32,309][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:10:47,243][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:10:59,373][root][INFO] - Processing question number 50
[2025-03-06 19:10:59,377][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:11:14,588][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:11:27,445][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:11:42,336][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:11:55,811][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:12:08,737][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:12:23,704][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:12:37,319][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:12:54,293][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:13:06,057][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:13:17,388][root][INFO] - Processing question number 60
[2025-03-06 19:13:17,392][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:13:33,413][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:13:51,484][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:14:07,595][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:14:23,296][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:14:38,336][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:14:52,335][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:15:05,038][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:15:18,072][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:15:28,306][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:15:41,880][root][INFO] - Processing question number 70
[2025-03-06 19:15:41,884][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:15:55,007][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:16:10,008][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:16:25,851][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:16:42,265][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:16:55,049][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:17:11,967][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:17:28,472][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:17:47,834][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:17:59,464][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:18:12,337][root][INFO] - Processing question number 80
[2025-03-06 19:18:12,342][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:18:24,792][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:18:40,075][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:18:56,666][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:19:10,034][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:19:27,096][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:19:42,914][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:19:57,715][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:20:12,821][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:20:29,322][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:20:43,591][root][INFO] - Processing question number 90
[2025-03-06 19:20:43,597][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:20:57,277][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:21:14,010][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:21:29,298][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:21:41,333][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:21:56,369][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:22:11,472][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:22:25,930][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:22:38,049][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:22:50,709][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:23:05,767][root][INFO] - Inference complete
[2025-03-06 19:23:05,768][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,777][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,780][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:23:05,780][root][WARNING] - |Q. 8||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:23:05,780][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:23:05,790][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,796][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,796][root][INFO] - Saved parsed outputs
[2025-03-06 19:23:05,797][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,798][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,798][root][INFO] - Saved parsing metadata
[2025-03-06 19:23:05,799][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,800][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:23:05,801][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:23:05,822][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 19:23:05,822][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.36, 'malformed_label': 1, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 16, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 19:23:15,946][root][INFO] - Setting global seed to 989
[2025-03-06 19:23:15,954][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 19:23:15,954][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:23:15,955][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:23:15,957][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:23:15,960][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:23:15,960][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:23:16,166][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 19:23:16,769][root][INFO] - Full model selected, loading model
[2025-03-06 19:23:43,541][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:25:26,604][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:25:26,605][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:26:02,844][root][INFO] - Peft model loaded successfully
[2025-03-06 19:26:10,324][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:26:10,325][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:26:10,325][root][INFO] - Starting inference
[2025-03-06 19:26:10,498][root][INFO] - Processing question number 0
[2025-03-06 19:26:10,500][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:26:25,713][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:26:40,029][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:26:57,906][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:27:13,202][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:27:25,565][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:27:39,169][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:27:53,398][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:28:08,364][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:28:19,115][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:28:32,696][root][INFO] - Processing question number 10
[2025-03-06 19:28:32,698][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:28:45,945][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:28:59,303][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:29:13,409][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:29:27,718][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:29:41,974][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:29:54,417][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:30:07,979][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:30:21,391][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:30:35,632][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:30:51,471][root][INFO] - Processing question number 20
[2025-03-06 19:30:51,474][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:31:03,341][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:31:16,791][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:31:30,379][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:31:43,262][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:31:57,113][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:32:12,171][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:32:25,471][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:32:41,032][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:32:54,951][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:33:10,614][root][INFO] - Processing question number 30
[2025-03-06 19:33:10,617][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:33:23,572][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:33:37,277][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:33:50,700][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:34:08,633][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:34:22,569][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:34:37,044][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:34:52,294][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:35:06,264][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:35:19,157][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:35:34,534][root][INFO] - Processing question number 40
[2025-03-06 19:35:34,537][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:35:48,889][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:36:02,790][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:36:16,550][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:36:29,007][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:36:45,874][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:36:59,073][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:37:11,508][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:37:23,044][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:37:36,446][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:37:50,689][root][INFO] - Processing question number 50
[2025-03-06 19:37:50,693][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:38:05,187][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:38:22,271][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:38:40,295][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:38:55,530][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:39:08,967][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:39:26,146][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:39:41,372][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:39:58,253][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:40:15,807][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:40:32,177][root][INFO] - Processing question number 60
[2025-03-06 19:40:32,181][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:40:45,952][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:41:03,363][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:41:18,695][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:41:34,456][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:41:49,713][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:42:06,970][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:42:21,913][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:42:35,301][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:42:48,619][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:43:01,790][root][INFO] - Processing question number 70
[2025-03-06 19:43:01,794][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:43:18,627][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:43:32,655][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:43:46,647][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:44:04,011][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:44:16,750][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:44:32,843][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:44:50,518][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:45:05,040][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:45:18,898][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:45:32,907][root][INFO] - Processing question number 80
[2025-03-06 19:45:32,911][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:45:49,863][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:46:04,529][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:46:19,510][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:46:34,836][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:46:54,769][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:47:10,951][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:47:28,521][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:47:43,796][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:47:59,303][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:48:14,450][root][INFO] - Processing question number 90
[2025-03-06 19:48:14,456][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:48:29,536][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:48:46,054][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:48:59,033][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:49:13,538][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:49:27,788][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:49:44,855][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:50:09,582][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:50:23,683][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:50:36,934][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:50:52,697][root][INFO] - Inference complete
[2025-03-06 19:50:52,697][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,705][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,717][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,723][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,723][root][INFO] - Saved parsed outputs
[2025-03-06 19:50:52,723][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,725][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,725][root][INFO] - Saved parsing metadata
[2025-03-06 19:50:52,726][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,728][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:50:52,729][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:50:52,788][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 19:50:52,788][root][INFO] - Summary of metrics : {'label_accuracy': 0.59, 'misclassification_rate': 0.41000000000000003, 'combined_accuracy': 0.31, 'malformed_label': 0, 'malformed_domain': 45, 'total_predictions': 100, 'correct_predictions': 59, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.02, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 24, 'correct_label_wrong_domain': 28, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-03-06 19:51:03,550][root][INFO] - Setting global seed to 989
[2025-03-06 19:51:03,575][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 19:51:03,575][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:51:03,577][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:51:03,579][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:51:03,595][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:51:03,595][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:51:03,741][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 19:51:04,346][root][INFO] - Full model selected, loading model
[2025-03-06 19:51:32,432][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 19:51:32,444][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 19:51:40,726][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:51:40,727][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 19:51:40,727][root][INFO] - Starting inference
[2025-03-06 19:51:40,847][root][INFO] - Processing question number 0
[2025-03-06 19:51:40,849][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:51:55,525][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:52:09,033][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:52:29,042][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:52:43,590][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:52:56,590][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:53:07,766][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:53:21,516][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:53:36,412][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:53:49,810][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:54:03,314][root][INFO] - Processing question number 10
[2025-03-06 19:54:03,316][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:54:13,888][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:54:24,887][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:54:39,526][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:54:51,397][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:55:06,493][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:55:19,763][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:55:30,792][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:55:43,600][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:55:58,264][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:56:13,913][root][INFO] - Processing question number 20
[2025-03-06 19:56:13,916][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:56:30,345][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:56:45,554][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:56:58,153][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:57:10,710][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:57:25,046][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:57:38,536][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:57:53,451][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:58:05,562][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:58:19,214][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:58:35,380][root][INFO] - Processing question number 30
[2025-03-06 19:58:35,382][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:58:49,147][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:59:02,375][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:59:17,305][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:59:31,324][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:59:44,521][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:00:01,800][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:00:17,435][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:00:33,717][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:00:48,540][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:01:03,805][root][INFO] - Processing question number 40
[2025-03-06 20:01:03,808][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:01:21,645][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:01:32,666][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:01:48,414][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:01:57,921][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:02:17,045][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:02:29,185][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:02:42,412][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:02:55,196][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:03:10,588][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:03:25,843][root][INFO] - Processing question number 50
[2025-03-06 20:03:25,847][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:03:43,147][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:03:56,189][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:04:11,586][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:04:25,766][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:04:37,662][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:04:49,698][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:05:04,135][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:05:20,253][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:05:32,417][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:05:45,838][root][INFO] - Processing question number 60
[2025-03-06 20:05:45,843][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:06:02,543][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:06:19,536][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:06:33,690][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:06:50,839][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:07:08,837][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:07:25,152][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:07:37,229][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:07:52,951][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:08:03,300][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:08:15,332][root][INFO] - Processing question number 70
[2025-03-06 20:08:15,337][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:08:27,357][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:08:44,050][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:08:58,995][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:09:15,500][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:09:29,051][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:09:47,383][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:10:01,916][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:10:16,101][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:10:28,211][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:10:41,216][root][INFO] - Processing question number 80
[2025-03-06 20:10:41,221][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:10:54,725][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:11:08,217][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:11:23,960][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:11:37,249][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:11:51,349][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:12:06,847][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:12:23,878][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:12:39,710][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:12:54,437][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:13:09,714][root][INFO] - Processing question number 90
[2025-03-06 20:13:09,720][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:13:25,500][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:13:40,590][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:13:54,205][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:14:05,950][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:14:21,906][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:14:37,564][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:14:52,210][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:15:04,137][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:15:16,922][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:15:32,419][root][INFO] - Inference complete
[2025-03-06 20:15:32,419][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,427][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,429][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,430][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,430][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,431][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,431][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,431][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,432][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,433][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,433][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,436][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,436][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,437][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,438][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,438][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,438][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,439][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,439][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,439][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,441][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:15:32,441][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:15:32,441][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:15:32,443][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,450][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,450][root][INFO] - Saved parsed outputs
[2025-03-06 20:15:32,450][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,452][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,452][root][INFO] - Saved parsing metadata
[2025-03-06 20:15:32,453][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,454][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:32,456][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:15:32,502][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 20:15:32,502][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.27, 'malformed_label': 7, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 20, 'correct_label_wrong_domain': 31, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Job 10 completed at Thu Mar  6 20:15:34 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n508
Job ID: 25358385
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 10:25:39
CPU Efficiency: 9.89% of 4-09:27:50 core-walltime
Job Wall-clock time: 10:32:47
Memory Utilized: 35.88 GB
Memory Efficiency: 99.66% of 36.00 GB
