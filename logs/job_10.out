Starting job 10 at Thu Feb 20 22:52:55 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=number_list_fact_first_few_shot_structured train=number_list_fact_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '10', 'training']
Updating job 10 to status training with exit code None
Status update completed for job 10
[2025-02-20 22:53:09,984][root][INFO] - Global seed set to 314
[2025-02-20 22:53:09,985][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:53:09,985][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:53:09,985][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:53:09,986][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:53:09,986][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-02-20 22:53:10,006][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:53:10,055][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:53:10,069][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:53:10,093][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:53:10,819][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:53:34,519][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:54:02,038][root][INFO] - Model prepared for kbit training
[2025-02-20 22:54:02,039][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'k_proj', 'gate_proj', 'down_proj', 'q_proj', 'up_proj', 'v_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:54:03,750][root][INFO] - Lora adapter added to model
[2025-02-20 22:54:03,754][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_structured
[2025-02-20 22:54:03,965][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.6352, 'grad_norm': 0.42628058791160583, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.3328, 'grad_norm': 0.3494184613227844, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.1321, 'grad_norm': 0.34956392645835876, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 0.967, 'grad_norm': 0.7427970170974731, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.7153, 'grad_norm': 0.3737342059612274, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 421.3454, 'train_samples_per_second': 0.249, 'train_steps_per_second': 0.036, 'train_loss': 1.1564799149831135, 'epoch': 15.0}
[2025-02-20 23:01:13,067][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_fact_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '10', 'trained', '0']
Updating job 10 to status trained with exit code 0
Status update completed for job 10
Starting evaluations for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-20 23:01:22,201][root][INFO] - Setting global seed to 206
[2025-02-20 23:01:22,206][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:01:22,206][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:01:22,208][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:01:22,209][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:01:22,211][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:01:22,211][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:01:22,466][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:01:23,000][root][INFO] - Full model selected, loading model
[2025-02-20 23:01:48,054][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:03:29,397][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:03:29,399][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:04:01,819][root][INFO] - Peft model loaded successfully
[2025-02-20 23:04:09,287][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:04:09,288][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:04:09,288][root][INFO] - Starting inference
[2025-02-20 23:04:09,488][root][INFO] - Processing question number 0
[2025-02-20 23:04:09,540][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:04:20,525][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:04:34,475][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:04:50,478][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:05:04,868][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:05:20,099][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:05:31,856][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:05:44,835][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:05:59,654][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:06:10,979][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:06:21,254][root][INFO] - Processing question number 10
[2025-02-20 23:06:21,257][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:06:38,174][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:06:51,271][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:07:05,943][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:07:20,882][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:07:34,339][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:07:46,424][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:08:00,014][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:08:11,992][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:08:28,311][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:08:40,607][root][INFO] - Processing question number 20
[2025-02-20 23:08:40,609][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:08:51,924][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:09:05,319][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:09:19,335][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:09:31,679][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:09:46,114][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:09:58,560][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:10:10,917][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:10:25,971][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:10:39,795][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:10:51,081][root][INFO] - Processing question number 30
[2025-02-20 23:10:51,083][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:11:05,731][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:11:20,131][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:11:36,353][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:11:52,398][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:12:03,868][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:12:17,921][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:12:31,532][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:12:45,994][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:12:59,687][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:13:14,700][root][INFO] - Processing question number 40
[2025-02-20 23:13:14,703][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:13:28,269][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:13:45,204][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:13:58,241][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:14:11,122][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:14:23,440][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:14:37,933][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:14:51,481][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:15:04,325][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:15:17,094][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:15:29,118][root][INFO] - Processing question number 50
[2025-02-20 23:15:29,121][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:15:41,373][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:15:56,019][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:16:09,669][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:16:22,424][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:16:33,874][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:16:44,317][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:16:59,091][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:17:10,848][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:17:23,571][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:17:35,645][root][INFO] - Processing question number 60
[2025-02-20 23:17:35,650][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:17:48,623][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:18:00,388][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:18:15,129][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:18:26,285][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:18:40,424][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:18:52,014][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:19:04,133][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:19:17,293][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:19:31,970][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:19:46,238][root][INFO] - Processing question number 70
[2025-02-20 23:19:46,243][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:19:58,625][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:20:15,870][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:20:27,384][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:20:43,759][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:20:58,834][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:21:11,957][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:21:28,188][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:21:42,826][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:21:58,257][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:22:15,382][root][INFO] - Processing question number 80
[2025-02-20 23:22:15,388][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:22:28,919][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:22:47,778][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:22:59,974][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:23:12,644][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:23:27,251][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:23:41,510][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:23:55,601][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:24:11,636][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:24:27,431][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:24:38,323][root][INFO] - Processing question number 90
[2025-02-20 23:24:38,329][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:24:55,430][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:25:08,284][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:25:21,089][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:25:35,292][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:25:49,559][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:26:04,988][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:26:17,003][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:26:32,216][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:26:45,688][root][INFO] - Inference complete
[2025-02-20 23:26:45,689][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,696][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,711][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,750][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,750][root][INFO] - Saved parsed outputs
[2025-02-20 23:26:45,750][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,778][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,778][root][INFO] - Saved parsing metadata
[2025-02-20 23:26:45,779][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,781][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:26:45,812][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:26:45,845][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-20 23:26:45,846][root][INFO] - Summary of metrics : {'label_accuracy': 0.5555555555555556, 'misclassification_rate': 0.4444444444444444, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 55, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.8461538461538461, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 13, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-20 23:26:56,412][root][INFO] - Setting global seed to 206
[2025-02-20 23:26:56,420][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:26:56,420][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:26:56,421][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:26:56,424][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:26:56,428][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:26:56,428][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:26:56,584][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:26:57,125][root][INFO] - Full model selected, loading model
[2025-02-20 23:27:19,877][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:27:19,878][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:27:27,715][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:27:27,717][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:27:27,717][root][INFO] - Starting inference
[2025-02-20 23:27:27,917][root][INFO] - Processing question number 0
[2025-02-20 23:27:27,960][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:27:39,417][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:27:52,691][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:28:09,435][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:28:21,627][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:28:34,715][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:28:48,429][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:29:03,915][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:29:16,887][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:29:29,649][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:29:40,716][root][INFO] - Processing question number 10
[2025-02-20 23:29:40,718][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:29:56,071][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:30:09,104][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:30:22,198][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:30:36,910][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:30:50,350][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:31:03,918][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:31:18,693][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:31:32,783][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:31:45,775][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:31:58,408][root][INFO] - Processing question number 20
[2025-02-20 23:31:58,411][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:32:09,755][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:32:25,324][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:32:39,409][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:32:53,943][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:33:08,867][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:33:22,248][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:33:36,340][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:33:50,797][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:34:06,786][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:34:19,945][root][INFO] - Processing question number 30
[2025-02-20 23:34:19,948][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:34:33,959][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:34:49,996][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:35:05,222][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:35:19,059][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:35:31,463][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:35:44,019][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:35:59,284][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:36:16,355][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:36:28,760][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:36:42,874][root][INFO] - Processing question number 40
[2025-02-20 23:36:42,877][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:36:57,692][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:37:12,094][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:37:27,731][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:37:44,304][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:37:56,797][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:38:10,097][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:38:23,628][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:38:36,002][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:38:49,447][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:39:01,908][root][INFO] - Processing question number 50
[2025-02-20 23:39:01,912][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:39:17,448][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:39:31,614][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:39:42,005][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:39:53,399][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:40:09,337][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:40:25,934][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:40:39,813][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:40:54,468][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:41:07,934][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:41:20,249][root][INFO] - Processing question number 60
[2025-02-20 23:41:20,255][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:41:34,013][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:41:43,306][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:42:00,126][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:42:13,623][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:42:25,505][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:42:39,869][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:42:50,144][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:43:03,386][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:43:16,049][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:43:31,474][root][INFO] - Processing question number 70
[2025-02-20 23:43:31,480][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:43:44,795][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:43:58,408][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:44:10,954][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:44:26,532][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:44:43,332][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:44:56,277][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:45:12,902][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:45:26,347][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:45:42,266][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:45:54,792][root][INFO] - Processing question number 80
[2025-02-20 23:45:54,796][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:46:08,405][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:46:28,269][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:46:42,310][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:46:55,409][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:47:08,724][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:47:23,477][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:47:37,751][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:47:51,415][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:48:08,055][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:48:22,427][root][INFO] - Processing question number 90
[2025-02-20 23:48:22,433][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:48:38,790][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:48:54,968][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:49:08,038][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:49:20,418][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:49:34,405][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:49:47,425][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:50:00,470][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:50:17,400][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:50:31,607][root][INFO] - Inference complete
[2025-02-20 23:50:31,607][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,615][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,630][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,644][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,644][root][INFO] - Saved parsed outputs
[2025-02-20 23:50:31,644][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,681][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,681][root][INFO] - Saved parsing metadata
[2025-02-20 23:50:31,682][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,684][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:50:31,705][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:50:31,737][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-20 23:50:31,737][root][INFO] - Summary of metrics : {'label_accuracy': 0.6161616161616161, 'misclassification_rate': 0.38383838383838387, 'combined_accuracy': 0.3333333333333333, 'malformed_label': 0, 'malformed_domain': 47, 'total_predictions': 99, 'correct_predictions': 61, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 19, 'correct_label_wrong_domain': 28, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-20 23:50:43,680][root][INFO] - Setting global seed to 206
[2025-02-20 23:50:43,688][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:50:43,688][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:50:43,689][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:50:43,692][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:50:43,697][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:50:43,697][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:50:43,842][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:50:44,399][root][INFO] - Full model selected, loading model
[2025-02-20 23:51:07,760][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:52:50,803][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:52:50,803][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:53:22,646][root][INFO] - Peft model loaded successfully
[2025-02-20 23:53:30,526][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:53:30,528][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:30,528][root][INFO] - Starting inference
[2025-02-20 23:53:30,747][root][INFO] - Processing question number 0
[2025-02-20 23:53:30,749][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:53:41,602][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:53:56,548][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:54:12,888][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:54:27,710][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:54:41,587][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:54:53,238][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:55:06,374][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:55:22,549][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:55:34,376][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:55:45,498][root][INFO] - Processing question number 10
[2025-02-20 23:55:45,501][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:56:03,245][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:56:16,149][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:56:34,002][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:56:53,663][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:57:07,645][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:57:21,707][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:57:35,359][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:57:48,102][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:58:03,022][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:58:16,695][root][INFO] - Processing question number 20
[2025-02-20 23:58:16,698][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:58:28,210][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:58:42,127][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:58:56,353][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:59:11,180][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:59:24,599][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:59:38,265][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:59:52,231][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:00:06,372][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:00:22,414][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:00:34,546][root][INFO] - Processing question number 30
[2025-02-21 00:00:34,549][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:00:52,834][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:01:06,522][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:01:21,942][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:01:37,659][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:01:50,545][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:02:03,478][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:02:17,562][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:02:32,717][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:02:50,073][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:03:04,828][root][INFO] - Processing question number 40
[2025-02-21 00:03:04,832][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:03:17,902][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:03:34,150][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:03:47,344][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:04:00,129][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:04:13,161][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:04:25,524][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:04:38,449][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:04:52,407][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:05:04,255][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:05:16,633][root][INFO] - Processing question number 50
[2025-02-21 00:05:16,637][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:05:29,715][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:05:43,038][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:05:54,945][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:06:08,590][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:06:22,181][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:06:32,510][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:06:47,100][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:07:00,173][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:07:14,452][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:07:28,714][root][INFO] - Processing question number 60
[2025-02-21 00:07:28,718][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:07:41,854][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:07:54,387][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:08:09,569][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:08:21,118][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:08:33,479][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:08:45,986][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:08:59,284][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:09:09,945][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:09:23,093][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:09:38,257][root][INFO] - Processing question number 70
[2025-02-21 00:09:38,264][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:09:51,928][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:10:04,555][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:10:17,343][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:10:34,703][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:10:50,529][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:11:03,761][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:11:18,468][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:11:29,335][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:11:45,779][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:12:02,794][root][INFO] - Processing question number 80
[2025-02-21 00:12:02,799][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:12:14,648][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:12:32,050][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:12:45,725][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:13:00,190][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:13:15,883][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:13:30,309][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:13:42,815][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:13:56,522][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:14:12,197][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:14:23,331][root][INFO] - Processing question number 90
[2025-02-21 00:14:23,337][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:14:40,275][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:14:53,282][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:15:08,952][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:15:23,331][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:15:39,490][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:15:53,209][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:16:05,470][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:16:20,148][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:16:34,826][root][INFO] - Inference complete
[2025-02-21 00:16:34,826][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,835][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,851][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,862][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,862][root][INFO] - Saved parsed outputs
[2025-02-21 00:16:34,862][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,867][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,867][root][INFO] - Saved parsing metadata
[2025-02-21 00:16:34,868][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,871][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:16:34,877][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:16:34,914][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 00:16:34,914][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 1, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.7692307692307693, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1111111111111111, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 11, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 00:16:46,635][root][INFO] - Setting global seed to 206
[2025-02-21 00:16:46,643][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:16:46,644][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:16:46,645][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:16:46,647][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:16:46,652][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:16:46,653][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:16:46,805][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:16:47,381][root][INFO] - Full model selected, loading model
[2025-02-21 00:17:09,817][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:17:09,818][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:17:17,771][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:17:17,772][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:17:17,772][root][INFO] - Starting inference
[2025-02-21 00:17:17,952][root][INFO] - Processing question number 0
[2025-02-21 00:17:17,955][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:17:29,658][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:17:44,405][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:18:01,574][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:18:19,268][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:18:33,417][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:18:46,893][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:19:01,008][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:19:17,120][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:19:32,408][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:19:44,553][root][INFO] - Processing question number 10
[2025-02-21 00:19:44,556][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:20:03,425][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:20:16,080][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:20:30,389][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:20:46,590][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:21:02,329][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:21:14,962][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:21:27,342][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:21:41,561][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:21:52,889][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:22:03,654][root][INFO] - Processing question number 20
[2025-02-21 00:22:03,657][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:22:21,725][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:22:35,690][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:22:49,706][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:23:01,236][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:23:15,474][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:23:30,109][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:23:46,424][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:24:02,303][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:24:14,543][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:24:27,573][root][INFO] - Processing question number 30
[2025-02-21 00:24:27,576][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:24:40,944][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:24:56,306][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:25:12,820][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:25:27,048][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:25:39,367][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:25:54,056][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:26:06,495][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:26:18,609][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:26:32,567][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:26:45,769][root][INFO] - Processing question number 40
[2025-02-21 00:26:45,773][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:26:59,239][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:27:14,342][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:27:31,012][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:27:46,793][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:28:00,122][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:28:14,217][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:28:29,857][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:28:42,048][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:28:54,960][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:29:08,612][root][INFO] - Processing question number 50
[2025-02-21 00:29:08,616][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:29:26,184][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:29:41,821][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:29:52,808][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:30:08,279][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:30:20,630][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:30:35,343][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:30:48,989][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:31:04,246][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:31:16,960][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:31:30,638][root][INFO] - Processing question number 60
[2025-02-21 00:31:30,642][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:31:45,093][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:31:55,479][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:32:10,551][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:32:22,093][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:32:36,028][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:32:51,397][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:33:01,461][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:33:12,678][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:33:25,514][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:33:41,287][root][INFO] - Processing question number 70
[2025-02-21 00:33:41,292][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:33:54,075][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:34:05,928][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:34:18,849][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:34:35,461][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:34:51,428][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:35:06,645][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:35:22,385][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:35:37,245][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:35:53,785][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:36:06,887][root][INFO] - Processing question number 80
[2025-02-21 00:36:06,892][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:36:22,022][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:36:39,200][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:36:50,881][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:37:03,753][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:37:20,064][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:37:35,104][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:37:50,034][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:38:04,240][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:38:20,059][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:38:32,946][root][INFO] - Processing question number 90
[2025-02-21 00:38:32,951][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:38:48,416][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:39:05,681][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:39:20,560][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:39:34,701][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:39:51,118][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:40:05,077][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:40:16,919][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:40:29,177][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:40:44,579][root][INFO] - Inference complete
[2025-02-21 00:40:44,579][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,586][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,601][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,608][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,608][root][INFO] - Saved parsed outputs
[2025-02-21 00:40:44,608][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,609][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,609][root][INFO] - Saved parsing metadata
[2025-02-21 00:40:44,610][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,612][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:40:44,614][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:40:44,646][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 00:40:44,646][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 0, 'malformed_domain': 47, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.050505050505050504, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 23, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 00:40:55,568][root][INFO] - Setting global seed to 206
[2025-02-21 00:40:55,576][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:40:55,576][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:40:55,577][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:40:55,580][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:40:55,585][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:40:55,585][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:40:56,011][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:40:56,633][root][INFO] - Full model selected, loading model
[2025-02-21 00:41:18,945][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:43:02,078][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:43:02,078][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:43:33,731][root][INFO] - Peft model loaded successfully
[2025-02-21 00:43:41,189][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:43:41,190][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:43:41,190][root][INFO] - Starting inference
[2025-02-21 00:43:41,393][root][INFO] - Processing question number 0
[2025-02-21 00:43:41,396][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:43:54,195][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:44:09,035][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:44:24,865][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:44:41,715][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:44:55,683][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:45:11,556][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:45:26,470][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:45:38,808][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:45:50,888][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:46:07,160][root][INFO] - Processing question number 10
[2025-02-21 00:46:07,162][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:46:24,541][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:46:38,475][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:46:52,412][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:47:06,116][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:47:17,071][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:47:33,280][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:47:48,252][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:48:01,504][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:48:14,220][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:48:26,772][root][INFO] - Processing question number 20
[2025-02-21 00:48:26,774][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:48:39,663][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:48:57,416][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:49:09,911][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:49:21,549][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:49:36,668][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:49:51,207][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:50:06,166][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:50:21,534][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:50:34,399][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:50:47,035][root][INFO] - Processing question number 30
[2025-02-21 00:50:47,038][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:51:03,451][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:51:18,961][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:51:34,758][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:51:50,067][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:52:01,021][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:52:16,387][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:52:29,599][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:52:45,065][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:52:57,597][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:53:11,117][root][INFO] - Processing question number 40
[2025-02-21 00:53:11,120][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:53:25,161][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:53:37,912][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:53:52,771][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:54:05,608][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:54:19,148][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:54:31,104][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:54:45,652][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:54:59,258][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:55:13,003][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:55:26,469][root][INFO] - Processing question number 50
[2025-02-21 00:55:26,473][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:55:43,190][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:55:57,004][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:56:08,100][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:56:21,381][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:56:34,304][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:56:44,233][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:56:59,184][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:57:13,120][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:57:25,028][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:57:37,087][root][INFO] - Processing question number 60
[2025-02-21 00:57:37,093][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:57:49,477][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:58:04,104][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:58:21,208][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:58:31,448][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:58:44,986][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:59:00,258][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:59:12,982][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:59:25,329][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:59:39,446][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:59:54,446][root][INFO] - Processing question number 70
[2025-02-21 00:59:54,450][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:00:08,876][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:00:22,215][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:00:37,805][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:00:55,099][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:01:10,400][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:01:23,932][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:01:42,079][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:01:56,124][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:02:11,575][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:02:27,197][root][INFO] - Processing question number 80
[2025-02-21 01:02:27,201][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:02:40,226][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:02:58,815][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:03:12,998][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:03:24,951][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:03:37,991][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:03:57,531][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:04:12,669][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:04:27,134][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:04:42,703][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:04:57,527][root][INFO] - Processing question number 90
[2025-02-21 01:04:57,533][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:05:14,252][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:05:28,722][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:05:45,880][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:05:59,848][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:06:13,906][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:06:29,665][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:06:41,413][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:06:55,927][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:07:12,212][root][INFO] - Inference complete
[2025-02-21 01:07:12,213][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,221][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,236][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,242][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,242][root][INFO] - Saved parsed outputs
[2025-02-21 01:07:12,242][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,244][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,244][root][INFO] - Saved parsing metadata
[2025-02-21 01:07:12,245][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,248][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:12,250][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:07:12,294][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 01:07:12,294][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 30, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 13, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 01:07:25,579][root][INFO] - Setting global seed to 206
[2025-02-21 01:07:25,587][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:07:25,588][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:07:25,589][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:07:25,591][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:07:25,596][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:07:25,596][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:07:25,778][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:07:26,329][root][INFO] - Full model selected, loading model
[2025-02-21 01:07:48,324][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:07:48,325][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:07:56,474][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:07:56,475][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:07:56,475][root][INFO] - Starting inference
[2025-02-21 01:07:56,662][root][INFO] - Processing question number 0
[2025-02-21 01:07:56,664][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:08:09,564][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:08:24,354][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:08:43,011][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:09:01,217][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:09:16,577][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:09:30,366][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:09:44,169][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:09:57,977][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:10:11,729][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:10:22,694][root][INFO] - Processing question number 10
[2025-02-21 01:10:22,696][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:10:38,769][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:10:50,110][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:11:05,637][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:11:19,644][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:11:33,570][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:11:47,830][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:12:00,108][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:12:14,684][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:12:26,771][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:12:40,642][root][INFO] - Processing question number 20
[2025-02-21 01:12:40,644][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:12:52,860][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:13:06,875][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:13:19,723][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:13:31,305][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:13:48,187][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:14:04,152][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:14:19,203][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:14:33,285][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:14:47,367][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:15:04,990][root][INFO] - Processing question number 30
[2025-02-21 01:15:04,992][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:15:24,366][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:15:38,881][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:15:53,782][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:16:07,947][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:16:20,054][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:16:36,975][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:16:53,049][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:17:08,347][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:17:23,170][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:17:37,255][root][INFO] - Processing question number 40
[2025-02-21 01:17:37,259][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:17:51,641][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:18:08,140][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:18:25,220][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:18:37,486][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:18:52,971][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:19:07,830][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:19:22,310][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:19:33,745][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:19:45,530][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:19:58,150][root][INFO] - Processing question number 50
[2025-02-21 01:19:58,154][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:20:11,068][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:20:27,325][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:20:39,916][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:20:53,183][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:21:08,098][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:21:21,733][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:21:36,264][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:21:48,817][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:22:06,637][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:22:24,997][root][INFO] - Processing question number 60
[2025-02-21 01:22:25,001][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:22:38,740][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:22:49,679][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:23:05,372][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:23:16,761][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:23:29,520][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:23:44,524][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:23:58,938][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:24:13,533][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:24:26,368][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:24:42,245][root][INFO] - Processing question number 70
[2025-02-21 01:24:42,250][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:24:56,254][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:25:12,295][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:25:24,857][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:25:43,762][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:26:01,139][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:26:15,891][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:26:34,447][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:26:49,609][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:27:04,639][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:27:23,197][root][INFO] - Processing question number 80
[2025-02-21 01:27:23,202][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:27:36,681][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:27:55,471][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:28:11,133][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:28:26,671][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:28:40,515][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:28:58,430][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:29:14,011][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:29:30,085][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:29:45,979][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:29:59,060][root][INFO] - Processing question number 90
[2025-02-21 01:29:59,065][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:30:17,168][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:30:31,293][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:30:43,691][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:30:56,599][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:31:11,810][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:31:23,647][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:31:38,309][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:32:00,478][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:32:14,504][root][INFO] - Inference complete
[2025-02-21 01:32:14,504][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,511][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,526][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,532][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,533][root][INFO] - Saved parsed outputs
[2025-02-21 01:32:14,533][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,534][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,534][root][INFO] - Saved parsing metadata
[2025-02-21 01:32:14,535][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,536][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:32:14,537][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:32:14,552][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 01:32:14,552][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.24242424242424243, 'malformed_label': 1, 'malformed_domain': 56, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.04040404040404041, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.08080808080808081, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 19, 'correct_label_wrong_domain': 25, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 01:32:21,228][root][INFO] - Setting global seed to 989
[2025-02-21 01:32:21,235][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:32:21,235][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:32:21,236][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:32:21,237][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:32:21,244][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:32:21,244][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:32:21,393][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:32:21,913][root][INFO] - Full model selected, loading model
[2025-02-21 01:32:41,232][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:34:25,103][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:34:25,124][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:34:55,461][root][INFO] - Peft model loaded successfully
[2025-02-21 01:35:02,855][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:35:02,856][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:35:02,856][root][INFO] - Starting inference
[2025-02-21 01:35:03,048][root][INFO] - Processing question number 0
[2025-02-21 01:35:03,051][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:35:14,028][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:35:27,966][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:35:43,955][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:35:58,331][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:36:13,547][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:36:25,291][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:36:38,251][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:36:53,058][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:37:04,369][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:37:14,632][root][INFO] - Processing question number 10
[2025-02-21 01:37:14,634][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:37:31,530][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:37:44,607][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:37:57,966][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:38:12,921][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:38:26,387][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:38:38,458][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:38:52,028][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:39:03,990][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:39:20,290][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:39:32,572][root][INFO] - Processing question number 20
[2025-02-21 01:39:32,575][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:39:43,878][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:39:57,258][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:40:11,253][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:40:23,581][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:40:38,000][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:40:50,433][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:41:02,771][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:41:17,795][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:41:31,607][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:41:42,916][root][INFO] - Processing question number 30
[2025-02-21 01:41:42,919][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:41:57,593][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:42:12,002][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:42:28,204][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:42:44,235][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:42:55,690][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:43:09,728][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:43:23,339][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:43:37,803][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:43:51,526][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:44:06,524][root][INFO] - Processing question number 40
[2025-02-21 01:44:06,528][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:44:20,079][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:44:36,998][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:44:50,023][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:45:02,891][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:45:15,193][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:45:29,665][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:45:43,191][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:45:56,014][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:46:08,766][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:46:20,768][root][INFO] - Processing question number 50
[2025-02-21 01:46:20,772][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:46:33,007][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:46:47,628][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:47:01,258][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:47:13,997][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:47:25,430][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:47:35,859][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:47:50,613][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:48:02,360][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:48:15,067][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:48:27,129][root][INFO] - Processing question number 60
[2025-02-21 01:48:27,133][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:48:40,092][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:48:51,847][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:49:06,573][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:49:17,715][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:49:31,840][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:49:43,421][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:49:55,520][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:50:08,666][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:50:23,325][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:50:37,576][root][INFO] - Processing question number 70
[2025-02-21 01:50:37,582][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:50:49,948][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:51:07,171][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:51:18,674][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:51:35,033][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:51:50,091][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:52:03,195][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:52:19,412][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:52:34,037][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:52:49,451][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:53:06,561][root][INFO] - Processing question number 80
[2025-02-21 01:53:06,566][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:53:20,080][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:53:38,922][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:53:51,099][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:54:03,750][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:54:17,430][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:54:31,117][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:54:45,195][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:55:01,218][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:55:16,993][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:55:27,876][root][INFO] - Processing question number 90
[2025-02-21 01:55:27,882][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:55:44,967][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:55:57,802][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:56:10,578][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:56:24,759][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:56:39,003][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:56:54,412][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:57:06,411][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:57:21,609][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:57:35,063][root][INFO] - Inference complete
[2025-02-21 01:57:35,063][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,069][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,084][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,090][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,091][root][INFO] - Saved parsed outputs
[2025-02-21 01:57:35,091][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,092][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,092][root][INFO] - Saved parsing metadata
[2025-02-21 01:57:35,093][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,094][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:57:35,096][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:57:35,125][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 01:57:35,126][root][INFO] - Summary of metrics : {'label_accuracy': 0.5555555555555556, 'misclassification_rate': 0.4444444444444444, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 55, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.8461538461538461, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 13, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 01:57:42,229][root][INFO] - Setting global seed to 989
[2025-02-21 01:57:42,235][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:57:42,236][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:57:42,237][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:57:42,239][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:57:42,241][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:57:42,241][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:57:42,394][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:57:43,021][root][INFO] - Full model selected, loading model
[2025-02-21 01:58:00,848][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:58:00,848][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:58:08,574][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:58:08,575][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:58:08,576][root][INFO] - Starting inference
[2025-02-21 01:58:08,781][root][INFO] - Processing question number 0
[2025-02-21 01:58:08,783][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:58:20,240][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:58:33,520][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:58:50,262][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:59:02,453][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:59:15,535][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:59:29,243][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:59:44,718][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:59:57,685][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:00:10,444][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:00:21,508][root][INFO] - Processing question number 10
[2025-02-21 02:00:21,510][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:00:36,862][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:00:49,892][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:01:02,980][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:01:17,689][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:01:31,123][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:01:44,683][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:01:59,458][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:02:13,541][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:02:26,528][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:02:39,151][root][INFO] - Processing question number 20
[2025-02-21 02:02:39,153][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:02:50,492][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:03:06,053][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:03:20,136][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:03:34,667][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:03:49,584][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:04:02,961][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:04:17,048][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:04:31,499][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:04:47,480][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:05:00,635][root][INFO] - Processing question number 30
[2025-02-21 02:05:00,637][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:05:14,642][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:05:30,675][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:05:45,896][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:05:59,724][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:06:12,122][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:06:24,671][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:06:39,928][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:06:56,994][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:07:09,392][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:07:23,501][root][INFO] - Processing question number 40
[2025-02-21 02:07:23,504][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:07:38,315][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:07:52,714][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:08:08,343][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:08:24,914][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:08:37,403][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:08:50,706][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:09:04,229][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:09:16,600][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:09:30,043][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:09:42,503][root][INFO] - Processing question number 50
[2025-02-21 02:09:42,507][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:09:58,037][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:10:12,193][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:10:22,575][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:10:33,967][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:10:46,908][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:11:03,471][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:11:17,344][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:11:31,995][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:11:45,454][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:11:57,769][root][INFO] - Processing question number 60
[2025-02-21 02:11:57,772][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:12:11,525][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:12:20,812][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:12:37,389][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:12:50,875][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:13:02,753][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:13:17,058][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:13:27,329][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:13:40,570][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:13:53,233][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:14:08,659][root][INFO] - Processing question number 70
[2025-02-21 02:14:08,663][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:14:22,096][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:14:35,778][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:14:48,391][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:15:04,038][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:15:20,880][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:15:33,893][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:15:50,597][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:16:04,059][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:16:20,051][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:16:32,638][root][INFO] - Processing question number 80
[2025-02-21 02:16:32,643][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:16:46,290][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:17:06,163][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:17:20,209][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:17:33,317][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:17:46,640][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:18:01,389][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:18:15,669][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:18:29,342][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:18:45,994][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:19:00,373][root][INFO] - Processing question number 90
[2025-02-21 02:19:00,379][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:19:16,744][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:19:32,928][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:19:46,005][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:19:58,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:20:12,394][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:20:25,432][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:20:38,482][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:20:55,420][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:21:09,630][root][INFO] - Inference complete
[2025-02-21 02:21:09,630][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,636][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,651][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,657][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,657][root][INFO] - Saved parsed outputs
[2025-02-21 02:21:09,657][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,659][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,659][root][INFO] - Saved parsing metadata
[2025-02-21 02:21:09,659][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,661][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:21:09,663][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:21:09,695][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 02:21:09,695][root][INFO] - Summary of metrics : {'label_accuracy': 0.6161616161616161, 'misclassification_rate': 0.38383838383838387, 'combined_accuracy': 0.3333333333333333, 'malformed_label': 0, 'malformed_domain': 47, 'total_predictions': 99, 'correct_predictions': 61, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 19, 'correct_label_wrong_domain': 28, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 02:21:18,173][root][INFO] - Setting global seed to 989
[2025-02-21 02:21:18,181][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:21:18,181][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:21:18,182][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:21:18,185][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:21:18,188][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:21:18,188][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:21:18,337][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:21:18,962][root][INFO] - Full model selected, loading model
[2025-02-21 02:21:39,480][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:23:24,174][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:23:24,225][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:24:02,789][root][INFO] - Peft model loaded successfully
[2025-02-21 02:24:10,579][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:24:10,581][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:24:10,581][root][INFO] - Starting inference
[2025-02-21 02:24:10,748][root][INFO] - Processing question number 0
[2025-02-21 02:24:10,750][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:24:22,145][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:24:35,228][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:24:52,743][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:25:06,839][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:25:19,736][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:25:31,176][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:25:44,770][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:26:01,453][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:26:15,813][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:26:28,622][root][INFO] - Processing question number 10
[2025-02-21 02:26:28,624][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:26:45,659][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:26:57,395][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:27:11,529][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:27:25,028][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:27:38,950][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:27:52,803][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:28:09,566][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:28:22,416][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:28:35,943][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:28:48,485][root][INFO] - Processing question number 20
[2025-02-21 02:28:48,487][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:29:02,230][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:29:18,412][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:29:33,755][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:29:45,543][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:29:57,888][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:30:12,472][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:30:24,869][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:30:40,442][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:30:54,426][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:31:06,603][root][INFO] - Processing question number 30
[2025-02-21 02:31:06,606][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:31:23,942][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:31:36,966][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:31:51,149][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:32:05,474][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:32:17,844][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:32:31,952][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:32:46,284][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:33:03,826][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:33:21,446][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:33:38,135][root][INFO] - Processing question number 40
[2025-02-21 02:33:38,139][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:33:51,143][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:34:05,939][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:34:19,908][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:34:30,383][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:34:44,481][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:34:57,504][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:35:10,948][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:35:24,804][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:35:37,464][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:35:50,713][root][INFO] - Processing question number 50
[2025-02-21 02:35:50,717][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:36:04,182][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:36:18,835][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:36:30,357][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:36:43,005][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:36:57,305][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:37:13,625][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:37:28,254][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:37:42,187][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:37:56,973][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:38:09,865][root][INFO] - Processing question number 60
[2025-02-21 02:38:09,869][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:38:22,184][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:38:33,539][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:38:49,182][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:39:00,222][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:39:13,809][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:39:28,870][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:39:41,589][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:39:57,643][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:40:10,483][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:40:25,584][root][INFO] - Processing question number 70
[2025-02-21 02:40:25,588][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:40:38,325][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:40:52,328][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:41:04,947][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:41:21,197][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:41:36,865][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:41:49,735][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:42:06,672][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:42:19,584][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:42:35,146][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:42:48,204][root][INFO] - Processing question number 80
[2025-02-21 02:42:48,209][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:43:01,336][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:43:18,781][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:43:31,322][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:43:45,013][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:44:00,852][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:44:15,066][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:44:27,106][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:44:43,008][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:44:59,605][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:45:09,579][root][INFO] - Processing question number 90
[2025-02-21 02:45:09,585][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:45:26,670][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:45:40,227][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:45:52,760][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:46:06,869][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:46:21,396][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:46:35,766][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:46:46,848][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:47:00,693][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:47:14,634][root][INFO] - Inference complete
[2025-02-21 02:47:14,635][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,641][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,657][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,674][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,674][root][INFO] - Saved parsed outputs
[2025-02-21 02:47:14,674][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,676][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,676][root][INFO] - Saved parsing metadata
[2025-02-21 02:47:14,676][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,678][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:14,679][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:47:14,720][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 02:47:14,720][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 17, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 02:47:21,846][root][INFO] - Setting global seed to 989
[2025-02-21 02:47:21,853][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:47:21,853][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:47:21,855][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:47:21,856][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:47:21,859][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:47:21,859][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:47:22,063][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:47:22,623][root][INFO] - Full model selected, loading model
[2025-02-21 02:47:42,436][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:47:42,436][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:47:50,121][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:47:50,122][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:47:50,122][root][INFO] - Starting inference
[2025-02-21 02:47:50,287][root][INFO] - Processing question number 0
[2025-02-21 02:47:50,289][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:48:02,557][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:48:16,053][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:48:35,431][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:48:46,448][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:49:01,079][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:49:18,707][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:49:35,592][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:49:50,468][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:50:02,785][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:50:16,926][root][INFO] - Processing question number 10
[2025-02-21 02:50:16,927][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:50:32,626][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:50:46,024][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:50:57,443][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:51:09,852][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:51:22,488][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:51:37,856][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:51:51,187][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:52:04,784][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:52:18,357][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:52:31,406][root][INFO] - Processing question number 20
[2025-02-21 02:52:31,408][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:52:44,791][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:53:00,342][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:53:15,472][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:53:29,270][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:53:48,542][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:54:04,398][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:54:20,861][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:54:32,943][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:54:49,540][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:55:02,365][root][INFO] - Processing question number 30
[2025-02-21 02:55:02,368][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:55:20,584][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:55:33,595][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:55:50,670][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:56:05,342][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:56:19,285][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:56:33,442][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:56:46,179][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:57:04,597][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:57:20,034][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:57:34,898][root][INFO] - Processing question number 40
[2025-02-21 02:57:34,901][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:57:50,363][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:58:04,790][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:58:22,289][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:58:36,140][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:58:51,915][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:59:05,999][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:59:23,108][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:59:34,489][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:59:45,764][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:59:59,003][root][INFO] - Processing question number 50
[2025-02-21 02:59:59,006][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:00:15,620][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:00:29,599][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:00:40,223][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:00:55,261][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:01:06,994][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:01:24,019][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:01:37,504][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:01:53,520][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:02:07,520][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:02:20,563][root][INFO] - Processing question number 60
[2025-02-21 03:02:20,567][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:02:34,804][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:02:44,851][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:03:02,555][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:03:14,449][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:03:27,618][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:03:41,287][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:03:52,266][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:04:06,867][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:04:19,910][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:04:34,485][root][INFO] - Processing question number 70
[2025-02-21 03:04:34,490][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:04:47,679][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:05:06,467][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:05:21,379][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:05:37,619][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:05:51,410][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:06:06,416][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:06:22,660][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:06:37,412][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:06:55,534][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:07:10,210][root][INFO] - Processing question number 80
[2025-02-21 03:07:10,215][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:07:27,732][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:07:43,328][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:07:56,051][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:08:11,700][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:08:31,578][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:08:46,606][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:09:01,017][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:09:15,722][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:09:32,482][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:09:47,497][root][INFO] - Processing question number 90
[2025-02-21 03:09:47,503][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:10:03,582][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:10:15,526][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:10:29,637][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:10:41,274][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:10:57,668][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:11:13,103][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:11:26,160][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:11:46,064][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:12:01,592][root][INFO] - Inference complete
[2025-02-21 03:12:01,593][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,599][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,615][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,621][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,621][root][INFO] - Saved parsed outputs
[2025-02-21 03:12:01,621][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,622][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,622][root][INFO] - Saved parsing metadata
[2025-02-21 03:12:01,623][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,624][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:12:01,626][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:12:01,637][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 03:12:01,637][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 0, 'malformed_domain': 49, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.050505050505050504, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 24, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 03:12:07,794][root][INFO] - Setting global seed to 989
[2025-02-21 03:12:07,799][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:12:07,800][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:12:07,801][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:12:07,802][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:12:07,804][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:12:07,804][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:12:07,952][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:12:08,481][root][INFO] - Full model selected, loading model
[2025-02-21 03:12:22,157][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:14:04,373][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:14:04,390][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:14:36,120][root][INFO] - Peft model loaded successfully
[2025-02-21 03:14:43,517][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:14:43,518][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:14:43,518][root][INFO] - Starting inference
[2025-02-21 03:14:43,746][root][INFO] - Processing question number 0
[2025-02-21 03:14:43,748][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:15:06,089][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:15:24,511][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:15:41,350][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:15:54,501][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:16:07,872][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:16:22,837][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:16:34,937][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:16:49,462][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:17:03,112][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:17:18,490][root][INFO] - Processing question number 10
[2025-02-21 03:17:18,492][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:17:32,653][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:17:43,640][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:17:57,116][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:18:12,791][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:18:25,328][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:18:38,884][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:18:52,274][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:19:05,111][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:19:18,281][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:19:30,580][root][INFO] - Processing question number 20
[2025-02-21 03:19:30,582][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:19:43,008][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:19:57,484][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:20:07,719][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:20:19,164][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:20:33,209][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:20:47,801][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:21:02,126][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:21:15,704][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:21:28,050][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:21:39,882][root][INFO] - Processing question number 30
[2025-02-21 03:21:39,885][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:21:56,659][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:22:08,702][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:22:24,223][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:22:38,645][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:22:49,961][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:23:03,207][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:23:15,829][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:23:32,604][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:23:47,659][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:24:04,294][root][INFO] - Processing question number 40
[2025-02-21 03:24:04,297][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:24:17,100][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:24:32,876][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:24:51,577][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:25:03,580][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:25:16,759][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:25:29,060][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:25:42,910][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:25:53,894][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:26:04,515][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:26:17,607][root][INFO] - Processing question number 50
[2025-02-21 03:26:17,611][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:26:30,833][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:26:44,249][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:26:56,193][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:27:13,764][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:27:27,190][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:27:38,059][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:27:53,159][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:28:04,658][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:28:18,927][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:28:22,156][root][INFO] - Processing question number 60
[2025-02-21 03:28:22,160][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:28:37,122][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:28:46,859][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:29:04,629][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:29:16,225][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:29:28,463][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:29:42,841][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:29:54,633][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:30:12,918][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:30:25,034][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:30:41,329][root][INFO] - Processing question number 70
[2025-02-21 03:30:41,333][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:30:55,136][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:31:09,341][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:31:23,491][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:31:40,666][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:31:57,771][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:32:09,272][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:32:26,198][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:32:38,382][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:32:53,298][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:33:12,576][root][INFO] - Processing question number 80
[2025-02-21 03:33:12,581][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:33:24,512][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:33:41,310][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:33:53,036][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:34:06,009][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:34:21,627][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:34:35,835][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:34:47,882][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:35:00,711][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:35:16,054][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:35:29,593][root][INFO] - Processing question number 90
[2025-02-21 03:35:29,599][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:35:46,352][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:35:59,700][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:36:12,480][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:36:25,477][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:36:42,595][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:36:55,185][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:37:06,215][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:37:20,921][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:37:34,488][root][INFO] - Inference complete
[2025-02-21 03:37:34,488][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,494][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 1. Chosen Domain in question number 18 in domain Evidence
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 2. Legal Concept in question number 18 in domain Evidence
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 3. Fact Analysis in question number 18 in domain Evidence
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 4. Rule Application in question number 18 in domain Evidence
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 5. Legal Conclusion in question number 18 in domain Evidence
[2025-02-21 03:37:34,503][root][WARNING] - No match found for 6. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 03:37:34,510][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,516][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,516][root][INFO] - Saved parsed outputs
[2025-02-21 03:37:34,516][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,517][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,517][root][INFO] - Saved parsing metadata
[2025-02-21 03:37:34,517][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,519][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:37:34,521][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:37:34,550][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 03:37:34,550][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.3838383838383838, 'malformed_label': 2, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 13, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 03:37:41,517][root][INFO] - Setting global seed to 989
[2025-02-21 03:37:41,524][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:37:41,524][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:37:41,525][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:37:41,526][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:37:41,529][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:37:41,529][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:37:41,726][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:37:42,255][root][INFO] - Full model selected, loading model
[2025-02-21 03:38:03,032][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:38:03,032][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:38:10,671][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:38:10,673][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:38:10,673][root][INFO] - Starting inference
[2025-02-21 03:38:10,918][root][INFO] - Processing question number 0
[2025-02-21 03:38:10,920][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:38:25,267][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:38:38,618][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:38:55,543][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:39:09,911][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:39:22,156][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:39:36,211][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:39:52,474][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:40:08,401][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:40:21,096][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:40:37,022][root][INFO] - Processing question number 10
[2025-02-21 03:40:37,024][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:40:53,495][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:41:09,205][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:41:19,617][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:41:35,831][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:41:50,180][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:42:07,310][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:42:20,352][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:42:33,918][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:42:48,475][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:43:01,435][root][INFO] - Processing question number 20
[2025-02-21 03:43:01,438][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:43:14,222][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:43:28,557][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:43:45,190][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:43:58,542][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:44:12,431][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:44:26,920][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:44:41,404][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:44:55,029][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:45:07,478][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:45:25,882][root][INFO] - Processing question number 30
[2025-02-21 03:45:25,885][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:45:38,444][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:45:59,324][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:46:14,734][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:46:28,758][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:46:41,336][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:46:57,800][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:47:13,113][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:47:28,892][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:47:45,797][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:48:01,140][root][INFO] - Processing question number 40
[2025-02-21 03:48:01,143][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:48:15,123][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:48:29,977][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:48:45,503][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:48:59,632][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:49:15,784][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:49:30,243][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:49:45,050][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:49:56,695][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:50:12,074][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:50:26,834][root][INFO] - Processing question number 50
[2025-02-21 03:50:26,837][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:50:41,475][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:50:59,985][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:51:11,377][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:51:25,960][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:51:40,371][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:51:51,049][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:52:07,254][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:52:21,390][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:52:37,592][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:52:51,537][root][INFO] - Processing question number 60
[2025-02-21 03:52:51,540][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:53:05,996][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:53:16,541][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:53:30,684][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:53:45,125][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:53:57,539][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:54:11,723][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:54:24,668][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:54:36,991][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:54:50,430][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:55:05,622][root][INFO] - Processing question number 70
[2025-02-21 03:55:05,627][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:55:19,160][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:55:30,888][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:55:47,852][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:56:03,685][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:56:18,257][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:56:32,288][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:56:50,825][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:57:06,781][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:57:20,368][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:57:36,097][root][INFO] - Processing question number 80
[2025-02-21 03:57:36,102][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:57:53,010][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:58:10,619][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:58:21,974][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:58:35,843][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:58:51,949][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:59:09,083][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:59:26,785][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:59:42,230][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:00:01,914][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:00:15,108][root][INFO] - Processing question number 90
[2025-02-21 04:00:15,113][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:00:30,272][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:00:47,740][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:01:01,300][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:01:16,077][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:01:31,756][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:01:45,572][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:01:57,879][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:02:15,345][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:02:31,413][root][INFO] - Inference complete
[2025-02-21 04:02:31,414][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,421][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,437][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,443][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,443][root][INFO] - Saved parsed outputs
[2025-02-21 04:02:31,443][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,444][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,444][root][INFO] - Saved parsing metadata
[2025-02-21 04:02:31,445][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,447][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:02:31,465][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:02:31,477][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 04:02:31,477][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 0, 'malformed_domain': 65, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.050505050505050504, 'Civil_Procedure_confidence': 0.04040404040404041, 'correct_domain_wrong_label': 12, 'correct_label_wrong_domain': 26, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 04:02:37,696][root][INFO] - Setting global seed to 206
[2025-02-21 04:02:37,701][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:02:37,701][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:02:37,702][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:02:37,704][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:02:37,705][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:02:37,706][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:02:38,054][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:02:38,844][root][INFO] - Full model selected, loading model
[2025-02-21 04:02:53,282][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:04:32,759][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:04:32,760][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:05:05,419][root][INFO] - Peft model loaded successfully
[2025-02-21 04:05:12,770][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:05:12,772][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:05:12,772][root][INFO] - Starting inference
[2025-02-21 04:05:12,944][root][INFO] - Processing question number 0
[2025-02-21 04:05:12,946][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:05:25,232][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:05:39,842][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:05:53,128][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:06:07,611][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:06:19,785][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:06:31,455][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:06:45,125][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:06:58,477][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:07:10,245][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:07:23,017][root][INFO] - Processing question number 10
[2025-02-21 04:07:23,019][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:07:35,079][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:07:48,201][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:08:00,801][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:08:11,183][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:08:23,823][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:08:36,305][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:08:47,698][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:09:01,976][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:09:15,861][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:09:29,856][root][INFO] - Processing question number 20
[2025-02-21 04:09:29,859][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:09:40,656][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:09:52,384][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:10:03,214][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:10:13,862][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:10:27,283][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:10:41,385][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:10:54,459][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:11:08,990][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:11:22,381][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:11:36,941][root][INFO] - Processing question number 30
[2025-02-21 04:11:36,944][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:11:48,639][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:12:03,438][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:12:15,411][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:12:28,245][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:12:40,979][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:12:54,887][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:13:10,250][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:13:24,252][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:13:37,865][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:13:51,474][root][INFO] - Processing question number 40
[2025-02-21 04:13:51,478][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:14:05,189][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:14:18,010][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:14:32,680][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:14:42,512][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:15:03,286][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:15:13,214][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:15:26,763][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:15:40,412][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:15:54,498][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:16:10,127][root][INFO] - Processing question number 50
[2025-02-21 04:16:10,131][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:16:24,732][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:16:40,758][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:16:55,786][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:17:10,064][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:17:25,065][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:17:38,588][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:17:52,916][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:18:06,320][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:18:17,623][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:18:31,277][root][INFO] - Processing question number 60
[2025-02-21 04:18:31,281][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:18:43,645][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:18:59,151][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:19:16,575][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:19:35,088][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:19:48,984][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:20:04,916][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:20:19,249][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:20:29,554][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:20:44,480][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:20:57,962][root][INFO] - Processing question number 70
[2025-02-21 04:20:57,967][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:21:10,863][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:21:23,684][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:21:37,339][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:21:54,076][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:22:06,466][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:22:20,563][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:22:39,065][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:22:55,265][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:23:09,138][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:23:23,172][root][INFO] - Processing question number 80
[2025-02-21 04:23:23,176][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:23:37,810][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:23:52,754][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:24:07,498][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:24:20,697][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:24:36,591][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:24:52,065][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:25:05,102][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:25:21,277][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:25:34,474][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:25:49,106][root][INFO] - Processing question number 90
[2025-02-21 04:25:49,111][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:26:03,021][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:26:16,037][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:26:31,559][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:26:43,965][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:26:59,800][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:27:16,283][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:27:31,220][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:27:43,377][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:27:54,219][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:28:08,956][root][INFO] - Inference complete
[2025-02-21 04:28:08,956][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,963][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,978][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,984][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,985][root][INFO] - Saved parsed outputs
[2025-02-21 04:28:08,985][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,986][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,986][root][INFO] - Saved parsing metadata
[2025-02-21 04:28:08,987][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,989][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:08,994][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:28:09,020][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 04:28:09,020][root][INFO] - Summary of metrics : {'label_accuracy': 0.61, 'misclassification_rate': 0.39, 'combined_accuracy': 0.38, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 61, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.13, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 23, 'both_wrong': 12}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 04:28:15,741][root][INFO] - Setting global seed to 206
[2025-02-21 04:28:15,746][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:28:15,747][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:28:15,748][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:28:15,751][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:28:15,753][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:28:15,754][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:28:15,920][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:28:16,472][root][INFO] - Full model selected, loading model
[2025-02-21 04:28:35,437][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:28:35,437][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:28:43,025][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:28:43,026][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:28:43,027][root][INFO] - Starting inference
[2025-02-21 04:28:43,227][root][INFO] - Processing question number 0
[2025-02-21 04:28:43,245][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:28:56,063][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:29:09,727][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:29:30,856][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:29:48,504][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:30:02,512][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:30:14,193][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:30:29,250][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:30:45,168][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:30:58,158][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:31:13,589][root][INFO] - Processing question number 10
[2025-02-21 04:31:13,592][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:31:23,437][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:31:37,986][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:31:53,992][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:32:05,171][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:32:16,743][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:32:28,919][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:32:39,745][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:32:56,615][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:33:10,906][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:33:25,867][root][INFO] - Processing question number 20
[2025-02-21 04:33:25,870][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:33:36,218][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:33:49,014][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:34:02,098][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:34:13,257][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:34:26,834][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:34:40,025][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:34:54,416][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:35:07,424][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:35:21,316][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:35:36,336][root][INFO] - Processing question number 30
[2025-02-21 04:35:36,339][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:35:50,315][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:36:05,107][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:36:18,349][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:36:32,153][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:36:43,984][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:36:59,727][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:37:16,463][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:37:32,013][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:37:46,129][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:38:04,466][root][INFO] - Processing question number 40
[2025-02-21 04:38:04,469][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:38:17,985][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:38:29,789][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:38:47,484][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:39:00,175][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:39:20,542][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:39:31,463][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:39:41,617][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:39:53,168][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:40:07,181][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:40:20,828][root][INFO] - Processing question number 50
[2025-02-21 04:40:20,831][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:40:33,864][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:40:48,417][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:41:05,571][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:41:19,667][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:41:33,189][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:41:46,230][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:42:05,180][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:42:27,023][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:42:37,731][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:42:49,623][root][INFO] - Processing question number 60
[2025-02-21 04:42:49,627][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:43:02,942][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:43:15,368][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:43:31,960][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:43:49,084][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:44:04,225][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:44:17,494][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:44:28,995][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:44:42,078][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:44:56,483][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:45:12,140][root][INFO] - Processing question number 70
[2025-02-21 04:45:12,145][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:45:24,639][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:45:41,992][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:45:59,203][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:46:17,084][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:46:29,122][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:46:48,804][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:47:02,442][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:47:18,799][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:47:32,227][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:47:45,700][root][INFO] - Processing question number 80
[2025-02-21 04:47:45,705][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:48:00,447][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:48:14,423][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:48:28,705][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:48:41,449][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:48:58,186][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:49:15,940][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:49:30,482][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:49:47,291][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:50:01,104][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:50:14,107][root][INFO] - Processing question number 90
[2025-02-21 04:50:14,113][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:50:28,338][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:50:44,411][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:50:56,257][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:51:10,957][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:51:25,510][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:51:39,205][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:51:54,814][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:52:08,694][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:52:22,644][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:52:35,832][root][INFO] - Inference complete
[2025-02-21 04:52:35,832][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,839][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,855][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,861][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,862][root][INFO] - Saved parsed outputs
[2025-02-21 04:52:35,862][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,863][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,863][root][INFO] - Saved parsing metadata
[2025-02-21 04:52:35,864][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,865][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:52:35,867][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:52:35,894][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 04:52:35,895][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.04, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 28, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 04:52:43,083][root][INFO] - Setting global seed to 206
[2025-02-21 04:52:43,090][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:52:43,090][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:52:43,091][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:52:43,092][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:52:43,095][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:52:43,095][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:52:43,249][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:52:43,780][root][INFO] - Full model selected, loading model
[2025-02-21 04:53:04,638][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:54:46,263][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:54:46,274][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:55:17,699][root][INFO] - Peft model loaded successfully
[2025-02-21 04:55:25,538][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:55:25,541][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 04:55:25,541][root][INFO] - Starting inference
[2025-02-21 04:55:25,800][root][INFO] - Processing question number 0
[2025-02-21 04:55:25,812][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:55:38,969][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:55:52,276][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:56:05,222][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:56:19,468][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:56:31,966][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:56:43,843][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:56:58,361][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:57:11,321][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:57:22,425][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:57:36,369][root][INFO] - Processing question number 10
[2025-02-21 04:57:36,371][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:57:46,946][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:57:59,415][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:58:13,701][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:58:25,271][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:58:37,350][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:58:50,189][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:59:02,844][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:59:16,679][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:59:28,522][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:59:40,883][root][INFO] - Processing question number 20
[2025-02-21 04:59:40,886][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:59:52,369][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:00:05,370][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:00:16,592][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:00:27,675][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:00:40,948][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:00:53,827][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:01:06,811][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:01:22,385][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:01:36,394][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:01:52,739][root][INFO] - Processing question number 30
[2025-02-21 05:01:52,742][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:02:04,585][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:02:18,380][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:02:32,408][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:02:48,183][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:02:59,307][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:03:14,988][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:03:29,212][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:03:41,066][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:03:53,263][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:04:05,807][root][INFO] - Processing question number 40
[2025-02-21 05:04:05,810][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:04:20,625][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:04:36,253][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:04:50,356][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:05:02,092][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:05:23,155][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:05:35,394][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:05:46,996][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:05:58,536][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:06:11,332][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:06:25,196][root][INFO] - Processing question number 50
[2025-02-21 05:06:25,199][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:06:41,663][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:06:57,353][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:07:14,553][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:07:27,261][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:07:40,717][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:07:55,934][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:08:12,100][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:08:28,137][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:08:40,350][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:08:52,570][root][INFO] - Processing question number 60
[2025-02-21 05:08:52,574][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:09:06,513][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:09:21,621][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:09:37,678][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:09:53,487][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:10:06,776][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:10:24,054][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:10:36,575][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:10:48,666][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:11:04,427][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:11:17,605][root][INFO] - Processing question number 70
[2025-02-21 05:11:17,610][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:11:31,696][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:11:45,173][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:11:59,868][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:12:15,698][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:12:28,135][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:12:43,019][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:13:02,618][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:13:16,449][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:13:29,881][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:13:43,202][root][INFO] - Processing question number 80
[2025-02-21 05:13:43,207][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:13:56,465][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:14:10,494][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:14:25,411][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:14:38,306][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:14:57,446][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:15:14,539][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:15:27,684][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:15:44,982][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:15:57,819][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:16:10,513][root][INFO] - Processing question number 90
[2025-02-21 05:16:10,518][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:16:24,488][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:16:41,101][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:16:53,347][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:17:04,788][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:17:20,279][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:17:36,464][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:17:50,287][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:18:02,077][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:18:14,964][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:18:30,033][root][INFO] - Inference complete
[2025-02-21 05:18:30,033][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,041][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,056][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,062][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,062][root][INFO] - Saved parsed outputs
[2025-02-21 05:18:30,062][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,071][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,071][root][INFO] - Saved parsing metadata
[2025-02-21 05:18:30,071][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,073][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:18:30,077][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:18:30,094][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 05:18:30,094][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.7857142857142857, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 22, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 05:18:36,523][root][INFO] - Setting global seed to 206
[2025-02-21 05:18:36,528][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:18:36,528][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:18:36,530][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:18:36,532][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:18:36,534][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:18:36,534][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:18:36,679][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:18:37,396][root][INFO] - Full model selected, loading model
[2025-02-21 05:18:56,984][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:18:56,984][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:19:04,569][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:19:04,570][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:19:04,570][root][INFO] - Starting inference
[2025-02-21 05:19:04,777][root][INFO] - Processing question number 0
[2025-02-21 05:19:04,779][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:19:19,617][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:19:32,909][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:19:49,240][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:20:03,273][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:20:17,030][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:20:29,507][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:20:42,438][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:20:56,842][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:21:08,273][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:21:19,686][root][INFO] - Processing question number 10
[2025-02-21 05:21:19,688][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:21:29,558][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:21:45,503][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:22:00,148][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:22:12,018][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:22:25,220][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:22:36,776][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:22:47,994][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:23:02,489][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:23:15,399][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:23:30,371][root][INFO] - Processing question number 20
[2025-02-21 05:23:30,374][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:23:43,559][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:23:58,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:24:13,340][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:24:25,285][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:24:38,498][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:24:53,585][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:25:08,658][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:25:22,046][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:25:35,557][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:25:51,162][root][INFO] - Processing question number 30
[2025-02-21 05:25:51,164][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:26:05,611][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:26:18,122][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:26:31,570][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:26:45,222][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:26:57,145][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:27:11,731][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:27:26,495][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:27:41,074][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:27:56,018][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:28:12,057][root][INFO] - Processing question number 40
[2025-02-21 05:28:12,060][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:28:25,742][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:28:38,780][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:28:56,942][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:29:09,305][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:29:26,610][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:29:39,793][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:29:52,491][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:30:06,860][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:30:23,394][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:30:36,795][root][INFO] - Processing question number 50
[2025-02-21 05:30:36,800][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:30:49,838][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:31:04,517][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:31:22,068][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:31:34,810][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:31:49,223][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:32:03,265][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:32:13,430][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:32:31,241][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:32:43,296][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:32:56,224][root][INFO] - Processing question number 60
[2025-02-21 05:32:56,229][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:33:11,396][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:33:27,786][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:33:45,142][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:34:00,314][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:34:16,488][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:34:32,584][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:34:43,425][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:34:56,012][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:35:09,111][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:35:20,413][root][INFO] - Processing question number 70
[2025-02-21 05:35:20,417][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:35:33,373][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:35:49,520][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:36:02,618][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:36:18,755][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:36:29,481][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:36:43,594][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:36:57,965][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:37:14,506][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:37:27,797][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:37:40,208][root][INFO] - Processing question number 80
[2025-02-21 05:37:40,213][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:37:55,901][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:38:10,819][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:38:26,946][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:38:40,771][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:38:59,234][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:39:14,177][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:39:32,377][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:39:49,942][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:40:04,372][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:40:18,660][root][INFO] - Processing question number 90
[2025-02-21 05:40:18,665][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:40:30,696][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:40:47,522][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:41:04,380][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:41:17,401][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:41:34,889][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:41:48,836][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:42:02,512][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:42:16,710][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:42:30,118][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:42:44,190][root][INFO] - Inference complete
[2025-02-21 05:42:44,190][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,197][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,212][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,225][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,225][root][INFO] - Saved parsed outputs
[2025-02-21 05:42:44,225][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,242][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,242][root][INFO] - Saved parsing metadata
[2025-02-21 05:42:44,243][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,244][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:42:44,246][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:42:44,265][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 05:42:44,265][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.24, 'malformed_label': 0, 'malformed_domain': 50, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.05, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.07, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 28, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 05:42:51,770][root][INFO] - Setting global seed to 206
[2025-02-21 05:42:51,777][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:42:51,777][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:42:51,779][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:42:51,781][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:42:51,783][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:42:51,783][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:42:51,939][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:42:52,504][root][INFO] - Full model selected, loading model
[2025-02-21 05:43:12,658][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:44:55,702][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:44:55,723][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:45:30,171][root][INFO] - Peft model loaded successfully
[2025-02-21 05:45:37,991][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:45:37,994][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 05:45:37,994][root][INFO] - Starting inference
[2025-02-21 05:45:38,202][root][INFO] - Processing question number 0
[2025-02-21 05:45:38,207][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:45:51,852][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:46:06,340][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:46:20,078][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:46:34,948][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:46:47,486][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:46:59,433][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:47:13,290][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:47:27,327][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:47:38,107][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:47:51,304][root][INFO] - Processing question number 10
[2025-02-21 05:47:51,307][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:48:02,612][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:48:15,826][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:48:26,758][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:48:36,341][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:48:51,232][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:49:02,390][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:49:12,755][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:49:26,999][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:49:39,052][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:49:54,250][root][INFO] - Processing question number 20
[2025-02-21 05:49:54,253][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:50:05,639][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:50:18,594][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:50:29,667][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:50:40,812][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:50:55,196][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:51:08,179][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:51:20,304][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:51:33,885][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:51:48,874][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:52:04,602][root][INFO] - Processing question number 30
[2025-02-21 05:52:04,605][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:52:16,045][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:52:28,259][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:52:41,156][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:52:54,828][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:53:07,328][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:53:25,860][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:53:41,202][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:53:56,004][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:54:09,533][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:54:23,157][root][INFO] - Processing question number 40
[2025-02-21 05:54:23,162][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:54:37,249][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:54:50,324][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:55:05,003][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:55:16,746][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:55:32,671][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:55:43,536][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:55:55,763][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:56:07,671][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:56:22,120][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:56:35,479][root][INFO] - Processing question number 50
[2025-02-21 05:56:35,484][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:56:50,083][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:57:01,273][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:57:19,203][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:57:32,576][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:57:47,146][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:58:00,782][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:58:15,389][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:58:31,811][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:58:47,613][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:59:01,028][root][INFO] - Processing question number 60
[2025-02-21 05:59:01,033][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:59:14,671][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:59:29,584][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:59:45,374][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:00:03,216][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:00:14,821][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:00:30,515][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:00:45,778][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:01:00,040][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:01:13,704][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:01:27,903][root][INFO] - Processing question number 70
[2025-02-21 06:01:27,908][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:01:41,276][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:01:56,152][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:02:12,126][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:02:30,713][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:02:41,966][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:02:56,624][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:03:12,644][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:03:29,105][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:03:40,540][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:03:54,952][root][INFO] - Processing question number 80
[2025-02-21 06:03:54,957][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:04:09,887][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:04:26,026][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:04:41,632][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:04:54,947][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:05:08,471][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:05:24,032][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:05:39,416][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:05:55,048][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:06:07,692][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:06:20,448][root][INFO] - Processing question number 90
[2025-02-21 06:06:20,455][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:06:34,226][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:06:53,156][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:07:06,843][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:07:22,031][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:07:39,364][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:07:55,984][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:08:11,937][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:08:22,931][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:08:34,221][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:08:50,594][root][INFO] - Inference complete
[2025-02-21 06:08:50,595][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,603][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,619][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,629][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,630][root][INFO] - Saved parsed outputs
[2025-02-21 06:08:50,630][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,632][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,632][root][INFO] - Saved parsing metadata
[2025-02-21 06:08:50,633][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,635][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:08:50,655][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:08:50,669][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 06:08:50,669][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.37, 'malformed_label': 0, 'malformed_domain': 37, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 37, 'Constitutional_Law_accuracy': 0.8571428571428571, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.12, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 23, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 06:08:57,008][root][INFO] - Setting global seed to 206
[2025-02-21 06:08:57,013][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:08:57,013][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:08:57,014][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:08:57,017][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:08:57,019][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:08:57,020][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:08:57,173][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:08:57,889][root][INFO] - Full model selected, loading model
[2025-02-21 06:09:20,144][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:09:20,152][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:09:27,967][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:09:27,970][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:09:27,970][root][INFO] - Starting inference
[2025-02-21 06:09:28,186][root][INFO] - Processing question number 0
[2025-02-21 06:09:28,199][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:09:45,225][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:10:00,465][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:10:15,974][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:10:31,737][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:10:44,026][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:10:54,803][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:11:09,190][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:11:22,633][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:11:35,387][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:11:53,804][root][INFO] - Processing question number 10
[2025-02-21 06:11:53,806][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:12:05,845][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:12:19,190][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:12:34,679][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:12:45,456][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:12:59,284][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:13:12,127][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:13:24,887][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:13:38,726][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:13:55,059][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:14:10,047][root][INFO] - Processing question number 20
[2025-02-21 06:14:10,050][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:14:22,293][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:14:35,607][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:14:49,277][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:15:01,739][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:15:15,576][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:15:30,045][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:15:41,770][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:15:54,425][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:16:08,009][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:16:23,241][root][INFO] - Processing question number 30
[2025-02-21 06:16:23,246][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:16:35,747][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:16:49,041][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:17:06,678][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:17:21,097][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:17:35,461][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:17:54,524][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:18:10,989][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:18:26,267][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:18:41,225][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:18:56,232][root][INFO] - Processing question number 40
[2025-02-21 06:18:56,236][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:19:09,960][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:19:24,564][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:19:41,681][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:19:53,126][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:20:12,082][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:20:27,363][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:20:38,637][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:20:51,375][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:21:03,923][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:21:17,842][root][INFO] - Processing question number 50
[2025-02-21 06:21:17,845][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:21:33,011][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:21:46,674][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:22:03,605][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:22:18,616][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:22:36,568][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:22:49,383][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:23:07,479][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:23:21,458][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:23:35,322][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:23:50,934][root][INFO] - Processing question number 60
[2025-02-21 06:23:50,939][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:24:06,418][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:24:20,700][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:24:38,955][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:24:56,267][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:25:10,375][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:25:24,888][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:25:36,290][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:25:47,927][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:26:00,725][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:26:14,064][root][INFO] - Processing question number 70
[2025-02-21 06:26:14,068][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:26:29,549][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:26:41,907][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:26:59,055][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:27:16,040][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:27:30,005][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:27:45,473][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:28:00,691][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:28:14,893][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:28:25,722][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:28:39,362][root][INFO] - Processing question number 80
[2025-02-21 06:28:39,367][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:28:53,922][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:29:09,208][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:29:25,752][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:29:38,862][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:29:55,579][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:30:09,958][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:30:26,908][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:30:44,425][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:30:59,018][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:31:14,852][root][INFO] - Processing question number 90
[2025-02-21 06:31:14,858][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:31:31,166][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:31:48,098][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:32:03,763][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:32:17,869][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:32:32,379][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:32:46,179][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:33:00,683][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:33:14,119][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:33:25,463][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:33:40,162][root][INFO] - Inference complete
[2025-02-21 06:33:40,162][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,170][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,186][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,211][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,211][root][INFO] - Saved parsed outputs
[2025-02-21 06:33:40,211][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,213][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,214][root][INFO] - Saved parsing metadata
[2025-02-21 06:33:40,214][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,216][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:33:40,217][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:33:40,230][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 06:33:40,231][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.19, 'malformed_label': 0, 'malformed_domain': 59, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 22, 'correct_label_wrong_domain': 39, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 06:33:46,585][root][INFO] - Setting global seed to 989
[2025-02-21 06:33:46,590][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:33:46,590][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:33:46,591][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:33:46,593][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:33:46,595][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:33:46,595][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:33:46,777][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:33:47,316][root][INFO] - Full model selected, loading model
[2025-02-21 06:34:01,987][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:35:42,794][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:35:42,795][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:36:13,533][root][INFO] - Peft model loaded successfully
[2025-02-21 06:36:20,867][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:36:20,869][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:36:20,870][root][INFO] - Starting inference
[2025-02-21 06:36:21,042][root][INFO] - Processing question number 0
[2025-02-21 06:36:21,056][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:36:33,339][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:36:47,970][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:37:01,194][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:37:15,581][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:37:27,713][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:37:39,339][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:37:52,926][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:38:06,276][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:38:18,030][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:38:30,802][root][INFO] - Processing question number 10
[2025-02-21 06:38:30,804][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:38:42,887][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:38:56,084][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:39:08,762][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:39:19,154][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:39:31,790][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:39:44,272][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:39:55,655][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:40:09,927][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:40:23,800][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:40:37,782][root][INFO] - Processing question number 20
[2025-02-21 06:40:37,784][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:40:48,569][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:41:00,291][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:41:11,116][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:41:21,759][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:41:35,173][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:41:49,270][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:42:02,339][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:42:16,867][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:42:30,251][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:42:44,809][root][INFO] - Processing question number 30
[2025-02-21 06:42:44,815][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:42:56,537][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:43:11,368][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:43:23,344][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:43:36,176][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:43:48,912][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:44:02,819][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:44:18,178][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:44:32,179][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:44:45,782][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:44:59,392][root][INFO] - Processing question number 40
[2025-02-21 06:44:59,395][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:45:13,103][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:45:25,907][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:45:40,499][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:45:50,303][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:46:11,032][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:46:20,945][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:46:34,475][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:46:48,106][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:47:02,168][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:47:17,766][root][INFO] - Processing question number 50
[2025-02-21 06:47:17,770][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:47:32,343][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:47:48,253][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:48:03,178][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:48:17,448][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:48:32,443][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:48:45,957][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:49:00,277][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:49:13,688][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:49:24,995][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:49:38,648][root][INFO] - Processing question number 60
[2025-02-21 06:49:38,653][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:49:51,005][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:50:06,495][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:50:23,913][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:50:42,423][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:50:56,318][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:51:12,235][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:51:26,554][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:51:36,851][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:51:51,776][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:52:05,263][root][INFO] - Processing question number 70
[2025-02-21 06:52:05,269][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:52:18,170][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:52:30,981][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:52:44,632][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:53:01,371][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:53:13,764][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:53:27,862][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:53:46,362][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:54:02,573][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:54:16,443][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:54:30,475][root][INFO] - Processing question number 80
[2025-02-21 06:54:30,480][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:54:45,116][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:55:00,073][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:55:14,823][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:55:28,027][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:55:43,924][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:55:59,401][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:56:12,441][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:56:28,617][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:56:41,812][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:56:56,452][root][INFO] - Processing question number 90
[2025-02-21 06:56:56,457][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:57:10,370][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:57:23,389][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:57:38,913][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:57:51,327][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:58:07,162][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:58:23,639][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:58:38,577][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:58:50,736][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:59:01,584][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:59:16,325][root][INFO] - Inference complete
[2025-02-21 06:59:16,325][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,333][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,349][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,356][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,356][root][INFO] - Saved parsed outputs
[2025-02-21 06:59:16,356][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,365][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,365][root][INFO] - Saved parsing metadata
[2025-02-21 06:59:16,366][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,369][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:16,379][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:59:16,403][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 06:59:16,403][root][INFO] - Summary of metrics : {'label_accuracy': 0.61, 'misclassification_rate': 0.39, 'combined_accuracy': 0.38, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 61, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.13, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 23, 'both_wrong': 12}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 06:59:23,341][root][INFO] - Setting global seed to 989
[2025-02-21 06:59:23,348][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:59:23,349][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:59:23,350][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:59:23,352][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:59:23,354][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:59:23,354][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:59:23,501][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:59:24,031][root][INFO] - Full model selected, loading model
[2025-02-21 06:59:42,817][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:59:42,817][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:59:50,414][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:59:50,416][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 06:59:50,416][root][INFO] - Starting inference
[2025-02-21 06:59:50,605][root][INFO] - Processing question number 0
[2025-02-21 06:59:50,608][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:00:03,399][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:00:17,058][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:00:38,178][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:00:55,818][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:01:09,831][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:01:21,514][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:01:36,574][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:01:52,491][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:02:05,481][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:02:20,911][root][INFO] - Processing question number 10
[2025-02-21 07:02:20,913][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:02:30,760][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:02:45,360][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:03:01,470][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:03:12,692][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:03:24,332][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:03:36,575][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:03:47,435][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:04:04,363][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:04:18,739][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:04:33,782][root][INFO] - Processing question number 20
[2025-02-21 07:04:33,784][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:04:44,143][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:04:56,988][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:05:10,116][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:05:21,328][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:05:34,918][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:05:48,090][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:06:02,474][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:06:15,467][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:06:29,349][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:06:44,365][root][INFO] - Processing question number 30
[2025-02-21 07:06:44,368][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:06:58,335][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:07:13,124][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:07:26,360][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:07:40,157][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:07:51,980][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:08:07,720][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:08:24,445][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:08:39,986][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:08:54,094][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:09:12,423][root][INFO] - Processing question number 40
[2025-02-21 07:09:12,427][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:09:25,928][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:09:37,726][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:09:55,424][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:10:08,125][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:10:28,488][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:10:39,409][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:10:49,563][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:11:01,111][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:11:15,143][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:11:28,826][root][INFO] - Processing question number 50
[2025-02-21 07:11:28,829][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:11:41,866][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:11:56,420][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:12:13,570][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:12:27,630][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:12:41,065][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:12:54,027][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:13:12,845][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:13:34,614][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:13:45,255][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:13:57,063][root][INFO] - Processing question number 60
[2025-02-21 07:13:57,068][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:14:10,268][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:14:22,647][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:14:39,121][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:14:56,123][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:15:11,232][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:15:24,501][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:15:35,997][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:15:49,076][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:16:03,476][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:16:19,131][root][INFO] - Processing question number 70
[2025-02-21 07:16:19,136][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:16:31,625][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:16:48,972][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:17:06,173][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:17:24,053][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:17:36,090][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:17:55,769][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:18:09,401][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:18:25,748][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:18:39,172][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:18:52,635][root][INFO] - Processing question number 80
[2025-02-21 07:18:52,641][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:19:07,373][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:19:21,339][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:19:35,617][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:19:48,354][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:20:05,080][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:20:22,794][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:20:37,319][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:20:54,107][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:21:07,904][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:21:20,899][root][INFO] - Processing question number 90
[2025-02-21 07:21:20,905][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:21:35,116][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:21:51,176][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:22:03,009][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:22:17,702][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:22:32,238][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:22:45,916][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:23:01,516][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:23:15,390][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:23:29,333][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:23:42,513][root][INFO] - Inference complete
[2025-02-21 07:23:42,513][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,520][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,536][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,548][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,548][root][INFO] - Saved parsed outputs
[2025-02-21 07:23:42,548][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,549][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,549][root][INFO] - Saved parsing metadata
[2025-02-21 07:23:42,550][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,552][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:23:42,553][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:23:42,586][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 07:23:42,586][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.04, 'Contracts_confidence': 0.03, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 28, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 07:23:48,968][root][INFO] - Setting global seed to 989
[2025-02-21 07:23:48,973][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:23:48,973][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:23:48,974][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:23:48,976][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:23:48,979][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:23:48,979][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:23:49,133][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:23:49,763][root][INFO] - Full model selected, loading model
[2025-02-21 07:24:10,741][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:25:54,612][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:25:54,613][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:26:26,355][root][INFO] - Peft model loaded successfully
[2025-02-21 07:26:34,147][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:26:34,149][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:26:34,149][root][INFO] - Starting inference
[2025-02-21 07:26:34,357][root][INFO] - Processing question number 0
[2025-02-21 07:26:34,359][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:26:47,927][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:27:01,594][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:27:14,637][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:27:31,844][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:27:44,176][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:27:56,849][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:28:09,780][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:28:23,723][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:28:35,103][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:28:47,187][root][INFO] - Processing question number 10
[2025-02-21 07:28:47,189][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:28:59,318][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:29:12,860][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:29:26,573][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:29:37,466][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:29:50,267][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:30:02,701][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:30:16,774][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:30:31,065][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:30:44,423][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:31:00,040][root][INFO] - Processing question number 20
[2025-02-21 07:31:00,042][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:31:10,576][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:31:23,833][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:31:34,803][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:31:46,042][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:31:59,517][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:32:13,421][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:32:26,398][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:32:38,943][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:32:52,232][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:33:08,837][root][INFO] - Processing question number 30
[2025-02-21 07:33:08,840][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:33:20,372][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:33:32,330][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:33:44,759][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:33:58,399][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:34:09,360][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:34:24,569][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:34:40,419][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:34:53,194][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:35:06,301][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:35:21,200][root][INFO] - Processing question number 40
[2025-02-21 07:35:21,203][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:35:33,290][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:35:46,257][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:36:01,240][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:36:11,677][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:36:30,529][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:36:42,158][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:36:54,526][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:37:10,380][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:37:26,720][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:37:38,734][root][INFO] - Processing question number 50
[2025-02-21 07:37:38,738][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:37:51,371][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:38:04,972][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:38:19,241][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:38:33,578][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:38:48,146][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:39:01,931][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:39:16,112][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:39:34,128][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:39:46,034][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:39:57,336][root][INFO] - Processing question number 60
[2025-02-21 07:39:57,340][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:40:13,073][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:40:28,432][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:40:43,847][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:41:01,408][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:41:14,841][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:41:30,680][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:41:42,476][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:41:54,507][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:42:09,190][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:42:23,746][root][INFO] - Processing question number 70
[2025-02-21 07:42:23,750][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:42:37,836][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:42:53,777][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:43:08,575][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:43:24,901][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:43:36,445][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:43:51,647][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:44:08,815][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:44:25,360][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:44:39,513][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:44:50,901][root][INFO] - Processing question number 80
[2025-02-21 07:44:50,906][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:45:06,401][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:45:20,486][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:45:35,607][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:45:49,117][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:46:04,277][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:46:21,490][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:46:36,150][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:46:51,524][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:47:04,369][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:47:18,771][root][INFO] - Processing question number 90
[2025-02-21 07:47:18,776][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:47:30,098][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:47:44,914][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:48:00,002][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:48:11,040][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:48:23,635][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:48:39,933][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:48:54,226][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:49:05,876][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:49:18,574][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:49:33,793][root][INFO] - Inference complete
[2025-02-21 07:49:33,793][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,799][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,815][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,822][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,822][root][INFO] - Saved parsed outputs
[2025-02-21 07:49:33,822][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,823][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,823][root][INFO] - Saved parsing metadata
[2025-02-21 07:49:33,824][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,826][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:49:33,827][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:49:33,835][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 07:49:33,835][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 38, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.12, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 23, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 07:49:41,552][root][INFO] - Setting global seed to 989
[2025-02-21 07:49:41,561][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:49:41,561][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:49:41,563][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:49:41,564][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:49:41,571][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:49:41,571][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:49:41,723][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:49:42,313][root][INFO] - Full model selected, loading model
[2025-02-21 07:49:59,346][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:49:59,346][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:50:07,003][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:50:07,005][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 07:50:07,005][root][INFO] - Starting inference
[2025-02-21 07:50:07,245][root][INFO] - Processing question number 0
[2025-02-21 07:50:07,247][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:50:19,692][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:50:34,327][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:50:52,023][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:51:08,188][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:51:20,234][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:51:31,483][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:51:43,737][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:51:59,472][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:52:11,277][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:52:27,474][root][INFO] - Processing question number 10
[2025-02-21 07:52:27,475][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:52:39,295][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:52:54,772][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:53:10,641][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:53:21,251][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:53:33,725][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:53:46,862][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:53:59,762][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:54:11,800][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:54:25,015][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:54:39,519][root][INFO] - Processing question number 20
[2025-02-21 07:54:39,521][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:54:51,353][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:55:05,575][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:55:19,128][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:55:30,203][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:55:45,514][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:55:59,155][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:56:12,837][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:56:27,423][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:56:42,755][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:56:59,501][root][INFO] - Processing question number 30
[2025-02-21 07:56:59,504][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:57:14,305][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:57:27,018][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:57:40,307][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:57:52,985][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:58:06,334][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:58:22,819][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:58:36,865][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:58:53,684][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:59:06,751][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:59:23,311][root][INFO] - Processing question number 40
[2025-02-21 07:59:23,314][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:59:37,697][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:59:48,980][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:00:02,258][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:00:15,149][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:00:30,605][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:00:44,986][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:00:57,042][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:01:08,118][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:01:24,755][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:01:38,660][root][INFO] - Processing question number 50
[2025-02-21 08:01:38,663][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:01:55,746][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:02:13,530][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:02:26,653][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:02:41,028][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:02:55,124][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:03:07,316][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:03:22,212][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:03:36,230][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:03:46,643][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:04:02,546][root][INFO] - Processing question number 60
[2025-02-21 08:04:02,550][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:04:18,032][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:04:33,042][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:04:50,975][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:05:05,161][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:05:18,585][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:05:33,543][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:05:46,543][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:06:01,301][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:06:15,258][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:06:30,623][root][INFO] - Processing question number 70
[2025-02-21 08:06:30,628][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:06:42,803][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:07:02,161][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:07:18,979][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:07:36,784][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:07:48,761][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:08:06,763][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:08:25,397][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:08:42,135][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:08:56,477][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:09:13,126][root][INFO] - Processing question number 80
[2025-02-21 08:09:13,131][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:09:27,203][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:09:42,732][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:09:58,425][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:10:10,854][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:10:26,765][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:10:43,797][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:11:01,096][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:11:17,023][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:11:31,549][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:11:47,472][root][INFO] - Processing question number 90
[2025-02-21 08:11:47,477][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:12:01,343][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:12:17,046][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:12:28,993][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:12:41,563][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:12:57,892][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:13:11,939][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:13:26,481][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:13:40,416][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:13:54,372][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:14:07,557][root][INFO] - Inference complete
[2025-02-21 08:14:07,557][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,564][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,579][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,593][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,593][root][INFO] - Saved parsed outputs
[2025-02-21 08:14:07,593][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,609][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,609][root][INFO] - Saved parsing metadata
[2025-02-21 08:14:07,609][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,611][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:14:07,612][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:14:07,625][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 08:14:07,625][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.27, 'malformed_label': 1, 'malformed_domain': 52, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.05, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.08, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.08, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 21, 'correct_label_wrong_domain': 29, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 08:14:13,809][root][INFO] - Setting global seed to 989
[2025-02-21 08:14:13,814][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 08:14:13,814][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 08:14:13,816][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:14:13,817][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:14:13,819][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:14:13,819][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:14:13,967][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:14:14,494][root][INFO] - Full model selected, loading model
[2025-02-21 08:14:28,225][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 08:16:07,560][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 08:16:07,560][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 08:16:40,612][root][INFO] - Peft model loaded successfully
[2025-02-21 08:16:47,927][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:16:47,929][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:16:47,929][root][INFO] - Starting inference
[2025-02-21 08:16:48,090][root][INFO] - Processing question number 0
[2025-02-21 08:16:48,093][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:17:02,099][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:17:17,529][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:17:31,664][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:17:46,367][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:17:56,974][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:18:08,838][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:18:21,353][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:18:34,115][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:18:46,842][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:19:00,038][root][INFO] - Processing question number 10
[2025-02-21 08:19:00,040][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:19:12,808][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:19:25,013][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:19:38,273][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:19:48,737][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:20:02,397][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:20:14,364][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:20:27,293][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:20:41,014][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:20:55,490][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:21:09,860][root][INFO] - Processing question number 20
[2025-02-21 08:21:09,863][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:21:21,745][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:21:34,745][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:21:47,185][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:21:57,262][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:22:09,816][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:22:23,253][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:22:33,545][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:22:46,849][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:23:00,967][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:23:17,303][root][INFO] - Processing question number 30
[2025-02-21 08:23:17,305][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:23:29,961][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:23:45,228][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:23:57,910][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:24:11,051][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:24:23,382][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:24:40,437][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:24:56,535][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:25:12,931][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:25:24,652][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:25:38,263][root][INFO] - Processing question number 40
[2025-02-21 08:25:38,266][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:25:51,115][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:26:03,204][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:26:17,867][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:26:28,600][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:26:45,237][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:26:58,749][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:27:10,445][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:27:22,653][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:27:38,060][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:27:52,226][root][INFO] - Processing question number 50
[2025-02-21 08:27:52,230][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:28:06,871][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:28:19,103][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:28:36,593][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:28:51,231][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:29:07,419][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:29:21,704][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:29:37,490][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:29:52,226][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:30:07,573][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:30:21,318][root][INFO] - Processing question number 60
[2025-02-21 08:30:21,323][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:30:34,839][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:30:47,478][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:31:01,840][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:31:17,936][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:31:31,313][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:31:46,632][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:32:00,449][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:32:10,817][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:32:25,593][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:32:39,888][root][INFO] - Processing question number 70
[2025-02-21 08:32:39,893][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:32:53,253][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:33:08,364][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:33:26,330][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:33:42,153][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:33:54,031][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:34:08,601][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:34:24,857][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:34:36,220][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:34:49,096][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:35:02,827][root][INFO] - Processing question number 80
[2025-02-21 08:35:02,832][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:35:16,755][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:35:31,302][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:35:46,688][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:35:59,577][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:36:15,859][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:36:32,562][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:36:47,226][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:37:00,840][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:37:15,819][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:37:28,537][root][INFO] - Processing question number 90
[2025-02-21 08:37:28,543][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:37:43,039][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:37:57,092][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:38:11,683][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:38:24,068][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:38:41,721][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:38:57,369][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:39:08,856][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:39:23,568][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:39:35,348][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:39:50,504][root][INFO] - Inference complete
[2025-02-21 08:39:50,504][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,515][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,530][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,537][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,537][root][INFO] - Saved parsed outputs
[2025-02-21 08:39:50,537][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,539][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,539][root][INFO] - Saved parsing metadata
[2025-02-21 08:39:50,540][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,541][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:39:50,552][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:39:50,566][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 08:39:50,566][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.36, 'malformed_label': 0, 'malformed_domain': 38, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.12, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 24, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 10 to status running with exit code None
Eval status update completed for job 10
[2025-02-21 08:39:57,800][root][INFO] - Setting global seed to 989
[2025-02-21 08:39:57,806][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 08:39:57,806][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 08:39:57,808][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:39:57,809][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:39:57,811][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:39:57,811][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:39:57,956][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:39:58,496][root][INFO] - Full model selected, loading model
[2025-02-21 08:40:13,078][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:40:13,078][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:40:20,623][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:40:20,624][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 08:40:20,624][root][INFO] - Starting inference
[2025-02-21 08:40:20,839][root][INFO] - Processing question number 0
[2025-02-21 08:40:20,851][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:40:36,263][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:40:52,701][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:41:11,621][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:41:26,802][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:41:40,825][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:41:52,352][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:42:07,385][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:42:19,744][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:42:32,493][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:42:45,188][root][INFO] - Processing question number 10
[2025-02-21 08:42:45,190][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:42:57,422][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:43:11,579][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:43:27,516][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:43:40,046][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:43:55,412][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:44:07,434][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:44:19,990][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:44:32,502][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:44:48,103][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:45:03,192][root][INFO] - Processing question number 20
[2025-02-21 08:45:03,194][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:45:20,044][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:45:38,120][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:45:50,307][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:46:04,862][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:46:19,158][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:46:33,015][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:46:47,275][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:46:59,975][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:47:13,884][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:47:28,453][root][INFO] - Processing question number 30
[2025-02-21 08:47:28,456][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:47:41,424][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:47:56,296][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:48:09,239][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:48:24,197][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:48:37,097][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:48:50,261][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:49:05,814][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:49:21,187][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:49:34,453][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:49:50,710][root][INFO] - Processing question number 40
[2025-02-21 08:49:50,713][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:50:04,184][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:50:18,486][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:50:36,346][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:50:48,546][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:51:06,245][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:51:17,260][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:51:32,959][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:51:45,375][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:52:01,047][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:52:15,530][root][INFO] - Processing question number 50
[2025-02-21 08:52:15,533][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:52:27,854][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:52:42,530][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:52:58,833][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:53:12,454][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:53:27,071][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:53:42,393][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:53:54,043][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:54:07,921][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:54:24,664][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:54:38,551][root][INFO] - Processing question number 60
[2025-02-21 08:54:38,556][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:54:53,373][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:55:08,947][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:55:24,157][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:55:40,170][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:55:53,100][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:56:12,928][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:56:23,975][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:56:42,195][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:56:55,152][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:57:06,310][root][INFO] - Processing question number 70
[2025-02-21 08:57:06,315][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:57:21,478][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:57:39,968][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:57:56,590][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:58:13,722][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:58:26,417][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:58:42,086][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:58:54,579][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:59:08,937][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:59:20,939][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:59:33,420][root][INFO] - Processing question number 80
[2025-02-21 08:59:33,425][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:59:51,203][root][INFO] - Domain : Property, Question : 81
[2025-02-21 09:00:05,143][root][INFO] - Domain : Property, Question : 88
[2025-02-21 09:00:25,255][root][INFO] - Domain : Property, Question : 91
[2025-02-21 09:00:38,223][root][INFO] - Domain : Property, Question : 94
[2025-02-21 09:00:56,061][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:01:13,734][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:01:32,883][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 09:01:48,094][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 09:02:03,208][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:02:17,349][root][INFO] - Processing question number 90
[2025-02-21 09:02:17,354][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 09:02:30,923][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 09:02:44,932][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:02:57,644][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 09:03:09,901][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 09:03:26,235][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 09:03:39,926][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 09:03:52,988][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 09:04:03,825][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 09:04:19,170][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 09:04:37,253][root][INFO] - Inference complete
[2025-02-21 09:04:37,253][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,260][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,276][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,292][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,292][root][INFO] - Saved parsed outputs
[2025-02-21 09:04:37,292][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,334][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,334][root][INFO] - Saved parsing metadata
[2025-02-21 09:04:37,335][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,336][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:04:37,353][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 09:04:37,381][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 09:04:37,381][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.21, 'malformed_label': 0, 'malformed_domain': 65, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.05, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.08, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.05, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 14, 'correct_label_wrong_domain': 36, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '10', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 10 to status completed with exit code 0
Eval status update completed for job 10
Job 10 completed at Fri Feb 21 09:04:38 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n515
Job ID: 25309345
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 10:07:02
CPU Efficiency: 9.91% of 4-06:02:40 core-walltime
Job Wall-clock time: 10:12:16
Memory Utilized: 35.43 GB
Memory Efficiency: 98.42% of 36.00 GB
