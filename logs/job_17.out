Starting job 17 at Thu Mar  6 10:16:19 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_10_samples prompt=json_answer_first_few_shot_structured train=json_answer_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '17', 'training']
Updating job 17 to status training with exit code None
Status update completed for job 17
[2025-03-06 10:16:35,353][root][INFO] - Global seed set to 314
[2025-03-06 10:16:35,354][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 10:16:35,354][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 10:16:35,354][root][INFO] - Running Fine-tuning on the all_domains_10_samples dataset
[2025-03-06 10:16:35,355][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:16:35,355][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 10:16:35,375][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:16:35,380][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 10:16:35,380][root][INFO] - Questions selected, dataset contains 70 questions with 10.0 questions per domain
[2025-03-06 10:16:35,415][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 10:16:35,854][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:16:49,124][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:17:22,488][root][INFO] - Model prepared for kbit training
[2025-03-06 10:17:22,489][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'down_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'k_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 10:17:24,265][root][INFO] - Lora adapter added to model
[2025-03-06 10:17:24,269][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_10_samples/llama2_json_answer_first_few_shot_structured
[2025-03-06 10:17:24,535][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4097, 'grad_norm': 0.14121116697788239, 'learning_rate': 2e-05, 'epoch': 0.3}
{'loss': 1.4114, 'grad_norm': 0.15125133097171783, 'learning_rate': 4e-05, 'epoch': 0.6}
{'loss': 1.3697, 'grad_norm': 0.15830408036708832, 'learning_rate': 6e-05, 'epoch': 0.9}
{'loss': 1.2174, 'grad_norm': 0.18731334805488586, 'learning_rate': 8e-05, 'epoch': 1.2}
{'loss': 1.0691, 'grad_norm': 0.2252679020166397, 'learning_rate': 0.0001, 'epoch': 1.5}
{'loss': 0.7804, 'grad_norm': 0.3033406734466553, 'learning_rate': 9.951340343707852e-05, 'epoch': 1.8}
{'loss': 0.581, 'grad_norm': 0.23101863265037537, 'learning_rate': 9.806308479691595e-05, 'epoch': 2.1}
{'loss': 0.4719, 'grad_norm': 0.28288596868515015, 'learning_rate': 9.567727288213005e-05, 'epoch': 2.4}
{'loss': 0.4181, 'grad_norm': 0.13353395462036133, 'learning_rate': 9.24024048078213e-05, 'epoch': 2.7}
{'loss': 0.4004, 'grad_norm': 0.09798631072044373, 'learning_rate': 8.83022221559489e-05, 'epoch': 3.0}
{'loss': 0.4038, 'grad_norm': 0.07868079841136932, 'learning_rate': 8.345653031794292e-05, 'epoch': 3.3}
{'loss': 0.3704, 'grad_norm': 0.10515535622835159, 'learning_rate': 7.795964517353735e-05, 'epoch': 3.6}
{'loss': 0.3543, 'grad_norm': 0.09236752241849899, 'learning_rate': 7.191855733945387e-05, 'epoch': 3.9}
{'loss': 0.349, 'grad_norm': 0.06822896003723145, 'learning_rate': 6.545084971874738e-05, 'epoch': 4.2}
{'loss': 0.3488, 'grad_norm': 0.0683840662240982, 'learning_rate': 5.868240888334653e-05, 'epoch': 4.5}
{'loss': 0.334, 'grad_norm': 0.08544173836708069, 'learning_rate': 5.174497483512506e-05, 'epoch': 4.8}
{'loss': 0.3282, 'grad_norm': 0.06821088492870331, 'learning_rate': 4.477357683661734e-05, 'epoch': 5.1}
{'loss': 0.329, 'grad_norm': 0.07561754435300827, 'learning_rate': 3.790390522001662e-05, 'epoch': 5.4}
{'loss': 0.3199, 'grad_norm': 0.07741124927997589, 'learning_rate': 3.12696703292044e-05, 'epoch': 5.7}
{'loss': 0.3515, 'grad_norm': 0.07731564342975616, 'learning_rate': 2.500000000000001e-05, 'epoch': 6.0}
{'loss': 0.309, 'grad_norm': 0.07640738785266876, 'learning_rate': 1.9216926233717085e-05, 'epoch': 6.3}
{'loss': 0.3069, 'grad_norm': 0.07860065996646881, 'learning_rate': 1.4033009983067452e-05, 'epoch': 6.6}
{'loss': 0.343, 'grad_norm': 0.0811915397644043, 'learning_rate': 9.549150281252633e-06, 'epoch': 6.9}
{'loss': 0.3197, 'grad_norm': 0.08256366103887558, 'learning_rate': 5.852620357053651e-06, 'epoch': 7.2}
{'loss': 0.3175, 'grad_norm': 0.08451709151268005, 'learning_rate': 3.0153689607045845e-06, 'epoch': 7.5}
{'loss': 0.3127, 'grad_norm': 0.08483395725488663, 'learning_rate': 1.0926199633097157e-06, 'epoch': 7.8}
{'loss': 0.3003, 'grad_norm': 0.10204336792230606, 'learning_rate': 1.2179748700879012e-07, 'epoch': 8.1}
{'loss': 0.3307, 'grad_norm': 0.08666059374809265, 'learning_rate': 9.987820251299122e-05, 'epoch': 8.4}
{'loss': 0.2922, 'grad_norm': 0.10450495779514313, 'learning_rate': 9.890738003669029e-05, 'epoch': 8.7}
{'loss': 0.2962, 'grad_norm': 0.09725654125213623, 'learning_rate': 9.698463103929542e-05, 'epoch': 9.0}
{'loss': 0.2638, 'grad_norm': 0.13614585995674133, 'learning_rate': 9.414737964294636e-05, 'epoch': 9.3}
{'loss': 0.2696, 'grad_norm': 0.15153636038303375, 'learning_rate': 9.045084971874738e-05, 'epoch': 9.6}
{'loss': 0.2422, 'grad_norm': 0.1468278467655182, 'learning_rate': 8.596699001693255e-05, 'epoch': 9.9}
{'loss': 0.1992, 'grad_norm': 0.1573629379272461, 'learning_rate': 8.07830737662829e-05, 'epoch': 10.2}
{'loss': 0.1829, 'grad_norm': 0.18487924337387085, 'learning_rate': 7.500000000000002e-05, 'epoch': 10.5}
{'loss': 0.1832, 'grad_norm': 0.23259955644607544, 'learning_rate': 6.873032967079561e-05, 'epoch': 10.8}
{'loss': 0.1817, 'grad_norm': 0.24111336469650269, 'learning_rate': 6.209609477998338e-05, 'epoch': 11.1}
{'loss': 0.1047, 'grad_norm': 0.27142471075057983, 'learning_rate': 5.52264231633827e-05, 'epoch': 11.4}
{'loss': 0.1429, 'grad_norm': 0.2076766937971115, 'learning_rate': 4.825502516487497e-05, 'epoch': 11.7}
{'loss': 0.1191, 'grad_norm': 0.2043832391500473, 'learning_rate': 4.131759111665349e-05, 'epoch': 12.0}
{'loss': 0.0876, 'grad_norm': 0.2759154140949249, 'learning_rate': 3.454915028125262e-05, 'epoch': 12.3}
{'loss': 0.0687, 'grad_norm': 0.28275808691978455, 'learning_rate': 2.8081442660546142e-05, 'epoch': 12.6}
{'loss': 0.0752, 'grad_norm': 0.23624828457832336, 'learning_rate': 2.2040354826462668e-05, 'epoch': 12.9}
{'loss': 0.0718, 'grad_norm': 0.19498538970947266, 'learning_rate': 1.654346968205709e-05, 'epoch': 13.2}
{'loss': 0.0469, 'grad_norm': 0.17889976501464844, 'learning_rate': 1.1697777844051105e-05, 'epoch': 13.5}
{'loss': 0.0605, 'grad_norm': 0.2501848340034485, 'learning_rate': 7.597595192178702e-06, 'epoch': 13.8}
{'loss': 0.048, 'grad_norm': 0.1819952130317688, 'learning_rate': 4.322727117869951e-06, 'epoch': 14.1}
{'loss': 0.0417, 'grad_norm': 0.14693893492221832, 'learning_rate': 1.93691520308405e-06, 'epoch': 14.4}
{'loss': 0.0387, 'grad_norm': 0.15451186895370483, 'learning_rate': 4.865965629214875e-07, 'epoch': 14.7}
{'loss': 0.042, 'grad_norm': 0.15952534973621368, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 3665.8056, 'train_samples_per_second': 0.286, 'train_steps_per_second': 0.041, 'train_loss': 0.36432472119728726, 'epoch': 15.0}
[2025-03-06 11:18:33,952][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_10_samples/llama2_json_answer_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '17', 'trained', '0']
Updating job 17 to status trained with exit code 0
Status update completed for job 17
Starting evaluations for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 11:18:44,366][root][INFO] - Setting global seed to 206
[2025-03-06 11:18:44,371][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:18:44,371][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:18:44,373][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:18:44,374][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:18:44,376][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:18:44,376][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:18:44,535][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:18:44,842][root][INFO] - Full model selected, loading model
[2025-03-06 11:19:03,195][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:20:11,197][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:20:11,197][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:20:37,622][root][INFO] - Peft model loaded successfully
[2025-03-06 11:20:43,928][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:20:43,930][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 11:20:43,930][root][INFO] - Starting inference
[2025-03-06 11:20:44,163][root][INFO] - Processing question number 0
[2025-03-06 11:20:44,165][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:21:14,446][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:21:45,559][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:22:16,204][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:22:47,316][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:23:17,898][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:23:48,480][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:24:20,048][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:24:51,092][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:25:21,686][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:25:52,969][root][INFO] - Processing question number 10
[2025-03-06 11:25:52,971][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:26:25,669][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:26:56,065][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:27:26,904][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:27:58,309][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:28:29,701][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:29:00,095][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:29:30,343][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:30:01,125][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:30:31,867][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:31:02,345][root][INFO] - Processing question number 20
[2025-03-06 11:31:02,348][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:31:33,030][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:32:03,957][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:32:34,305][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:33:04,602][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:33:35,615][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:34:06,431][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:34:38,002][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:35:08,767][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:35:39,663][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:36:09,841][root][INFO] - Processing question number 30
[2025-03-06 11:36:09,844][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:36:40,922][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:37:12,348][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:37:43,225][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:38:13,890][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:38:44,461][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:39:15,813][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:39:46,435][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:40:17,493][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:40:48,350][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:41:19,944][root][INFO] - Processing question number 40
[2025-03-06 11:41:19,947][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:41:50,969][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:42:21,996][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:42:53,407][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:43:24,784][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:43:55,364][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:44:26,238][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:44:58,416][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:45:28,374][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:45:59,140][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:46:30,586][root][INFO] - Processing question number 50
[2025-03-06 11:46:30,590][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:47:02,234][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:47:33,234][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:48:03,427][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:48:35,357][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:49:06,327][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:49:36,324][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:50:07,901][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:50:38,311][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:51:09,752][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:51:41,977][root][INFO] - Processing question number 60
[2025-03-06 11:51:41,982][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:52:12,349][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:52:43,021][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:53:14,401][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:53:44,761][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:54:15,680][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:54:46,731][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:55:17,789][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:55:49,201][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:56:20,309][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:56:51,982][root][INFO] - Processing question number 70
[2025-03-06 11:56:51,987][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:57:22,718][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:57:53,446][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:58:23,996][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:58:55,229][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:59:26,326][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:59:56,771][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:00:28,079][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:00:59,120][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:01:30,424][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:02:01,069][root][INFO] - Processing question number 80
[2025-03-06 12:02:01,075][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:02:32,136][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:03:03,224][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:03:33,826][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:04:04,424][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:04:35,862][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:05:07,114][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:05:38,430][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:06:09,018][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:06:40,061][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:07:10,432][root][INFO] - Processing question number 90
[2025-03-06 12:07:10,438][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:07:42,225][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:08:12,093][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:08:42,853][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:09:12,865][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:09:44,160][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:10:14,510][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:10:45,120][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:11:16,080][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:11:47,539][root][INFO] - Inference complete
[2025-03-06 12:11:47,540][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,547][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,548][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,548][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,549][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,549][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,549][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,550][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,550][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,550][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,551][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,551][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,551][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,551][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,552][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,552][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,552][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,552][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,552][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,553][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,553][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,553][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,553][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,553][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,554][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,554][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,554][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,554][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,554][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,555][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,555][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,555][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,555][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,556][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,556][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,556][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,556][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,557][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,557][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,557][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,557][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,557][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,558][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,558][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,558][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,558][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,559][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,559][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,559][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,559][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,559][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,559][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,560][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,560][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,560][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,560][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,560][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,561][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,561][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,561][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,561][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,561][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,562][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,562][root][WARNING] - |Q. 8||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,562][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,562][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,562][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,562][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,563][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,563][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,564][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,564][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,564][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,564][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,564][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,565][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,565][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,565][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,565][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,565][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,565][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,566][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,566][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,566][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,566][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,566][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,566][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,567][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,567][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,567][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,567][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,567][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,567][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,568][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,568][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,568][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,568][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,569][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,569][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,569][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,569][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,569][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,570][root][WARNING] - |Q. 82||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,570][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,570][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,570][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,570][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,570][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,571][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,571][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,571][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,571][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,571][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,572][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,572][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,572][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,573][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,573][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,573][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,574][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,574][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,574][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,575][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,575][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,575][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,575][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,575][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,575][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,576][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,576][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,576][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,576][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,576][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:47,576][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,577][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,577][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,577][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,577][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,578][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,578][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,578][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,579][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,579][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,579][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,579][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,579][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,580][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,580][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,580][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,581][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:47,581][root][WARNING] - |Q. 74||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:47,581][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:47,583][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,589][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,589][root][INFO] - Saved parsed outputs
[2025-03-06 12:11:47,589][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,590][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,590][root][INFO] - Saved parsing metadata
[2025-03-06 12:11:47,591][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,611][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:11:47,612][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:11:47,654][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 12:11:47,654][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 17, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.5625, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 2, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 12:12:00,052][root][INFO] - Setting global seed to 206
[2025-03-06 12:12:00,067][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:12:00,067][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:12:00,069][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:12:00,071][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:12:00,073][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:12:00,073][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:12:00,232][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:12:00,498][root][INFO] - Full model selected, loading model
[2025-03-06 12:12:18,481][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:13:25,811][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:13:25,811][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:13:52,439][root][INFO] - Peft model loaded successfully
[2025-03-06 12:13:58,766][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:13:58,768][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 12:13:58,768][root][INFO] - Starting inference
[2025-03-06 12:13:58,992][root][INFO] - Processing question number 0
[2025-03-06 12:13:58,994][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:14:29,532][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:15:00,784][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:15:31,609][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:16:02,902][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:16:33,645][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:17:04,320][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:17:35,832][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:18:06,861][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:18:37,500][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:19:08,789][root][INFO] - Processing question number 10
[2025-03-06 12:19:08,791][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:19:41,523][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:20:11,973][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:20:42,945][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:21:14,523][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:21:46,070][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:22:16,591][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:22:46,990][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:23:17,934][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:23:48,841][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:24:19,463][root][INFO] - Processing question number 20
[2025-03-06 12:24:19,465][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:24:50,399][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:25:21,748][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:25:52,381][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:26:22,982][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:26:54,241][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:27:25,349][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:27:57,131][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:28:28,039][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:28:59,080][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:29:29,423][root][INFO] - Processing question number 30
[2025-03-06 12:29:29,426][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:30:00,648][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:30:32,209][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:31:03,257][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:31:34,078][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:32:04,795][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:32:36,298][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:33:07,091][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:33:38,306][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:34:09,327][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:34:25,542][root][INFO] - Processing question number 40
[2025-03-06 12:34:25,546][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:34:56,626][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:35:27,703][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:35:59,281][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:36:03,480][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:36:34,218][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:37:05,259][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:37:37,591][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:38:07,708][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:38:38,638][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:39:10,253][root][INFO] - Processing question number 50
[2025-03-06 12:39:10,259][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:39:42,049][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:40:13,201][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:40:43,603][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:41:15,861][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:41:46,995][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:42:17,135][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:42:48,879][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:43:19,422][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:43:51,025][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:44:23,418][root][INFO] - Processing question number 60
[2025-03-06 12:44:23,423][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:44:53,956][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:45:24,804][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:45:56,346][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:46:26,869][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:46:57,888][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:47:28,983][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:48:00,077][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:48:31,525][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:49:02,704][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:49:34,397][root][INFO] - Processing question number 70
[2025-03-06 12:49:34,401][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:50:05,213][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:50:36,118][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:51:06,847][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:51:38,259][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:52:09,531][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:52:40,208][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:53:11,815][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:53:43,158][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:54:14,776][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:54:45,684][root][INFO] - Processing question number 80
[2025-03-06 12:54:45,690][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:55:17,089][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:55:48,387][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:56:19,116][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:56:49,895][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:57:21,493][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:57:52,912][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:58:24,389][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:58:55,118][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:59:26,336][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:59:56,842][root][INFO] - Processing question number 90
[2025-03-06 12:59:56,891][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:00:28,849][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:00:58,890][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:01:29,822][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:02:00,007][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:02:31,502][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:03:02,014][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:03:32,812][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:04:03,935][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:04:35,563][root][INFO] - Inference complete
[2025-03-06 13:04:35,564][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,579][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,580][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,580][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,580][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,581][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,581][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,582][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,582][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,582][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,582][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,583][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,583][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,583][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,583][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,584][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,584][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,584][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,584][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,584][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,585][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,585][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,585][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,585][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,585][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,585][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,586][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,586][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,586][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,586][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,587][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,587][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,587][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,587][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,587][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,588][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,588][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,588][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,588][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,589][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,589][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,589][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,589][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,589][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,590][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,590][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,590][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,590][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,591][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,591][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,591][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,591][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,591][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,591][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,592][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,592][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,592][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,592][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,592][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,593][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,593][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,593][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,593][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,593][root][WARNING] - |Q. 8||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,593][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,594][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,594][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,594][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,594][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,594][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,594][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,595][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,595][root][WARNING] - |Q. 51||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,595][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,596][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,596][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,596][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,596][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,596][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,596][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,597][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,597][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,597][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,597][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,597][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,598][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,598][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,598][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,598][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,598][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,598][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,598][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,599][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,599][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,599][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,599][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,599][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,600][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,600][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,600][root][WARNING] - |Q. 41||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,600][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,600][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,601][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,601][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,601][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,601][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,601][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,602][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,602][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,602][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,602][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,603][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,603][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,603][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,603][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,603][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,604][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,604][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,604][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,604][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,604][root][WARNING] - |Q. 18||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,604][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,605][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,605][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,605][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,605][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,605][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,605][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,606][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,606][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,606][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,607][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,607][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,607][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,608][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,608][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,608][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,608][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,609][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,609][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,609][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,609][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,609][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,609][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,610][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,610][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,610][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,610][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:04:35,610][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,611][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,611][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,611][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,611][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,611][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,611][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,612][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,612][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,612][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,613][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,613][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,613][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,613][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,613][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,613][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,614][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,614][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,614][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,614][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,614][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,614][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,615][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,615][root][WARNING] - |Q. 36||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,615][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,616][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:04:35,616][root][WARNING] - |Q. 64||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:04:35,616][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:04:35,617][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,633][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,633][root][INFO] - Saved parsed outputs
[2025-03-06 13:04:35,634][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,646][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,646][root][INFO] - Saved parsing metadata
[2025-03-06 13:04:35,646][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,648][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:04:35,657][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:04:35,678][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 13:04:35,678][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.26262626262626265, 'malformed_label': 16, 'malformed_domain': 24, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 2, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 13:04:52,048][root][INFO] - Setting global seed to 206
[2025-03-06 13:04:52,097][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:04:52,098][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:04:52,099][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:04:52,118][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:04:52,120][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:04:52,121][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:04:52,309][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:04:52,652][root][INFO] - Full model selected, loading model
[2025-03-06 13:05:11,836][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:06:19,477][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:06:19,478][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:06:46,234][root][INFO] - Peft model loaded successfully
[2025-03-06 13:06:52,586][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:06:52,587][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:06:52,587][root][INFO] - Starting inference
[2025-03-06 13:06:52,804][root][INFO] - Processing question number 0
[2025-03-06 13:06:52,825][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:07:23,224][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:07:54,480][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:08:25,304][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:08:56,588][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:09:27,329][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:09:58,091][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:10:29,858][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:11:00,894][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:11:31,552][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:12:02,852][root][INFO] - Processing question number 10
[2025-03-06 13:12:02,859][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:12:35,587][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:13:06,046][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:13:37,017][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:14:08,591][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:14:40,145][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:15:10,675][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:15:41,083][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:16:12,042][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:16:42,956][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:17:13,583][root][INFO] - Processing question number 20
[2025-03-06 13:17:13,594][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:17:44,438][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:18:15,519][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:18:46,024][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:19:16,469][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:19:47,639][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:20:18,576][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:20:50,296][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:21:21,205][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:21:52,239][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:22:22,632][root][INFO] - Processing question number 30
[2025-03-06 13:22:22,635][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:22:54,138][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:23:25,841][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:23:57,018][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:24:27,935][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:24:58,801][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:25:30,388][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:26:01,178][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:26:32,378][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:27:03,396][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:27:35,139][root][INFO] - Processing question number 40
[2025-03-06 13:27:35,143][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:28:06,207][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:28:37,270][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:29:08,834][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:29:40,346][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:30:11,074][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:30:42,109][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:31:14,430][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:31:44,549][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:32:15,474][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:32:47,079][root][INFO] - Processing question number 50
[2025-03-06 13:32:47,084][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:33:18,869][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:33:50,013][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:34:20,361][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:34:52,438][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:35:23,564][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:35:53,706][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:36:25,443][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:36:55,981][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:37:27,582][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:37:59,964][root][INFO] - Processing question number 60
[2025-03-06 13:37:59,969][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:38:30,493][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:39:01,329][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:39:32,931][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:40:03,563][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:40:34,582][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:41:05,652][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:41:36,732][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:42:08,154][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:42:39,315][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:43:10,998][root][INFO] - Processing question number 70
[2025-03-06 13:43:11,003][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:43:41,820][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:44:12,725][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:44:43,454][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:45:14,870][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:45:46,139][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:46:16,745][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:46:48,205][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:47:19,414][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:47:50,862][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:48:21,660][root][INFO] - Processing question number 80
[2025-03-06 13:48:21,665][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:48:52,902][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:49:24,120][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:49:54,842][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:50:25,611][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:50:57,194][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:51:28,677][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:52:00,323][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:52:31,177][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:53:02,513][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:53:33,125][root][INFO] - Processing question number 90
[2025-03-06 13:53:33,131][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:54:05,234][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:54:35,332][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:55:06,235][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:55:36,409][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:56:07,871][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:56:38,361][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:57:09,141][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:57:40,242][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:58:11,845][root][INFO] - Inference complete
[2025-03-06 13:58:11,846][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,854][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,855][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,855][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,855][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,855][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,856][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,856][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,856][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,856][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,857][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,858][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,858][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,858][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,858][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,859][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,859][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,859][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,859][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,859][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,860][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,860][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,860][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,860][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,861][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,861][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,861][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,861][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,861][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,861][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,862][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,862][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,862][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,862][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,862][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,863][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,863][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,863][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,863][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,863][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,864][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,864][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,864][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,864][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,865][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,865][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,865][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,865][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,865][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,866][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,866][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,866][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,866][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,867][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,867][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,867][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,867][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,868][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,868][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,868][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,868][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,868][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,869][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,869][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,869][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,870][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,870][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,870][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,870][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,870][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,870][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,870][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,871][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,871][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,871][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,871][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,871][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,871][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,872][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,872][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,872][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,872][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,872][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,873][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,873][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,873][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,874][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,874][root][WARNING] - |Q. 90||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,874][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,875][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,875][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,875][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,875][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,875][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,875][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,876][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,876][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,876][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,877][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,877][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,877][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,878][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,878][root][WARNING] - |Q. 78||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,878][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,879][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,879][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,879][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,879][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,879][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,879][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,880][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,880][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,880][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,880][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,881][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,881][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,881][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,881][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,881][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,882][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,882][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,882][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,882][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,882][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,883][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,883][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,883][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,883][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,883][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,883][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,884][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,884][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,884][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,884][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,884][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,884][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,885][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,885][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,885][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:58:11,885][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,886][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:58:11,887][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:58:11,887][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:58:11,888][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,894][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,894][root][INFO] - Saved parsed outputs
[2025-03-06 13:58:11,894][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,895][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,895][root][INFO] - Saved parsing metadata
[2025-03-06 13:58:11,896][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,898][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 13:58:11,899][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:58:11,919][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 13:58:11,919][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 12, 'malformed_domain': 20, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.5625, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.15151515151515152, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 4, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 13:58:21,101][root][INFO] - Setting global seed to 989
[2025-03-06 13:58:21,109][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:58:21,109][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:58:21,110][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:58:21,112][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:58:21,114][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:58:21,114][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:58:21,259][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:58:21,697][root][INFO] - Full model selected, loading model
[2025-03-06 13:58:40,901][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:59:47,125][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:59:47,125][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:00:14,909][root][INFO] - Peft model loaded successfully
[2025-03-06 14:00:21,241][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:00:21,243][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:00:21,243][root][INFO] - Starting inference
[2025-03-06 14:00:21,447][root][INFO] - Processing question number 0
[2025-03-06 14:00:21,449][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:00:51,547][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:01:22,595][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:01:53,222][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:02:24,312][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:02:54,855][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:03:25,352][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:03:56,668][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:04:27,495][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:04:57,949][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:05:29,043][root][INFO] - Processing question number 10
[2025-03-06 14:05:29,045][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:06:01,567][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:06:31,828][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:07:02,630][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:07:34,001][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:08:05,365][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:08:35,685][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:09:05,886][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:09:36,624][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:10:07,444][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:10:38,021][root][INFO] - Processing question number 20
[2025-03-06 14:10:38,023][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:11:08,655][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:11:39,533][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:12:09,845][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:12:40,073][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:13:11,027][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:13:41,767][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:14:13,281][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:14:43,978][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:15:14,801][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:15:44,930][root][INFO] - Processing question number 30
[2025-03-06 14:15:44,933][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:16:15,958][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:16:47,307][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:17:18,129][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:17:48,742][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:18:19,260][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:18:50,552][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:19:21,129][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:19:52,128][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:20:22,955][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:20:54,501][root][INFO] - Processing question number 40
[2025-03-06 14:20:54,504][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:21:25,379][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:21:56,315][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:22:27,897][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:22:59,330][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:23:29,996][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:24:00,914][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:24:33,182][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:25:03,180][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:25:33,892][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:26:05,300][root][INFO] - Processing question number 50
[2025-03-06 14:26:05,304][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:26:36,894][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:27:07,844][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:27:38,000][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:28:09,886][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:28:40,804][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:29:10,752][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:29:42,289][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:30:12,632][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:30:44,041][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:31:16,228][root][INFO] - Processing question number 60
[2025-03-06 14:31:16,233][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:31:46,551][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:32:17,186][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:32:48,515][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:33:18,819][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:33:49,620][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:34:20,468][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:34:51,345][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:35:22,570][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:35:53,541][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:36:25,019][root][INFO] - Processing question number 70
[2025-03-06 14:36:25,024][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:36:55,626][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:37:26,300][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:37:56,800][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:38:27,988][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:38:59,045][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:39:29,442][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:40:00,825][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:40:31,888][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:41:03,138][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:41:33,738][root][INFO] - Processing question number 80
[2025-03-06 14:41:33,743][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:42:04,778][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:42:35,790][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:43:06,311][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:43:36,869][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:44:08,252][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:44:39,449][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:45:10,704][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:45:41,223][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:46:12,197][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:46:42,496][root][INFO] - Processing question number 90
[2025-03-06 14:46:42,502][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:47:14,252][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:47:44,061][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:48:14,769][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:48:44,738][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:49:15,999][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:49:46,289][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:50:16,860][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:50:47,763][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:51:19,171][root][INFO] - Inference complete
[2025-03-06 14:51:19,171][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,178][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,179][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,179][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,179][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,180][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,180][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,181][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,181][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,181][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,181][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,182][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,182][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,182][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,182][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,183][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,183][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,183][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,183][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,183][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,184][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,184][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,184][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,184][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,184][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,184][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,185][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,185][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,185][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,185][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,186][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,186][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,186][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,186][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,186][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,187][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,187][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,187][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,188][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,188][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,188][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,188][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,188][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,188][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,189][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,189][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,189][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,189][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,190][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,190][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,190][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,190][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,190][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,190][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,191][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,191][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,191][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,191][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,191][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,192][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,192][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,192][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,192][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,192][root][WARNING] - |Q. 8||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,193][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,193][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,193][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,193][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,194][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,194][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,194][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,195][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,195][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,195][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,195][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,195][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,195][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,196][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,196][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,196][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,196][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,196][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,197][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,197][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,197][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,197][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,197][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,198][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,198][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,198][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,198][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,198][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,198][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,198][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,199][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,199][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,199][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,199][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,200][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,200][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,200][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,200][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,200][root][WARNING] - |Q. 82||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,200][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,201][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,201][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,201][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,201][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,201][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,202][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,202][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,202][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,202][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,203][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,203][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,203][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,204][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,204][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,204][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,204][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,205][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,205][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,205][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,206][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,206][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,206][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,206][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,206][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,206][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,207][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,207][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,207][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,207][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:51:19,207][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,207][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,208][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,208][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,208][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,208][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,209][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,209][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,209][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,209][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,210][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,210][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,210][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,210][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,211][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,211][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,212][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:51:19,212][root][WARNING] - |Q. 74||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:51:19,212][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:51:19,213][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,219][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,220][root][INFO] - Saved parsed outputs
[2025-03-06 14:51:19,220][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,221][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,221][root][INFO] - Saved parsing metadata
[2025-03-06 14:51:19,222][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,223][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:51:19,224][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:51:19,241][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 14:51:19,241][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.29292929292929293, 'malformed_label': 17, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 29, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.5625, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 2, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 14:51:28,033][root][INFO] - Setting global seed to 989
[2025-03-06 14:51:28,040][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 14:51:28,041][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:51:28,042][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:51:28,053][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:51:28,055][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:51:28,056][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:51:28,218][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:51:28,494][root][INFO] - Full model selected, loading model
[2025-03-06 14:51:48,666][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:52:56,017][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:52:56,017][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:53:23,707][root][INFO] - Peft model loaded successfully
[2025-03-06 14:53:30,099][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:53:30,101][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 14:53:30,101][root][INFO] - Starting inference
[2025-03-06 14:53:30,363][root][INFO] - Processing question number 0
[2025-03-06 14:53:30,365][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:54:01,093][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:54:32,495][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:55:03,301][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:55:34,559][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:56:05,260][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:56:35,910][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:57:07,408][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:57:38,398][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:58:09,012][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:58:40,277][root][INFO] - Processing question number 10
[2025-03-06 14:58:40,279][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:59:12,976][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:59:43,408][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:00:14,347][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:00:45,897][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:01:17,421][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:01:47,917][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:02:18,275][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:02:49,196][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:03:20,096][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:03:50,702][root][INFO] - Processing question number 20
[2025-03-06 15:03:50,712][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:04:21,534][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:04:52,585][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:05:23,076][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:05:53,501][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:06:24,643][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:06:55,576][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:07:27,290][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:07:58,188][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:08:29,215][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:08:59,635][root][INFO] - Processing question number 30
[2025-03-06 15:08:59,650][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:09:30,997][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:10:02,538][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:10:33,550][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:11:04,343][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:11:35,034][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:12:06,506][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:12:37,271][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:13:08,474][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:13:39,467][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:14:11,188][root][INFO] - Processing question number 40
[2025-03-06 15:14:11,192][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:14:42,248][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:15:13,297][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:15:44,842][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:16:16,337][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:16:47,047][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:17:18,057][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:17:50,366][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:18:20,459][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:18:51,362][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:19:22,958][root][INFO] - Processing question number 50
[2025-03-06 15:19:22,968][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:19:54,740][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:20:25,867][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:20:56,300][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:21:28,504][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:21:59,713][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:22:30,005][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:23:01,839][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:23:32,545][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:24:04,160][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:24:36,543][root][INFO] - Processing question number 60
[2025-03-06 15:24:36,548][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:25:07,063][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:25:37,881][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:25:51,336][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:26:21,816][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:26:52,808][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:27:23,857][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:27:54,926][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:28:26,344][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:28:57,495][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:29:29,189][root][INFO] - Processing question number 70
[2025-03-06 15:29:29,254][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:30:00,054][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:30:30,949][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:31:01,682][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:31:33,085][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:32:04,338][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:32:34,923][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:33:06,359][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:33:37,544][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:34:08,987][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:34:39,762][root][INFO] - Processing question number 80
[2025-03-06 15:34:39,772][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:35:10,980][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:35:42,191][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:36:12,901][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:36:43,656][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:37:15,243][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:37:46,650][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:38:18,110][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:38:48,913][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:39:20,226][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:39:50,714][root][INFO] - Processing question number 90
[2025-03-06 15:39:50,720][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:40:22,649][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:40:52,653][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:41:23,540][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:41:53,696][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:42:25,153][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:42:55,621][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:43:26,387][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:43:57,479][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:44:29,077][root][INFO] - Inference complete
[2025-03-06 15:44:29,078][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,088][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,089][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,089][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,089][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,090][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,090][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,091][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,091][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,091][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,091][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,092][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,092][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,092][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,092][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,093][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,093][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,093][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,093][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,093][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,093][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,094][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,094][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,094][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,094][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,094][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,095][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,095][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,095][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,096][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,096][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,096][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,096][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,096][root][WARNING] - |Q. 9||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,097][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,097][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,097][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,097][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,098][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,098][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,098][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,098][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,099][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,099][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,099][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,099][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,099][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,100][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,100][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,100][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,100][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,100][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,100][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,101][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,101][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,101][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,101][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,101][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,101][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,102][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,102][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,102][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,102][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,103][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,103][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,103][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,103][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,104][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,104][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,104][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,105][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,105][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,105][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,105][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,105][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,105][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,106][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,106][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,106][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,106][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,107][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,107][root][WARNING] - |Q. 41||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,107][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,107][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,107][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,108][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,108][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,108][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,108][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,109][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,109][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,109][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,110][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,110][root][WARNING] - |Q. 18||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,110][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,110][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,111][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,111][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,111][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,111][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,111][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,112][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,112][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,112][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,112][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,113][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,113][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,113][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,114][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,114][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,114][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,114][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,115][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,115][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,115][root][WARNING] - |Q. 48||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,115][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,115][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,115][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,116][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,116][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,116][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,116][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,116][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,117][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,117][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,117][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,117][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,117][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,118][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,118][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,118][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,118][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,118][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,118][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,119][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,119][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,119][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,120][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,120][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,120][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,120][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,121][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,121][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,121][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,121][root][WARNING] - |Q. 74||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:44:29,121][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,122][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:44:29,122][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:44:29,122][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:44:29,123][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,129][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,129][root][INFO] - Saved parsed outputs
[2025-03-06 15:44:29,129][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,131][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,131][root][INFO] - Saved parsing metadata
[2025-03-06 15:44:29,132][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,149][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:44:29,151][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:44:29,165][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 15:44:29,165][root][INFO] - Summary of metrics : {'label_accuracy': 0.25252525252525254, 'misclassification_rate': 0.7474747474747474, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 12, 'malformed_domain': 21, 'total_predictions': 99, 'correct_predictions': 25, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 56, 'correct_label_wrong_domain': 3, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 15:44:38,004][root][INFO] - Setting global seed to 989
[2025-03-06 15:44:38,012][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 15:44:38,012][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:44:38,014][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:44:38,016][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:44:38,018][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:44:38,018][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:44:38,178][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:44:38,445][root][INFO] - Full model selected, loading model
[2025-03-06 15:44:56,874][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:46:03,762][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:46:03,762][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:46:31,622][root][INFO] - Peft model loaded successfully
[2025-03-06 15:46:38,007][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:46:38,009][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 15:46:38,010][root][INFO] - Starting inference
[2025-03-06 15:46:38,242][root][INFO] - Processing question number 0
[2025-03-06 15:46:38,244][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:47:08,694][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:47:39,955][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:48:10,781][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:48:42,084][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:49:12,830][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:49:43,533][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:50:15,072][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:50:46,123][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:51:16,959][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:51:48,417][root][INFO] - Processing question number 10
[2025-03-06 15:51:48,426][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:52:21,259][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:52:51,883][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:53:22,942][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:53:54,707][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:54:26,271][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:54:56,808][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:55:27,198][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:55:58,155][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:56:29,076][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:56:59,742][root][INFO] - Processing question number 20
[2025-03-06 15:56:59,824][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:57:30,692][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:58:01,801][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:58:32,340][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:59:02,794][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:59:33,965][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:00:04,921][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:00:36,653][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:01:07,572][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:01:38,631][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:02:08,981][root][INFO] - Processing question number 30
[2025-03-06 16:02:08,984][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:02:40,224][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:03:11,811][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:03:42,865][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:04:13,699][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:04:44,433][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:05:15,971][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:05:46,786][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:06:18,010][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:06:49,041][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:07:20,788][root][INFO] - Processing question number 40
[2025-03-06 16:07:20,808][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:07:51,899][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:08:22,986][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 16:08:54,560][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 16:09:26,137][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 16:09:57,052][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:10:28,094][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 16:11:00,422][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:11:30,553][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 16:12:01,482][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 16:12:33,092][root][INFO] - Processing question number 50
[2025-03-06 16:12:33,096][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:13:04,888][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:13:36,040][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:14:06,383][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:14:38,476][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:15:09,621][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:15:39,769][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:16:11,532][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:16:42,098][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:17:13,711][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:17:46,103][root][INFO] - Processing question number 60
[2025-03-06 16:17:46,116][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:18:16,658][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:18:47,497][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:19:19,024][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:19:49,535][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:20:20,542][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:20:51,612][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:21:22,726][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:21:54,267][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:22:25,456][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:22:57,152][root][INFO] - Processing question number 70
[2025-03-06 16:22:57,174][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:23:27,989][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:23:59,010][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:24:29,966][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:25:01,778][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:25:33,142][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:26:03,844][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:26:35,423][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:27:06,742][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:27:38,314][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:28:09,224][root][INFO] - Processing question number 80
[2025-03-06 16:28:09,230][root][INFO] - Domain : Property, Question : 67
[2025-03-06 16:28:40,573][root][INFO] - Domain : Property, Question : 75
[2025-03-06 16:29:11,932][root][INFO] - Domain : Property, Question : 83
[2025-03-06 16:29:42,774][root][INFO] - Domain : Property, Question : 89
[2025-03-06 16:30:13,653][root][INFO] - Domain : Property, Question : 97
[2025-03-06 16:30:45,345][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:31:16,860][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 16:31:48,429][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:32:19,262][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:32:50,569][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:33:21,160][root][INFO] - Processing question number 90
[2025-03-06 16:33:21,166][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:33:53,208][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:34:23,319][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:34:54,315][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:35:24,576][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:35:56,161][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:36:26,758][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:36:57,642][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:37:28,854][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:38:00,567][root][INFO] - Inference complete
[2025-03-06 16:38:00,568][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,576][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,577][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,578][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,578][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,578][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,579][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,579][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,579][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,579][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,579][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,580][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,580][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:38:00,581][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,581][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,581][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,581][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,582][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,582][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,582][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,582][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,582][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,582][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,583][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,583][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,583][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,583][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,583][root][WARNING] - |Q. 56||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,583][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,584][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,584][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,584][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,585][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,585][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,585][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,585][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,585][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,585][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,586][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,586][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,586][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,587][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,587][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,587][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,587][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,588][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,588][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,588][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,588][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,588][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,588][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,589][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,589][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,589][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,589][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:38:00,590][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,590][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,590][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,590][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,590][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,591][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,591][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,591][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,591][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,591][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,592][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,592][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,592][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,592][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,592][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,593][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,593][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,593][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,593][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,594][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,594][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,594][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,594][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,595][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,595][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,595][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,595][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,595][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,596][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,596][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,596][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,596][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,596][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,597][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,597][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,597][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,597][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,598][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,598][root][WARNING] - |Q. 41||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,598][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,599][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,599][root][WARNING] - |Q. 82||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,599][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,599][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,600][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,600][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,600][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,601][root][WARNING] - |Q. 18||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,601][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,601][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,601][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:38:00,601][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,602][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,602][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,602][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,602][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,602][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,602][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,603][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,603][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,603][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,604][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,604][root][WARNING] - |Q. 86||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,604][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,605][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,605][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,605][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,605][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,605][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,605][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,606][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,606][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:38:00,606][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,606][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,606][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,607][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,607][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,607][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:38:00,607][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,608][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,608][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,608][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,609][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,609][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,609][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,609][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,610][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,610][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,610][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,611][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,611][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,611][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:38:00,612][root][WARNING] - |Q. 80||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:38:00,612][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:38:00,613][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,619][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,620][root][INFO] - Saved parsed outputs
[2025-03-06 16:38:00,620][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,621][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,621][root][INFO] - Saved parsing metadata
[2025-03-06 16:38:00,622][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,624][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
[2025-03-06 16:38:00,625][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:38:00,670][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_1
[2025-03-06 16:38:00,670][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.26262626262626265, 'malformed_label': 8, 'malformed_domain': 17, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.15151515151515152, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 56, 'correct_label_wrong_domain': 3, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 16:38:22,392][root][INFO] - Setting global seed to 206
[2025-03-06 16:38:22,458][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:38:22,458][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:38:22,460][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:38:22,462][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:38:22,469][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:38:22,469][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:38:22,633][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:38:22,954][root][INFO] - Full model selected, loading model
[2025-03-06 16:38:41,756][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:39:50,455][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:39:50,456][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:40:19,073][root][INFO] - Peft model loaded successfully
[2025-03-06 16:40:25,486][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:40:25,488][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 16:40:25,488][root][INFO] - Starting inference
[2025-03-06 16:40:25,738][root][INFO] - Processing question number 0
[2025-03-06 16:40:25,740][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:40:57,190][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:41:28,853][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:42:00,655][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:42:32,014][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:43:02,710][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:43:32,874][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:44:03,553][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:44:34,528][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:45:04,777][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:45:35,653][root][INFO] - Processing question number 10
[2025-03-06 16:45:35,655][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:46:05,739][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:46:36,387][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:47:07,189][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:47:37,446][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:48:08,622][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:48:39,477][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:49:10,229][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:49:40,865][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:50:12,035][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:50:43,376][root][INFO] - Processing question number 20
[2025-03-06 16:50:43,380][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:51:13,505][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:51:44,490][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:52:15,007][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:52:45,670][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:53:16,404][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:53:47,742][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:54:18,564][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:54:49,555][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:55:20,370][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:55:51,830][root][INFO] - Processing question number 30
[2025-03-06 16:55:51,834][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:56:22,699][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:56:53,363][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:57:24,003][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:57:55,415][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:58:26,157][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:58:57,035][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:59:27,863][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:59:59,367][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:00:30,381][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:01:01,438][root][INFO] - Processing question number 40
[2025-03-06 17:01:01,441][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:01:32,419][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:02:03,170][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:02:34,523][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:03:04,689][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:03:36,228][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:04:07,219][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:04:38,037][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:05:09,027][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:05:39,917][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:06:11,124][root][INFO] - Processing question number 50
[2025-03-06 17:06:11,128][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:06:42,650][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:07:13,073][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:07:44,597][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:08:15,698][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:08:46,195][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:08:50,257][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:09:21,909][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:09:53,335][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:10:24,763][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:10:55,911][root][INFO] - Processing question number 60
[2025-03-06 17:10:55,916][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:11:26,867][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:11:57,865][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:12:29,588][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:13:00,778][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:13:31,923][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:14:02,563][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:14:33,005][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:15:03,271][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:15:33,871][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:16:04,405][root][INFO] - Processing question number 70
[2025-03-06 17:16:04,410][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:16:35,530][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:17:06,544][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:17:37,743][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:18:09,468][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:18:40,005][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:19:11,164][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:19:43,369][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:20:14,541][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:20:44,725][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:21:15,325][root][INFO] - Processing question number 80
[2025-03-06 17:21:15,331][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:21:46,859][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:22:18,425][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:22:49,896][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:23:21,021][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:23:53,103][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:24:23,810][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:24:55,165][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:25:27,023][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:25:58,050][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:26:29,072][root][INFO] - Processing question number 90
[2025-03-06 17:26:29,078][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:27:00,131][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:27:31,547][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:28:02,695][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:28:33,657][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:29:05,294][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:29:20,776][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:29:51,952][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:30:22,712][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:30:53,021][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:31:24,596][root][INFO] - Inference complete
[2025-03-06 17:31:24,596][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,607][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,608][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,609][root][WARNING] - |Q. 1||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,609][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,609][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,609][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,610][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,610][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,610][root][WARNING] - |Q. 27||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,611][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,611][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,611][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,612][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,612][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,612][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,612][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,613][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,613][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,613][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,613][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,614][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,614][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,614][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,614][root][WARNING] - |Q. 21||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,614][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,615][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,615][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,615][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,616][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,616][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,617][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,617][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,617][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,617][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,618][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,618][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,619][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,619][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,619][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,619][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,620][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,620][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,620][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,620][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,621][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,621][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,621][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,621][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,621][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,622][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,622][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,622][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,622][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,622][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,623][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,623][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,623][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,623][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,624][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,624][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,624][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,625][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,625][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,625][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,626][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,626][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,626][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,626][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,626][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,626][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,627][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,627][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,627][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,627][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,627][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,627][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,628][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,628][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,628][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,628][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,628][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,629][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,629][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,629][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,629][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,630][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,630][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,630][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,630][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,631][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,631][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,631][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,631][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,631][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,631][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,632][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,632][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,632][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,632][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,632][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,633][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,633][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,633][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,633][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,633][root][WARNING] - |Q. 46||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,633][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,634][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,634][root][WARNING] - |Q. 66||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,634][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,634][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,635][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,635][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,635][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,635][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,635][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,636][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,636][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,636][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,637][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,637][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,637][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,637][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,637][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,637][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,638][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,638][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,638][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,638][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,638][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,639][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,639][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,639][root][WARNING] - |Q. 57||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,639][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,640][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,640][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,640][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,640][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,640][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,640][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,641][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,641][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,641][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,641][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,641][root][WARNING] - |Q. 79||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:24,641][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,642][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:24,642][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:24,642][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:24,643][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,649][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,649][root][INFO] - Saved parsed outputs
[2025-03-06 17:31:24,649][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,651][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,651][root][INFO] - Saved parsing metadata
[2025-03-06 17:31:24,652][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,654][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:31:24,656][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:31:24,714][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 17:31:24,714][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.22, 'malformed_label': 13, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 52, 'correct_label_wrong_domain': 6, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 17:31:32,525][root][INFO] - Setting global seed to 206
[2025-03-06 17:31:32,532][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:31:32,532][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:31:32,534][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:31:32,536][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:31:32,538][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:31:32,539][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:31:32,708][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:31:32,996][root][INFO] - Full model selected, loading model
[2025-03-06 17:31:46,934][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:32:55,081][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:32:55,081][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:33:23,872][root][INFO] - Peft model loaded successfully
[2025-03-06 17:33:30,221][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:33:30,222][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 17:33:30,222][root][INFO] - Starting inference
[2025-03-06 17:33:30,436][root][INFO] - Processing question number 0
[2025-03-06 17:33:30,438][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:34:01,938][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:34:33,759][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:35:05,767][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:35:37,284][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:36:08,132][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:36:38,457][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:37:09,277][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:37:40,410][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:38:10,819][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:38:41,860][root][INFO] - Processing question number 10
[2025-03-06 17:38:41,862][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:39:12,076][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:39:42,877][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:40:13,837][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:40:44,229][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:41:15,569][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:41:46,568][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:42:17,459][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:42:48,238][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:43:19,545][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:43:51,033][root][INFO] - Processing question number 20
[2025-03-06 17:43:51,045][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:44:21,300][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:44:52,410][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:45:23,054][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:45:53,848][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:46:24,713][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:46:56,208][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:47:27,183][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:47:58,333][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:48:29,311][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:49:00,903][root][INFO] - Processing question number 30
[2025-03-06 17:49:00,907][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:49:31,954][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:50:02,787][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:50:33,572][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:51:05,129][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:51:36,024][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:52:07,045][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:52:38,008][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:53:09,655][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:53:40,802][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:54:11,965][root][INFO] - Processing question number 40
[2025-03-06 17:54:11,969][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:54:43,094][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:55:13,994][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:55:45,484][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:56:15,775][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:56:47,460][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:57:18,585][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:57:49,567][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:58:20,717][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:58:51,759][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:59:23,102][root][INFO] - Processing question number 50
[2025-03-06 17:59:23,107][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:59:54,790][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:00:25,311][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:00:56,877][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:01:28,029][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:01:58,548][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:02:29,409][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:03:01,206][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:03:36,728][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:04:08,533][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:04:39,873][root][INFO] - Processing question number 60
[2025-03-06 18:04:39,878][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:05:10,941][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:05:42,004][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:06:13,763][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:06:45,023][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:07:16,359][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:07:47,312][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:08:18,000][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:08:48,403][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:09:19,158][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:09:49,838][root][INFO] - Processing question number 70
[2025-03-06 18:09:49,843][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:10:21,100][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:10:52,257][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:11:23,603][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:11:55,490][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:12:26,160][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:12:57,465][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:13:29,825][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:14:01,144][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:14:31,507][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:15:02,253][root][INFO] - Processing question number 80
[2025-03-06 18:15:02,258][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:15:33,941][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:16:05,654][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:16:37,284][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:17:08,565][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:17:40,811][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:18:11,682][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:18:43,197][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:19:15,213][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:19:46,377][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:20:17,558][root][INFO] - Processing question number 90
[2025-03-06 18:20:17,564][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:20:48,750][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:21:20,334][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:21:51,644][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:22:22,752][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:22:54,535][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:23:26,206][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:23:57,527][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:24:28,413][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:24:58,849][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:25:30,577][root][INFO] - Inference complete
[2025-03-06 18:25:30,577][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,585][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,586][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,586][root][WARNING] - |Q. 1||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,586][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,586][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,587][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,587][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,587][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,587][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,588][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,588][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,589][root][WARNING] - |Q. 27||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,589][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,589][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,589][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,589][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,590][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,590][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,590][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,591][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,591][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,591][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,592][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,592][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,592][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,592][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,593][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,593][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,593][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,593][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,593][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,594][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,594][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,594][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,594][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,594][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,594][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,595][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,595][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,595][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,595][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,596][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,596][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,596][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,596][root][WARNING] - |Q. 7||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,596][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,596][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,597][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,597][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,597][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,597][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,597][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,598][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,598][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,598][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,598][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,599][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,599][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,599][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,599][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,600][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,600][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,600][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,600][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,600][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,601][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,601][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,602][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,602][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,602][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,603][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,603][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,603][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,603][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,603][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,603][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,604][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,604][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,604][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,604][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,604][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,604][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,605][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,605][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,605][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,605][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,605][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,606][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,606][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,606][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,606][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,607][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,607][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,607][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,607][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,608][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,608][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,608][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,608][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,608][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,608][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,609][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,609][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,609][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,609][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,609][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,609][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,610][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:25:30,610][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,610][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,610][root][WARNING] - |Q. 69||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,610][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,611][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,611][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,611][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,611][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,612][root][WARNING] - |Q. 91||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,612][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,612][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,612][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,612][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,613][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,613][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,613][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,613][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,613][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,613][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,614][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,614][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,614][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,614][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,614][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,614][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,614][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,615][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,615][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,615][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,615][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,615][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,616][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,616][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,616][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,617][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:25:30,617][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:25:30,617][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:25:30,618][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,624][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,624][root][INFO] - Saved parsed outputs
[2025-03-06 18:25:30,624][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,625][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,626][root][INFO] - Saved parsing metadata
[2025-03-06 18:25:30,627][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,628][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:25:30,630][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:25:30,677][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 18:25:30,677][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.2, 'malformed_label': 11, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 6, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 18:25:42,034][root][INFO] - Setting global seed to 206
[2025-03-06 18:25:42,043][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:25:42,043][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:25:42,045][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:25:42,046][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:25:42,051][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:25:42,051][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:25:42,232][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:25:42,515][root][INFO] - Full model selected, loading model
[2025-03-06 18:26:00,433][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:27:07,772][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:27:07,773][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:27:33,660][root][INFO] - Peft model loaded successfully
[2025-03-06 18:27:40,037][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:27:40,039][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 18:27:40,039][root][INFO] - Starting inference
[2025-03-06 18:27:40,234][root][INFO] - Processing question number 0
[2025-03-06 18:27:40,236][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:28:12,171][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:28:44,035][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:29:16,052][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:29:47,598][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:30:18,483][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:30:48,826][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:31:19,690][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:31:50,838][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:32:21,262][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:32:52,328][root][INFO] - Processing question number 10
[2025-03-06 18:32:52,330][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:33:22,586][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:33:53,411][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:34:24,419][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:34:54,859][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:35:26,215][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:35:57,248][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:36:28,178][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:36:59,011][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:37:30,336][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:38:01,884][root][INFO] - Processing question number 20
[2025-03-06 18:38:01,887][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:38:32,204][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:39:03,376][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:39:34,083][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:40:04,933][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:40:35,856][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:41:07,393][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:41:38,423][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:42:09,614][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:42:40,612][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:43:12,237][root][INFO] - Processing question number 30
[2025-03-06 18:43:12,240][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:43:43,291][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:44:14,142][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:44:44,954][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:45:16,551][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:45:47,482][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:46:18,536][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:46:49,558][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:47:21,251][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:47:52,430][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:48:23,629][root][INFO] - Processing question number 40
[2025-03-06 18:48:23,632][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:48:54,798][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:49:25,722][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:49:57,247][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:50:27,570][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:50:59,282][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:51:30,434][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:52:01,434][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:52:32,594][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:53:03,660][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:53:35,037][root][INFO] - Processing question number 50
[2025-03-06 18:53:35,041][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:54:06,738][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:54:37,341][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:55:09,052][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:55:40,342][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:56:10,996][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:56:41,878][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:57:13,715][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:57:45,313][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:58:16,960][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:58:48,298][root][INFO] - Processing question number 60
[2025-03-06 18:58:48,303][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:59:19,420][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:59:51,126][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:00:23,032][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:00:54,396][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:01:25,696][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:01:56,494][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:02:27,121][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:02:57,584][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:03:28,366][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:03:59,071][root][INFO] - Processing question number 70
[2025-03-06 19:03:59,076][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:04:30,378][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:05:01,583][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:05:32,983][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:06:04,919][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:06:35,638][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:07:06,989][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:07:39,395][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:08:10,747][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:08:41,113][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:09:11,880][root][INFO] - Processing question number 80
[2025-03-06 19:09:11,885][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:09:43,598][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:10:15,372][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:10:47,043][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:11:18,353][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:11:50,631][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:12:21,550][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:12:53,110][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:13:25,165][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:13:56,371][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:14:27,605][root][INFO] - Processing question number 90
[2025-03-06 19:14:27,611][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:14:58,847][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:15:30,472][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:16:01,828][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:16:32,984][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:17:04,824][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:17:36,548][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:18:07,916][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:18:38,855][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:19:09,352][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:19:41,121][root][INFO] - Inference complete
[2025-03-06 19:19:41,121][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,131][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,132][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,132][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,133][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,133][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,133][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,133][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,134][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,135][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,135][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,135][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,135][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,135][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,136][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,136][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,137][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,137][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,137][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,138][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,138][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,138][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,138][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,139][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,139][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,139][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,140][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,140][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,141][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,141][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,141][root][WARNING] - |Q. 7||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,141][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,141][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,142][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,142][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,142][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,142][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,142][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,143][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,143][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,143][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,144][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,144][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,144][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,144][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,145][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,145][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,145][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,145][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,145][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,146][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,146][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,146][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,146][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,146][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,147][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,147][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,147][root][WARNING] - |Q. 43||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,147][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,148][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,148][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,148][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,149][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,149][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,149][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,150][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,150][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,150][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,150][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,150][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,150][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,151][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,151][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,151][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,152][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,152][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,152][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,152][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,152][root][WARNING] - |Q. 68||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,153][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,153][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,153][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,154][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,154][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,154][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,154][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,155][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,155][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,155][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,155][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,156][root][WARNING] - |Q. 66||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,156][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,156][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,156][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,157][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,157][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,157][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,157][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,158][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,158][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,158][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,158][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,158][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,159][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,159][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,159][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,159][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,159][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,159][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,160][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,160][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,160][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,160][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,161][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,161][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,161][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,161][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,161][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,161][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,162][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,162][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:19:41,162][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,162][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,162][root][WARNING] - |Q. 79||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,162][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,163][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:19:41,163][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:19:41,163][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:19:41,164][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,171][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,171][root][INFO] - Saved parsed outputs
[2025-03-06 19:19:41,171][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,172][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,172][root][INFO] - Saved parsing metadata
[2025-03-06 19:19:41,174][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,180][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:19:41,182][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:19:41,226][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 19:19:41,226][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.24, 'malformed_label': 13, 'malformed_domain': 28, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.18, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 4, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 19:19:48,358][root][INFO] - Setting global seed to 989
[2025-03-06 19:19:48,363][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 19:19:48,364][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:19:48,365][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:19:48,396][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:19:48,398][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:19:48,398][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:19:48,577][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:19:48,852][root][INFO] - Full model selected, loading model
[2025-03-06 19:20:01,964][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:21:10,225][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:21:10,226][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:21:38,461][root][INFO] - Peft model loaded successfully
[2025-03-06 19:21:44,949][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:21:44,953][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 19:21:44,953][root][INFO] - Starting inference
[2025-03-06 19:21:45,151][root][INFO] - Processing question number 0
[2025-03-06 19:21:45,154][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:22:16,238][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:22:47,904][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:23:19,710][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:23:51,049][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:24:21,725][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:24:51,875][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:25:22,530][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:25:53,486][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:26:23,718][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:26:54,597][root][INFO] - Processing question number 10
[2025-03-06 19:26:54,600][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:27:24,674][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:27:55,317][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:28:26,130][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:28:56,385][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:29:27,563][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:29:58,430][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:30:29,195][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:30:59,835][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:31:31,000][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:32:02,322][root][INFO] - Processing question number 20
[2025-03-06 19:32:02,325][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:32:32,441][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:33:03,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:33:33,898][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:34:04,514][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:34:35,210][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:35:06,514][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:35:37,320][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:36:08,291][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:36:39,081][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:37:10,503][root][INFO] - Processing question number 30
[2025-03-06 19:37:10,506][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:37:41,353][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:38:11,984][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:38:42,594][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:39:13,983][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:39:44,716][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:40:15,587][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:40:46,394][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:41:17,895][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:41:48,874][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:42:19,890][root][INFO] - Processing question number 40
[2025-03-06 19:42:19,894][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:42:50,862][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:43:21,586][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:43:52,901][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:44:23,043][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:44:54,549][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:45:25,500][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:45:56,295][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:46:27,256][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:46:58,127][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:47:29,311][root][INFO] - Processing question number 50
[2025-03-06 19:47:29,315][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:48:00,805][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:48:31,203][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:49:02,701][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:49:33,772][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:50:04,238][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:50:08,300][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:50:39,941][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:51:11,359][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:51:42,772][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:52:13,912][root][INFO] - Processing question number 60
[2025-03-06 19:52:13,917][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:52:44,853][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:53:15,830][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:53:47,534][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:54:18,717][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:54:49,840][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:55:20,457][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:55:50,898][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:56:21,218][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:56:51,817][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:57:22,351][root][INFO] - Processing question number 70
[2025-03-06 19:57:22,356][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:57:53,472][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:58:24,462][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:58:55,626][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:59:27,304][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:59:57,813][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:00:28,957][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:01:01,155][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:01:32,308][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:02:02,462][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:02:33,037][root][INFO] - Processing question number 80
[2025-03-06 20:02:33,043][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:03:04,546][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:03:36,095][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:04:07,576][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:04:38,709][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:05:10,789][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:05:41,503][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:06:12,861][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:06:44,730][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:07:15,758][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:07:46,784][root][INFO] - Processing question number 90
[2025-03-06 20:07:46,790][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:08:17,826][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:08:49,236][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:09:20,387][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:09:51,340][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:10:22,976][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:10:38,466][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:11:09,622][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:11:40,364][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:12:10,665][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:12:42,244][root][INFO] - Inference complete
[2025-03-06 20:12:42,244][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,253][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,253][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,254][root][WARNING] - |Q. 1||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,254][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,254][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,255][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,255][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,255][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,256][root][WARNING] - |Q. 27||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,256][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,256][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,257][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,257][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,257][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,257][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,257][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,258][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,258][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,258][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,259][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,259][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,259][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,259][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,260][root][WARNING] - |Q. 21||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,260][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,260][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,260][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,260][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,261][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,261][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,262][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,262][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,263][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,263][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,263][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,264][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,264][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,264][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,265][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,265][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,265][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,265][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,265][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,266][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,266][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,266][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,266][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,267][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,267][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,267][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,267][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,267][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,268][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,268][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,268][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,268][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,268][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,269][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,269][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,269][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,269][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,270][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,270][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,270][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,271][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,271][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,271][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,271][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,272][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,272][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,272][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,272][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,272][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,272][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,273][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,273][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,273][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,273][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,273][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,274][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,274][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,274][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,274][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,274][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,274][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,275][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,275][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,275][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,275][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,276][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,276][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,276][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,276][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,276][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,277][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,277][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,277][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,277][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,277][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,277][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,278][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,278][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,278][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,278][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,278][root][WARNING] - |Q. 46||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,278][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,279][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,279][root][WARNING] - |Q. 66||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,279][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,280][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,280][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,280][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,280][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,280][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,280][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,281][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,281][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,281][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,281][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,282][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,282][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,282][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,282][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,282][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,283][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,283][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,283][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,283][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,283][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,284][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,284][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,284][root][WARNING] - |Q. 57||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,284][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,285][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,285][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,285][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,285][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,285][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,285][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,286][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,286][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,286][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,286][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,286][root][WARNING] - |Q. 79||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:12:42,286][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,287][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:12:42,287][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:12:42,287][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:12:42,288][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,295][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,295][root][INFO] - Saved parsed outputs
[2025-03-06 20:12:42,295][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,296][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,296][root][INFO] - Saved parsing metadata
[2025-03-06 20:12:42,298][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,299][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:12:42,301][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:12:42,314][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 20:12:42,315][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.22, 'malformed_label': 13, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.13, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 52, 'correct_label_wrong_domain': 6, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 20:12:50,845][root][INFO] - Setting global seed to 989
[2025-03-06 20:12:50,852][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 20:12:50,852][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:12:50,853][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:12:50,855][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:12:50,858][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:12:50,858][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:12:51,007][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:12:51,402][root][INFO] - Full model selected, loading model
[2025-03-06 20:13:04,157][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:14:11,047][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:14:11,047][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:14:38,182][root][INFO] - Peft model loaded successfully
[2025-03-06 20:14:44,604][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:14:44,607][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 20:14:44,607][root][INFO] - Starting inference
[2025-03-06 20:14:44,809][root][INFO] - Processing question number 0
[2025-03-06 20:14:44,812][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:15:16,310][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:15:48,157][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:16:20,163][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:16:51,686][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:17:22,560][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:17:52,889][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:18:23,725][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:18:54,871][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:19:25,287][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:19:56,337][root][INFO] - Processing question number 10
[2025-03-06 20:19:56,339][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:20:26,580][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:20:57,398][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:21:28,392][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:21:58,835][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:22:30,243][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:23:01,258][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:23:32,183][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:24:02,942][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:24:34,237][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:25:05,789][root][INFO] - Processing question number 20
[2025-03-06 20:25:05,792][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:25:36,106][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:26:07,220][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:26:37,794][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:27:08,610][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:27:39,426][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:28:10,806][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:28:41,631][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:29:12,726][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:29:43,597][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:30:15,059][root][INFO] - Processing question number 30
[2025-03-06 20:30:15,063][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:30:45,943][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:31:16,644][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:31:47,287][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:32:18,704][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:32:49,449][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:33:20,328][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:33:51,161][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:34:22,679][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:34:53,680][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:35:24,710][root][INFO] - Processing question number 40
[2025-03-06 20:35:24,714][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:35:55,701][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:36:26,459][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:36:57,803][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:37:27,965][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:37:59,497][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:38:30,465][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:39:01,275][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:39:32,251][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:40:03,129][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:40:34,318][root][INFO] - Processing question number 50
[2025-03-06 20:40:34,322][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:41:05,842][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:41:36,264][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:42:07,792][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:42:38,896][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:43:09,361][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:43:40,061][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:44:11,704][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:44:43,115][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:45:14,596][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:45:45,737][root][INFO] - Processing question number 60
[2025-03-06 20:45:45,742][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:46:16,676][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:46:47,665][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:47:19,375][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:47:50,557][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:48:21,659][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:48:52,276][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:49:22,720][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:49:53,001][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:50:23,598][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:50:54,128][root][INFO] - Processing question number 70
[2025-03-06 20:50:54,133][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:51:25,240][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:51:56,246][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:52:27,440][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:52:59,172][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:53:29,689][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:54:00,844][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:54:33,050][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:55:04,209][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:55:34,379][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:56:04,961][root][INFO] - Processing question number 80
[2025-03-06 20:56:04,966][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:56:36,490][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:57:08,049][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:57:39,536][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:58:10,678][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:58:42,770][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:59:13,497][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:59:44,871][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:00:16,740][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:00:47,756][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:01:18,791][root][INFO] - Processing question number 90
[2025-03-06 21:01:18,797][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:01:49,834][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:02:21,266][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:02:52,430][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:03:23,391][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:03:55,034][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:04:26,571][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:04:57,744][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:05:28,491][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:05:58,796][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:06:30,409][root][INFO] - Inference complete
[2025-03-06 21:06:30,410][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,419][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,420][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,421][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,421][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,421][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,422][root][WARNING] - |Q. 27||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,422][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,423][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,423][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,423][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,424][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,424][root][WARNING] - |Q. 8||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,424][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,424][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,424][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,425][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,425][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,425][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,425][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,426][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,426][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,426][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,426][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,426][root][WARNING] - |Q. 64||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,426][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,427][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,427][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,428][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,428][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,429][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,429][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,429][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,429][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,429][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,430][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,430][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,430][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,430][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,430][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,430][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,431][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,431][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,431][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,431][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,432][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,432][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,432][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,432][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,432][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,433][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,433][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,433][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,434][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,434][root][WARNING] - |Q. 60||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,434][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,435][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,435][root][WARNING] - |Q. 80||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,435][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,435][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,436][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,436][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,436][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,436][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,436][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,436][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,437][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,437][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,437][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,437][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,437][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,438][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,438][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,438][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,438][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,438][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,438][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,439][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,439][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,439][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,439][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,439][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,439][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,440][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,440][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,440][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,440][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,440][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,441][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,441][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,441][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,441][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,441][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,441][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,441][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,442][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,442][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,442][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,442][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,442][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,442][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,443][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,443][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,443][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,443][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,443][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,443][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,444][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,444][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,444][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,444][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,445][root][WARNING] - |Q. 66||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,445][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,445][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,445][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,445][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,446][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,446][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,446][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,446][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,447][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,447][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,447][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,447][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,447][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,447][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,448][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,448][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,448][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,448][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,448][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,448][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,449][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:30,449][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,449][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,449][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,449][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,450][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,450][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,450][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,450][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,450][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,450][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,451][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,451][root][WARNING] - |Q. 79||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,451][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,451][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:30,451][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:30,451][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:30,453][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,458][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,459][root][INFO] - Saved parsed outputs
[2025-03-06 21:06:30,459][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,460][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,460][root][INFO] - Saved parsing metadata
[2025-03-06 21:06:30,462][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,463][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:30,465][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:06:30,649][root][INFO] - Evaluation completed for json_answer_first_few_shot_structured, on test_set_2
[2025-03-06 21:06:30,649][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.25, 'malformed_label': 12, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 4, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 17 to status completed with exit code 0
Eval status update completed for job 17
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '17', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 17 to status running with exit code None
Eval status update completed for job 17
[2025-03-06 21:06:45,805][root][INFO] - Setting global seed to 989
[2025-03-06 21:06:45,827][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 21:06:45,827][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:06:45,829][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:06:45,830][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:06:45,836][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:06:45,836][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:06:46,030][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:06:46,395][root][INFO] - Full model selected, loading model
[2025-03-06 21:07:05,621][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:08:05,923][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:08:05,923][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:08:32,827][root][INFO] - Peft model loaded successfully
[2025-03-06 21:08:39,092][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:08:39,095][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_few_shot_structured/test_set_2.json
[2025-03-06 21:08:39,095][root][INFO] - Starting inference
[2025-03-06 21:08:39,307][root][INFO] - Processing question number 0
[2025-03-06 21:08:39,309][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:09:11,197][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:09:42,901][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:10:14,748][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:10:46,120][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:11:16,833][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:11:47,012][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:12:17,700][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:12:48,690][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:13:18,956][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:13:49,857][root][INFO] - Processing question number 10
[2025-03-06 21:13:49,859][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:14:19,956][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:14:50,630][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:15:21,469][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:15:51,750][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:16:22,970][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:16:53,858][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:17:24,643][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:17:55,325][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:18:26,569][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:18:58,129][root][INFO] - Processing question number 20
[2025-03-06 21:18:58,132][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:19:28,430][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:20:02,580][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:20:33,399][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:21:04,078][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:21:34,813][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:22:06,165][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:22:37,006][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:23:08,023][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:23:38,862][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:24:10,316][root][INFO] - Processing question number 30
[2025-03-06 21:24:10,320][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:24:41,216][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:25:11,910][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:25:42,560][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:26:13,993][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:26:44,756][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:27:15,649][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:27:46,495][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:28:18,020][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:28:49,032][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:29:20,077][root][INFO] - Processing question number 40
[2025-03-06 21:29:20,081][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:29:51,083][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:30:21,850][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:30:53,207][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:31:23,379][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:31:54,924][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:32:25,916][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:32:56,749][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:33:27,754][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:33:58,659][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:34:29,873][root][INFO] - Processing question number 50
[2025-03-06 21:34:29,877][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:35:01,403][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:35:31,851][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:36:03,388][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:36:34,510][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:37:05,000][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:37:35,723][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:38:07,383][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:38:38,812][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:39:10,256][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:39:41,416][root][INFO] - Processing question number 60
[2025-03-06 21:39:41,420][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:40:12,379][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:40:43,394][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:41:15,129][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:41:46,374][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:42:17,521][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:42:48,167][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:43:18,654][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:43:48,964][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:44:19,637][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:44:50,408][root][INFO] - Processing question number 70
[2025-03-06 21:44:50,414][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:45:21,683][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:45:52,850][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:46:24,169][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:46:55,920][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:47:26,459][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:47:57,629][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:48:29,862][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:49:01,040][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:49:31,230][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:50:01,833][root][INFO] - Processing question number 80
[2025-03-06 21:50:01,839][root][INFO] - Domain : Property, Question : 69
