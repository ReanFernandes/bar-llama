Starting job 9 at Thu Mar  6 09:40:29 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=json_fact_first_few_shot_structured train=json_fact_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '9', 'training']
Updating job 9 to status training with exit code None
Status update completed for job 9
[2025-03-06 09:40:42,830][root][INFO] - Global seed set to 314
[2025-03-06 09:40:42,832][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 09:40:42,832][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 09:40:42,832][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 09:40:42,833][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:40:42,833][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 09:40:42,854][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:40:42,868][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 09:40:42,870][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 09:40:42,960][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 09:40:43,384][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 09:40:55,510][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 09:41:26,861][root][INFO] - Model prepared for kbit training
[2025-03-06 09:41:26,862][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'v_proj', 'k_proj', 'gate_proj', 'down_proj', 'q_proj', 'up_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 09:41:28,582][root][INFO] - Lora adapter added to model
[2025-03-06 09:41:28,585][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_few_shot_structured
[2025-03-06 09:41:28,716][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4425, 'grad_norm': 0.14474622905254364, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.2857, 'grad_norm': 0.191392719745636, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.158, 'grad_norm': 0.20157869160175323, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.0492, 'grad_norm': 0.24001474678516388, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8568, 'grad_norm': 0.240866020321846, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 367.793, 'train_samples_per_second': 0.285, 'train_steps_per_second': 0.041, 'train_loss': 1.15843931833903, 'epoch': 15.0}
[2025-03-06 09:47:39,804][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '9', 'trained', '0']
Updating job 9 to status trained with exit code 0
Status update completed for job 9
Starting evaluations for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 09:47:49,672][root][INFO] - Setting global seed to 206
[2025-03-06 09:47:49,677][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:47:49,678][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:47:49,679][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:47:49,681][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:47:49,683][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:47:49,684][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:47:50,057][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 09:47:50,571][root][INFO] - Full model selected, loading model
[2025-03-06 09:48:02,265][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:49:06,661][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:49:06,662][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:49:32,140][root][INFO] - Peft model loaded successfully
[2025-03-06 09:49:38,257][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:49:38,259][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 09:49:38,259][root][INFO] - Starting inference
[2025-03-06 09:49:38,466][root][INFO] - Processing question number 0
[2025-03-06 09:49:38,468][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:50:08,756][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:50:39,926][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:51:10,671][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:51:41,861][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:52:03,425][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:52:34,045][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:53:05,462][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:53:36,410][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:54:06,978][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:54:38,177][root][INFO] - Processing question number 10
[2025-03-06 09:54:38,179][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:55:10,800][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:55:34,982][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:55:57,215][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:56:28,675][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:57:00,137][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:57:30,549][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:58:00,844][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:58:31,678][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:59:02,484][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:59:33,008][root][INFO] - Processing question number 20
[2025-03-06 09:59:33,010][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:00:03,749][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:00:34,721][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:01:05,153][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:01:35,495][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:02:06,541][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:02:37,464][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:03:09,139][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:03:39,953][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:04:10,893][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:04:41,110][root][INFO] - Processing question number 30
[2025-03-06 10:04:41,113][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:05:12,213][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:05:43,668][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:06:14,581][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:06:45,290][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:07:15,890][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:07:47,281][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:08:17,955][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:08:49,049][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:09:19,957][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:09:51,694][root][INFO] - Processing question number 40
[2025-03-06 10:09:51,697][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:10:22,819][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:10:53,925][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:11:25,601][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:11:57,021][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:12:27,624][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:12:52,462][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:13:24,663][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:13:54,662][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:14:25,469][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:14:56,949][root][INFO] - Processing question number 50
[2025-03-06 10:14:56,953][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:15:28,624][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:15:59,651][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:16:29,878][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:17:01,845][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:17:32,847][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:18:02,891][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:18:34,542][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:19:04,973][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:19:36,475][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:20:08,755][root][INFO] - Processing question number 60
[2025-03-06 10:20:08,759][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:20:39,180][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:21:09,916][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:21:41,336][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:22:11,727][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:22:42,637][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:23:13,587][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:23:38,588][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:24:09,911][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:24:40,958][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:25:12,551][root][INFO] - Processing question number 70
[2025-03-06 10:25:12,555][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:25:43,264][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:26:14,050][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:26:44,668][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:27:15,958][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:27:47,107][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:28:17,599][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:28:48,958][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:29:20,060][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:29:51,425][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:30:22,127][root][INFO] - Processing question number 80
[2025-03-06 10:30:22,132][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:30:53,270][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:31:24,395][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:31:55,016][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:32:25,696][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:32:57,178][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:33:28,486][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:33:59,862][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:34:30,482][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:35:01,566][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:35:31,967][root][INFO] - Processing question number 90
[2025-03-06 10:35:31,973][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:36:03,812][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:36:33,729][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:37:04,534][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:37:34,599][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:38:05,966][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:38:36,357][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:39:07,030][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:39:38,026][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:40:09,532][root][INFO] - Inference complete
[2025-03-06 10:40:09,532][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,539][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,541][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,541][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,542][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,548][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,548][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,549][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,549][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,550][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:40:09,550][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,552][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,552][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,552][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,554][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,554][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,554][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,555][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,555][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,555][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,556][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,556][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,556][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,558][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,558][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:09,559][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,559][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:09,560][root][WARNING] - |Q. 36||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:40:09,560][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:09,562][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,568][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,568][root][INFO] - Saved parsed outputs
[2025-03-06 10:40:09,568][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,569][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,570][root][INFO] - Saved parsing metadata
[2025-03-06 10:40:09,571][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,573][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:09,574][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:40:09,599][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 10:40:09,599][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.18181818181818182, 'malformed_label': 9, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.16161616161616163, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 23, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 10:40:16,041][root][INFO] - Setting global seed to 206
[2025-03-06 10:40:16,048][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:40:16,048][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:40:16,049][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:40:16,051][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:40:16,053][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:40:16,054][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:40:16,228][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:40:16,481][root][INFO] - Full model selected, loading model
[2025-03-06 10:40:31,835][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:40:31,835][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:40:38,217][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:40:38,219][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 10:40:38,219][root][INFO] - Starting inference
[2025-03-06 10:40:38,413][root][INFO] - Processing question number 0
[2025-03-06 10:40:38,415][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:41:08,547][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:41:39,612][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:42:10,222][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:42:41,322][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:43:11,848][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:43:42,334][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:44:13,665][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:44:44,482][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:45:14,920][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:45:46,020][root][INFO] - Processing question number 10
[2025-03-06 10:45:46,022][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:46:18,480][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:46:48,679][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:47:19,398][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:47:50,778][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:48:22,135][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:48:52,398][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:49:22,581][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:49:53,266][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:50:23,916][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:50:54,339][root][INFO] - Processing question number 20
[2025-03-06 10:50:54,342][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:51:24,972][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:51:55,839][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:52:26,091][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:52:56,276][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:53:27,215][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:53:57,889][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:54:29,395][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:55:00,024][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:55:30,849][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:56:00,948][root][INFO] - Processing question number 30
[2025-03-06 10:56:00,952][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:56:31,961][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:57:03,313][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:57:34,114][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:58:04,708][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:58:35,196][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:59:06,370][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:59:36,835][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:00:07,732][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:00:38,405][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:01:09,921][root][INFO] - Processing question number 40
[2025-03-06 11:01:09,924][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:01:40,765][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:02:11,520][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:02:42,780][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:03:13,988][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:03:44,413][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:04:15,153][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:04:47,139][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:05:16,948][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:05:47,504][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:06:18,811][root][INFO] - Processing question number 50
[2025-03-06 11:06:18,815][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:06:50,288][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:07:21,114][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:07:51,121][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:08:22,885][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:08:53,684][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:09:23,502][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:09:54,931][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:10:25,107][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:10:56,400][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:11:28,488][root][INFO] - Processing question number 60
[2025-03-06 11:11:28,493][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:11:58,639][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:12:29,144][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:13:00,351][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:13:30,481][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:14:01,165][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:14:31,904][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:15:02,664][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:15:33,681][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:16:04,515][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:16:35,883][root][INFO] - Processing question number 70
[2025-03-06 11:16:35,888][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:17:06,339][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:17:36,843][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:18:07,231][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:18:38,223][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:19:09,166][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:19:39,437][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:20:10,484][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:20:41,373][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:21:12,412][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:21:42,891][root][INFO] - Processing question number 80
[2025-03-06 11:21:42,896][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:22:13,809][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:22:44,723][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:23:15,114][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:23:45,554][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:24:16,826][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:24:47,818][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:25:18,872][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:25:49,276][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:26:20,139][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:26:50,262][root][INFO] - Processing question number 90
[2025-03-06 11:26:50,268][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:27:21,891][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:27:51,542][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:28:22,073][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:28:51,922][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:29:22,987][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:29:53,119][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:30:23,580][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:30:54,369][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:31:25,656][root][INFO] - Inference complete
[2025-03-06 11:31:25,657][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,663][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,664][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,664][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,665][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,666][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,667][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,667][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,669][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,669][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,669][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,670][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,670][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,670][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,671][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,671][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,672][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,672][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,672][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,673][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,673][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,674][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,674][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,675][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,676][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,676][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,676][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,677][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,677][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,677][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,678][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,678][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,678][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,678][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,679][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,679][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,680][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,680][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,680][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,680][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,681][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,681][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,681][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,682][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,682][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,682][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,682][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,683][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,683][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,683][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,684][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,684][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,684][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,684][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,685][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,685][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,685][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,686][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,686][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,686][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,687][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,687][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,688][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,689][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,689][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,689][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,689][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,690][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,690][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,690][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,690][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,691][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,691][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,691][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,692][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,692][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,692][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,692][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,692][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,693][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,693][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,693][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,694][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,694][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,694][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,694][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,695][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,695][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,695][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,696][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,696][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:31:25,696][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,696][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,697][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,697][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,697][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,697][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,697][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,698][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,698][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,698][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,698][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,699][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,699][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,699][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,699][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,699][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,700][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:31:25,700][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:31:25,700][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:31:25,702][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,708][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,708][root][INFO] - Saved parsed outputs
[2025-03-06 11:31:25,708][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,710][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,710][root][INFO] - Saved parsing metadata
[2025-03-06 11:31:25,710][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,712][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:31:25,713][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:31:25,775][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 11:31:25,776][root][INFO] - Summary of metrics : {'label_accuracy': 0.18181818181818182, 'misclassification_rate': 0.8181818181818181, 'combined_accuracy': 0.08080808080808081, 'malformed_label': 36, 'malformed_domain': 48, 'total_predictions': 99, 'correct_predictions': 18, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 10, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 11:31:34,432][root][INFO] - Setting global seed to 206
[2025-03-06 11:31:34,440][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:31:34,440][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:31:34,441][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:31:34,443][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:31:34,447][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:31:34,447][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:31:34,608][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:31:34,869][root][INFO] - Full model selected, loading model
[2025-03-06 11:31:48,417][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:32:51,863][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:32:51,863][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:33:17,367][root][INFO] - Peft model loaded successfully
[2025-03-06 11:33:23,432][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:33:23,433][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 11:33:23,433][root][INFO] - Starting inference
[2025-03-06 11:33:23,640][root][INFO] - Processing question number 0
[2025-03-06 11:33:23,642][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:33:54,198][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:34:25,390][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:34:56,142][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:35:27,356][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:35:58,021][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:36:28,650][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:37:00,132][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:37:31,091][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:38:01,673][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:38:32,910][root][INFO] - Processing question number 10
[2025-03-06 11:38:32,912][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:39:05,600][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:39:35,996][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:40:06,910][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:40:38,419][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:41:09,904][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:41:40,352][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:42:10,679][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:42:41,557][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:43:12,402][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:43:42,967][root][INFO] - Processing question number 20
[2025-03-06 11:43:42,970][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:44:13,753][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:44:44,762][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:45:15,211][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:45:45,595][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:46:16,695][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:46:47,580][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:47:19,251][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:47:50,098][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:48:21,070][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:48:51,329][root][INFO] - Processing question number 30
[2025-03-06 11:48:51,332][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:49:22,494][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:49:54,002][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:50:24,981][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:50:55,755][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:51:26,413][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:51:57,857][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:52:28,595][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:52:59,758][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:53:30,719][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:54:02,410][root][INFO] - Processing question number 40
[2025-03-06 11:54:02,414][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:54:33,427][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:55:04,443][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:55:35,966][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:56:07,430][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:56:38,111][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:57:09,093][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:57:41,376][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:58:11,445][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:58:42,318][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:59:09,359][root][INFO] - Processing question number 50
[2025-03-06 11:59:09,363][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:59:41,120][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:00:12,226][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:00:42,523][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:01:14,566][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:01:45,642][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:02:15,747][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:02:47,463][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:03:17,958][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:03:49,544][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:04:21,995][root][INFO] - Processing question number 60
[2025-03-06 12:04:21,999][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:04:52,585][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:05:23,483][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:05:55,069][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:06:25,644][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:06:56,719][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:07:27,844][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:07:59,005][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:08:30,512][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:08:55,208][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:09:27,060][root][INFO] - Processing question number 70
[2025-03-06 12:09:27,065][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:09:57,963][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:10:28,930][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:10:59,722][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:11:31,197][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:12:02,545][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:12:33,195][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:13:04,702][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:13:35,950][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:14:07,478][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:14:38,331][root][INFO] - Processing question number 80
[2025-03-06 12:14:38,337][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:15:09,635][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:15:40,914][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:16:11,704][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:16:42,537][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:17:14,187][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:17:45,658][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:18:17,201][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:18:47,978][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:19:19,229][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:19:49,789][root][INFO] - Processing question number 90
[2025-03-06 12:19:49,795][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:20:21,809][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:20:51,874][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:21:16,860][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:21:47,094][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:22:18,640][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:22:49,193][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:23:20,037][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:23:37,586][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:24:09,245][root][INFO] - Inference complete
[2025-03-06 12:24:09,246][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,253][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,254][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,255][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,256][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,256][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,257][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,257][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,257][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,258][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,258][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,262][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,262][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,262][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,264][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,264][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,264][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,266][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,267][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,267][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,267][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,268][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:24:09,268][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,269][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,269][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,269][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,270][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,270][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:24:09,270][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,272][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,272][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,272][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,273][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:09,273][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:09,273][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:09,276][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,283][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,283][root][INFO] - Saved parsed outputs
[2025-03-06 12:24:09,283][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,284][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,284][root][INFO] - Saved parsing metadata
[2025-03-06 12:24:09,285][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,286][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:09,288][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:24:09,320][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 12:24:09,320][root][INFO] - Summary of metrics : {'label_accuracy': 0.3838383838383838, 'misclassification_rate': 0.6161616161616161, 'combined_accuracy': 0.21212121212121213, 'malformed_label': 11, 'malformed_domain': 50, 'total_predictions': 99, 'correct_predictions': 38, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.16161616161616163, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 17, 'both_wrong': 33}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 12:24:18,125][root][INFO] - Setting global seed to 206
[2025-03-06 12:24:18,133][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:24:18,133][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:24:18,134][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:24:18,136][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:24:18,138][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:24:18,139][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:24:18,315][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:24:18,619][root][INFO] - Full model selected, loading model
[2025-03-06 12:24:39,413][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:24:39,413][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:24:45,692][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:24:45,693][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 12:24:45,694][root][INFO] - Starting inference
[2025-03-06 12:24:45,870][root][INFO] - Processing question number 0
[2025-03-06 12:24:45,872][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:25:16,144][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:25:47,281][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:26:17,972][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:26:49,152][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:27:19,761][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:27:50,333][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:28:21,741][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:28:52,646][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:29:23,180][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:29:54,359][root][INFO] - Processing question number 10
[2025-03-06 12:29:54,361][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:30:26,906][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:30:57,193][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:31:28,004][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:31:59,467][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:32:30,911][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:33:01,262][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:33:31,543][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:34:02,313][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:34:33,061][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:35:03,584][root][INFO] - Processing question number 20
[2025-03-06 12:35:03,587][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:35:34,304][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:36:05,271][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:36:35,718][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:37:06,040][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:37:37,101][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:38:07,907][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:38:39,539][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:39:10,313][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:39:41,229][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:40:11,436][root][INFO] - Processing question number 30
[2025-03-06 12:40:11,440][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:40:42,555][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:41:14,001][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:41:44,914][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:42:15,617][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:42:46,327][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:43:17,785][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:43:48,466][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:44:19,572][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:44:50,470][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:45:22,103][root][INFO] - Processing question number 40
[2025-03-06 12:45:22,107][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:45:53,072][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:46:24,032][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:46:55,498][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:47:26,913][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:47:57,541][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:48:28,462][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:49:00,612][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:49:30,621][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:50:01,379][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:50:32,883][root][INFO] - Processing question number 50
[2025-03-06 12:50:32,887][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:51:04,555][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:51:35,590][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:52:05,822][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:52:37,795][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:53:08,806][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:53:38,850][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:54:10,489][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:54:40,884][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:55:12,387][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:55:44,674][root][INFO] - Processing question number 60
[2025-03-06 12:55:44,678][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:56:15,045][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:56:45,769][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:57:17,180][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:57:47,531][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:58:18,427][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:58:49,377][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:59:20,392][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:59:51,626][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:00:22,684][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:00:54,279][root][INFO] - Processing question number 70
[2025-03-06 13:00:54,311][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:01:24,995][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:01:55,727][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:02:26,354][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:02:57,564][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:03:28,738][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:03:59,277][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:04:30,547][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:05:01,666][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:05:32,941][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:06:03,648][root][INFO] - Processing question number 80
[2025-03-06 13:06:03,654][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:06:34,810][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:07:05,922][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:07:36,536][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:08:07,190][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:08:38,678][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:09:09,894][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:09:41,172][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:10:11,796][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:10:42,882][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:11:13,218][root][INFO] - Processing question number 90
[2025-03-06 13:11:13,224][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:11:45,061][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:12:14,932][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:12:45,692][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:13:15,765][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:13:47,041][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:14:17,386][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:14:48,060][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:15:19,063][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:15:50,550][root][INFO] - Inference complete
[2025-03-06 13:15:50,550][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,557][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,558][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,559][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,560][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,560][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,561][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,561][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,562][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,562][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,562][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,563][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,563][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,563][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,564][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,565][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,565][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,565][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,566][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,566][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,566][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,566][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,567][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,568][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,568][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,568][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,569][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,570][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,570][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,571][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,571][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,571][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,571][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,572][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,572][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,572][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,573][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,573][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,573][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,574][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,574][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,575][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,575][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,575][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,576][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,576][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,576][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,578][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,578][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,579][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,579][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,580][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,580][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,581][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,581][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,581][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,582][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,582][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,582][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,583][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,583][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,583][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,583][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,584][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,584][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,585][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,585][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:15:50,585][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,585][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,586][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,586][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,587][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:15:50,588][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:15:50,588][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:15:50,589][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,595][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,595][root][INFO] - Saved parsed outputs
[2025-03-06 13:15:50,595][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,596][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,597][root][INFO] - Saved parsing metadata
[2025-03-06 13:15:50,597][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,599][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:15:50,600][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:15:50,650][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 13:15:50,650][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.18181818181818182, 'malformed_label': 25, 'malformed_domain': 39, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 13:16:00,738][root][INFO] - Setting global seed to 206
[2025-03-06 13:16:00,746][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:16:00,746][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:16:00,747][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:16:00,749][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:16:00,753][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:16:00,753][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:16:00,933][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:16:01,189][root][INFO] - Full model selected, loading model
[2025-03-06 13:16:17,282][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:17:20,056][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:17:20,057][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:17:45,962][root][INFO] - Peft model loaded successfully
[2025-03-06 13:17:52,049][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:17:52,051][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 13:17:52,051][root][INFO] - Starting inference
[2025-03-06 13:17:52,223][root][INFO] - Processing question number 0
[2025-03-06 13:17:52,226][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:18:22,719][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:18:54,015][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:19:24,879][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:19:50,316][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:20:21,082][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:20:51,769][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:21:23,315][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:21:54,349][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:22:25,032][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:22:56,626][root][INFO] - Processing question number 10
[2025-03-06 13:22:56,647][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:23:29,686][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:24:00,282][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:24:31,429][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:25:03,218][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:25:34,980][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:26:05,678][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:26:36,271][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:27:07,405][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:27:38,512][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:28:09,391][root][INFO] - Processing question number 20
[2025-03-06 13:28:09,396][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:28:40,416][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:29:11,684][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:29:42,393][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:30:13,035][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:30:44,402][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:31:15,602][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:31:47,565][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:32:18,686][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:32:50,058][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:33:20,718][root][INFO] - Processing question number 30
[2025-03-06 13:33:20,721][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:33:52,248][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:34:24,106][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:34:55,375][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:35:26,377][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:35:57,274][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:36:28,960][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:36:59,934][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:37:31,334][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:38:02,532][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:38:34,459][root][INFO] - Processing question number 40
[2025-03-06 13:38:34,463][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:39:05,725][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:39:36,980][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:40:08,740][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:40:40,444][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:41:01,567][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:41:32,777][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:42:05,303][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:42:35,607][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:43:06,717][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:43:38,521][root][INFO] - Processing question number 50
[2025-03-06 13:43:38,525][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:44:10,486][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:44:41,805][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:45:12,316][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:45:44,587][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:46:15,883][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:46:46,202][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:47:18,140][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:47:48,853][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:48:20,646][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:48:53,220][root][INFO] - Processing question number 60
[2025-03-06 13:48:53,225][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:49:23,937][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:49:54,943][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:50:26,647][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:50:57,319][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:51:28,499][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:51:59,755][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:52:31,016][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:53:02,615][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:53:33,935][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:54:05,803][root][INFO] - Processing question number 70
[2025-03-06 13:54:05,808][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:54:36,782][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:55:07,839][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:55:38,717][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:56:10,298][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:56:41,732][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:57:12,483][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:57:44,120][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:58:15,498][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:58:47,176][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:59:18,158][root][INFO] - Processing question number 80
[2025-03-06 13:59:18,164][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:59:49,592][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:00:21,010][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:00:51,926][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:01:22,886][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:01:54,645][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:02:26,237][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:02:57,876][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:03:28,765][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:04:00,139][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:04:30,806][root][INFO] - Processing question number 90
[2025-03-06 14:04:30,811][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:05:02,933][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:05:33,119][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:06:04,203][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:06:34,543][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:07:06,200][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:07:36,889][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:08:07,849][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:08:39,145][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:09:09,447][root][INFO] - Inference complete
[2025-03-06 14:09:09,448][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,455][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,455][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,456][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,456][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,456][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,457][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,458][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,458][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,458][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,458][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,459][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,459][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,459][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,460][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,461][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,461][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,461][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,461][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,461][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,462][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,462][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,462][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,463][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,463][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,463][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,465][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,465][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,465][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,467][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,467][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,467][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,468][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,469][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,469][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,469][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,469][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,469][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,470][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,470][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,470][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,471][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,472][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,472][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,473][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,474][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,474][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,475][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,475][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,476][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,476][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,476][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,476][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,477][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,478][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,478][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,478][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,478][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:09,479][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,481][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:09,481][root][WARNING] - |Q. 92||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:09,481][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:09,482][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,489][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,489][root][INFO] - Saved parsed outputs
[2025-03-06 14:09:09,489][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,492][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,492][root][INFO] - Saved parsing metadata
[2025-03-06 14:09:09,492][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,494][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:09,495][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:09:09,512][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 14:09:09,512][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.1111111111111111, 'malformed_label': 21, 'malformed_domain': 56, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 11, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.16161616161616163, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 15, 'both_wrong': 41}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 14:09:17,045][root][INFO] - Setting global seed to 206
[2025-03-06 14:09:17,052][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:09:17,052][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:09:17,054][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:09:17,057][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:09:17,059][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:09:17,059][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:09:17,222][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:09:17,471][root][INFO] - Full model selected, loading model
[2025-03-06 14:09:35,667][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:09:35,667][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:09:42,252][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:09:42,254][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 14:09:42,254][root][INFO] - Starting inference
[2025-03-06 14:09:42,447][root][INFO] - Processing question number 0
[2025-03-06 14:09:42,450][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:10:12,893][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:10:44,280][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:11:15,211][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:11:46,626][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:12:17,476][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:12:48,290][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:13:19,944][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:13:51,097][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:14:21,876][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:14:53,304][root][INFO] - Processing question number 10
[2025-03-06 14:14:53,306][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:15:26,102][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:15:56,629][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:16:27,701][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:16:59,426][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:17:31,128][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:18:01,741][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:18:32,272][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:19:03,285][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:19:34,280][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:20:05,052][root][INFO] - Processing question number 20
[2025-03-06 14:20:05,054][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:20:36,029][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:21:07,242][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:21:37,854][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:22:08,385][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:22:39,700][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:23:10,740][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:23:42,604][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:24:13,603][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:24:44,861][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:25:15,339][root][INFO] - Processing question number 30
[2025-03-06 14:25:15,342][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:25:46,726][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:26:18,512][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:26:49,572][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:27:20,410][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:27:51,142][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:28:22,671][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:28:53,479][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:29:24,691][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:29:55,706][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:30:27,444][root][INFO] - Processing question number 40
[2025-03-06 14:30:27,447][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:30:58,514][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:31:29,577][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:32:01,148][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:32:32,673][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:33:03,399][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:33:34,430][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:34:06,696][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:34:36,806][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:35:07,669][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:35:39,275][root][INFO] - Processing question number 50
[2025-03-06 14:35:39,279][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:36:11,059][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:36:42,211][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:37:12,561][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:37:44,787][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:38:16,046][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:38:46,324][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:39:18,130][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:39:48,635][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:40:20,244][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:40:52,647][root][INFO] - Processing question number 60
[2025-03-06 14:40:52,652][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:41:23,127][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:41:53,960][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:42:25,484][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:42:55,941][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:43:26,958][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:43:58,017][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:44:29,109][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:45:00,454][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:45:31,623][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:46:03,332][root][INFO] - Processing question number 70
[2025-03-06 14:46:03,336][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:46:34,143][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:47:04,990][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:47:35,706][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:48:07,028][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:48:38,297][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:49:08,906][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:49:40,286][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:50:11,503][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:50:42,875][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:51:13,685][root][INFO] - Processing question number 80
[2025-03-06 14:51:13,690][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:51:44,938][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:52:16,174][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:52:46,913][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:53:17,686][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:53:49,318][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:54:20,661][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:54:52,062][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:55:22,804][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:55:54,009][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:56:24,483][root][INFO] - Processing question number 90
[2025-03-06 14:56:24,489][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:56:56,429][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:57:26,398][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:57:57,238][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:58:27,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:58:58,786][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:59:29,233][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:00:00,010][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:00:31,109][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:01:02,701][root][INFO] - Inference complete
[2025-03-06 15:01:02,701][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,708][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,710][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,710][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,711][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,713][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,713][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,713][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,714][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,715][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,715][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,715][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,715][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,716][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,716][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,717][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,717][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,718][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,718][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,718][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,719][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,719][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,719][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,721][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,721][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,721][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,725][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,725][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,726][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,727][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,727][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,727][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,728][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,728][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,728][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,729][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,729][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,729][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,730][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,731][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,731][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,731][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,731][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:01:02,732][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,732][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,732][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,732][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,734][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:01:02,734][root][WARNING] - |Q. 92||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:01:02,734][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:01:02,736][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,742][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,742][root][INFO] - Saved parsed outputs
[2025-03-06 15:01:02,742][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,744][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,744][root][INFO] - Saved parsing metadata
[2025-03-06 15:01:02,744][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,746][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:01:02,747][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:01:02,761][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 15:01:02,761][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.15151515151515152, 'malformed_label': 16, 'malformed_domain': 45, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.2222222222222222, 'Evidence_confidence': 0.04040404040404041, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 13, 'both_wrong': 32}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 15:01:10,630][root][INFO] - Setting global seed to 989
[2025-03-06 15:01:10,638][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 15:01:10,638][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:01:10,640][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:01:10,641][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:01:10,643][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:01:10,644][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:01:10,851][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:01:11,217][root][INFO] - Full model selected, loading model
[2025-03-06 15:01:28,714][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:02:34,969][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:02:34,970][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:03:02,363][root][INFO] - Peft model loaded successfully
[2025-03-06 15:03:08,501][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:03:08,503][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:03:08,503][root][INFO] - Starting inference
[2025-03-06 15:03:08,702][root][INFO] - Processing question number 0
[2025-03-06 15:03:08,705][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:03:39,084][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:04:10,248][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:04:40,972][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:05:12,152][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:05:33,702][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:06:04,302][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:06:35,721][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:07:06,682][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:07:37,263][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:08:08,494][root][INFO] - Processing question number 10
[2025-03-06 15:08:08,538][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:08:41,176][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:09:05,376][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:09:27,645][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:09:59,149][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:10:30,632][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:11:01,066][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:11:31,385][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:12:02,244][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:12:33,089][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:13:03,647][root][INFO] - Processing question number 20
[2025-03-06 15:13:03,656][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:13:34,425][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:14:05,426][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:14:35,956][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:15:06,587][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:15:37,874][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:16:08,938][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:16:40,650][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:17:11,455][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:17:42,397][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:18:12,634][root][INFO] - Processing question number 30
[2025-03-06 15:18:12,640][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:18:43,752][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:19:15,224][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:19:46,226][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:20:17,015][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:20:47,766][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:21:19,299][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:21:50,099][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:22:21,320][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:22:52,351][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:23:24,109][root][INFO] - Processing question number 40
[2025-03-06 15:23:24,113][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:23:55,173][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:24:26,204][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:24:57,754][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:25:29,250][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:25:59,957][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:26:24,895][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:26:57,210][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:27:27,312][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:27:58,201][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:28:29,853][root][INFO] - Processing question number 50
[2025-03-06 15:28:29,908][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:29:01,807][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:29:33,085][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:30:03,591][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:30:35,812][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:31:07,085][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:31:37,363][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:32:09,254][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:32:39,943][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:33:11,693][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:33:44,082][root][INFO] - Processing question number 60
[2025-03-06 15:33:44,155][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:34:14,889][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:34:45,952][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:35:17,701][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:35:48,299][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:36:19,447][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:36:50,625][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:37:15,766][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:37:47,312][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:38:18,552][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:38:50,356][root][INFO] - Processing question number 70
[2025-03-06 15:38:50,378][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:39:21,272][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:39:52,244][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:40:23,080][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:40:54,570][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:41:25,901][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:41:56,601][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:42:28,159][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:42:59,476][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:43:31,031][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:44:01,936][root][INFO] - Processing question number 80
[2025-03-06 15:44:01,995][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:44:33,340][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:45:04,665][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:45:35,495][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:46:06,389][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:46:38,076][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:47:09,605][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:47:41,169][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:48:12,000][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:48:43,364][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:49:14,007][root][INFO] - Processing question number 90
[2025-03-06 15:49:14,013][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:49:46,082][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:50:16,230][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:50:47,240][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:51:17,537][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:51:49,077][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:52:19,632][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:52:50,495][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:53:21,669][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:53:53,375][root][INFO] - Inference complete
[2025-03-06 15:53:53,375][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,429][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,431][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,431][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,432][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,438][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,438][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,438][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,439][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,439][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:53:53,439][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,441][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,442][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,442][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,443][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,444][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,444][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,444][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,445][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,445][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,445][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,446][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,446][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,447][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,448][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:53:53,448][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,449][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:53:53,449][root][WARNING] - |Q. 36||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:53:53,449][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:53:53,451][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,458][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,458][root][INFO] - Saved parsed outputs
[2025-03-06 15:53:53,458][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,459][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,459][root][INFO] - Saved parsing metadata
[2025-03-06 15:53:53,460][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,461][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:53:53,463][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:53:53,495][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 15:53:53,495][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.18181818181818182, 'malformed_label': 9, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.16161616161616163, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 23, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 15:54:03,302][root][INFO] - Setting global seed to 989
[2025-03-06 15:54:03,311][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 15:54:03,311][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:54:03,312][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:54:03,314][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:54:03,317][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:54:03,317][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:54:03,470][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:54:03,754][root][INFO] - Full model selected, loading model
[2025-03-06 15:54:23,197][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:54:23,197][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:54:29,525][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:54:29,526][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 15:54:29,526][root][INFO] - Starting inference
[2025-03-06 15:54:29,720][root][INFO] - Processing question number 0
[2025-03-06 15:54:29,729][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:54:59,906][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:55:31,026][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:56:01,693][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:56:32,840][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:57:03,438][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:57:33,985][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:58:05,368][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:58:36,253][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:59:06,747][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:59:37,902][root][INFO] - Processing question number 10
[2025-03-06 15:59:37,904][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:00:10,423][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:00:40,690][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:01:11,465][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:01:42,918][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:02:14,344][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:02:44,672][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:03:14,939][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:03:45,685][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:04:16,413][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:04:46,912][root][INFO] - Processing question number 20
[2025-03-06 16:04:46,914][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:05:17,616][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:05:48,562][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:06:18,917][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:06:49,227][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 16:07:20,264][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:07:51,024][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:08:22,623][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:08:53,349][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:09:24,246][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:09:54,436][root][INFO] - Processing question number 30
[2025-03-06 16:09:54,439][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:10:25,526][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:10:56,960][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:11:27,861][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:11:58,541][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:12:29,112][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:13:00,494][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:13:31,146][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:14:02,235][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:14:33,121][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:15:04,726][root][INFO] - Processing question number 40
[2025-03-06 16:15:04,730][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:15:35,706][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:16:06,704][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 16:16:38,191][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 16:17:09,629][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 16:17:40,264][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:18:11,220][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 16:18:43,349][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:19:13,345][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 16:19:44,066][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 16:20:15,555][root][INFO] - Processing question number 50
[2025-03-06 16:20:15,571][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:20:47,220][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:21:18,234][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:21:48,435][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:22:20,365][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:22:51,338][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:23:21,327][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:23:52,729][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:24:22,871][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:24:54,136][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:25:26,218][root][INFO] - Processing question number 60
[2025-03-06 16:25:26,223][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:25:56,426][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:26:27,000][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:26:58,437][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:27:28,725][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:27:59,526][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:28:30,425][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:29:01,339][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:29:32,547][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:30:03,665][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:30:35,373][root][INFO] - Processing question number 70
[2025-03-06 16:30:35,377][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:31:06,094][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:31:36,778][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:32:07,325][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:32:38,482][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:33:09,600][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:33:40,051][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:34:11,263][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:34:42,332][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:35:13,550][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:35:44,190][root][INFO] - Processing question number 80
[2025-03-06 16:35:44,196][root][INFO] - Domain : Property, Question : 67
[2025-03-06 16:36:15,288][root][INFO] - Domain : Property, Question : 75
[2025-03-06 16:36:46,376][root][INFO] - Domain : Property, Question : 83
[2025-03-06 16:37:16,944][root][INFO] - Domain : Property, Question : 89
[2025-03-06 16:37:47,562][root][INFO] - Domain : Property, Question : 97
[2025-03-06 16:38:18,986][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:38:50,138][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 16:39:21,348][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:39:51,906][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:40:22,916][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:40:53,203][root][INFO] - Processing question number 90
[2025-03-06 16:40:53,208][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:41:24,980][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:41:54,771][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:42:25,372][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:42:55,365][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:43:26,495][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:43:56,696][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:44:27,210][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:44:58,105][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:45:29,556][root][INFO] - Inference complete
[2025-03-06 16:45:29,556][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,563][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,563][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,564][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,564][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,566][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,566][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,567][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,568][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,569][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,569][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,570][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,570][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,570][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,571][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,571][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,571][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,572][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,572][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,572][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,573][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,574][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,574][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,575][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,575][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,576][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,576][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,576][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,577][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,577][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,577][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,577][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,578][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,578][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,578][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,579][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,579][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,580][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,580][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,580][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,580][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,581][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,581][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,581][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,582][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,582][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,582][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,583][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,583][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,583][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,584][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,584][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,584][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,584][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,585][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,585][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,585][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,586][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,586][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,586][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,587][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,587][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,588][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,589][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,589][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,589][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,590][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,590][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,590][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,590][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,591][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,591][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,591][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,591][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,592][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,592][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,592][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,592][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,593][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,593][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,593][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,594][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,594][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,594][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,594][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,594][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,595][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,595][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,596][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,596][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,596][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:45:29,596][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,597][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,597][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,597][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,597][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,598][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,598][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,598][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,598][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,598][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,599][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,599][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,599][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,599][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,600][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,600][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,600][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:45:29,601][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:45:29,601][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:45:29,602][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,609][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,609][root][INFO] - Saved parsed outputs
[2025-03-06 16:45:29,609][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,610][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,610][root][INFO] - Saved parsing metadata
[2025-03-06 16:45:29,611][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,612][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:45:29,613][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:45:29,642][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 16:45:29,642][root][INFO] - Summary of metrics : {'label_accuracy': 0.18181818181818182, 'misclassification_rate': 0.8181818181818181, 'combined_accuracy': 0.08080808080808081, 'malformed_label': 36, 'malformed_domain': 48, 'total_predictions': 99, 'correct_predictions': 18, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 10, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 16:45:42,931][root][INFO] - Setting global seed to 989
[2025-03-06 16:45:42,975][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 16:45:42,976][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:45:42,977][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 16:45:43,038][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:45:43,041][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:45:43,041][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 16:45:43,199][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:45:43,524][root][INFO] - Full model selected, loading model
[2025-03-06 16:46:03,957][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:47:04,986][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:47:04,987][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:47:30,742][root][INFO] - Peft model loaded successfully
[2025-03-06 16:47:36,837][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:47:36,839][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 16:47:36,839][root][INFO] - Starting inference
[2025-03-06 16:47:37,055][root][INFO] - Processing question number 0
[2025-03-06 16:47:37,058][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 16:48:07,635][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 16:48:29,555][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 16:49:00,379][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 16:49:31,781][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 16:49:53,671][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 16:50:24,447][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 16:50:56,097][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 16:51:27,220][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 16:51:57,968][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 16:52:29,348][root][INFO] - Processing question number 10
[2025-03-06 16:52:29,350][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:53:02,181][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:53:32,748][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:53:54,932][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:54:26,614][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:54:58,288][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:55:28,908][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:55:59,404][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:56:30,647][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:57:01,808][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:57:32,671][root][INFO] - Processing question number 20
[2025-03-06 16:57:32,674][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:58:03,819][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:58:34,991][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:59:05,598][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:59:36,146][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 17:00:07,424][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 17:00:38,479][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 17:01:10,227][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 17:01:41,127][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 17:02:12,274][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 17:02:42,711][root][INFO] - Processing question number 30
[2025-03-06 17:02:42,714][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:03:14,043][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 17:03:45,729][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 17:04:16,882][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 17:04:47,718][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 17:05:18,421][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 17:05:49,924][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 17:06:20,813][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 17:06:52,131][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:07:23,252][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 17:07:55,117][root][INFO] - Processing question number 40
[2025-03-06 17:07:55,120][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:08:26,297][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 17:08:57,480][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 17:09:29,172][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 17:10:00,809][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 17:10:31,676][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:11:02,828][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 17:11:35,153][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:12:05,301][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 17:12:36,218][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 17:13:07,809][root][INFO] - Processing question number 50
[2025-03-06 17:13:07,813][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:13:39,592][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 17:14:10,706][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 17:14:41,015][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 17:15:13,091][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 17:15:44,189][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:16:14,441][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 17:16:46,290][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 17:17:16,949][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 17:17:48,654][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 17:18:21,155][root][INFO] - Processing question number 60
[2025-03-06 17:18:21,159][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:18:51,791][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:19:13,256][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 17:19:44,912][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 17:20:15,534][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 17:20:46,657][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 17:21:17,833][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 17:21:49,046][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 17:22:20,593][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:22:51,869][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 17:23:23,610][root][INFO] - Processing question number 70
[2025-03-06 17:23:23,616][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 17:23:54,439][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 17:24:25,334][root][INFO] - Domain : Property, Question : 6
[2025-03-06 17:24:56,040][root][INFO] - Domain : Property, Question : 13
[2025-03-06 17:25:27,452][root][INFO] - Domain : Property, Question : 20
[2025-03-06 17:25:58,708][root][INFO] - Domain : Property, Question : 33
[2025-03-06 17:26:29,416][root][INFO] - Domain : Property, Question : 39
[2025-03-06 17:27:01,009][root][INFO] - Domain : Property, Question : 48
[2025-03-06 17:27:32,347][root][INFO] - Domain : Property, Question : 54
[2025-03-06 17:28:03,950][root][INFO] - Domain : Property, Question : 61
[2025-03-06 17:28:34,881][root][INFO] - Processing question number 80
[2025-03-06 17:28:34,886][root][INFO] - Domain : Property, Question : 67
[2025-03-06 17:29:06,257][root][INFO] - Domain : Property, Question : 75
[2025-03-06 17:29:37,614][root][INFO] - Domain : Property, Question : 83
[2025-03-06 17:30:08,470][root][INFO] - Domain : Property, Question : 89
[2025-03-06 17:30:39,373][root][INFO] - Domain : Property, Question : 97
[2025-03-06 17:31:11,104][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:31:42,646][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 17:32:14,248][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:32:45,097][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 17:33:16,426][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 17:33:47,056][root][INFO] - Processing question number 90
[2025-03-06 17:33:47,062][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 17:34:19,154][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 17:34:49,308][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 17:35:14,774][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 17:35:45,042][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:36:16,536][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 17:36:47,039][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 17:37:17,820][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 17:37:48,930][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 17:38:20,540][root][INFO] - Inference complete
[2025-03-06 17:38:20,540][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,548][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,549][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,550][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,551][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,551][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,551][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,552][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,553][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,553][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:38:20,553][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,556][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,556][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,557][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,558][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,558][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:38:20,559][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,560][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,560][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,561][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,561][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,561][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,562][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,563][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,563][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,564][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,564][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,564][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:38:20,564][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,565][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,565][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,565][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,566][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,567][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,567][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,568][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:38:20,568][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:38:20,568][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:38:20,571][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,577][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,577][root][INFO] - Saved parsed outputs
[2025-03-06 17:38:20,577][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,578][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,578][root][INFO] - Saved parsing metadata
[2025-03-06 17:38:20,579][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,580][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:20,582][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 17:38:20,595][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 17:38:20,595][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.18181818181818182, 'malformed_label': 12, 'malformed_domain': 51, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1717171717171717, 'Civil_Procedure_confidence': 0.050505050505050504, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 18, 'both_wrong': 33}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 17:38:27,904][root][INFO] - Setting global seed to 989
[2025-03-06 17:38:27,911][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 17:38:27,911][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:38:27,912][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 17:38:27,917][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:38:27,920][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:38:27,920][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 17:38:28,093][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:38:28,354][root][INFO] - Full model selected, loading model
[2025-03-06 17:38:46,391][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:38:46,391][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:38:52,764][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:38:52,765][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 17:38:52,765][root][INFO] - Starting inference
[2025-03-06 17:38:52,955][root][INFO] - Processing question number 0
[2025-03-06 17:38:52,957][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 17:39:23,293][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 17:39:54,564][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 17:40:25,384][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 17:40:56,683][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 17:41:27,419][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 17:41:58,113][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 17:42:29,646][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 17:43:00,682][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 17:43:31,361][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 17:44:02,687][root][INFO] - Processing question number 10
[2025-03-06 17:44:02,689][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 17:44:35,374][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 17:45:05,780][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 17:45:36,707][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 17:46:08,293][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 17:46:39,869][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 17:47:10,351][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 17:47:40,765][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 17:48:11,794][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 17:48:42,664][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 17:49:13,305][root][INFO] - Processing question number 20
[2025-03-06 17:49:13,308][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 17:49:44,170][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 17:50:15,274][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 17:50:45,756][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 17:51:16,159][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 17:51:47,342][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 17:52:18,256][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 17:52:49,882][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 17:53:20,630][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 17:53:51,568][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 17:54:21,795][root][INFO] - Processing question number 30
[2025-03-06 17:54:21,798][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:54:52,937][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 17:55:24,393][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 17:55:55,325][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 17:56:26,030][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 17:56:56,646][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 17:57:28,057][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 17:57:58,747][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 17:58:29,864][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:59:00,791][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 17:59:32,436][root][INFO] - Processing question number 40
[2025-03-06 17:59:32,439][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:00:03,430][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 18:00:34,384][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 18:01:05,850][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 18:01:37,254][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 18:02:07,895][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:02:38,826][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 18:03:10,989][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:03:41,028][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 18:04:11,924][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 18:04:43,559][root][INFO] - Processing question number 50
[2025-03-06 18:04:43,563][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:05:15,361][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 18:05:46,534][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 18:06:16,909][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 18:06:49,004][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 18:07:20,135][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:07:50,280][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 18:08:22,056][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 18:08:52,575][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 18:09:24,195][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 18:09:56,614][root][INFO] - Processing question number 60
[2025-03-06 18:09:56,618][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:10:27,130][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:10:57,989][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 18:11:29,545][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 18:12:00,026][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 18:12:30,935][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 18:13:02,003][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 18:13:33,105][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 18:14:04,482][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:14:35,652][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 18:15:07,358][root][INFO] - Processing question number 70
[2025-03-06 18:15:07,363][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 18:15:38,176][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 18:16:09,025][root][INFO] - Domain : Property, Question : 6
[2025-03-06 18:16:39,762][root][INFO] - Domain : Property, Question : 13
[2025-03-06 18:17:11,101][root][INFO] - Domain : Property, Question : 20
[2025-03-06 18:17:42,402][root][INFO] - Domain : Property, Question : 33
[2025-03-06 18:18:13,000][root][INFO] - Domain : Property, Question : 39
[2025-03-06 18:18:44,377][root][INFO] - Domain : Property, Question : 48
[2025-03-06 18:19:15,585][root][INFO] - Domain : Property, Question : 54
[2025-03-06 18:19:46,939][root][INFO] - Domain : Property, Question : 61
[2025-03-06 18:20:17,724][root][INFO] - Processing question number 80
[2025-03-06 18:20:17,729][root][INFO] - Domain : Property, Question : 67
[2025-03-06 18:20:48,959][root][INFO] - Domain : Property, Question : 75
[2025-03-06 18:21:20,186][root][INFO] - Domain : Property, Question : 83
[2025-03-06 18:21:50,917][root][INFO] - Domain : Property, Question : 89
[2025-03-06 18:22:21,681][root][INFO] - Domain : Property, Question : 97
[2025-03-06 18:22:53,271][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:23:24,564][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 18:23:55,935][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:24:26,560][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 18:24:57,621][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 18:25:27,958][root][INFO] - Processing question number 90
[2025-03-06 18:25:27,964][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 18:25:59,788][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 18:26:29,637][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 18:27:00,355][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 18:27:30,391][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:28:01,651][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 18:28:31,965][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 18:29:02,614][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 18:29:33,588][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 18:30:05,048][root][INFO] - Inference complete
[2025-03-06 18:30:05,048][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,055][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,058][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,059][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,059][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,059][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,059][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,059][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,060][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,060][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,061][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,062][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,062][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,062][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,063][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,063][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,064][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,064][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,064][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,064][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,066][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,066][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,066][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,068][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,068][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,068][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,070][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,070][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,070][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,072][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,072][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,072][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,072][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,073][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,073][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,073][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,074][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,074][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,075][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,075][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,075][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,075][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,076][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,076][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,076][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,077][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,077][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,078][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,078][root][WARNING] - |Q. 86||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,078][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,078][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,079][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,079][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,079][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,079][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,080][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,081][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,081][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,081][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,081][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,082][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,082][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,082][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,083][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,083][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,084][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,085][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,085][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,085][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,086][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,086][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,086][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,086][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,086][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,087][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,087][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:30:05,087][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,088][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,088][root][WARNING] - |Q. 80||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,088][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,088][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:30:05,089][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:30:05,089][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:30:05,090][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,097][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,097][root][INFO] - Saved parsed outputs
[2025-03-06 18:30:05,097][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,098][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,099][root][INFO] - Saved parsing metadata
[2025-03-06 18:30:05,099][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:30:05,102][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 18:30:05,115][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 18:30:05,115][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.12121212121212122, 'malformed_label': 27, 'malformed_domain': 45, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 16, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 18:30:11,971][root][INFO] - Setting global seed to 989
[2025-03-06 18:30:11,976][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 18:30:11,976][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:30:11,978][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 18:30:11,979][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:30:11,981][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:30:11,981][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 18:30:12,149][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:30:12,591][root][INFO] - Full model selected, loading model
[2025-03-06 18:30:23,772][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:31:24,821][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:31:24,822][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:31:50,862][root][INFO] - Peft model loaded successfully
[2025-03-06 18:31:56,951][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:31:56,952][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 18:31:56,953][root][INFO] - Starting inference
[2025-03-06 18:31:57,145][root][INFO] - Processing question number 0
[2025-03-06 18:31:57,147][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 18:32:27,555][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 18:32:58,765][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 18:33:29,557][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 18:34:00,821][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 18:34:31,517][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 18:35:02,183][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 18:35:33,686][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 18:36:04,666][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 18:36:35,287][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 18:37:06,562][root][INFO] - Processing question number 10
[2025-03-06 18:37:06,564][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 18:37:39,283][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 18:38:09,880][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 18:38:40,950][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 18:39:12,650][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 18:39:44,435][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 18:40:15,050][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 18:40:45,539][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 18:41:16,566][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 18:41:47,578][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 18:42:18,304][root][INFO] - Processing question number 20
[2025-03-06 18:42:18,307][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 18:42:49,236][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 18:43:20,399][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 18:43:43,384][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 18:44:13,947][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 18:44:45,209][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 18:45:16,251][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 18:45:34,097][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 18:46:05,091][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 18:46:36,219][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 18:47:06,634][root][INFO] - Processing question number 30
[2025-03-06 18:47:06,637][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:47:37,959][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 18:48:09,617][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 18:48:40,743][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 18:49:11,609][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 18:49:42,385][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 18:50:13,895][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 18:50:44,690][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 18:51:15,938][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:51:46,994][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 18:52:18,814][root][INFO] - Processing question number 40
[2025-03-06 18:52:18,817][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:52:49,929][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 18:53:21,037][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 18:53:52,655][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 18:54:24,158][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 18:54:54,832][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:55:25,782][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 18:55:58,033][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:56:28,105][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 18:56:58,947][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 18:57:30,482][root][INFO] - Processing question number 50
[2025-03-06 18:57:30,486][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:58:02,247][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 18:58:33,347][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 18:59:03,618][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 18:59:35,642][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 19:00:06,692][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:00:36,767][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 19:01:08,452][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 19:01:38,957][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 19:02:10,600][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 19:02:43,010][root][INFO] - Processing question number 60
[2025-03-06 19:02:43,014][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:03:13,564][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:03:44,430][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 19:04:15,977][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 19:04:46,485][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 19:05:17,507][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 19:05:48,577][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 19:06:19,709][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 19:06:51,162][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:07:22,351][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 19:07:54,070][root][INFO] - Processing question number 70
[2025-03-06 19:07:54,075][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 19:08:24,902][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 19:08:46,296][root][INFO] - Domain : Property, Question : 6
[2025-03-06 19:09:17,036][root][INFO] - Domain : Property, Question : 13
[2025-03-06 19:09:48,453][root][INFO] - Domain : Property, Question : 20
[2025-03-06 19:10:19,761][root][INFO] - Domain : Property, Question : 33
[2025-03-06 19:10:50,386][root][INFO] - Domain : Property, Question : 39
[2025-03-06 19:11:21,870][root][INFO] - Domain : Property, Question : 48
[2025-03-06 19:11:53,112][root][INFO] - Domain : Property, Question : 54
[2025-03-06 19:12:24,605][root][INFO] - Domain : Property, Question : 61
[2025-03-06 19:12:55,427][root][INFO] - Processing question number 80
[2025-03-06 19:12:55,435][root][INFO] - Domain : Property, Question : 67
[2025-03-06 19:13:26,714][root][INFO] - Domain : Property, Question : 75
[2025-03-06 19:13:57,952][root][INFO] - Domain : Property, Question : 83
[2025-03-06 19:14:28,708][root][INFO] - Domain : Property, Question : 89
[2025-03-06 19:14:59,492][root][INFO] - Domain : Property, Question : 97
[2025-03-06 19:15:31,119][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:16:02,562][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 19:16:34,071][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:17:04,804][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 19:17:35,933][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 19:18:06,346][root][INFO] - Processing question number 90
[2025-03-06 19:18:06,351][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 19:18:38,233][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 19:19:08,172][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 19:19:39,002][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 19:20:09,199][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:20:40,702][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 19:21:11,216][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 19:21:42,012][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 19:22:13,168][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 19:22:33,045][root][INFO] - Inference complete
[2025-03-06 19:22:33,045][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,053][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,056][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,057][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,057][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,059][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,059][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:22:33,059][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,061][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,062][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,062][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,065][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,066][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,066][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,066][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,067][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,067][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,068][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,069][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:22:33,069][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,070][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,070][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,070][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,071][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,072][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,072][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,072][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,072][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,073][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,073][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,074][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,074][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,075][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:22:33,075][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:22:33,075][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:22:33,077][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,083][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,083][root][INFO] - Saved parsed outputs
[2025-03-06 19:22:33,083][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,084][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,084][root][INFO] - Saved parsing metadata
[2025-03-06 19:22:33,085][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,087][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:33,089][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 19:22:33,102][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 19:22:33,102][root][INFO] - Summary of metrics : {'label_accuracy': 0.25252525252525254, 'misclassification_rate': 0.7474747474747474, 'combined_accuracy': 0.10101010101010101, 'malformed_label': 12, 'malformed_domain': 53, 'total_predictions': 99, 'correct_predictions': 25, 'correct_label_and_domain': 10, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.2222222222222222, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 15, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 19:22:39,325][root][INFO] - Setting global seed to 989
[2025-03-06 19:22:39,330][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 19:22:39,330][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:22:39,332][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 19:22:39,402][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:22:39,404][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:22:39,404][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 19:22:39,565][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:22:39,816][root][INFO] - Full model selected, loading model
[2025-03-06 19:22:51,024][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 19:22:51,025][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 19:22:57,330][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:22:57,332][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 19:22:57,332][root][INFO] - Starting inference
[2025-03-06 19:22:57,532][root][INFO] - Processing question number 0
[2025-03-06 19:22:57,534][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 19:23:28,433][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 19:23:59,614][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 19:24:30,351][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 19:25:01,566][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 19:25:32,251][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 19:26:02,853][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 19:26:34,294][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 19:27:05,240][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 19:27:35,849][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 19:28:07,086][root][INFO] - Processing question number 10
[2025-03-06 19:28:07,088][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 19:28:39,690][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 19:29:10,040][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 19:29:41,068][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 19:30:12,580][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 19:30:44,081][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 19:31:14,473][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 19:31:44,799][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 19:32:15,621][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 19:32:46,404][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 19:33:16,959][root][INFO] - Processing question number 20
[2025-03-06 19:33:16,962][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 19:33:47,721][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 19:34:18,718][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 19:34:49,133][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 19:35:19,475][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 19:35:50,568][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 19:36:21,381][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 19:36:53,016][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 19:37:23,818][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 19:37:54,806][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 19:38:14,373][root][INFO] - Processing question number 30
[2025-03-06 19:38:14,376][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:38:45,552][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 19:39:17,043][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 19:39:48,002][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 19:40:18,733][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 19:40:49,377][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 19:41:20,807][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 19:41:51,514][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 19:42:22,660][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:42:53,628][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 19:43:25,285][root][INFO] - Processing question number 40
[2025-03-06 19:43:25,289][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:43:56,282][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 19:44:27,261][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 19:44:58,678][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 19:45:30,031][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 19:46:00,588][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:46:31,447][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 19:47:03,548][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:47:33,508][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 19:48:04,210][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 19:48:35,626][root][INFO] - Processing question number 50
[2025-03-06 19:48:35,630][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:49:08,985][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 19:49:40,000][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 19:50:10,197][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 19:50:42,098][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 19:51:13,050][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:51:43,054][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 19:52:14,649][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 19:52:44,983][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 19:53:16,414][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 19:53:48,640][root][INFO] - Processing question number 60
[2025-03-06 19:53:48,644][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:54:18,960][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:54:49,640][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 19:55:21,001][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 19:55:51,284][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 19:56:22,119][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 19:56:53,004][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 19:57:23,924][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 19:57:55,109][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:58:26,127][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 19:58:57,683][root][INFO] - Processing question number 70
[2025-03-06 19:58:57,687][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 19:59:28,337][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 19:59:59,005][root][INFO] - Domain : Property, Question : 6
[2025-03-06 20:00:29,554][root][INFO] - Domain : Property, Question : 13
[2025-03-06 20:01:00,722][root][INFO] - Domain : Property, Question : 20
[2025-03-06 20:01:31,821][root][INFO] - Domain : Property, Question : 33
[2025-03-06 20:01:46,601][root][INFO] - Domain : Property, Question : 39
[2025-03-06 20:02:17,792][root][INFO] - Domain : Property, Question : 48
[2025-03-06 20:02:48,847][root][INFO] - Domain : Property, Question : 54
[2025-03-06 20:03:20,036][root][INFO] - Domain : Property, Question : 61
[2025-03-06 20:03:50,666][root][INFO] - Processing question number 80
[2025-03-06 20:03:50,671][root][INFO] - Domain : Property, Question : 67
[2025-03-06 20:04:21,744][root][INFO] - Domain : Property, Question : 75
[2025-03-06 20:04:52,829][root][INFO] - Domain : Property, Question : 83
[2025-03-06 20:05:23,399][root][INFO] - Domain : Property, Question : 89
[2025-03-06 20:05:53,993][root][INFO] - Domain : Property, Question : 97
[2025-03-06 20:06:25,417][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:06:56,577][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 20:07:27,782][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:07:58,323][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 20:08:29,335][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 20:08:59,633][root][INFO] - Processing question number 90
[2025-03-06 20:08:59,638][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 20:09:31,425][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 20:10:01,263][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 20:10:31,956][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 20:11:01,977][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:11:33,191][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 20:12:03,491][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 20:12:34,096][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 20:13:05,030][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 20:13:36,469][root][INFO] - Inference complete
[2025-03-06 20:13:36,469][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,476][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,478][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,479][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,479][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,479][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,479][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,480][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,481][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,481][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,481][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,482][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,482][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,482][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,482][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,483][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,483][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,484][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,484][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,485][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,485][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,485][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,485][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,486][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,486][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,486][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,487][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,487][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,488][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,489][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,489][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,489][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,490][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,490][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,490][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,491][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,492][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,492][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,493][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,493][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,493][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,495][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,496][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,496][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,496][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,496][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,497][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,497][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,497][root][WARNING] - |Q. 78||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,497][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,498][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,498][root][WARNING] - |Q. 86||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,498][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,499][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,499][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,499][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,500][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,501][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,501][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,501][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,501][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,501][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,502][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,503][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,503][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,503][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,504][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,504][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,504][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,504][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,504][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,505][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,505][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:13:36,505][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,506][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:13:36,506][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:13:36,506][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:13:36,507][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,513][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,513][root][INFO] - Saved parsed outputs
[2025-03-06 20:13:36,513][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,515][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,515][root][INFO] - Saved parsing metadata
[2025-03-06 20:13:36,516][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,517][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
[2025-03-06 20:13:36,518][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 20:13:36,676][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_1
[2025-03-06 20:13:36,676][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 25, 'malformed_domain': 53, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.06060606060606061, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 14, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 20:13:49,807][root][INFO] - Setting global seed to 206
[2025-03-06 20:13:49,815][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 20:13:49,815][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:13:49,816][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:13:49,818][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:13:49,825][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:13:49,825][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:13:49,981][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:13:50,243][root][INFO] - Full model selected, loading model
[2025-03-06 20:14:08,243][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:15:07,327][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:15:07,327][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:15:32,610][root][INFO] - Peft model loaded successfully
[2025-03-06 20:15:38,622][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:15:38,623][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 20:15:38,623][root][INFO] - Starting inference
[2025-03-06 20:15:38,832][root][INFO] - Processing question number 0
[2025-03-06 20:15:38,834][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:16:10,096][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:16:41,710][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:17:13,456][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:17:44,756][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:18:15,387][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:18:45,572][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:19:16,139][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:19:47,137][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:20:17,315][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:20:48,169][root][INFO] - Processing question number 10
[2025-03-06 20:20:48,171][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:21:18,108][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:21:41,642][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:22:12,250][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:22:42,317][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:23:13,340][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:23:44,005][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:24:14,568][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:24:45,020][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:25:15,982][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:25:47,132][root][INFO] - Processing question number 20
[2025-03-06 20:25:47,134][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:26:17,070][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:26:47,861][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:27:18,183][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:27:48,650][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:28:19,200][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:28:50,367][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:29:21,011][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:29:51,827][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:30:22,466][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:30:53,761][root][INFO] - Processing question number 30
[2025-03-06 20:30:53,764][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:31:24,451][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:31:54,929][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:32:25,386][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:32:56,617][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:33:27,167][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:33:57,854][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:34:28,493][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:34:59,813][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:35:30,621][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:36:01,466][root][INFO] - Processing question number 40
[2025-03-06 20:36:01,469][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:36:32,272][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:37:02,827][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:37:33,973][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:38:03,935][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:38:35,278][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:39:06,054][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:39:36,676][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:40:07,471][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:40:38,171][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:41:09,172][root][INFO] - Processing question number 50
[2025-03-06 20:41:09,176][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:41:40,498][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:42:10,726][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:42:42,062][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:43:12,969][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:43:43,257][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:44:13,759][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:44:45,221][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:45:16,445][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:45:47,667][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:46:18,616][root][INFO] - Processing question number 60
[2025-03-06 20:46:18,624][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:46:44,465][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:47:15,279][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:47:46,806][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:48:07,176][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:48:38,101][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:49:08,535][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:49:38,811][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:50:08,906][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:50:39,305][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:51:09,647][root][INFO] - Processing question number 70
[2025-03-06 20:51:09,653][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:51:40,584][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:52:11,401][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:52:42,415][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:53:13,957][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:53:44,287][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:54:15,245][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:54:47,256][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:55:18,224][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:55:48,217][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:56:18,604][root][INFO] - Processing question number 80
[2025-03-06 20:56:18,609][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:56:49,951][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:57:21,328][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:57:52,631][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:58:23,581][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:58:55,478][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:59:26,008][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:59:57,193][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:00:28,867][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:00:59,696][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:01:30,604][root][INFO] - Processing question number 90
[2025-03-06 21:01:30,610][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:02:01,479][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:02:32,708][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:03:03,676][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:03:34,456][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:04:05,914][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:04:37,242][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:05:08,221][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:05:38,779][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:06:08,905][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:06:40,278][root][INFO] - Inference complete
[2025-03-06 21:06:40,278][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,287][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,291][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,291][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,292][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,294][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,294][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,295][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,295][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,295][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:40,295][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,296][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,296][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,296][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,297][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,297][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,297][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,298][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,298][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:40,298][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,300][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,300][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,300][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,302][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,302][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:40,302][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,304][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,304][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,304][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,305][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,305][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,305][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,306][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,306][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,307][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,307][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,307][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,307][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,308][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,308][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,309][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,309][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,310][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:06:40,310][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,310][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:06:40,310][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:06:40,311][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:06:40,312][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,318][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,318][root][INFO] - Saved parsed outputs
[2025-03-06 21:06:40,319][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,320][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,320][root][INFO] - Saved parsing metadata
[2025-03-06 21:06:40,321][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,333][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:06:40,334][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:06:40,386][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 21:06:40,386][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.1, 'malformed_label': 15, 'malformed_domain': 51, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 10, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 12, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 21:06:50,650][root][INFO] - Setting global seed to 206
[2025-03-06 21:06:50,660][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 21:06:50,660][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:06:50,661][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:06:50,663][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:06:50,668][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:06:50,668][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:06:50,845][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:06:51,130][root][INFO] - Full model selected, loading model
[2025-03-06 21:07:08,922][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 21:07:08,922][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 21:07:15,413][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:07:15,415][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:07:15,415][root][INFO] - Starting inference
[2025-03-06 21:07:15,626][root][INFO] - Processing question number 0
[2025-03-06 21:07:15,628][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:07:46,744][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:08:18,255][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:08:49,925][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:09:21,039][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:09:51,568][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:10:21,560][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:10:52,082][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:11:23,083][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:11:53,154][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:12:23,813][root][INFO] - Processing question number 10
[2025-03-06 21:12:23,815][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:12:53,724][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:13:24,212][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:13:54,805][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:14:24,896][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:14:55,936][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:15:26,582][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:15:57,158][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:16:27,637][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:16:58,640][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:17:29,736][root][INFO] - Processing question number 20
[2025-03-06 21:17:29,739][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:17:59,688][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:18:30,505][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:19:00,842][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:19:31,333][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:20:01,881][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:20:32,969][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:21:03,581][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:21:34,420][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:22:05,032][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:22:36,334][root][INFO] - Processing question number 30
[2025-03-06 21:22:36,337][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:23:06,997][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:23:37,512][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:24:07,989][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:24:39,257][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:25:09,838][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:25:40,497][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:26:11,112][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:26:42,475][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:27:13,314][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:27:44,177][root][INFO] - Processing question number 40
[2025-03-06 21:27:44,180][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:28:15,006][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:28:45,584][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:29:16,669][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:29:46,651][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:30:18,029][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:30:48,839][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:31:19,440][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:31:50,272][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:32:20,943][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:32:51,993][root][INFO] - Processing question number 50
[2025-03-06 21:32:51,997][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:33:23,368][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:33:53,583][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:34:24,947][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:34:55,893][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:35:26,201][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:35:56,742][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:36:28,221][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:36:59,486][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:37:30,757][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:38:01,749][root][INFO] - Processing question number 60
[2025-03-06 21:38:01,753][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:38:32,527][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:39:03,367][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:39:34,914][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:40:05,955][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:40:36,903][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:41:07,362][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:41:37,606][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:42:07,730][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:42:38,168][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:43:08,544][root][INFO] - Processing question number 70
[2025-03-06 21:43:08,549][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:43:39,500][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:44:10,347][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:44:41,395][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:45:12,959][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:45:43,323][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:46:14,338][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:46:46,346][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:47:17,360][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:47:47,373][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:48:17,789][root][INFO] - Processing question number 80
[2025-03-06 21:48:17,794][root][INFO] - Domain : Property, Question : 69
[2025-03-06 21:48:49,159][root][INFO] - Domain : Property, Question : 81
[2025-03-06 21:49:20,561][root][INFO] - Domain : Property, Question : 88
[2025-03-06 21:49:52,132][root][INFO] - Domain : Property, Question : 91
[2025-03-06 21:50:23,018][root][INFO] - Domain : Property, Question : 94
[2025-03-06 21:50:54,834][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:51:25,284][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:51:56,293][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:52:27,885][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:52:58,627][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:53:29,392][root][INFO] - Processing question number 90
[2025-03-06 21:53:29,397][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:54:00,161][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:54:31,324][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:55:02,230][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:55:32,921][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:56:04,288][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:56:35,550][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:57:06,460][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:57:36,923][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:58:06,958][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:58:38,253][root][INFO] - Inference complete
[2025-03-06 21:58:38,253][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,260][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,261][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,262][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,262][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,263][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,263][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,263][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,264][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,264][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,264][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,264][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,265][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,265][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,265][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,265][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,265][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,266][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,266][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,267][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,267][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,267][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,267][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,268][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,268][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,268][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,270][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,271][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,271][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,271][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,272][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,272][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,274][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,275][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,275][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,275][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,275][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,276][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,277][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,277][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,278][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,279][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,279][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,280][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,280][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,280][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,281][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,282][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,282][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,283][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,283][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,284][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,284][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,284][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,284][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,285][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,285][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,285][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,285][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,286][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,286][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,286][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,287][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,287][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,287][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,288][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,288][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,288][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,288][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,289][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,289][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,290][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,290][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,290][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,291][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,291][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:58:38,291][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,292][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:58:38,292][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:58:38,292][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:58:38,294][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,300][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,300][root][INFO] - Saved parsed outputs
[2025-03-06 21:58:38,300][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,302][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,302][root][INFO] - Saved parsing metadata
[2025-03-06 21:58:38,303][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,304][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 21:58:38,306][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:58:38,352][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 21:58:38,353][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.06, 'malformed_label': 26, 'malformed_domain': 47, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 6, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 10, 'both_wrong': 37}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 21:58:50,787][root][INFO] - Setting global seed to 206
[2025-03-06 21:58:50,795][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 21:58:50,795][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:58:50,797][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:58:50,799][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:58:50,804][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:58:50,804][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:58:50,966][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:58:51,267][root][INFO] - Full model selected, loading model
[2025-03-06 21:59:09,973][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:00:10,755][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:00:10,755][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:00:36,876][root][INFO] - Peft model loaded successfully
[2025-03-06 22:00:42,966][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:00:42,967][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:00:42,968][root][INFO] - Starting inference
[2025-03-06 22:00:43,199][root][INFO] - Processing question number 0
[2025-03-06 22:00:43,202][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:01:15,211][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:01:47,078][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:02:19,078][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:02:50,639][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:03:21,371][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:03:51,508][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:04:22,157][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:04:53,105][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:05:23,330][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:05:48,490][root][INFO] - Processing question number 10
[2025-03-06 22:05:48,492][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:06:18,551][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:06:49,179][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:07:19,974][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:07:50,214][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:08:21,396][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:08:52,251][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:09:22,993][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:09:53,616][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:10:24,764][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:10:56,107][root][INFO] - Processing question number 20
[2025-03-06 22:10:56,109][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:11:26,219][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:11:57,181][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:12:27,672][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:12:58,323][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:13:29,038][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:14:00,372][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:14:31,183][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:15:02,173][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:15:32,990][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:16:04,434][root][INFO] - Processing question number 30
[2025-03-06 22:16:04,437][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:16:35,305][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:17:05,967][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:17:36,595][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:18:08,008][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:18:38,737][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:19:09,602][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:19:40,422][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:20:11,924][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:20:42,914][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:21:13,929][root][INFO] - Processing question number 40
[2025-03-06 22:21:13,933][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:21:44,912][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:22:15,651][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:22:46,983][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:23:17,128][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:23:48,655][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:24:19,617][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:24:50,426][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:25:21,400][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:25:52,278][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:26:23,465][root][INFO] - Processing question number 50
[2025-03-06 22:26:23,470][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:26:54,984][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:27:25,401][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:27:56,920][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:28:28,014][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:28:58,474][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:29:29,166][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:30:00,809][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:30:32,221][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:31:03,647][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:31:34,778][root][INFO] - Processing question number 60
[2025-03-06 22:31:34,783][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:32:05,717][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:32:36,702][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:33:08,413][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:33:39,594][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:34:10,699][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:34:41,307][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:35:11,748][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:35:42,021][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:36:12,613][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:36:43,136][root][INFO] - Processing question number 70
[2025-03-06 22:36:43,140][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:37:14,242][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:37:45,240][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:38:16,427][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:38:48,150][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:39:18,657][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:39:49,800][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:40:21,999][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:40:48,912][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:41:19,074][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:41:49,654][root][INFO] - Processing question number 80
[2025-03-06 22:41:49,659][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:42:21,169][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:42:52,724][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:43:24,204][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:43:55,337][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:44:27,413][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:44:58,143][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:45:29,511][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:46:01,371][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:46:32,383][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:47:03,414][root][INFO] - Processing question number 90
[2025-03-06 22:47:03,420][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:47:34,454][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:48:05,877][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:48:37,032][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:49:07,984][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:49:39,621][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:50:11,147][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:50:42,486][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:51:04,344][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:51:34,752][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:52:06,434][root][INFO] - Inference complete
[2025-03-06 22:52:06,434][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,442][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,444][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,444][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,445][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,447][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,447][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,447][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,449][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,449][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,450][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,451][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,451][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,452][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,455][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,455][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,455][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,456][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,456][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,456][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,457][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,457][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,457][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,457][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,458][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,458][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,459][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,459][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:52:06,459][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,460][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,460][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:52:06,461][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,462][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,462][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,462][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,463][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,463][root][WARNING] - |Q. 18||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,463][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,464][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,464][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:52:06,464][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,464][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:52:06,465][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:52:06,465][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:52:06,467][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,474][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,474][root][INFO] - Saved parsed outputs
[2025-03-06 22:52:06,474][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,476][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,476][root][INFO] - Saved parsing metadata
[2025-03-06 22:52:06,477][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,479][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:06,481][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:52:06,510][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 22:52:06,510][root][INFO] - Summary of metrics : {'label_accuracy': 0.36, 'misclassification_rate': 0.64, 'combined_accuracy': 0.13, 'malformed_label': 14, 'malformed_domain': 54, 'total_predictions': 100, 'correct_predictions': 36, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 23, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 22:52:15,122][root][INFO] - Setting global seed to 206
[2025-03-06 22:52:15,129][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 22:52:15,129][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 22:52:15,130][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:52:15,132][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:52:15,135][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:52:15,135][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:52:15,310][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 22:52:15,578][root][INFO] - Full model selected, loading model
[2025-03-06 22:52:30,670][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 22:52:30,670][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 22:52:36,978][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:52:36,979][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 22:52:36,979][root][INFO] - Starting inference
[2025-03-06 22:52:37,167][root][INFO] - Processing question number 0
[2025-03-06 22:52:37,169][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:53:08,170][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:53:39,880][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:54:11,603][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:54:42,773][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:55:13,365][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:55:43,420][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:56:13,984][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:56:44,846][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:57:14,983][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:57:45,701][root][INFO] - Processing question number 10
[2025-03-06 22:57:45,703][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:58:15,676][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:58:46,218][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:59:16,871][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:59:47,022][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:00:18,127][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:00:48,837][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:01:19,486][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:01:50,023][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:02:21,089][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:02:52,240][root][INFO] - Processing question number 20
[2025-03-06 23:02:52,243][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:03:22,260][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:03:53,135][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:04:23,543][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:04:54,094][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:05:24,713][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:05:55,860][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:06:26,530][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:06:57,418][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:07:28,092][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:07:59,444][root][INFO] - Processing question number 30
[2025-03-06 23:07:59,447][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:08:30,173][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:09:00,745][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:09:31,281][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:10:02,600][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:10:33,239][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:11:03,955][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:11:34,623][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:12:06,033][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:12:36,928][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:13:07,842][root][INFO] - Processing question number 40
[2025-03-06 23:13:07,846][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:13:38,727][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:14:09,366][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:14:40,503][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:15:10,549][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:15:41,976][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:16:12,837][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:16:43,488][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:17:14,361][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:17:45,085][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:18:16,179][root][INFO] - Processing question number 50
[2025-03-06 23:18:16,182][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:18:47,594][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:19:17,859][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:19:49,276][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:20:20,268][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:20:50,638][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:21:21,230][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:21:52,766][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:22:24,079][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:22:55,397][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:23:26,439][root][INFO] - Processing question number 60
[2025-03-06 23:23:26,443][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:23:57,277][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:24:28,166][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:24:59,757][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:25:30,852][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:26:01,853][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:26:32,368][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:27:02,672][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:27:32,846][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:28:03,347][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:28:33,778][root][INFO] - Processing question number 70
[2025-03-06 23:28:33,783][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:29:04,792][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:29:35,696][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:30:06,800][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:30:38,417][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:31:08,836][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:31:39,892][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:32:11,922][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:32:42,990][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:33:13,062][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:33:43,545][root][INFO] - Processing question number 80
[2025-03-06 23:33:43,551][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:34:14,975][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:34:46,435][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:35:17,819][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:35:48,863][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:36:20,840][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:36:51,458][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:37:22,639][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:37:54,391][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:38:25,302][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:38:56,233][root][INFO] - Processing question number 90
[2025-03-06 23:38:56,238][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:39:27,177][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:39:58,507][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:40:29,577][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:41:00,433][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:41:31,967][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:42:03,391][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:42:34,467][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:43:05,106][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:43:35,365][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:44:07,005][root][INFO] - Inference complete
[2025-03-06 23:44:07,005][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,012][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,013][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,014][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,015][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,016][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,017][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,017][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,018][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,018][root][WARNING] - |Q. 8||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:44:07,018][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,019][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,019][root][WARNING] - |Q. 21||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:44:07,019][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,019][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,020][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,020][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,021][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,021][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,021][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,023][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,023][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:44:07,023][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,024][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,024][root][WARNING] - |Q. 65||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:44:07,024][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,026][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,026][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,026][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,027][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,028][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,028][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,028][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,029][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,029][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,030][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,030][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:44:07,030][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,031][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,031][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,031][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,033][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,033][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,033][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,035][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,036][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,036][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,036][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,036][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,036][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,037][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,037][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,038][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,039][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:44:07,039][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:44:07,039][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:44:07,041][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,047][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,048][root][INFO] - Saved parsed outputs
[2025-03-06 23:44:07,048][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,049][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,049][root][INFO] - Saved parsing metadata
[2025-03-06 23:44:07,049][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,051][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:44:07,052][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:44:07,058][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-06 23:44:07,058][root][INFO] - Summary of metrics : {'label_accuracy': 0.31, 'misclassification_rate': 0.69, 'combined_accuracy': 0.16, 'malformed_label': 18, 'malformed_domain': 44, 'total_predictions': 100, 'correct_predictions': 31, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 15, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-06 23:44:13,282][root][INFO] - Setting global seed to 206
[2025-03-06 23:44:13,287][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:44:13,287][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 23:44:13,289][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:44:13,290][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:44:13,292][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:44:13,292][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:44:13,434][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 23:44:13,687][root][INFO] - Full model selected, loading model
[2025-03-06 23:44:24,852][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:45:25,313][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:45:25,313][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:45:51,266][root][INFO] - Peft model loaded successfully
[2025-03-06 23:45:57,348][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:45:57,350][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-06 23:45:57,350][root][INFO] - Starting inference
[2025-03-06 23:45:57,557][root][INFO] - Processing question number 0
[2025-03-06 23:45:57,559][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:46:28,829][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:47:00,490][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:47:32,315][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:48:03,669][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:48:34,361][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:49:04,507][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:49:35,168][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:50:06,127][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:50:36,361][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:51:07,227][root][INFO] - Processing question number 10
[2025-03-06 23:51:07,229][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:51:37,290][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:52:07,935][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:52:38,741][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:53:08,984][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:53:40,174][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:54:11,031][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:54:41,779][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:55:12,417][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:55:43,566][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:56:14,908][root][INFO] - Processing question number 20
[2025-03-06 23:56:14,910][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:56:45,024][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:57:07,325][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:57:37,821][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:58:08,477][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:58:39,190][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:59:10,528][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:59:41,352][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:00:12,342][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:00:43,174][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:01:14,632][root][INFO] - Processing question number 30
[2025-03-07 00:01:14,635][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:01:45,515][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:02:16,190][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:02:46,831][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:03:18,255][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 00:03:49,006][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 00:04:16,029][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 00:04:46,938][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 00:05:18,450][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 00:05:49,467][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 00:06:20,481][root][INFO] - Processing question number 40
[2025-03-07 00:06:20,485][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 00:06:51,472][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 00:07:22,213][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 00:07:53,559][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 00:08:23,705][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 00:08:55,230][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 00:09:26,181][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 00:09:56,988][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 00:10:27,969][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 00:10:58,842][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 00:11:30,022][root][INFO] - Processing question number 50
[2025-03-07 00:11:30,026][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 00:12:01,538][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 00:12:31,953][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 00:13:03,475][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 00:13:34,568][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 00:14:05,034][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 00:14:35,739][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 00:15:07,381][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 00:15:38,786][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 00:16:10,209][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 00:16:41,338][root][INFO] - Processing question number 60
[2025-03-07 00:16:41,342][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 00:17:12,270][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 00:17:43,254][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 00:18:14,959][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 00:18:46,136][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 00:19:17,239][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 00:19:33,539][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 00:20:03,993][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 00:20:34,271][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 00:21:04,869][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 00:21:35,397][root][INFO] - Processing question number 70
[2025-03-07 00:21:35,402][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 00:22:06,518][root][INFO] - Domain : Property, Question : 9
[2025-03-07 00:22:37,515][root][INFO] - Domain : Property, Question : 17
[2025-03-07 00:23:08,705][root][INFO] - Domain : Property, Question : 25
[2025-03-07 00:23:40,432][root][INFO] - Domain : Property, Question : 30
[2025-03-07 00:24:10,946][root][INFO] - Domain : Property, Question : 36
[2025-03-07 00:24:42,092][root][INFO] - Domain : Property, Question : 46
[2025-03-07 00:25:14,290][root][INFO] - Domain : Property, Question : 53
[2025-03-07 00:25:45,459][root][INFO] - Domain : Property, Question : 59
[2025-03-07 00:26:15,624][root][INFO] - Domain : Property, Question : 66
[2025-03-07 00:26:46,203][root][INFO] - Processing question number 80
[2025-03-07 00:26:46,208][root][INFO] - Domain : Property, Question : 69
[2025-03-07 00:27:17,725][root][INFO] - Domain : Property, Question : 81
[2025-03-07 00:27:49,287][root][INFO] - Domain : Property, Question : 88
[2025-03-07 00:28:20,773][root][INFO] - Domain : Property, Question : 91
[2025-03-07 00:28:51,904][root][INFO] - Domain : Property, Question : 94
[2025-03-07 00:29:23,985][root][INFO] - Domain : Property, Question : 100
[2025-03-07 00:29:54,710][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 00:30:26,085][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 00:30:57,944][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 00:31:28,962][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 00:31:59,999][root][INFO] - Processing question number 90
[2025-03-07 00:32:00,005][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 00:32:22,618][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 00:32:54,046][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 00:33:25,206][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 00:33:56,166][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 00:34:27,806][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 00:34:59,334][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 00:35:30,513][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 00:36:01,353][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 00:36:31,786][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 00:37:03,340][root][INFO] - Inference complete
[2025-03-07 00:37:03,340][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,347][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,348][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,349][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,349][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,350][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,350][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,351][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,351][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,352][root][WARNING] - |Q. 99||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,352][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,353][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,354][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,355][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,355][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,355][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,355][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,357][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,357][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,357][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,358][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,358][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,358][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,359][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,360][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,360][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,360][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,360][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,361][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,361][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,362][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,362][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,364][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,364][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,364][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,364][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,365][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,365][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,366][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,366][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,366][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,367][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,367][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,367][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,369][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,369][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,369][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,370][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,370][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,370][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,371][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,371][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,371][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,372][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,372][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,372][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,372][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,373][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,373][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,373][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,373][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 00:37:03,373][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,374][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,374][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,374][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,374][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:37:03,375][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:37:03,375][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:37:03,376][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,382][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,382][root][INFO] - Saved parsed outputs
[2025-03-07 00:37:03,382][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,384][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,384][root][INFO] - Saved parsing metadata
[2025-03-07 00:37:03,384][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,386][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:03,387][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 00:37:03,394][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 00:37:03,394][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.08, 'malformed_label': 22, 'malformed_domain': 61, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 14, 'both_wrong': 47}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 00:37:09,703][root][INFO] - Setting global seed to 206
[2025-03-07 00:37:09,708][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-07 00:37:09,708][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 00:37:09,709][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 00:37:09,710][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 00:37:09,712][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 00:37:09,712][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 00:37:09,856][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 00:37:10,189][root][INFO] - Full model selected, loading model
[2025-03-07 00:37:24,819][root][INFO] - Baseline model selected, no adapter needed
[2025-03-07 00:37:24,819][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-07 00:37:31,197][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 00:37:31,198][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 00:37:31,198][root][INFO] - Starting inference
[2025-03-07 00:37:31,418][root][INFO] - Processing question number 0
[2025-03-07 00:37:31,421][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 00:38:02,688][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 00:38:34,388][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 00:39:06,239][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 00:39:37,540][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 00:40:08,260][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 00:40:38,446][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 00:41:09,139][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 00:41:40,130][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 00:42:10,394][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 00:42:41,244][root][INFO] - Processing question number 10
[2025-03-07 00:42:41,246][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 00:43:11,346][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 00:43:42,020][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 00:44:12,800][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 00:44:43,085][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 00:45:14,311][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 00:45:45,150][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 00:46:15,922][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 00:46:46,587][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 00:47:17,779][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 00:47:49,058][root][INFO] - Processing question number 20
[2025-03-07 00:47:49,061][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 00:48:19,206][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 00:48:50,211][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 00:49:20,745][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 00:49:51,425][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 00:50:22,169][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 00:50:53,441][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 00:51:24,241][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:51:55,260][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:52:26,058][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:52:57,608][root][INFO] - Processing question number 30
[2025-03-07 00:52:57,626][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:53:28,485][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:53:59,188][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:54:29,852][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:55:01,304][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 00:55:32,078][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 00:56:02,926][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 00:56:33,720][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 00:57:05,259][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 00:57:36,283][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 00:58:07,326][root][INFO] - Processing question number 40
[2025-03-07 00:58:07,330][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 00:58:38,337][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 00:59:09,104][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 00:59:40,372][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 01:00:10,551][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 01:00:42,107][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 01:01:13,100][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 01:01:43,883][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 01:02:14,891][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 01:02:45,749][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 01:03:16,979][root][INFO] - Processing question number 50
[2025-03-07 01:03:16,983][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 01:03:48,530][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 01:04:18,933][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 01:04:50,483][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 01:05:21,609][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 01:05:52,108][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 01:06:22,836][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 01:06:54,501][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 01:07:25,947][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 01:07:57,397][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 01:08:28,570][root][INFO] - Processing question number 60
[2025-03-07 01:08:28,574][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 01:08:59,535][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 01:09:30,555][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 01:10:02,277][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 01:10:33,495][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 01:11:04,623][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 01:11:35,268][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 01:12:05,703][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 01:12:36,014][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 01:13:06,643][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 01:13:37,206][root][INFO] - Processing question number 70
[2025-03-07 01:13:37,211][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 01:14:08,347][root][INFO] - Domain : Property, Question : 9
[2025-03-07 01:14:39,378][root][INFO] - Domain : Property, Question : 17
[2025-03-07 01:15:10,608][root][INFO] - Domain : Property, Question : 25
[2025-03-07 01:15:42,346][root][INFO] - Domain : Property, Question : 30
[2025-03-07 01:16:12,894][root][INFO] - Domain : Property, Question : 36
[2025-03-07 01:16:44,077][root][INFO] - Domain : Property, Question : 46
[2025-03-07 01:17:16,234][root][INFO] - Domain : Property, Question : 53
[2025-03-07 01:17:47,430][root][INFO] - Domain : Property, Question : 59
[2025-03-07 01:18:17,629][root][INFO] - Domain : Property, Question : 66
[2025-03-07 01:18:48,239][root][INFO] - Processing question number 80
[2025-03-07 01:18:48,244][root][INFO] - Domain : Property, Question : 69
[2025-03-07 01:19:19,792][root][INFO] - Domain : Property, Question : 81
[2025-03-07 01:19:51,375][root][INFO] - Domain : Property, Question : 88
[2025-03-07 01:20:22,886][root][INFO] - Domain : Property, Question : 91
[2025-03-07 01:20:54,058][root][INFO] - Domain : Property, Question : 94
[2025-03-07 01:21:26,162][root][INFO] - Domain : Property, Question : 100
[2025-03-07 01:21:56,912][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 01:22:28,215][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 01:23:00,099][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 01:23:31,139][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 01:24:02,205][root][INFO] - Processing question number 90
[2025-03-07 01:24:02,211][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 01:24:33,279][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 01:25:04,740][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 01:25:35,941][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 01:26:06,928][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 01:26:38,772][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 01:27:10,514][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 01:27:41,911][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 01:28:12,952][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 01:28:43,287][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 01:29:14,864][root][INFO] - Inference complete
[2025-03-07 01:29:14,864][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,872][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,873][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,873][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,874][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,875][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,875][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,875][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,877][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,877][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,877][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,880][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,880][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,880][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,880][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,881][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,881][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,882][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,883][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,883][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,883][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,883][root][WARNING] - |Q. 58||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,883][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,884][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,884][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,884][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,884][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,885][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,885][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,886][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,886][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,886][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,887][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,887][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,887][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,889][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,890][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,890][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,891][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,891][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,891][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,892][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,892][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,893][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,893][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,893][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,893][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,894][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,894][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 01:29:14,894][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,894][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,894][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,895][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,896][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,896][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,897][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,897][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,897][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,898][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,898][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,898][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,899][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,899][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 01:29:14,899][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 01:29:14,899][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 01:29:14,902][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,909][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,909][root][INFO] - Saved parsed outputs
[2025-03-07 01:29:14,909][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,910][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,910][root][INFO] - Saved parsing metadata
[2025-03-07 01:29:14,911][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,913][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:29:14,914][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 01:29:14,921][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 01:29:14,921][root][INFO] - Summary of metrics : {'label_accuracy': 0.25, 'misclassification_rate': 0.75, 'combined_accuracy': 0.13, 'malformed_label': 21, 'malformed_domain': 43, 'total_predictions': 100, 'correct_predictions': 25, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.24, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 12, 'both_wrong': 31}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 01:29:21,105][root][INFO] - Setting global seed to 989
[2025-03-07 01:29:21,111][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 01:29:21,111][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 01:29:21,112][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 01:29:21,114][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 01:29:21,115][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 01:29:21,116][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 01:29:21,261][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 01:29:21,501][root][INFO] - Full model selected, loading model
[2025-03-07 01:29:32,710][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-07 01:30:33,517][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 01:30:33,518][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 01:30:59,709][root][INFO] - Peft model loaded successfully
[2025-03-07 01:31:05,829][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 01:31:05,831][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 01:31:05,831][root][INFO] - Starting inference
[2025-03-07 01:31:06,006][root][INFO] - Processing question number 0
[2025-03-07 01:31:06,009][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 01:31:37,093][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 01:32:08,696][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 01:32:40,678][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 01:33:11,961][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 01:33:42,585][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 01:34:12,685][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 01:34:43,284][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 01:35:14,181][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 01:35:44,350][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 01:36:15,156][root][INFO] - Processing question number 10
[2025-03-07 01:36:15,158][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 01:36:45,160][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 01:37:08,801][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 01:37:39,545][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 01:38:09,733][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 01:38:40,856][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 01:39:11,640][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 01:39:42,330][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 01:40:12,900][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 01:40:43,981][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 01:41:15,247][root][INFO] - Processing question number 20
[2025-03-07 01:41:15,249][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 01:41:45,307][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 01:42:16,226][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 01:42:46,655][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 01:43:17,238][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 01:43:47,901][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 01:44:19,172][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 01:44:49,925][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 01:45:20,840][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 01:45:51,587][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 01:46:22,966][root][INFO] - Processing question number 30
[2025-03-07 01:46:22,969][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 01:46:53,757][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 01:47:24,348][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 01:47:54,922][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 01:48:26,262][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 01:48:56,937][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 01:49:27,740][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 01:49:58,492][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 01:50:29,926][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 01:51:00,846][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 01:51:31,795][root][INFO] - Processing question number 40
[2025-03-07 01:51:31,799][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 01:52:02,715][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 01:52:33,392][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 01:53:04,654][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 01:53:34,743][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 01:54:06,206][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 01:54:37,097][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 01:55:07,836][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 01:55:38,738][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 01:56:09,544][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 01:56:40,660][root][INFO] - Processing question number 50
[2025-03-07 01:56:40,664][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 01:57:12,106][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 01:57:42,452][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 01:58:13,911][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 01:58:44,935][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 01:59:15,350][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 01:59:45,969][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 02:00:17,546][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 02:00:48,894][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 02:01:20,243][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 02:01:51,308][root][INFO] - Processing question number 60
[2025-03-07 02:01:51,313][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 02:02:17,254][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 02:02:48,190][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 02:03:19,835][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 02:03:40,289][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 02:04:11,330][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 02:04:41,879][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 02:05:12,272][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 02:05:42,486][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 02:06:13,008][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 02:06:43,471][root][INFO] - Processing question number 70
[2025-03-07 02:06:43,476][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 02:07:14,524][root][INFO] - Domain : Property, Question : 9
[2025-03-07 02:07:45,464][root][INFO] - Domain : Property, Question : 17
[2025-03-07 02:08:16,597][root][INFO] - Domain : Property, Question : 25
[2025-03-07 02:08:48,256][root][INFO] - Domain : Property, Question : 30
[2025-03-07 02:09:18,709][root][INFO] - Domain : Property, Question : 36
[2025-03-07 02:09:49,781][root][INFO] - Domain : Property, Question : 46
[2025-03-07 02:10:21,905][root][INFO] - Domain : Property, Question : 53
[2025-03-07 02:10:52,986][root][INFO] - Domain : Property, Question : 59
[2025-03-07 02:11:23,093][root][INFO] - Domain : Property, Question : 66
[2025-03-07 02:11:53,585][root][INFO] - Processing question number 80
[2025-03-07 02:11:53,590][root][INFO] - Domain : Property, Question : 69
[2025-03-07 02:12:25,045][root][INFO] - Domain : Property, Question : 81
[2025-03-07 02:12:56,537][root][INFO] - Domain : Property, Question : 88
[2025-03-07 02:13:27,950][root][INFO] - Domain : Property, Question : 91
[2025-03-07 02:13:59,014][root][INFO] - Domain : Property, Question : 94
[2025-03-07 02:14:31,020][root][INFO] - Domain : Property, Question : 100
[2025-03-07 02:15:01,664][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 02:15:32,956][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 02:16:04,734][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 02:16:35,669][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 02:17:06,623][root][INFO] - Processing question number 90
[2025-03-07 02:17:06,629][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 02:17:37,598][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 02:18:08,974][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 02:18:40,302][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 02:19:11,187][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 02:19:42,755][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 02:20:14,197][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 02:20:45,294][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 02:21:15,965][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 02:21:46,209][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 02:22:17,693][root][INFO] - Inference complete
[2025-03-07 02:22:17,694][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,701][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,705][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,705][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,706][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,708][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,709][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,709][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,709][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,709][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 02:22:17,709][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,710][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,710][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,711][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,711][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,711][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,711][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,712][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,712][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 02:22:17,713][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,714][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,714][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,714][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,717][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,717][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 02:22:17,717][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,718][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,718][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,719][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,719][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,719][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,719][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,720][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,721][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,721][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,721][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,722][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,722][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,723][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,723][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,723][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,724][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,724][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 02:22:17,724][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,725][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 02:22:17,725][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 02:22:17,725][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 02:22:17,727][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,733][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,733][root][INFO] - Saved parsed outputs
[2025-03-07 02:22:17,733][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,734][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,734][root][INFO] - Saved parsing metadata
[2025-03-07 02:22:17,735][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,737][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:17,738][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 02:22:17,761][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 02:22:17,761][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.1, 'malformed_label': 15, 'malformed_domain': 51, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 10, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.06, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 12, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 02:22:24,909][root][INFO] - Setting global seed to 989
[2025-03-07 02:22:24,916][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-07 02:22:24,916][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 02:22:24,917][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 02:22:24,918][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 02:22:24,921][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 02:22:24,921][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 02:22:25,105][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 02:22:25,351][root][INFO] - Full model selected, loading model
[2025-03-07 02:22:43,804][root][INFO] - Baseline model selected, no adapter needed
[2025-03-07 02:22:43,804][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-07 02:22:50,149][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 02:22:50,151][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 02:22:50,151][root][INFO] - Starting inference
[2025-03-07 02:22:50,350][root][INFO] - Processing question number 0
[2025-03-07 02:22:50,352][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 02:23:21,180][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 02:23:52,578][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 02:24:24,127][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 02:24:55,501][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 02:25:25,935][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 02:25:55,818][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 02:26:26,206][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 02:26:56,894][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 02:27:26,856][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 02:27:57,404][root][INFO] - Processing question number 10
[2025-03-07 02:27:57,406][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 02:28:27,221][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 02:28:57,593][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 02:29:28,069][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 02:29:58,046][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 02:30:28,973][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 02:30:59,506][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 02:31:29,972][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 02:32:00,339][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 02:32:31,229][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 02:33:02,210][root][INFO] - Processing question number 20
[2025-03-07 02:33:02,212][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 02:33:32,051][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 02:34:02,755][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 02:34:32,983][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 02:35:03,360][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 02:35:33,796][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 02:36:04,767][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 02:36:35,267][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 02:37:05,985][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 02:37:36,485][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 02:38:07,668][root][INFO] - Processing question number 30
[2025-03-07 02:38:07,671][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 02:38:38,216][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 02:39:08,618][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 02:39:38,980][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 02:40:10,133][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 02:40:40,594][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 02:41:11,133][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 02:41:41,630][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 02:42:12,872][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 02:42:43,592][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 02:43:14,337][root][INFO] - Processing question number 40
[2025-03-07 02:43:14,341][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 02:43:45,051][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 02:44:15,517][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 02:44:46,485][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 02:45:16,355][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 02:45:47,609][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 02:46:18,302][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 02:46:48,782][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 02:47:19,489][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 02:47:50,037][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 02:48:20,963][root][INFO] - Processing question number 50
[2025-03-07 02:48:20,967][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 02:48:52,206][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 02:49:22,302][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 02:49:53,550][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 02:50:24,383][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 02:50:54,587][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 02:51:25,013][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 02:51:56,376][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 02:52:27,524][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 02:52:58,674][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 02:53:29,550][root][INFO] - Processing question number 60
[2025-03-07 02:53:29,555][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 02:54:00,214][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 02:54:30,932][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 02:55:02,352][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 02:55:33,274][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 02:56:04,110][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 02:56:34,456][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 02:57:04,593][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 02:57:34,604][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 02:58:04,931][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 02:58:35,195][root][INFO] - Processing question number 70
[2025-03-07 02:58:35,200][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 02:59:06,038][root][INFO] - Domain : Property, Question : 9
[2025-03-07 02:59:36,776][root][INFO] - Domain : Property, Question : 17
[2025-03-07 03:00:07,709][root][INFO] - Domain : Property, Question : 25
[2025-03-07 03:00:39,156][root][INFO] - Domain : Property, Question : 30
[2025-03-07 03:01:09,407][root][INFO] - Domain : Property, Question : 36
[2025-03-07 03:01:40,296][root][INFO] - Domain : Property, Question : 46
[2025-03-07 03:02:12,162][root][INFO] - Domain : Property, Question : 53
[2025-03-07 03:02:43,069][root][INFO] - Domain : Property, Question : 59
[2025-03-07 03:03:12,974][root][INFO] - Domain : Property, Question : 66
[2025-03-07 03:03:43,284][root][INFO] - Processing question number 80
[2025-03-07 03:03:43,290][root][INFO] - Domain : Property, Question : 69
[2025-03-07 03:04:14,544][root][INFO] - Domain : Property, Question : 81
[2025-03-07 03:04:45,843][root][INFO] - Domain : Property, Question : 88
[2025-03-07 03:05:17,066][root][INFO] - Domain : Property, Question : 91
[2025-03-07 03:05:47,949][root][INFO] - Domain : Property, Question : 94
[2025-03-07 03:06:19,767][root][INFO] - Domain : Property, Question : 100
[2025-03-07 03:06:50,229][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 03:07:21,242][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 03:07:52,844][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 03:08:23,637][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 03:08:54,592][root][INFO] - Processing question number 90
[2025-03-07 03:08:54,599][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 03:09:25,534][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 03:09:56,875][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 03:10:28,028][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 03:10:58,763][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 03:11:30,142][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 03:12:01,419][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 03:12:32,336][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 03:13:02,810][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 03:13:32,851][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 03:14:04,134][root][INFO] - Inference complete
[2025-03-07 03:14:04,134][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,142][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,143][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,143][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,144][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,144][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,145][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,145][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,145][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,145][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,146][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,146][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,146][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,147][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,147][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,147][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,147][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,148][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,148][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,148][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,149][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,149][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,149][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,150][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,150][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,150][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,152][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,152][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,153][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,153][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,153][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,153][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,156][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,156][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,156][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,157][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,157][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,157][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,159][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,159][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,159][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,161][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,161][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,161][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,162][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,162][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,162][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,164][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,164][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,164][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,165][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,165][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,165][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,166][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,166][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,166][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,166][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,167][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,167][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,167][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,168][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,168][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,168][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,169][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,169][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,169][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,169][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,170][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,170][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,170][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,170][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,171][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,172][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,172][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,173][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,173][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 03:14:04,173][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,174][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 03:14:04,174][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 03:14:04,174][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 03:14:04,175][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,182][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,182][root][INFO] - Saved parsed outputs
[2025-03-07 03:14:04,182][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,183][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,183][root][INFO] - Saved parsing metadata
[2025-03-07 03:14:04,184][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,185][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:14:04,186][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 03:14:04,210][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 03:14:04,210][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.06, 'malformed_label': 26, 'malformed_domain': 47, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 6, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.07, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 10, 'both_wrong': 37}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 03:14:12,591][root][INFO] - Setting global seed to 989
[2025-03-07 03:14:12,598][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 03:14:12,599][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 03:14:12,600][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 03:14:12,601][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 03:14:12,604][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 03:14:12,604][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 03:14:12,822][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 03:14:13,065][root][INFO] - Full model selected, loading model
[2025-03-07 03:14:31,731][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-07 03:15:32,285][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 03:15:32,285][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 03:15:58,359][root][INFO] - Peft model loaded successfully
[2025-03-07 03:16:04,512][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 03:16:04,514][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 03:16:04,514][root][INFO] - Starting inference
[2025-03-07 03:16:04,748][root][INFO] - Processing question number 0
[2025-03-07 03:16:04,750][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 03:16:36,185][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 03:17:07,965][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 03:17:39,907][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 03:18:11,382][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 03:18:42,189][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 03:19:12,448][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 03:19:43,218][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 03:20:14,294][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 03:20:44,637][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 03:21:15,618][root][INFO] - Processing question number 10
[2025-03-07 03:21:15,620][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 03:21:45,792][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 03:22:16,552][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 03:22:47,481][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 03:23:17,851][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 03:23:49,161][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 03:24:20,139][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 03:24:51,020][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 03:25:21,776][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 03:25:53,050][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 03:26:24,502][root][INFO] - Processing question number 20
[2025-03-07 03:26:24,505][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 03:26:54,729][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 03:27:25,813][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 03:27:56,427][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 03:28:27,192][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 03:28:58,031][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 03:29:29,486][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 03:30:00,429][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 03:30:20,687][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 03:30:51,624][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 03:31:23,197][root][INFO] - Processing question number 30
[2025-03-07 03:31:23,201][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 03:31:54,189][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 03:32:24,976][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 03:32:55,723][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 03:33:27,256][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 03:33:58,125][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 03:34:29,115][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 03:35:00,053][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 03:35:31,680][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 03:36:02,794][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 03:36:21,935][root][INFO] - Processing question number 40
[2025-03-07 03:36:21,939][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 03:36:53,041][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 03:37:23,900][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 03:37:55,359][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 03:38:25,630][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 03:38:57,275][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 03:39:28,370][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 03:39:59,291][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 03:40:30,378][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 03:41:01,379][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 03:41:32,677][root][INFO] - Processing question number 50
[2025-03-07 03:41:32,682][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 03:42:04,310][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 03:42:34,842][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 03:43:06,482][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 03:43:37,693][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 03:44:08,268][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 03:44:39,078][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 03:45:10,856][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 03:45:42,399][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 03:46:13,946][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 03:46:39,218][root][INFO] - Processing question number 60
[2025-03-07 03:46:39,223][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 03:47:10,268][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 03:47:41,371][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 03:48:13,200][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 03:48:44,493][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 03:49:15,719][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 03:49:46,440][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 03:50:17,005][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 03:50:47,400][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 03:51:18,100][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 03:51:48,738][root][INFO] - Processing question number 70
[2025-03-07 03:51:48,743][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 03:52:19,970][root][INFO] - Domain : Property, Question : 9
[2025-03-07 03:52:51,084][root][INFO] - Domain : Property, Question : 17
[2025-03-07 03:53:22,390][root][INFO] - Domain : Property, Question : 25
[2025-03-07 03:53:54,229][root][INFO] - Domain : Property, Question : 30
[2025-03-07 03:54:24,865][root][INFO] - Domain : Property, Question : 36
[2025-03-07 03:54:56,121][root][INFO] - Domain : Property, Question : 46
[2025-03-07 03:55:28,445][root][INFO] - Domain : Property, Question : 53
[2025-03-07 03:55:59,726][root][INFO] - Domain : Property, Question : 59
[2025-03-07 03:56:30,012][root][INFO] - Domain : Property, Question : 66
[2025-03-07 03:57:00,729][root][INFO] - Processing question number 80
[2025-03-07 03:57:00,734][root][INFO] - Domain : Property, Question : 69
[2025-03-07 03:57:32,374][root][INFO] - Domain : Property, Question : 81
[2025-03-07 03:58:04,071][root][INFO] - Domain : Property, Question : 88
[2025-03-07 03:58:35,667][root][INFO] - Domain : Property, Question : 91
[2025-03-07 03:59:06,921][root][INFO] - Domain : Property, Question : 94
[2025-03-07 03:59:39,118][root][INFO] - Domain : Property, Question : 100
[2025-03-07 04:00:09,963][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 04:00:41,496][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 04:01:09,144][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 04:01:40,273][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 04:02:11,426][root][INFO] - Processing question number 90
[2025-03-07 04:02:11,432][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 04:02:42,590][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 04:03:14,144][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 04:03:45,424][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 04:04:16,506][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 04:04:48,264][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 04:05:19,928][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 04:05:51,221][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 04:06:22,081][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 04:06:52,498][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 04:07:24,198][root][INFO] - Inference complete
[2025-03-07 04:07:24,198][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,206][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,208][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,209][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,209][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,210][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,211][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,212][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,213][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,213][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,213][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,214][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,214][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,214][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,215][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,215][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,216][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,216][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,216][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,216][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,217][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,217][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,217][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,218][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,218][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,219][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,220][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,220][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,220][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,220][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,221][root][WARNING] - |Q. 51||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,221][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,222][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,222][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,223][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,223][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,223][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,223][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,224][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,224][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,225][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,225][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,225][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,225][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,226][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,226][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,226][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,227][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,227][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:07:24,227][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,227][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,228][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,228][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,229][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,229][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,229][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,229][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,230][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,230][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,230][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,231][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,231][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,231][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,231][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,231][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,232][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,232][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,233][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,233][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,233][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,233][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,234][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,235][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,235][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,235][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:07:24,235][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:07:24,235][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:07:24,237][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,243][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,244][root][INFO] - Saved parsed outputs
[2025-03-07 04:07:24,244][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,245][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,245][root][INFO] - Saved parsing metadata
[2025-03-07 04:07:24,245][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,247][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:24,248][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 04:07:24,277][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 04:07:24,277][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.11, 'malformed_label': 25, 'malformed_domain': 54, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 11, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 16, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 04:07:31,277][root][INFO] - Setting global seed to 989
[2025-03-07 04:07:31,284][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-07 04:07:31,285][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 04:07:31,286][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 04:07:31,287][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 04:07:31,290][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 04:07:31,290][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 04:07:31,452][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 04:07:31,754][root][INFO] - Full model selected, loading model
[2025-03-07 04:07:52,553][root][INFO] - Baseline model selected, no adapter needed
[2025-03-07 04:07:52,553][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-07 04:07:58,954][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 04:07:58,956][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:07:58,956][root][INFO] - Starting inference
[2025-03-07 04:07:59,158][root][INFO] - Processing question number 0
[2025-03-07 04:07:59,160][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 04:08:30,519][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 04:09:02,332][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 04:09:34,207][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 04:10:05,523][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 04:10:36,258][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 04:11:06,458][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 04:11:37,165][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 04:12:08,172][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 04:12:38,448][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 04:13:09,314][root][INFO] - Processing question number 10
[2025-03-07 04:13:09,316][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 04:13:39,429][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 04:14:10,117][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 04:14:40,915][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 04:15:11,210][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 04:15:42,452][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 04:16:13,301][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 04:16:44,086][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 04:17:14,768][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 04:17:45,971][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 04:18:17,265][root][INFO] - Processing question number 20
[2025-03-07 04:18:17,267][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 04:18:47,421][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 04:19:18,437][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 04:19:48,979][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 04:20:19,670][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 04:20:50,423][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 04:21:21,709][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 04:21:52,520][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 04:22:23,557][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 04:22:54,369][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 04:23:25,862][root][INFO] - Processing question number 30
[2025-03-07 04:23:25,865][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 04:23:56,728][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 04:24:27,445][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 04:24:58,122][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 04:25:29,594][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 04:26:00,381][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 04:26:31,241][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 04:27:02,058][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 04:27:33,620][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 04:28:04,662][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 04:28:35,723][root][INFO] - Processing question number 40
[2025-03-07 04:28:35,726][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 04:29:06,749][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 04:29:37,530][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 04:30:08,809][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 04:30:39,043][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 04:31:10,698][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 04:31:41,719][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 04:32:12,530][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 04:32:43,561][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 04:33:14,447][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 04:33:45,704][root][INFO] - Processing question number 50
[2025-03-07 04:33:45,708][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 04:34:17,281][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 04:34:47,707][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 04:35:19,286][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 04:35:50,445][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 04:36:20,975][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 04:36:51,732][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 04:37:23,434][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 04:37:54,934][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 04:38:26,427][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 04:38:57,666][root][INFO] - Processing question number 60
[2025-03-07 04:38:57,671][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 04:39:28,711][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 04:39:59,807][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 04:40:31,582][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 04:41:02,866][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 04:41:34,075][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 04:42:04,778][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 04:42:35,244][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 04:43:05,586][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 04:43:36,247][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 04:44:06,845][root][INFO] - Processing question number 70
[2025-03-07 04:44:06,850][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 04:44:38,020][root][INFO] - Domain : Property, Question : 9
[2025-03-07 04:45:09,089][root][INFO] - Domain : Property, Question : 17
[2025-03-07 04:45:40,354][root][INFO] - Domain : Property, Question : 25
[2025-03-07 04:46:12,140][root][INFO] - Domain : Property, Question : 30
[2025-03-07 04:46:42,728][root][INFO] - Domain : Property, Question : 36
[2025-03-07 04:47:13,948][root][INFO] - Domain : Property, Question : 46
[2025-03-07 04:47:46,150][root][INFO] - Domain : Property, Question : 53
[2025-03-07 04:48:17,394][root][INFO] - Domain : Property, Question : 59
[2025-03-07 04:48:47,633][root][INFO] - Domain : Property, Question : 66
[2025-03-07 04:49:18,292][root][INFO] - Processing question number 80
[2025-03-07 04:49:18,297][root][INFO] - Domain : Property, Question : 69
[2025-03-07 04:49:49,897][root][INFO] - Domain : Property, Question : 81
[2025-03-07 04:50:21,530][root][INFO] - Domain : Property, Question : 88
[2025-03-07 04:50:53,094][root][INFO] - Domain : Property, Question : 91
[2025-03-07 04:51:24,431][root][INFO] - Domain : Property, Question : 94
[2025-03-07 04:51:56,792][root][INFO] - Domain : Property, Question : 100
[2025-03-07 04:52:27,776][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 04:52:59,374][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 04:53:31,394][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 04:54:02,532][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 04:54:33,689][root][INFO] - Processing question number 90
[2025-03-07 04:54:33,695][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 04:55:04,858][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 04:55:36,415][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 04:56:07,706][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 04:56:38,785][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 04:57:10,535][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 04:57:42,183][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 04:58:13,478][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 04:58:44,334][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 04:59:14,747][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 04:59:46,416][root][INFO] - Inference complete
[2025-03-07 04:59:46,416][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,424][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,425][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,425][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,426][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,426][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,427][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,427][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,427][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,427][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,428][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,429][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,429][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,429][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,430][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,430][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,430][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,431][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,431][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,431][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,433][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,433][root][WARNING] - |Q. 64||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,433][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,435][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,435][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,435][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,436][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,436][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,437][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,439][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,439][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,440][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,441][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,441][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,441][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,444][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,444][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,444][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,445][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,445][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,445][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,446][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,446][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,446][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,447][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,447][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,447][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,447][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,447][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,447][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,448][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,449][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,449][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,449][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,450][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,450][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,450][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,450][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,451][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,451][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,451][root][WARNING] - |Q. 18||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,451][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,452][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,452][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 04:59:46,452][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,453][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 04:59:46,453][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 04:59:46,453][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 04:59:46,456][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,462][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,462][root][INFO] - Saved parsed outputs
[2025-03-07 04:59:46,462][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,463][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,464][root][INFO] - Saved parsing metadata
[2025-03-07 04:59:46,464][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,465][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 04:59:46,467][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 04:59:46,479][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 04:59:46,480][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.14, 'malformed_label': 22, 'malformed_domain': 42, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 10, 'both_wrong': 32}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 04:59:52,655][root][INFO] - Setting global seed to 989
[2025-03-07 04:59:52,661][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-07 04:59:52,661][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 04:59:52,662][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 04:59:52,663][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 04:59:52,665][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 04:59:52,665][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 04:59:52,820][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 04:59:53,075][root][INFO] - Full model selected, loading model
[2025-03-07 05:00:04,367][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-07 05:01:05,103][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-07 05:01:05,103][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-07 05:01:30,853][root][INFO] - Peft model loaded successfully
[2025-03-07 05:01:36,925][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 05:01:36,927][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:01:36,927][root][INFO] - Starting inference
[2025-03-07 05:01:37,100][root][INFO] - Processing question number 0
[2025-03-07 05:01:37,103][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 05:02:08,853][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 05:02:40,536][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 05:03:12,376][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 05:03:43,753][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 05:04:14,465][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 05:04:44,633][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 05:05:15,314][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 05:05:46,293][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 05:06:16,549][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 05:06:47,430][root][INFO] - Processing question number 10
[2025-03-07 05:06:47,432][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 05:07:17,513][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 05:07:48,171][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 05:08:18,992][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 05:08:49,259][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 05:09:20,465][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 05:09:51,342][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 05:10:22,106][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 05:10:52,762][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 05:11:23,927][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 05:11:55,274][root][INFO] - Processing question number 20
[2025-03-07 05:11:55,277][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 05:12:25,410][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 05:12:56,391][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 05:13:26,903][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 05:13:57,567][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 05:14:28,294][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 05:14:59,646][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 05:15:20,077][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 05:15:51,085][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 05:16:21,921][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 05:16:53,384][root][INFO] - Processing question number 30
[2025-03-07 05:16:53,387][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 05:17:07,969][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 05:17:38,650][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 05:18:09,295][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 05:18:40,728][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 05:19:11,492][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 05:19:42,380][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 05:20:13,217][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 05:20:44,744][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 05:21:15,751][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 05:21:46,777][root][INFO] - Processing question number 40
[2025-03-07 05:21:46,781][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 05:22:08,386][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 05:22:39,140][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 05:23:10,492][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 05:23:40,668][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 05:24:12,229][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 05:24:43,260][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 05:25:14,132][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 05:25:45,164][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 05:26:16,102][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 05:26:47,349][root][INFO] - Processing question number 50
[2025-03-07 05:26:47,354][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 05:27:18,911][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 05:27:49,378][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 05:28:20,928][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 05:28:52,044][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 05:29:22,528][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 05:29:53,251][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 05:30:24,908][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 05:30:56,340][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 05:31:19,332][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 05:31:50,489][root][INFO] - Processing question number 60
[2025-03-07 05:31:50,493][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 05:32:21,484][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 05:32:52,538][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 05:33:24,309][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 05:33:55,557][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 05:34:26,720][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 05:34:57,392][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 05:35:27,905][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 05:35:58,258][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 05:36:28,896][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 05:36:59,448][root][INFO] - Processing question number 70
[2025-03-07 05:36:59,454][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 05:37:30,596][root][INFO] - Domain : Property, Question : 9
[2025-03-07 05:38:01,657][root][INFO] - Domain : Property, Question : 17
[2025-03-07 05:38:32,881][root][INFO] - Domain : Property, Question : 25
[2025-03-07 05:39:04,618][root][INFO] - Domain : Property, Question : 30
[2025-03-07 05:39:35,144][root][INFO] - Domain : Property, Question : 36
[2025-03-07 05:40:06,289][root][INFO] - Domain : Property, Question : 46
[2025-03-07 05:40:38,494][root][INFO] - Domain : Property, Question : 53
[2025-03-07 05:41:09,655][root][INFO] - Domain : Property, Question : 59
[2025-03-07 05:41:39,823][root][INFO] - Domain : Property, Question : 66
[2025-03-07 05:42:10,411][root][INFO] - Processing question number 80
[2025-03-07 05:42:10,416][root][INFO] - Domain : Property, Question : 69
[2025-03-07 05:42:47,292][root][INFO] - Domain : Property, Question : 81
[2025-03-07 05:43:19,959][root][INFO] - Domain : Property, Question : 88
[2025-03-07 05:43:52,028][root][INFO] - Domain : Property, Question : 91
[2025-03-07 05:44:23,378][root][INFO] - Domain : Property, Question : 94
[2025-03-07 05:44:55,587][root][INFO] - Domain : Property, Question : 100
[2025-03-07 05:45:27,449][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 05:45:59,707][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 05:46:32,010][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 05:47:03,565][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 05:47:35,180][root][INFO] - Processing question number 90
[2025-03-07 05:47:35,189][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 05:48:07,295][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 05:48:39,170][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 05:49:10,801][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 05:49:33,802][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 05:50:05,990][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 05:50:37,937][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 05:51:09,663][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 05:51:40,830][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 05:52:11,235][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 05:52:42,870][root][INFO] - Inference complete
[2025-03-07 05:52:42,871][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,885][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,886][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,887][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,888][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,888][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,889][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,889][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,890][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,890][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,890][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,891][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,891][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,892][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,893][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,894][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,894][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,897][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,897][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 05:52:42,897][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,899][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,899][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,899][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,902][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,903][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,903][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,903][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,904][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,904][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,904][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,904][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,904][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,905][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,905][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,905][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,906][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,906][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,906][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,907][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,907][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,907][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,908][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,908][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,908][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,909][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,909][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 05:52:42,910][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,911][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,911][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 05:52:42,911][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,912][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 05:52:42,912][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 05:52:42,912][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 05:52:42,914][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,921][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,921][root][INFO] - Saved parsed outputs
[2025-03-07 05:52:42,921][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,922][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,922][root][INFO] - Saved parsing metadata
[2025-03-07 05:52:42,923][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,926][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:52:42,927][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 05:52:42,980][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 05:52:42,980][root][INFO] - Summary of metrics : {'label_accuracy': 0.18, 'misclassification_rate': 0.8200000000000001, 'combined_accuracy': 0.04, 'malformed_label': 17, 'malformed_domain': 64, 'total_predictions': 100, 'correct_predictions': 18, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.05, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.04, 'correct_domain_wrong_label': 32, 'correct_label_wrong_domain': 14, 'both_wrong': 50}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-03-07 05:52:58,453][root][INFO] - Setting global seed to 989
[2025-03-07 05:52:58,465][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-07 05:52:58,465][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-07 05:52:58,466][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-07 05:52:58,468][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-07 05:52:58,478][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-07 05:52:58,478][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-07 05:52:58,628][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-07 05:52:58,929][root][INFO] - Full model selected, loading model
[2025-03-07 05:53:23,792][root][INFO] - Baseline model selected, no adapter needed
[2025-03-07 05:53:23,794][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-07 05:53:38,405][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-07 05:53:38,408][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 05:53:38,408][root][INFO] - Starting inference
[2025-03-07 05:53:38,622][root][INFO] - Processing question number 0
[2025-03-07 05:53:38,624][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-07 05:54:10,873][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-07 05:54:42,556][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-07 05:55:14,416][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-07 05:55:45,686][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-07 05:56:16,399][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-07 05:56:46,567][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-07 05:57:17,239][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-07 05:57:48,244][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-07 05:58:18,473][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-07 05:58:49,502][root][INFO] - Processing question number 10
[2025-03-07 05:58:49,507][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-07 05:59:19,581][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-07 05:59:50,210][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-07 06:00:20,985][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-07 06:00:51,228][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-07 06:01:22,441][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-07 06:01:53,359][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-07 06:02:24,128][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-07 06:02:54,790][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-07 06:03:25,968][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-07 06:03:57,260][root][INFO] - Processing question number 20
[2025-03-07 06:03:57,263][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-07 06:04:27,363][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-07 06:04:58,361][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 06:05:28,872][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 06:05:59,615][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 06:06:30,360][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 06:07:01,599][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 06:07:32,364][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 06:08:03,376][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 06:08:34,148][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 06:09:05,603][root][INFO] - Processing question number 30
[2025-03-07 06:09:05,606][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 06:09:36,456][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 06:10:07,129][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 06:10:37,762][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 06:11:09,183][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 06:11:39,924][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 06:12:10,737][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 06:12:41,499][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 06:13:13,007][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 06:13:43,996][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 06:14:15,002][root][INFO] - Processing question number 40
[2025-03-07 06:14:15,005][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 06:14:45,986][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 06:15:16,754][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 06:15:47,983][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 06:16:18,228][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 06:16:49,765][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 06:17:20,727][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 06:17:51,475][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 06:18:22,454][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 06:18:53,283][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 06:19:24,484][root][INFO] - Processing question number 50
[2025-03-07 06:19:24,488][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 06:19:56,001][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 06:20:26,377][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 06:20:57,915][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 06:21:29,027][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 06:21:59,502][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 06:22:30,199][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 06:23:01,835][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 06:23:33,243][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 06:24:04,669][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 06:24:35,806][root][INFO] - Processing question number 60
[2025-03-07 06:24:35,811][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 06:25:06,727][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 06:25:37,709][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 06:26:09,390][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 06:26:40,572][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 06:27:11,694][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 06:27:42,297][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 06:28:12,680][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 06:28:42,941][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 06:29:13,526][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 06:29:44,041][root][INFO] - Processing question number 70
[2025-03-07 06:29:44,045][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 06:30:15,135][root][INFO] - Domain : Property, Question : 9
[2025-03-07 06:30:46,122][root][INFO] - Domain : Property, Question : 17
[2025-03-07 06:31:17,306][root][INFO] - Domain : Property, Question : 25
[2025-03-07 06:31:49,006][root][INFO] - Domain : Property, Question : 30
[2025-03-07 06:32:19,509][root][INFO] - Domain : Property, Question : 36
[2025-03-07 06:32:50,683][root][INFO] - Domain : Property, Question : 46
[2025-03-07 06:33:22,800][root][INFO] - Domain : Property, Question : 53
[2025-03-07 06:33:53,946][root][INFO] - Domain : Property, Question : 59
[2025-03-07 06:34:24,101][root][INFO] - Domain : Property, Question : 66
[2025-03-07 06:34:54,672][root][INFO] - Processing question number 80
[2025-03-07 06:34:54,677][root][INFO] - Domain : Property, Question : 69
[2025-03-07 06:35:26,270][root][INFO] - Domain : Property, Question : 81
[2025-03-07 06:35:57,856][root][INFO] - Domain : Property, Question : 88
[2025-03-07 06:36:29,346][root][INFO] - Domain : Property, Question : 91
[2025-03-07 06:37:00,490][root][INFO] - Domain : Property, Question : 94
[2025-03-07 06:37:32,572][root][INFO] - Domain : Property, Question : 100
[2025-03-07 06:38:03,297][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 06:38:34,593][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 06:39:06,462][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 06:39:37,472][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 06:40:08,508][root][INFO] - Processing question number 90
[2025-03-07 06:40:08,514][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 06:40:39,550][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 06:41:10,984][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 06:41:42,162][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 06:42:13,119][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 06:42:44,756][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 06:43:16,280][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 06:43:47,467][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 06:44:18,205][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 06:44:48,531][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 06:45:20,085][root][INFO] - Inference complete
[2025-03-07 06:45:20,085][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,093][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,094][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,094][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,094][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,095][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,095][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,096][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,096][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,097][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,097][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,098][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,099][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,099][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,100][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,100][root][WARNING] - |Q. 8||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,100][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,101][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,101][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,101][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,102][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,102][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,102][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,103][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,103][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,103][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,104][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,105][root][WARNING] - |Q. 7||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,105][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,106][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,107][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,107][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,108][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,108][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,108][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,109][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,109][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,110][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,111][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,111][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,111][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,112][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,112][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,112][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,113][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,113][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,113][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,114][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,114][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,114][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,114][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,115][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,115][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,115][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,116][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,116][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,117][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,118][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,118][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,119][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,119][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,119][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,119][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,120][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,120][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,120][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,120][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-07 06:45:20,120][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,121][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,121][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,121][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,122][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,122][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,123][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,123][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,123][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,123][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,124][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,124][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,124][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,125][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 06:45:20,125][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 06:45:20,126][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 06:45:20,127][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,133][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,133][root][INFO] - Saved parsed outputs
[2025-03-07 06:45:20,133][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,135][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,135][root][INFO] - Saved parsing metadata
[2025-03-07 06:45:20,135][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,136][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
[2025-03-07 06:45:20,138][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 06:45:20,150][root][INFO] - Evaluation completed for json_fact_first_few_shot_structured, on test_set_2
[2025-03-07 06:45:20,150][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.09, 'malformed_label': 28, 'malformed_domain': 54, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 9, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 44}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Job 9 completed at Fri Mar  7 06:45:21 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n511
Job ID: 25358384
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 20:57:19
CPU Efficiency: 9.94% of 8-18:54:10 core-walltime
Job Wall-clock time: 21:05:25
Memory Utilized: 27.90 GB
Memory Efficiency: 77.51% of 36.00 GB
