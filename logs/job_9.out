Starting job 9 at Thu Feb 20 22:52:55 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=number_list_fact_first_few_shot_structured train=number_list_fact_first_few_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '9', 'training']
Updating job 9 to status training with exit code None
Status update completed for job 9
[2025-02-20 22:53:09,985][root][INFO] - Global seed set to 314
[2025-02-20 22:53:09,986][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:53:09,986][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:53:09,986][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:53:09,987][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 22:53:09,987][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-02-20 22:53:10,005][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:53:10,055][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:53:10,069][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:53:10,092][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:53:10,535][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:53:23,570][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:53:51,603][root][INFO] - Model prepared for kbit training
[2025-02-20 22:53:51,604][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'gate_proj', 'o_proj', 'k_proj', 'down_proj', 'up_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:53:53,267][root][INFO] - Lora adapter added to model
[2025-02-20 22:53:53,270][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_fact_first_few_shot_structured
[2025-02-20 22:53:53,395][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4452, 'grad_norm': 0.14276207983493805, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.2876, 'grad_norm': 0.20919658243656158, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.1547, 'grad_norm': 0.20785771310329437, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.0423, 'grad_norm': 0.2445191591978073, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8465, 'grad_norm': 0.246855691075325, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 366.8005, 'train_samples_per_second': 0.286, 'train_steps_per_second': 0.041, 'train_loss': 1.1552481969197592, 'epoch': 15.0}
[2025-02-20 23:00:03,649][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_fact_first_few_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '9', 'trained', '0']
Updating job 9 to status trained with exit code 0
Status update completed for job 9
Starting evaluations for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-20 23:00:13,994][root][INFO] - Setting global seed to 206
[2025-02-20 23:00:14,001][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:00:14,001][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:00:14,003][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:00:14,006][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:00:14,008][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:00:14,008][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:00:14,151][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:00:14,429][root][INFO] - Full model selected, loading model
[2025-02-20 23:00:32,147][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:01:32,808][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:01:32,808][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:01:57,611][root][INFO] - Peft model loaded successfully
[2025-02-20 23:02:03,609][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:02:03,611][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:02:03,611][root][INFO] - Starting inference
[2025-02-20 23:02:03,867][root][INFO] - Processing question number 0
[2025-02-20 23:02:03,913][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:02:34,525][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:03:05,743][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:03:36,492][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:04:07,770][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:04:38,351][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:05:08,881][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:05:40,248][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:06:11,111][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:06:41,589][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:07:14,090][root][INFO] - Processing question number 10
[2025-02-20 23:07:14,093][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:07:46,639][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:08:16,921][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:08:47,762][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:09:19,205][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:09:50,632][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:10:21,041][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:10:51,331][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:11:22,081][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:11:52,817][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:12:23,289][root][INFO] - Processing question number 20
[2025-02-20 23:12:23,292][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:12:54,024][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:13:24,935][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:13:55,293][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:14:25,585][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:14:56,602][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:15:27,398][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:15:58,979][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:16:29,742][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:17:00,627][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:17:30,803][root][INFO] - Processing question number 30
[2025-02-20 23:17:30,806][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:18:01,879][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:18:33,285][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:19:04,170][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:19:34,893][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:20:05,467][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:20:36,824][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:21:07,480][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:21:38,541][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:22:09,411][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:22:41,021][root][INFO] - Processing question number 40
[2025-02-20 23:22:41,024][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:23:11,961][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:23:44,328][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:24:15,739][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:24:47,085][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:25:17,682][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:25:48,592][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:26:20,757][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:26:50,695][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:27:21,516][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:27:52,973][root][INFO] - Processing question number 50
[2025-02-20 23:27:52,977][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:28:24,603][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:28:55,591][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:29:25,770][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:29:57,684][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:30:28,650][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:30:58,626][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:31:30,222][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:32:00,595][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:32:32,049][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:33:04,266][root][INFO] - Processing question number 60
[2025-02-20 23:33:04,271][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:33:34,634][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:34:05,357][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:34:36,715][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:35:07,055][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:35:37,907][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:36:08,802][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:36:39,747][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:37:11,018][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:37:42,022][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:38:13,549][root][INFO] - Processing question number 70
[2025-02-20 23:38:13,554][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:38:44,249][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:39:14,981][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:39:45,542][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:40:19,748][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:40:51,000][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:41:21,438][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:41:52,989][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:42:24,042][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:42:55,407][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:43:26,109][root][INFO] - Processing question number 80
[2025-02-20 23:43:26,115][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:43:57,186][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:44:28,241][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:44:58,825][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:45:29,453][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:46:00,886][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:46:32,146][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:47:03,465][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:47:34,037][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:48:05,054][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:48:35,395][root][INFO] - Processing question number 90
[2025-02-20 23:48:35,401][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:49:07,198][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:49:37,060][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:50:07,810][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:50:37,833][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:51:09,241][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:51:39,642][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:52:10,364][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:52:41,386][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:53:12,879][root][INFO] - Inference complete
[2025-02-20 23:53:12,879][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,886][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,897][root][WARNING] - No match found for 6. Chosen Option Label in question number 18 in domain Evidence
[2025-02-20 23:53:12,904][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,910][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,911][root][INFO] - Saved parsed outputs
[2025-02-20 23:53:12,911][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,966][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,966][root][INFO] - Saved parsing metadata
[2025-02-20 23:53:12,967][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,968][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:12,984][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:53:13,016][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-20 23:53:13,016][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 6, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1111111111111111, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 8, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-20 23:53:19,715][root][INFO] - Setting global seed to 206
[2025-02-20 23:53:19,720][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:53:19,720][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-20 23:53:19,722][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:53:19,723][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:53:19,726][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:53:19,726][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:53:19,865][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:53:20,115][root][INFO] - Full model selected, loading model
[2025-02-20 23:53:31,405][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:53:31,405][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:53:37,646][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:53:37,647][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-20 23:53:37,648][root][INFO] - Starting inference
[2025-02-20 23:53:37,841][root][INFO] - Processing question number 0
[2025-02-20 23:53:37,843][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:54:08,245][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:54:39,266][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:55:09,825][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:55:40,926][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:56:11,398][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:56:41,834][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:57:13,107][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:57:43,870][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:58:14,259][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:58:45,293][root][INFO] - Processing question number 10
[2025-02-20 23:58:45,295][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:59:17,698][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:59:47,851][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:00:18,576][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:00:49,897][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:01:21,201][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:01:51,473][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:02:21,624][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:02:55,966][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:03:26,719][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:03:57,090][root][INFO] - Processing question number 20
[2025-02-21 00:03:57,093][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:04:27,675][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:04:58,505][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:05:28,772][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:05:58,927][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:06:29,833][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:07:00,473][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:07:31,944][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:08:02,548][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:08:33,322][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:09:03,399][root][INFO] - Processing question number 30
[2025-02-21 00:09:03,402][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:09:34,380][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:10:05,692][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:10:36,546][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:11:07,112][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:11:37,571][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:12:08,823][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:12:39,358][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:13:10,330][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:13:41,095][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:14:12,584][root][INFO] - Processing question number 40
[2025-02-21 00:14:12,588][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:14:43,419][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:15:14,240][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:15:45,566][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:16:16,839][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:16:47,341][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:17:18,205][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:17:50,306][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:18:22,408][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:18:53,075][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:19:24,532][root][INFO] - Processing question number 50
[2025-02-21 00:19:24,538][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:19:56,085][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:20:28,405][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:20:58,511][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:21:30,363][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:22:01,247][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:22:31,153][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:23:02,662][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:23:32,953][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:24:04,323][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:24:36,481][root][INFO] - Processing question number 60
[2025-02-21 00:24:36,486][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:25:06,763][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:25:37,400][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:26:08,695][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:26:38,904][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:27:09,661][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:27:40,468][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:28:11,304][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:28:42,396][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:29:13,312][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:29:44,761][root][INFO] - Processing question number 70
[2025-02-21 00:29:44,767][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:30:15,330][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:30:46,074][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:31:16,554][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:31:47,625][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:32:18,656][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:32:49,017][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:33:20,247][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:33:51,236][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:34:22,463][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:34:53,027][root][INFO] - Processing question number 80
[2025-02-21 00:34:53,032][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:35:24,039][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:35:55,039][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:36:25,531][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:36:56,068][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:37:27,429][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:37:58,516][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:38:29,739][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:39:00,234][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:39:34,840][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:40:05,044][root][INFO] - Processing question number 90
[2025-02-21 00:40:05,050][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:40:36,782][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:41:06,572][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:41:37,224][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:42:07,220][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:42:38,510][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:43:08,769][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:43:39,389][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:44:10,256][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:44:41,601][root][INFO] - Inference complete
[2025-02-21 00:44:41,602][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,608][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,613][root][WARNING] - No match found for 6. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 00:44:41,623][root][WARNING] - No match found for 6. Chosen Option Label in question number 39 in domain Property
[2025-02-21 00:44:41,626][root][WARNING] - No match found for 6. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 00:44:41,629][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,635][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,635][root][INFO] - Saved parsed outputs
[2025-02-21 00:44:41,635][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,636][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,636][root][INFO] - Saved parsing metadata
[2025-02-21 00:44:41,637][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,638][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:44:41,640][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:44:41,664][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 00:44:41,664][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 3, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 8, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 00:44:48,344][root][INFO] - Setting global seed to 206
[2025-02-21 00:44:48,350][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:44:48,351][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 00:44:48,352][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:44:48,354][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:44:48,356][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:44:48,357][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:44:49,130][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:44:49,568][root][INFO] - Full model selected, loading model
[2025-02-21 00:45:00,881][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:46:00,520][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:46:00,520][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:46:26,022][root][INFO] - Peft model loaded successfully
[2025-02-21 00:46:32,032][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:46:32,034][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 00:46:32,034][root][INFO] - Starting inference
[2025-02-21 00:46:32,217][root][INFO] - Processing question number 0
[2025-02-21 00:46:32,219][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:47:02,673][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:47:34,027][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:48:04,907][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:48:36,303][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:49:07,049][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:49:37,734][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:50:09,273][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:50:40,307][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:51:10,958][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:51:42,356][root][INFO] - Processing question number 10
[2025-02-21 00:51:42,358][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:52:15,069][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:52:45,548][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:53:16,549][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:53:48,133][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:54:19,706][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:54:50,248][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:55:20,727][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:55:54,192][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:56:25,180][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:56:55,844][root][INFO] - Processing question number 20
[2025-02-21 00:56:55,848][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:57:26,760][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:57:57,858][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:58:28,401][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:58:58,874][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:59:30,051][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:00:01,022][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:00:32,773][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:01:03,713][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:01:34,774][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:02:05,129][root][INFO] - Processing question number 30
[2025-02-21 01:02:05,133][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:02:36,378][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:03:07,970][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:03:39,024][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:04:09,926][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:04:40,669][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:05:12,200][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:05:43,017][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:06:14,252][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:06:45,296][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:07:17,085][root][INFO] - Processing question number 40
[2025-02-21 01:07:17,089][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:07:48,284][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:08:19,422][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:08:51,005][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:09:22,544][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:09:53,298][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:10:24,354][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:10:56,752][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:11:26,921][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:11:57,863][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:12:29,497][root][INFO] - Processing question number 50
[2025-02-21 01:12:29,501][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:13:01,318][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:13:32,491][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:14:02,849][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:14:34,959][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:15:06,103][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:15:36,282][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:16:08,077][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:16:38,655][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:17:10,284][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:17:42,711][root][INFO] - Processing question number 60
[2025-02-21 01:17:42,716][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:18:13,272][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:18:44,191][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:19:15,759][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:19:46,297][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:20:17,335][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:20:48,431][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:21:19,551][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:21:51,014][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:22:22,203][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:22:53,925][root][INFO] - Processing question number 70
[2025-02-21 01:22:53,931][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:23:24,809][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:23:55,726][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:24:26,474][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:24:57,910][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:25:29,297][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:25:59,988][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:26:31,463][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:27:02,690][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:27:34,165][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:28:05,038][root][INFO] - Processing question number 80
[2025-02-21 01:28:05,043][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:28:36,333][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:29:07,647][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:29:38,498][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:30:09,456][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:30:41,156][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:31:12,603][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:31:44,156][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:32:14,960][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:32:46,256][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:33:16,853][root][INFO] - Processing question number 90
[2025-02-21 01:33:16,860][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:33:48,913][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:34:19,057][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:34:50,054][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:35:20,312][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:35:51,827][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:36:22,372][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:36:53,202][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:37:24,316][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:37:55,924][root][INFO] - Inference complete
[2025-02-21 01:37:55,924][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,931][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,949][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,955][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,955][root][INFO] - Saved parsed outputs
[2025-02-21 01:37:55,955][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,957][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,957][root][INFO] - Saved parsing metadata
[2025-02-21 01:37:55,957][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,959][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:37:55,960][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:37:55,979][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 01:37:55,979][root][INFO] - Summary of metrics : {'label_accuracy': 0.43434343434343436, 'misclassification_rate': 0.5656565656565656, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 6, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 43, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.5625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 01:38:03,771][root][INFO] - Setting global seed to 206
[2025-02-21 01:38:03,779][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:38:03,780][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 01:38:03,781][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:38:03,782][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:38:03,784][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:38:03,784][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:38:03,977][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:38:04,294][root][INFO] - Full model selected, loading model
[2025-02-21 01:38:19,360][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:38:19,360][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:38:25,675][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:38:25,676][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 01:38:25,677][root][INFO] - Starting inference
[2025-02-21 01:38:25,862][root][INFO] - Processing question number 0
[2025-02-21 01:38:25,864][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:38:56,125][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:39:27,333][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:39:58,107][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:40:29,355][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:41:00,047][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:41:30,692][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:42:02,163][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:42:33,067][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:43:03,600][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:43:34,872][root][INFO] - Processing question number 10
[2025-02-21 01:43:34,874][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:44:07,474][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:44:37,781][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:45:08,648][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:45:40,111][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:46:11,556][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:46:41,964][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:47:12,254][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:47:43,028][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:48:13,782][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:48:44,307][root][INFO] - Processing question number 20
[2025-02-21 01:48:44,309][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:49:15,038][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:49:46,000][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:50:16,408][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:50:46,698][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:51:17,749][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:51:48,533][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:52:20,144][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:52:50,887][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:53:21,816][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:53:52,034][root][INFO] - Processing question number 30
[2025-02-21 01:53:52,037][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:54:23,154][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:54:54,607][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:55:25,529][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:55:56,236][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:56:26,844][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:56:58,235][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:57:28,917][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:58:00,075][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:58:31,015][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:59:02,643][root][INFO] - Processing question number 40
[2025-02-21 01:59:02,646][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:59:33,610][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:00:04,564][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:00:36,018][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:01:07,426][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:01:38,054][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:02:08,977][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:02:41,195][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:03:11,204][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:03:41,968][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:04:13,461][root][INFO] - Processing question number 50
[2025-02-21 02:04:13,465][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:04:45,130][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:05:16,165][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:05:46,396][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:06:18,364][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:06:49,375][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:07:19,413][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:07:51,049][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:08:21,491][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:08:52,985][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:09:25,265][root][INFO] - Processing question number 60
[2025-02-21 02:09:25,275][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:09:55,694][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:10:26,418][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:10:57,829][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:11:28,175][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:11:59,073][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:12:30,017][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:13:00,993][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:13:32,223][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:14:03,275][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:14:34,858][root][INFO] - Processing question number 70
[2025-02-21 02:14:34,863][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:15:05,553][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:15:36,281][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:16:06,890][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:16:38,090][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:17:09,250][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:17:39,741][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:18:11,095][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:18:42,200][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:19:13,552][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:19:44,248][root][INFO] - Processing question number 80
[2025-02-21 02:19:44,253][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:20:15,577][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:20:46,869][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:21:17,644][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:21:48,590][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:22:20,133][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:22:51,530][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:23:22,997][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:23:53,750][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:24:24,941][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:24:55,315][root][INFO] - Processing question number 90
[2025-02-21 02:24:55,320][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:25:27,187][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:25:57,067][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:26:27,817][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:26:57,881][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:27:29,248][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:27:59,685][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:28:30,499][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:29:01,630][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:29:33,245][root][INFO] - Inference complete
[2025-02-21 02:29:33,246][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,252][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,256][root][WARNING] - No match found for 6. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 02:29:33,267][root][WARNING] - No match found for 6. Chosen Option Label in question number 39 in domain Property
[2025-02-21 02:29:33,269][root][WARNING] - No match found for 6. Chosen Option Label in question number 26 in domain Criminal_law
[2025-02-21 02:29:33,272][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,279][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,279][root][INFO] - Saved parsed outputs
[2025-02-21 02:29:33,279][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,282][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,282][root][INFO] - Saved parsing metadata
[2025-02-21 02:29:33,282][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,284][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:29:33,285][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:29:33,300][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 02:29:33,300][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 3, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 7, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 02:29:40,584][root][INFO] - Setting global seed to 206
[2025-02-21 02:29:40,591][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:29:40,591][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 02:29:40,592][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:29:40,594][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:29:40,597][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:29:40,597][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:29:40,825][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:29:41,125][root][INFO] - Full model selected, loading model
[2025-02-21 02:29:57,277][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:30:57,912][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:30:57,912][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:31:23,265][root][INFO] - Peft model loaded successfully
[2025-02-21 02:31:29,243][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:31:29,244][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 02:31:29,245][root][INFO] - Starting inference
[2025-02-21 02:31:29,458][root][INFO] - Processing question number 0
[2025-02-21 02:31:29,460][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:31:59,841][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:32:31,149][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:33:01,990][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:33:33,341][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:34:04,049][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:34:34,696][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:35:06,201][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:35:37,189][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:36:07,868][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:36:39,287][root][INFO] - Processing question number 10
[2025-02-21 02:36:39,289][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:37:11,956][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:37:42,379][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:38:13,336][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:38:44,888][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:39:16,423][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:39:46,924][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:40:17,346][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:40:48,264][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:41:19,157][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:41:49,771][root][INFO] - Processing question number 20
[2025-02-21 02:41:49,774][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:42:20,645][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:42:51,745][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:43:22,243][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:43:52,676][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:44:23,816][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:44:54,750][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:45:26,597][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:45:57,496][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:46:28,516][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:46:58,824][root][INFO] - Processing question number 30
[2025-02-21 02:46:58,827][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:47:30,062][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:48:01,734][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:48:32,749][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:49:03,600][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:49:34,304][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:50:05,782][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:50:36,558][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:51:07,763][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:51:38,768][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:52:10,513][root][INFO] - Processing question number 40
[2025-02-21 02:52:10,516][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:52:41,591][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:53:12,643][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:53:44,193][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:54:15,700][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:54:46,421][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:55:17,446][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:55:49,764][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:56:19,871][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:56:50,780][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:57:22,365][root][INFO] - Processing question number 50
[2025-02-21 02:57:22,369][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:57:54,156][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:58:25,297][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:58:55,623][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:59:27,701][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:59:58,808][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:00:28,938][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:01:00,697][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:01:31,229][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:02:02,818][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:02:35,206][root][INFO] - Processing question number 60
[2025-02-21 03:02:35,211][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:03:05,865][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:03:36,882][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:04:08,519][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:04:39,113][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:05:10,266][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:05:41,332][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:06:12,405][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:06:43,814][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:07:14,992][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:07:46,695][root][INFO] - Processing question number 70
[2025-02-21 03:07:46,700][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:08:17,548][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:08:48,445][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:09:19,170][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:09:50,564][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:10:21,915][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:10:52,493][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:11:23,941][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:11:55,134][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:12:26,589][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:12:57,447][root][INFO] - Processing question number 80
[2025-02-21 03:12:57,452][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:13:28,694][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:13:59,920][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:14:30,659][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:15:01,430][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:15:33,020][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:16:04,424][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:16:35,876][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:17:06,591][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:17:37,754][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:18:08,246][root][INFO] - Processing question number 90
[2025-02-21 03:18:08,251][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:18:40,181][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:19:10,176][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:19:41,059][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:20:11,210][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:20:42,807][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:21:13,373][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:21:44,237][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:22:15,434][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:22:47,053][root][INFO] - Inference complete
[2025-02-21 03:22:47,054][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,061][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,070][root][WARNING] - No match found for 6. Chosen Option Label in question number 4 in domain Torts
[2025-02-21 03:22:47,080][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,087][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,087][root][INFO] - Saved parsed outputs
[2025-02-21 03:22:47,087][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,089][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,089][root][INFO] - Saved parsing metadata
[2025-02-21 03:22:47,089][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,091][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:22:47,093][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:22:47,100][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 03:22:47,100][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 22, 'malformed_domain': 45, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.0707070707070707, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 10, 'both_wrong': 35}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 03:22:53,627][root][INFO] - Setting global seed to 206
[2025-02-21 03:22:53,632][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:22:53,632][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 03:22:53,634][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:22:53,635][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:22:53,637][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:22:53,637][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:22:53,778][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:22:54,038][root][INFO] - Full model selected, loading model
[2025-02-21 03:23:06,262][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:23:06,262][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:23:12,607][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:23:12,608][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 03:23:12,608][root][INFO] - Starting inference
[2025-02-21 03:23:12,745][root][INFO] - Processing question number 0
[2025-02-21 03:23:12,747][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:23:43,134][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:24:14,431][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:24:45,243][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:25:16,436][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:25:47,076][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:26:17,671][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:26:49,098][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:27:20,022][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:27:50,571][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:28:21,765][root][INFO] - Processing question number 10
[2025-02-21 03:28:21,768][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:28:54,324][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:29:24,645][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:29:55,562][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:30:27,041][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:30:58,493][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:31:28,916][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:31:59,215][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:32:30,001][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:32:50,873][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:33:21,413][root][INFO] - Processing question number 20
[2025-02-21 03:33:21,415][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:33:52,151][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:34:23,134][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:34:53,674][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:35:24,000][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:35:55,058][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:36:25,858][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:36:57,482][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:37:28,244][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:37:59,209][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:38:29,510][root][INFO] - Processing question number 30
[2025-02-21 03:38:29,513][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:39:00,805][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:39:32,390][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:40:03,484][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:40:34,316][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:41:05,063][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:41:36,480][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:42:07,183][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:42:38,316][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:43:09,243][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:43:40,892][root][INFO] - Processing question number 40
[2025-02-21 03:43:40,895][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:44:11,873][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:44:42,846][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:45:14,315][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:45:45,761][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:46:16,554][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:46:47,495][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:47:19,725][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:47:49,750][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:48:20,527][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:48:52,038][root][INFO] - Processing question number 50
[2025-02-21 03:48:52,041][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:49:23,725][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:49:54,778][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:50:25,022][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:50:57,008][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:51:28,033][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:51:58,090][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:52:29,738][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:53:00,189][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:53:31,693][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:54:04,010][root][INFO] - Processing question number 60
[2025-02-21 03:54:04,014][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:54:34,469][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:55:05,221][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:55:36,658][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:56:07,033][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:56:37,954][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:57:08,915][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:57:39,902][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:58:11,167][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:58:42,360][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:59:13,948][root][INFO] - Processing question number 70
[2025-02-21 03:59:13,953][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:59:44,650][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:00:15,390][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:00:46,003][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:01:17,214][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:01:48,378][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:02:18,873][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:02:50,255][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:03:21,386][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:03:52,751][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:04:23,463][root][INFO] - Processing question number 80
[2025-02-21 04:04:23,469][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:04:54,624][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:05:25,778][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:05:56,427][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:06:27,110][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:06:58,607][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:07:29,842][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:08:01,207][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:08:31,836][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:09:02,917][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:09:33,272][root][INFO] - Processing question number 90
[2025-02-21 04:09:33,278][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:10:05,114][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:10:34,996][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:11:05,740][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:11:35,806][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:12:07,172][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:12:37,521][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:13:08,194][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:13:39,199][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:14:10,693][root][INFO] - Inference complete
[2025-02-21 04:14:10,693][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,700][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,722][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,729][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,729][root][INFO] - Saved parsed outputs
[2025-02-21 04:14:10,729][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,740][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,740][root][INFO] - Saved parsing metadata
[2025-02-21 04:14:10,740][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,742][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:14:10,749][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:14:10,756][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 04:14:10,756][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 0, 'malformed_domain': 35, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.09090909090909091, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 14, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 04:14:16,997][root][INFO] - Setting global seed to 989
[2025-02-21 04:14:17,002][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 04:14:17,002][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 04:14:17,003][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:14:17,005][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:14:17,006][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:14:17,007][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:14:17,199][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:14:17,525][root][INFO] - Full model selected, loading model
[2025-02-21 04:14:30,315][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:15:31,640][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:15:31,640][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:15:57,815][root][INFO] - Peft model loaded successfully
[2025-02-21 04:16:03,899][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:16:03,901][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 04:16:03,901][root][INFO] - Starting inference
[2025-02-21 04:16:04,144][root][INFO] - Processing question number 0
[2025-02-21 04:16:04,146][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:16:34,569][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:17:05,887][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:17:36,591][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:18:07,783][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:18:38,344][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:19:08,861][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:19:40,193][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:20:11,041][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:20:41,491][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:21:12,679][root][INFO] - Processing question number 10
[2025-02-21 04:21:12,681][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:21:45,193][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:22:15,446][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:22:46,239][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:23:17,614][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:23:48,985][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:24:19,310][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:24:49,557][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:25:20,299][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:25:51,016][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:26:21,451][root][INFO] - Processing question number 20
[2025-02-21 04:26:21,454][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:26:52,147][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:27:23,025][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:27:53,349][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:28:23,615][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:28:54,600][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:29:25,353][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:29:56,887][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:30:27,610][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:30:58,452][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:31:28,586][root][INFO] - Processing question number 30
[2025-02-21 04:31:28,590][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:31:59,622][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:32:30,986][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:33:01,825][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:33:32,507][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:34:03,038][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:34:34,355][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:35:04,965][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:35:35,989][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:36:06,815][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:36:38,386][root][INFO] - Processing question number 40
[2025-02-21 04:36:38,389][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:37:09,285][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:37:40,160][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:38:11,629][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:38:43,002][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:39:13,551][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:39:44,403][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:40:16,551][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:40:46,468][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:41:17,206][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:41:48,627][root][INFO] - Processing question number 50
[2025-02-21 04:41:48,631][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:42:20,245][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:42:51,212][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:43:21,393][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:43:53,271][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:44:24,204][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:44:54,156][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:45:25,722][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:45:56,063][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:46:27,481][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:46:59,671][root][INFO] - Processing question number 60
[2025-02-21 04:46:59,675][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:47:30,004][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:48:00,692][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:48:32,019][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:49:02,336][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:49:33,157][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:50:04,023][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:50:34,939][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:51:06,171][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:51:37,144][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:52:08,652][root][INFO] - Processing question number 70
[2025-02-21 04:52:08,657][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:52:39,323][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:53:10,033][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:53:40,565][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:54:11,777][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:54:42,938][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:55:13,464][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:55:44,862][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:56:15,956][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:56:47,340][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:57:18,125][root][INFO] - Processing question number 80
[2025-02-21 04:57:18,131][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:57:49,219][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:58:20,251][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:58:50,804][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:59:21,399][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:59:52,797][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:00:24,024][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:00:55,317][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:01:25,863][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:01:56,853][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:02:27,174][root][INFO] - Processing question number 90
[2025-02-21 05:02:27,180][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:02:58,950][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:03:28,785][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:03:59,513][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:04:29,504][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:05:00,793][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:05:31,100][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:06:01,699][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:06:32,616][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:07:04,055][root][INFO] - Inference complete
[2025-02-21 05:07:04,055][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,062][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,073][root][WARNING] - No match found for 6. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 05:07:04,082][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,096][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,096][root][INFO] - Saved parsed outputs
[2025-02-21 05:07:04,096][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,098][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,098][root][INFO] - Saved parsing metadata
[2025-02-21 05:07:04,098][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:04,109][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:07:04,137][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 05:07:04,137][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 6, 'malformed_domain': 33, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1111111111111111, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 8, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 05:07:11,716][root][INFO] - Setting global seed to 989
[2025-02-21 05:07:11,724][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 05:07:11,724][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:07:11,725][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:07:11,727][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:07:11,729][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:07:11,729][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:07:11,885][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:07:12,166][root][INFO] - Full model selected, loading model
[2025-02-21 05:07:28,882][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:07:28,882][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:07:35,134][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:07:35,135][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:07:35,135][root][INFO] - Starting inference
[2025-02-21 05:07:35,324][root][INFO] - Processing question number 0
[2025-02-21 05:07:35,331][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:08:05,277][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:08:36,220][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:09:06,711][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:09:37,747][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:10:08,258][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:10:38,699][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:11:10,045][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:11:40,860][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:12:11,340][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:12:42,347][root][INFO] - Processing question number 10
[2025-02-21 05:12:42,349][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:13:14,696][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:13:44,796][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:14:15,464][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:14:46,725][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:15:17,965][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:15:48,170][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:16:18,258][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:16:48,828][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:17:19,377][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:17:49,692][root][INFO] - Processing question number 20
[2025-02-21 05:17:49,695][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:18:20,233][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:18:51,127][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:19:21,362][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:19:51,458][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:20:22,308][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:20:52,900][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:21:24,316][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:21:54,864][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:22:25,597][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:22:55,612][root][INFO] - Processing question number 30
[2025-02-21 05:22:55,615][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:23:26,533][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:23:57,787][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:24:28,509][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:24:59,018][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:25:29,521][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:26:00,717][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:26:31,191][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:27:02,097][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:27:32,804][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:28:04,227][root][INFO] - Processing question number 40
[2025-02-21 05:28:04,230][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:28:35,019][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:29:05,789][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:29:37,055][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:30:08,278][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:30:38,717][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:31:09,447][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:31:41,469][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:32:11,278][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:32:41,832][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:33:13,144][root][INFO] - Processing question number 50
[2025-02-21 05:33:13,148][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:33:44,742][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:34:15,575][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:34:45,600][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:35:17,372][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:35:48,177][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:36:18,006][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:36:49,434][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:37:19,657][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:37:50,937][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:38:23,009][root][INFO] - Processing question number 60
[2025-02-21 05:38:23,013][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:38:53,207][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:39:23,716][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:39:54,914][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:40:25,048][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:40:55,727][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:41:26,458][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:41:57,216][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:42:28,233][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:42:59,086][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:43:30,469][root][INFO] - Processing question number 70
[2025-02-21 05:43:30,474][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:44:00,958][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:44:31,489][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:45:01,890][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:45:32,896][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:46:03,940][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:46:34,244][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:47:05,399][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:47:36,319][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:48:07,464][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:48:37,949][root][INFO] - Processing question number 80
[2025-02-21 05:48:37,954][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:49:08,877][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:49:39,781][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:50:10,183][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:50:40,627][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:51:11,927][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:51:42,925][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:52:14,072][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:52:44,474][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:53:15,334][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:53:45,464][root][INFO] - Processing question number 90
[2025-02-21 05:53:45,469][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:54:17,092][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:54:46,743][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:55:17,265][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:55:47,103][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:56:18,246][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:56:48,367][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:57:18,812][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:57:49,597][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:58:20,868][root][INFO] - Inference complete
[2025-02-21 05:58:20,869][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,875][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,879][root][WARNING] - No match found for 6. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 05:58:20,889][root][WARNING] - No match found for 6. Chosen Option Label in question number 39 in domain Property
[2025-02-21 05:58:20,892][root][WARNING] - No match found for 6. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 05:58:20,894][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,900][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,900][root][INFO] - Saved parsed outputs
[2025-02-21 05:58:20,901][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,915][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,915][root][INFO] - Saved parsing metadata
[2025-02-21 05:58:20,915][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,917][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 05:58:20,918][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:58:20,944][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 05:58:20,944][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 3, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 8, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 05:58:27,651][root][INFO] - Setting global seed to 989
[2025-02-21 05:58:27,658][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 05:58:27,658][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 05:58:27,660][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:58:27,661][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:58:27,663][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:58:27,663][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:58:27,811][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:58:28,093][root][INFO] - Full model selected, loading model
[2025-02-21 05:58:45,169][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:59:45,722][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:59:45,722][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:00:11,182][root][INFO] - Peft model loaded successfully
[2025-02-21 06:00:17,127][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:00:17,128][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:00:17,128][root][INFO] - Starting inference
[2025-02-21 06:00:17,323][root][INFO] - Processing question number 0
[2025-02-21 06:00:17,325][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:00:47,706][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:01:19,017][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:01:49,861][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:02:21,344][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:02:52,231][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:03:23,058][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:03:54,725][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:04:25,896][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:04:56,619][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:05:27,972][root][INFO] - Processing question number 10
[2025-02-21 06:05:27,974][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:06:00,638][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:06:31,071][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:07:02,032][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:07:33,588][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:08:05,123][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:08:35,626][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:09:06,068][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:09:37,048][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:10:07,945][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:10:38,563][root][INFO] - Processing question number 20
[2025-02-21 06:10:38,566][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:11:09,533][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:11:40,727][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:12:11,341][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:12:41,931][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:13:13,103][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:13:44,043][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:14:15,761][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:14:46,662][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:15:17,693][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:15:48,032][root][INFO] - Processing question number 30
[2025-02-21 06:15:48,036][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:16:19,256][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:16:50,838][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:17:21,986][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:17:52,859][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:18:23,579][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:18:55,068][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:19:25,855][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:19:57,052][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:20:28,122][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:20:59,971][root][INFO] - Processing question number 40
[2025-02-21 06:20:59,975][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:21:31,043][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:22:02,099][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:22:33,656][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:23:05,157][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:23:35,877][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:24:06,891][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:24:39,213][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:25:09,324][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:25:40,236][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:26:11,831][root][INFO] - Processing question number 50
[2025-02-21 06:26:11,836][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:26:43,625][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:27:14,763][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:27:45,091][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:28:17,165][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:28:48,277][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:29:18,414][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:29:50,162][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:30:20,690][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:30:52,278][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:31:24,656][root][INFO] - Processing question number 60
[2025-02-21 06:31:24,660][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:31:55,167][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:32:26,043][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:32:57,545][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:33:28,033][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:33:59,065][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:34:30,276][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:35:01,365][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:35:32,799][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:36:03,967][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:36:35,732][root][INFO] - Processing question number 70
[2025-02-21 06:36:35,737][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:37:06,756][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:37:37,769][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:38:08,635][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:38:40,166][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:39:11,702][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:39:42,290][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:40:13,733][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:40:44,929][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:41:16,364][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:41:47,203][root][INFO] - Processing question number 80
[2025-02-21 06:41:47,209][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:42:18,434][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:42:49,658][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:43:20,419][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:43:51,172][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:44:22,748][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:44:54,139][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:45:25,588][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:45:56,293][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:46:27,451][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:46:57,931][root][INFO] - Processing question number 90
[2025-02-21 06:46:57,937][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:47:29,864][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:47:59,860][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:48:30,742][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:49:00,888][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:49:32,329][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:50:02,797][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:50:33,552][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:51:04,634][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:51:36,229][root][INFO] - Inference complete
[2025-02-21 06:51:36,229][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,236][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,238][root][WARNING] - No match found for 6. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 06:51:36,253][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,259][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,259][root][INFO] - Saved parsed outputs
[2025-02-21 06:51:36,259][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,261][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,261][root][INFO] - Saved parsing metadata
[2025-02-21 06:51:36,261][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,263][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:51:36,264][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:51:36,277][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 06:51:36,277][root][INFO] - Summary of metrics : {'label_accuracy': 0.3333333333333333, 'misclassification_rate': 0.6666666666666667, 'combined_accuracy': 0.23232323232323232, 'malformed_label': 9, 'malformed_domain': 39, 'total_predictions': 99, 'correct_predictions': 33, 'correct_label_and_domain': 23, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.09090909090909091, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 06:51:42,983][root][INFO] - Setting global seed to 989
[2025-02-21 06:51:42,989][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 06:51:42,989][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 06:51:42,990][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:51:42,992][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:51:42,994][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:51:42,994][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:51:43,143][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:51:43,398][root][INFO] - Full model selected, loading model
[2025-02-21 06:51:54,499][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:51:54,499][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:52:00,704][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:52:00,706][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 06:52:00,706][root][INFO] - Starting inference
[2025-02-21 06:52:00,885][root][INFO] - Processing question number 0
[2025-02-21 06:52:00,902][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:52:31,091][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:53:02,236][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:53:32,929][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:54:04,098][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:54:34,713][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:55:05,300][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:55:36,892][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:56:07,808][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:56:38,351][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:57:09,537][root][INFO] - Processing question number 10
[2025-02-21 06:57:09,539][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:57:42,086][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:58:12,391][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:58:43,268][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:59:14,738][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:59:46,254][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:00:16,678][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:00:46,966][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:01:17,850][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:01:48,721][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:02:19,368][root][INFO] - Processing question number 20
[2025-02-21 07:02:19,371][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:02:50,276][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:03:21,278][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:03:51,708][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:04:22,024][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:04:53,096][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:05:23,913][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:05:55,540][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:06:26,298][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:06:57,241][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:07:27,473][root][INFO] - Processing question number 30
[2025-02-21 07:07:27,476][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:07:58,607][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:08:30,071][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:09:01,008][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:09:31,732][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:10:02,484][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:10:34,002][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:11:04,811][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:11:36,130][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:12:07,215][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:12:38,958][root][INFO] - Processing question number 40
[2025-02-21 07:12:38,962][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:13:10,058][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:13:41,177][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:14:12,705][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:14:44,123][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:15:14,761][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:15:45,693][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:16:17,984][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:16:48,074][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:17:18,842][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:17:50,343][root][INFO] - Processing question number 50
[2025-02-21 07:17:50,347][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:18:22,021][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:18:53,066][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:19:23,305][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:19:55,279][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:20:26,298][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:20:56,342][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:21:27,986][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:21:58,431][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:22:29,932][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:23:02,220][root][INFO] - Processing question number 60
[2025-02-21 07:23:02,225][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:23:32,651][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:24:03,409][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:24:34,838][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:25:05,204][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:25:36,139][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:26:07,139][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:26:38,156][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:27:09,401][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:27:40,464][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:28:12,051][root][INFO] - Processing question number 70
[2025-02-21 07:28:12,056][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:28:42,751][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:29:13,512][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:29:44,149][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:30:15,535][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:30:46,713][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:31:17,205][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:31:48,555][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:32:19,664][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:32:51,016][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:33:21,724][root][INFO] - Processing question number 80
[2025-02-21 07:33:21,729][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:33:52,893][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:34:24,022][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:34:54,645][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:35:25,306][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:35:56,780][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:36:27,986][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:36:59,345][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:37:29,961][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:38:01,034][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:38:31,378][root][INFO] - Processing question number 90
[2025-02-21 07:38:31,383][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:39:03,211][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:39:33,078][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:40:03,816][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:40:33,870][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:41:05,226][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:41:35,565][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:42:06,233][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:42:37,230][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:43:08,715][root][INFO] - Inference complete
[2025-02-21 07:43:08,715][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,722][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,730][root][WARNING] - No match found for 6. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 07:43:08,734][root][WARNING] - No match found for 6. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 07:43:08,739][root][WARNING] - No match found for 6. Chosen Option Label in question number 89 in domain Property
[2025-02-21 07:43:08,740][root][WARNING] - No match found for 6. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 07:43:08,742][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,748][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,748][root][INFO] - Saved parsed outputs
[2025-02-21 07:43:08,748][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,750][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,750][root][INFO] - Saved parsing metadata
[2025-02-21 07:43:08,750][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,752][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:43:08,753][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:43:08,779][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 07:43:08,779][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 4, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 8, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 07:43:15,544][root][INFO] - Setting global seed to 989
[2025-02-21 07:43:15,552][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 07:43:15,552][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 07:43:15,553][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:43:15,555][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:43:15,558][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:43:15,558][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:43:15,714][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:43:15,961][root][INFO] - Full model selected, loading model
[2025-02-21 07:43:28,413][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:44:28,716][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:44:28,717][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:44:51,644][root][INFO] - Peft model loaded successfully
[2025-02-21 07:44:57,652][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:44:57,653][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 07:44:57,653][root][INFO] - Starting inference
[2025-02-21 07:44:57,836][root][INFO] - Processing question number 0
[2025-02-21 07:44:57,838][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:45:28,254][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:45:59,593][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:46:30,572][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:47:02,049][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:47:32,872][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:48:03,623][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:48:35,266][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:49:06,236][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:49:37,037][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:50:08,561][root][INFO] - Processing question number 10
[2025-02-21 07:50:08,563][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:50:41,333][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:51:11,922][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:51:42,871][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:52:14,421][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:52:45,934][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:53:16,407][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:53:46,807][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:54:17,703][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:54:48,575][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:55:01,423][root][INFO] - Processing question number 20
[2025-02-21 07:55:01,425][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:55:32,275][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:56:03,313][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:56:33,786][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:57:04,197][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:57:35,320][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:58:06,222][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:58:37,911][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:59:08,892][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:59:40,001][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:00:10,407][root][INFO] - Processing question number 30
[2025-02-21 08:00:10,411][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:00:41,755][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:01:13,280][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:01:44,275][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:02:15,106][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:02:45,785][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:03:17,248][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:03:47,998][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:04:19,247][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:04:50,412][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:05:22,151][root][INFO] - Processing question number 40
[2025-02-21 08:05:22,154][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:05:53,194][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:06:24,231][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:06:55,766][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:07:27,253][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:07:57,952][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:08:28,947][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:09:01,250][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:09:31,347][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:10:02,240][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:10:33,817][root][INFO] - Processing question number 50
[2025-02-21 08:10:33,822][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:11:05,582][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:11:36,701][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:12:07,006][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:12:39,089][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:13:10,179][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:13:40,290][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:14:12,022][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:14:42,554][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:15:14,136][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:15:46,509][root][INFO] - Processing question number 60
[2025-02-21 08:15:46,514][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:16:17,033][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:16:47,921][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:17:19,409][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:17:49,879][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:18:20,851][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:18:51,884][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:19:22,940][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:19:54,336][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:20:25,518][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:20:57,357][root][INFO] - Processing question number 70
[2025-02-21 08:20:57,362][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:21:28,292][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:21:59,314][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:22:30,081][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:23:01,609][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:23:32,930][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:24:03,485][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:24:34,902][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:25:06,071][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:25:37,486][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:26:08,302][root][INFO] - Processing question number 80
[2025-02-21 08:26:08,307][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:26:39,509][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:27:10,697][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:27:41,390][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:28:12,125][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:28:43,678][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:29:15,050][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:29:46,482][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:30:17,173][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:30:48,309][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:31:18,763][root][INFO] - Processing question number 90
[2025-02-21 08:31:18,769][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:31:50,674][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:32:20,651][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:32:51,512][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:33:21,633][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:33:53,061][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:34:23,511][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:34:54,247][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:35:25,316][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:35:56,912][root][INFO] - Inference complete
[2025-02-21 08:35:56,912][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,920][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 1. Chosen Domain in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 2. Legal Concept in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 3. Fact Analysis in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 4. Rule Application in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 5. Legal Conclusion in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,927][root][WARNING] - No match found for 6. Chosen Option Label in question number 65 in domain Constitutional_law
[2025-02-21 08:35:56,940][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,954][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,954][root][INFO] - Saved parsed outputs
[2025-02-21 08:35:56,954][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,977][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,977][root][INFO] - Saved parsing metadata
[2025-02-21 08:35:56,977][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,979][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:35:56,987][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:35:57,018][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 08:35:57,018][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 22, 'malformed_domain': 54, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.0707070707070707, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 29, 'correct_label_wrong_domain': 13, 'both_wrong': 41}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 08:36:03,186][root][INFO] - Setting global seed to 989
[2025-02-21 08:36:03,191][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 08:36:03,192][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 08:36:03,193][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:36:03,194][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:36:03,196][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:36:03,197][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:36:03,341][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:36:03,615][root][INFO] - Full model selected, loading model
[2025-02-21 08:36:14,594][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:36:14,594][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:36:20,844][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:36:20,846][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 08:36:20,846][root][INFO] - Starting inference
[2025-02-21 08:36:21,011][root][INFO] - Processing question number 0
[2025-02-21 08:36:21,023][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:36:51,240][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:37:22,411][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:37:53,119][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:38:24,337][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:38:55,090][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:39:25,674][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:39:57,088][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:40:28,042][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:40:58,573][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:41:29,746][root][INFO] - Processing question number 10
[2025-02-21 08:41:29,748][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:42:02,284][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:42:32,573][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:43:03,433][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:43:34,889][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:44:06,329][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:44:36,733][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:45:07,016][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:45:37,783][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:46:08,532][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:46:39,049][root][INFO] - Processing question number 20
[2025-02-21 08:46:39,051][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:47:09,774][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:47:40,731][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:48:11,133][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:48:41,432][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:49:12,605][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:49:43,488][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:50:15,201][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:50:46,078][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:51:17,007][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:51:47,222][root][INFO] - Processing question number 30
[2025-02-21 08:51:47,225][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:52:18,339][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:52:49,791][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:53:20,712][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:53:51,416][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:54:22,104][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:54:53,642][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:55:24,432][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:55:55,697][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:56:26,685][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:56:58,475][root][INFO] - Processing question number 40
[2025-02-21 08:56:58,478][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:57:29,447][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:58:00,402][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:58:31,860][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:59:03,266][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:59:33,911][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:00:04,858][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 09:00:37,182][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:01:07,309][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 09:01:38,180][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 09:02:09,834][root][INFO] - Processing question number 50
[2025-02-21 09:02:09,838][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:02:41,515][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 09:03:12,552][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 09:03:42,782][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 09:04:14,751][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 09:04:45,766][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 09:05:15,919][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 09:05:47,554][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 09:06:17,989][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 09:06:49,478][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 09:07:21,752][root][INFO] - Processing question number 60
[2025-02-21 09:07:21,757][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:07:52,173][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:08:22,885][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 09:08:54,285][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 09:09:24,621][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 09:09:55,507][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 09:10:26,444][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 09:10:57,450][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 09:11:28,681][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:11:59,733][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 09:12:31,317][root][INFO] - Processing question number 70
[2025-02-21 09:12:31,322][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 09:13:02,000][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 09:13:32,717][root][INFO] - Domain : Property, Question : 6
[2025-02-21 09:14:03,366][root][INFO] - Domain : Property, Question : 13
[2025-02-21 09:14:34,666][root][INFO] - Domain : Property, Question : 20
[2025-02-21 09:15:05,814][root][INFO] - Domain : Property, Question : 33
[2025-02-21 09:15:36,288][root][INFO] - Domain : Property, Question : 39
[2025-02-21 09:16:07,624][root][INFO] - Domain : Property, Question : 48
[2025-02-21 09:16:38,713][root][INFO] - Domain : Property, Question : 54
[2025-02-21 09:17:10,049][root][INFO] - Domain : Property, Question : 61
[2025-02-21 09:17:40,730][root][INFO] - Processing question number 80
[2025-02-21 09:17:40,735][root][INFO] - Domain : Property, Question : 67
[2025-02-21 09:18:11,859][root][INFO] - Domain : Property, Question : 75
[2025-02-21 09:18:42,966][root][INFO] - Domain : Property, Question : 83
[2025-02-21 09:19:13,575][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:19:44,222][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:20:15,690][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:20:46,887][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:21:18,234][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:21:48,837][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:22:19,900][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:22:50,231][root][INFO] - Processing question number 90
[2025-02-21 09:22:50,236][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:23:22,055][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:23:51,936][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:24:22,784][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:24:52,895][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:25:24,262][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:25:54,597][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:26:25,269][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:26:56,255][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:27:27,738][root][INFO] - Inference complete
[2025-02-21 09:27:27,738][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,745][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,747][root][WARNING] - No match found for 6. Chosen Option Label in question number 35 in domain Civil_procedure
[2025-02-21 09:27:27,755][root][WARNING] - No match found for 6. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 09:27:27,757][root][WARNING] - No match found for 6. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 09:27:27,761][root][WARNING] - No match found for 6. Chosen Option Label in question number 54 in domain Property
[2025-02-21 09:27:27,762][root][WARNING] - No match found for 6. Chosen Option Label in question number 67 in domain Property
[2025-02-21 09:27:27,763][root][WARNING] - No match found for 6. Chosen Option Label in question number 100 in domain Property
[2025-02-21 09:27:27,766][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,772][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,772][root][INFO] - Saved parsed outputs
[2025-02-21 09:27:27,772][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,779][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,779][root][INFO] - Saved parsing metadata
[2025-02-21 09:27:27,780][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,781][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
[2025-02-21 09:27:27,782][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:27:27,812][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_1
[2025-02-21 09:27:27,813][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.26262626262626265, 'malformed_label': 6, 'malformed_domain': 39, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 34, 'correct_label_wrong_domain': 10, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 09:27:35,321][root][INFO] - Setting global seed to 206
[2025-02-21 09:27:35,328][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:27:35,328][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 09:27:35,329][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:27:35,331][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:27:35,334][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:27:35,334][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:27:35,471][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:27:35,716][root][INFO] - Full model selected, loading model
[2025-02-21 09:27:48,073][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:28:48,464][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:28:48,464][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:29:14,203][root][INFO] - Peft model loaded successfully
[2025-02-21 09:29:20,219][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:29:20,221][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 09:29:20,221][root][INFO] - Starting inference
[2025-02-21 09:29:20,408][root][INFO] - Processing question number 0
[2025-02-21 09:29:20,410][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:29:51,480][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:30:23,061][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:30:54,817][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:31:26,118][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:31:56,712][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:32:26,784][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:32:57,350][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:33:28,206][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:33:58,346][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:34:29,120][root][INFO] - Processing question number 10
[2025-02-21 09:34:29,122][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 09:34:59,099][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 09:35:29,642][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 09:36:00,351][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 09:36:30,499][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 09:37:01,690][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 09:37:32,445][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:38:03,149][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 09:38:33,681][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 09:39:04,727][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 09:39:35,968][root][INFO] - Processing question number 20
[2025-02-21 09:39:35,971][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 09:40:05,988][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 09:40:36,869][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:41:07,258][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 09:41:37,812][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 09:42:08,536][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 09:42:39,772][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 09:43:10,506][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 09:43:41,452][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:44:12,177][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 09:44:43,519][root][INFO] - Processing question number 30
[2025-02-21 09:44:43,522][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 09:45:14,293][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 09:45:44,868][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 09:46:15,411][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 09:46:46,745][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 09:47:17,451][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 09:47:48,224][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:48:18,950][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 09:48:50,348][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:49:21,239][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 09:49:52,306][root][INFO] - Processing question number 40
[2025-02-21 09:49:52,310][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 09:50:23,319][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 09:50:54,133][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 09:51:25,515][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 09:51:55,559][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 09:52:26,995][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 09:52:57,868][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:53:28,584][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:53:59,470][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 09:54:30,246][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 09:55:01,435][root][INFO] - Processing question number 50
[2025-02-21 09:55:01,439][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 09:55:32,852][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 09:56:03,159][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 09:56:34,581][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:57:05,564][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 09:57:35,941][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 09:58:06,545][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 09:58:38,100][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 09:59:09,456][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 09:59:40,778][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:00:11,819][root][INFO] - Processing question number 60
[2025-02-21 10:00:11,823][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:00:42,691][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:01:13,759][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:01:45,494][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:02:16,812][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:02:48,005][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:03:18,721][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:03:49,284][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:04:19,706][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:04:50,401][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:05:21,032][root][INFO] - Processing question number 70
[2025-02-21 10:05:21,037][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:05:52,228][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:06:23,302][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:06:54,647][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:07:26,425][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:07:56,997][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:08:28,206][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:09:00,445][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:09:31,629][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:10:01,810][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:10:32,409][root][INFO] - Processing question number 80
[2025-02-21 10:10:32,414][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:11:03,958][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:11:35,473][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:12:06,923][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:12:38,011][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:13:10,133][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:13:40,858][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:14:12,179][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:14:43,966][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:15:14,899][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:15:45,854][root][INFO] - Processing question number 90
[2025-02-21 10:15:45,859][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:16:16,842][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:16:48,220][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:17:19,427][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:17:50,347][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:18:21,943][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:18:53,420][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:19:24,624][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:19:55,351][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:20:25,639][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:20:57,163][root][INFO] - Inference complete
[2025-02-21 10:20:57,163][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,169][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,182][root][WARNING] - No match found for 6. Chosen Option Label in question number 36 in domain Property
[2025-02-21 10:20:57,184][root][WARNING] - No match found for 6. Chosen Option Label in question number 94 in domain Property
[2025-02-21 10:20:57,187][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,201][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,201][root][INFO] - Saved parsed outputs
[2025-02-21 10:20:57,201][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,202][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,202][root][INFO] - Saved parsing metadata
[2025-02-21 10:20:57,203][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,204][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:20:57,207][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:20:57,221][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 10:20:57,222][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.16, 'malformed_label': 5, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 12, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 10:21:04,673][root][INFO] - Setting global seed to 206
[2025-02-21 10:21:04,679][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 10:21:04,679][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 10:21:04,681][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:21:04,682][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:21:04,684][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:21:04,684][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:21:04,826][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:21:05,065][root][INFO] - Full model selected, loading model
[2025-02-21 10:21:19,520][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 10:21:19,520][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 10:21:25,761][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:21:25,763][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 10:21:25,764][root][INFO] - Starting inference
[2025-02-21 10:21:25,948][root][INFO] - Processing question number 0
[2025-02-21 10:21:25,969][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:21:56,863][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:22:28,454][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:23:00,230][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:23:31,530][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:24:02,157][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:24:32,207][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:25:02,822][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:25:33,646][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:26:03,805][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:26:34,599][root][INFO] - Processing question number 10
[2025-02-21 10:26:34,601][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:27:04,604][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:27:35,177][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:28:05,857][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:28:36,042][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:29:07,138][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:29:37,794][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:30:08,396][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:30:38,889][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:31:09,896][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:31:41,014][root][INFO] - Processing question number 20
[2025-02-21 10:31:41,017][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:32:11,000][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:32:41,851][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:33:12,278][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:33:42,962][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:34:13,635][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:34:44,840][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:35:15,516][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:35:46,374][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:36:17,045][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:36:48,398][root][INFO] - Processing question number 30
[2025-02-21 10:36:48,401][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:37:19,173][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:37:49,743][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:38:20,280][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:38:51,616][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:39:22,214][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:39:52,939][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:40:23,564][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:40:54,951][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:41:25,818][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:41:56,721][root][INFO] - Processing question number 40
[2025-02-21 10:41:56,725][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:42:27,594][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:42:58,220][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:43:29,350][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:43:59,386][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:44:30,760][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:45:01,578][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:45:32,194][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:46:03,060][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:46:33,828][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:47:04,904][root][INFO] - Processing question number 50
[2025-02-21 10:47:04,908][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:47:36,299][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:48:06,601][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:48:38,100][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:49:09,091][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:49:39,435][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:50:10,004][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:50:41,510][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:51:12,813][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:51:44,136][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:52:15,201][root][INFO] - Processing question number 60
[2025-02-21 10:52:15,206][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:52:46,126][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:53:17,080][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:53:48,759][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:54:19,949][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:54:50,921][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:55:21,399][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:55:51,735][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:56:21,904][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:56:52,393][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:57:22,845][root][INFO] - Processing question number 70
[2025-02-21 10:57:22,850][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:57:53,875][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:58:24,796][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:58:55,907][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:59:27,501][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:59:57,895][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:00:28,912][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:01:00,937][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:01:32,009][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:02:02,080][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:02:32,561][root][INFO] - Processing question number 80
[2025-02-21 11:02:32,566][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:03:03,980][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:03:35,433][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:04:06,787][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:04:37,773][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:05:09,692][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:05:40,276][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:06:11,537][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:06:43,288][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:07:14,199][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:07:45,136][root][INFO] - Processing question number 90
[2025-02-21 11:07:45,142][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:08:16,075][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:08:47,408][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:09:18,439][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:09:49,250][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:10:20,723][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:10:52,118][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:11:23,164][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:11:53,771][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:12:23,927][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:12:55,334][root][INFO] - Inference complete
[2025-02-21 11:12:55,334][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,342][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,355][root][WARNING] - No match found for 4. Rule Application in question number 61 in domain Civil_procedure
[2025-02-21 11:12:55,355][root][WARNING] - No match found for 5. Legal Conclusion in question number 61 in domain Civil_procedure
[2025-02-21 11:12:55,355][root][WARNING] - No match found for 6. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 11:12:55,359][root][WARNING] - No match found for 6. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 11:12:55,363][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,369][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,369][root][INFO] - Saved parsed outputs
[2025-02-21 11:12:55,369][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,371][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,371][root][INFO] - Saved parsing metadata
[2025-02-21 11:12:55,372][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,374][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:12:55,376][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:12:55,389][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 11:12:55,389][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.21, 'malformed_label': 2, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 11, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 11:13:03,122][root][INFO] - Setting global seed to 206
[2025-02-21 11:13:03,129][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 11:13:03,129][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 11:13:03,130][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:13:03,132][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:13:03,135][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:13:03,135][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:13:03,281][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:13:03,550][root][INFO] - Full model selected, loading model
[2025-02-21 11:13:18,279][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 11:14:21,592][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 11:14:21,593][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 11:14:47,769][root][INFO] - Peft model loaded successfully
[2025-02-21 11:14:53,790][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:14:53,792][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 11:14:53,792][root][INFO] - Starting inference
[2025-02-21 11:14:53,983][root][INFO] - Processing question number 0
[2025-02-21 11:14:53,986][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:15:25,335][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:15:57,127][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:16:29,120][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:17:00,645][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:17:31,444][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:18:01,715][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:18:32,510][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:19:03,590][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:19:33,922][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:20:04,947][root][INFO] - Processing question number 10
[2025-02-21 11:20:04,951][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:20:35,156][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:21:05,915][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:21:36,819][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:22:07,178][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:22:38,557][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:23:09,515][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:23:40,432][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:24:11,169][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:24:42,418][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:25:13,851][root][INFO] - Processing question number 20
[2025-02-21 11:25:13,853][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:25:44,115][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:26:15,260][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:26:45,909][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:27:16,720][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:27:47,650][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:28:19,156][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:28:50,133][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:29:21,244][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:29:52,191][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:30:23,761][root][INFO] - Processing question number 30
[2025-02-21 11:30:23,765][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:30:54,797][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:31:25,632][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:31:56,420][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:32:28,005][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:32:59,057][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:33:30,164][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:34:01,213][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:34:32,968][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:35:04,107][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:35:35,288][root][INFO] - Processing question number 40
[2025-02-21 11:35:35,292][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:36:06,434][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:36:37,398][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:37:08,912][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:37:39,222][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:38:10,909][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:38:42,024][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:39:12,949][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:39:44,059][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:40:15,065][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:40:46,484][root][INFO] - Processing question number 50
[2025-02-21 11:40:46,488][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:41:18,141][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:41:48,726][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:42:20,421][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:42:51,699][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:43:22,350][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:43:53,247][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:44:25,017][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:44:56,546][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:45:28,138][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:45:59,471][root][INFO] - Processing question number 60
[2025-02-21 11:45:59,497][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:46:30,626][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:47:01,803][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:47:33,682][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:48:05,123][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:48:36,362][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:49:07,182][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:49:37,745][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:50:08,193][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:50:38,897][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:51:09,560][root][INFO] - Processing question number 70
[2025-02-21 11:51:09,566][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:51:40,799][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:52:11,934][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:52:43,370][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:53:15,269][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:53:45,902][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:54:17,201][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:54:49,590][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:55:21,066][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:55:51,486][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:56:22,243][root][INFO] - Processing question number 80
[2025-02-21 11:56:22,250][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:56:53,932][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:57:25,652][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:57:57,318][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:58:28,588][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:59:00,808][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:59:31,649][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:00:03,137][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:00:35,186][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:01:06,383][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:01:37,598][root][INFO] - Processing question number 90
[2025-02-21 12:01:37,603][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:02:08,823][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:02:40,429][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:03:11,868][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:03:42,936][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:04:14,703][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:04:46,351][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:05:17,813][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:05:48,796][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:06:19,347][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:06:51,121][root][INFO] - Inference complete
[2025-02-21 12:06:51,121][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,131][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,136][root][WARNING] - No match found for 6. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 12:06:51,149][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,155][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,155][root][INFO] - Saved parsed outputs
[2025-02-21 12:06:51,155][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,156][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,157][root][INFO] - Saved parsing metadata
[2025-02-21 12:06:51,157][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,159][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:06:51,161][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:06:51,173][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 12:06:51,173][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.2, 'malformed_label': 7, 'malformed_domain': 38, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.08, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 26}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 12:06:57,611][root][INFO] - Setting global seed to 206
[2025-02-21 12:06:57,616][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 12:06:57,616][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 12:06:57,618][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:06:57,619][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:06:57,621][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:06:57,621][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:06:57,770][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:06:58,026][root][INFO] - Full model selected, loading model
[2025-02-21 12:07:09,457][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 12:07:09,457][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 12:07:15,807][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:07:15,809][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:07:15,809][root][INFO] - Starting inference
[2025-02-21 12:07:15,989][root][INFO] - Processing question number 0
[2025-02-21 12:07:15,991][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:07:47,219][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:08:18,977][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:08:50,818][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:09:22,210][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:09:52,934][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:10:23,123][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:10:53,823][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:11:24,847][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:11:55,153][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:12:26,084][root][INFO] - Processing question number 10
[2025-02-21 12:12:26,085][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:12:56,218][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:13:26,900][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:13:57,679][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:14:27,954][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:14:59,185][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:15:30,051][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:16:00,858][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:16:31,545][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:17:02,752][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:17:34,097][root][INFO] - Processing question number 20
[2025-02-21 12:17:34,101][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:18:04,292][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:18:35,360][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:19:05,872][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:19:36,511][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:20:07,264][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:20:38,559][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:21:09,367][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:21:40,406][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:22:11,226][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:22:42,703][root][INFO] - Processing question number 30
[2025-02-21 12:22:42,707][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:23:13,620][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:23:44,314][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:24:14,968][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:24:46,397][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:25:17,182][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:25:48,093][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:26:18,889][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:26:50,419][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:27:21,441][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:27:52,506][root][INFO] - Processing question number 40
[2025-02-21 12:27:52,510][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:28:23,490][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:28:54,226][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:29:25,461][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:29:55,650][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:30:27,248][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:30:58,271][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:31:29,087][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:32:00,108][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:32:31,032][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:33:02,318][root][INFO] - Processing question number 50
[2025-02-21 12:33:02,322][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:33:33,940][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:34:04,464][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:34:36,134][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:35:07,258][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:35:37,761][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:36:08,492][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:36:40,208][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:37:11,682][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:37:43,163][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:38:14,369][root][INFO] - Processing question number 60
[2025-02-21 12:38:14,375][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:38:45,332][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:39:16,394][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:39:48,108][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:40:19,311][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:40:50,433][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:41:21,068][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:41:51,538][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:42:21,840][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:42:52,463][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:43:23,001][root][INFO] - Processing question number 70
[2025-02-21 12:43:23,006][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:43:54,122][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:44:25,125][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:44:56,341][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:45:28,070][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:45:58,613][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:46:29,790][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:47:01,938][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:47:33,123][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:48:03,319][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:48:33,976][root][INFO] - Processing question number 80
[2025-02-21 12:48:33,982][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:49:05,525][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:49:37,083][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:50:08,552][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:50:39,695][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:51:11,773][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:51:42,508][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:52:13,894][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:52:45,774][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:53:16,787][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:53:47,817][root][INFO] - Processing question number 90
[2025-02-21 12:53:47,823][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:54:18,935][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:54:50,448][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:55:21,703][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:55:52,789][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:56:24,438][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:56:55,982][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:57:27,177][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:57:57,916][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:58:28,218][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:58:59,754][root][INFO] - Inference complete
[2025-02-21 12:58:59,754][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,763][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,764][root][WARNING] - No match found for 6. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 12:58:59,779][root][WARNING] - No match found for 6. Chosen Option Label in question number 94 in domain Property
[2025-02-21 12:58:59,780][root][WARNING] - No match found for 6. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 12:58:59,781][root][WARNING] - No match found for 6. Chosen Option Label in question number 45 in domain Torts
[2025-02-21 12:58:59,783][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,793][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,794][root][INFO] - Saved parsed outputs
[2025-02-21 12:58:59,794][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,796][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,796][root][INFO] - Saved parsing metadata
[2025-02-21 12:58:59,797][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,798][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 12:58:59,800][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:58:59,811][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 12:58:59,811][root][INFO] - Summary of metrics : {'label_accuracy': 0.31, 'misclassification_rate': 0.69, 'combined_accuracy': 0.19, 'malformed_label': 4, 'malformed_domain': 28, 'total_predictions': 100, 'correct_predictions': 31, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 12, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 12:59:05,972][root][INFO] - Setting global seed to 206
[2025-02-21 12:59:05,977][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 12:59:05,978][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 12:59:05,979][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:59:05,980][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:59:05,982][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:59:05,983][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:59:06,132][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:59:06,387][root][INFO] - Full model selected, loading model
[2025-02-21 12:59:17,534][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 13:00:19,506][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 13:00:19,506][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 13:00:46,144][root][INFO] - Peft model loaded successfully
[2025-02-21 13:00:52,197][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:00:52,199][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:00:52,199][root][INFO] - Starting inference
[2025-02-21 13:00:52,376][root][INFO] - Processing question number 0
[2025-02-21 13:00:52,379][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:01:23,780][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:01:55,602][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:02:27,568][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:02:59,039][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:03:29,826][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:04:00,079][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:04:30,866][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:05:01,942][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:05:32,314][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:06:03,330][root][INFO] - Processing question number 10
[2025-02-21 13:06:03,332][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:06:33,532][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:07:04,291][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:07:35,232][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:08:05,616][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:08:37,024][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:09:07,998][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:09:38,937][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:10:09,706][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:10:40,988][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:11:12,467][root][INFO] - Processing question number 20
[2025-02-21 13:11:12,471][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:11:42,721][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:12:13,831][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:12:44,454][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:13:15,209][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:13:46,088][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:14:17,535][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:14:48,492][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:15:19,654][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:15:50,629][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:16:22,217][root][INFO] - Processing question number 30
[2025-02-21 13:16:22,221][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:16:53,264][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:17:24,081][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:17:54,896][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:18:26,432][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:18:57,325][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:19:28,359][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:19:59,354][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:20:31,027][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:21:02,239][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:21:33,425][root][INFO] - Processing question number 40
[2025-02-21 13:21:33,432][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:22:04,795][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:22:35,807][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:23:07,262][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:23:37,510][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:24:09,196][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:24:40,346][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:25:11,336][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:25:42,491][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:26:13,559][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:26:45,029][root][INFO] - Processing question number 50
[2025-02-21 13:26:45,033][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:27:16,724][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:27:47,307][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:28:18,999][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:28:50,274][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:29:20,885][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:29:51,765][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:30:23,607][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:30:55,210][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:31:26,826][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:31:58,163][root][INFO] - Processing question number 60
[2025-02-21 13:31:58,168][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:32:29,278][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:33:00,351][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:33:32,143][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:34:03,553][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:34:34,844][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:35:05,673][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:35:36,284][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:36:06,747][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:36:37,456][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:37:08,060][root][INFO] - Processing question number 70
[2025-02-21 13:37:08,064][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:37:39,243][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:38:10,325][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:38:41,690][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:39:13,490][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:39:44,096][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:40:15,358][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:40:47,683][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:41:19,065][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:41:49,361][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:42:20,063][root][INFO] - Processing question number 80
[2025-02-21 13:42:20,070][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:42:51,709][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:43:23,384][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:43:54,987][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:44:26,241][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:44:58,577][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:45:29,565][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:46:01,116][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:46:33,139][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:47:04,289][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:47:35,647][root][INFO] - Processing question number 90
[2025-02-21 13:47:35,654][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:48:06,898][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:48:38,499][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:49:09,951][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:49:41,123][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:50:13,004][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:50:44,669][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:51:16,131][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:51:47,056][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:52:17,552][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:52:49,277][root][INFO] - Inference complete
[2025-02-21 13:52:49,277][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,285][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,303][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,309][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,309][root][INFO] - Saved parsed outputs
[2025-02-21 13:52:49,310][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,311][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,311][root][INFO] - Saved parsing metadata
[2025-02-21 13:52:49,311][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,314][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:52:49,315][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:52:49,475][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 13:52:49,475][root][INFO] - Summary of metrics : {'label_accuracy': 0.3, 'misclassification_rate': 0.7, 'combined_accuracy': 0.14, 'malformed_label': 24, 'malformed_domain': 53, 'total_predictions': 100, 'correct_predictions': 30, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.06, 'Contracts_confidence': 0.04, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 33, 'correct_label_wrong_domain': 16, 'both_wrong': 37}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 13:53:23,314][root][INFO] - Setting global seed to 206
[2025-02-21 13:53:23,328][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 13:53:23,328][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 13:53:23,329][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:53:23,332][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:53:23,404][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:53:23,404][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:53:23,570][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:53:23,897][root][INFO] - Full model selected, loading model
[2025-02-21 13:53:40,537][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 13:53:40,537][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 13:53:46,825][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:53:46,826][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 13:53:46,827][root][INFO] - Starting inference
[2025-02-21 13:53:47,077][root][INFO] - Processing question number 0
[2025-02-21 13:53:47,078][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:54:18,555][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:54:50,294][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:55:22,186][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:55:53,597][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:56:24,352][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:56:54,542][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:57:25,241][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:57:56,240][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:58:26,500][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:58:57,400][root][INFO] - Processing question number 10
[2025-02-21 13:58:57,402][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:59:27,461][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:59:58,106][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:00:28,898][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:00:59,143][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:01:30,310][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:02:01,134][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:02:31,849][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:03:02,456][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:03:33,585][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:04:04,806][root][INFO] - Processing question number 20
[2025-02-21 14:04:04,808][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:04:34,898][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:05:05,929][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:05:36,666][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:06:07,288][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:06:38,001][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:07:09,211][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:07:39,955][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:08:10,915][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:08:41,656][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:09:13,072][root][INFO] - Processing question number 30
[2025-02-21 14:09:13,076][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:09:43,921][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:10:14,557][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:10:45,157][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:11:16,552][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:11:47,269][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:12:18,111][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:12:48,852][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:13:20,330][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:13:51,289][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:14:22,273][root][INFO] - Processing question number 40
[2025-02-21 14:14:22,277][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:14:53,229][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:15:23,941][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:15:55,157][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:16:25,273][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:16:56,764][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:17:27,699][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:17:58,430][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:18:29,376][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:19:00,228][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:19:31,399][root][INFO] - Processing question number 50
[2025-02-21 14:19:31,403][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:20:02,956][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:20:33,389][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:21:04,917][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:21:36,017][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:22:06,457][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:22:37,124][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:23:08,728][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:23:40,109][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:24:11,496][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:24:42,608][root][INFO] - Processing question number 60
[2025-02-21 14:24:42,619][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:25:13,521][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:25:44,485][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:26:16,143][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:26:47,360][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:27:18,470][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:27:49,100][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:28:19,570][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:28:49,829][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:29:20,395][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:29:50,893][root][INFO] - Processing question number 70
[2025-02-21 14:29:50,903][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:30:21,983][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:30:52,959][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:31:24,120][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:31:55,800][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:32:26,288][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:32:57,410][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:33:29,501][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:34:00,631][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:34:30,770][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:35:01,315][root][INFO] - Processing question number 80
[2025-02-21 14:35:01,323][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:35:32,808][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:36:04,330][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:36:35,779][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:37:06,891][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:37:38,936][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:38:09,627][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:38:40,970][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:39:12,796][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:39:43,778][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:40:14,784][root][INFO] - Processing question number 90
[2025-02-21 14:40:14,791][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:40:45,798][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:41:17,198][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:41:48,339][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:42:19,265][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:42:50,867][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:43:22,352][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:43:53,493][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:44:24,197][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:44:54,462][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:45:25,977][root][INFO] - Inference complete
[2025-02-21 14:45:25,978][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:25,985][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:25,988][root][WARNING] - No match found for 6. Chosen Option Label in question number 86 in domain Constitutional_law
[2025-02-21 14:45:25,994][root][WARNING] - No match found for 6. Chosen Option Label in question number 10 in domain Evidence
[2025-02-21 14:45:26,006][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,022][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,022][root][INFO] - Saved parsed outputs
[2025-02-21 14:45:26,022][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,024][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,024][root][INFO] - Saved parsing metadata
[2025-02-21 14:45:26,024][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,025][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:45:26,033][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:45:26,131][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 14:45:26,131][root][INFO] - Summary of metrics : {'label_accuracy': 0.33, 'misclassification_rate': 0.6699999999999999, 'combined_accuracy': 0.21, 'malformed_label': 4, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 33, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.15, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 12, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 14:45:32,374][root][INFO] - Setting global seed to 989
[2025-02-21 14:45:32,380][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 14:45:32,380][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 14:45:32,382][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:45:32,383][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:45:32,385][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:45:32,385][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:45:32,534][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:45:32,767][root][INFO] - Full model selected, loading model
[2025-02-21 14:45:44,672][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 14:46:43,947][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 14:46:43,948][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 14:47:09,366][root][INFO] - Peft model loaded successfully
[2025-02-21 14:47:15,506][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:47:15,507][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 14:47:15,507][root][INFO] - Starting inference
[2025-02-21 14:47:15,726][root][INFO] - Processing question number 0
[2025-02-21 14:47:15,728][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:47:46,889][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:48:18,509][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:48:50,244][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:49:21,503][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:49:52,105][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:50:22,168][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:50:52,735][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:51:23,593][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:51:53,739][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:52:24,518][root][INFO] - Processing question number 10
[2025-02-21 14:52:24,521][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:52:54,498][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:53:25,038][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:53:55,748][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:54:25,903][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:54:57,098][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:55:27,856][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:55:58,563][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:56:29,097][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:57:00,141][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:57:31,380][root][INFO] - Processing question number 20
[2025-02-21 14:57:31,388][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:58:01,412][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:58:32,295][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:59:02,682][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:59:33,231][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:00:03,907][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:00:35,142][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:01:05,873][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:01:36,765][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:02:07,494][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:02:38,841][root][INFO] - Processing question number 30
[2025-02-21 15:02:38,848][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:03:09,626][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:03:40,202][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:04:10,747][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:04:42,063][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:05:12,764][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:05:43,532][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:06:14,265][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:06:45,668][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:07:16,563][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:07:47,490][root][INFO] - Processing question number 40
[2025-02-21 15:07:47,494][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:08:18,385][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:08:49,085][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:09:20,314][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:09:50,364][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:10:21,795][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:10:52,667][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:11:23,379][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:11:54,317][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:12:25,099][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:12:56,293][root][INFO] - Processing question number 50
[2025-02-21 15:12:56,297][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:13:27,714][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:13:58,024][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:14:29,589][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:15:00,673][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:15:31,079][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:16:01,950][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:16:33,594][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:17:05,045][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:17:36,536][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:18:07,680][root][INFO] - Processing question number 60
[2025-02-21 15:18:07,685][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:18:38,616][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:19:09,608][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:19:41,329][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:20:12,602][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:20:43,700][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:21:14,317][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:21:44,770][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:22:15,107][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:22:45,703][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:23:16,223][root][INFO] - Processing question number 70
[2025-02-21 15:23:16,228][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:23:47,321][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:24:18,321][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:24:49,601][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:25:21,323][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:25:51,830][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:26:22,972][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:26:55,181][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:27:26,436][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:27:56,618][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:28:27,186][root][INFO] - Processing question number 80
[2025-02-21 15:28:27,193][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:28:58,719][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:29:30,270][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:30:01,758][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:30:32,884][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:31:05,038][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:31:35,807][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:32:07,179][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:32:39,038][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:33:10,058][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:33:41,094][root][INFO] - Processing question number 90
[2025-02-21 15:33:41,100][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:34:12,137][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:34:43,565][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:35:14,825][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:35:45,783][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:36:17,423][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:36:48,940][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:37:20,200][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:37:51,004][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:38:21,477][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:38:53,043][root][INFO] - Inference complete
[2025-02-21 15:38:53,044][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,050][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,063][root][WARNING] - No match found for 6. Chosen Option Label in question number 36 in domain Property
[2025-02-21 15:38:53,065][root][WARNING] - No match found for 6. Chosen Option Label in question number 94 in domain Property
[2025-02-21 15:38:53,068][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,075][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,075][root][INFO] - Saved parsed outputs
[2025-02-21 15:38:53,075][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,078][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,078][root][INFO] - Saved parsing metadata
[2025-02-21 15:38:53,078][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,080][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:38:53,082][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:38:53,105][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 15:38:53,105][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.16, 'malformed_label': 5, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.09, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 12, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 15:39:00,042][root][INFO] - Setting global seed to 989
[2025-02-21 15:39:00,049][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:39:00,049][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 15:39:00,051][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:39:00,053][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:39:00,055][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:39:00,055][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:39:00,204][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:39:00,450][root][INFO] - Full model selected, loading model
[2025-02-21 15:39:18,942][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:39:18,942][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:39:25,278][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:39:25,279][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 15:39:25,279][root][INFO] - Starting inference
[2025-02-21 15:39:25,489][root][INFO] - Processing question number 0
[2025-02-21 15:39:25,491][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:39:56,475][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:40:28,036][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:40:59,758][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:41:31,003][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:42:01,568][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:42:31,608][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:43:02,148][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:43:32,994][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:44:03,110][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:44:33,862][root][INFO] - Processing question number 10
[2025-02-21 15:44:33,864][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:45:03,820][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:45:34,343][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:46:04,974][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:46:35,110][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:47:06,189][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:47:36,880][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:48:07,513][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:48:38,030][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:49:09,076][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:49:40,214][root][INFO] - Processing question number 20
[2025-02-21 15:49:40,218][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:50:10,212][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:50:41,066][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:51:11,450][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:51:41,978][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:52:12,576][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:52:43,702][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:53:14,359][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:53:45,232][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:54:15,893][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:54:47,228][root][INFO] - Processing question number 30
[2025-02-21 15:54:47,231][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:55:17,992][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:55:48,546][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:56:19,063][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:56:50,371][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:57:20,998][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:57:51,749][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:58:22,408][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:58:53,797][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:59:24,678][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:59:55,579][root][INFO] - Processing question number 40
[2025-02-21 15:59:55,582][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:00:26,451][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:00:57,075][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:01:28,206][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:01:58,254][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:02:29,789][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:03:00,689][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:03:31,455][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:04:02,344][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:04:33,106][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:05:04,180][root][INFO] - Processing question number 50
[2025-02-21 16:05:04,184][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:05:35,581][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:06:05,881][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:06:37,285][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:07:08,266][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:07:38,619][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:08:09,223][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:08:40,743][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:09:12,039][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:09:43,339][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:10:14,356][root][INFO] - Processing question number 60
[2025-02-21 16:10:14,360][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:10:45,175][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:11:16,043][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:11:47,612][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:12:18,665][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:12:49,638][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:13:20,117][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:13:50,437][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:14:20,587][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:14:51,078][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:15:21,475][root][INFO] - Processing question number 70
[2025-02-21 16:15:21,481][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:15:52,457][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:16:23,335][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:16:54,396][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:17:25,975][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:17:56,357][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:18:27,376][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:18:59,381][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:19:30,411][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:20:00,443][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:20:30,875][root][INFO] - Processing question number 80
[2025-02-21 16:20:30,881][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:21:02,404][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:21:33,904][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:22:05,382][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:22:36,450][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:23:08,404][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:23:38,992][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:24:10,230][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:24:41,961][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:25:12,843][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:25:43,744][root][INFO] - Processing question number 90
[2025-02-21 16:25:43,750][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:26:14,657][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:26:45,950][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:27:16,988][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:27:47,814][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:28:19,321][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:28:50,717][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:29:21,762][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:29:52,365][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:30:22,539][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:30:53,958][root][INFO] - Inference complete
[2025-02-21 16:30:53,959][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,965][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,978][root][WARNING] - No match found for 4. Rule Application in question number 61 in domain Civil_procedure
[2025-02-21 16:30:53,978][root][WARNING] - No match found for 5. Legal Conclusion in question number 61 in domain Civil_procedure
[2025-02-21 16:30:53,978][root][WARNING] - No match found for 6. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 16:30:53,982][root][WARNING] - No match found for 6. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 16:30:53,986][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,992][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,992][root][INFO] - Saved parsed outputs
[2025-02-21 16:30:53,992][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,995][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,995][root][INFO] - Saved parsing metadata
[2025-02-21 16:30:53,995][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,997][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:30:53,998][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:30:54,042][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 16:30:54,042][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.21, 'malformed_label': 2, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 11, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 16:31:01,958][root][INFO] - Setting global seed to 989
[2025-02-21 16:31:01,965][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 16:31:01,965][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 16:31:01,967][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:31:01,969][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:31:01,971][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:31:01,971][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:31:02,286][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:31:02,540][root][INFO] - Full model selected, loading model
[2025-02-21 16:31:18,909][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 16:32:19,358][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 16:32:19,359][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 16:32:44,512][root][INFO] - Peft model loaded successfully
[2025-02-21 16:32:50,541][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:32:50,542][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 16:32:50,542][root][INFO] - Starting inference
[2025-02-21 16:32:50,753][root][INFO] - Processing question number 0
[2025-02-21 16:32:50,756][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:33:22,246][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:33:54,048][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:34:26,002][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:34:57,477][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:35:28,287][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:35:58,565][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:36:29,350][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:37:00,434][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:37:30,821][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:38:01,815][root][INFO] - Processing question number 10
[2025-02-21 16:38:01,817][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:38:32,002][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:39:02,768][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:39:33,686][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:40:04,061][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:40:35,464][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:41:06,446][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:41:37,359][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:42:08,117][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:42:39,387][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:43:10,952][root][INFO] - Processing question number 20
[2025-02-21 16:43:10,955][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:43:41,336][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:44:12,433][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:44:43,053][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:45:13,869][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:45:44,759][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:46:16,213][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:46:47,156][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:47:18,270][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:47:49,208][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:48:20,781][root][INFO] - Processing question number 30
[2025-02-21 16:48:20,784][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:48:51,782][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:49:22,581][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:49:53,335][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:50:24,875][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:50:55,796][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:51:26,785][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:51:57,730][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:52:29,353][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:53:00,465][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:53:31,597][root][INFO] - Processing question number 40
[2025-02-21 16:53:31,601][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:54:02,690][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:54:33,646][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:55:05,136][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:55:35,417][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:56:07,052][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:56:38,125][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:57:09,042][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:57:40,128][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:58:11,116][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:58:42,500][root][INFO] - Processing question number 50
[2025-02-21 16:58:42,504][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:59:14,124][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:59:44,640][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:00:16,262][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:00:47,455][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:01:18,027][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:01:48,829][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:02:20,569][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:02:52,079][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:03:23,594][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:03:54,826][root][INFO] - Processing question number 60
[2025-02-21 17:03:54,830][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:04:25,859][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:04:56,947][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:05:28,757][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:06:00,131][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:06:31,323][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:07:02,037][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:07:32,585][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:08:03,012][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:08:33,703][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:09:04,329][root][INFO] - Processing question number 70
[2025-02-21 17:09:04,333][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:09:35,531][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:10:06,636][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:10:38,021][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:11:09,848][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:11:40,463][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:12:11,705][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:12:44,002][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:13:15,354][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:13:45,624][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:14:16,309][root][INFO] - Processing question number 80
[2025-02-21 17:14:16,314][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:14:47,929][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:15:19,589][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:15:51,166][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:16:22,394][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:16:54,648][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:17:25,525][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:17:56,993][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:18:28,955][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:19:00,072][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:19:31,200][root][INFO] - Processing question number 90
[2025-02-21 17:19:31,205][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:20:02,347][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:20:33,874][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:21:05,230][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:21:36,288][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:22:08,026][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:22:39,654][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:23:11,018][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:23:41,912][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:24:12,366][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:24:44,019][root][INFO] - Inference complete
[2025-02-21 17:24:44,019][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,026][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,040][root][WARNING] - No match found for 6. Chosen Option Label in question number 94 in domain Property
[2025-02-21 17:24:44,043][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,050][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,050][root][INFO] - Saved parsed outputs
[2025-02-21 17:24:44,050][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,051][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,051][root][INFO] - Saved parsing metadata
[2025-02-21 17:24:44,052][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,053][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:24:44,055][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:24:44,084][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 17:24:44,084][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.22, 'malformed_label': 6, 'malformed_domain': 36, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.08, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.04, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 13, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 17:24:52,379][root][INFO] - Setting global seed to 989
[2025-02-21 17:24:52,386][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 17:24:52,386][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 17:24:52,388][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:24:52,390][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:24:52,392][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:24:52,392][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:24:52,544][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:24:52,795][root][INFO] - Full model selected, loading model
[2025-02-21 17:25:10,888][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 17:25:10,888][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 17:25:17,225][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:25:17,227][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 17:25:17,227][root][INFO] - Starting inference
[2025-02-21 17:25:17,438][root][INFO] - Processing question number 0
[2025-02-21 17:25:17,440][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:25:49,082][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:26:20,967][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:26:52,974][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:27:24,479][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:27:55,250][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:28:25,483][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:28:56,227][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:29:27,277][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:29:57,601][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:30:28,560][root][INFO] - Processing question number 10
[2025-02-21 17:30:28,562][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:30:58,720][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:31:29,447][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:32:00,289][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:32:30,621][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:33:01,906][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:33:32,798][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:34:03,632][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:34:34,354][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:35:05,599][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:35:36,935][root][INFO] - Processing question number 20
[2025-02-21 17:35:36,938][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:36:07,141][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:36:38,199][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:37:08,785][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:37:39,521][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:38:10,320][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:38:41,651][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:39:12,509][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:39:43,587][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:40:14,449][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:40:45,984][root][INFO] - Processing question number 30
[2025-02-21 17:40:45,987][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:41:16,949][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:41:47,708][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:42:18,428][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:42:49,929][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:43:20,759][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:43:51,707][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:44:22,559][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:44:54,141][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:45:25,318][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:45:56,499][root][INFO] - Processing question number 40
[2025-02-21 17:45:56,503][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:46:27,622][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:46:58,561][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:47:29,880][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:48:00,103][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:48:31,712][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:49:02,869][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:49:33,740][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:50:04,793][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:50:35,747][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:51:07,008][root][INFO] - Processing question number 50
[2025-02-21 17:51:07,012][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:51:38,590][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:52:09,080][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:52:40,672][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:53:11,837][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:53:42,384][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:54:13,154][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:54:44,861][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:55:16,340][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:55:47,830][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:56:19,043][root][INFO] - Processing question number 60
[2025-02-21 17:56:19,047][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:56:50,057][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:57:21,116][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:57:52,882][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:58:24,137][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:58:55,310][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:59:25,996][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:59:56,522][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:00:26,881][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:00:57,549][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:01:28,148][root][INFO] - Processing question number 70
[2025-02-21 18:01:28,153][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:01:59,335][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:02:30,410][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:03:01,679][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:03:33,464][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:04:04,051][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:04:35,276][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:05:07,478][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:05:38,717][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:06:08,965][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:06:39,616][root][INFO] - Processing question number 80
[2025-02-21 18:06:39,621][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:07:11,209][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:07:42,837][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:08:14,388][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:08:45,599][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:09:17,745][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:09:48,537][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:10:19,976][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:10:51,902][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:11:22,988][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:11:54,091][root][INFO] - Processing question number 90
[2025-02-21 18:11:54,097][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:12:25,205][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:12:56,705][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:13:27,945][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:13:58,974][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:14:30,679][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:15:02,271][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:15:33,526][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:16:04,477][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:16:34,923][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:17:06,582][root][INFO] - Inference complete
[2025-02-21 18:17:06,582][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,588][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,590][root][WARNING] - No match found for 6. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 18:17:06,600][root][WARNING] - No match found for 6. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 18:17:06,602][root][WARNING] - No match found for 6. Chosen Option Label in question number 25 in domain Property
[2025-02-21 18:17:06,606][root][WARNING] - No match found for 6. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 18:17:06,608][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,614][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,614][root][INFO] - Saved parsed outputs
[2025-02-21 18:17:06,614][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,615][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,615][root][INFO] - Saved parsing metadata
[2025-02-21 18:17:06,616][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,617][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:17:06,618][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:17:06,658][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 18:17:06,658][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.18, 'malformed_label': 4, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 56, 'correct_label_wrong_domain': 11, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 18:17:25,346][root][INFO] - Setting global seed to 989
[2025-02-21 18:17:25,373][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 18:17:25,373][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 18:17:25,375][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:17:25,376][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:17:25,379][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:17:25,379][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:17:25,526][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:17:25,793][root][INFO] - Full model selected, loading model
[2025-02-21 18:17:45,633][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 18:18:45,417][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 18:18:45,417][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 18:19:10,681][root][INFO] - Peft model loaded successfully
[2025-02-21 18:19:16,659][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:19:16,660][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 18:19:16,660][root][INFO] - Starting inference
[2025-02-21 18:19:16,913][root][INFO] - Processing question number 0
[2025-02-21 18:19:16,915][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:19:48,291][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:20:20,109][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:20:52,066][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:21:23,555][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:21:54,373][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:22:24,657][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:22:55,446][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:23:26,543][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:23:56,901][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:24:27,903][root][INFO] - Processing question number 10
[2025-02-21 18:24:27,905][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:24:58,104][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:25:28,870][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:25:59,803][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:26:30,185][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:27:01,592][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:27:32,579][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:28:03,507][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:28:34,275][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:29:05,554][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:29:37,027][root][INFO] - Processing question number 20
[2025-02-21 18:29:37,030][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:30:07,272][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:30:38,377][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:31:09,001][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:31:39,813][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:32:10,697][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:32:42,152][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:33:13,108][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:33:44,239][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:34:15,198][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:34:46,782][root][INFO] - Processing question number 30
[2025-02-21 18:34:46,786][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:35:17,791][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:35:48,602][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:36:19,369][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:36:50,918][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:37:21,848][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:37:53,022][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:38:24,018][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:38:55,757][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:39:26,900][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:39:58,042][root][INFO] - Processing question number 40
[2025-02-21 18:39:58,046][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:40:29,152][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:41:00,070][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:41:31,519][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:41:43,800][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:42:15,445][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:42:46,523][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:43:17,448][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:43:48,538][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:44:19,529][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:44:50,927][root][INFO] - Processing question number 50
[2025-02-21 18:44:50,932][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:45:22,550][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:45:53,075][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:46:24,709][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:46:55,917][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:47:26,493][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:47:57,310][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:48:29,059][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:49:00,581][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:49:32,101][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:50:03,343][root][INFO] - Processing question number 60
[2025-02-21 18:50:03,347][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:50:34,383][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:51:05,486][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:51:37,303][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:52:08,690][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:52:39,885][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:53:10,604][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:53:41,156][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:54:11,588][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:54:42,288][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:55:12,926][root][INFO] - Processing question number 70
[2025-02-21 18:55:12,931][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:55:44,138][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:56:15,253][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:56:46,648][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:57:18,492][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:57:49,109][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:58:20,369][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:58:52,680][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:59:24,046][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:59:54,320][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:00:25,003][root][INFO] - Processing question number 80
[2025-02-21 19:00:25,008][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:00:56,635][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:01:28,303][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:01:59,889][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:02:31,134][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:03:03,395][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:03:34,276][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:04:05,751][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:04:37,717][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:05:08,837][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:05:39,982][root][INFO] - Processing question number 90
[2025-02-21 19:05:39,987][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:06:11,140][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:06:42,679][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:07:14,050][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:07:45,120][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:08:16,868][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:08:48,506][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:09:19,884][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:09:50,793][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:10:21,256][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:10:52,931][root][INFO] - Inference complete
[2025-02-21 19:10:52,931][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,938][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,956][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,962][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,962][root][INFO] - Saved parsed outputs
[2025-02-21 19:10:52,962][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,964][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,964][root][INFO] - Saved parsing metadata
[2025-02-21 19:10:52,965][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,967][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:10:52,968][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:10:52,997][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 19:10:52,997][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.13, 'malformed_label': 18, 'malformed_domain': 50, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.07, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 40}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 9 to status running with exit code None
Eval status update completed for job 9
[2025-02-21 19:11:07,828][root][INFO] - Setting global seed to 989
[2025-02-21 19:11:07,845][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 19:11:07,846][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : number_list 
[2025-02-21 19:11:07,847][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 19:11:07,849][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 19:11:07,851][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 19:11:07,851][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 19:11:08,060][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 19:11:08,373][root][INFO] - Full model selected, loading model
[2025-02-21 19:11:26,865][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 19:11:26,865][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 19:11:33,228][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 19:11:33,230][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 19:11:33,230][root][INFO] - Starting inference
[2025-02-21 19:11:33,446][root][INFO] - Processing question number 0
[2025-02-21 19:11:33,448][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 19:12:04,694][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 19:12:36,454][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 19:13:08,357][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 19:13:39,795][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 19:14:10,566][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 19:14:40,801][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 19:15:11,542][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 19:15:42,580][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 19:16:12,898][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 19:16:43,852][root][INFO] - Processing question number 10
[2025-02-21 19:16:43,854][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 19:17:14,006][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 19:17:44,731][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 19:18:15,570][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 19:18:45,902][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 19:19:17,178][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 19:19:48,069][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 19:20:18,902][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 19:20:49,622][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 19:21:20,864][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 19:21:52,316][root][INFO] - Processing question number 20
[2025-02-21 19:21:52,319][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 19:22:22,576][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 19:22:53,779][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 19:23:24,446][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 19:23:55,252][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 19:24:26,052][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 19:24:42,662][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 19:25:13,522][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 19:25:44,642][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 19:26:15,496][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 19:26:47,020][root][INFO] - Processing question number 30
[2025-02-21 19:26:47,023][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 19:27:17,972][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 19:27:48,723][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 19:28:19,451][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 19:28:50,953][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 19:29:21,766][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 19:29:52,703][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 19:30:23,569][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 19:30:55,151][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 19:31:26,285][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 19:31:57,466][root][INFO] - Processing question number 40
[2025-02-21 19:31:57,469][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 19:32:28,574][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 19:32:59,382][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 19:33:30,734][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 19:34:00,952][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 19:34:32,539][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 19:35:03,565][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 19:35:34,388][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 19:36:05,432][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 19:36:36,376][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:37:07,682][root][INFO] - Processing question number 50
[2025-02-21 19:37:07,686][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:37:39,253][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:38:09,732][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:38:41,327][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:39:12,484][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:39:43,017][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:40:13,782][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:40:45,558][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:41:17,032][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:41:48,511][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:42:19,717][root][INFO] - Processing question number 60
[2025-02-21 19:42:19,721][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:42:50,711][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:43:21,840][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:43:53,738][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:44:24,989][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:44:56,160][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:45:26,847][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:45:57,362][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:46:27,769][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:46:58,433][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:47:29,035][root][INFO] - Processing question number 70
[2025-02-21 19:47:29,040][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:48:00,223][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:48:31,384][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:49:02,656][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:49:34,441][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:50:05,025][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:50:36,252][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:51:08,540][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:51:39,785][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:52:10,037][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:52:40,692][root][INFO] - Processing question number 80
[2025-02-21 19:52:40,697][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:53:12,322][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:53:43,968][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:54:15,530][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:54:46,749][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:55:18,942][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:55:49,744][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:56:21,191][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:56:53,199][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:57:24,287][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:57:55,398][root][INFO] - Processing question number 90
[2025-02-21 19:57:55,404][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:58:26,528][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:58:58,124][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:59:29,372][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 20:00:00,411][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 20:00:32,165][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 20:01:03,764][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 20:01:35,018][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 20:01:52,282][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 20:02:22,704][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 20:02:54,331][root][INFO] - Inference complete
[2025-02-21 20:02:54,331][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,337][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,342][root][WARNING] - No match found for 6. Chosen Option Label in question number 29 in domain Criminal_law
[2025-02-21 20:02:54,346][root][WARNING] - No match found for 6. Chosen Option Label in question number 10 in domain Evidence
[2025-02-21 20:02:54,358][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,364][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,364][root][INFO] - Saved parsed outputs
[2025-02-21 20:02:54,364][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,365][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,366][root][INFO] - Saved parsing metadata
[2025-02-21 20:02:54,366][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,367][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
[2025-02-21 20:02:54,368][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 20:02:54,407][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_structured, on test_set_2
[2025-02-21 20:02:54,408][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.18, 'malformed_label': 4, 'malformed_domain': 30, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.07, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 52, 'correct_label_wrong_domain': 6, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '9', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 9 to status completed with exit code 0
Eval status update completed for job 9
Job 9 completed at Fri Feb 21 20:02:55 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n515
Job ID: 25309344
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 21:03:18
CPU Efficiency: 9.94% of 8-19:45:30 core-walltime
Job Wall-clock time: 21:10:33
Memory Utilized: 28.10 GB
Memory Efficiency: 78.06% of 36.00 GB
