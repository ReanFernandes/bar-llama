Starting job 28 at Thu Feb 20 23:39:33 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=markdown_fact_first_few_shot_unstructured train=markdown_fact_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '28', 'training']
Updating job 28 to status training with exit code None
Status update completed for job 28
[2025-02-20 23:39:47,386][root][INFO] - Global seed set to 314
[2025-02-20 23:39:47,387][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 23:39:47,388][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 23:39:47,388][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 23:39:47,388][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:39:47,388][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 23:39:47,404][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:39:47,437][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 23:39:47,440][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 23:39:47,467][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 23:39:48,202][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:40:13,535][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:40:41,778][root][INFO] - Model prepared for kbit training
[2025-02-20 23:40:41,779][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'o_proj', 'gate_proj', 'down_proj', 'k_proj', 'q_proj', 'up_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 23:40:43,517][root][INFO] - Lora adapter added to model
[2025-02-20 23:40:43,519][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_few_shot_unstructured
[2025-02-20 23:40:43,746][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.899, 'grad_norm': 0.40070220828056335, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.5806, 'grad_norm': 0.4324146509170532, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.366, 'grad_norm': 0.3837515413761139, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.195, 'grad_norm': 0.48338639736175537, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.919, 'grad_norm': 0.42701810598373413, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 417.0221, 'train_samples_per_second': 0.252, 'train_steps_per_second': 0.036, 'train_loss': 1.3918990770975748, 'epoch': 15.0}
[2025-02-20 23:47:48,628][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_fact_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '28', 'trained', '0']
Updating job 28 to status trained with exit code 0
Status update completed for job 28
Starting evaluations for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-20 23:47:57,415][root][INFO] - Setting global seed to 206
[2025-02-20 23:47:57,420][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:47:57,421][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:47:57,422][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:47:57,425][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:47:57,427][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:47:57,427][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:47:57,570][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:47:58,180][root][INFO] - Full model selected, loading model
[2025-02-20 23:48:20,118][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:50:03,990][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:50:03,991][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:50:35,576][root][INFO] - Peft model loaded successfully
[2025-02-20 23:50:42,775][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:50:42,777][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:50:42,777][root][INFO] - Starting inference
[2025-02-20 23:50:42,992][root][INFO] - Processing question number 0
[2025-02-20 23:50:43,026][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:50:50,532][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:50:59,814][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:51:23,883][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:51:39,669][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:51:50,541][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:52:21,374][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:52:36,676][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:52:45,708][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:52:51,244][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:53:22,364][root][INFO] - Processing question number 10
[2025-02-20 23:53:22,366][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:53:31,172][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:53:46,515][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:53:52,412][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:54:00,338][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:54:08,245][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:54:20,082][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:54:30,401][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:54:36,162][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:55:07,094][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:55:25,102][root][INFO] - Processing question number 20
[2025-02-20 23:55:25,104][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:55:42,776][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:56:05,318][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:56:16,340][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:56:46,948][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:56:58,376][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:57:06,561][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:57:17,480][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:57:29,130][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:58:00,105][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:58:10,174][root][INFO] - Processing question number 30
[2025-02-20 23:58:10,177][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:58:27,678][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:58:34,011][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:58:45,132][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:58:56,962][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:59:04,018][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:59:15,121][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:59:25,526][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:59:56,782][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:00:27,820][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:00:41,114][root][INFO] - Processing question number 40
[2025-02-21 00:00:41,117][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:01:12,203][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:01:23,567][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:01:38,915][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:02:10,269][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:02:19,072][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:02:30,214][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:02:41,299][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:02:48,531][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:02:56,043][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:03:01,692][root][INFO] - Processing question number 50
[2025-02-21 00:03:01,696][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:03:09,752][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:03:25,000][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:03:35,218][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:04:06,994][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:04:21,178][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:04:30,772][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:04:39,322][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:04:53,764][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:05:07,581][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:05:39,331][root][INFO] - Processing question number 60
[2025-02-21 00:05:39,336][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:05:47,150][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:05:55,964][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:06:05,713][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:06:12,691][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:06:24,924][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:06:35,503][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:06:47,804][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:07:18,922][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:07:25,148][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:07:35,479][root][INFO] - Processing question number 70
[2025-02-21 00:07:35,483][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:08:06,355][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:08:12,431][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:08:18,359][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:08:27,947][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:08:37,384][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:08:46,045][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:08:58,841][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:09:10,124][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:09:41,437][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:09:56,268][root][INFO] - Processing question number 80
[2025-02-21 00:09:56,273][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:10:04,331][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:10:15,559][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:10:23,494][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:10:31,564][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:11:02,917][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:11:11,484][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:11:20,294][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:11:28,223][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:11:40,231][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:12:10,825][root][INFO] - Processing question number 90
[2025-02-21 00:12:10,830][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:12:42,408][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:12:51,783][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:13:22,727][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:13:31,656][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:13:40,619][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:13:50,583][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:14:00,598][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:14:13,094][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:14:22,094][root][INFO] - Inference complete
[2025-02-21 00:14:22,095][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,101][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,102][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:14:22,103][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:14:22,103][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:14:22,103][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 00:14:22,104][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:14:22,104][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,104][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,105][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:14:22,105][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,105][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:14:22,105][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,106][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:14:22,106][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:14:22,107][root][ERROR] - |Q. 94||D: Contracts| Failed to extract chosen option: 
[2025-02-21 00:14:22,108][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:14:22,108][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 00:14:22,109][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:14:22,109][root][ERROR] - |Q. 18||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:14:22,110][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:14:22,110][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:14:22,110][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:14:22,111][root][ERROR] - |Q. 86||D: Evidence| Failed to extract chosen option: 
[2025-02-21 00:14:22,111][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:14:22,111][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 00:14:22,112][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:14:22,112][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:14:22,113][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 00:14:22,114][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,150][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,151][root][INFO] - Saved parsed outputs
[2025-02-21 00:14:22,151][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,172][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,172][root][INFO] - Saved parsing metadata
[2025-02-21 00:14:22,172][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,174][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:22,200][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:14:22,208][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:14:22,208][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 19, 'malformed_domain': 22, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.15151515151515152, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 7, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 00:14:28,656][root][INFO] - Setting global seed to 206
[2025-02-21 00:14:28,661][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:14:28,661][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:14:28,662][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:14:28,663][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:14:28,665][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:14:28,665][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:14:28,839][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:14:29,357][root][INFO] - Full model selected, loading model
[2025-02-21 00:14:42,432][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:14:42,432][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:14:49,762][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:14:49,764][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:14:49,764][root][INFO] - Starting inference
[2025-02-21 00:14:49,954][root][INFO] - Processing question number 0
[2025-02-21 00:14:49,957][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:15:02,033][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:15:16,381][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:15:30,295][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:15:37,792][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:15:50,850][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:16:03,366][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:16:16,947][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:16:29,357][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:16:40,907][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:16:53,243][root][INFO] - Processing question number 10
[2025-02-21 00:16:53,244][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:17:09,027][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:17:19,250][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:17:27,499][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:17:47,352][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:17:54,963][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:18:01,635][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:18:13,527][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:18:23,308][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:18:29,601][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:18:41,423][root][INFO] - Processing question number 20
[2025-02-21 00:18:41,425][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:18:49,409][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:19:07,778][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:19:16,697][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:19:33,224][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:19:43,814][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:19:54,617][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:20:04,725][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:20:20,728][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:20:34,700][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:20:44,584][root][INFO] - Processing question number 30
[2025-02-21 00:20:44,587][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:21:04,649][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:21:18,670][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:21:28,857][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:21:39,208][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:21:50,343][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:21:59,805][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:22:08,486][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:22:22,583][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:22:31,557][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:22:40,176][root][INFO] - Processing question number 40
[2025-02-21 00:22:40,179][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:22:49,964][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:22:59,994][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:23:14,436][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:23:25,401][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:23:35,239][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:23:48,179][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:23:57,243][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:24:07,590][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:24:17,906][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:24:28,635][root][INFO] - Processing question number 50
[2025-02-21 00:24:28,640][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:24:45,353][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:25:01,928][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:25:13,373][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:25:32,991][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:25:50,563][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:26:01,677][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:26:12,174][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:26:25,339][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:26:36,048][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:26:45,048][root][INFO] - Processing question number 60
[2025-02-21 00:26:45,051][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:26:56,091][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:27:05,397][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:27:25,302][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:27:33,643][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:27:42,700][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:27:54,975][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:28:08,366][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:28:16,177][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:28:26,989][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:28:39,521][root][INFO] - Processing question number 70
[2025-02-21 00:28:39,525][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:28:50,413][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:29:06,472][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:29:13,673][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:29:23,807][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:29:32,243][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:29:41,812][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:30:00,123][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:30:10,118][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:30:26,525][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:30:36,389][root][INFO] - Processing question number 80
[2025-02-21 00:30:36,393][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:30:45,694][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:30:55,330][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:31:10,333][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:31:18,361][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:31:32,806][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:31:43,915][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:31:53,722][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:32:00,387][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:32:11,004][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:32:23,002][root][INFO] - Processing question number 90
[2025-02-21 00:32:23,007][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:32:35,030][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:32:45,095][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:32:59,702][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:33:14,708][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:33:30,702][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:33:38,758][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:33:46,709][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:33:58,626][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:34:17,369][root][INFO] - Inference complete
[2025-02-21 00:34:17,369][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,375][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,375][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:34:17,376][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:34:17,376][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:34:17,376][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:34:17,377][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:34:17,378][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:34:17,379][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:34:17,380][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:34:17,381][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:34:17,382][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:34:17,383][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:34:17,384][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:34:17,385][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:34:17,386][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:34:17,387][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:34:17,388][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:34:17,389][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:34:17,390][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,396][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,396][root][INFO] - Saved parsed outputs
[2025-02-21 00:34:17,396][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,398][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,398][root][INFO] - Saved parsing metadata
[2025-02-21 00:34:17,398][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,399][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:34:17,401][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:34:17,432][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:34:17,432][root][INFO] - Summary of metrics : {'label_accuracy': 0.5454545454545454, 'misclassification_rate': 0.4545454545454546, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 54, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 54, 'both_wrong': 45}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 00:34:25,807][root][INFO] - Setting global seed to 206
[2025-02-21 00:34:25,814][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:34:25,815][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:34:25,816][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:34:25,818][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:34:25,821][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:34:25,821][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:34:25,976][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:34:26,509][root][INFO] - Full model selected, loading model
[2025-02-21 00:34:48,791][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:36:30,238][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:36:30,239][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:37:02,420][root][INFO] - Peft model loaded successfully
[2025-02-21 00:37:09,566][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:37:09,567][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:37:09,567][root][INFO] - Starting inference
[2025-02-21 00:37:09,790][root][INFO] - Processing question number 0
[2025-02-21 00:37:09,792][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:37:18,207][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:37:26,125][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:37:54,890][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:38:24,488][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:38:32,053][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:39:03,346][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:39:14,714][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:39:44,995][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:39:50,533][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:39:59,211][root][INFO] - Processing question number 10
[2025-02-21 00:39:59,213][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:40:09,843][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:40:23,434][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:40:31,904][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:40:39,303][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:40:52,671][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:41:06,676][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:41:37,609][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:42:09,042][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:42:19,322][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:42:40,336][root][INFO] - Processing question number 20
[2025-02-21 00:42:40,339][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:42:45,796][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:43:10,277][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:43:41,332][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:43:52,702][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:44:24,277][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:44:31,948][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:44:51,168][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:45:00,380][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:45:31,660][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:45:39,419][root][INFO] - Processing question number 30
[2025-02-21 00:45:39,423][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:45:47,619][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:45:55,511][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:46:06,090][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:46:17,236][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:46:24,751][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:46:34,253][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:46:42,423][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:46:55,674][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:47:05,930][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:47:17,715][root][INFO] - Processing question number 40
[2025-02-21 00:47:17,718][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:47:29,404][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:47:42,139][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:47:55,893][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:48:04,044][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:48:14,574][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:48:26,974][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:48:40,169][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:48:45,624][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:48:52,120][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:48:59,621][root][INFO] - Processing question number 50
[2025-02-21 00:48:59,624][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:49:09,470][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:49:23,535][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:49:32,026][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:50:04,101][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:50:16,707][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:50:25,606][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:50:38,136][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:51:09,097][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:51:15,942][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:51:22,189][root][INFO] - Processing question number 60
[2025-02-21 00:51:22,193][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:51:27,921][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:51:59,088][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:52:07,172][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:52:15,987][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:52:28,336][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:52:44,313][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:52:55,921][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:53:27,344][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:53:58,712][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:54:06,034][root][INFO] - Processing question number 70
[2025-02-21 00:54:06,038][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:54:18,280][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:54:27,473][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:54:34,934][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:54:45,568][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:55:01,723][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:55:11,976][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:55:29,554][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:55:39,353][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:55:48,050][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:56:03,939][root][INFO] - Processing question number 80
[2025-02-21 00:56:03,944][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:56:35,380][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:56:56,748][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:57:04,169][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:57:12,118][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:57:21,420][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:57:42,579][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:57:52,471][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:58:03,905][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:58:16,578][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:58:27,296][root][INFO] - Processing question number 90
[2025-02-21 00:58:27,301][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:58:38,211][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:58:48,321][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:59:19,563][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:59:24,979][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:59:56,613][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:00:03,696][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:00:11,122][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:00:21,623][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:00:30,818][root][INFO] - Inference complete
[2025-02-21 01:00:30,818][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,825][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,827][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:00:30,827][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:00:30,827][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:00:30,827][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:00:30,828][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:00:30,828][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,829][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:00:30,829][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,829][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,829][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,830][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:00:30,830][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,832][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:00:30,832][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:00:30,833][root][ERROR] - |Q. 5||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:00:30,833][root][ERROR] - |Q. 5||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:00:30,833][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:00:30,833][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:00:30,834][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:00:30,834][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:00:30,834][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:00:30,834][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:00:30,836][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 01:00:30,836][root][ERROR] - |Q. 67||D: Property| Failed to extract chosen option: 
[2025-02-21 01:00:30,836][root][ERROR] - |Q. 75||D: Property| Failed to extract chosen option: 
[2025-02-21 01:00:30,837][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:00:30,837][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,837][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:00:30,837][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:00:30,838][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,844][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,844][root][INFO] - Saved parsed outputs
[2025-02-21 01:00:30,844][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,845][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,845][root][INFO] - Saved parsing metadata
[2025-02-21 01:00:30,846][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,847][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:30,849][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:00:30,867][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:00:30,867][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.2828282828282828, 'malformed_label': 17, 'malformed_domain': 27, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 28, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 11, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 01:00:37,878][root][INFO] - Setting global seed to 206
[2025-02-21 01:00:37,885][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:00:37,885][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:00:37,886][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:00:37,888][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:00:37,890][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:00:37,890][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:00:38,033][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:00:38,578][root][INFO] - Full model selected, loading model
[2025-02-21 01:00:54,122][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:00:54,122][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:01:01,462][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:01:01,463][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:01:01,463][root][INFO] - Starting inference
[2025-02-21 01:01:01,684][root][INFO] - Processing question number 0
[2025-02-21 01:01:01,686][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:01:12,591][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:01:27,215][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:01:36,407][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:01:46,571][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:01:54,770][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:02:09,455][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:02:19,405][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:02:32,025][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:02:38,880][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:02:51,423][root][INFO] - Processing question number 10
[2025-02-21 01:02:51,425][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:03:07,321][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:03:16,840][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:03:27,395][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:03:39,460][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:03:48,234][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:03:54,909][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:04:05,520][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:04:19,448][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:04:25,742][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:04:36,414][root][INFO] - Processing question number 20
[2025-02-21 01:04:36,417][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:04:45,505][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:05:02,340][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:05:12,222][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:05:26,527][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:05:36,302][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:05:44,657][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:05:54,145][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:06:04,346][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:06:19,704][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:06:26,036][root][INFO] - Processing question number 30
[2025-02-21 01:06:26,040][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:06:43,813][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:06:58,163][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:07:10,142][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:07:20,430][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:07:29,023][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:07:43,641][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:07:53,104][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:08:03,743][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:08:12,537][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:08:19,832][root][INFO] - Processing question number 40
[2025-02-21 01:08:19,835][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:08:35,001][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:08:48,331][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:09:01,314][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:09:11,061][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:09:21,031][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:09:40,400][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:09:48,928][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:09:59,505][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:10:11,767][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:10:18,612][root][INFO] - Processing question number 50
[2025-02-21 01:10:18,616][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:10:30,799][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:10:47,157][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:11:01,290][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:11:22,963][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:11:37,070][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:11:49,558][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:12:01,005][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:12:09,913][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:12:22,379][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:12:31,247][root][INFO] - Processing question number 60
[2025-02-21 01:12:31,251][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:12:45,088][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:12:51,611][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:13:00,689][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:13:11,569][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:13:22,708][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:13:35,693][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:13:48,855][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:13:57,331][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:14:11,612][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:14:22,288][root][INFO] - Processing question number 70
[2025-02-21 01:14:22,293][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:14:37,597][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:14:54,515][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:15:01,034][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:15:12,061][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:15:20,972][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:15:36,820][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:15:50,066][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:15:58,390][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:16:09,585][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:16:20,033][root][INFO] - Processing question number 80
[2025-02-21 01:16:20,037][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:16:30,823][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:16:40,140][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:16:48,785][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:16:58,904][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:17:13,329][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:17:23,626][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:17:36,058][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:17:44,015][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:17:53,675][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:18:03,452][root][INFO] - Processing question number 90
[2025-02-21 01:18:03,457][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:18:15,543][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:18:30,241][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:18:43,124][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:18:51,611][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:19:09,220][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:19:18,708][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:19:27,438][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:19:52,997][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:20:06,773][root][INFO] - Inference complete
[2025-02-21 01:20:06,774][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,779][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,780][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:20:06,780][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:20:06,780][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:20:06,780][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:20:06,780][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:20:06,781][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:20:06,782][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:20:06,783][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:20:06,784][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:20:06,785][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:20:06,786][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:20:06,787][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:20:06,788][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:20:06,789][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:20:06,790][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:20:06,791][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:20:06,792][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:20:06,793][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:20:06,793][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:20:06,793][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:20:06,793][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:20:06,793][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:20:06,794][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,799][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,799][root][INFO] - Saved parsed outputs
[2025-02-21 01:20:06,799][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,802][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,802][root][INFO] - Saved parsing metadata
[2025-02-21 01:20:06,802][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,804][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:20:06,805][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:20:06,812][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:20:06,812][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 51, 'both_wrong': 48}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 01:20:13,227][root][INFO] - Setting global seed to 206
[2025-02-21 01:20:13,232][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:20:13,232][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:20:13,233][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:20:13,235][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:20:13,237][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:20:13,237][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:20:13,375][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:20:13,897][root][INFO] - Full model selected, loading model
[2025-02-21 01:20:34,641][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:22:15,443][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:22:15,462][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:22:46,652][root][INFO] - Peft model loaded successfully
[2025-02-21 01:22:53,750][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:22:53,752][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:53,752][root][INFO] - Starting inference
[2025-02-21 01:22:53,973][root][INFO] - Processing question number 0
[2025-02-21 01:22:53,975][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:23:00,164][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:23:11,181][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:23:27,521][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:23:59,000][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:24:30,025][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:24:39,448][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:25:10,793][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:25:21,696][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:25:31,254][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:25:44,539][root][INFO] - Processing question number 10
[2025-02-21 01:25:44,541][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:26:17,152][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:26:26,569][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:26:40,375][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:26:51,120][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:27:22,678][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:27:30,142][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:27:45,479][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:27:54,940][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:28:02,415][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:28:11,302][root][INFO] - Processing question number 20
[2025-02-21 01:28:11,304][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:28:18,863][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:28:26,621][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:28:38,921][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:28:46,322][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:28:57,436][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:29:06,293][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:29:16,642][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:29:31,495][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:29:46,571][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:29:55,118][root][INFO] - Processing question number 30
[2025-02-21 01:29:55,121][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:30:10,826][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:30:17,500][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:30:27,568][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:30:37,753][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:30:54,048][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:31:04,039][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:31:13,228][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:31:22,334][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:31:33,479][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:31:44,588][root][INFO] - Processing question number 40
[2025-02-21 01:31:44,591][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:31:52,403][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:32:03,065][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:32:11,902][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:32:36,984][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:32:49,246][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:33:03,093][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:33:13,098][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:33:20,485][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:33:29,884][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:33:38,175][root][INFO] - Processing question number 50
[2025-02-21 01:33:38,179][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:33:46,399][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:33:56,021][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:34:08,242][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:34:40,288][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:34:58,253][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:35:06,854][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:35:18,194][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:35:30,116][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:35:39,200][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:35:54,209][root][INFO] - Processing question number 60
[2025-02-21 01:35:54,213][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:36:02,531][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:36:12,411][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:36:43,967][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:36:51,114][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:37:02,151][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:37:33,651][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:38:05,029][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:38:36,616][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:38:45,843][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:38:55,028][root][INFO] - Processing question number 70
[2025-02-21 01:38:55,033][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:39:03,016][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:39:14,305][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:39:21,504][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:39:30,916][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:39:41,327][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:39:47,945][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:40:19,562][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:40:31,543][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:40:39,769][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:40:49,513][root][INFO] - Processing question number 80
[2025-02-21 01:40:49,518][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:41:04,438][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:41:30,687][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:41:38,490][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:41:45,055][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:41:58,744][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:42:15,696][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:42:24,145][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:42:55,073][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:43:08,490][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:43:19,392][root][INFO] - Processing question number 90
[2025-02-21 01:43:19,397][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:43:27,972][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:43:41,360][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:43:49,973][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:43:54,700][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:44:03,683][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:44:08,752][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:44:39,802][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:45:04,187][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:45:12,915][root][INFO] - Inference complete
[2025-02-21 01:45:12,915][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,921][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,922][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:45:12,922][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:45:12,923][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:45:12,923][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:45:12,924][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 01:45:12,927][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:45:12,927][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:45:12,927][root][ERROR] - |Q. 90||D: Torts| Failed to extract chosen option: 
[2025-02-21 01:45:12,928][root][ERROR] - |Q. 5||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:45:12,928][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:45:12,928][root][ERROR] - |Q. 34||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:45:12,929][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:45:12,929][root][ERROR] - |Q. 53||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:45:12,929][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:45:12,929][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 01:45:12,930][root][ERROR] - |Q. 39||D: Property| Failed to extract chosen option: 
[2025-02-21 01:45:12,931][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:45:12,932][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 01:45:12,933][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,938][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,938][root][INFO] - Saved parsed outputs
[2025-02-21 01:45:12,938][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,940][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,940][root][INFO] - Saved parsing metadata
[2025-02-21 01:45:12,940][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,942][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:12,943][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:45:12,959][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:45:12,959][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.3333333333333333, 'malformed_label': 14, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 11, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 01:45:19,344][root][INFO] - Setting global seed to 206
[2025-02-21 01:45:19,349][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:45:19,349][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:45:19,350][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:45:19,352][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:45:19,354][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:45:19,354][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:45:19,503][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:45:20,022][root][INFO] - Full model selected, loading model
[2025-02-21 01:45:34,476][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:45:34,476][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:45:41,877][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:45:41,878][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:45:41,878][root][INFO] - Starting inference
[2025-02-21 01:45:42,064][root][INFO] - Processing question number 0
[2025-02-21 01:45:42,066][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:45:52,649][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:46:05,638][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:46:13,539][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:46:19,954][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:46:29,627][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:46:39,742][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:46:49,136][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:47:02,500][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:47:15,042][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:47:22,220][root][INFO] - Processing question number 10
[2025-02-21 01:47:22,222][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:47:38,158][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:47:50,138][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:47:59,140][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:48:09,685][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:48:18,902][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:48:25,965][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:48:34,550][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:48:43,906][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:48:49,900][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:49:05,977][root][INFO] - Processing question number 20
[2025-02-21 01:49:05,980][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:49:20,111][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:49:28,360][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:49:41,059][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:49:49,698][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:49:58,964][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:50:10,899][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:50:35,180][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:50:49,537][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:51:02,218][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:51:10,505][root][INFO] - Processing question number 30
[2025-02-21 01:51:10,508][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:51:21,985][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:51:35,300][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:51:45,863][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:51:54,952][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:52:03,193][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:52:20,150][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:52:30,536][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:52:42,312][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:52:50,654][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:53:06,472][root][INFO] - Processing question number 40
[2025-02-21 01:53:06,475][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:53:22,292][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:53:39,790][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:53:49,981][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:54:07,358][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:54:15,789][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:54:26,115][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:54:39,707][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:54:55,837][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:55:08,492][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:55:23,060][root][INFO] - Processing question number 50
[2025-02-21 01:55:23,064][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:55:29,620][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:55:45,095][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:55:52,250][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:56:12,225][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:56:25,666][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:56:35,685][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:56:47,582][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:56:58,062][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:57:09,358][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:57:18,169][root][INFO] - Processing question number 60
[2025-02-21 01:57:18,173][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:57:29,298][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:57:36,850][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:57:52,857][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:58:03,927][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:58:13,058][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:58:26,284][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:58:34,721][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:58:44,490][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:58:56,443][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:59:14,334][root][INFO] - Processing question number 70
[2025-02-21 01:59:14,338][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:59:22,138][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:59:30,771][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:59:40,142][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:59:52,523][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:00:10,863][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:00:20,557][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:00:32,667][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:00:49,112][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:00:56,788][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:01:06,778][root][INFO] - Processing question number 80
[2025-02-21 02:01:06,783][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:01:16,657][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:01:30,912][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:01:52,090][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:02:03,513][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:02:16,978][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:02:26,433][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:02:45,130][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:02:52,583][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:03:03,422][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:03:16,151][root][INFO] - Processing question number 90
[2025-02-21 02:03:16,156][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:03:26,639][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:03:35,070][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:03:50,548][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:04:02,015][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:04:16,361][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:04:26,431][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:04:34,957][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:04:45,540][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:04:55,658][root][INFO] - Inference complete
[2025-02-21 02:04:55,658][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,664][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,665][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:04:55,665][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:04:55,665][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:04:55,666][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:04:55,667][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:04:55,668][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:04:55,669][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:04:55,670][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:04:55,671][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:04:55,672][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:04:55,673][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:04:55,674][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:04:55,675][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:04:55,676][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:04:55,677][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:04:55,678][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:04:55,678][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:04:55,679][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,683][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,684][root][INFO] - Saved parsed outputs
[2025-02-21 02:04:55,684][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,685][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,685][root][INFO] - Saved parsing metadata
[2025-02-21 02:04:55,686][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,687][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:04:55,688][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:04:55,703][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:04:55,703][root][INFO] - Summary of metrics : {'label_accuracy': 0.5252525252525253, 'misclassification_rate': 0.4747474747474747, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 1, 'malformed_domain': 94, 'total_predictions': 99, 'correct_predictions': 52, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.020202020202020204, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 49, 'both_wrong': 45}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 02:05:02,721][root][INFO] - Setting global seed to 989
[2025-02-21 02:05:02,727][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:05:02,727][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:05:02,728][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:05:02,730][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:05:02,733][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:05:02,733][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:05:02,936][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:05:03,512][root][INFO] - Full model selected, loading model
[2025-02-21 02:05:18,630][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:06:58,562][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:06:58,562][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:07:31,223][root][INFO] - Peft model loaded successfully
[2025-02-21 02:07:38,331][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:07:38,333][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:07:38,333][root][INFO] - Starting inference
[2025-02-21 02:07:38,536][root][INFO] - Processing question number 0
[2025-02-21 02:07:38,539][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:07:46,074][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:07:55,361][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:08:19,431][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:08:35,228][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:08:46,106][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:09:16,939][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:09:32,250][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:09:41,287][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:09:46,824][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:10:17,926][root][INFO] - Processing question number 10
[2025-02-21 02:10:17,928][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:10:26,728][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:10:42,063][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:10:47,957][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:10:55,875][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:11:03,781][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:11:15,608][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:11:25,919][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:11:31,674][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:12:02,586][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:12:20,582][root][INFO] - Processing question number 20
[2025-02-21 02:12:20,586][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:12:38,246][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:13:00,777][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:13:11,787][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:13:42,371][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:13:53,789][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:14:01,968][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:14:12,882][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:14:24,526][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:14:55,477][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:15:05,545][root][INFO] - Processing question number 30
[2025-02-21 02:15:05,548][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:15:23,043][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:15:29,372][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:15:40,490][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:15:52,318][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:15:59,368][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:16:10,465][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:16:20,868][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:16:52,105][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:17:23,134][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:17:36,423][root][INFO] - Processing question number 40
[2025-02-21 02:17:36,426][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:18:07,490][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:18:18,851][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:18:34,185][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:19:05,523][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:19:14,324][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:19:25,455][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:19:36,538][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:19:43,758][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:19:51,267][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:19:56,919][root][INFO] - Processing question number 50
[2025-02-21 02:19:56,923][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:20:04,974][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:20:20,212][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:20:30,465][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:21:02,341][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:21:16,518][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:21:26,102][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:21:34,647][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:21:49,082][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:22:02,893][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:22:34,644][root][INFO] - Processing question number 60
[2025-02-21 02:22:34,648][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:22:42,482][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:22:51,292][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:23:01,039][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:23:08,013][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:23:20,244][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:23:30,822][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:23:43,112][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:24:14,216][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:24:20,441][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:24:30,770][root][INFO] - Processing question number 70
[2025-02-21 02:24:30,775][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:25:01,642][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:25:07,717][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:25:13,644][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:25:23,227][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:25:32,650][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:25:41,289][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:25:54,051][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:26:05,329][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:26:36,640][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:26:51,499][root][INFO] - Processing question number 80
[2025-02-21 02:26:51,503][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:26:59,556][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:27:10,776][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:27:18,705][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:27:26,772][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:27:58,107][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:28:06,666][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:28:15,469][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:28:23,394][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:28:35,416][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:29:06,024][root][INFO] - Processing question number 90
[2025-02-21 02:29:06,029][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:29:37,640][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:29:47,012][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:30:17,941][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:30:26,869][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:30:35,845][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:30:45,799][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:30:55,740][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:31:08,171][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:31:17,171][root][INFO] - Inference complete
[2025-02-21 02:31:17,171][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,177][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,179][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:31:17,179][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:31:17,179][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:31:17,179][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 02:31:17,180][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:31:17,180][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,180][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,181][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:31:17,181][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,181][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:31:17,182][root][ERROR] - |Q. 87||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,182][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:31:17,183][root][ERROR] - |Q. 51||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:31:17,183][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:31:17,183][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:31:17,183][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:31:17,183][root][ERROR] - |Q. 72||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:31:17,184][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:31:17,184][root][ERROR] - |Q. 94||D: Contracts| Failed to extract chosen option: 
[2025-02-21 02:31:17,185][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 02:31:17,185][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 02:31:17,185][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:31:17,185][root][ERROR] - |Q. 18||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:31:17,186][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:31:17,186][root][ERROR] - |Q. 68||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:31:17,187][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:31:17,187][root][ERROR] - |Q. 86||D: Evidence| Failed to extract chosen option: 
[2025-02-21 02:31:17,188][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:31:17,188][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 02:31:17,188][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:31:17,188][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:31:17,189][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 02:31:17,191][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,196][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,196][root][INFO] - Saved parsed outputs
[2025-02-21 02:31:17,196][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,197][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,197][root][INFO] - Saved parsing metadata
[2025-02-21 02:31:17,197][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,200][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:17,201][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:31:17,215][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:31:17,216][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 19, 'malformed_domain': 22, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.15151515151515152, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.1111111111111111, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 7, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 02:31:25,059][root][INFO] - Setting global seed to 989
[2025-02-21 02:31:25,065][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:31:25,065][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:31:25,067][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:31:25,069][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:31:25,072][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:31:25,072][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:31:25,217][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:31:25,762][root][INFO] - Full model selected, loading model
[2025-02-21 02:31:40,919][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:31:40,920][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:31:48,305][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:31:48,306][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:31:48,306][root][INFO] - Starting inference
[2025-02-21 02:31:48,533][root][INFO] - Processing question number 0
[2025-02-21 02:31:48,535][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:32:00,294][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:32:14,645][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:32:28,567][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:32:36,062][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:32:49,129][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:33:01,650][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:33:15,304][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:33:27,792][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:33:39,429][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:33:51,844][root][INFO] - Processing question number 10
[2025-02-21 02:33:51,846][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:34:07,687][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:34:17,946][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:34:26,249][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:34:46,233][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:34:53,878][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:35:00,557][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:35:12,503][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:35:22,348][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:35:28,685][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:35:40,578][root][INFO] - Processing question number 20
[2025-02-21 02:35:40,580][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:35:48,571][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:36:06,949][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:36:15,873][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:36:32,398][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:36:42,993][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:36:53,796][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:37:03,910][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:37:19,917][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:37:33,896][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:37:43,783][root][INFO] - Processing question number 30
[2025-02-21 02:37:43,786][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:38:03,854][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:38:17,882][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:38:28,075][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:38:38,429][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:38:49,569][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:38:59,036][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:39:07,719][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:39:21,815][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:39:30,794][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:39:39,409][root][INFO] - Processing question number 40
[2025-02-21 02:39:39,412][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:39:49,203][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:39:59,234][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:40:13,682][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:40:24,650][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:40:34,490][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:40:47,428][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:40:56,498][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:41:06,852][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:41:17,207][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:41:27,948][root][INFO] - Processing question number 50
[2025-02-21 02:41:27,951][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:41:44,691][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:42:01,295][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:42:12,779][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:42:32,405][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:42:50,010][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:43:01,144][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:43:11,648][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:43:24,815][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:43:35,554][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:43:44,572][root][INFO] - Processing question number 60
[2025-02-21 02:43:44,576][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:43:55,622][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:44:04,931][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:44:24,851][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:44:33,195][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:44:42,257][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:44:54,538][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:45:07,941][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:45:15,753][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:45:26,575][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:45:39,143][root][INFO] - Processing question number 70
[2025-02-21 02:45:39,147][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:45:50,048][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:46:06,115][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:46:13,317][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:46:23,454][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:46:31,896][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:46:41,467][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:46:59,793][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:47:09,790][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:47:26,201][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:47:36,065][root][INFO] - Processing question number 80
[2025-02-21 02:47:36,069][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:47:45,375][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:47:55,017][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:48:10,028][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:48:18,056][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:48:32,505][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:48:43,614][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:48:53,428][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:49:00,094][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:49:10,713][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:49:22,709][root][INFO] - Processing question number 90
[2025-02-21 02:49:22,718][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:49:34,767][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:49:44,851][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:49:59,518][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:50:14,534][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:50:30,515][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:50:38,565][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:50:46,500][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:50:58,412][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:51:17,163][root][INFO] - Inference complete
[2025-02-21 02:51:17,163][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,169][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,170][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:51:17,170][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:51:17,170][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:51:17,170][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:51:17,170][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:51:17,171][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:51:17,172][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:51:17,173][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:51:17,174][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:51:17,175][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:51:17,176][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:51:17,177][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:51:17,178][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:51:17,179][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:51:17,180][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:51:17,181][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:51:17,182][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:51:17,183][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:51:17,183][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:51:17,183][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:51:17,183][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:51:17,183][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:51:17,184][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,189][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,189][root][INFO] - Saved parsed outputs
[2025-02-21 02:51:17,189][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,191][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,191][root][INFO] - Saved parsing metadata
[2025-02-21 02:51:17,191][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,193][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:51:17,194][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:51:17,222][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:51:17,222][root][INFO] - Summary of metrics : {'label_accuracy': 0.5454545454545454, 'misclassification_rate': 0.4545454545454546, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 54, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 54, 'both_wrong': 45}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 02:51:25,293][root][INFO] - Setting global seed to 989
[2025-02-21 02:51:25,303][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:51:25,303][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:51:25,304][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:51:25,306][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:51:25,311][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:51:25,311][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:51:25,459][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:51:26,006][root][INFO] - Full model selected, loading model
[2025-02-21 02:51:48,196][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:53:34,614][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:53:34,615][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:54:06,633][root][INFO] - Peft model loaded successfully
[2025-02-21 02:54:14,224][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:54:14,225][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:54:14,225][root][INFO] - Starting inference
[2025-02-21 02:54:14,429][root][INFO] - Processing question number 0
[2025-02-21 02:54:14,431][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:54:45,538][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:54:53,672][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:55:24,270][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:55:36,665][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:55:58,526][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:56:29,710][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:56:46,817][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:57:06,574][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:57:15,906][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:57:24,989][root][INFO] - Processing question number 10
[2025-02-21 02:57:24,991][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:57:37,453][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:57:47,871][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:57:53,434][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:58:02,191][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:58:33,807][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:58:44,780][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:59:15,840][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:59:47,140][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:59:53,594][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:00:02,005][root][INFO] - Processing question number 20
[2025-02-21 03:00:02,007][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:00:11,254][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:00:39,077][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:00:49,714][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:00:57,837][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:01:09,338][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:01:18,844][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:01:29,880][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:01:43,916][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:01:56,112][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:02:06,488][root][INFO] - Processing question number 30
[2025-02-21 03:02:06,491][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:02:14,446][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:02:22,847][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:02:33,334][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:02:55,066][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:03:04,613][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:03:14,775][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:03:24,485][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:03:37,903][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:03:46,366][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:03:57,911][root][INFO] - Processing question number 40
[2025-02-21 03:03:57,914][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:04:14,788][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:04:23,962][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:04:55,635][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:05:27,332][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:05:36,476][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:05:47,077][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:05:58,071][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:06:28,705][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:06:35,949][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:06:41,658][root][INFO] - Processing question number 50
[2025-02-21 03:06:41,662][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:06:52,890][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:07:23,159][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:07:33,380][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:08:05,475][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:08:16,577][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:08:31,311][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:08:40,601][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:08:51,798][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:09:01,309][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:09:07,107][root][INFO] - Processing question number 60
[2025-02-21 03:09:07,111][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:09:15,102][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:09:46,291][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:09:57,699][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:10:05,583][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:10:15,684][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:10:29,994][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:10:45,615][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:10:56,025][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:11:27,428][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:11:35,755][root][INFO] - Processing question number 70
[2025-02-21 03:11:35,760][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:11:45,323][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:11:51,691][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:11:59,827][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:12:31,548][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:12:41,541][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:12:49,219][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:13:03,925][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:13:35,448][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:14:07,223][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:14:38,465][root][INFO] - Processing question number 80
[2025-02-21 03:14:38,470][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:14:54,292][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:15:02,825][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:15:10,593][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:15:17,369][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:15:49,066][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:15:59,128][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:16:08,685][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:16:22,595][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:16:36,397][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:17:07,319][root][INFO] - Processing question number 90
[2025-02-21 03:17:07,324][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:17:24,150][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:17:37,867][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:17:50,401][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:18:01,540][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:18:20,077][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:18:26,774][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:18:37,625][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:18:48,386][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:18:58,038][root][INFO] - Inference complete
[2025-02-21 03:18:58,038][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,044][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,045][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:18:58,045][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:18:58,046][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:18:58,046][root][ERROR] - |Q. 35||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:18:58,047][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:18:58,047][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 03:18:58,047][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:18:58,047][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 03:18:58,047][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:18:58,048][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 03:18:58,050][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:18:58,050][root][ERROR] - |Q. 88||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:18:58,050][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:18:58,050][root][ERROR] - |Q. 94||D: Contracts| Failed to extract chosen option: 
[2025-02-21 03:18:58,051][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 03:18:58,051][root][ERROR] - |Q. 32||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:18:58,051][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:18:58,051][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 03:18:58,052][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:18:58,052][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:18:58,053][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:18:58,053][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:18:58,053][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 03:18:58,054][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 03:18:58,054][root][ERROR] - |Q. 13||D: Property| Failed to extract chosen option: 
[2025-02-21 03:18:58,054][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:18:58,054][root][ERROR] - |Q. 48||D: Property| Failed to extract chosen option: 
[2025-02-21 03:18:58,054][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:18:58,055][root][ERROR] - |Q. 54||D: Property| Failed to extract chosen option: 
[2025-02-21 03:18:58,055][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 03:18:58,055][root][ERROR] - |Q. 61||D: Property| Failed to extract chosen option: 
[2025-02-21 03:18:58,055][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:18:58,055][root][ERROR] - |Q. 97||D: Property| Failed to extract chosen option: 
[2025-02-21 03:18:58,056][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:18:58,056][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 03:18:58,057][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,062][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,062][root][INFO] - Saved parsed outputs
[2025-02-21 03:18:58,062][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,064][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,064][root][INFO] - Saved parsing metadata
[2025-02-21 03:18:58,064][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,066][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:18:58,067][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:18:58,081][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:18:58,082][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.3333333333333333, 'malformed_label': 18, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.13131313131313133, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.10101010101010101, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 8, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 03:19:04,747][root][INFO] - Setting global seed to 989
[2025-02-21 03:19:04,752][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:19:04,752][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:19:04,754][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:19:04,755][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:19:04,757][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:19:04,757][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:19:04,904][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:19:05,448][root][INFO] - Full model selected, loading model
[2025-02-21 03:19:19,817][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:19:19,817][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:19:27,189][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:19:27,190][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:19:27,190][root][INFO] - Starting inference
[2025-02-21 03:19:27,423][root][INFO] - Processing question number 0
[2025-02-21 03:19:27,425][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:19:37,557][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:19:54,351][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:20:03,799][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:20:18,220][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:20:25,344][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:20:34,933][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:20:42,779][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:20:55,755][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:21:07,413][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:21:15,894][root][INFO] - Processing question number 10
[2025-02-21 03:21:15,896][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:21:31,384][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:21:47,890][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:22:00,005][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:22:09,957][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:22:26,244][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:22:36,271][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:22:49,423][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:22:58,841][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:23:06,125][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:23:19,810][root][INFO] - Processing question number 20
[2025-02-21 03:23:19,812][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:23:27,431][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:23:43,080][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:23:55,421][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:24:06,688][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:24:18,985][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:24:31,589][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:24:43,732][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:24:56,748][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:25:18,481][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:25:27,716][root][INFO] - Processing question number 30
[2025-02-21 03:25:27,718][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:25:39,262][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:25:53,467][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:26:03,747][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:26:14,943][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:26:22,603][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:26:32,155][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:26:42,228][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:26:54,440][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:27:05,588][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:27:19,755][root][INFO] - Processing question number 40
[2025-02-21 03:27:19,758][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:27:27,975][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:27:38,557][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:27:55,333][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:28:07,277][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:28:17,015][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:28:32,335][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:28:40,834][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:28:54,887][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:29:06,126][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:29:14,479][root][INFO] - Processing question number 50
[2025-02-21 03:29:14,482][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:29:32,676][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:29:49,614][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:29:59,340][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:30:20,245][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:30:37,321][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:30:51,160][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:31:02,873][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:31:16,255][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:31:31,535][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:31:38,888][root][INFO] - Processing question number 60
[2025-02-21 03:31:38,892][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:31:48,399][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:32:00,433][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:32:11,017][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:32:18,744][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:32:29,234][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:32:39,367][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:32:57,629][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:33:06,707][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:33:18,471][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:33:33,250][root][INFO] - Processing question number 70
[2025-02-21 03:33:33,254][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:33:45,442][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:33:57,168][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:34:06,448][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:34:15,868][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:34:24,781][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:34:33,742][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:34:48,112][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:34:56,241][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:35:06,180][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:35:16,479][root][INFO] - Processing question number 80
[2025-02-21 03:35:16,483][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:35:26,565][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:35:37,290][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:35:50,465][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:35:59,598][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:36:16,684][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:36:28,291][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:36:37,727][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:36:47,706][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:36:58,466][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:37:07,356][root][INFO] - Processing question number 90
[2025-02-21 03:37:07,361][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:37:19,285][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:37:27,427][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:37:40,400][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:37:50,006][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:38:01,671][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:38:11,209][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:38:21,524][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:38:40,183][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:38:53,089][root][INFO] - Inference complete
[2025-02-21 03:38:53,089][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,095][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,096][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:38:53,096][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:38:53,096][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:38:53,097][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:38:53,098][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:38:53,099][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:38:53,100][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:38:53,101][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:38:53,102][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:38:53,103][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:38:53,104][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:38:53,105][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:38:53,106][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:38:53,107][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:38:53,108][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:38:53,109][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:38:53,110][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,115][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,115][root][INFO] - Saved parsed outputs
[2025-02-21 03:38:53,115][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,117][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,117][root][INFO] - Saved parsing metadata
[2025-02-21 03:38:53,118][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,119][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:38:53,121][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:38:53,136][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:38:53,136][root][INFO] - Summary of metrics : {'label_accuracy': 0.5656565656565656, 'misclassification_rate': 0.43434343434343436, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 56, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 56, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 03:39:00,605][root][INFO] - Setting global seed to 989
[2025-02-21 03:39:00,613][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:39:00,613][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:39:00,614][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:39:00,616][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:39:00,618][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:39:00,619][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:39:00,775][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:39:01,296][root][INFO] - Full model selected, loading model
[2025-02-21 03:39:16,623][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:40:56,792][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:40:56,794][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:41:28,141][root][INFO] - Peft model loaded successfully
[2025-02-21 03:41:35,231][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:41:35,233][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:41:35,233][root][INFO] - Starting inference
[2025-02-21 03:41:35,441][root][INFO] - Processing question number 0
[2025-02-21 03:41:35,443][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:41:46,451][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:41:52,535][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:42:04,885][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:42:36,415][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:42:46,859][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:43:01,216][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:43:32,384][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:43:47,983][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:43:55,336][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:44:01,376][root][INFO] - Processing question number 10
[2025-02-21 03:44:01,379][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:44:11,805][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:44:23,503][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:44:44,416][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:44:57,453][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:45:16,300][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:45:25,781][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:45:45,838][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:45:57,559][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:46:05,587][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:46:21,885][root][INFO] - Processing question number 20
[2025-02-21 03:46:21,888][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:46:30,737][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:46:49,534][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:47:05,709][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:47:20,525][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:47:29,806][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:47:40,453][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:47:48,336][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:48:02,463][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:48:16,515][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:48:33,122][root][INFO] - Processing question number 30
[2025-02-21 03:48:33,126][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:48:39,691][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:48:48,837][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:49:05,140][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:49:14,490][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:49:19,794][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:49:32,831][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:49:42,584][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:49:52,165][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:50:06,770][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:50:15,064][root][INFO] - Processing question number 40
[2025-02-21 03:50:15,068][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:50:29,691][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:50:41,370][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:50:51,737][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:51:01,750][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:51:11,432][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:51:22,342][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:51:33,089][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:51:43,693][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:51:52,515][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:51:58,018][root][INFO] - Processing question number 50
[2025-02-21 03:51:58,022][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:52:06,304][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:52:17,944][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:52:25,256][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:52:57,336][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:53:07,279][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:53:23,862][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:53:36,039][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:54:02,357][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:54:15,443][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:54:27,696][root][INFO] - Processing question number 60
[2025-02-21 03:54:27,700][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:54:35,684][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:54:46,024][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:55:00,313][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:55:14,892][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:55:26,889][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:55:41,243][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:56:12,580][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:56:28,181][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:56:41,812][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:57:13,374][root][INFO] - Processing question number 70
[2025-02-21 03:57:13,380][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:57:30,061][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:57:41,641][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:57:50,235][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:58:00,818][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:58:08,636][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:58:39,612][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:58:50,937][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:58:59,021][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:59:07,460][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:59:28,978][root][INFO] - Processing question number 80
[2025-02-21 03:59:28,985][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:59:38,168][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:59:50,460][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:59:58,272][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:00:07,706][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:00:31,500][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:00:46,371][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:00:56,869][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:01:10,507][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:01:25,255][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:01:37,555][root][INFO] - Processing question number 90
[2025-02-21 04:01:37,561][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:01:53,751][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:02:05,675][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:02:37,042][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:02:48,822][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:02:59,476][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:03:09,460][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:03:20,548][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:03:29,544][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:03:42,063][root][INFO] - Inference complete
[2025-02-21 04:03:42,063][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,070][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,071][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 04:03:42,072][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 04:03:42,075][root][ERROR] - |Q. 82||D: Torts| Failed to extract chosen option: 
[2025-02-21 04:03:42,077][root][ERROR] - |Q. 59||D: Evidence| Failed to extract chosen option: 
[2025-02-21 04:03:42,077][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:03:42,077][root][ERROR] - |Q. 78||D: Evidence| Failed to extract chosen option: 
[2025-02-21 04:03:42,078][root][ERROR] - |Q. 33||D: Property| Failed to extract explanation: 
[2025-02-21 04:03:42,078][root][ERROR] - |Q. 33||D: Property| Failed to extract chosen option: 
[2025-02-21 04:03:42,079][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:03:42,079][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 04:03:42,081][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,092][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,093][root][INFO] - Saved parsed outputs
[2025-02-21 04:03:42,093][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,094][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,094][root][INFO] - Saved parsing metadata
[2025-02-21 04:03:42,095][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,096][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:03:42,098][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:03:42,125][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:03:42,125][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 7, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.2857142857142857, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.1414141414141414, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.020202020202020204, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 7, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 04:03:49,970][root][INFO] - Setting global seed to 989
[2025-02-21 04:03:49,978][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:03:49,978][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:03:49,979][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:03:49,982][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:03:49,985][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:03:49,985][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:03:50,126][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:03:50,665][root][INFO] - Full model selected, loading model
[2025-02-21 04:04:13,683][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:04:13,683][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:04:21,169][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:04:21,171][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:04:21,171][root][INFO] - Starting inference
[2025-02-21 04:04:21,346][root][INFO] - Processing question number 0
[2025-02-21 04:04:21,348][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:04:29,132][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:04:40,866][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:04:56,876][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:05:08,196][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:05:18,571][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:05:28,650][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:05:40,416][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:05:56,729][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:06:08,685][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:06:20,274][root][INFO] - Processing question number 10
[2025-02-21 04:06:20,276][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:06:31,739][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:06:46,532][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:06:55,147][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:07:12,796][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:07:28,464][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:07:42,413][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:07:55,412][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:08:04,081][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:08:18,966][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:08:27,658][root][INFO] - Processing question number 20
[2025-02-21 04:08:27,660][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:08:38,743][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:08:52,778][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:09:01,284][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:09:10,425][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:09:21,157][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:09:29,762][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:09:44,159][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:09:53,865][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:10:14,454][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:10:21,963][root][INFO] - Processing question number 30
[2025-02-21 04:10:21,966][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:10:34,614][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:10:46,422][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:10:56,945][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:11:07,789][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:11:17,772][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:11:27,568][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:11:36,772][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:11:46,346][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:11:55,347][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:12:04,644][root][INFO] - Processing question number 40
[2025-02-21 04:12:04,647][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:12:19,310][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:12:31,483][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:12:43,047][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:12:58,902][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:13:07,195][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:13:19,290][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:13:31,919][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:13:39,218][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:13:48,133][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:14:00,824][root][INFO] - Processing question number 50
[2025-02-21 04:14:00,827][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:14:12,812][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:14:24,855][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:14:34,130][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:14:49,271][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:15:02,224][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:15:17,201][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:15:25,674][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:15:33,304][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:15:46,030][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:15:55,515][root][INFO] - Processing question number 60
[2025-02-21 04:15:55,518][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:16:09,964][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:16:19,253][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:16:30,597][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:16:37,487][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:16:52,254][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:17:05,144][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:17:23,403][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:17:36,551][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:17:46,809][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:17:57,890][root][INFO] - Processing question number 70
[2025-02-21 04:17:57,894][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:18:09,534][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:18:19,461][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:18:28,249][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:18:38,777][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:18:47,340][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:18:57,141][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:19:07,852][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:19:16,080][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:19:24,464][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:19:32,479][root][INFO] - Processing question number 80
[2025-02-21 04:19:32,484][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:19:46,656][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:20:09,747][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:20:17,849][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:20:30,729][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:20:44,332][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:20:55,839][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:21:04,271][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:21:14,252][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:21:29,764][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:21:40,776][root][INFO] - Processing question number 90
[2025-02-21 04:21:40,781][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:21:55,267][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:22:06,305][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:22:21,400][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:22:30,170][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:22:45,100][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:22:53,930][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:23:04,066][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:23:16,496][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:23:34,804][root][INFO] - Inference complete
[2025-02-21 04:23:34,804][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,810][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,811][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:23:34,811][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:23:34,812][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:23:34,813][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:23:34,814][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:23:34,815][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:23:34,816][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:23:34,816][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:23:34,816][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:23:34,816][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:23:34,816][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:23:34,817][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:23:34,818][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:23:34,819][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:23:34,820][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:23:34,821][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:23:34,822][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:23:34,823][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:23:34,824][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:23:34,824][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:23:34,824][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:23:34,824][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:23:34,824][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:23:34,825][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,835][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,835][root][INFO] - Saved parsed outputs
[2025-02-21 04:23:34,835][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,841][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,842][root][INFO] - Saved parsing metadata
[2025-02-21 04:23:34,842][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,844][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:23:34,852][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:23:34,865][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:23:34,866][root][INFO] - Summary of metrics : {'label_accuracy': 0.5050505050505051, 'misclassification_rate': 0.4949494949494949, 'combined_accuracy': 0.020202020202020204, 'malformed_label': 2, 'malformed_domain': 97, 'total_predictions': 99, 'correct_predictions': 50, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 04:23:41,605][root][INFO] - Setting global seed to 206
[2025-02-21 04:23:41,611][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:23:41,611][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:23:41,613][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:23:41,615][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:23:41,617][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:23:41,617][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'failed', '1', 'Evaluation failed']
Updating eval for job 28 to status failed with exit code 1
Error message: Evaluation failed
Eval status update completed for job 28
Evaluation failed with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 04:23:48,185][root][INFO] - Setting global seed to 206
[2025-02-21 04:23:48,190][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:23:48,190][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:23:48,191][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:23:48,193][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:23:48,195][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:23:48,195][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:23:48,333][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:23:48,866][root][INFO] - Full model selected, loading model
[2025-02-21 04:24:02,742][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:24:02,742][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:24:10,107][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:24:10,109][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:24:10,109][root][INFO] - Starting inference
[2025-02-21 04:24:10,309][root][INFO] - Processing question number 0
[2025-02-21 04:24:10,316][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:24:22,212][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:24:33,499][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:24:46,026][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:24:56,219][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:25:04,495][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:25:14,957][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:25:29,026][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:25:38,183][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:25:49,514][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:25:57,847][root][INFO] - Processing question number 10
[2025-02-21 04:25:57,848][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:26:07,013][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:26:18,142][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:26:29,793][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:26:43,822][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:26:57,741][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:27:06,774][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:27:21,453][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:27:34,481][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:27:45,058][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:27:56,891][root][INFO] - Processing question number 20
[2025-02-21 04:27:56,893][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:28:08,118][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:28:24,784][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:28:34,191][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:28:43,542][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:28:55,264][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:29:04,997][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:29:16,528][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:29:39,007][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:29:50,142][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:30:03,600][root][INFO] - Processing question number 30
[2025-02-21 04:30:03,604][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:30:16,132][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:30:24,448][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:30:36,030][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:30:49,816][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:31:08,633][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:31:30,293][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:31:39,692][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:31:54,575][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:32:08,635][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:32:20,703][root][INFO] - Processing question number 40
[2025-02-21 04:32:20,706][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:32:32,850][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:32:45,301][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:33:00,486][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:33:12,728][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:33:27,450][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:33:36,143][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:33:45,298][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:33:54,759][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:34:03,551][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:34:13,634][root][INFO] - Processing question number 50
[2025-02-21 04:34:13,637][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:34:30,057][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:34:39,880][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:34:52,040][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:35:03,316][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:35:13,638][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:35:26,589][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:35:37,158][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:35:46,344][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:35:57,521][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:36:07,747][root][INFO] - Processing question number 60
[2025-02-21 04:36:07,751][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:36:16,482][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:36:31,165][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:36:43,392][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:36:53,874][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:37:03,599][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:37:12,554][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:37:23,047][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:37:29,574][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:37:42,578][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:37:50,879][root][INFO] - Processing question number 70
[2025-02-21 04:37:50,883][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:37:59,476][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:38:07,886][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:38:22,251][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:38:39,943][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:38:51,202][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:39:04,475][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:39:15,153][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:39:29,368][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:39:39,956][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:39:51,865][root][INFO] - Processing question number 80
[2025-02-21 04:39:51,869][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:39:59,425][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:40:09,200][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:40:26,560][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:40:38,328][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:40:48,481][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:40:57,842][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:41:11,631][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:41:24,720][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:41:34,543][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:41:55,396][root][INFO] - Processing question number 90
[2025-02-21 04:41:55,400][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:42:05,781][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:42:15,921][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:42:27,116][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:42:39,903][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:42:49,669][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:42:58,711][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:43:08,646][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:43:17,939][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:43:27,274][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:43:38,544][root][INFO] - Inference complete
[2025-02-21 04:43:38,544][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,552][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,552][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:43:38,553][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:43:38,553][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:43:38,553][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:43:38,553][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:43:38,553][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:43:38,554][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:43:38,555][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:43:38,556][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:43:38,557][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:43:38,558][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:43:38,559][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:43:38,560][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:43:38,561][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:43:38,562][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:43:38,563][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:43:38,564][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:43:38,565][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:43:38,566][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:43:38,566][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:43:38,566][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:43:38,566][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 04:43:38,567][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,573][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,573][root][INFO] - Saved parsed outputs
[2025-02-21 04:43:38,573][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,575][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,575][root][INFO] - Saved parsing metadata
[2025-02-21 04:43:38,576][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,577][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:43:38,579][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:43:38,593][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:43:38,593][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 55, 'both_wrong': 45}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 04:43:45,493][root][INFO] - Setting global seed to 206
[2025-02-21 04:43:45,498][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:43:45,499][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:43:45,500][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:43:45,501][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:43:45,504][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:43:45,504][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:43:45,647][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:43:46,169][root][INFO] - Full model selected, loading model
[2025-02-21 04:44:02,974][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:45:41,546][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:45:41,568][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:46:13,595][root][INFO] - Peft model loaded successfully
[2025-02-21 04:46:20,625][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:46:20,627][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:46:20,627][root][INFO] - Starting inference
[2025-02-21 04:46:20,828][root][INFO] - Processing question number 0
[2025-02-21 04:46:20,830][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:46:32,657][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:46:41,384][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:46:52,107][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:47:02,334][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:47:10,963][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:47:22,522][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:47:53,639][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:48:02,771][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:48:08,701][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:48:14,001][root][INFO] - Processing question number 10
[2025-02-21 04:48:14,003][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:48:27,220][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:48:45,497][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:48:54,446][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:49:02,131][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:49:12,219][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:49:21,046][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:49:52,384][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:50:03,100][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:50:15,313][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:50:26,624][root][INFO] - Processing question number 20
[2025-02-21 04:50:26,626][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:50:37,634][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:51:08,995][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:51:18,470][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:51:24,985][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:51:36,237][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:52:07,743][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:52:19,358][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:52:29,877][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:52:39,358][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:52:49,739][root][INFO] - Processing question number 30
[2025-02-21 04:52:49,743][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:53:00,804][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:53:32,053][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:53:41,243][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:53:57,587][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:54:06,108][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:54:37,534][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:55:08,663][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:55:17,706][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:55:24,697][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:55:35,459][root][INFO] - Processing question number 40
[2025-02-21 04:55:35,462][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:55:44,262][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:55:51,855][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:56:03,137][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:56:33,739][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:56:48,636][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:56:56,165][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:57:06,387][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:57:12,063][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:57:43,283][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:57:50,950][root][INFO] - Processing question number 50
[2025-02-21 04:57:50,955][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:57:58,447][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:58:29,274][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:58:38,110][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:58:49,432][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:58:58,411][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:59:08,222][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:59:19,079][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:59:32,661][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:59:48,341][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:59:58,138][root][INFO] - Processing question number 60
[2025-02-21 04:59:58,142][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:00:28,174][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:00:41,090][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:01:12,946][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:01:24,465][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:01:47,505][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:02:18,591][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:02:44,790][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:02:53,430][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:03:06,839][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:03:18,115][root][INFO] - Processing question number 70
[2025-02-21 05:03:18,119][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:03:49,479][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:04:00,957][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:04:20,592][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:04:32,769][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:04:42,543][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:04:52,002][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:05:02,357][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:05:33,935][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:05:40,056][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:06:11,151][root][INFO] - Processing question number 80
[2025-02-21 05:06:11,156][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:06:24,150][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:06:30,846][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:06:44,043][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:06:52,300][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:07:24,286][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:07:31,400][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:07:48,013][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:08:19,852][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:08:28,506][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:08:37,076][root][INFO] - Processing question number 90
[2025-02-21 05:08:37,081][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:08:42,915][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:08:56,801][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:09:11,233][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:09:42,523][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:09:50,806][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:09:59,318][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:10:14,121][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:10:25,127][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:10:55,936][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:11:07,686][root][INFO] - Inference complete
[2025-02-21 05:11:07,687][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,693][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,694][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:11:07,694][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 05:11:07,695][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:07,695][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:11:07,696][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:07,696][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:11:07,697][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:11:07,697][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 05:11:07,697][root][ERROR] - |Q. 14||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:11:07,697][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:07,697][root][ERROR] - |Q. 24||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:11:07,698][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:07,698][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:11:07,698][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:11:07,698][root][ERROR] - |Q. 58||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:11:07,699][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:07,699][root][ERROR] - |Q. 4||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:11:07,699][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:07,700][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:11:07,700][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:11:07,700][root][ERROR] - |Q. 51||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:11:07,701][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:07,701][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:11:07,701][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:11:07,702][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:07,702][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:11:07,702][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:11:07,702][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:11:07,702][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:11:07,703][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:07,703][root][ERROR] - |Q. 53||D: Property| Failed to extract chosen option: 
[2025-02-21 05:11:07,703][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:07,703][root][ERROR] - |Q. 66||D: Property| Failed to extract chosen option: 
[2025-02-21 05:11:07,704][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 05:11:07,704][root][ERROR] - |Q. 94||D: Property| Failed to extract chosen option: 
[2025-02-21 05:11:07,704][root][ERROR] - |Q. 18||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:11:07,705][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:07,705][root][ERROR] - |Q. 57||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:11:07,706][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 05:11:07,706][root][ERROR] - |Q. 92||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:11:07,707][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,716][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,716][root][INFO] - Saved parsed outputs
[2025-02-21 05:11:07,717][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,726][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,726][root][INFO] - Saved parsing metadata
[2025-02-21 05:11:07,726][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,728][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:07,730][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:11:07,757][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:11:07,757][root][INFO] - Summary of metrics : {'label_accuracy': 0.43, 'misclassification_rate': 0.5700000000000001, 'combined_accuracy': 0.3, 'malformed_label': 22, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 43, 'correct_label_and_domain': 30, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.18, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 13, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 05:11:15,845][root][INFO] - Setting global seed to 206
[2025-02-21 05:11:15,852][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:11:15,852][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:11:15,853][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:11:15,855][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:11:15,861][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:11:15,861][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:11:16,035][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:11:16,556][root][INFO] - Full model selected, loading model
[2025-02-21 05:11:37,814][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:11:37,852][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:11:45,319][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:11:45,321][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:11:45,321][root][INFO] - Starting inference
[2025-02-21 05:11:45,510][root][INFO] - Processing question number 0
[2025-02-21 05:11:45,518][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:11:59,138][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:12:10,150][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:12:23,233][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:12:31,606][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:12:41,730][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:13:00,919][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:13:08,771][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:13:17,458][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:13:35,356][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:13:43,787][root][INFO] - Processing question number 10
[2025-02-21 05:13:43,789][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:13:57,814][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:14:08,559][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:14:19,278][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:14:30,273][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:14:38,890][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:14:53,637][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:15:07,725][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:15:25,812][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:15:37,840][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:15:48,321][root][INFO] - Processing question number 20
[2025-02-21 05:15:48,323][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:15:58,524][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:16:08,507][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:16:24,952][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:16:34,521][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:16:48,491][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:16:59,359][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:17:14,651][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:17:32,819][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:17:47,920][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:17:58,662][root][INFO] - Processing question number 30
[2025-02-21 05:17:58,665][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:18:07,498][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:18:17,771][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:18:26,336][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:18:45,545][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:18:56,359][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:19:09,066][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:19:19,559][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:19:36,524][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:19:47,518][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:20:04,935][root][INFO] - Processing question number 40
[2025-02-21 05:20:04,939][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:20:12,945][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:20:23,802][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:20:43,306][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:20:53,972][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:21:10,288][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:21:20,870][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:21:30,071][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:21:38,829][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:21:47,712][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:22:02,336][root][INFO] - Processing question number 50
[2025-02-21 05:22:02,344][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:22:19,017][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:22:35,052][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:22:53,416][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:23:04,039][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:23:14,996][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:23:26,660][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:23:36,410][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:23:45,027][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:23:59,238][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:24:12,961][root][INFO] - Processing question number 60
[2025-02-21 05:24:12,965][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:24:23,146][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:24:35,568][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:24:48,620][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:24:58,746][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:25:10,866][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:25:22,135][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:25:32,669][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:25:39,053][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:25:56,101][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:26:09,140][root][INFO] - Processing question number 70
[2025-02-21 05:26:09,144][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:26:19,876][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:26:27,519][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:26:40,772][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:26:51,112][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:27:05,323][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:27:16,596][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:27:25,580][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:27:36,067][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:27:45,273][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:27:58,897][root][INFO] - Processing question number 80
[2025-02-21 05:27:58,902][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:28:07,525][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:28:17,233][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:28:27,400][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:28:37,667][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:28:47,401][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:29:00,094][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:29:19,514][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:29:30,573][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:29:39,486][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:29:52,824][root][INFO] - Processing question number 90
[2025-02-21 05:29:52,829][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:30:05,518][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:30:15,951][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:30:28,415][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:30:37,609][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:30:46,245][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:30:55,634][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:31:05,815][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:31:15,735][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:31:25,846][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:31:36,966][root][INFO] - Inference complete
[2025-02-21 05:31:36,966][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:36,974][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:36,975][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:31:36,975][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:31:36,975][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:31:36,976][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:31:36,977][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:31:36,978][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:31:36,979][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:31:36,980][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:31:36,981][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:31:36,982][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:31:36,983][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:31:36,984][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:31:36,985][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:31:36,986][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 05:31:36,987][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:31:36,988][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:31:36,989][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:31:36,989][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,006][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,007][root][INFO] - Saved parsed outputs
[2025-02-21 05:31:37,007][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,008][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,008][root][INFO] - Saved parsing metadata
[2025-02-21 05:31:37,010][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,011][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:31:37,013][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:31:37,026][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:31:37,026][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 56, 'both_wrong': 44}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 05:31:44,428][root][INFO] - Setting global seed to 206
[2025-02-21 05:31:44,436][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:31:44,436][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:31:44,437][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:31:44,438][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:31:44,441][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:31:44,441][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:31:44,752][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:31:45,272][root][INFO] - Full model selected, loading model
[2025-02-21 05:32:04,590][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:33:44,454][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:33:44,466][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:34:17,319][root][INFO] - Peft model loaded successfully
[2025-02-21 05:34:24,426][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:34:24,428][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:34:24,428][root][INFO] - Starting inference
[2025-02-21 05:34:24,658][root][INFO] - Processing question number 0
[2025-02-21 05:34:24,664][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:34:39,723][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:34:48,051][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:34:58,524][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:35:15,513][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:35:35,916][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:35:48,195][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:35:53,357][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:36:00,760][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:36:08,353][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:36:18,094][root][INFO] - Processing question number 10
[2025-02-21 05:36:18,096][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:36:26,105][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:36:36,825][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:36:47,570][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:36:58,463][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:37:06,771][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:37:18,930][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:37:28,182][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:37:37,647][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:37:47,805][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:37:59,724][root][INFO] - Processing question number 20
[2025-02-21 05:37:59,726][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:38:11,776][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:38:19,891][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:38:42,505][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:38:59,037][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:39:07,319][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:39:14,785][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:39:30,522][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:39:50,983][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:39:59,969][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:40:12,273][root][INFO] - Processing question number 30
[2025-02-21 05:40:12,276][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:40:20,708][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:40:30,429][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:40:47,963][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:40:55,134][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:41:02,354][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:41:33,586][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:41:44,212][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:41:55,619][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:42:02,415][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:42:17,216][root][INFO] - Processing question number 40
[2025-02-21 05:42:17,219][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:42:25,972][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:42:35,585][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:42:45,040][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:43:15,621][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:43:37,659][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:43:45,637][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:43:57,208][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:44:04,810][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:44:36,239][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:44:44,951][root][INFO] - Processing question number 50
[2025-02-21 05:44:44,955][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:44:59,168][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:45:10,066][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:45:41,692][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:46:09,510][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:46:40,377][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:46:53,186][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:47:24,834][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:47:37,768][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:48:09,295][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:48:32,565][root][INFO] - Processing question number 60
[2025-02-21 05:48:32,569][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:48:52,937][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:49:07,726][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:49:29,740][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:49:38,160][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:49:50,125][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:50:02,844][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:50:33,773][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:50:43,209][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:50:54,020][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:51:15,411][root][INFO] - Processing question number 70
[2025-02-21 05:51:15,416][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:51:36,280][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:51:43,184][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:52:14,737][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:52:26,355][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:52:34,072][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:52:43,745][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:52:58,002][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:53:07,899][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:53:15,047][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:53:46,151][root][INFO] - Processing question number 80
[2025-02-21 05:53:46,156][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:54:14,796][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:54:25,318][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:54:39,144][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:54:44,836][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:54:53,349][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:55:08,759][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:55:21,391][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:55:38,972][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:55:44,612][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:55:54,237][root][INFO] - Processing question number 90
[2025-02-21 05:55:54,242][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:56:03,716][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:56:12,642][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:56:44,241][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:56:50,507][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:57:01,378][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:57:09,999][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:57:20,426][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:57:28,571][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:57:59,416][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:58:25,279][root][INFO] - Inference complete
[2025-02-21 05:58:25,279][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,286][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,289][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:58:25,290][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 05:58:25,290][root][ERROR] - |Q. 4||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,291][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,291][root][ERROR] - |Q. 60||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,292][root][ERROR] - |Q. 80||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,292][root][ERROR] - |Q. 85||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,292][root][ERROR] - |Q. 90||D: Evidence| Failed to extract chosen option: 
[2025-02-21 05:58:25,292][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:58:25,293][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:58:25,293][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 05:58:25,294][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 05:58:25,294][root][ERROR] - |Q. 17||D: Property| Failed to extract chosen option: 
[2025-02-21 05:58:25,295][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 05:58:25,295][root][ERROR] - |Q. 66||D: Property| Failed to extract chosen option: 
[2025-02-21 05:58:25,296][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 05:58:25,296][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:58:25,297][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 05:58:25,297][root][ERROR] - |Q. 92||D: Torts| Failed to extract chosen option: 
[2025-02-21 05:58:25,298][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,303][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,303][root][INFO] - Saved parsed outputs
[2025-02-21 05:58:25,303][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,320][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,320][root][INFO] - Saved parsing metadata
[2025-02-21 05:58:25,321][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,324][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:25,336][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:58:25,350][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:58:25,350][root][INFO] - Summary of metrics : {'label_accuracy': 0.5, 'misclassification_rate': 0.5, 'combined_accuracy': 0.34, 'malformed_label': 14, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 50, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.7857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.11, 'Torts_confidence': 0.11, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 16, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 05:58:31,638][root][INFO] - Setting global seed to 206
[2025-02-21 05:58:31,643][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:58:31,643][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:58:31,645][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:58:31,647][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:58:31,648][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:58:31,649][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:58:31,868][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:58:32,383][root][INFO] - Full model selected, loading model
[2025-02-21 05:58:47,510][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:58:47,510][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:58:54,840][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:58:54,842][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:58:54,842][root][INFO] - Starting inference
[2025-02-21 05:58:55,043][root][INFO] - Processing question number 0
[2025-02-21 05:58:55,045][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:59:07,926][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:59:21,170][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:59:34,803][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:59:44,977][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:59:52,917][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:00:06,781][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:00:17,029][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:00:30,836][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:00:48,425][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:01:08,996][root][INFO] - Processing question number 10
[2025-02-21 06:01:08,998][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:01:23,478][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:01:36,208][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:01:47,011][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:02:01,360][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:02:14,900][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:02:23,169][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:02:31,632][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:02:40,502][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:02:49,650][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:03:00,453][root][INFO] - Processing question number 20
[2025-02-21 06:03:00,455][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:03:10,287][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:03:25,241][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:03:38,195][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:03:45,784][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:03:58,635][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:04:07,535][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:04:23,468][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:04:32,783][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:04:39,644][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:04:57,053][root][INFO] - Processing question number 30
[2025-02-21 06:04:57,056][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:05:07,182][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:05:14,759][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:05:33,652][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:05:42,319][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:05:57,015][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:06:08,473][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:06:17,499][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:06:30,257][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:06:42,821][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:06:53,324][root][INFO] - Processing question number 40
[2025-02-21 06:06:53,328][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:07:03,364][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:07:19,078][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:07:38,791][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:07:47,597][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:08:01,616][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:08:10,727][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:08:21,646][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:08:32,631][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:08:43,242][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:08:54,052][root][INFO] - Processing question number 50
[2025-02-21 06:08:54,056][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:09:04,449][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:09:13,414][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:09:22,541][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:09:35,167][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:09:42,964][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:09:57,321][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:10:06,209][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:10:16,421][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:10:27,229][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:10:39,178][root][INFO] - Processing question number 60
[2025-02-21 06:10:39,182][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:10:54,429][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:11:03,386][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:11:11,953][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:11:26,451][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:11:37,206][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:11:49,563][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:11:58,954][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:12:07,782][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:12:20,185][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:12:27,225][root][INFO] - Processing question number 70
[2025-02-21 06:12:27,229][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:12:43,155][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:12:48,821][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:13:14,295][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:13:28,910][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:13:39,473][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:13:51,264][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:14:01,985][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:14:12,609][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:14:22,415][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:14:32,290][root][INFO] - Processing question number 80
[2025-02-21 06:14:32,295][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:14:40,313][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:14:55,545][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:15:05,613][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:15:15,907][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:15:26,052][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:15:35,302][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:15:52,710][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:15:58,665][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:16:08,017][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:16:25,808][root][INFO] - Processing question number 90
[2025-02-21 06:16:25,813][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:16:41,327][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:16:55,054][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:17:04,377][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:17:18,877][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:17:32,789][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:17:43,310][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:17:49,837][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:17:59,548][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:18:13,962][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:18:24,421][root][INFO] - Inference complete
[2025-02-21 06:18:24,421][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,428][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:18:24,429][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:18:24,430][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:18:24,431][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:18:24,432][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:18:24,433][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:18:24,434][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:18:24,435][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:18:24,436][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:18:24,437][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:18:24,438][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:18:24,439][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:18:24,440][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:18:24,441][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:18:24,442][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,447][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,447][root][INFO] - Saved parsed outputs
[2025-02-21 06:18:24,447][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,449][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,449][root][INFO] - Saved parsing metadata
[2025-02-21 06:18:24,450][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,451][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:18:24,452][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:18:24,464][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:18:24,464][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.02, 'malformed_label': 1, 'malformed_domain': 96, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 50, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 06:18:30,705][root][INFO] - Setting global seed to 989
[2025-02-21 06:18:30,710][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:18:30,710][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:18:30,711][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:18:30,712][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:18:30,714][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:18:30,714][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:18:30,862][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:18:31,370][root][INFO] - Full model selected, loading model
[2025-02-21 06:18:49,927][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:20:29,137][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:20:29,160][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:20:59,141][root][INFO] - Peft model loaded successfully
[2025-02-21 06:21:06,223][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:21:06,225][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:21:06,225][root][INFO] - Starting inference
[2025-02-21 06:21:06,454][root][INFO] - Processing question number 0
[2025-02-21 06:21:06,470][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:21:13,834][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:21:23,244][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:21:34,289][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:22:05,644][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:22:36,405][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:23:06,933][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:23:37,791][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:23:46,706][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:24:17,243][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:24:26,361][root][INFO] - Processing question number 10
[2025-02-21 06:24:26,363][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:24:39,323][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:24:49,262][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:24:59,518][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:25:11,030][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:25:20,063][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:25:31,373][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:25:40,790][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:25:54,135][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:26:02,228][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:26:09,331][root][INFO] - Processing question number 20
[2025-02-21 06:26:09,333][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:26:39,631][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:26:47,241][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:27:17,989][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:27:27,914][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:27:38,875][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:27:46,679][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:27:56,367][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:28:06,111][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:28:14,094][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:28:23,311][root][INFO] - Processing question number 30
[2025-02-21 06:28:23,319][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:28:34,057][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:28:43,163][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:28:51,003][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:29:22,287][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:29:30,042][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:29:44,951][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:29:57,171][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:30:14,093][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:30:20,693][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:30:34,461][root][INFO] - Processing question number 40
[2025-02-21 06:30:34,465][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:30:42,021][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:31:12,840][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:31:24,954][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:31:34,562][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:31:50,096][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:31:58,108][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:32:09,484][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:32:15,802][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:32:46,760][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:33:00,359][root][INFO] - Processing question number 50
[2025-02-21 06:33:00,363][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:33:07,552][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:33:38,113][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:34:09,493][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:34:19,699][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:34:28,365][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:34:38,755][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:34:52,092][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:35:02,868][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:35:14,983][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:35:46,180][root][INFO] - Processing question number 60
[2025-02-21 06:35:46,184][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:35:57,993][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:36:18,483][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:36:32,444][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:36:46,576][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:36:58,348][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:37:12,505][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:37:26,767][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:37:34,026][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:37:43,770][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:37:56,799][root][INFO] - Processing question number 70
[2025-02-21 06:37:56,804][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:38:07,935][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:38:38,950][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:39:10,234][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:39:19,140][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:39:30,998][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:39:41,631][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:39:50,750][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:40:05,958][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:40:12,801][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:40:22,444][root][INFO] - Processing question number 80
[2025-02-21 06:40:22,449][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:40:53,751][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:40:59,961][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:41:31,396][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:41:42,877][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:41:50,770][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:41:58,568][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:42:11,707][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:42:19,124][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:42:27,068][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:42:37,411][root][INFO] - Processing question number 90
[2025-02-21 06:42:37,417][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:42:51,800][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:43:05,731][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:43:37,091][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:43:42,922][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:43:49,466][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:43:58,817][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:44:12,660][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:44:22,698][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:44:34,231][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:45:05,657][root][INFO] - Inference complete
[2025-02-21 06:45:05,657][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,664][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,665][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:45:05,665][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,666][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:45:05,667][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,668][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:45:05,668][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,668][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:45:05,668][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 06:45:05,669][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:45:05,669][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:45:05,670][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:45:05,670][root][ERROR] - |Q. 87||D: Contracts| Failed to extract chosen option: 
[2025-02-21 06:45:05,671][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:45:05,671][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 06:45:05,671][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:45:05,671][root][ERROR] - |Q. 51||D: Evidence| Failed to extract chosen option: 
[2025-02-21 06:45:05,672][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:45:05,672][root][ERROR] - |Q. 60||D: Evidence| Failed to extract chosen option: 
[2025-02-21 06:45:05,672][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:45:05,672][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 06:45:05,674][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 06:45:05,674][root][ERROR] - |Q. 9||D: Property| Failed to extract chosen option: 
[2025-02-21 06:45:05,674][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 06:45:05,674][root][ERROR] - |Q. 17||D: Property| Failed to extract chosen option: 
[2025-02-21 06:45:05,675][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 06:45:05,675][root][ERROR] - |Q. 69||D: Property| Failed to extract chosen option: 
[2025-02-21 06:45:05,675][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 06:45:05,675][root][ERROR] - |Q. 88||D: Property| Failed to extract chosen option: 
[2025-02-21 06:45:05,676][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 06:45:05,676][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:45:05,677][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:45:05,677][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 06:45:05,678][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,683][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,683][root][INFO] - Saved parsed outputs
[2025-02-21 06:45:05,683][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,685][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,685][root][INFO] - Saved parsing metadata
[2025-02-21 06:45:05,685][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,687][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:05,697][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:45:05,724][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:45:05,724][root][INFO] - Summary of metrics : {'label_accuracy': 0.37, 'misclassification_rate': 0.63, 'combined_accuracy': 0.24, 'malformed_label': 19, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 37, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.13, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 13, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 06:45:12,716][root][INFO] - Setting global seed to 989
[2025-02-21 06:45:12,723][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:45:12,723][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:45:12,724][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:45:12,728][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:45:12,731][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:45:12,731][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:45:12,887][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:45:13,423][root][INFO] - Full model selected, loading model
[2025-02-21 06:45:32,493][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:45:32,494][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:45:39,820][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:45:39,822][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:45:39,822][root][INFO] - Starting inference
[2025-02-21 06:45:40,021][root][INFO] - Processing question number 0
[2025-02-21 06:45:40,024][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:45:51,838][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:46:03,053][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:46:15,567][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:46:25,743][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:46:33,975][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:46:44,381][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:46:58,408][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:47:07,577][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:47:18,907][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:47:27,245][root][INFO] - Processing question number 10
[2025-02-21 06:47:27,247][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:47:36,417][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:47:47,555][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:47:59,215][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:48:13,245][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:48:27,174][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:48:36,219][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:48:50,870][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:49:03,868][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:49:14,432][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:49:26,248][root][INFO] - Processing question number 20
[2025-02-21 06:49:26,250][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:49:37,460][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:49:54,115][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:50:03,510][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:50:12,849][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:50:24,556][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:50:34,282][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:50:45,803][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:51:08,247][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:51:19,377][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:51:32,838][root][INFO] - Processing question number 30
[2025-02-21 06:51:32,841][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:51:45,370][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:51:53,690][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:52:05,272][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:52:19,059][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:52:37,878][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:52:59,542][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:53:08,942][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:53:23,828][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:53:37,892][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:53:49,959][root][INFO] - Processing question number 40
[2025-02-21 06:53:49,962][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:54:02,104][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:54:14,555][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:54:29,735][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:54:41,983][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:54:56,699][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:55:05,395][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:55:14,549][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:55:24,009][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:55:32,801][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:55:42,882][root][INFO] - Processing question number 50
[2025-02-21 06:55:42,886][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:55:59,306][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:56:09,130][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:56:21,287][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:56:32,563][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:56:42,883][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:56:55,832][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:57:06,397][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:57:15,587][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:57:26,763][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:57:36,972][root][INFO] - Processing question number 60
[2025-02-21 06:57:36,977][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:57:45,682][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:58:00,339][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:58:12,565][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:58:23,049][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:58:32,774][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:58:41,725][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:58:52,216][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:58:58,741][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:59:11,738][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:59:20,040][root][INFO] - Processing question number 70
[2025-02-21 06:59:20,045][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:59:28,640][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:59:37,050][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:59:51,393][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:00:09,071][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:00:20,329][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:00:33,605][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:00:44,280][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:00:58,494][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:01:09,081][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:01:20,993][root][INFO] - Processing question number 80
[2025-02-21 07:01:20,997][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:01:28,552][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:01:38,327][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:01:55,689][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:02:07,460][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:02:17,613][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:02:26,971][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:02:40,756][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:02:53,844][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:03:03,666][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:03:24,521][root][INFO] - Processing question number 90
[2025-02-21 07:03:24,527][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:03:34,908][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:03:45,050][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:03:56,281][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:04:09,067][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:04:18,829][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:04:27,873][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:04:37,811][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:04:47,106][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:04:56,442][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:05:07,714][root][INFO] - Inference complete
[2025-02-21 07:05:07,714][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,721][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,721][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:05:07,722][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:05:07,723][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:05:07,724][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:05:07,725][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:05:07,726][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:05:07,727][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:05:07,728][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:05:07,729][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:05:07,730][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:05:07,731][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:05:07,732][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:05:07,733][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:05:07,734][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:05:07,735][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:05:07,735][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:05:07,735][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:05:07,735][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:05:07,735][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:05:07,736][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,745][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,745][root][INFO] - Saved parsed outputs
[2025-02-21 07:05:07,745][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,746][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,746][root][INFO] - Saved parsing metadata
[2025-02-21 07:05:07,747][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,748][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:05:07,760][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:05:07,772][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:05:07,772][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 55, 'both_wrong': 45}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 07:05:14,020][root][INFO] - Setting global seed to 989
[2025-02-21 07:05:14,025][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:05:14,025][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:05:14,026][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:05:14,027][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:05:14,029][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:05:14,029][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:05:14,173][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:05:14,694][root][INFO] - Full model selected, loading model
[2025-02-21 07:05:28,797][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:07:10,147][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:07:10,164][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:07:40,775][root][INFO] - Peft model loaded successfully
[2025-02-21 07:07:47,955][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:07:47,957][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:07:47,957][root][INFO] - Starting inference
[2025-02-21 07:07:48,213][root][INFO] - Processing question number 0
[2025-02-21 07:07:48,219][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:07:59,262][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:08:07,562][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:08:16,603][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:08:48,231][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:08:58,744][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:09:10,249][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:09:23,016][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:09:35,902][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:09:45,188][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:09:56,640][root][INFO] - Processing question number 10
[2025-02-21 07:09:56,642][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:10:07,261][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:10:16,004][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:10:31,082][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:10:38,081][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:10:53,144][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:11:03,358][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:11:11,330][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:11:23,144][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:11:32,606][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:11:40,221][root][INFO] - Processing question number 20
[2025-02-21 07:11:40,223][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:12:10,814][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:12:23,501][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:12:54,533][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:13:03,364][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:13:13,678][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:13:45,215][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:13:55,741][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:14:06,871][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:14:15,962][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:14:25,254][root][INFO] - Processing question number 30
[2025-02-21 07:14:25,256][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:14:34,592][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:14:41,557][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:14:47,940][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:15:19,501][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:15:28,009][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:15:59,274][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:16:07,524][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:16:15,469][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:16:23,059][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:16:35,136][root][INFO] - Processing question number 40
[2025-02-21 07:16:35,139][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:16:44,344][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:16:53,076][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:17:02,540][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:17:12,382][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:17:44,101][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:17:50,556][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:17:58,658][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:18:29,979][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:18:41,400][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:18:51,880][root][INFO] - Processing question number 50
[2025-02-21 07:18:51,884][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:19:02,042][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:19:32,890][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:19:44,657][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:19:58,203][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:20:07,977][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:20:18,339][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:20:45,144][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:20:59,752][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:21:11,032][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:21:19,683][root][INFO] - Processing question number 60
[2025-02-21 07:21:19,687][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:21:36,584][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:21:55,459][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:22:27,341][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:22:49,777][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:23:00,896][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:23:10,671][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:23:25,151][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:23:47,463][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:23:59,680][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:24:08,355][root][INFO] - Processing question number 70
[2025-02-21 07:24:08,359][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:24:21,627][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:24:32,029][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:24:50,256][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:25:05,974][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:25:17,437][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:25:24,461][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:25:35,747][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:25:43,883][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:25:58,032][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:26:07,169][root][INFO] - Processing question number 80
[2025-02-21 07:26:07,173][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:26:17,241][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:26:21,905][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:26:37,064][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:26:44,391][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:26:57,192][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:27:05,003][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:27:22,762][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:27:39,927][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:27:53,960][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:28:05,332][root][INFO] - Processing question number 90
[2025-02-21 07:28:05,337][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:28:16,762][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:28:29,433][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:28:45,005][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:28:51,467][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:28:59,653][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:29:07,321][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:29:16,094][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:29:29,864][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:30:00,703][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:30:17,813][root][INFO] - Inference complete
[2025-02-21 07:30:17,813][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,820][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,821][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract chosen option: 
[2025-02-21 07:30:17,822][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:30:17,823][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:30:17,823][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:30:17,823][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:30:17,823][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:30:17,823][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 07:30:17,824][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:30:17,824][root][ERROR] - |Q. 34||D: Contracts| Failed to extract chosen option: 
[2025-02-21 07:30:17,825][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:30:17,825][root][ERROR] - |Q. 48||D: Contracts| Failed to extract chosen option: 
[2025-02-21 07:30:17,825][root][ERROR] - |Q. 10||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:30:17,826][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:30:17,826][root][ERROR] - |Q. 31||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:30:17,826][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:30:17,826][root][ERROR] - |Q. 51||D: Evidence| Failed to extract chosen option: 
[2025-02-21 07:30:17,827][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:30:17,828][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:30:17,828][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 07:30:17,829][root][ERROR] - |Q. 69||D: Property| Failed to extract chosen option: 
[2025-02-21 07:30:17,831][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 07:30:17,831][root][ERROR] - |Q. 92||D: Torts| Failed to extract chosen option: 
[2025-02-21 07:30:17,832][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,837][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,837][root][INFO] - Saved parsed outputs
[2025-02-21 07:30:17,837][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,838][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,839][root][INFO] - Saved parsing metadata
[2025-02-21 07:30:17,839][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,841][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:17,842][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:30:17,854][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:30:17,854][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.33, 'malformed_label': 13, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.6428571428571429, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.42857142857142855, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 41, 'correct_label_wrong_domain': 15, 'both_wrong': 11}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 07:30:24,025][root][INFO] - Setting global seed to 989
[2025-02-21 07:30:24,030][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:30:24,030][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:30:24,031][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:30:24,032][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:30:24,034][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:30:24,034][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:30:24,190][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:30:24,710][root][INFO] - Full model selected, loading model
[2025-02-21 07:30:43,904][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:30:43,904][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:30:51,288][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:30:51,290][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:30:51,290][root][INFO] - Starting inference
[2025-02-21 07:30:51,480][root][INFO] - Processing question number 0
[2025-02-21 07:30:51,491][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:31:02,024][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:31:16,344][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:31:32,383][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:31:40,750][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:31:49,428][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:32:01,872][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:32:12,639][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:32:21,564][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:32:32,984][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:32:42,276][root][INFO] - Processing question number 10
[2025-02-21 07:32:42,278][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:32:51,442][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:33:01,881][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:33:13,689][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:33:27,596][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:33:43,776][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:33:55,040][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:34:05,298][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:34:16,963][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:34:31,510][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:34:44,226][root][INFO] - Processing question number 20
[2025-02-21 07:34:44,229][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:34:53,776][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:35:03,303][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:35:16,172][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:35:25,929][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:35:36,633][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:35:46,583][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:35:57,565][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:36:10,717][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:36:18,664][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:36:29,645][root][INFO] - Processing question number 30
[2025-02-21 07:36:29,648][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:36:44,906][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:36:54,873][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:37:14,656][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:37:27,588][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:37:47,229][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:38:09,383][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:38:22,254][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:38:39,826][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:38:54,711][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:39:06,174][root][INFO] - Processing question number 40
[2025-02-21 07:39:06,177][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:39:13,791][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:39:28,351][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:39:49,155][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:40:01,694][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:40:22,111][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:40:29,788][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:40:39,164][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:40:49,250][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:41:00,063][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:41:13,195][root][INFO] - Processing question number 50
[2025-02-21 07:41:13,198][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:41:24,198][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:41:38,214][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:41:50,067][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:42:01,482][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:42:13,121][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:42:21,795][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:42:34,118][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:42:48,254][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:43:04,904][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:43:14,400][root][INFO] - Processing question number 60
[2025-02-21 07:43:14,404][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:43:24,871][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:43:39,799][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:43:50,085][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:44:01,452][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:44:09,104][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:44:21,213][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:44:32,628][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:44:47,816][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:44:57,237][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:45:09,313][root][INFO] - Processing question number 70
[2025-02-21 07:45:09,318][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:45:19,985][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:45:26,731][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:45:41,297][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:45:56,944][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:46:07,998][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:46:19,060][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:46:30,640][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:46:44,304][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:46:53,111][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:47:04,417][root][INFO] - Processing question number 80
[2025-02-21 07:47:04,425][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:47:12,389][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:47:21,837][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:47:33,362][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:47:46,634][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:48:00,966][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:48:11,895][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:48:25,031][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:48:34,455][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:48:44,510][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:48:55,375][root][INFO] - Processing question number 90
[2025-02-21 07:48:55,380][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:49:06,699][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:49:15,868][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:49:25,094][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:49:37,682][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:49:48,329][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:49:58,498][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:50:08,870][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:50:19,129][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:50:31,898][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:50:42,855][root][INFO] - Inference complete
[2025-02-21 07:50:42,855][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,861][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,862][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:50:42,862][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:50:42,863][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:50:42,864][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:50:42,865][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:50:42,866][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:50:42,867][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:50:42,868][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:50:42,869][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:50:42,870][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:50:42,871][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:50:42,872][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:50:42,873][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:50:42,874][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:50:42,875][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:50:42,876][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:50:42,876][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:50:42,877][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,882][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,882][root][INFO] - Saved parsed outputs
[2025-02-21 07:50:42,882][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,883][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,883][root][INFO] - Saved parsing metadata
[2025-02-21 07:50:42,884][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,885][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:50:42,887][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:50:42,900][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:50:42,900][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 53, 'both_wrong': 47}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 07:50:50,398][root][INFO] - Setting global seed to 989
[2025-02-21 07:50:50,404][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:50:50,404][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:50:50,406][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:50:50,408][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:50:50,410][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:50:50,411][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:50:50,558][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:50:51,080][root][INFO] - Full model selected, loading model
[2025-02-21 07:51:06,044][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:52:48,465][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:52:48,483][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:53:20,800][root][INFO] - Peft model loaded successfully
[2025-02-21 07:53:27,979][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:53:27,981][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:53:27,982][root][INFO] - Starting inference
[2025-02-21 07:53:28,195][root][INFO] - Processing question number 0
[2025-02-21 07:53:28,198][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:53:38,910][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:53:48,529][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:54:11,630][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:54:25,770][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:54:33,719][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:54:46,830][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:55:01,492][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:55:11,962][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:55:22,469][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:55:37,645][root][INFO] - Processing question number 10
[2025-02-21 07:55:37,647][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:55:46,504][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:55:57,531][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:56:07,592][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:56:17,344][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:56:32,769][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:56:41,835][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:56:50,206][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:56:58,990][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:57:13,499][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:57:23,870][root][INFO] - Processing question number 20
[2025-02-21 07:57:23,873][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:57:35,334][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:57:42,662][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:58:13,710][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:58:24,627][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:58:55,740][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:59:04,162][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:59:19,010][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:59:28,889][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:59:43,138][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:59:51,629][root][INFO] - Processing question number 30
[2025-02-21 07:59:51,631][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:00:02,372][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:00:08,702][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:00:16,367][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:00:25,897][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:00:37,602][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:00:49,783][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:01:00,512][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:01:09,310][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:01:20,686][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:01:35,039][root][INFO] - Processing question number 40
[2025-02-21 08:01:35,043][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:01:42,227][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:01:50,270][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:01:58,935][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:02:09,373][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:02:35,534][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:03:02,412][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:03:15,250][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:03:35,506][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:04:06,770][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:04:19,368][root][INFO] - Processing question number 50
[2025-02-21 08:04:19,372][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:04:26,167][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:04:35,740][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:04:42,232][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:05:13,739][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:05:28,288][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:05:34,944][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:05:46,082][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:06:17,605][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:06:26,934][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:06:49,171][root][INFO] - Processing question number 60
[2025-02-21 08:06:49,175][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:06:55,795][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:07:13,341][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:07:36,340][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:07:55,518][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:08:04,182][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:08:23,853][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:08:40,600][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:09:11,489][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:09:26,113][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:09:38,004][root][INFO] - Processing question number 70
[2025-02-21 08:09:38,008][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:09:46,082][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:09:55,919][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:10:05,550][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:10:11,764][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:10:20,857][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:10:30,628][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:10:41,352][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:10:55,393][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:11:04,504][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:11:35,621][root][INFO] - Processing question number 80
[2025-02-21 08:11:35,626][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:11:46,516][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:12:05,428][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:12:18,237][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:12:26,652][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:12:40,589][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:13:01,365][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:13:12,839][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:13:24,720][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:13:31,591][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:13:43,927][root][INFO] - Processing question number 90
[2025-02-21 08:13:43,933][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:13:54,509][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:14:16,221][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:14:47,849][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:14:58,644][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:15:07,337][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:15:22,979][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:15:35,675][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:15:44,956][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:15:59,652][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:16:31,505][root][INFO] - Inference complete
[2025-02-21 08:16:31,505][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,512][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,515][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:16:31,515][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract chosen option: 
[2025-02-21 08:16:31,517][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 08:16:31,517][root][ERROR] - |Q. 38||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:16:31,518][root][ERROR] - |Q. 73||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:16:31,518][root][ERROR] - |Q. 98||D: Evidence| Failed to extract chosen option: 
[2025-02-21 08:16:31,519][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:16:31,519][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 08:16:31,519][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:16:31,520][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract chosen option: 
[2025-02-21 08:16:31,521][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 08:16:31,521][root][ERROR] - |Q. 66||D: Property| Failed to extract chosen option: 
[2025-02-21 08:16:31,522][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 08:16:31,522][root][ERROR] - |Q. 52||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:16:31,523][root][ERROR] - |Q. 92||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:16:31,523][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 08:16:31,523][root][ERROR] - |Q. 95||D: Torts| Failed to extract chosen option: 
[2025-02-21 08:16:31,524][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,538][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,538][root][INFO] - Saved parsed outputs
[2025-02-21 08:16:31,538][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,543][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,543][root][INFO] - Saved parsing metadata
[2025-02-21 08:16:31,543][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,545][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:16:31,546][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:16:31,574][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 08:16:31,574][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.33, 'malformed_label': 12, 'malformed_domain': 32, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.7142857142857143, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.35714285714285715, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.14, 'Evidence_confidence': 0.12, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.12, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 16, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 28 to status running with exit code None
Eval status update completed for job 28
[2025-02-21 08:16:38,440][root][INFO] - Setting global seed to 989
[2025-02-21 08:16:38,445][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 08:16:38,445][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 08:16:38,447][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 08:16:38,449][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:16:38,451][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:16:38,451][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 08:16:38,603][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 08:16:39,223][root][INFO] - Full model selected, loading model
[2025-02-21 08:16:58,390][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:16:58,391][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:17:05,821][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:17:05,822][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:17:05,823][root][INFO] - Starting inference
[2025-02-21 08:17:06,012][root][INFO] - Processing question number 0
[2025-02-21 08:17:06,029][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 08:17:26,400][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 08:17:42,916][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 08:17:56,102][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 08:18:03,577][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 08:18:11,821][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 08:18:22,602][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 08:18:31,048][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 08:18:40,486][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 08:18:49,061][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 08:18:58,955][root][INFO] - Processing question number 10
[2025-02-21 08:18:58,957][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 08:19:14,588][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 08:19:30,152][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 08:19:41,207][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 08:19:55,562][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 08:20:06,278][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 08:20:18,743][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:20:27,948][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 08:20:42,219][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 08:20:53,533][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 08:21:08,257][root][INFO] - Processing question number 20
[2025-02-21 08:21:08,259][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 08:21:17,906][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 08:21:27,082][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:21:40,248][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 08:21:48,041][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 08:22:02,260][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 08:22:14,287][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 08:22:29,429][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 08:22:37,608][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:22:47,043][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 08:22:57,077][root][INFO] - Processing question number 30
[2025-02-21 08:22:57,079][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 08:23:09,675][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 08:23:17,721][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 08:23:32,978][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 08:23:42,398][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 08:23:55,999][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 08:24:04,870][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:24:14,451][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 08:24:33,115][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:24:42,687][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 08:24:53,407][root][INFO] - Processing question number 40
[2025-02-21 08:24:53,410][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 08:25:01,967][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 08:25:14,427][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 08:25:29,184][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 08:25:36,819][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 08:25:52,753][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 08:26:03,323][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:26:12,558][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:26:23,555][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 08:26:37,596][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 08:26:52,225][root][INFO] - Processing question number 50
[2025-02-21 08:26:52,229][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 08:27:03,749][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 08:27:22,900][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 08:27:37,974][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:27:48,809][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 08:28:02,716][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 08:28:14,176][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 08:28:25,734][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 08:28:36,718][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 08:28:45,756][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 08:28:54,699][root][INFO] - Processing question number 60
[2025-02-21 08:28:54,702][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 08:29:04,145][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 08:29:19,242][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 08:29:32,140][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 08:29:45,024][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 08:29:54,984][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 08:30:09,310][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 08:30:17,820][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 08:30:25,870][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 08:30:38,935][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 08:30:50,573][root][INFO] - Processing question number 70
[2025-02-21 08:30:50,577][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 08:31:09,392][root][INFO] - Domain : Property, Question : 9
[2025-02-21 08:31:18,176][root][INFO] - Domain : Property, Question : 17
[2025-02-21 08:31:30,259][root][INFO] - Domain : Property, Question : 25
[2025-02-21 08:31:42,790][root][INFO] - Domain : Property, Question : 30
[2025-02-21 08:31:54,349][root][INFO] - Domain : Property, Question : 36
[2025-02-21 08:32:02,663][root][INFO] - Domain : Property, Question : 46
[2025-02-21 08:32:21,035][root][INFO] - Domain : Property, Question : 53
[2025-02-21 08:32:30,920][root][INFO] - Domain : Property, Question : 59
[2025-02-21 08:32:44,129][root][INFO] - Domain : Property, Question : 66
[2025-02-21 08:32:56,147][root][INFO] - Processing question number 80
[2025-02-21 08:32:56,152][root][INFO] - Domain : Property, Question : 69
[2025-02-21 08:33:04,324][root][INFO] - Domain : Property, Question : 81
[2025-02-21 08:33:14,485][root][INFO] - Domain : Property, Question : 88
[2025-02-21 08:33:27,593][root][INFO] - Domain : Property, Question : 91
[2025-02-21 08:33:37,812][root][INFO] - Domain : Property, Question : 94
[2025-02-21 08:33:48,412][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:33:59,449][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:34:09,251][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 08:34:22,865][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 08:34:33,127][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:34:40,763][root][INFO] - Processing question number 90
[2025-02-21 08:34:40,768][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 08:34:53,250][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 08:35:02,826][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:35:12,359][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 08:35:23,954][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 08:35:39,060][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 08:35:52,286][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 08:36:10,843][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 08:36:21,112][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 08:36:29,399][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:36:37,305][root][INFO] - Inference complete
[2025-02-21 08:36:37,306][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,312][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,313][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 08:36:37,313][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 08:36:37,313][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 08:36:37,313][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 08:36:37,314][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 08:36:37,315][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 08:36:37,316][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 08:36:37,317][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 08:36:37,318][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 08:36:37,319][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 08:36:37,320][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 08:36:37,321][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 08:36:37,322][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 08:36:37,323][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 08:36:37,324][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 08:36:37,325][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 08:36:37,325][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 08:36:37,325][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 08:36:37,325][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 08:36:37,325][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 08:36:37,326][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 08:36:37,327][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,332][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,332][root][INFO] - Saved parsed outputs
[2025-02-21 08:36:37,332][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,343][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,343][root][INFO] - Saved parsing metadata
[2025-02-21 08:36:37,344][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,345][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 08:36:37,352][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 08:36:37,368][root][INFO] - Evaluation completed for markdown_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 08:36:37,368][root][INFO] - Summary of metrics : {'label_accuracy': 0.6, 'misclassification_rate': 0.4, 'combined_accuracy': 0.05, 'malformed_label': 0, 'malformed_domain': 94, 'total_predictions': 100, 'correct_predictions': 60, 'correct_label_and_domain': 5, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.02, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 55, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '28', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 28 to status completed with exit code 0
Eval status update completed for job 28
Job 28 completed at Fri Feb 21 08:36:38 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n516
Job ID: 25309363
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 08:53:29
CPU Efficiency: 9.92% of 3-17:36:30 core-walltime
Job Wall-clock time: 08:57:39
Memory Utilized: 35.34 GB
Memory Efficiency: 98.18% of 36.00 GB
