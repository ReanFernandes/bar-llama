Starting job 5 at Thu Mar  6 08:32:18 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=json_answer_first_zero_shot_structured train=json_answer_first_zero_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '5', 'training']
Updating job 5 to status training with exit code None
Status update completed for job 5
[2025-03-06 08:33:47,332][root][INFO] - Global seed set to 314
[2025-03-06 08:33:47,334][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 08:33:47,334][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 08:33:47,334][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 08:33:47,334][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:33:47,334][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 08:33:47,375][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:33:47,442][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 08:33:47,484][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 08:33:47,488][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 08:33:48,596][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 08:34:08,558][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 08:34:42,314][root][INFO] - Model prepared for kbit training
[2025-03-06 08:34:42,315][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'v_proj', 'up_proj', 'k_proj', 'down_proj', 'gate_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 08:34:44,198][root][INFO] - Lora adapter added to model
[2025-03-06 08:34:44,201][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_answer_first_zero_shot_structured
[2025-03-06 08:34:44,564][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4643, 'grad_norm': 0.14163722097873688, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.3223, 'grad_norm': 0.17989102005958557, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.2083, 'grad_norm': 0.1842564344406128, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1171, 'grad_norm': 0.2264162302017212, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.9532, 'grad_norm': 0.2324618697166443, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 359.1148, 'train_samples_per_second': 0.292, 'train_steps_per_second': 0.042, 'train_loss': 1.2130399862925212, 'epoch': 15.0}
[2025-03-06 08:40:46,837][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_answer_first_zero_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '5', 'trained', '0']
Updating job 5 to status trained with exit code 0
Status update completed for job 5
Starting evaluations for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 08:40:57,320][root][INFO] - Setting global seed to 206
[2025-03-06 08:40:57,325][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 08:40:57,326][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:40:57,327][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 08:40:57,330][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:40:57,331][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 08:40:57,332][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 08:40:57,483][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 08:40:57,754][root][INFO] - Full model selected, loading model
[2025-03-06 08:41:09,412][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 08:42:12,193][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 08:42:12,193][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 08:42:37,610][root][INFO] - Peft model loaded successfully
[2025-03-06 08:42:43,708][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 08:42:43,710][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 08:42:43,710][root][INFO] - Starting inference
[2025-03-06 08:42:43,932][root][INFO] - Processing question number 0
[2025-03-06 08:42:43,935][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 08:43:05,589][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 08:43:32,693][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 08:43:59,418][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 08:44:25,045][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 08:44:51,672][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 08:45:18,259][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 08:45:38,229][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 08:46:05,100][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 08:46:31,628][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 08:46:48,690][root][INFO] - Processing question number 10
[2025-03-06 08:46:48,691][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 08:47:17,127][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 08:47:43,402][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 08:47:55,482][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 08:48:22,877][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 08:48:50,250][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 08:49:16,594][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 08:49:25,161][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 08:49:51,926][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 08:50:00,304][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 08:50:21,702][root][INFO] - Processing question number 20
[2025-03-06 08:50:21,704][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 08:50:30,586][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 08:50:41,341][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 08:51:07,693][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 08:51:33,975][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 08:51:52,550][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 08:52:05,991][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 08:52:17,214][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 08:52:31,337][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 08:52:39,663][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 08:52:51,371][root][INFO] - Processing question number 30
[2025-03-06 08:52:51,388][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 08:53:10,805][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 08:53:38,183][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 08:53:51,874][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 08:54:04,646][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 08:54:31,231][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 08:54:58,541][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 08:55:19,196][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 08:55:39,073][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 08:55:56,532][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 08:56:19,827][root][INFO] - Processing question number 40
[2025-03-06 08:56:19,829][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 08:56:39,516][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 08:57:06,423][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 08:57:28,141][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 08:57:55,481][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 08:58:08,132][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 08:58:21,166][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 08:58:44,321][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 08:58:53,410][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 08:59:06,170][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 08:59:27,089][root][INFO] - Processing question number 50
[2025-03-06 08:59:27,092][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 08:59:41,049][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 08:59:55,853][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:00:22,035][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:00:37,093][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:00:44,410][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:00:59,966][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:01:14,902][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:01:22,790][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:01:50,237][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:02:18,411][root][INFO] - Processing question number 60
[2025-03-06 09:02:18,419][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:02:29,843][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:02:56,560][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:03:07,805][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:03:24,150][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:03:36,105][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:03:47,162][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:03:56,143][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:04:19,700][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:04:30,229][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:04:40,864][root][INFO] - Processing question number 70
[2025-03-06 09:04:40,886][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:04:57,901][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:05:06,658][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:05:18,864][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:05:36,347][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:05:49,527][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:06:01,594][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:06:15,227][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:06:34,870][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:06:53,839][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:07:20,509][root][INFO] - Processing question number 80
[2025-03-06 09:07:20,513][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:07:47,593][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:08:14,665][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:08:41,285][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:08:55,007][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:09:22,421][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:09:49,582][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:10:16,872][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:10:43,467][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:11:07,805][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:11:17,105][root][INFO] - Processing question number 90
[2025-03-06 09:11:17,169][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:11:24,770][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:11:50,596][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:11:59,051][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:12:25,096][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:12:45,671][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:13:11,980][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:13:22,045][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:13:37,450][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:13:51,014][root][INFO] - Inference complete
[2025-03-06 09:13:51,014][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,020][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,021][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,022][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,022][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,023][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,023][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:13:51,023][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,024][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,024][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,024][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,025][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,025][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,025][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,026][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,026][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,026][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,028][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,028][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:13:51,028][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,028][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,029][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,029][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,029][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,030][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,030][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,030][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,030][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,030][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,031][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,031][root][WARNING] - |Q. 58||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:13:51,031][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,031][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,032][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:13:51,032][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,032][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,032][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,033][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,033][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,033][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:13:51,033][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,033][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,034][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,034][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,034][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,035][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,035][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,036][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,037][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,037][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,039][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,040][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,040][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,040][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,040][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,041][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,041][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,041][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,041][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,042][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,042][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,042][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,043][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:13:51,043][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:13:51,043][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:13:51,045][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,056][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,056][root][INFO] - Saved parsed outputs
[2025-03-06 09:13:51,056][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,106][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,106][root][INFO] - Saved parsing metadata
[2025-03-06 09:13:51,107][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,140][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:13:51,147][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:13:51,314][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 09:13:51,314][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 09:13:58,785][root][INFO] - Setting global seed to 206
[2025-03-06 09:13:58,792][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 09:13:58,792][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:13:58,793][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:13:58,795][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:13:58,797][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:13:58,797][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:13:58,984][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 09:13:59,264][root][INFO] - Full model selected, loading model
[2025-03-06 09:14:17,096][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 09:14:17,096][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 09:14:23,429][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:14:23,431][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:14:23,431][root][INFO] - Starting inference
[2025-03-06 09:14:23,593][root][INFO] - Processing question number 0
[2025-03-06 09:14:23,625][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:14:49,799][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:15:16,869][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:15:43,505][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:16:10,567][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:16:22,520][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:16:48,993][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:17:16,177][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:17:41,614][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:18:08,054][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:18:35,091][root][INFO] - Processing question number 10
[2025-03-06 09:18:35,126][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:19:03,452][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:19:29,617][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:19:56,321][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:20:23,626][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:20:50,830][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:21:17,072][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:21:43,222][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:22:09,898][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:22:36,551][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:23:02,979][root][INFO] - Processing question number 20
[2025-03-06 09:23:03,008][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:23:29,634][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:23:56,442][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:24:22,667][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:24:48,839][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:25:15,745][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:25:42,429][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:26:09,881][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:26:36,529][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:27:03,297][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:27:29,394][root][INFO] - Processing question number 30
[2025-03-06 09:27:29,403][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:27:56,374][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:28:23,590][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:28:50,359][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:29:16,958][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:29:28,903][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:29:56,068][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:30:22,708][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:30:49,689][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:31:16,442][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:31:44,023][root][INFO] - Processing question number 40
[2025-03-06 09:31:44,053][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:32:10,925][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:32:37,806][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:33:05,172][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:33:32,412][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:33:59,006][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:34:25,856][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:34:53,939][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:35:19,899][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:35:46,617][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:36:14,004][root][INFO] - Processing question number 50
[2025-03-06 09:36:14,021][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:36:41,529][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:37:08,490][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:37:34,639][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:38:02,530][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:38:29,424][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:38:55,378][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:39:22,894][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:39:49,231][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:40:16,613][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:40:44,696][root][INFO] - Processing question number 60
[2025-03-06 09:40:44,713][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:41:11,002][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:41:37,694][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:42:04,952][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:42:17,202][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:42:43,966][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:43:10,842][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:43:22,427][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:43:49,572][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:44:16,539][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:44:43,976][root][INFO] - Processing question number 70
[2025-03-06 09:44:43,989][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:45:10,620][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:45:37,292][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:46:03,841][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:46:30,939][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:46:57,974][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:47:24,351][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:47:51,499][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:48:18,504][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:48:45,634][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:48:57,467][root][INFO] - Processing question number 80
[2025-03-06 09:48:57,472][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:49:24,516][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:49:47,703][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:50:14,271][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:50:40,890][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:51:08,253][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:51:24,761][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:51:51,915][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:52:18,484][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:52:45,461][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:53:11,705][root][INFO] - Processing question number 90
[2025-03-06 09:53:11,710][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:53:39,381][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:54:05,185][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:54:31,867][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:54:57,783][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:55:24,960][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:55:51,205][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:56:17,802][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:56:44,697][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:57:12,037][root][INFO] - Inference complete
[2025-03-06 09:57:12,037][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,043][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,048][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,049][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,049][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,050][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,050][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,051][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,051][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,052][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,052][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,052][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,052][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,053][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,053][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,053][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,054][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,054][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,054][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,054][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,055][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,055][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,056][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,056][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,056][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,057][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,057][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,057][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,057][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,058][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,058][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,058][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,059][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,059][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,059][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,061][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,061][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,061][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,063][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,063][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,063][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,063][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,064][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,064][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,065][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,065][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,065][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,067][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,067][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,067][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,068][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,068][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,069][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,069][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,069][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,070][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,070][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,070][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,070][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,071][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,071][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 09:57:12,071][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,071][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,071][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,071][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,072][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,072][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,072][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,072][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:57:12,073][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:57:12,073][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:57:12,074][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,079][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,079][root][INFO] - Saved parsed outputs
[2025-03-06 09:57:12,079][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,081][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,081][root][INFO] - Saved parsing metadata
[2025-03-06 09:57:12,081][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,118][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:57:12,120][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:57:12,168][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 09:57:12,169][root][INFO] - Summary of metrics : {'label_accuracy': 0.3838383838383838, 'misclassification_rate': 0.6161616161616161, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 38, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 38, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 09:57:19,572][root][INFO] - Setting global seed to 206
[2025-03-06 09:57:19,577][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:57:19,577][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:57:19,579][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:57:19,580][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:57:19,582][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:57:19,582][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:57:19,820][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 09:57:20,116][root][INFO] - Full model selected, loading model
[2025-03-06 09:57:37,577][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:58:39,061][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:58:39,061][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:59:05,375][root][INFO] - Peft model loaded successfully
[2025-03-06 09:59:11,449][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:59:11,451][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:59:11,451][root][INFO] - Starting inference
[2025-03-06 09:59:11,610][root][INFO] - Processing question number 0
[2025-03-06 09:59:11,613][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:59:23,554][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:59:50,816][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:00:17,672][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:00:37,668][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:00:49,473][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:01:07,001][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:01:15,518][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:01:35,126][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:02:01,825][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:02:29,140][root][INFO] - Processing question number 10
[2025-03-06 10:02:29,142][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:02:49,168][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:03:01,373][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:03:24,999][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:03:52,582][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:04:20,137][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:04:30,503][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:04:38,910][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:04:49,692][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:04:57,047][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:05:13,614][root][INFO] - Processing question number 20
[2025-03-06 10:05:13,616][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:05:33,263][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:06:00,360][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:06:26,873][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:06:53,322][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:07:08,097][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:07:20,794][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:07:31,876][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:07:58,792][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:08:07,336][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:08:33,683][root][INFO] - Processing question number 30
[2025-03-06 10:08:33,685][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:08:53,282][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:09:20,835][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:09:47,896][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:10:02,485][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:10:15,686][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:10:32,677][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:10:55,962][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:11:17,210][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:11:29,928][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:11:51,786][root][INFO] - Processing question number 40
[2025-03-06 10:11:51,789][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:12:05,269][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:12:26,694][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:12:51,835][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:13:19,379][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:13:32,355][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:13:44,732][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:14:13,014][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:14:39,185][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:14:51,766][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:15:05,004][root][INFO] - Processing question number 50
[2025-03-06 10:15:05,007][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:15:32,752][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:15:46,780][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:16:05,974][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:16:34,065][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:16:42,290][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:17:08,470][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:17:36,170][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:18:02,786][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:18:18,151][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:18:46,504][root][INFO] - Processing question number 60
[2025-03-06 10:18:46,507][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:19:00,629][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:19:12,091][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:19:23,136][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:19:35,337][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:19:47,368][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:20:07,353][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:20:16,389][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:20:37,793][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:21:03,261][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:21:12,628][root][INFO] - Processing question number 70
[2025-03-06 10:21:12,631][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:21:26,807][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:21:37,861][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:21:54,136][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:22:21,467][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:22:36,430][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:22:49,575][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:23:16,963][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:23:33,120][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:23:49,169][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:24:14,994][root][INFO] - Processing question number 80
[2025-03-06 10:24:14,998][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:24:42,249][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:25:04,115][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:25:16,575][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:25:28,703][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:25:48,353][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:26:10,406][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:26:25,916][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:26:52,683][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:27:08,362][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:27:19,063][root][INFO] - Processing question number 90
[2025-03-06 10:27:19,067][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:27:32,790][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:27:40,751][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:27:50,708][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:28:00,593][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:28:28,060][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:28:54,544][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:29:21,364][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:29:41,427][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:29:53,763][root][INFO] - Inference complete
[2025-03-06 10:29:53,764][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,770][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,771][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,772][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,773][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,773][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,774][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,774][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,774][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,774][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,774][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,775][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,776][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,776][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,776][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,776][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,777][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,777][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,777][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,777][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,779][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,779][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,779][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,780][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,780][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,780][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,781][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,781][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,781][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,782][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,782][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,782][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,783][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,784][root][WARNING] - |Q. 76||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,784][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,784][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,784][root][WARNING] - |Q. 90||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,784][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,785][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,785][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,785][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,786][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,786][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,786][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,787][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,788][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,788][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,788][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,788][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,788][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,789][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,789][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,789][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,790][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,790][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,790][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,790][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,791][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,791][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,791][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,791][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:29:53,791][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,791][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,792][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,792][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,793][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:29:53,793][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:29:53,793][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:29:53,795][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,799][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,799][root][INFO] - Saved parsed outputs
[2025-03-06 10:29:53,799][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,801][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,801][root][INFO] - Saved parsing metadata
[2025-03-06 10:29:53,802][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,803][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:29:53,804][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:29:53,817][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 10:29:53,818][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 1, 'malformed_domain': 98, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 63}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 10:30:00,470][root][INFO] - Setting global seed to 206
[2025-03-06 10:30:00,475][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:30:00,475][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:30:00,476][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:30:00,478][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:30:00,481][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:30:00,481][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:30:00,638][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:30:00,907][root][INFO] - Full model selected, loading model
[2025-03-06 10:30:18,898][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:30:18,898][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:30:25,178][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:30:25,180][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:30:25,180][root][INFO] - Starting inference
[2025-03-06 10:30:25,346][root][INFO] - Processing question number 0
[2025-03-06 10:30:25,348][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:30:51,570][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:31:18,677][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:31:45,423][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:32:12,692][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:32:26,424][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:32:41,664][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:33:09,058][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:33:26,974][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:33:35,218][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:34:02,435][root][INFO] - Processing question number 10
[2025-03-06 10:34:02,437][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:34:30,983][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:34:57,345][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:35:24,243][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:35:51,751][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:36:19,154][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:36:30,581][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:36:56,923][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:37:03,998][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:37:30,836][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:37:57,446][root][INFO] - Processing question number 20
[2025-03-06 10:37:57,448][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:38:03,518][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:38:09,953][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:38:18,813][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:38:45,165][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:39:03,153][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:39:16,019][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:39:43,668][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:39:49,254][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:40:16,201][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:40:25,816][root][INFO] - Processing question number 30
[2025-03-06 10:40:25,818][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:40:52,980][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:41:20,396][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:41:47,365][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:42:14,133][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:42:21,778][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:42:29,155][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:42:55,923][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:43:23,101][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:43:50,084][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:44:17,765][root][INFO] - Processing question number 40
[2025-03-06 10:44:17,768][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:44:44,804][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:45:11,823][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:45:39,341][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:46:06,729][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:46:33,438][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:47:00,389][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:47:28,578][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:47:47,978][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:48:14,824][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:48:42,381][root][INFO] - Processing question number 50
[2025-03-06 10:48:42,385][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:49:10,086][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:49:18,426][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:49:44,734][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:50:12,772][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:50:39,842][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:51:05,924][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:51:12,998][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:51:39,476][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:52:07,013][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:52:35,246][root][INFO] - Processing question number 60
[2025-03-06 10:52:35,250][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:53:01,687][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:53:28,504][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:53:55,871][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:54:22,262][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:54:41,677][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:55:08,657][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:55:35,693][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:56:02,979][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:56:30,066][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:56:57,706][root][INFO] - Processing question number 70
[2025-03-06 10:56:57,710][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:57:24,478][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:57:51,298][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:58:17,998][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:58:45,240][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:59:12,439][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:59:38,964][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:00:06,268][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:00:25,037][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:00:52,339][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:01:19,104][root][INFO] - Processing question number 80
[2025-03-06 11:01:19,108][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:01:46,313][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:02:09,611][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:02:36,314][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:03:03,053][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:03:30,508][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:03:57,693][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:04:24,865][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:04:51,426][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:05:18,416][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:05:44,657][root][INFO] - Processing question number 90
[2025-03-06 11:05:44,661][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:06:03,475][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:06:16,130][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:06:42,816][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:07:08,769][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:07:35,943][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:08:02,194][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:08:10,304][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:08:34,880][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:08:44,600][root][INFO] - Inference complete
[2025-03-06 11:08:44,601][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,607][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,609][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,609][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,609][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,610][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,610][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,611][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,611][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,612][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,612][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,612][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,612][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,612][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,613][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,613][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,613][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,613][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,613][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,613][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,614][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,615][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,615][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,616][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,616][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,616][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,617][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,618][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,618][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,618][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,618][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,619][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,620][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,620][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,620][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,623][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,624][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,624][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,624][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,624][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,624][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,625][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,625][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,626][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,627][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,627][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,627][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,627][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,628][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,628][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,628][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,628][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,629][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,629][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,630][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,630][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,630][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,630][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,630][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,631][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,631][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,631][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,631][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,631][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,632][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,632][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,632][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:08:44,632][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,633][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:08:44,633][root][WARNING] - |Q. 85||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:08:44,633][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:08:44,634][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,638][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,638][root][INFO] - Saved parsed outputs
[2025-03-06 11:08:44,638][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,639][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,640][root][INFO] - Saved parsing metadata
[2025-03-06 11:08:44,640][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,642][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:08:44,643][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:08:44,680][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 11:08:44,680][root][INFO] - Summary of metrics : {'label_accuracy': 0.37373737373737376, 'misclassification_rate': 0.6262626262626263, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 37, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 37, 'both_wrong': 62}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 11:08:51,413][root][INFO] - Setting global seed to 206
[2025-03-06 11:08:51,419][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:08:51,419][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:08:51,420][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:08:51,422][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:08:51,424][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:08:51,424][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:08:51,610][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:08:51,862][root][INFO] - Full model selected, loading model
[2025-03-06 11:09:09,863][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:10:09,483][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:10:09,483][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:10:35,468][root][INFO] - Peft model loaded successfully
[2025-03-06 11:10:41,479][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:10:41,481][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:10:41,482][root][INFO] - Starting inference
[2025-03-06 11:10:41,641][root][INFO] - Processing question number 0
[2025-03-06 11:10:41,643][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:11:00,419][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:11:14,537][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:11:30,140][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:11:45,932][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:12:12,313][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:12:38,878][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:13:06,227][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:13:20,536][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:13:34,109][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:13:58,954][root][INFO] - Processing question number 10
[2025-03-06 11:13:58,955][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:14:19,186][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:14:38,114][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:15:04,931][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:15:16,289][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:15:38,433][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:16:04,785][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:16:31,058][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:16:57,816][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:17:10,622][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:17:37,133][root][INFO] - Processing question number 20
[2025-03-06 11:17:37,135][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:17:47,568][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:18:02,608][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:18:28,947][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:18:37,601][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:19:04,597][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:19:18,382][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:19:34,477][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:19:44,226][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:19:53,147][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:20:19,314][root][INFO] - Processing question number 30
[2025-03-06 11:20:19,317][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:20:27,342][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:20:46,315][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:20:55,838][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:21:06,481][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:21:17,417][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:21:44,739][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:21:56,359][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:22:23,409][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:22:38,730][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:23:06,289][root][INFO] - Processing question number 40
[2025-03-06 11:23:06,291][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:23:19,801][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:23:36,152][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:24:03,564][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:24:30,907][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:24:51,307][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:25:18,199][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:25:39,017][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:25:50,045][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:26:00,578][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:26:28,020][root][INFO] - Processing question number 50
[2025-03-06 11:26:28,023][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:26:46,776][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:27:00,874][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:27:09,434][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:27:37,349][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:27:50,499][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:28:16,515][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:28:44,077][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:28:52,307][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:29:19,749][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:29:42,790][root][INFO] - Processing question number 60
[2025-03-06 11:29:42,793][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:29:53,140][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:30:07,471][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:30:25,872][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:30:52,164][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:31:04,117][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:31:19,994][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:31:29,365][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:31:56,557][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:32:19,570][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:32:40,485][root][INFO] - Processing question number 70
[2025-03-06 11:32:40,489][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:32:54,863][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:33:21,596][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:33:39,323][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:34:00,055][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:34:20,476][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:34:46,966][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:35:08,634][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:35:35,705][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:35:55,699][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:36:22,398][root][INFO] - Processing question number 80
[2025-03-06 11:36:22,402][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:36:49,495][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:37:07,298][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:37:20,430][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:37:32,755][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:38:00,200][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:38:12,970][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:38:24,637][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:38:38,469][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:39:00,734][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:39:27,087][root][INFO] - Processing question number 90
[2025-03-06 11:39:27,090][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:39:54,909][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:40:02,557][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:40:29,294][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:40:55,380][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:41:15,491][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:41:29,884][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:41:56,547][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:42:09,034][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:42:18,965][root][INFO] - Inference complete
[2025-03-06 11:42:18,966][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:18,971][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:18,972][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,972][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,972][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,973][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,973][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,974][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,975][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,975][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,975][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,976][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,976][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,976][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,976][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,976][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,976][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,977][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,977][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,977][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,978][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,978][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,978][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,979][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,979][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,979][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,979][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,980][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,980][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,980][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,980][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,980][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,981][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,981][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,981][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,981][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,981][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,981][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,982][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,982][root][WARNING] - |Q. 38||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,982][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,982][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,982][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,983][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,983][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,983][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,983][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,984][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,984][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,984][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,984][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,985][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,985][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,985][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,985][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,986][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,986][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,986][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,986][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,986][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,986][root][WARNING] - |Q. 41||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,987][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,987][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,987][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,987][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,987][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,987][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,988][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,988][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,988][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,988][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,988][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,988][root][WARNING] - |Q. 76||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,988][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,989][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,989][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,989][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,989][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,990][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,990][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,990][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,990][root][WARNING] - |Q. 5||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,990][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,991][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,991][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,991][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,991][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,992][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,992][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,992][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,993][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,993][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,993][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,993][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,993][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,994][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,994][root][WARNING] - |Q. 86||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,994][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,994][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,995][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:42:18,995][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,995][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,996][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,996][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,996][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,996][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,996][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,996][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,997][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,997][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,997][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,997][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,997][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,998][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,998][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,998][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,998][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,999][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,999][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:18,999][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:18,999][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:18,999][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:19,000][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:19,000][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:19,000][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:19,001][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:19,001][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:19,001][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:19,001][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:42:19,002][root][WARNING] - |Q. 80||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:42:19,002][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:42:19,003][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,008][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,008][root][INFO] - Saved parsed outputs
[2025-03-06 11:42:19,008][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,010][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,010][root][INFO] - Saved parsing metadata
[2025-03-06 11:42:19,011][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,012][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:19,013][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:42:19,043][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 11:42:19,043][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 10, 'malformed_domain': 90, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.020202020202020204, 'Contracts_confidence': 0.06060606060606061, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.010101010101010102, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 6, 'correct_label_wrong_domain': 26, 'both_wrong': 64}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 11:42:27,132][root][INFO] - Setting global seed to 206
[2025-03-06 11:42:27,138][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:42:27,139][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:42:27,140][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:42:27,142][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:42:27,146][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:42:27,146][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:42:27,293][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:42:27,556][root][INFO] - Full model selected, loading model
[2025-03-06 11:42:45,978][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:42:45,991][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:42:52,303][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:42:52,304][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:42:52,304][root][INFO] - Starting inference
[2025-03-06 11:42:52,434][root][INFO] - Processing question number 0
[2025-03-06 11:42:52,436][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:43:03,541][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:43:07,748][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:43:16,293][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:43:43,362][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:43:59,694][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:44:26,260][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:44:30,246][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:44:43,871][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:44:44,472][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:44:51,595][root][INFO] - Processing question number 10
[2025-03-06 11:44:51,596][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:45:19,958][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:45:46,292][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:45:54,249][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:46:21,699][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:46:24,249][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:46:50,636][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:47:16,964][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:47:43,800][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:47:53,152][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:48:19,730][root][INFO] - Processing question number 20
[2025-03-06 11:48:19,732][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:48:46,527][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:49:13,466][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:49:19,180][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:49:45,509][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:49:49,980][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:49:54,096][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:50:21,712][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:50:48,522][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:51:15,431][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:51:19,328][root][INFO] - Processing question number 30
[2025-03-06 11:51:19,330][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:51:31,056][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:51:53,374][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:52:20,285][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:52:36,092][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:53:02,734][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:53:30,021][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:53:56,731][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:54:23,831][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:54:35,388][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:55:02,987][root][INFO] - Processing question number 40
[2025-03-06 11:55:02,990][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:55:14,694][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:55:41,615][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:55:45,992][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:55:50,288][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:55:56,088][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:56:22,992][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:56:40,687][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:56:51,137][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:57:17,940][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:57:45,424][root][INFO] - Processing question number 50
[2025-03-06 11:57:45,427][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:57:52,487][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:57:59,947][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:58:26,227][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:58:54,225][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:59:21,251][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:59:29,644][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:59:39,003][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:59:39,468][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:00:06,957][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:00:35,158][root][INFO] - Processing question number 60
[2025-03-06 12:00:35,161][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:01:01,545][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:01:06,656][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:01:33,981][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:02:00,342][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:02:06,959][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:02:33,911][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:02:40,800][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:03:08,055][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:03:22,247][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:03:49,820][root][INFO] - Processing question number 70
[2025-03-06 12:03:49,824][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:04:16,550][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:04:22,675][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:04:36,225][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:04:42,305][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:05:09,469][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:05:21,900][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:05:49,165][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:05:56,386][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:06:17,947][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:06:36,351][root][INFO] - Processing question number 80
[2025-03-06 12:06:36,354][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:06:45,104][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:07:08,191][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:07:34,874][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:08:01,603][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:08:16,992][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:08:40,719][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:08:45,566][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:08:54,901][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:09:21,985][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:09:37,756][root][INFO] - Processing question number 90
[2025-03-06 12:09:37,760][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:10:03,755][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:10:15,013][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:10:41,800][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:11:07,849][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:11:11,836][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:11:38,194][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:11:46,164][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:12:13,175][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:12:21,832][root][INFO] - Inference complete
[2025-03-06 12:12:21,832][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,837][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,840][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,841][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,841][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,841][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,841][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,841][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,842][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,842][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,843][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,843][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,843][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,843][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,844][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,844][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,844][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,844][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,844][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,844][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,845][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,845][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,845][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,845][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,845][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,846][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,846][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,846][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,846][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,847][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,847][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,847][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,847][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,847][root][WARNING] - |Q. 38||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,848][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,848][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,848][root][WARNING] - |Q. 51||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,848][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,849][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,849][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,849][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,849][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,850][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,850][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,850][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,850][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,850][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,851][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,851][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,851][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,853][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,853][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,854][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,854][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,855][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,855][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,858][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,858][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,858][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,859][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,860][root][WARNING] - |Q. 86||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,860][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,860][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,860][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,860][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,860][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,861][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,861][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,861][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,861][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,861][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,862][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,862][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,862][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,863][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,863][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,863][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,863][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,864][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,864][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,864][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,864][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,865][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,865][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,865][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:21,865][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,865][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,865][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,865][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,866][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:21,866][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:21,866][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:21,868][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,872][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,872][root][INFO] - Saved parsed outputs
[2025-03-06 12:12:21,872][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,873][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,874][root][INFO] - Saved parsing metadata
[2025-03-06 12:12:21,874][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,875][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:12:21,876][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:12:21,889][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 12:12:21,889][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.0, 'malformed_label': 10, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 30, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 12:12:29,449][root][INFO] - Setting global seed to 989
[2025-03-06 12:12:29,456][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:12:29,456][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:12:29,457][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:12:29,459][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:12:29,478][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:12:29,478][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:12:29,635][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:12:29,905][root][INFO] - Full model selected, loading model
[2025-03-06 12:12:48,180][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:13:48,507][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:13:48,507][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:14:15,065][root][INFO] - Peft model loaded successfully
[2025-03-06 12:14:21,100][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:14:21,101][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:14:21,102][root][INFO] - Starting inference
[2025-03-06 12:14:21,256][root][INFO] - Processing question number 0
[2025-03-06 12:14:21,258][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:14:42,663][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:15:09,750][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:15:36,453][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:16:02,078][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:16:28,681][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:16:55,256][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:17:15,215][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:17:42,059][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:18:08,590][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:18:25,645][root][INFO] - Processing question number 10
[2025-03-06 12:18:25,647][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:18:54,094][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:19:20,366][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:19:32,449][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:19:59,855][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:20:27,224][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:20:53,574][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:21:02,137][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:21:28,904][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:21:37,283][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:21:58,680][root][INFO] - Processing question number 20
[2025-03-06 12:21:58,682][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:22:07,562][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:22:18,317][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:22:44,679][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:23:10,989][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:23:29,569][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:23:43,003][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:23:54,229][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:24:08,361][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:24:16,689][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:24:28,403][root][INFO] - Processing question number 30
[2025-03-06 12:24:28,406][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:24:47,828][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:25:15,213][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:25:28,902][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:25:41,682][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:26:08,287][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:26:35,630][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:26:56,296][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:27:16,188][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:27:33,666][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:27:56,975][root][INFO] - Processing question number 40
[2025-03-06 12:27:56,978][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:28:16,678][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:28:43,614][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:29:05,352][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:29:32,715][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:29:45,370][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:29:58,396][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:30:21,567][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:30:30,656][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:30:43,417][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:31:04,343][root][INFO] - Processing question number 50
[2025-03-06 12:31:04,346][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:31:18,294][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:31:33,099][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:31:59,278][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:32:14,331][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:32:21,644][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:32:37,192][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:32:52,122][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:33:00,008][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:33:27,447][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:33:55,621][root][INFO] - Processing question number 60
[2025-03-06 12:33:55,624][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:34:07,042][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:34:33,760][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:34:44,999][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:35:01,336][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:35:13,289][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:35:24,345][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:35:33,321][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:35:56,871][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:36:07,396][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:36:18,029][root][INFO] - Processing question number 70
[2025-03-06 12:36:18,032][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:36:35,044][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:36:43,794][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:36:56,131][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:37:13,610][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:37:26,774][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:37:38,830][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:37:52,459][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:38:12,097][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:38:31,061][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:38:57,729][root][INFO] - Processing question number 80
[2025-03-06 12:38:57,733][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:39:24,795][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:39:51,854][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:40:18,451][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:40:32,178][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:40:59,595][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:41:26,761][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:41:54,089][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:42:20,692][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:42:45,039][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:42:54,339][root][INFO] - Processing question number 90
[2025-03-06 12:42:54,343][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:43:01,943][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:43:27,766][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:43:36,217][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:44:02,223][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:44:22,782][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:44:49,086][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:44:59,148][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:45:14,541][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:45:28,101][root][INFO] - Inference complete
[2025-03-06 12:45:28,101][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,106][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,107][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,108][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,109][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,109][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,109][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:45:28,110][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,110][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,110][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,110][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,111][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,111][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,111][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,112][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,112][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,112][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,114][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,114][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:45:28,114][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,115][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,115][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,115][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,116][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,116][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,116][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,116][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,116][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,117][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,117][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,117][root][WARNING] - |Q. 58||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:45:28,117][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,118][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,118][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:45:28,118][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,118][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,119][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,119][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,119][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,119][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:45:28,119][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,120][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,120][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,120][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,121][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,121][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,121][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,123][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,123][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,123][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,126][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,126][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,126][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,126][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,127][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,127][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,127][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,127][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,128][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,128][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,128][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,128][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,129][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:45:28,129][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:45:28,129][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:45:28,131][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,135][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,135][root][INFO] - Saved parsed outputs
[2025-03-06 12:45:28,135][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,137][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,137][root][INFO] - Saved parsing metadata
[2025-03-06 12:45:28,137][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,139][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:45:28,140][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:45:28,164][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 12:45:28,164][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 12:45:41,789][root][INFO] - Setting global seed to 989
[2025-03-06 12:45:41,795][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:45:41,795][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:45:41,796][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:45:41,799][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:45:41,803][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:45:41,803][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:45:41,959][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:45:42,226][root][INFO] - Full model selected, loading model
[2025-03-06 12:45:59,086][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:45:59,087][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:46:05,388][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:46:05,390][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:46:05,390][root][INFO] - Starting inference
[2025-03-06 12:46:05,532][root][INFO] - Processing question number 0
[2025-03-06 12:46:05,534][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:46:31,528][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:46:58,556][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:47:25,115][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:47:52,113][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:48:04,054][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:48:30,493][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:48:57,642][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:49:23,042][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:49:49,434][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:50:16,438][root][INFO] - Processing question number 10
[2025-03-06 12:50:16,440][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:50:44,729][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:51:10,849][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:51:37,520][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:52:04,782][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:52:31,953][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:52:58,139][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:53:24,258][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:53:50,891][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:54:17,486][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:54:43,865][root][INFO] - Processing question number 20
[2025-03-06 12:54:43,867][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:55:10,461][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:55:37,320][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:56:03,506][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:56:29,625][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:56:56,477][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:57:23,125][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:57:50,520][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:58:17,116][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:58:43,830][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:59:09,900][root][INFO] - Processing question number 30
[2025-03-06 12:59:09,935][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:59:36,862][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:00:04,035][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:00:30,763][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:00:57,309][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:01:09,233][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:01:36,354][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:02:02,867][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:02:29,830][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:02:56,539][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:03:23,956][root][INFO] - Processing question number 40
[2025-03-06 13:03:23,959][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:03:50,720][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:04:17,471][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:04:44,720][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:05:11,853][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:05:38,351][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:06:05,096][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:06:33,045][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:06:58,869][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:07:25,486][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:07:52,767][root][INFO] - Processing question number 50
[2025-03-06 13:07:52,770][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:08:20,216][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:08:47,062][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:09:13,117][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:09:40,931][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:10:07,750][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:10:33,579][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:11:00,986][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:11:27,210][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:11:54,484][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:12:22,468][root][INFO] - Processing question number 60
[2025-03-06 13:12:22,471][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:12:48,646][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:13:15,199][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:13:42,297][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:13:54,464][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:14:21,129][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:14:47,845][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:14:59,366][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:15:26,382][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:15:53,218][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:16:20,564][root][INFO] - Processing question number 70
[2025-03-06 13:16:20,568][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:16:47,072][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:17:13,639][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:17:40,054][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:18:06,924][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:18:33,750][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:18:59,909][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:19:26,820][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:19:53,603][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:20:20,528][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:20:32,245][root][INFO] - Processing question number 80
[2025-03-06 13:20:32,269][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:20:59,063][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:21:22,039][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:21:48,372][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:22:14,743][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:22:41,871][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:22:58,220][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:23:25,144][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:23:51,475][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:24:18,207][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:24:44,226][root][INFO] - Processing question number 90
[2025-03-06 13:24:44,230][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:25:11,663][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:25:37,249][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:26:03,714][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:26:29,445][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:26:56,375][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:27:22,398][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:27:48,772][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:28:15,448][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:28:42,580][root][INFO] - Inference complete
[2025-03-06 13:28:42,581][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,587][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,591][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,591][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,591][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,592][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,592][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,593][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,594][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,594][root][WARNING] - |Q. 17||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,594][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,595][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,595][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,595][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,595][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,596][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,596][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,596][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,597][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,597][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,597][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,598][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,598][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,599][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,599][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,599][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,599][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,599][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,600][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,600][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,600][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,600][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,601][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,601][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,601][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,603][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,603][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,603][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,605][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,605][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,605][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,606][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,606][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,606][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,607][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,607][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,607][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,609][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,609][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,609][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,610][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,610][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,611][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,611][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,611][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,611][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,612][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,612][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,612][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,612][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,612][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:28:42,612][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,613][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,613][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,613][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,613][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,614][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,614][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,614][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:28:42,614][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:28:42,614][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:28:42,616][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,620][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,620][root][INFO] - Saved parsed outputs
[2025-03-06 13:28:42,620][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,621][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,622][root][INFO] - Saved parsing metadata
[2025-03-06 13:28:42,622][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,623][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:28:42,625][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:28:42,678][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 13:28:42,678][root][INFO] - Summary of metrics : {'label_accuracy': 0.3838383838383838, 'misclassification_rate': 0.6161616161616161, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 38, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 38, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 13:28:50,237][root][INFO] - Setting global seed to 989
[2025-03-06 13:28:50,242][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:28:50,243][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:28:50,244][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:28:50,245][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:28:50,249][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:28:50,249][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:28:50,422][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:28:50,735][root][INFO] - Full model selected, loading model
[2025-03-06 13:29:08,710][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:30:08,591][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:30:08,592][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:30:34,829][root][INFO] - Peft model loaded successfully
[2025-03-06 13:30:40,868][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:30:40,869][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:30:40,869][root][INFO] - Starting inference
[2025-03-06 13:30:41,019][root][INFO] - Processing question number 0
[2025-03-06 13:30:41,021][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:31:07,666][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:31:26,613][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:31:53,318][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:32:11,506][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:32:38,130][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:33:04,697][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:33:23,935][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:33:33,161][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:33:59,701][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:34:19,184][root][INFO] - Processing question number 10
[2025-03-06 13:34:19,186][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:34:47,635][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:35:13,925][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:35:31,889][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:35:59,299][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:36:10,384][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:36:36,743][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:36:56,033][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:37:10,232][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:37:21,447][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:37:35,542][root][INFO] - Processing question number 20
[2025-03-06 13:37:35,544][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:37:51,791][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:38:18,722][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:38:32,133][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:38:43,958][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:38:59,051][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:39:14,798][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:39:25,939][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:39:41,391][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:39:49,454][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:39:59,795][root][INFO] - Processing question number 30
[2025-03-06 13:39:59,797][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:40:18,545][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:40:39,992][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:41:05,943][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:41:18,820][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:41:45,416][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:42:07,043][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:42:33,726][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:42:54,205][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:43:06,522][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:43:34,082][root][INFO] - Processing question number 40
[2025-03-06 13:43:34,084][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:43:47,974][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:44:07,159][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:44:34,569][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:45:01,920][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:45:14,837][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:45:41,738][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:46:09,844][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:46:22,295][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:46:33,444][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:46:46,112][root][INFO] - Processing question number 50
[2025-03-06 13:46:46,115][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:47:13,738][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:47:25,941][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:47:52,147][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:48:08,868][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:48:16,823][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:48:42,855][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:48:58,067][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:49:06,136][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:49:33,628][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:50:01,819][root][INFO] - Processing question number 60
[2025-03-06 13:50:01,823][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:50:11,316][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:50:21,541][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:50:33,546][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:50:40,951][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:51:07,068][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:51:15,874][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:51:24,858][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:51:52,054][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:52:09,760][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:52:37,269][root][INFO] - Processing question number 70
[2025-03-06 13:52:37,272][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:52:52,292][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:53:00,750][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:53:13,999][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:53:41,148][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:53:56,227][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:54:07,996][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:54:35,210][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:55:02,266][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:55:29,472][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:55:44,890][root][INFO] - Processing question number 80
[2025-03-06 13:55:44,894][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:56:11,973][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:56:29,945][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:56:56,554][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:57:08,043][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:57:25,989][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:57:38,617][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:57:53,173][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:58:19,783][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:58:46,808][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:59:04,516][root][INFO] - Processing question number 90
[2025-03-06 13:59:04,521][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:59:32,329][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:59:41,328][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:00:08,053][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:00:34,086][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:01:01,373][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:01:19,430][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:01:30,144][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:01:57,096][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:02:07,951][root][INFO] - Inference complete
[2025-03-06 14:02:07,951][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,957][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,958][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,958][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,959][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,959][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,960][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,960][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,960][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,960][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,960][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,961][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,961][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,961][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,962][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,962][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,962][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,963][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,963][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,964][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,964][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,964][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,964][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,965][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,965][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,965][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,966][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,967][root][WARNING] - |Q. 8||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,967][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,968][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,968][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,968][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,969][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,969][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,969][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,969][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,970][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,970][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,970][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,971][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,971][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,971][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,972][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,972][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,973][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,973][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,973][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,973][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,974][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,974][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,974][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,975][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,975][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,975][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,975][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,976][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,976][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,977][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,977][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,977][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,978][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,978][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,978][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,978][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,978][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,978][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,979][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,979][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,979][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,979][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,979][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,980][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,980][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,980][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,980][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,981][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,981][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,981][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,981][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,982][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,982][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,982][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,982][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,982][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,983][root][WARNING] - |Q. 36||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,983][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,983][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,984][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,984][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,984][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,984][root][WARNING] - |Q. 80||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:02:07,984][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,984][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:02:07,985][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:02:07,985][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:02:07,986][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,991][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,991][root][INFO] - Saved parsed outputs
[2025-03-06 14:02:07,991][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,992][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,992][root][INFO] - Saved parsing metadata
[2025-03-06 14:02:07,993][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,995][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:07,996][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:02:08,018][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 14:02:08,018][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 14:02:21,820][root][INFO] - Setting global seed to 989
[2025-03-06 14:02:21,827][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:02:21,827][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:02:21,828][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:02:21,830][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:02:21,832][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:02:21,832][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:02:22,032][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:02:22,312][root][INFO] - Full model selected, loading model
[2025-03-06 14:02:39,998][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:02:39,998][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:02:46,323][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:02:46,324][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:02:46,325][root][INFO] - Starting inference
[2025-03-06 14:02:46,484][root][INFO] - Processing question number 0
[2025-03-06 14:02:46,486][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:03:12,616][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:03:39,619][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:04:06,206][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:04:33,237][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:04:45,188][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:05:11,661][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:05:38,840][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:05:56,858][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:06:23,302][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:06:50,338][root][INFO] - Processing question number 10
[2025-03-06 14:06:50,340][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:07:09,284][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:07:35,453][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:08:02,169][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:08:29,479][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:08:56,802][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:09:15,426][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:09:26,708][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:09:53,515][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:10:01,828][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:10:28,271][root][INFO] - Processing question number 20
[2025-03-06 14:10:28,273][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:10:54,913][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:11:21,725][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:11:48,002][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:12:14,183][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:12:32,052][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:12:58,744][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:13:26,206][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:13:34,301][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:14:01,085][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:14:27,188][root][INFO] - Processing question number 30
[2025-03-06 14:14:27,190][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:14:54,168][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:15:21,382][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:15:48,141][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:16:00,513][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:16:27,011][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:16:54,159][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:17:20,715][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:17:47,675][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:18:14,425][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:18:41,880][root][INFO] - Processing question number 40
[2025-03-06 14:18:41,883][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:19:08,663][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:19:35,438][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:20:02,724][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:20:29,899][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:20:56,435][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:21:23,207][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:21:51,184][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:22:17,047][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:22:43,703][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:23:11,029][root][INFO] - Processing question number 50
[2025-03-06 14:23:11,032][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:23:38,512][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:24:05,396][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:24:31,489][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:24:59,305][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:25:26,166][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:25:52,020][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:26:05,588][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:26:31,848][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:26:59,165][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:27:27,201][root][INFO] - Processing question number 60
[2025-03-06 14:27:27,204][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:27:53,435][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:28:20,049][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:28:47,215][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:29:13,418][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:29:34,407][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:30:01,185][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:30:08,628][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:30:35,704][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:31:02,604][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:31:30,008][root][INFO] - Processing question number 70
[2025-03-06 14:31:30,011][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:31:50,463][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:32:17,083][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:32:32,659][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:32:59,705][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:33:26,708][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:33:53,048][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:34:20,164][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:34:38,870][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:34:50,898][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:35:17,472][root][INFO] - Processing question number 80
[2025-03-06 14:35:17,476][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:35:44,458][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:36:07,589][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:36:34,093][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:37:00,639][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:37:17,379][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:37:44,439][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:38:11,557][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:38:37,609][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:39:04,546][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:39:30,755][root][INFO] - Processing question number 90
[2025-03-06 14:39:30,759][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:39:58,392][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:40:11,069][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:40:37,704][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:41:03,586][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:41:30,701][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:41:56,899][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:42:23,453][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:42:50,309][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:43:01,549][root][INFO] - Inference complete
[2025-03-06 14:43:01,549][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,556][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,557][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,558][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,559][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,561][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,561][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,561][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,562][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,562][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,562][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,563][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,563][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,563][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,564][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,564][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,564][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,566][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,566][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,566][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,567][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,567][root][WARNING] - |Q. 51||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,567][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,568][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,568][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,568][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,568][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,569][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,569][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,569][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,570][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,570][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,570][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,570][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,570][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,571][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,571][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,571][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,572][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,572][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,572][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,574][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,574][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,574][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,575][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,575][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,575][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,578][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,578][root][WARNING] - |Q. 86||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,578][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,579][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,579][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,579][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,579][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,580][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,580][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,580][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,581][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,581][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,582][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,582][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,582][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,582][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,583][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,583][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,583][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,583][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,583][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,584][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,584][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,584][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,584][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,584][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,584][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,585][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,585][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,585][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,585][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,585][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,586][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,586][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,586][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:43:01,586][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,586][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,586][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,587][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,587][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:43:01,587][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:43:01,587][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:43:01,589][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,593][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,593][root][INFO] - Saved parsed outputs
[2025-03-06 14:43:01,593][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,594][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,594][root][INFO] - Saved parsing metadata
[2025-03-06 14:43:01,595][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,597][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:43:01,598][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:43:01,609][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 14:43:01,609][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 14:43:08,044][root][INFO] - Setting global seed to 989
[2025-03-06 14:43:08,049][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 14:43:08,050][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:43:08,051][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:43:08,052][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:43:08,054][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:43:08,055][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:43:08,201][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:43:08,479][root][INFO] - Full model selected, loading model
[2025-03-06 14:43:25,920][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:44:26,107][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:44:26,108][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:44:50,612][root][INFO] - Peft model loaded successfully
[2025-03-06 14:44:56,675][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:44:56,677][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:44:56,677][root][INFO] - Starting inference
[2025-03-06 14:44:56,833][root][INFO] - Processing question number 0
[2025-03-06 14:44:56,835][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:45:06,461][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:45:21,246][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:45:47,979][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:46:08,383][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:46:25,198][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:46:38,704][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:47:06,092][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:47:33,000][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:47:43,115][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:48:04,782][root][INFO] - Processing question number 10
[2025-03-06 14:48:04,784][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:48:33,261][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:48:59,575][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:49:26,412][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:49:53,857][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:50:04,906][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:50:14,747][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:50:41,061][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:51:06,742][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:51:27,870][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:51:41,072][root][INFO] - Processing question number 20
[2025-03-06 14:51:41,074][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:51:56,254][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:52:23,227][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:52:49,621][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:53:01,633][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:53:19,685][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:53:32,884][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:54:00,483][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:54:18,575][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:54:28,286][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:54:38,863][root][INFO] - Processing question number 30
[2025-03-06 14:54:38,865][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:55:03,102][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:55:30,543][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:55:41,608][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:56:08,351][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:56:16,521][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:56:43,886][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:56:57,328][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:57:16,179][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:57:43,090][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:57:59,301][root][INFO] - Processing question number 40
[2025-03-06 14:57:59,304][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:58:14,986][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:58:33,460][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:58:47,959][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:59:04,371][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:59:31,015][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:59:57,934][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:00:20,444][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:00:29,630][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:00:40,960][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:01:08,426][root][INFO] - Processing question number 50
[2025-03-06 15:01:08,429][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:01:24,208][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:01:36,767][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:01:47,597][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:02:13,080][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:02:40,083][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:02:49,234][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:03:12,009][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:03:19,410][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:03:46,918][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:04:15,130][root][INFO] - Processing question number 60
[2025-03-06 15:04:15,133][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:04:25,536][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:04:35,208][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:04:50,813][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:05:17,176][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:05:27,227][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:05:39,002][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:05:48,079][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:06:15,296][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:06:24,786][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:06:41,703][root][INFO] - Processing question number 70
[2025-03-06 15:06:41,706][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:07:08,415][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:07:35,155][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:08:01,770][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:08:21,278][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:08:36,293][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:08:50,637][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:09:06,262][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:09:24,147][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:09:51,377][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:10:10,077][root][INFO] - Processing question number 80
[2025-03-06 15:10:10,088][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:10:37,197][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:11:04,316][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:11:13,685][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:11:22,254][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:11:42,667][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:12:09,858][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:12:22,864][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:12:49,500][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:13:14,900][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:13:37,170][root][INFO] - Processing question number 90
[2025-03-06 15:13:37,174][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:14:05,009][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:14:29,551][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:14:56,297][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:15:22,349][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:15:49,668][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:16:16,011][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:16:30,855][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:16:57,831][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:17:07,943][root][INFO] - Inference complete
[2025-03-06 15:17:07,943][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,951][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,952][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,952][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,953][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,953][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,954][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,954][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,954][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,954][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,955][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,955][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,955][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,955][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,956][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,956][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,956][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,957][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,957][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,957][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,957][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,957][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,957][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,958][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,958][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,958][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,959][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,959][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,959][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,959][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,960][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,960][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,960][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,960][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,960][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,961][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,961][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,961][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,961][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,962][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,962][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,962][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,962][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,962][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,963][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,963][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,963][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,963][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,963][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,964][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,964][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,964][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,964][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,965][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,965][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,965][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,965][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,966][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,966][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,966][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,966][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,966][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,967][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,967][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,967][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,968][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,968][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,968][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,968][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,968][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,968][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,969][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,969][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,969][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,969][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,969][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,970][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,970][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,970][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,970][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,971][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,971][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,971][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,971][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,972][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,972][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,972][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,972][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,972][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,973][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,973][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,973][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,973][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,974][root][WARNING] - |Q. 34||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,974][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,974][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,974][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,974][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,975][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,975][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,975][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,975][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,976][root][WARNING] - |Q. 86||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,976][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,976][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,976][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,976][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,977][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,978][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,978][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,978][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,978][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,978][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,979][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,979][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,979][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,979][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,980][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,980][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,980][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,980][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,981][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,981][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,981][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,981][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,981][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,982][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,982][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,982][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,982][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,982][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,983][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,983][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,983][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,983][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,983][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,983][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,984][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,984][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,984][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,984][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,984][root][WARNING] - |Q. 80||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:17:07,984][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,985][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:17:07,985][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:17:07,985][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:17:07,986][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,991][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,991][root][INFO] - Saved parsed outputs
[2025-03-06 15:17:07,991][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,992][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,992][root][INFO] - Saved parsing metadata
[2025-03-06 15:17:07,994][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,995][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:07,996][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:17:08,038][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 15:17:08,038][root][INFO] - Summary of metrics : {'label_accuracy': 0.24242424242424243, 'misclassification_rate': 0.7575757575757576, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 16, 'malformed_domain': 93, 'total_predictions': 99, 'correct_predictions': 24, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.030303030303030304, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 5, 'correct_label_wrong_domain': 23, 'both_wrong': 70}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 15:17:14,655][root][INFO] - Setting global seed to 989
[2025-03-06 15:17:14,660][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 15:17:14,661][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:17:14,662][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:17:14,685][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:17:14,687][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:17:14,688][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:17:14,856][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:17:15,194][root][INFO] - Full model selected, loading model
[2025-03-06 15:17:33,096][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:17:33,096][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:17:39,435][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:17:39,438][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:17:39,438][root][INFO] - Starting inference
[2025-03-06 15:17:39,584][root][INFO] - Processing question number 0
[2025-03-06 15:17:39,586][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:18:05,712][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:18:32,754][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:18:59,582][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:19:22,318][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:19:33,800][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:20:00,295][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:20:10,684][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:20:16,215][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:20:42,674][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:20:48,807][root][INFO] - Processing question number 10
[2025-03-06 15:20:48,808][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:21:17,162][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:21:26,735][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:21:53,467][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:21:54,194][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:22:21,427][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:22:47,687][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:22:58,170][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:23:08,105][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:23:34,781][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:24:01,238][root][INFO] - Processing question number 20
[2025-03-06 15:24:01,240][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:24:27,893][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:24:54,711][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:25:20,969][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:25:47,152][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:26:14,081][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:26:14,608][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:26:42,085][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:26:46,588][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:26:50,694][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:26:56,264][root][INFO] - Processing question number 30
[2025-03-06 15:26:56,267][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:27:23,266][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:27:50,503][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:28:17,292][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:28:17,685][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:28:44,206][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:28:48,183][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:29:14,769][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:29:41,749][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:30:08,521][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:30:36,019][root][INFO] - Processing question number 40
[2025-03-06 15:30:36,022][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:30:42,798][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:31:09,619][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:31:26,639][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:31:53,835][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:32:20,381][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:32:41,967][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:33:09,981][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:33:35,873][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:33:50,100][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:33:57,009][root][INFO] - Processing question number 50
[2025-03-06 15:33:57,012][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:34:24,536][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:34:31,444][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:34:57,582][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:35:25,436][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:35:52,339][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:36:18,230][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:36:45,722][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:37:12,017][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:37:39,375][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:37:51,774][root][INFO] - Processing question number 60
[2025-03-06 15:37:51,798][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:37:58,408][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:38:25,063][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:38:52,286][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:39:18,530][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:39:45,290][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:39:49,235][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:39:56,343][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:40:23,448][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:40:50,389][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:41:02,250][root][INFO] - Processing question number 70
[2025-03-06 15:41:02,254][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:41:08,374][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:41:35,025][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:42:01,555][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:42:28,633][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:42:50,232][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:43:16,613][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:43:43,745][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:44:10,721][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:44:18,333][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:44:27,942][root][INFO] - Processing question number 80
[2025-03-06 15:44:27,945][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:44:50,833][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:45:17,823][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:45:40,618][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:45:54,872][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:46:22,210][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:46:32,860][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:46:36,914][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:47:03,444][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:47:30,405][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:47:56,635][root][INFO] - Processing question number 90
[2025-03-06 15:47:56,659][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:48:24,313][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:48:37,256][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:49:03,915][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:49:29,829][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:49:37,447][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:50:03,674][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:50:30,251][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:50:57,136][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:51:05,176][root][INFO] - Inference complete
[2025-03-06 15:51:05,177][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,183][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,186][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,186][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,186][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,187][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,187][root][WARNING] - |Q. 29||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,187][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,189][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,189][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,189][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,190][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,190][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,190][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,190][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,190][root][WARNING] - |Q. 71||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,191][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,191][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,191][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,191][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,192][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,192][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,192][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,193][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,193][root][WARNING] - |Q. 38||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,193][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,193][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,193][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,193][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,194][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,194][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,194][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,195][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,195][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,195][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,195][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,195][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,195][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,196][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,196][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,196][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,197][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,197][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,197][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,198][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,198][root][WARNING] - |Q. 99||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,198][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,198][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,199][root][WARNING] - |Q. 18||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,199][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,201][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,201][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,202][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,202][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,202][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,203][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,203][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,203][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,204][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,205][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,205][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,205][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,206][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,206][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,206][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,206][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,206][root][WARNING] - |Q. 45||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:51:05,207][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,207][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,207][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,207][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,208][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:51:05,208][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:51:05,208][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:51:05,209][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,214][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,214][root][INFO] - Saved parsed outputs
[2025-03-06 15:51:05,214][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,215][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,215][root][INFO] - Saved parsing metadata
[2025-03-06 15:51:05,217][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,218][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:51:05,219][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:51:05,290][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 15:51:05,290][root][INFO] - Summary of metrics : {'label_accuracy': 0.3939393939393939, 'misclassification_rate': 0.6060606060606061, 'combined_accuracy': 0.0, 'malformed_label': 10, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 15:51:13,898][root][INFO] - Setting global seed to 206
[2025-03-06 15:51:13,905][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:51:13,905][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:51:13,906][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:51:13,908][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:51:13,912][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:51:13,912][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:51:14,093][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:51:14,339][root][INFO] - Full model selected, loading model
[2025-03-06 15:51:31,946][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:52:32,489][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:52:32,489][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:52:59,036][root][INFO] - Peft model loaded successfully
[2025-03-06 15:53:05,072][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:53:05,074][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:53:05,074][root][INFO] - Starting inference
[2025-03-06 15:53:05,252][root][INFO] - Processing question number 0
[2025-03-06 15:53:05,254][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:53:15,631][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:53:38,633][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:54:02,140][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:54:29,279][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:54:37,848][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:54:56,042][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:55:05,357][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:55:13,758][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:55:39,798][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:55:52,578][root][INFO] - Processing question number 10
[2025-03-06 15:55:52,580][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:56:18,484][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:56:45,205][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:56:56,052][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:57:22,102][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:57:41,822][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:58:08,454][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:58:16,522][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:58:31,032][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:58:44,969][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:59:12,000][root][INFO] - Processing question number 20
[2025-03-06 15:59:12,002][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:59:26,381][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:59:42,795][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:00:09,128][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:00:19,551][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:00:37,051][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:01:04,083][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:01:19,165][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:01:39,399][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:02:05,988][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:02:33,233][root][INFO] - Processing question number 30
[2025-03-06 16:02:33,235][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:02:59,918][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:03:26,455][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:03:52,927][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:04:20,114][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:04:36,882][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:04:48,589][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:05:05,245][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:05:32,529][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:05:59,318][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:06:21,066][root][INFO] - Processing question number 40
[2025-03-06 16:06:21,069][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:06:39,965][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:07:06,519][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:07:26,737][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:07:52,692][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:08:06,311][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:08:16,909][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:08:43,485][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:09:01,752][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:09:13,024][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:09:28,096][root][INFO] - Processing question number 50
[2025-03-06 16:09:28,099][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:09:47,688][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:09:56,273][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:10:07,052][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:10:25,568][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:10:51,855][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:11:18,369][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:11:29,313][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:11:41,233][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:12:04,598][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:12:21,747][root][INFO] - Processing question number 60
[2025-03-06 16:12:21,750][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:12:33,256][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:12:55,257][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:13:22,707][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:13:49,680][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:14:12,830][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:14:24,992][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:14:51,270][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:15:17,346][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:15:29,420][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:15:42,593][root][INFO] - Processing question number 70
[2025-03-06 16:15:42,597][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:15:59,398][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:16:17,489][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:16:44,462][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:17:11,927][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:17:32,019][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:17:55,859][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:18:23,755][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:18:50,696][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:19:16,662][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:19:43,060][root][INFO] - Processing question number 80
[2025-03-06 16:19:43,117][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:20:10,406][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:20:37,725][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:21:04,967][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:21:26,574][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:21:41,678][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:21:53,632][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:22:05,329][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:22:27,993][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:22:44,988][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:22:58,290][root][INFO] - Processing question number 90
[2025-03-06 16:22:58,296][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:23:25,117][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:23:49,328][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:24:16,271][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:24:26,090][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:24:53,451][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:25:16,538][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:25:33,364][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:25:44,941][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:25:57,152][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:26:24,483][root][INFO] - Inference complete
[2025-03-06 16:26:24,483][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,493][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,494][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,494][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,495][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,496][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,496][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,496][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,496][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,497][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,497][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,497][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,498][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,498][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,498][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,498][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,499][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,499][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,500][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,500][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,500][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,500][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,501][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,501][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,501][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,501][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,502][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,502][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,502][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,502][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,502][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,503][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,503][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,503][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,503][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,504][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,504][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,504][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,505][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,505][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,506][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,508][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,508][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,508][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,508][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,508][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,508][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,509][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,509][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,509][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,510][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,510][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,510][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,511][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,511][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,511][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,511][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,512][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,512][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,512][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,512][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,512][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,512][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,513][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,513][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,513][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,513][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,513][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,514][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,514][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,514][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,515][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,515][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,515][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,515][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,515][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,515][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,516][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,516][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,516][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,516][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,517][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,517][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,517][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,517][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,517][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,518][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,518][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,518][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,519][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,519][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,519][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,519][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,520][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:26:24,520][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,520][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,520][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,520][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,521][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:26:24,521][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:26:24,521][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:26:24,523][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,527][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,527][root][INFO] - Saved parsed outputs
[2025-03-06 16:26:24,527][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,529][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,529][root][INFO] - Saved parsing metadata
[2025-03-06 16:26:24,532][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,533][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:24,534][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:26:24,558][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 16:26:24,558][root][INFO] - Summary of metrics : {'label_accuracy': 0.3, 'misclassification_rate': 0.7, 'combined_accuracy': 0.0, 'malformed_label': 5, 'malformed_domain': 99, 'total_predictions': 100, 'correct_predictions': 30, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 30, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 16:26:33,904][root][INFO] - Setting global seed to 206
[2025-03-06 16:26:33,912][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:26:33,912][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:26:33,914][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:26:33,915][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:26:33,918][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:26:33,918][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:26:34,080][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:26:34,383][root][INFO] - Full model selected, loading model
[2025-03-06 16:26:52,882][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:26:52,882][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:26:58,747][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:26:58,752][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:26:58,752][root][INFO] - Starting inference
[2025-03-06 16:26:58,951][root][INFO] - Processing question number 0
[2025-03-06 16:26:58,954][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:27:25,733][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:27:53,071][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:28:20,535][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:28:47,495][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:29:13,933][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:29:39,803][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:30:06,194][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:30:32,832][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:30:58,785][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:31:25,338][root][INFO] - Processing question number 10
[2025-03-06 16:31:25,340][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:31:51,132][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:32:17,515][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:32:44,013][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:33:09,973][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:33:36,860][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:34:03,401][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:34:29,701][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:34:56,079][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:35:22,927][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:35:49,954][root][INFO] - Processing question number 20
[2025-03-06 16:35:49,956][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:36:15,807][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:36:42,461][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:37:08,640][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:37:35,021][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:38:01,463][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:38:28,401][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:38:54,909][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:39:07,581][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:39:34,092][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:40:01,156][root][INFO] - Processing question number 30
[2025-03-06 16:40:01,158][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:40:27,725][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:40:54,140][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:41:20,505][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:41:47,534][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:42:14,010][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:42:40,556][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:43:07,059][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:43:34,245][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:44:00,949][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:44:27,667][root][INFO] - Processing question number 40
[2025-03-06 16:44:27,670][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:44:54,325][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:45:20,801][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:45:47,729][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:46:13,603][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:46:40,816][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:47:07,481][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:47:34,001][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:48:00,725][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:48:27,277][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:48:36,238][root][INFO] - Processing question number 50
[2025-03-06 16:48:36,241][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:49:03,419][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:49:29,481][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:49:56,658][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:50:23,444][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:50:49,581][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:51:15,996][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:51:43,292][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:52:10,295][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:52:37,297][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:53:04,119][root][INFO] - Processing question number 60
[2025-03-06 16:53:04,122][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:53:30,720][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:53:57,403][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:54:24,744][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:54:51,616][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:55:18,406][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:55:44,752][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:56:10,884][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:56:36,874][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:57:03,200][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:57:29,414][root][INFO] - Processing question number 70
[2025-03-06 16:57:29,418][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:57:56,221][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:58:22,934][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:58:49,825][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:59:17,193][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:59:43,395][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:00:10,246][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:00:38,040][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:01:04,895][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:01:30,776][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:01:57,096][root][INFO] - Processing question number 80
[2025-03-06 17:01:57,100][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:02:24,292][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:02:51,527][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:03:18,690][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:03:45,536][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:04:13,336][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:04:39,787][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:05:06,755][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:05:34,250][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:05:52,158][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:06:18,896][root][INFO] - Processing question number 90
[2025-03-06 17:06:18,900][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:06:45,642][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:07:12,695][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:07:39,560][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:08:06,198][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:08:33,507][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:09:00,710][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:09:27,585][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:09:35,539][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:10:01,552][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:10:28,783][root][INFO] - Inference complete
[2025-03-06 17:10:28,783][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,790][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,792][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,793][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,794][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,795][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,795][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,795][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,796][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,796][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,796][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,797][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,798][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,798][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,798][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,798][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,799][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,799][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,799][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,799][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,801][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,802][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,802][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,802][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,802][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,802][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,804][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,805][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,805][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,805][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,805][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,805][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,806][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,807][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,807][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,808][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,808][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,808][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,808][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,809][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,809][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,809][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,809][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,810][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,810][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,810][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,810][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,811][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,811][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,811][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,812][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,812][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,813][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,816][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,816][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:10:28,816][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,817][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:10:28,817][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:10:28,817][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:10:28,819][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,823][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,823][root][INFO] - Saved parsed outputs
[2025-03-06 17:10:28,824][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,825][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,825][root][INFO] - Saved parsing metadata
[2025-03-06 17:10:28,826][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,830][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:10:28,831][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:10:28,885][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 17:10:28,885][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 32, 'both_wrong': 68}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 17:10:39,064][root][INFO] - Setting global seed to 206
[2025-03-06 17:10:39,072][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:10:39,072][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:10:39,073][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:10:39,076][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:10:39,078][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:10:39,079][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:10:39,240][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:10:39,583][root][INFO] - Full model selected, loading model
[2025-03-06 17:10:58,793][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:12:00,105][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:12:00,106][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:12:26,001][root][INFO] - Peft model loaded successfully
[2025-03-06 17:12:32,600][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:12:32,602][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:12:32,602][root][INFO] - Starting inference
[2025-03-06 17:12:32,790][root][INFO] - Processing question number 0
[2025-03-06 17:12:32,792][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:12:43,530][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:13:02,962][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:13:30,808][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:13:47,580][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:14:14,285][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:14:40,445][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:14:52,565][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:15:00,866][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:15:20,662][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:15:32,081][root][INFO] - Processing question number 10
[2025-03-06 17:15:32,083][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:15:58,166][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:16:24,833][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:16:41,825][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:17:08,077][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:17:35,266][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:17:52,917][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:18:03,978][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:18:19,737][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:18:31,112][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:18:58,345][root][INFO] - Processing question number 20
[2025-03-06 17:18:58,347][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:19:08,397][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:19:21,152][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:19:32,329][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:19:41,708][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:20:08,442][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:20:20,970][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:20:29,450][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:20:39,096][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:21:05,874][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:21:29,024][root][INFO] - Processing question number 30
[2025-03-06 17:21:29,026][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:21:55,863][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:22:12,223][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:22:24,017][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:22:35,763][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:22:52,394][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:23:02,656][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:23:21,817][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:23:43,610][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:23:54,387][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:24:12,624][root][INFO] - Processing question number 40
[2025-03-06 17:24:12,626][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:24:32,531][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:24:59,284][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:25:26,500][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:25:38,838][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:25:52,551][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:26:01,973][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:26:11,437][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:26:36,429][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:26:55,270][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:27:08,613][root][INFO] - Processing question number 50
[2025-03-06 17:27:08,616][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:27:31,337][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:27:39,936][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:28:07,445][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:28:29,997][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:28:42,148][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:28:51,460][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:29:03,867][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:29:15,775][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:29:28,331][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:29:55,432][root][INFO] - Processing question number 60
[2025-03-06 17:29:55,436][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:30:10,197][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:30:37,209][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:31:04,843][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:31:25,168][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:31:52,263][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:32:20,785][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:32:35,425][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:32:45,237][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:33:11,830][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:33:26,802][root][INFO] - Processing question number 70
[2025-03-06 17:33:26,806][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:33:40,986][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:34:07,958][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:34:29,754][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:34:43,679][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:35:02,954][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:35:23,003][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:35:51,080][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:36:07,400][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:36:29,846][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:36:56,443][root][INFO] - Processing question number 80
[2025-03-06 17:36:56,447][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:37:15,343][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:37:35,149][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:38:02,584][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:38:29,685][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:38:57,700][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:39:09,262][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:39:24,155][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:39:46,823][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:40:03,963][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:40:17,329][root][INFO] - Processing question number 90
[2025-03-06 17:40:17,333][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:40:44,336][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:40:58,802][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:41:25,919][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:41:36,634][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:42:00,464][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:42:21,642][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:42:37,422][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:42:46,350][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:43:06,166][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:43:33,660][root][INFO] - Inference complete
[2025-03-06 17:43:33,661][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,667][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,668][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,668][root][WARNING] - |Q. 6||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,669][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,670][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,670][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,670][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,670][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,670][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,670][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,671][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,671][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,672][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,673][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,674][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,674][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,675][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,675][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,675][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,676][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,677][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,677][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,678][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,678][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,678][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,679][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,679][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,679][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,680][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,680][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,680][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,681][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,681][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,681][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,681][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,682][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,682][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,682][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,682][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,682][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,683][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,683][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,684][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,684][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,684][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,684][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,685][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,685][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,685][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,685][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,686][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,686][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,686][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,686][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,686][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,687][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,687][root][WARNING] - |Q. 69||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,687][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,687][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,687][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,688][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,688][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,688][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,688][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,688][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,689][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,689][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,689][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,689][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,689][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,690][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,690][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:43:33,691][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,691][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,691][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,691][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,692][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:43:33,692][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:43:33,692][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:43:33,694][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,698][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,699][root][INFO] - Saved parsed outputs
[2025-03-06 17:43:33,699][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,700][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,700][root][INFO] - Saved parsing metadata
[2025-03-06 17:43:33,701][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,702][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:43:33,705][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:43:33,720][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 17:43:33,720][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 23, 'both_wrong': 77}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 17:43:44,651][root][INFO] - Setting global seed to 206
[2025-03-06 17:43:44,676][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:43:44,677][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:43:44,678][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:43:44,679][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:43:44,681][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:43:44,681][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:43:44,880][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:43:45,177][root][INFO] - Full model selected, loading model
[2025-03-06 17:44:03,325][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:44:03,325][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:44:12,552][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:44:12,556][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:44:12,556][root][INFO] - Starting inference
[2025-03-06 17:44:12,776][root][INFO] - Processing question number 0
[2025-03-06 17:44:12,778][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:44:39,870][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:45:07,391][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:45:35,025][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:46:02,142][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:46:28,721][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:46:54,753][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:47:21,307][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:47:48,096][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:48:14,205][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:48:40,923][root][INFO] - Processing question number 10
[2025-03-06 17:48:40,924][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:49:06,820][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:49:22,903][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:49:31,719][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:49:57,837][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:50:24,885][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:50:51,584][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:51:18,229][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:51:44,773][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:52:11,898][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:52:39,005][root][INFO] - Processing question number 20
[2025-03-06 17:52:39,007][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:52:47,435][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:53:14,245][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:53:40,632][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:54:07,252][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:54:33,864][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:55:00,963][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:55:09,145][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:55:36,003][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:56:02,676][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:56:29,885][root][INFO] - Processing question number 30
[2025-03-06 17:56:29,887][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:56:38,812][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:56:46,659][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:57:13,181][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:57:40,366][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:58:07,005][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:58:33,714][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:59:00,378][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:59:27,722][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:59:54,579][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:00:21,457][root][INFO] - Processing question number 40
[2025-03-06 18:00:21,460][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:00:48,269][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:01:14,909][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:01:41,999][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:02:08,037][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:02:35,401][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:02:44,316][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:03:10,969][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:03:37,778][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:03:44,735][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:03:53,752][root][INFO] - Processing question number 50
[2025-03-06 18:03:53,755][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:04:21,107][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:04:47,366][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:05:14,724][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:05:25,933][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:05:41,286][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:06:07,868][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:06:23,936][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:06:51,118][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:07:18,303][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:07:45,411][root][INFO] - Processing question number 60
[2025-03-06 18:07:45,415][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:08:12,197][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:08:19,859][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:08:47,374][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:09:14,415][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:09:41,373][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:10:07,872][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:10:19,987][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:10:46,128][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:11:12,616][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:11:38,989][root][INFO] - Processing question number 70
[2025-03-06 18:11:38,993][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:12:05,948][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:12:32,812][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:13:00,013][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:13:27,546][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:13:36,772][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:14:03,772][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:14:31,728][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:14:58,733][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:15:09,520][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:15:20,067][root][INFO] - Processing question number 80
[2025-03-06 18:15:20,072][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:15:47,420][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:16:14,808][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:16:39,324][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:17:06,316][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:17:34,241][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:18:00,839][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:18:27,964][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:18:28,555][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:18:46,568][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:18:53,645][root][INFO] - Processing question number 90
[2025-03-06 18:18:53,649][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:19:20,540][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:19:47,721][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:20:14,731][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:20:41,515][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:21:08,985][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:21:31,529][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:21:38,251][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:22:04,886][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:22:10,887][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:22:38,271][root][INFO] - Inference complete
[2025-03-06 18:22:38,271][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,278][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,281][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,281][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,282][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,283][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,283][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,283][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,284][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,284][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,284][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,285][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,285][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,285][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,288][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,288][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,288][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,289][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,289][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,289][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,290][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,291][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,291][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,294][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,294][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,294][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,295][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,295][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,295][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,296][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,296][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,296][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,296][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,297][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,297][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,297][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,297][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:22:38,297][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,298][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,298][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,298][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,298][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,299][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,299][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,300][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,300][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,300][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,302][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,302][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,302][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,303][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,303][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,303][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,304][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,304][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:22:38,304][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,304][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:22:38,305][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:22:38,305][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:22:38,306][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,311][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,311][root][INFO] - Saved parsed outputs
[2025-03-06 18:22:38,311][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,312][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,312][root][INFO] - Saved parsing metadata
[2025-03-06 18:22:38,314][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,315][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:22:38,316][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:22:38,349][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 18:22:38,349][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 28, 'both_wrong': 72}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 18:22:48,514][root][INFO] - Setting global seed to 206
[2025-03-06 18:22:48,522][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:22:48,522][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:22:48,524][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:22:48,525][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:22:48,528][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:22:48,529][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:22:48,680][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:22:48,928][root][INFO] - Full model selected, loading model
[2025-03-06 18:23:06,960][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:24:07,764][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:24:07,764][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:24:33,573][root][INFO] - Peft model loaded successfully
[2025-03-06 18:24:39,645][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:24:39,648][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:24:39,648][root][INFO] - Starting inference
[2025-03-06 18:24:39,805][root][INFO] - Processing question number 0
[2025-03-06 18:24:39,807][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:25:00,281][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:25:27,944][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:25:55,764][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:26:08,515][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:26:18,598][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:26:26,556][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:26:35,766][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:27:02,704][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:27:14,215][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:27:23,223][root][INFO] - Processing question number 10
[2025-03-06 18:27:23,224][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:27:30,407][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:27:57,058][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:28:23,823][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:28:37,024][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:28:51,925][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:29:06,669][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:29:17,291][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:29:43,936][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:30:01,031][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:30:28,252][root][INFO] - Processing question number 20
[2025-03-06 18:30:28,254][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:30:39,843][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:31:06,798][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:31:17,372][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:31:30,397][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:31:57,203][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:32:09,689][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:32:31,488][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:32:58,453][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:33:25,224][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:33:52,625][root][INFO] - Processing question number 30
[2025-03-06 18:33:52,628][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:34:10,640][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:34:23,277][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:34:49,918][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:35:17,287][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:35:31,767][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:35:40,814][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:36:07,577][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:36:16,789][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:36:31,450][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:36:51,547][root][INFO] - Processing question number 40
[2025-03-06 18:36:51,550][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:37:14,341][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:37:41,084][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:38:00,102][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:38:24,906][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:38:38,297][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:38:54,505][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:39:03,317][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:39:17,924][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:39:44,747][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:39:59,108][root][INFO] - Processing question number 50
[2025-03-06 18:39:59,111][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:40:07,485][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:40:17,573][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:40:40,429][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:40:50,408][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:41:02,603][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:41:29,298][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:41:56,860][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:42:10,555][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:42:31,456][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:42:54,744][root][INFO] - Processing question number 60
[2025-03-06 18:42:54,748][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:43:11,649][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:43:24,312][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:43:51,938][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:44:19,091][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:44:41,926][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:45:08,539][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:45:24,672][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:45:33,672][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:46:00,255][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:46:12,171][root][INFO] - Processing question number 70
[2025-03-06 18:46:12,174][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:46:33,207][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:46:53,751][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:47:09,461][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:47:37,101][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:47:53,354][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:48:20,465][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:48:48,543][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:49:02,535][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:49:24,218][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:49:35,196][root][INFO] - Processing question number 80
[2025-03-06 18:49:35,200][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:50:02,664][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:50:25,417][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:50:47,264][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:51:07,401][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:51:35,423][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:51:47,547][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:52:14,789][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:52:42,633][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:52:57,349][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:53:10,120][root][INFO] - Processing question number 90
[2025-03-06 18:53:10,124][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:53:32,955][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:53:45,903][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:54:07,258][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:54:18,015][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:54:30,858][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:54:58,339][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:55:16,897][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:55:30,582][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:55:46,852][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:56:14,360][root][INFO] - Inference complete
[2025-03-06 18:56:14,360][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,366][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,367][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,368][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,369][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,369][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,369][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,370][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,370][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,370][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,370][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,371][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,371][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,371][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,371][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,371][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,371][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,372][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,372][root][WARNING] - |Q. 62||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,372][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,372][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,372][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,372][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,373][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,373][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,373][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,373][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,373][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,374][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,374][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,374][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,374][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,375][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,375][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,375][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,375][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,375][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,375][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,376][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,376][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,376][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,377][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,377][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,377][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,377][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,378][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,378][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,378][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,378][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,378][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,379][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,379][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,379][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,379][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,380][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,380][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,380][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,380][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,381][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,381][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,381][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,381][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,381][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,382][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,382][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,382][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,383][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,383][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,383][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,383][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,383][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,384][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,384][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,384][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,385][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,385][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,385][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,385][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,386][root][WARNING] - |Q. 51||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,386][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,386][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,387][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,387][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,387][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,387][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,387][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,388][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,388][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,388][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,388][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,388][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,389][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,389][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,389][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,389][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,389][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,390][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,390][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,390][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,390][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,390][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,391][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,391][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,391][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,392][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,392][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,392][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,393][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,393][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,393][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,393][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,394][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,394][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,394][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,394][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,394][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,395][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,395][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,395][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,395][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,396][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,396][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,396][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,397][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,397][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,397][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,397][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,397][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,398][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,398][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,398][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,398][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,399][root][WARNING] - |Q. 18||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,399][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,399][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,399][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,400][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,400][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,400][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,400][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,400][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,400][root][WARNING] - |Q. 57||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,401][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,401][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,401][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,401][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,402][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,402][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,402][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,402][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,402][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:56:14,402][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,403][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:56:14,403][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:56:14,403][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:56:14,404][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,409][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,409][root][INFO] - Saved parsed outputs
[2025-03-06 18:56:14,409][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,410][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,410][root][INFO] - Saved parsing metadata
[2025-03-06 18:56:14,411][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,413][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:14,414][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:56:14,433][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 18:56:14,433][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.06, 'malformed_label': 10, 'malformed_domain': 82, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 6, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.04, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 12, 'correct_label_wrong_domain': 22, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 18:56:22,535][root][INFO] - Setting global seed to 206
[2025-03-06 18:56:22,543][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:56:22,543][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:56:22,544][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:56:22,546][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:56:22,548][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:56:22,548][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:56:22,728][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:56:23,002][root][INFO] - Full model selected, loading model
[2025-03-06 18:56:39,508][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:56:39,508][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:56:45,915][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:56:45,917][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:56:45,917][root][INFO] - Starting inference
[2025-03-06 18:56:46,115][root][INFO] - Processing question number 0
[2025-03-06 18:56:46,118][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:57:13,273][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:57:40,869][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:57:41,379][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:58:08,532][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:58:35,153][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:59:01,254][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:59:27,951][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:59:54,765][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:59:55,356][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:00:22,098][root][INFO] - Processing question number 10
[2025-03-06 19:00:22,100][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:00:48,038][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:01:01,402][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:01:28,085][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:01:33,424][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:02:00,512][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:02:27,249][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:02:53,939][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:03:20,507][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:03:47,551][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:03:54,733][root][INFO] - Processing question number 20
[2025-03-06 19:03:54,736][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:04:01,374][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:04:28,202][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:04:39,793][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:05:06,360][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:05:25,137][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:05:37,755][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:06:04,453][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:06:31,326][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:06:58,022][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:07:05,534][root][INFO] - Processing question number 30
[2025-03-06 19:07:05,536][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:07:14,388][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:07:25,589][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:07:52,139][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:08:19,344][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:08:46,009][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:09:12,744][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:09:39,444][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:09:52,293][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:10:19,169][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:10:28,785][root][INFO] - Processing question number 40
[2025-03-06 19:10:28,787][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:10:55,611][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:11:22,272][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:11:49,383][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:12:15,440][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:12:42,824][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:13:09,651][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:13:36,330][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:13:44,052][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:14:10,797][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:14:37,866][root][INFO] - Processing question number 50
[2025-03-06 19:14:37,870][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:14:41,853][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:14:42,328][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:14:48,374][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:14:49,020][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:15:03,688][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:15:13,517][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:15:41,017][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:15:41,585][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:15:47,576][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:15:59,255][root][INFO] - Processing question number 60
[2025-03-06 19:15:59,258][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:16:26,054][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:16:52,930][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:16:59,788][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:17:10,030][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:17:37,016][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:18:03,560][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:18:29,868][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:18:56,046][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:19:05,892][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:19:32,299][root][INFO] - Processing question number 70
[2025-03-06 19:19:32,302][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:19:45,378][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:20:06,086][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:20:33,162][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:20:34,767][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:20:45,726][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:21:12,759][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:21:40,751][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:22:07,797][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:22:33,874][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:22:37,763][root][INFO] - Processing question number 80
[2025-03-06 19:22:37,766][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:23:05,048][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:23:32,478][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:23:59,886][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:24:26,920][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:24:54,886][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:25:21,526][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:25:43,744][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:25:47,989][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:25:55,579][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:26:04,863][root][INFO] - Processing question number 90
[2025-03-06 19:26:04,867][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:26:17,515][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:26:44,728][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:26:51,069][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:27:17,871][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:27:45,358][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:27:53,746][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:28:20,792][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:28:47,447][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:29:13,641][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:29:38,047][root][INFO] - Inference complete
[2025-03-06 19:29:38,048][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,054][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,056][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,057][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,058][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,059][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,060][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,060][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,060][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,060][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,060][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,060][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,061][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,061][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,061][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,061][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,061][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,062][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,062][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,062][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,063][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,063][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,063][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,063][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,063][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,064][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,064][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,064][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,064][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,065][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,066][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,066][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,066][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,066][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,066][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,067][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,067][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,067][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,068][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,069][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,069][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,070][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,070][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,070][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,071][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,071][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,071][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,072][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,072][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,072][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,072][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,072][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,072][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,073][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,074][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,074][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,074][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,074][root][WARNING] - |Q. 66||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,074][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,075][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,075][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,075][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,075][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,076][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,076][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,079][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,079][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,079][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,079][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,079][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,079][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,079][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,080][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:29:38,080][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,080][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,080][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,080][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,084][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:29:38,084][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:29:38,084][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:29:38,085][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,090][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,091][root][INFO] - Saved parsed outputs
[2025-03-06 19:29:38,091][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,092][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,092][root][INFO] - Saved parsing metadata
[2025-03-06 19:29:38,093][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,094][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:29:38,096][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:29:38,118][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 19:29:38,118][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.0, 'malformed_label': 14, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 23, 'both_wrong': 77}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 19:29:47,799][root][INFO] - Setting global seed to 989
[2025-03-06 19:29:47,807][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 19:29:47,807][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:29:47,808][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:29:47,809][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:29:47,817][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:29:47,817][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:29:47,982][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:29:48,321][root][INFO] - Full model selected, loading model
[2025-03-06 19:30:06,335][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:31:06,890][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:31:06,890][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:31:32,055][root][INFO] - Peft model loaded successfully
[2025-03-06 19:31:38,102][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:31:38,104][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:31:38,104][root][INFO] - Starting inference
[2025-03-06 19:31:38,260][root][INFO] - Processing question number 0
[2025-03-06 19:31:38,262][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:31:48,693][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:32:11,693][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:32:35,169][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:33:02,207][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:33:10,761][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:33:28,944][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:33:38,251][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:33:46,646][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:34:12,652][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:34:25,398][root][INFO] - Processing question number 10
[2025-03-06 19:34:25,400][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:34:51,262][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:35:17,718][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:35:28,521][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:35:54,561][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:36:14,277][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:36:40,896][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:36:48,953][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:37:03,451][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:37:17,379][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:37:44,395][root][INFO] - Processing question number 20
[2025-03-06 19:37:44,397][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:37:58,772][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:38:15,178][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:38:41,501][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:38:51,918][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:39:09,410][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:39:36,429][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:39:51,492][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:40:11,698][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:40:38,273][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:41:05,490][root][INFO] - Processing question number 30
[2025-03-06 19:41:05,500][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:41:32,141][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:41:58,706][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:42:25,162][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:42:52,343][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:43:09,112][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:43:20,813][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:43:37,459][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:44:04,736][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:44:31,515][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:44:53,254][root][INFO] - Processing question number 40
[2025-03-06 19:44:53,257][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:45:12,153][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:45:38,703][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:45:58,911][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:46:24,853][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:46:38,466][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:46:49,062][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:47:15,631][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:47:33,889][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:47:45,158][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:48:00,223][root][INFO] - Processing question number 50
[2025-03-06 19:48:00,226][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:48:19,815][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:48:28,351][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:48:39,123][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:48:57,632][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:49:23,924][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:49:50,474][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:50:01,415][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:50:13,333][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:50:36,695][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:50:53,839][root][INFO] - Processing question number 60
[2025-03-06 19:50:53,843][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:51:05,350][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:51:27,361][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:51:54,907][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:52:21,885][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:52:45,017][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:52:57,167][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:53:23,449][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:53:49,574][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:54:01,634][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:54:14,799][root][INFO] - Processing question number 70
[2025-03-06 19:54:14,803][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:54:31,594][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:54:49,664][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:55:16,612][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:55:44,051][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:56:04,148][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:56:28,031][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:56:55,965][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:57:22,892][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:57:48,826][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:58:15,222][root][INFO] - Processing question number 80
[2025-03-06 19:58:15,226][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:58:42,526][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:59:09,867][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:59:37,080][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:59:58,657][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:00:13,748][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:00:25,707][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:00:37,408][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:00:59,959][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:01:16,914][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:01:30,220][root][INFO] - Processing question number 90
[2025-03-06 20:01:30,224][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:01:57,035][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:02:21,230][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:02:48,157][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:02:57,969][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:03:25,324][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:03:48,397][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:04:05,205][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:04:16,811][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:04:29,012][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:04:56,315][root][INFO] - Inference complete
[2025-03-06 20:04:56,315][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,321][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,321][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,322][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,323][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,323][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,324][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,324][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,324][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,324][root][WARNING] - |Q. 35||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,324][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,325][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,325][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,325][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,326][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,326][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,326][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,327][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,327][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,327][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,328][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,328][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,328][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,329][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,329][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,329][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,329][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,330][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,330][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,330][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,330][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,330][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,331][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,331][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,331][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,331][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,332][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,332][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,333][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,333][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,333][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,335][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,336][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,336][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,336][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,336][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,336][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,337][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,337][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,337][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,338][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,338][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,338][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,338][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,339][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,339][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,339][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,339][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,340][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,340][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,340][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,340][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,340][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,341][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,341][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,341][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,341][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,341][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,342][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,342][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,342][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,342][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,343][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,343][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,343][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,343][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,343][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,344][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,344][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,344][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,344][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,345][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,345][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,345][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,345][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,345][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,346][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,346][root][WARNING] - |Q. 18||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,346][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,347][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,347][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,347][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,347][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,348][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:04:56,348][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,348][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,348][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,348][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,349][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:04:56,349][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:04:56,349][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:04:56,351][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,355][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,355][root][INFO] - Saved parsed outputs
[2025-03-06 20:04:56,355][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,357][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,357][root][INFO] - Saved parsing metadata
[2025-03-06 20:04:56,357][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,359][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:04:56,360][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:04:56,395][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 20:04:56,395][root][INFO] - Summary of metrics : {'label_accuracy': 0.3, 'misclassification_rate': 0.7, 'combined_accuracy': 0.0, 'malformed_label': 5, 'malformed_domain': 99, 'total_predictions': 100, 'correct_predictions': 30, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 30, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 20:05:06,248][root][INFO] - Setting global seed to 989
[2025-03-06 20:05:06,270][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 20:05:06,270][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:05:06,272][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:05:06,273][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:05:06,276][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:05:06,276][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:05:06,441][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:05:06,837][root][INFO] - Full model selected, loading model
[2025-03-06 20:05:26,716][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 20:05:26,717][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 20:05:33,096][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:05:33,098][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:05:33,098][root][INFO] - Starting inference
[2025-03-06 20:05:33,250][root][INFO] - Processing question number 0
[2025-03-06 20:05:33,252][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:06:00,332][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:06:27,879][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:06:55,534][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:07:22,703][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:07:49,318][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:08:15,396][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:08:41,995][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:09:08,831][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:09:34,967][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:10:01,726][root][INFO] - Processing question number 10
[2025-03-06 20:10:01,727][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:10:27,677][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:10:54,263][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:11:20,948][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:11:47,110][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:12:14,190][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:12:40,939][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:13:07,432][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:13:34,001][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:14:01,037][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:14:28,180][root][INFO] - Processing question number 20
[2025-03-06 20:14:28,182][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:14:54,227][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:15:21,149][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:15:47,541][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:16:14,148][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:16:40,785][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:17:07,919][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:17:34,628][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:17:47,400][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:18:14,121][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:18:41,455][root][INFO] - Processing question number 30
[2025-03-06 20:18:41,457][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:19:08,246][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:19:34,881][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:20:01,465][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:20:28,704][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:20:55,398][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:21:22,170][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:21:48,891][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:22:16,304][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:22:43,223][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:23:10,165][root][INFO] - Processing question number 40
[2025-03-06 20:23:10,168][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:23:37,042][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:24:03,738][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:24:30,898][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:24:57,003][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:25:24,429][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:25:51,290][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:26:17,997][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:26:44,843][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:27:11,607][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:27:20,633][root][INFO] - Processing question number 50
[2025-03-06 20:27:20,636][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:27:48,013][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:28:14,290][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:28:41,672][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:29:08,661][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:29:35,000][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:30:01,632][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:30:29,127][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:30:56,330][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:31:23,544][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:31:50,573][root][INFO] - Processing question number 60
[2025-03-06 20:31:50,577][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:32:17,369][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:32:44,239][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:33:11,786][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:33:38,846][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:34:05,829][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:34:32,388][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:34:58,713][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:35:24,881][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:35:51,372][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:36:17,790][root][INFO] - Processing question number 70
[2025-03-06 20:36:17,794][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:36:44,783][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:37:11,659][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:37:38,732][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:38:06,243][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:38:32,576][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:38:59,550][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:39:27,478][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:39:54,491][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:40:20,559][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:40:47,040][root][INFO] - Processing question number 80
[2025-03-06 20:40:47,044][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:41:14,404][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:41:41,789][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:42:09,084][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:42:36,069][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:43:04,061][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:43:30,670][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:43:57,762][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:44:25,394][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:44:43,394][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:45:10,260][root][INFO] - Processing question number 90
[2025-03-06 20:45:10,264][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:45:37,132][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:46:04,304][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:46:31,300][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:46:58,106][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:47:25,546][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:47:52,885][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:48:19,877][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:48:27,868][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:48:54,004][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:49:21,380][root][INFO] - Inference complete
[2025-03-06 20:49:21,381][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,387][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,388][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,389][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,390][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,391][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,391][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,391][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,392][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,392][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,393][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,394][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,394][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,394][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,394][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,395][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,395][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,395][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,395][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,395][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,398][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,398][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,398][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,398][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,398][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,399][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,400][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,401][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,401][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,401][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,401][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,401][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,402][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,403][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,403][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,403][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,404][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,404][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,404][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,404][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,405][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,405][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,405][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,406][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,406][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,406][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,406][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,407][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,407][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,407][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,408][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,408][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,409][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,411][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,412][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:49:21,412][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,413][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:49:21,413][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:49:21,413][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:49:21,415][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,419][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,419][root][INFO] - Saved parsed outputs
[2025-03-06 20:49:21,419][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,420][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,421][root][INFO] - Saved parsing metadata
[2025-03-06 20:49:21,421][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,423][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:49:21,424][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:49:21,455][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 20:49:21,455][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 32, 'both_wrong': 68}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 20:49:35,157][root][INFO] - Setting global seed to 989
[2025-03-06 20:49:35,165][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 20:49:35,166][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:49:35,167][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:49:35,170][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:49:35,176][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:49:35,176][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:49:35,333][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:49:35,630][root][INFO] - Full model selected, loading model
[2025-03-06 20:49:54,034][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:50:55,682][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:50:55,682][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:51:20,781][root][INFO] - Peft model loaded successfully
[2025-03-06 20:51:26,864][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:51:26,867][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:51:26,867][root][INFO] - Starting inference
[2025-03-06 20:51:27,047][root][INFO] - Processing question number 0
[2025-03-06 20:51:27,049][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:51:55,128][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:52:22,864][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:52:50,810][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:53:09,378][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:53:19,632][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:53:45,899][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:53:54,030][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:54:01,064][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:54:27,398][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:54:54,392][root][INFO] - Processing question number 10
[2025-03-06 20:54:54,394][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:55:02,238][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:55:28,998][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:55:41,202][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:56:07,548][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:56:25,886][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:56:45,614][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:56:52,742][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:57:01,380][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:57:22,684][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:57:45,477][root][INFO] - Processing question number 20
[2025-03-06 20:57:45,479][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:58:11,704][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:58:27,095][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:58:53,729][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:59:20,490][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:59:47,357][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:00:14,711][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:00:41,629][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:00:59,758][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:01:26,674][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:01:54,216][root][INFO] - Processing question number 30
[2025-03-06 21:01:54,218][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:02:11,729][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:02:38,550][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:03:05,331][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:03:22,144][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:03:38,399][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:03:48,533][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:04:15,437][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:04:43,044][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:04:58,234][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:05:15,507][root][INFO] - Processing question number 40
[2025-03-06 21:05:15,510][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:05:30,459][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:05:46,990][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:06:14,342][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:06:25,409][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:06:38,919][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:06:53,557][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:07:03,968][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:07:31,050][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:07:46,544][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:07:59,591][root][INFO] - Processing question number 50
[2025-03-06 21:07:59,594][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:08:19,841][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:08:28,611][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:08:42,827][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:09:10,013][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:09:21,529][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:09:32,876][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:10:00,579][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:10:14,066][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:10:36,960][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:11:04,183][root][INFO] - Processing question number 60
[2025-03-06 21:11:04,186][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:11:18,218][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:11:42,717][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:12:10,459][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:12:31,567][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:12:58,753][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:13:25,509][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:13:45,885][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:14:12,276][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:14:38,996][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:14:58,118][root][INFO] - Processing question number 70
[2025-03-06 21:14:58,121][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:15:11,033][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:15:27,751][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:15:41,209][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:16:02,336][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:16:18,537][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:16:37,626][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:17:05,836][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:17:33,100][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:17:46,195][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:17:58,450][root][INFO] - Processing question number 80
[2025-03-06 21:17:58,454][root][INFO] - Domain : Property, Question : 69
[2025-03-06 21:18:26,065][root][INFO] - Domain : Property, Question : 81
[2025-03-06 21:18:46,820][root][INFO] - Domain : Property, Question : 88
[2025-03-06 21:18:55,490][root][INFO] - Domain : Property, Question : 91
[2025-03-06 21:19:13,429][root][INFO] - Domain : Property, Question : 94
[2025-03-06 21:19:41,592][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:19:52,346][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:20:19,724][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:20:30,453][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:20:47,624][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:21:01,084][root][INFO] - Processing question number 90
[2025-03-06 21:21:01,088][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:21:13,441][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:21:37,612][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:21:57,550][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:22:07,310][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:22:28,000][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:22:52,731][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:23:11,568][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:23:38,439][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:24:03,526][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:24:21,169][root][INFO] - Inference complete
[2025-03-06 21:24:21,169][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,175][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,176][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,176][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,177][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,177][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,178][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,178][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,178][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,179][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,179][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,179][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,179][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,180][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,180][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,180][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,181][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,182][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,182][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,182][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,183][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,183][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,183][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,184][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,184][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,184][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,184][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,184][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,184][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,185][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,185][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,185][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,186][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,186][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,186][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,187][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,187][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,187][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,187][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,188][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,188][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,188][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,188][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,188][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,189][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,189][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,189][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,190][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,190][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,190][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,191][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,192][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,192][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,192][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,193][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,193][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,193][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,193][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,193][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,194][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,194][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,194][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,195][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,196][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,196][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,196][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,196][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,196][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,197][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,197][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,197][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,197][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,198][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,198][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,198][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,198][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,198][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,199][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,199][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,200][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,200][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,200][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,200][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,201][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,201][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,201][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,202][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,203][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:24:21,203][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,203][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:24:21,203][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:24:21,203][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:24:21,205][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,209][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,209][root][INFO] - Saved parsed outputs
[2025-03-06 21:24:21,209][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,211][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,211][root][INFO] - Saved parsing metadata
[2025-03-06 21:24:21,212][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,213][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:21,214][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:24:21,242][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 21:24:21,242][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 27, 'both_wrong': 73}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 21:24:29,585][root][INFO] - Setting global seed to 989
[2025-03-06 21:24:29,593][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 21:24:29,594][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:24:29,595][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:24:29,597][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:24:29,601][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:24:29,601][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:24:29,753][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:24:30,006][root][INFO] - Full model selected, loading model
[2025-03-06 21:24:43,099][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 21:24:43,100][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 21:24:49,446][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:24:49,448][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:24:49,448][root][INFO] - Starting inference
[2025-03-06 21:24:49,584][root][INFO] - Processing question number 0
[2025-03-06 21:24:49,586][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:25:14,153][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:25:41,775][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:26:09,533][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:26:36,798][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:26:43,238][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:27:09,546][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:27:36,246][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:28:03,154][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:28:29,401][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:28:56,261][root][INFO] - Processing question number 10
[2025-03-06 21:28:56,263][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:29:22,279][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:29:48,962][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:29:59,470][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:30:25,745][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:30:52,926][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:31:19,778][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:31:46,326][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:32:12,996][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:32:40,147][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:33:07,397][root][INFO] - Processing question number 20
[2025-03-06 21:33:07,399][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:33:15,700][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:33:21,431][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:33:47,885][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:34:14,573][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:34:41,314][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:35:08,601][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:35:27,701][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:35:36,307][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:36:03,121][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:36:30,478][root][INFO] - Processing question number 30
[2025-03-06 21:36:30,481][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:36:57,342][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:37:04,680][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:37:31,359][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:37:58,667][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:38:25,457][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:38:52,323][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:39:19,154][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:39:46,643][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:40:13,649][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:40:40,667][root][INFO] - Processing question number 40
[2025-03-06 21:40:40,669][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:41:07,617][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:41:34,423][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:42:01,657][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:42:27,862][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:42:36,418][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:43:03,379][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:43:30,192][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:43:57,128][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:44:24,001][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:44:51,203][root][INFO] - Processing question number 50
[2025-03-06 21:44:51,206][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:44:58,363][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:45:24,761][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:45:52,260][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:46:19,355][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:46:45,810][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:46:56,162][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:47:23,770][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:47:51,080][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:48:18,390][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:48:45,539][root][INFO] - Processing question number 60
[2025-03-06 21:48:45,543][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:49:12,458][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:49:39,450][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:50:07,103][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:50:34,297][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:50:40,733][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:51:07,391][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:51:13,809][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:51:40,118][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:51:49,832][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:52:16,372][root][INFO] - Processing question number 70
[2025-03-06 21:52:16,376][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:52:35,285][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:53:02,279][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:53:29,475][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:53:57,150][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:54:05,488][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:54:32,646][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:55:00,751][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:55:27,924][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:55:54,121][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:56:20,757][root][INFO] - Processing question number 80
[2025-03-06 21:56:20,762][root][INFO] - Domain : Property, Question : 69
[2025-03-06 21:56:48,252][root][INFO] - Domain : Property, Question : 81
[2025-03-06 21:57:15,781][root][INFO] - Domain : Property, Question : 88
[2025-03-06 21:57:43,235][root][INFO] - Domain : Property, Question : 91
[2025-03-06 21:58:10,379][root][INFO] - Domain : Property, Question : 94
[2025-03-06 21:58:38,452][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:59:05,215][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:59:14,429][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:59:42,225][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:00:09,230][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:00:36,268][root][INFO] - Processing question number 90
[2025-03-06 22:00:36,272][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:01:03,306][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:01:10,498][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:01:37,660][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:02:04,558][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:02:32,148][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:02:39,170][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:03:06,326][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:03:33,110][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:03:59,415][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:04:26,922][root][INFO] - Inference complete
[2025-03-06 22:04:26,922][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,929][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,932][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,932][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,933][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,934][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,934][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:04:26,934][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,935][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,935][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,936][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,936][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,936][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:04:26,936][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,937][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,938][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,938][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,938][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,938][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,939][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,939][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,940][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,940][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,942][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,942][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,942][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,945][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,945][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,946][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,948][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,948][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,948][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,949][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,949][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,949][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,953][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,953][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,953][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,954][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:04:26,954][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:04:26,954][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:04:26,956][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,961][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,961][root][INFO] - Saved parsed outputs
[2025-03-06 22:04:26,961][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,975][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,975][root][INFO] - Saved parsing metadata
[2025-03-06 22:04:26,977][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,978][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:04:26,979][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:04:26,996][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 22:04:26,996][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 29, 'both_wrong': 71}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 22:04:36,058][root][INFO] - Setting global seed to 989
[2025-03-06 22:04:36,064][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 22:04:36,064][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 22:04:36,065][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:04:36,067][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:04:36,069][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:04:36,069][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:04:36,239][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 22:04:36,509][root][INFO] - Full model selected, loading model
[2025-03-06 22:04:48,865][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:05:50,279][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:05:50,279][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:06:16,263][root][INFO] - Peft model loaded successfully
[2025-03-06 22:06:22,364][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:06:22,366][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:06:22,366][root][INFO] - Starting inference
[2025-03-06 22:06:22,519][root][INFO] - Processing question number 0
[2025-03-06 22:06:22,523][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:06:42,881][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:06:53,927][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:07:21,870][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:07:39,931][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:08:06,765][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:08:15,988][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:08:29,740][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:08:39,590][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:09:05,925][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:09:16,147][root][INFO] - Processing question number 10
[2025-03-06 22:09:16,149][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:09:42,333][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:09:52,275][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:10:04,311][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:10:13,904][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:10:41,193][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:11:08,134][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:11:20,828][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:11:33,463][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:12:00,724][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:12:28,082][root][INFO] - Processing question number 20
[2025-03-06 22:12:28,085][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:12:54,316][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:13:04,216][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:13:17,095][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:13:43,881][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:14:05,986][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:14:25,436][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:14:45,141][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:14:59,031][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:15:15,976][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:15:43,186][root][INFO] - Processing question number 30
[2025-03-06 22:15:43,188][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:16:10,152][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:16:27,759][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:16:41,589][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:17:09,105][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:17:29,665][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:17:40,632][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:18:07,545][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:18:35,157][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:18:52,018][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:19:03,525][root][INFO] - Processing question number 40
[2025-03-06 22:19:03,528][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:19:27,095][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:19:43,128][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:20:01,499][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:20:13,469][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:20:32,288][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:20:56,214][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:21:19,326][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:21:46,421][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:22:13,384][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:22:28,325][root][INFO] - Processing question number 50
[2025-03-06 22:22:28,328][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:22:40,130][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:22:49,762][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:23:13,882][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:23:32,633][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:23:53,990][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:24:20,835][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:24:30,480][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:24:44,799][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:25:05,729][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:25:25,565][root][INFO] - Processing question number 60
[2025-03-06 22:25:25,568][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:25:52,617][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:26:19,718][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:26:45,111][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:27:12,400][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:27:23,276][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:27:50,037][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:28:16,627][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:28:43,019][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:28:53,801][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:29:07,709][root][INFO] - Processing question number 70
[2025-03-06 22:29:07,713][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:29:32,364][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:29:48,312][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:30:07,719][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:30:35,500][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:30:49,531][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:31:16,788][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:31:45,006][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:32:11,702][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:32:37,983][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:32:51,425][root][INFO] - Processing question number 80
[2025-03-06 22:32:51,429][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:33:19,036][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:33:46,681][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:33:55,746][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:34:18,124][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:34:41,396][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:35:00,756][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:35:18,880][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:35:38,259][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:35:55,170][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:36:11,606][root][INFO] - Processing question number 90
[2025-03-06 22:36:11,610][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:36:33,116][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:36:52,555][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:37:19,823][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:37:31,436][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:37:47,130][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:38:10,358][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:38:37,631][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:38:54,238][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:39:20,670][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:39:34,890][root][INFO] - Inference complete
[2025-03-06 22:39:34,891][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,897][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,898][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,898][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,899][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,899][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,900][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,900][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,900][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,900][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,900][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,901][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,901][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,901][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,902][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,902][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,902][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,902][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,903][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,903][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,903][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,903][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,903][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,904][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,904][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,904][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,904][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,904][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,904][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,905][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,905][root][WARNING] - |Q. 21||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,905][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,905][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,905][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,906][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,906][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,906][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,906][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,906][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,906][root][WARNING] - |Q. 55||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,907][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,907][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,907][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,907][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,908][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,908][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,908][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,908][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,908][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,909][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,909][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,909][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,909][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,910][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,910][root][WARNING] - |Q. 14||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,910][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,911][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,911][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,911][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,911][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,911][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,911][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,912][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,912][root][WARNING] - |Q. 42||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,912][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,912][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,912][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,912][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,913][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,913][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,913][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,914][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,914][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,914][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,915][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,915][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,915][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,915][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,916][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,916][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,917][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,917][root][WARNING] - |Q. 85||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,917][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,918][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,918][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,918][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,919][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,919][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,919][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,919][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,920][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,920][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,920][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,920][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,920][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,921][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,921][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,921][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,921][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,922][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,922][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,922][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,922][root][WARNING] - |Q. 68||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,922][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,923][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,923][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,924][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,924][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,924][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,924][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,924][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,925][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,925][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,925][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,926][root][WARNING] - |Q. 91||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,926][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,926][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,926][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,926][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,927][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,927][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,927][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,928][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,928][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,928][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,928][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,929][root][WARNING] - |Q. 57||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:39:34,929][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,929][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,929][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,929][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,930][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:39:34,930][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:39:34,930][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:39:34,931][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,948][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,948][root][INFO] - Saved parsed outputs
[2025-03-06 22:39:34,948][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,950][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,950][root][INFO] - Saved parsing metadata
[2025-03-06 22:39:34,951][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,953][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:39:34,954][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:39:34,976][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 22:39:34,976][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.05, 'malformed_label': 13, 'malformed_domain': 84, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 5, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 11, 'correct_label_wrong_domain': 19, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 5 to status running with exit code None
Eval status update completed for job 5
[2025-03-06 22:39:51,572][root][INFO] - Setting global seed to 989
[2025-03-06 22:39:51,588][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 22:39:51,588][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 22:39:51,589][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:39:51,591][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:39:51,628][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:39:51,629][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:39:51,829][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 22:39:52,108][root][INFO] - Full model selected, loading model
[2025-03-06 22:40:04,165][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 22:40:04,165][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 22:40:10,599][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:40:10,602][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 22:40:10,602][root][INFO] - Starting inference
[2025-03-06 22:40:10,747][root][INFO] - Processing question number 0
[2025-03-06 22:40:10,749][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:40:15,410][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:40:43,068][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:40:43,574][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:40:47,686][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:41:14,423][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:41:40,603][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:42:07,300][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:42:12,865][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:42:39,135][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:42:50,340][root][INFO] - Processing question number 10
[2025-03-06 22:42:50,342][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:42:55,242][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:43:10,794][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:43:20,093][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:43:46,365][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:43:52,355][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:43:56,551][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:44:18,645][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:44:45,319][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:44:52,723][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:45:19,974][root][INFO] - Processing question number 20
[2025-03-06 22:45:19,976][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:45:46,132][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:46:13,070][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:46:39,539][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:47:06,233][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:47:32,990][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:48:00,232][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:48:08,761][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:48:35,761][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:49:02,574][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:49:29,936][root][INFO] - Processing question number 30
[2025-03-06 22:49:29,938][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:49:40,174][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:50:06,883][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:50:33,557][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:51:00,886][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:51:27,677][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:51:54,535][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:52:21,387][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:52:36,465][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:52:44,260][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:52:49,908][root][INFO] - Processing question number 40
[2025-03-06 22:52:49,911][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:53:16,862][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:53:43,650][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:54:10,885][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:54:37,064][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:55:04,573][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:55:11,599][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:55:38,399][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:55:44,647][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:56:11,520][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:56:19,982][root][INFO] - Processing question number 50
[2025-03-06 22:56:19,985][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:56:28,362][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:56:28,757][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:56:56,261][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:57:01,582][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:57:17,382][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:57:44,114][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:58:08,725][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:58:15,873][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:58:43,245][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:59:10,409][root][INFO] - Processing question number 60
[2025-03-06 22:59:10,412][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:59:31,148][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:59:38,551][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:59:46,942][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:59:59,676][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:00:26,799][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:00:37,257][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:00:44,733][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:00:52,361][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:00:59,891][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:01:09,829][root][INFO] - Processing question number 70
[2025-03-06 23:01:09,833][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:01:16,147][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:01:43,163][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:02:10,369][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:02:11,008][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:02:37,528][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:02:41,543][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:03:09,655][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:03:18,408][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:03:30,726][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:03:41,341][root][INFO] - Processing question number 80
[2025-03-06 23:03:41,344][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:04:08,848][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:04:26,378][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:04:30,629][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:04:57,778][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:05:06,973][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:05:33,733][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:05:40,343][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:05:54,527][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:06:21,529][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:06:48,545][root][INFO] - Processing question number 90
[2025-03-06 23:06:48,549][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:07:15,576][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:07:42,899][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:07:51,298][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:08:01,115][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:08:28,732][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:08:39,458][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:08:46,255][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:08:55,494][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:09:21,793][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:09:49,300][root][INFO] - Inference complete
[2025-03-06 23:09:49,300][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,306][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,306][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,307][root][WARNING] - |Q. 1||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,307][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,308][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,309][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,309][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,309][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,309][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,309][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,310][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,310][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,310][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,310][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,310][root][WARNING] - |Q. 29||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,310][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,311][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,311][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,311][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,314][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,314][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,314][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,315][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,316][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,316][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,317][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,317][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,317][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,318][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,318][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,318][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,318][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,319][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,319][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,319][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,320][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,320][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,320][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,320][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,321][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,321][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,321][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,321][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,322][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,322][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,322][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,322][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,323][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,323][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,324][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,325][root][WARNING] - |Q. 22||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,325][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,325][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,325][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:09:49,325][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,327][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:09:49,327][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:09:49,327][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:09:49,328][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,333][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,333][root][INFO] - Saved parsed outputs
[2025-03-06 23:09:49,333][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,334][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,334][root][INFO] - Saved parsing metadata
[2025-03-06 23:09:49,335][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,336][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 23:09:49,338][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:09:49,367][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 23:09:49,367][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.0, 'malformed_label': 6, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 23, 'both_wrong': 77}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '5', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 5 to status completed with exit code 0
Eval status update completed for job 5
Job 5 completed at Thu Mar  6 23:09:50 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n508
Job ID: 25358380
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 14:30:02
CPU Efficiency: 9.91% of 6-02:22:00 core-walltime
Job Wall-clock time: 14:38:12
Memory Utilized: 28.06 GB
Memory Efficiency: 77.95% of 36.00 GB
