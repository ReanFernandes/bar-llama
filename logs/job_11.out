Starting job 11 at Thu Feb 20 22:52:55 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=number_list_fact_first_few_shot_unstructured train=number_list_fact_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '11', 'training']
Updating job 11 to status training with exit code None
Status update completed for job 11
[2025-02-20 22:53:09,988][root][INFO] - Global seed set to 314
[2025-02-20 22:53:09,990][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:53:09,990][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:53:09,990][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:53:09,990][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:53:09,990][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 22:53:10,004][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:53:10,055][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:53:10,069][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:53:10,113][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:53:10,535][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:53:23,655][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:53:51,597][root][INFO] - Model prepared for kbit training
[2025-02-20 22:53:51,598][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'k_proj', 'gate_proj', 'down_proj', 'v_proj', 'q_proj', 'up_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:53:53,438][root][INFO] - Lora adapter added to model
[2025-02-20 22:53:53,441][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_fact_first_few_shot_unstructured
[2025-02-20 22:53:53,552][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.5694, 'grad_norm': 0.13318929076194763, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4206, 'grad_norm': 0.17116352915763855, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3025, 'grad_norm': 0.1753092110157013, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.2048, 'grad_norm': 0.22641213238239288, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0223, 'grad_norm': 0.2620577812194824, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 375.7723, 'train_samples_per_second': 0.279, 'train_steps_per_second': 0.04, 'train_loss': 1.3039268175760905, 'epoch': 15.0}
[2025-02-20 23:00:12,552][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_fact_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '11', 'trained', '0']
Updating job 11 to status trained with exit code 0
Status update completed for job 11
Starting evaluations for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-20 23:00:21,089][root][INFO] - Setting global seed to 206
[2025-02-20 23:00:21,095][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:00:21,095][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:00:21,096][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:00:21,098][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:00:21,100][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:00:21,100][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:00:21,264][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:00:21,525][root][INFO] - Full model selected, loading model
[2025-02-20 23:00:33,337][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:01:33,172][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:01:33,173][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:01:58,557][root][INFO] - Peft model loaded successfully
[2025-02-20 23:02:04,790][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:02:04,791][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:02:04,791][root][INFO] - Starting inference
[2025-02-20 23:02:04,938][root][INFO] - Processing question number 0
[2025-02-20 23:02:04,963][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:02:34,431][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:03:04,781][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:03:34,664][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:04:05,097][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:04:34,755][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:05:04,337][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:05:34,686][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:06:04,588][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:06:34,133][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:07:05,652][root][INFO] - Processing question number 10
[2025-02-20 23:07:05,656][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:07:37,224][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:08:06,580][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:08:36,456][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:09:06,878][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:09:37,292][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:10:06,713][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:10:36,082][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:11:05,894][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:11:35,699][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:12:05,233][root][INFO] - Processing question number 20
[2025-02-20 23:12:05,235][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:12:35,011][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:13:04,965][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:13:34,378][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:14:03,730][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:14:33,786][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:15:03,627][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:15:34,250][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:16:04,037][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:16:33,969][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:17:03,160][root][INFO] - Processing question number 30
[2025-02-20 23:17:03,163][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:17:33,287][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:18:03,697][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:18:33,616][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:19:03,381][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:19:33,000][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:20:03,348][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:20:33,085][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:21:03,187][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:21:33,105][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:22:03,747][root][INFO] - Processing question number 40
[2025-02-20 23:22:03,750][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:22:33,700][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:23:03,661][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:23:35,528][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:24:05,885][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:24:35,517][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:25:05,438][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:25:36,687][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:26:05,687][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:26:35,505][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:27:06,068][root][INFO] - Processing question number 50
[2025-02-20 23:27:06,073][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:27:36,914][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:28:06,946][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:28:36,243][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:29:07,194][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:29:37,202][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:30:06,240][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:30:36,893][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:31:06,336][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:31:36,782][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:32:08,064][root][INFO] - Processing question number 60
[2025-02-20 23:32:08,068][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:32:37,496][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:33:07,267][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:33:37,636][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:34:07,038][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:34:36,938][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:35:06,888][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:35:36,857][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:36:07,118][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:36:37,174][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:37:07,725][root][INFO] - Processing question number 70
[2025-02-20 23:37:07,729][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:37:37,487][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:38:07,264][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:38:36,872][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:39:07,109][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:39:37,314][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:40:09,807][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:40:40,142][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:41:10,232][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:41:40,538][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:42:10,533][root][INFO] - Processing question number 80
[2025-02-20 23:42:10,540][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:42:40,791][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:43:10,957][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:43:40,595][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:44:10,309][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:44:40,756][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:45:11,012][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:45:41,339][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:46:10,957][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:46:41,045][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:47:10,453][root][INFO] - Processing question number 90
[2025-02-20 23:47:10,458][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:47:41,292][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:48:10,192][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:48:39,994][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:49:09,044][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:49:39,364][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:50:08,763][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:50:38,517][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:51:08,727][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:51:39,381][root][INFO] - Inference complete
[2025-02-20 23:51:39,382][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,389][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,391][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-20 23:51:39,391][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Civil_procedure
[2025-02-20 23:51:39,391][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-20 23:51:39,392][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-20 23:51:39,392][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-20 23:51:39,393][root][WARNING] - No match found for 3. Chosen Option Label in question number 77 in domain Civil_procedure
[2025-02-20 23:51:39,393][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-20 23:51:39,393][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-20 23:51:39,394][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Constitutional_law
[2025-02-20 23:51:39,394][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-20 23:51:39,394][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-20 23:51:39,394][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-20 23:51:39,395][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-20 23:51:39,395][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-20 23:51:39,395][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-20 23:51:39,396][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-20 23:51:39,396][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Constitutional_law
[2025-02-20 23:51:39,397][root][WARNING] - No match found for 3. Chosen Option Label in question number 3 in domain Contracts
[2025-02-20 23:51:39,397][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Contracts
[2025-02-20 23:51:39,398][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Contracts
[2025-02-20 23:51:39,398][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-20 23:51:39,398][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-20 23:51:39,399][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-20 23:51:39,399][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-20 23:51:39,400][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-20 23:51:39,400][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Torts
[2025-02-20 23:51:39,400][root][WARNING] - No match found for 3. Chosen Option Label in question number 11 in domain Torts
[2025-02-20 23:51:39,400][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-20 23:51:39,401][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Torts
[2025-02-20 23:51:39,401][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-20 23:51:39,401][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-20 23:51:39,402][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Torts
[2025-02-20 23:51:39,403][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-20 23:51:39,403][root][WARNING] - No match found for 3. Chosen Option Label in question number 23 in domain Evidence
[2025-02-20 23:51:39,403][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-20 23:51:39,403][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Evidence
[2025-02-20 23:51:39,404][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Evidence
[2025-02-20 23:51:39,404][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-20 23:51:39,405][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-20 23:51:39,405][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Property
[2025-02-20 23:51:39,406][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Property
[2025-02-20 23:51:39,406][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Property
[2025-02-20 23:51:39,407][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-20 23:51:39,407][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-20 23:51:39,407][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-20 23:51:39,408][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-20 23:51:39,408][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-20 23:51:39,408][root][WARNING] - No match found for 3. Chosen Option Label in question number 10 in domain Criminal_law
[2025-02-20 23:51:39,409][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-20 23:51:39,409][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-20 23:51:39,409][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-20 23:51:39,410][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-20 23:51:39,410][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Criminal_law
[2025-02-20 23:51:39,410][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-20 23:51:39,411][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,427][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,427][root][INFO] - Saved parsed outputs
[2025-02-20 23:51:39,427][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,443][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,443][root][INFO] - Saved parsing metadata
[2025-02-20 23:51:39,444][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,446][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:51:39,456][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:51:39,478][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:51:39,478][root][INFO] - Summary of metrics : {'label_accuracy': 0.2222222222222222, 'misclassification_rate': 0.7777777777777778, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 54, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 22, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 61, 'correct_label_wrong_domain': 3, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-20 23:51:48,052][root][INFO] - Setting global seed to 206
[2025-02-20 23:51:48,059][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:51:48,059][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:51:48,061][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:51:48,063][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:51:48,065][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:51:48,065][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:51:48,222][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:51:48,484][root][INFO] - Full model selected, loading model
[2025-02-20 23:52:06,271][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:52:06,271][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:52:12,799][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:52:12,801][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:52:12,801][root][INFO] - Starting inference
[2025-02-20 23:52:12,930][root][INFO] - Processing question number 0
[2025-02-20 23:52:12,932][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:52:42,206][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:53:12,445][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:53:42,242][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:54:12,344][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:54:41,898][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:55:11,405][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:55:41,714][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:56:11,548][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:56:41,007][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:57:11,123][root][INFO] - Processing question number 10
[2025-02-20 23:57:11,124][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:57:42,601][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:58:11,792][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:58:41,570][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:59:11,922][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:59:42,255][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:00:11,605][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:00:40,788][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:01:10,532][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:01:40,215][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:02:09,664][root][INFO] - Processing question number 20
[2025-02-21 00:02:09,666][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:02:39,331][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:03:12,838][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:03:42,205][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:04:11,402][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:04:41,376][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:05:11,135][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:05:41,640][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:06:11,326][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:06:41,176][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:07:10,300][root][INFO] - Processing question number 30
[2025-02-21 00:07:10,304][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:07:40,348][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:08:10,688][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:08:40,536][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:09:10,184][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:09:39,724][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:10:10,008][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:10:39,635][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:11:09,679][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:11:39,517][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:12:10,045][root][INFO] - Processing question number 40
[2025-02-21 00:12:10,048][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:12:39,931][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:13:09,824][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:13:40,169][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:14:10,471][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:14:40,034][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:15:09,882][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:15:41,049][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:16:09,985][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:16:39,703][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:17:10,291][root][INFO] - Processing question number 50
[2025-02-21 00:17:10,295][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:17:40,904][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:18:12,978][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:18:42,269][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:19:13,290][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:19:43,236][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:20:13,444][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:20:43,971][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:21:13,337][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:21:43,713][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:22:14,941][root][INFO] - Processing question number 60
[2025-02-21 00:22:14,945][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:22:44,292][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:23:13,956][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:23:44,245][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:24:13,579][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:24:43,394][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:25:13,261][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:25:43,161][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:26:13,364][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:26:43,333][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:27:13,810][root][INFO] - Processing question number 70
[2025-02-21 00:27:13,814][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:27:43,436][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:28:13,093][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:28:42,633][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:29:12,766][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:29:42,845][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:30:12,274][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:30:42,650][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:31:12,683][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:31:42,911][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:32:12,534][root][INFO] - Processing question number 80
[2025-02-21 00:32:12,539][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:32:42,591][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:33:12,639][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:33:42,192][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:34:11,785][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:34:42,148][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:35:12,292][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:35:42,529][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:36:12,082][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:36:42,077][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:37:11,409][root][INFO] - Processing question number 90
[2025-02-21 00:37:11,415][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:37:42,171][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:38:10,972][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:38:40,639][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:39:09,618][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:39:43,505][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:40:12,827][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:40:42,434][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:41:12,510][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:41:43,075][root][INFO] - Inference complete
[2025-02-21 00:41:43,076][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,084][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,085][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-21 00:41:43,086][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 00:41:43,086][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-21 00:41:43,086][root][WARNING] - No match found for 3. Chosen Option Label in question number 56 in domain Civil_procedure
[2025-02-21 00:41:43,087][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-21 00:41:43,088][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-21 00:41:43,088][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 00:41:43,088][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 00:41:43,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 00:41:43,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 00:41:43,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-21 00:41:43,090][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 00:41:43,090][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-21 00:41:43,091][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 00:41:43,091][root][WARNING] - No match found for 3. Chosen Option Label in question number 3 in domain Contracts
[2025-02-21 00:41:43,092][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Contracts
[2025-02-21 00:41:43,092][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 00:41:43,093][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Contracts
[2025-02-21 00:41:43,093][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 00:41:43,093][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 00:41:43,094][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Contracts
[2025-02-21 00:41:43,094][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-21 00:41:43,095][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 00:41:43,095][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 00:41:43,095][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 00:41:43,096][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-21 00:41:43,097][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Torts
[2025-02-21 00:41:43,097][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 00:41:43,097][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 00:41:43,098][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Evidence
[2025-02-21 00:41:43,099][root][WARNING] - No match found for 3. Chosen Option Label in question number 73 in domain Evidence
[2025-02-21 00:41:43,099][root][WARNING] - No match found for 3. Chosen Option Label in question number 78 in domain Evidence
[2025-02-21 00:41:43,100][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 00:41:43,101][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Property
[2025-02-21 00:41:43,101][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-21 00:41:43,102][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 00:41:43,102][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 00:41:43,102][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 00:41:43,102][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 00:41:43,103][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 00:41:43,103][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 00:41:43,104][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 00:41:43,104][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-21 00:41:43,104][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 00:41:43,106][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,111][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,111][root][INFO] - Saved parsed outputs
[2025-02-21 00:41:43,111][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,113][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,113][root][INFO] - Saved parsing metadata
[2025-02-21 00:41:43,114][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,117][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:43,118][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:41:43,135][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:41:43,136][root][INFO] - Summary of metrics : {'label_accuracy': 0.2222222222222222, 'misclassification_rate': 0.7777777777777778, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 44, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 22, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 5, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 00:41:51,147][root][INFO] - Setting global seed to 206
[2025-02-21 00:41:51,154][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:41:51,155][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:41:51,156][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:41:51,158][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:41:51,160][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:41:51,160][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:41:51,304][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:41:51,574][root][INFO] - Full model selected, loading model
[2025-02-21 00:42:09,323][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:43:10,950][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:43:10,950][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:43:37,574][root][INFO] - Peft model loaded successfully
[2025-02-21 00:43:43,848][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:43:43,849][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:43:43,850][root][INFO] - Starting inference
[2025-02-21 00:43:43,979][root][INFO] - Processing question number 0
[2025-02-21 00:43:43,981][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:44:13,477][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:44:43,845][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:45:13,838][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:45:44,252][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:46:14,072][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:46:43,850][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:47:14,404][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:47:44,490][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:48:14,220][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:48:44,625][root][INFO] - Processing question number 10
[2025-02-21 00:48:44,627][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:49:16,377][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:49:45,906][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:50:15,961][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:50:46,558][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:51:17,144][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:51:46,740][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:52:16,263][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:52:46,268][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:53:16,256][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:53:45,967][root][INFO] - Processing question number 20
[2025-02-21 00:53:45,970][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:54:15,929][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:54:46,076][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:55:15,677][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:55:47,646][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:56:17,906][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:56:47,916][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:57:18,722][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:57:48,989][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:58:19,087][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:58:48,453][root][INFO] - Processing question number 30
[2025-02-21 00:58:48,457][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:59:18,742][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:59:49,316][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:00:19,411][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:00:49,335][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:01:19,122][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:01:49,634][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:02:19,542][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:02:49,815][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:03:19,902][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:03:50,719][root][INFO] - Processing question number 40
[2025-02-21 01:03:50,723][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:04:20,863][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:04:50,986][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:05:21,570][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:05:52,107][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:06:21,909][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:06:52,015][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:07:23,454][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:07:52,872][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:08:22,876][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:08:53,509][root][INFO] - Processing question number 50
[2025-02-21 01:08:53,513][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:09:24,371][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:09:54,579][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:10:24,049][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:10:55,195][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:11:25,380][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:11:54,594][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:12:25,423][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:12:55,037][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:13:25,667][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:13:57,133][root][INFO] - Processing question number 60
[2025-02-21 01:13:57,137][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:14:26,739][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:14:56,689][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:15:27,236][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:15:56,803][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:16:26,875][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:16:56,997][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:17:27,159][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:17:57,595][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:18:27,818][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:18:58,545][root][INFO] - Processing question number 70
[2025-02-21 01:18:58,551][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:19:28,464][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:19:58,431][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:20:28,226][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:20:58,648][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:21:29,030][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:21:58,701][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:22:29,185][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:22:59,465][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:23:29,948][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:23:59,865][root][INFO] - Processing question number 80
[2025-02-21 01:23:59,871][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:24:30,223][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:25:00,568][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:25:30,368][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:26:00,257][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:26:30,880][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:27:01,316][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:27:31,816][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:28:01,618][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:28:31,896][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:29:01,558][root][INFO] - Processing question number 90
[2025-02-21 01:29:01,564][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:29:32,714][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:30:02,036][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:30:32,127][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:31:01,362][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:31:31,863][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:32:01,450][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:32:31,442][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:33:01,799][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:33:32,578][root][INFO] - Inference complete
[2025-02-21 01:33:32,579][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,586][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,588][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 01:33:32,588][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-21 01:33:32,589][root][WARNING] - No match found for 3. Chosen Option Label in question number 70 in domain Civil_procedure
[2025-02-21 01:33:32,589][root][WARNING] - No match found for 3. Chosen Option Label in question number 77 in domain Civil_procedure
[2025-02-21 01:33:32,589][root][WARNING] - No match found for 3. Chosen Option Label in question number 84 in domain Civil_procedure
[2025-02-21 01:33:32,589][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-21 01:33:32,590][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Constitutional_law
[2025-02-21 01:33:32,590][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 01:33:32,591][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 01:33:32,591][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-21 01:33:32,592][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-21 01:33:32,592][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 01:33:32,593][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 01:33:32,594][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 01:33:32,594][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 01:33:32,595][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-21 01:33:32,595][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Torts
[2025-02-21 01:33:32,595][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 01:33:32,596][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Torts
[2025-02-21 01:33:32,596][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 01:33:32,596][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 01:33:32,597][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-21 01:33:32,597][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 01:33:32,598][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 01:33:32,598][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Evidence
[2025-02-21 01:33:32,599][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Evidence
[2025-02-21 01:33:32,600][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Property
[2025-02-21 01:33:32,601][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-21 01:33:32,601][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 01:33:32,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 01:33:32,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 01:33:32,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Criminal_law
[2025-02-21 01:33:32,603][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 01:33:32,603][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-21 01:33:32,604][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-21 01:33:32,604][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Criminal_law
[2025-02-21 01:33:32,605][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,611][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,611][root][INFO] - Saved parsed outputs
[2025-02-21 01:33:32,611][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,612][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,612][root][INFO] - Saved parsing metadata
[2025-02-21 01:33:32,613][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,615][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:33:32,616][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:33:32,631][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:33:32,631][root][INFO] - Summary of metrics : {'label_accuracy': 0.2828282828282828, 'misclassification_rate': 0.7171717171717171, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 36, 'malformed_domain': 22, 'total_predictions': 99, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 6, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 01:33:40,362][root][INFO] - Setting global seed to 206
[2025-02-21 01:33:40,369][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:33:40,370][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:33:40,371][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:33:40,373][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:33:40,375][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:33:40,375][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:33:40,525][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:33:40,779][root][INFO] - Full model selected, loading model
[2025-02-21 01:33:57,126][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:33:57,126][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:34:03,760][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:34:03,761][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:34:03,761][root][INFO] - Starting inference
[2025-02-21 01:34:03,919][root][INFO] - Processing question number 0
[2025-02-21 01:34:03,921][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:34:33,664][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:35:04,104][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:35:33,908][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:36:04,178][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:36:33,897][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:37:03,574][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:37:34,030][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:38:04,041][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:38:33,709][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:39:03,979][root][INFO] - Processing question number 10
[2025-02-21 01:39:03,982][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:39:35,617][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:40:04,986][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:40:34,943][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:41:05,453][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:41:35,959][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:42:05,548][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:42:34,913][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:43:04,826][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:43:34,703][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:44:04,347][root][INFO] - Processing question number 20
[2025-02-21 01:44:04,350][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:44:34,183][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:45:04,235][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:45:33,745][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:46:03,112][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:46:33,246][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:47:03,169][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:47:33,826][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:48:03,678][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:48:33,696][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:49:02,999][root][INFO] - Processing question number 30
[2025-02-21 01:49:03,002][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:49:33,209][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:50:03,708][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:50:33,718][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:51:03,529][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:51:33,239][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:52:03,680][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:52:33,466][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:53:03,665][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:53:33,664][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:54:04,341][root][INFO] - Processing question number 40
[2025-02-21 01:54:04,344][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:54:34,400][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:55:04,448][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:55:34,960][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:56:05,416][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:56:35,144][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:57:05,155][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:57:36,481][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:58:05,756][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:58:35,640][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:59:06,185][root][INFO] - Processing question number 50
[2025-02-21 01:59:06,188][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:59:36,911][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:00:07,039][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:00:36,353][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:01:07,419][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:01:37,518][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:02:06,659][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:02:37,349][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:03:06,897][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:03:37,446][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:04:08,826][root][INFO] - Processing question number 60
[2025-02-21 02:04:08,831][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:04:38,357][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:05:08,189][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:05:38,652][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:06:08,163][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:06:38,152][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:07:08,191][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:07:38,261][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:08:08,634][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:08:38,781][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:09:09,418][root][INFO] - Processing question number 70
[2025-02-21 02:09:09,423][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:09:39,223][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:10:09,062][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:10:38,775][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:11:09,076][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:11:39,332][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:12:08,930][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:12:39,330][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:13:09,529][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:13:39,933][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:14:09,738][root][INFO] - Processing question number 80
[2025-02-21 02:14:09,743][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:14:39,971][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:15:10,185][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:15:39,912][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:16:09,677][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:16:40,209][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:17:10,519][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:17:40,930][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:18:10,651][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:18:40,822][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:19:10,328][root][INFO] - Processing question number 90
[2025-02-21 02:19:10,333][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:19:41,262][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:20:10,420][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:20:40,480][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:21:09,798][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:21:40,512][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:22:10,141][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:22:40,124][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:23:10,214][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:23:40,752][root][INFO] - Inference complete
[2025-02-21 02:23:40,752][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,759][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,760][root][WARNING] - No match found for 3. Chosen Option Label in question number 7 in domain Civil_procedure
[2025-02-21 02:23:40,760][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-21 02:23:40,761][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 02:23:40,761][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-21 02:23:40,762][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 02:23:40,763][root][WARNING] - No match found for 3. Chosen Option Label in question number 84 in domain Civil_procedure
[2025-02-21 02:23:40,763][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 02:23:40,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 02:23:40,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 02:23:40,765][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-21 02:23:40,766][root][WARNING] - No match found for 3. Chosen Option Label in question number 3 in domain Contracts
[2025-02-21 02:23:40,767][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 02:23:40,768][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Contracts
[2025-02-21 02:23:40,768][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Torts
[2025-02-21 02:23:40,769][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 02:23:40,769][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 02:23:40,770][root][WARNING] - No match found for 3. Chosen Option Label in question number 62 in domain Torts
[2025-02-21 02:23:40,770][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Torts
[2025-02-21 02:23:40,770][root][WARNING] - No match found for 3. Chosen Option Label in question number 95 in domain Torts
[2025-02-21 02:23:40,771][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 02:23:40,772][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Evidence
[2025-02-21 02:23:40,772][root][WARNING] - No match found for 3. Chosen Option Label in question number 59 in domain Evidence
[2025-02-21 02:23:40,773][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-21 02:23:40,773][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Evidence
[2025-02-21 02:23:40,773][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Evidence
[2025-02-21 02:23:40,774][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 02:23:40,774][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-21 02:23:40,775][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-21 02:23:40,775][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-21 02:23:40,776][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 02:23:40,776][root][WARNING] - No match found for 3. Chosen Option Label in question number 10 in domain Criminal_law
[2025-02-21 02:23:40,777][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 02:23:40,777][root][WARNING] - No match found for 3. Chosen Option Label in question number 45 in domain Criminal_law
[2025-02-21 02:23:40,778][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-21 02:23:40,779][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,784][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,785][root][INFO] - Saved parsed outputs
[2025-02-21 02:23:40,785][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,786][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,786][root][INFO] - Saved parsing metadata
[2025-02-21 02:23:40,787][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,789][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:23:40,790][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:23:40,820][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:23:40,820][root][INFO] - Summary of metrics : {'label_accuracy': 0.29292929292929293, 'misclassification_rate': 0.7070707070707071, 'combined_accuracy': 0.25252525252525254, 'malformed_label': 34, 'malformed_domain': 20, 'total_predictions': 99, 'correct_predictions': 29, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 4, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 02:23:47,403][root][INFO] - Setting global seed to 206
[2025-02-21 02:23:47,409][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:23:47,409][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:23:47,410][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:23:47,412][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:23:47,415][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:23:47,415][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:23:47,570][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:23:47,837][root][INFO] - Full model selected, loading model
[2025-02-21 02:24:00,485][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:25:01,316][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:25:01,317][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:25:28,150][root][INFO] - Peft model loaded successfully
[2025-02-21 02:25:34,439][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:25:34,441][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:25:34,442][root][INFO] - Starting inference
[2025-02-21 02:25:34,584][root][INFO] - Processing question number 0
[2025-02-21 02:25:34,586][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:26:04,161][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:26:34,554][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:27:04,516][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:27:34,945][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:28:04,806][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:28:34,610][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:29:05,204][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:29:35,341][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:30:05,141][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:30:35,601][root][INFO] - Processing question number 10
[2025-02-21 02:30:35,603][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:31:07,392][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:31:36,966][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:32:07,042][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:32:37,672][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:33:08,281][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:33:37,905][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:34:07,461][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:34:37,495][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:35:07,524][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:35:37,264][root][INFO] - Processing question number 20
[2025-02-21 02:35:37,267][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:36:07,269][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:36:37,451][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:37:07,082][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:37:36,648][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:38:06,909][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:38:36,950][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:39:07,794][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:39:37,812][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:40:07,957][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:40:37,361][root][INFO] - Processing question number 30
[2025-02-21 02:40:37,363][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:41:07,700][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:41:38,324][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:42:08,459][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:42:38,478][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:43:08,437][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:43:38,992][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:44:08,940][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:44:39,262][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:45:09,396][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:45:40,268][root][INFO] - Processing question number 40
[2025-02-21 02:45:40,271][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:46:10,455][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:46:40,628][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:47:11,261][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:47:41,989][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:48:11,885][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:48:42,039][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:49:13,494][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:49:42,719][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:50:12,750][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:50:43,424][root][INFO] - Processing question number 50
[2025-02-21 02:50:43,428][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:51:14,335][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:51:44,583][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:52:14,091][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:52:45,279][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:53:15,510][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:53:44,762][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:54:15,633][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:54:45,294][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:55:15,963][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:55:47,471][root][INFO] - Processing question number 60
[2025-02-21 02:55:47,475][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:56:17,117][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:56:47,113][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:57:17,698][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:57:47,312][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:58:17,423][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:58:47,589][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:59:17,782][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:59:48,272][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:00:18,546][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:00:49,300][root][INFO] - Processing question number 70
[2025-02-21 03:00:49,305][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:01:19,260][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:01:49,262][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:02:19,096][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:02:49,582][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:03:20,029][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:03:49,752][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:04:20,289][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:04:50,617][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:05:21,149][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:05:51,105][root][INFO] - Processing question number 80
[2025-02-21 03:05:51,110][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:06:21,502][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:06:51,891][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:07:21,869][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:07:51,922][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:08:22,690][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:08:53,254][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:09:23,935][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:09:53,800][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:10:24,088][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:10:53,690][root][INFO] - Processing question number 90
[2025-02-21 03:10:53,696][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:11:24,744][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:11:53,861][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:12:23,971][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:12:53,368][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:13:23,994][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:13:53,743][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:14:23,776][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:14:54,084][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:15:24,745][root][INFO] - Inference complete
[2025-02-21 03:15:24,746][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,752][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,755][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-21 03:15:24,756][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 03:15:24,757][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-21 03:15:24,757][root][WARNING] - No match found for 3. Chosen Option Label in question number 79 in domain Constitutional_law
[2025-02-21 03:15:24,758][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 03:15:24,759][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Contracts
[2025-02-21 03:15:24,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Property
[2025-02-21 03:15:24,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-21 03:15:24,766][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Criminal_law
[2025-02-21 03:15:24,768][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,773][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,773][root][INFO] - Saved parsed outputs
[2025-02-21 03:15:24,773][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,775][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,775][root][INFO] - Saved parsing metadata
[2025-02-21 03:15:24,775][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,777][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:24,778][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:15:24,808][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:15:24,808][root][INFO] - Summary of metrics : {'label_accuracy': 0.25252525252525254, 'misclassification_rate': 0.7474747474747474, 'combined_accuracy': 0.20202020202020202, 'malformed_label': 9, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 25, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 5, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 03:15:32,043][root][INFO] - Setting global seed to 206
[2025-02-21 03:15:32,050][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:15:32,050][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:15:32,051][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:15:32,053][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:15:32,055][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:15:32,056][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:15:32,212][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:15:32,474][root][INFO] - Full model selected, loading model
[2025-02-21 03:15:49,344][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:15:49,344][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:15:55,819][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:15:55,821][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:15:55,821][root][INFO] - Starting inference
[2025-02-21 03:15:55,978][root][INFO] - Processing question number 0
[2025-02-21 03:15:55,980][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:16:25,322][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:16:55,568][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:17:25,377][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:17:55,652][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:18:25,382][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:18:55,065][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:19:25,539][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:19:55,542][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:20:25,208][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:20:55,532][root][INFO] - Processing question number 10
[2025-02-21 03:20:55,534][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:21:27,195][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:21:56,583][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:22:26,549][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:22:57,090][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:23:27,620][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:23:57,161][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:24:26,539][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:24:56,458][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:25:26,322][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:25:55,952][root][INFO] - Processing question number 20
[2025-02-21 03:25:55,954][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:26:25,792][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:26:55,849][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:27:25,370][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:27:54,742][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:28:24,889][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:28:54,820][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:29:25,514][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:29:55,520][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:30:25,548][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:30:54,843][root][INFO] - Processing question number 30
[2025-02-21 03:30:54,846][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:31:25,065][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:31:55,577][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:32:25,593][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:32:55,407][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:33:25,124][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:33:55,569][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:34:25,362][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:34:55,590][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:35:25,597][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:35:56,288][root][INFO] - Processing question number 40
[2025-02-21 03:35:56,291][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:36:26,359][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:36:56,407][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:37:26,928][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:37:57,497][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:38:27,317][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:38:57,379][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:39:28,718][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:39:57,838][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:40:27,722][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:40:58,292][root][INFO] - Processing question number 50
[2025-02-21 03:40:58,296][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:41:29,025][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:41:59,153][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:42:28,463][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:42:59,530][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:43:29,628][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:43:58,750][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:44:29,439][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:44:58,976][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:45:29,523][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:46:00,918][root][INFO] - Processing question number 60
[2025-02-21 03:46:00,922][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:46:30,475][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:47:00,298][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:47:30,756][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:48:00,248][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:48:30,233][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:49:00,265][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:49:30,326][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:50:00,691][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:50:30,833][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:51:01,459][root][INFO] - Processing question number 70
[2025-02-21 03:51:01,464][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:51:31,254][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:52:01,082][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:52:30,781][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:53:01,073][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:53:31,320][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:54:00,966][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:54:31,506][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:55:01,809][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:55:32,338][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:56:02,224][root][INFO] - Processing question number 80
[2025-02-21 03:56:02,228][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:56:32,614][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:57:02,845][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:57:32,563][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:58:02,319][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:58:32,888][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:59:03,194][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:59:33,596][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:00:03,307][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:00:33,467][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:01:02,960][root][INFO] - Processing question number 90
[2025-02-21 04:01:02,965][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:01:33,882][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:02:02,853][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:02:32,696][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:03:01,963][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:03:32,519][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:04:02,108][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:04:31,975][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:05:02,202][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:05:32,778][root][INFO] - Inference complete
[2025-02-21 04:05:32,778][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,784][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,786][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 04:05:32,786][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-21 04:05:32,788][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 04:05:32,790][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Constitutional_law
[2025-02-21 04:05:32,793][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 04:05:32,795][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 04:05:32,796][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Torts
[2025-02-21 04:05:32,798][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 04:05:32,800][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 04:05:32,803][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-21 04:05:32,805][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,810][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,810][root][INFO] - Saved parsed outputs
[2025-02-21 04:05:32,810][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,821][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,821][root][INFO] - Saved parsing metadata
[2025-02-21 04:05:32,822][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,823][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:05:32,825][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:05:32,837][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:05:32,837][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.23232323232323232, 'malformed_label': 11, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 23, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 8, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 04:05:38,913][root][INFO] - Setting global seed to 989
[2025-02-21 04:05:38,918][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 04:05:38,918][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:05:38,920][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:05:38,922][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:05:38,924][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:05:38,924][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:05:39,076][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:05:39,321][root][INFO] - Full model selected, loading model
[2025-02-21 04:05:56,453][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:06:56,637][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:06:56,637][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:07:22,857][root][INFO] - Peft model loaded successfully
[2025-02-21 04:07:29,015][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:07:29,016][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:07:29,017][root][INFO] - Starting inference
[2025-02-21 04:07:29,183][root][INFO] - Processing question number 0
[2025-02-21 04:07:29,194][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:07:58,582][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:08:28,820][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:08:58,622][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:09:28,890][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:09:58,572][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:10:28,201][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:10:58,612][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:11:28,577][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:11:58,175][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:12:28,437][root][INFO] - Processing question number 10
[2025-02-21 04:12:28,440][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:13:00,044][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:13:29,455][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:13:59,376][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:14:29,894][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:15:00,403][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:15:29,925][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:15:59,357][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:16:29,276][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:16:59,311][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:17:28,897][root][INFO] - Processing question number 20
[2025-02-21 04:17:28,900][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:17:58,738][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:18:28,756][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:18:58,260][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:19:27,687][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:19:57,808][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:20:27,727][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:20:58,422][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:21:28,273][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:21:58,254][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:22:27,495][root][INFO] - Processing question number 30
[2025-02-21 04:22:27,498][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:22:57,664][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:23:28,118][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:23:58,087][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:24:27,908][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:24:57,572][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:25:27,972][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:25:57,758][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:26:27,924][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:26:57,886][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:27:28,566][root][INFO] - Processing question number 40
[2025-02-21 04:27:28,570][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:27:58,581][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:28:28,685][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:28:59,239][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:29:29,650][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:29:59,333][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:30:29,313][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:31:00,594][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:31:29,647][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:31:59,512][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:32:30,017][root][INFO] - Processing question number 50
[2025-02-21 04:32:30,022][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:33:00,751][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:33:30,845][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:34:00,217][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:34:31,238][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:35:01,304][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:35:30,412][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:36:01,111][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:36:30,591][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:37:01,095][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:37:32,427][root][INFO] - Processing question number 60
[2025-02-21 04:37:32,431][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:38:01,898][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:38:31,734][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:39:02,146][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:39:31,597][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:40:01,549][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:40:31,555][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:41:01,564][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:41:31,963][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:42:02,203][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:42:32,890][root][INFO] - Processing question number 70
[2025-02-21 04:42:32,896][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:43:02,844][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:43:32,779][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:44:02,561][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:44:32,847][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:45:03,082][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:45:32,630][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:46:02,961][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:46:33,099][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:47:03,442][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:47:33,234][root][INFO] - Processing question number 80
[2025-02-21 04:47:33,239][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:48:03,453][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:48:33,649][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:49:03,325][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:49:33,119][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:50:03,615][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:50:33,911][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:51:04,284][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:51:33,966][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:52:04,094][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:52:33,545][root][INFO] - Processing question number 90
[2025-02-21 04:52:33,550][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:53:04,555][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:53:33,642][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:54:03,580][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:54:32,808][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:55:03,257][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:55:32,815][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:56:02,578][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:56:32,625][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:57:03,108][root][INFO] - Inference complete
[2025-02-21 04:57:03,108][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,115][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,116][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-21 04:57:03,117][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Civil_procedure
[2025-02-21 04:57:03,117][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-21 04:57:03,117][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Civil_procedure
[2025-02-21 04:57:03,118][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-21 04:57:03,118][root][WARNING] - No match found for 3. Chosen Option Label in question number 77 in domain Civil_procedure
[2025-02-21 04:57:03,118][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-21 04:57:03,119][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 04:57:03,119][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Constitutional_law
[2025-02-21 04:57:03,119][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 04:57:03,120][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 04:57:03,120][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 04:57:03,120][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-21 04:57:03,121][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 04:57:03,121][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-21 04:57:03,122][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 04:57:03,122][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Constitutional_law
[2025-02-21 04:57:03,122][root][WARNING] - No match found for 3. Chosen Option Label in question number 3 in domain Contracts
[2025-02-21 04:57:03,123][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Contracts
[2025-02-21 04:57:03,123][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Contracts
[2025-02-21 04:57:03,123][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 04:57:03,124][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 04:57:03,124][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 04:57:03,125][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-21 04:57:03,125][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-21 04:57:03,125][root][WARNING] - No match found for 3. Chosen Option Label in question number 4 in domain Torts
[2025-02-21 04:57:03,125][root][WARNING] - No match found for 3. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 04:57:03,126][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 04:57:03,126][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Torts
[2025-02-21 04:57:03,126][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 04:57:03,127][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 04:57:03,127][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Torts
[2025-02-21 04:57:03,128][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 04:57:03,128][root][WARNING] - No match found for 3. Chosen Option Label in question number 23 in domain Evidence
[2025-02-21 04:57:03,128][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 04:57:03,129][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Evidence
[2025-02-21 04:57:03,129][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Evidence
[2025-02-21 04:57:03,130][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-21 04:57:03,130][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 04:57:03,131][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Property
[2025-02-21 04:57:03,131][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Property
[2025-02-21 04:57:03,132][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Property
[2025-02-21 04:57:03,132][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-21 04:57:03,132][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-21 04:57:03,133][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 04:57:03,133][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 04:57:03,133][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 04:57:03,133][root][WARNING] - No match found for 3. Chosen Option Label in question number 10 in domain Criminal_law
[2025-02-21 04:57:03,134][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 04:57:03,134][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-21 04:57:03,134][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 04:57:03,135][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-21 04:57:03,135][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Criminal_law
[2025-02-21 04:57:03,136][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-21 04:57:03,137][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,153][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,153][root][INFO] - Saved parsed outputs
[2025-02-21 04:57:03,153][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,155][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,155][root][INFO] - Saved parsing metadata
[2025-02-21 04:57:03,155][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,157][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:03,159][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:57:03,182][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:57:03,183][root][INFO] - Summary of metrics : {'label_accuracy': 0.2222222222222222, 'misclassification_rate': 0.7777777777777778, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 54, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 22, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 61, 'correct_label_wrong_domain': 3, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 04:57:10,549][root][INFO] - Setting global seed to 989
[2025-02-21 04:57:10,556][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:57:10,556][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:57:10,558][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:57:10,560][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:57:10,562][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:57:10,562][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:57:10,714][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:57:10,950][root][INFO] - Full model selected, loading model
[2025-02-21 04:57:28,512][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:57:28,512][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:57:34,983][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:57:34,984][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:57:34,984][root][INFO] - Starting inference
[2025-02-21 04:57:35,140][root][INFO] - Processing question number 0
[2025-02-21 04:57:35,142][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:58:04,167][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:58:34,216][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:59:03,825][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:59:33,902][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:00:03,431][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:00:32,916][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:01:03,189][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:01:32,995][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:02:02,436][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:02:32,533][root][INFO] - Processing question number 10
[2025-02-21 05:02:32,536][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:03:04,031][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:03:33,216][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:04:03,099][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:04:33,542][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:05:03,850][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:05:33,175][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:06:02,339][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:06:32,060][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:07:01,724][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:07:31,174][root][INFO] - Processing question number 20
[2025-02-21 05:07:31,178][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:08:00,817][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:08:30,673][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:08:59,995][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:09:29,174][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:09:59,146][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:10:28,884][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:10:59,380][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:11:29,051][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:11:58,886][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:12:27,996][root][INFO] - Processing question number 30
[2025-02-21 05:12:27,999][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:12:58,018][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:13:28,327][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:13:58,148][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:14:27,766][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:14:57,282][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:15:27,534][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:15:57,123][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:16:27,134][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:16:56,945][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:17:27,438][root][INFO] - Processing question number 40
[2025-02-21 05:17:27,441][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:17:57,304][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:18:27,174][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:18:57,648][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:19:27,949][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:19:57,481][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:20:27,303][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:20:58,445][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:21:27,360][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:21:57,032][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:22:27,391][root][INFO] - Processing question number 50
[2025-02-21 05:22:27,395][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:22:57,929][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:23:27,868][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:23:56,981][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:24:27,854][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:24:57,752][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:25:26,726][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:25:57,223][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:26:26,565][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:26:56,914][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:27:28,106][root][INFO] - Processing question number 60
[2025-02-21 05:27:28,110][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:27:57,429][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:28:27,141][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:28:57,554][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:29:26,963][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:29:56,904][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:30:26,837][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:30:56,854][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:31:27,021][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:31:56,963][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:32:27,387][root][INFO] - Processing question number 70
[2025-02-21 05:32:27,392][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:32:56,983][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:33:26,623][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:33:56,147][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:34:26,243][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:34:56,289][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:35:25,682][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:35:55,877][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:36:25,875][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:36:56,071][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:37:25,665][root][INFO] - Processing question number 80
[2025-02-21 05:37:25,669][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:37:55,692][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:38:25,705][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:38:55,229][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:39:24,794][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:39:55,127][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:40:25,239][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:40:55,442][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:41:24,962][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:41:54,926][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:42:24,224][root][INFO] - Processing question number 90
[2025-02-21 05:42:24,229][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:42:54,989][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:43:23,907][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:43:53,703][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:44:22,762][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:44:53,094][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:45:22,526][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:45:52,187][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:46:22,110][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:46:52,444][root][INFO] - Inference complete
[2025-02-21 05:46:52,445][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,451][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,452][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-21 05:46:52,453][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 05:46:52,453][root][WARNING] - No match found for 3. Chosen Option Label in question number 49 in domain Civil_procedure
[2025-02-21 05:46:52,454][root][WARNING] - No match found for 3. Chosen Option Label in question number 56 in domain Civil_procedure
[2025-02-21 05:46:52,454][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Civil_procedure
[2025-02-21 05:46:52,455][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Civil_procedure
[2025-02-21 05:46:52,455][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 05:46:52,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 05:46:52,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 05:46:52,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 05:46:52,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-21 05:46:52,457][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 05:46:52,457][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-21 05:46:52,458][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 05:46:52,458][root][WARNING] - No match found for 3. Chosen Option Label in question number 3 in domain Contracts
[2025-02-21 05:46:52,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Contracts
[2025-02-21 05:46:52,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 05:46:52,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Contracts
[2025-02-21 05:46:52,460][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 05:46:52,460][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 05:46:52,461][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Contracts
[2025-02-21 05:46:52,461][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-21 05:46:52,462][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 05:46:52,462][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 05:46:52,462][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 05:46:52,463][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-21 05:46:52,463][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Torts
[2025-02-21 05:46:52,464][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 05:46:52,464][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Evidence
[2025-02-21 05:46:52,465][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Evidence
[2025-02-21 05:46:52,466][root][WARNING] - No match found for 3. Chosen Option Label in question number 73 in domain Evidence
[2025-02-21 05:46:52,466][root][WARNING] - No match found for 3. Chosen Option Label in question number 78 in domain Evidence
[2025-02-21 05:46:52,467][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 05:46:52,467][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Property
[2025-02-21 05:46:52,468][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-21 05:46:52,468][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 05:46:52,469][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 05:46:52,469][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 05:46:52,469][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 05:46:52,470][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 05:46:52,470][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 05:46:52,471][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 05:46:52,471][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-21 05:46:52,471][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 05:46:52,472][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,478][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,478][root][INFO] - Saved parsed outputs
[2025-02-21 05:46:52,478][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,479][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,479][root][INFO] - Saved parsing metadata
[2025-02-21 05:46:52,480][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,481][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:46:52,482][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:46:52,494][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 05:46:52,494][root][INFO] - Summary of metrics : {'label_accuracy': 0.2222222222222222, 'misclassification_rate': 0.7777777777777778, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 44, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 22, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 5, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 05:46:58,582][root][INFO] - Setting global seed to 989
[2025-02-21 05:46:58,587][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 05:46:58,587][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:46:58,588][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:46:58,590][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:46:58,591][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:46:58,592][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:46:58,739][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:46:58,989][root][INFO] - Full model selected, loading model
[2025-02-21 05:47:16,198][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:48:17,239][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:48:17,240][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:48:43,515][root][INFO] - Peft model loaded successfully
[2025-02-21 05:48:49,677][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:48:49,678][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:48:49,678][root][INFO] - Starting inference
[2025-02-21 05:48:49,825][root][INFO] - Processing question number 0
[2025-02-21 05:48:49,834][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:49:19,372][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:49:49,772][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:50:19,738][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:50:50,185][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:51:20,197][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:51:50,000][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:52:20,588][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:52:50,710][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:53:20,471][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:53:50,911][root][INFO] - Processing question number 10
[2025-02-21 05:53:50,913][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:54:22,703][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:54:52,268][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:55:22,354][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:55:52,989][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:56:23,605][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:56:53,237][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:57:22,798][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:57:52,834][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:58:22,859][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:58:52,631][root][INFO] - Processing question number 20
[2025-02-21 05:58:52,634][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:59:22,646][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:59:52,840][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:00:22,494][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:00:52,064][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:01:22,333][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:01:52,384][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:02:23,271][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:02:53,320][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:03:23,498][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:03:52,930][root][INFO] - Processing question number 30
[2025-02-21 06:03:52,933][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:04:23,296][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:04:53,928][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:05:24,069][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:05:54,038][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:06:23,868][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:06:54,427][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:07:24,375][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:07:54,697][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:08:24,825][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:08:55,704][root][INFO] - Processing question number 40
[2025-02-21 06:08:55,708][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:09:26,064][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:09:56,241][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:10:26,880][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:10:57,468][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:11:27,345][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:11:57,504][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:12:28,975][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:12:58,208][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:13:28,238][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:13:58,906][root][INFO] - Processing question number 50
[2025-02-21 06:13:58,909][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:14:29,820][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:15:00,070][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:15:29,610][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:16:00,918][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:16:31,284][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:17:00,652][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:17:31,632][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:18:01,434][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:18:32,169][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:19:03,673][root][INFO] - Processing question number 60
[2025-02-21 06:19:03,677][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:19:33,315][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:20:03,300][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:20:33,904][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:21:03,538][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:21:33,648][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:22:03,807][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:22:33,996][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:23:04,470][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:23:34,730][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:24:05,486][root][INFO] - Processing question number 70
[2025-02-21 06:24:05,491][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:24:35,443][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:25:05,438][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:25:35,268][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:26:05,714][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:26:36,129][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:27:05,834][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:27:36,348][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:28:06,659][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:28:37,177][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:29:07,128][root][INFO] - Processing question number 80
[2025-02-21 06:29:07,132][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:29:37,524][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:30:07,903][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:30:37,744][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:31:07,663][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:31:38,318][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:32:08,784][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:32:39,311][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:33:09,149][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:33:39,438][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:34:09,179][root][INFO] - Processing question number 90
[2025-02-21 06:34:09,184][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:34:40,392][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:35:09,605][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:35:39,721][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:36:09,113][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:36:39,711][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:37:09,342][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:37:39,283][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:38:09,520][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:38:40,357][root][INFO] - Inference complete
[2025-02-21 06:38:40,357][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,367][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,368][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Civil_procedure
[2025-02-21 06:38:40,369][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Civil_procedure
[2025-02-21 06:38:40,370][root][WARNING] - No match found for 3. Chosen Option Label in question number 84 in domain Civil_procedure
[2025-02-21 06:38:40,370][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Constitutional_law
[2025-02-21 06:38:40,371][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Constitutional_law
[2025-02-21 06:38:40,371][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Constitutional_law
[2025-02-21 06:38:40,371][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 06:38:40,372][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-21 06:38:40,372][root][WARNING] - No match found for 3. Chosen Option Label in question number 43 in domain Constitutional_law
[2025-02-21 06:38:40,372][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 06:38:40,372][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Constitutional_law
[2025-02-21 06:38:40,373][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 06:38:40,373][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Constitutional_law
[2025-02-21 06:38:40,374][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Contracts
[2025-02-21 06:38:40,374][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 06:38:40,375][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 06:38:40,375][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 06:38:40,376][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Contracts
[2025-02-21 06:38:40,376][root][WARNING] - No match found for 3. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 06:38:40,376][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 06:38:40,377][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 06:38:40,377][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Torts
[2025-02-21 06:38:40,377][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 06:38:40,378][root][WARNING] - No match found for 3. Chosen Option Label in question number 62 in domain Torts
[2025-02-21 06:38:40,378][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Torts
[2025-02-21 06:38:40,379][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Torts
[2025-02-21 06:38:40,379][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 06:38:40,380][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Evidence
[2025-02-21 06:38:40,380][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Evidence
[2025-02-21 06:38:40,381][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 06:38:40,381][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Property
[2025-02-21 06:38:40,382][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Property
[2025-02-21 06:38:40,382][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-21 06:38:40,383][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Property
[2025-02-21 06:38:40,383][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Property
[2025-02-21 06:38:40,383][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 06:38:40,384][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Property
[2025-02-21 06:38:40,384][root][WARNING] - No match found for 3. Chosen Option Label in question number 15 in domain Criminal_law
[2025-02-21 06:38:40,384][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Criminal_law
[2025-02-21 06:38:40,385][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-21 06:38:40,385][root][WARNING] - No match found for 3. Chosen Option Label in question number 45 in domain Criminal_law
[2025-02-21 06:38:40,385][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 06:38:40,386][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Criminal_law
[2025-02-21 06:38:40,386][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Criminal_law
[2025-02-21 06:38:40,387][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,401][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,401][root][INFO] - Saved parsed outputs
[2025-02-21 06:38:40,402][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,403][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,403][root][INFO] - Saved parsing metadata
[2025-02-21 06:38:40,404][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,407][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:38:40,410][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:38:40,420][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 06:38:40,421][root][INFO] - Summary of metrics : {'label_accuracy': 0.20202020202020202, 'misclassification_rate': 0.797979797979798, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 44, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 20, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1111111111111111, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.09090909090909091, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 59, 'correct_label_wrong_domain': 3, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 06:38:47,182][root][INFO] - Setting global seed to 989
[2025-02-21 06:38:47,188][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 06:38:47,188][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:38:47,190][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:38:47,191][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:38:47,193][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:38:47,193][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:38:47,455][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:38:47,703][root][INFO] - Full model selected, loading model
[2025-02-21 06:39:04,790][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:39:04,790][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:39:11,240][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:39:11,241][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:39:11,241][root][INFO] - Starting inference
[2025-02-21 06:39:11,376][root][INFO] - Processing question number 0
[2025-02-21 06:39:11,379][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:39:40,730][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:40:10,958][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:40:40,746][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:41:11,001][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:41:40,709][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:42:10,371][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:42:40,824][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:43:10,864][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:43:40,493][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:44:10,753][root][INFO] - Processing question number 10
[2025-02-21 06:44:10,755][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:44:42,384][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:45:11,739][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:45:41,686][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:46:12,190][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:46:42,673][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:47:12,175][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:47:41,523][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:48:11,423][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:48:41,269][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:49:10,880][root][INFO] - Processing question number 20
[2025-02-21 06:49:10,883][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:49:40,694][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:50:10,729][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:50:40,224][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:51:09,570][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:51:39,694][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:52:09,651][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:52:40,298][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:53:10,130][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:53:40,129][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:54:09,398][root][INFO] - Processing question number 30
[2025-02-21 06:54:09,402][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:54:39,591][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:55:10,081][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:55:40,113][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:56:09,909][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:56:39,603][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:57:10,024][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:57:39,797][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:58:09,979][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:58:39,967][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:59:10,631][root][INFO] - Processing question number 40
[2025-02-21 06:59:10,634][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:59:40,794][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:00:10,863][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:00:41,363][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:01:11,822][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:01:41,549][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:02:11,559][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:02:42,906][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:03:12,154][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:03:42,177][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:04:12,820][root][INFO] - Processing question number 50
[2025-02-21 07:04:12,824][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:04:43,655][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:05:13,923][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:05:43,303][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:06:14,357][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:06:44,449][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:07:13,564][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:07:44,240][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:08:13,772][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:08:44,308][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:09:15,676][root][INFO] - Processing question number 60
[2025-02-21 07:09:15,681][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:09:45,202][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:10:15,036][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:10:45,498][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:11:15,010][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:11:45,028][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:12:15,065][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:12:45,131][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:13:15,498][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:13:45,643][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:14:16,260][root][INFO] - Processing question number 70
[2025-02-21 07:14:16,265][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:14:46,047][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:15:15,866][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:15:45,562][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:16:15,850][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:16:46,092][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:17:15,666][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:17:46,039][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:18:16,208][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:18:46,588][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:19:16,363][root][INFO] - Processing question number 80
[2025-02-21 07:19:16,368][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:19:46,575][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:20:16,770][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:20:46,473][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:21:16,211][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:21:46,723][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:22:17,008][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:22:47,401][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:23:17,097][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:23:47,259][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:24:16,882][root][INFO] - Processing question number 90
[2025-02-21 07:24:16,887][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:24:47,948][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:25:17,003][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:25:47,025][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:26:16,302][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:26:46,784][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:27:16,256][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:27:46,006][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:28:16,074][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:28:46,585][root][INFO] - Inference complete
[2025-02-21 07:28:46,585][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,592][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,593][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Civil_procedure
[2025-02-21 07:28:46,594][root][WARNING] - No match found for 3. Chosen Option Label in question number 56 in domain Civil_procedure
[2025-02-21 07:28:46,596][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Constitutional_law
[2025-02-21 07:28:46,596][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 07:28:46,597][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Constitutional_law
[2025-02-21 07:28:46,597][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Constitutional_law
[2025-02-21 07:28:46,598][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Contracts
[2025-02-21 07:28:46,599][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Contracts
[2025-02-21 07:28:46,599][root][WARNING] - No match found for 3. Chosen Option Label in question number 22 in domain Contracts
[2025-02-21 07:28:46,599][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 07:28:46,600][root][WARNING] - No match found for 3. Chosen Option Label in question number 51 in domain Contracts
[2025-02-21 07:28:46,600][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Contracts
[2025-02-21 07:28:46,601][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Contracts
[2025-02-21 07:28:46,601][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Torts
[2025-02-21 07:28:46,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 41 in domain Torts
[2025-02-21 07:28:46,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 07:28:46,602][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 07:28:46,603][root][WARNING] - No match found for 3. Chosen Option Label in question number 76 in domain Torts
[2025-02-21 07:28:46,603][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Torts
[2025-02-21 07:28:46,604][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Evidence
[2025-02-21 07:28:46,605][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Evidence
[2025-02-21 07:28:46,605][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Evidence
[2025-02-21 07:28:46,606][root][WARNING] - No match found for 3. Chosen Option Label in question number 78 in domain Evidence
[2025-02-21 07:28:46,606][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Evidence
[2025-02-21 07:28:46,606][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 07:28:46,607][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Property
[2025-02-21 07:28:46,607][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Property
[2025-02-21 07:28:46,608][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Property
[2025-02-21 07:28:46,609][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 07:28:46,609][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 07:28:46,610][root][WARNING] - No match found for 3. Chosen Option Label in question number 30 in domain Criminal_law
[2025-02-21 07:28:46,610][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Criminal_law
[2025-02-21 07:28:46,610][root][WARNING] - No match found for 3. Chosen Option Label in question number 45 in domain Criminal_law
[2025-02-21 07:28:46,610][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 07:28:46,611][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Criminal_law
[2025-02-21 07:28:46,611][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Criminal_law
[2025-02-21 07:28:46,612][root][WARNING] - No match found for 3. Chosen Option Label in question number 92 in domain Criminal_law
[2025-02-21 07:28:46,612][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,617][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,618][root][INFO] - Saved parsed outputs
[2025-02-21 07:28:46,618][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,619][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,619][root][INFO] - Saved parsing metadata
[2025-02-21 07:28:46,619][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,621][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:28:46,622][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:28:46,639][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 07:28:46,639][root][INFO] - Summary of metrics : {'label_accuracy': 0.23232323232323232, 'misclassification_rate': 0.7676767676767677, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 37, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 23, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 7, 'both_wrong': 21}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 07:28:54,070][root][INFO] - Setting global seed to 989
[2025-02-21 07:28:54,077][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 07:28:54,078][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 07:28:54,079][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:28:54,080][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:28:54,083][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:28:54,083][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:28:54,226][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:28:54,499][root][INFO] - Full model selected, loading model
[2025-02-21 07:29:11,784][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:30:13,278][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:30:13,278][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:30:39,698][root][INFO] - Peft model loaded successfully
[2025-02-21 07:30:45,926][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:30:45,927][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:30:45,927][root][INFO] - Starting inference
[2025-02-21 07:30:46,081][root][INFO] - Processing question number 0
[2025-02-21 07:30:46,089][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:31:15,635][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:31:46,014][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:32:15,961][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:32:46,380][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:33:16,212][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:33:45,997][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:34:16,596][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:34:46,698][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:35:16,437][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:35:46,859][root][INFO] - Processing question number 10
[2025-02-21 07:35:46,861][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:36:18,628][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:36:48,179][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:37:18,244][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:37:48,862][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:38:19,461][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:38:49,072][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:39:18,613][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:39:48,627][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:40:18,631][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:40:48,359][root][INFO] - Processing question number 20
[2025-02-21 07:40:48,361][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:41:18,335][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:41:48,493][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:42:18,104][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:42:47,658][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:43:17,905][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:43:47,968][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:44:18,801][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:44:48,810][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:45:18,939][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:45:48,331][root][INFO] - Processing question number 30
[2025-02-21 07:45:48,333][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:46:18,678][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:46:49,298][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:47:19,428][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:47:49,402][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:48:19,230][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:48:49,782][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:49:19,715][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:49:50,242][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:50:20,554][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:50:51,518][root][INFO] - Processing question number 40
[2025-02-21 07:50:51,522][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:51:21,861][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:51:52,118][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:52:22,869][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:52:53,428][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:53:23,248][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:53:53,370][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:54:24,786][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:54:53,979][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:55:23,980][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:55:54,627][root][INFO] - Processing question number 50
[2025-02-21 07:55:54,631][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:56:25,500][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:56:55,725][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:57:25,211][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:57:56,366][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:58:26,564][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:58:55,804][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:59:26,668][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:59:56,314][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:00:26,966][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:00:58,450][root][INFO] - Processing question number 60
[2025-02-21 08:00:58,454][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:01:28,068][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:01:58,033][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:02:28,586][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:02:58,170][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:03:28,246][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:03:58,382][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:04:28,575][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:04:59,058][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:05:29,293][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:06:00,020][root][INFO] - Processing question number 70
[2025-02-21 08:06:00,024][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:06:29,951][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:06:59,925][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:07:29,730][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:08:00,158][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:08:30,548][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:09:00,237][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:09:30,724][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:10:01,020][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:10:31,509][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:11:01,438][root][INFO] - Processing question number 80
[2025-02-21 08:11:01,443][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:11:31,805][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:12:02,162][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:12:32,090][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:13:02,049][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:13:32,679][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:14:03,117][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:14:33,727][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:15:03,692][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:15:34,051][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:16:03,748][root][INFO] - Processing question number 90
[2025-02-21 08:16:03,754][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:16:34,910][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:17:04,062][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:17:34,040][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:18:03,264][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:18:33,766][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:19:03,350][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:19:33,257][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:20:03,438][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:20:34,132][root][INFO] - Inference complete
[2025-02-21 08:20:34,132][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,152][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,155][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Constitutional_law
[2025-02-21 08:20:34,156][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Constitutional_law
[2025-02-21 08:20:34,159][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Torts
[2025-02-21 08:20:34,160][root][WARNING] - No match found for 3. Chosen Option Label in question number 62 in domain Torts
[2025-02-21 08:20:34,162][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Property
[2025-02-21 08:20:34,163][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Property
[2025-02-21 08:20:34,163][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Property
[2025-02-21 08:20:34,165][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Criminal_law
[2025-02-21 08:20:34,167][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,185][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,185][root][INFO] - Saved parsed outputs
[2025-02-21 08:20:34,185][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,200][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,200][root][INFO] - Saved parsing metadata
[2025-02-21 08:20:34,201][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,203][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:20:34,225][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:20:34,238][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 08:20:34,238][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.15151515151515152, 'malformed_label': 8, 'malformed_domain': 34, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 15, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 50, 'correct_label_wrong_domain': 11, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 08:20:40,431][root][INFO] - Setting global seed to 989
[2025-02-21 08:20:40,436][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 08:20:40,436][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 08:20:40,437][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:20:40,439][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:20:40,441][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:20:40,441][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:20:40,623][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:20:40,881][root][INFO] - Full model selected, loading model
[2025-02-21 08:20:59,184][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:20:59,184][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:21:05,670][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:21:05,672][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:21:05,672][root][INFO] - Starting inference
[2025-02-21 08:21:05,848][root][INFO] - Processing question number 0
[2025-02-21 08:21:05,858][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:21:35,524][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:22:05,771][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:22:35,584][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:23:05,905][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:23:35,624][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:24:05,296][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:24:35,755][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:25:05,745][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:25:35,381][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:26:05,650][root][INFO] - Processing question number 10
[2025-02-21 08:26:05,652][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:26:37,290][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:27:06,656][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:27:36,608][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:28:07,117][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:28:37,606][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:29:07,117][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:29:36,475][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:30:06,383][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:30:36,234][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:31:05,860][root][INFO] - Processing question number 20
[2025-02-21 08:31:05,862][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:31:35,690][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:32:05,739][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:32:35,255][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:33:04,620][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:33:34,759][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:34:04,680][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:34:35,340][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:35:05,187][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:35:35,201][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:36:04,497][root][INFO] - Processing question number 30
[2025-02-21 08:36:04,500][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:36:34,759][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:37:05,398][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:37:35,571][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:38:05,483][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:38:35,343][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:39:05,944][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:39:35,821][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:40:06,079][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:40:36,149][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:41:06,821][root][INFO] - Processing question number 40
[2025-02-21 08:41:06,824][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:41:36,875][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:42:06,916][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:42:37,425][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:43:07,877][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:43:37,600][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:44:07,607][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:44:38,926][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:45:08,027][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:45:37,892][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:46:08,436][root][INFO] - Processing question number 50
[2025-02-21 08:46:08,441][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:46:39,158][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:47:09,281][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:47:38,587][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:48:09,646][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:48:39,746][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:49:08,887][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:49:39,580][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:50:09,129][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:50:39,688][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:51:11,061][root][INFO] - Processing question number 60
[2025-02-21 08:51:11,065][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:51:40,588][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:52:10,410][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:52:40,861][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:53:10,355][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:53:40,332][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:54:10,358][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:54:40,455][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:55:10,829][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:55:40,969][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:56:11,598][root][INFO] - Processing question number 70
[2025-02-21 08:56:11,603][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:56:41,400][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:57:11,230][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:57:40,927][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:58:11,206][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:58:41,441][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:59:11,023][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:59:41,516][root][INFO] - Domain : Property, Question : 48
[2025-02-21 09:00:11,759][root][INFO] - Domain : Property, Question : 54
[2025-02-21 09:00:42,164][root][INFO] - Domain : Property, Question : 61
[2025-02-21 09:01:11,951][root][INFO] - Processing question number 80
[2025-02-21 09:01:11,956][root][INFO] - Domain : Property, Question : 67
[2025-02-21 09:01:42,178][root][INFO] - Domain : Property, Question : 75
[2025-02-21 09:02:12,389][root][INFO] - Domain : Property, Question : 83
[2025-02-21 09:02:42,098][root][INFO] - Domain : Property, Question : 89
[2025-02-21 09:03:11,841][root][INFO] - Domain : Property, Question : 97
[2025-02-21 09:03:42,355][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:04:12,645][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 09:04:43,044][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:05:12,758][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 09:05:42,908][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 09:06:12,390][root][INFO] - Processing question number 90
[2025-02-21 09:06:12,395][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 09:06:43,302][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 09:07:12,266][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 09:07:42,090][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 09:08:11,227][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:08:41,618][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:09:11,094][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:09:40,847][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:10:10,912][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:10:41,427][root][INFO] - Inference complete
[2025-02-21 09:10:41,427][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,433][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,438][root][WARNING] - No match found for 3. Chosen Option Label in question number 65 in domain Constitutional_law
[2025-02-21 09:10:41,440][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Contracts
[2025-02-21 09:10:41,441][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Contracts
[2025-02-21 09:10:41,445][root][WARNING] - No match found for 3. Chosen Option Label in question number 40 in domain Evidence
[2025-02-21 09:10:41,446][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Evidence
[2025-02-21 09:10:41,447][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Property
[2025-02-21 09:10:41,449][root][WARNING] - No match found for 3. Chosen Option Label in question number 89 in domain Property
[2025-02-21 09:10:41,452][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,457][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,457][root][INFO] - Saved parsed outputs
[2025-02-21 09:10:41,458][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,459][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,459][root][INFO] - Saved parsing metadata
[2025-02-21 09:10:41,459][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,461][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:10:41,468][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:10:41,482][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_1
[2025-02-21 09:10:41,482][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.1919191919191919, 'malformed_label': 10, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.08080808080808081, 'Real_Property_confidence': 0.08080808080808081, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 12, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 09:10:47,512][root][INFO] - Setting global seed to 206
[2025-02-21 09:10:47,517][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:10:47,517][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 09:10:47,518][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:10:47,519][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:10:47,521][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:10:47,521][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:10:47,691][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:10:47,933][root][INFO] - Full model selected, loading model
[2025-02-21 09:10:59,620][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:11:59,736][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:11:59,737][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:12:25,939][root][INFO] - Peft model loaded successfully
[2025-02-21 09:12:32,107][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:12:32,109][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:12:32,109][root][INFO] - Starting inference
[2025-02-21 09:12:32,276][root][INFO] - Processing question number 0
[2025-02-21 09:13:05,506][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:13:35,720][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:14:06,492][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:14:37,390][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:15:07,763][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:15:37,556][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:16:06,753][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:16:36,464][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:17:06,477][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:17:35,737][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:18:05,661][root][INFO] - Processing question number 10
[2025-02-21 09:18:05,663][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 09:18:34,768][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 09:19:04,465][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 09:19:34,313][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 09:20:03,674][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 09:20:33,962][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 09:21:03,872][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:21:33,720][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 09:22:03,424][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 09:22:33,668][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 09:23:03,999][root][INFO] - Processing question number 20
[2025-02-21 09:23:04,001][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 09:23:33,136][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 09:24:03,300][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:24:33,074][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 09:25:02,902][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 09:25:32,852][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 09:26:03,322][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 09:26:33,293][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 09:27:03,339][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:27:33,214][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 09:28:03,686][root][INFO] - Processing question number 30
[2025-02-21 09:28:03,689][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 09:28:33,617][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 09:29:03,375][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 09:29:33,075][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 09:30:03,497][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 09:30:33,338][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 09:31:03,307][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:31:33,211][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 09:32:03,724][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:32:33,763][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 09:33:03,816][root][INFO] - Processing question number 40
[2025-02-21 09:33:03,820][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 09:33:33,837][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 09:34:03,685][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 09:34:34,022][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 09:35:03,213][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 09:35:33,735][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 09:36:03,747][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:36:33,610][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:37:03,634][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 09:37:33,551][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 09:38:03,840][root][INFO] - Processing question number 50
[2025-02-21 09:38:03,844][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 09:38:34,358][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 09:39:03,823][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 09:39:34,343][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:40:04,480][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 09:40:33,997][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 09:41:03,795][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 09:41:34,489][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 09:42:04,964][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 09:42:35,382][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 09:43:05,618][root][INFO] - Processing question number 60
[2025-02-21 09:43:05,622][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 09:43:35,644][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 09:44:05,687][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 09:44:36,421][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 09:45:06,679][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 09:45:36,825][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 09:46:06,496][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 09:46:36,149][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 09:47:05,611][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 09:47:35,257][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 09:48:04,824][root][INFO] - Processing question number 70
[2025-02-21 09:48:04,828][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 09:48:34,976][root][INFO] - Domain : Property, Question : 9
[2025-02-21 09:49:05,024][root][INFO] - Domain : Property, Question : 17
[2025-02-21 09:49:35,311][root][INFO] - Domain : Property, Question : 25
[2025-02-21 09:50:06,105][root][INFO] - Domain : Property, Question : 30
[2025-02-21 09:50:35,674][root][INFO] - Domain : Property, Question : 36
[2025-02-21 09:51:05,934][root][INFO] - Domain : Property, Question : 46
[2025-02-21 09:51:37,166][root][INFO] - Domain : Property, Question : 53
[2025-02-21 09:52:07,399][root][INFO] - Domain : Property, Question : 59
[2025-02-21 09:52:36,580][root][INFO] - Domain : Property, Question : 66
[2025-02-21 09:53:06,202][root][INFO] - Processing question number 80
[2025-02-21 09:53:06,206][root][INFO] - Domain : Property, Question : 69
[2025-02-21 09:53:36,706][root][INFO] - Domain : Property, Question : 81
[2025-02-21 09:54:07,260][root][INFO] - Domain : Property, Question : 88
[2025-02-21 09:54:37,725][root][INFO] - Domain : Property, Question : 91
[2025-02-21 09:55:07,934][root][INFO] - Domain : Property, Question : 94
[2025-02-21 09:55:39,114][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:56:08,920][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:56:39,273][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 09:57:10,167][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 09:57:40,211][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:58:10,283][root][INFO] - Processing question number 90
[2025-02-21 09:58:10,288][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 09:58:40,381][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 09:59:10,845][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:59:41,090][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:00:11,079][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:00:41,770][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:01:12,317][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:01:42,588][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:02:12,448][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:02:41,903][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:03:12,495][root][INFO] - Inference complete
[2025-02-21 10:03:12,495][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,502][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,504][root][WARNING] - No match found for 3. Chosen Option Label in question number 1 in domain Constitutional_law
[2025-02-21 10:03:12,504][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Constitutional_law
[2025-02-21 10:03:12,504][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 10:03:12,504][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 10:03:12,506][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 10:03:12,506][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Criminal_law
[2025-02-21 10:03:12,507][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Criminal_law
[2025-02-21 10:03:12,507][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 10:03:12,507][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Criminal_law
[2025-02-21 10:03:12,508][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Criminal_law
[2025-02-21 10:03:12,508][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 10:03:12,508][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Criminal_law
[2025-02-21 10:03:12,509][root][WARNING] - No match found for 3. Chosen Option Label in question number 76 in domain Criminal_law
[2025-02-21 10:03:12,509][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 10:03:12,510][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 10:03:12,510][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 10:03:12,510][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 10:03:12,511][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 10:03:12,511][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 10:03:12,512][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Evidence
[2025-02-21 10:03:12,512][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 10:03:12,513][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Evidence
[2025-02-21 10:03:12,514][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Evidence
[2025-02-21 10:03:12,514][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 10:03:12,515][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 10:03:12,515][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 10:03:12,516][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 10:03:12,516][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 10:03:12,516][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 10:03:12,516][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Civil_procedure
[2025-02-21 10:03:12,517][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Civil_procedure
[2025-02-21 10:03:12,517][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 10:03:12,518][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 10:03:12,518][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 10:03:12,519][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 10:03:12,519][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Property
[2025-02-21 10:03:12,519][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 10:03:12,519][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 10:03:12,520][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Property
[2025-02-21 10:03:12,520][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 10:03:12,521][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Torts
[2025-02-21 10:03:12,521][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Torts
[2025-02-21 10:03:12,522][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 10:03:12,522][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 10:03:12,523][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,529][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,529][root][INFO] - Saved parsed outputs
[2025-02-21 10:03:12,529][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,530][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,530][root][INFO] - Saved parsing metadata
[2025-02-21 10:03:12,531][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,532][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:12,541][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:03:12,553][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 10:03:12,553][root][INFO] - Summary of metrics : {'label_accuracy': 0.12, 'misclassification_rate': 0.88, 'combined_accuracy': 0.12, 'malformed_label': 44, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 12, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.21, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 64, 'correct_label_wrong_domain': 0, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 10:03:18,780][root][INFO] - Setting global seed to 206
[2025-02-21 10:03:18,785][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 10:03:18,785][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 10:03:18,786][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:03:18,787][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:03:18,789][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:03:18,790][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:03:18,938][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:03:19,179][root][INFO] - Full model selected, loading model
[2025-02-21 10:03:30,943][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 10:03:30,943][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 10:03:37,443][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:03:37,445][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:03:37,446][root][INFO] - Starting inference
[2025-02-21 10:03:37,569][root][INFO] - Processing question number 0
[2025-02-21 10:03:37,571][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:04:07,557][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:04:38,131][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:05:08,915][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:05:39,174][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:06:08,809][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:06:37,904][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:07:07,504][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:07:37,401][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:08:06,551][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:08:36,358][root][INFO] - Processing question number 10
[2025-02-21 10:08:36,360][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:09:05,357][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:09:34,919][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:10:04,599][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:10:33,827][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:11:04,105][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:11:34,019][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:12:03,835][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:12:33,505][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:13:03,739][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:13:34,023][root][INFO] - Processing question number 20
[2025-02-21 10:13:34,025][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:14:03,054][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:14:32,952][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:15:02,384][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:15:31,956][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:16:01,598][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:16:31,811][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:17:01,511][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:17:31,420][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:18:01,123][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:18:31,440][root][INFO] - Processing question number 30
[2025-02-21 10:18:31,443][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:19:01,234][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:19:30,836][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:20:00,402][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:20:30,700][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:21:00,389][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:21:30,201][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:21:59,905][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:22:30,303][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:23:00,219][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:23:30,161][root][INFO] - Processing question number 40
[2025-02-21 10:23:30,164][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:24:00,062][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:24:29,748][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:24:59,983][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:25:29,050][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:25:59,456][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:26:29,342][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:26:59,044][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:27:28,939][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:27:58,738][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:28:28,868][root][INFO] - Processing question number 50
[2025-02-21 10:28:28,871][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:28:59,270][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:29:28,619][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:29:59,015][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:30:29,030][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:30:58,432][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:31:28,058][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:31:58,573][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:32:28,864][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:32:59,162][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:33:29,418][root][INFO] - Processing question number 60
[2025-02-21 10:33:29,423][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:33:59,344][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:34:29,261][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:34:59,846][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:35:29,949][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:35:59,969][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:36:29,515][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:36:58,902][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:37:28,086][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:37:57,613][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:38:27,073][root][INFO] - Processing question number 70
[2025-02-21 10:38:27,077][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:38:57,112][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:39:27,027][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:39:57,150][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:40:27,740][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:40:57,194][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:41:27,266][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:41:58,321][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:42:28,410][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:42:57,498][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:43:27,000][root][INFO] - Processing question number 80
[2025-02-21 10:43:27,004][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:43:57,407][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:44:27,836][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:44:58,196][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:45:28,255][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:45:59,254][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:46:28,904][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:46:59,144][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:47:29,927][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:47:59,859][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:48:29,833][root][INFO] - Processing question number 90
[2025-02-21 10:48:29,839][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:48:59,808][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:49:30,124][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:50:00,220][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:50:30,105][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:51:00,622][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:51:31,024][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:52:01,206][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:52:30,935][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:53:00,208][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:53:30,658][root][INFO] - Inference complete
[2025-02-21 10:53:30,658][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,665][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,666][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Constitutional_law
[2025-02-21 10:53:30,667][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 10:53:30,667][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 10:53:30,668][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 10:53:30,669][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Constitutional_law
[2025-02-21 10:53:30,669][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Constitutional_law
[2025-02-21 10:53:30,669][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 10:53:30,670][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Criminal_law
[2025-02-21 10:53:30,670][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 10:53:30,671][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 10:53:30,671][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Criminal_law
[2025-02-21 10:53:30,671][root][WARNING] - No match found for 3. Chosen Option Label in question number 76 in domain Criminal_law
[2025-02-21 10:53:30,672][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 10:53:30,672][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Criminal_law
[2025-02-21 10:53:30,673][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 10:53:30,673][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 10:53:30,673][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 10:53:30,674][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 10:53:30,674][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 10:53:30,675][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 10:53:30,676][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 10:53:30,676][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Evidence
[2025-02-21 10:53:30,677][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 10:53:30,677][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Evidence
[2025-02-21 10:53:30,678][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Evidence
[2025-02-21 10:53:30,678][root][WARNING] - No match found for 3. Chosen Option Label in question number 98 in domain Evidence
[2025-02-21 10:53:30,678][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 10:53:30,679][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 10:53:30,679][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 10:53:30,680][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 10:53:30,681][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Civil_procedure
[2025-02-21 10:53:30,681][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 10:53:30,681][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 10:53:30,682][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 10:53:30,682][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 10:53:30,683][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 10:53:30,683][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 10:53:30,683][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 10:53:30,684][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Property
[2025-02-21 10:53:30,684][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 10:53:30,684][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Torts
[2025-02-21 10:53:30,685][root][WARNING] - No match found for 3. Chosen Option Label in question number 22 in domain Torts
[2025-02-21 10:53:30,685][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 10:53:30,685][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Torts
[2025-02-21 10:53:30,686][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 10:53:30,686][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 10:53:30,688][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,693][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,693][root][INFO] - Saved parsed outputs
[2025-02-21 10:53:30,693][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,694][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,694][root][INFO] - Saved parsing metadata
[2025-02-21 10:53:30,695][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,696][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:53:30,698][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:53:30,710][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 10:53:30,710][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.16, 'malformed_label': 46, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 59, 'correct_label_wrong_domain': 3, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 10:53:36,958][root][INFO] - Setting global seed to 206
[2025-02-21 10:53:36,963][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 10:53:36,963][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 10:53:36,965][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:53:36,966][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:53:36,968][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:53:36,968][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:53:37,151][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:53:37,513][root][INFO] - Full model selected, loading model
[2025-02-21 10:53:49,131][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 10:54:51,917][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 10:54:51,917][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 10:55:18,465][root][INFO] - Peft model loaded successfully
[2025-02-21 10:55:24,692][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:55:24,694][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:55:24,694][root][INFO] - Starting inference
[2025-02-21 10:55:24,835][root][INFO] - Processing question number 0
[2025-02-21 10:55:24,838][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:55:55,258][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:56:26,117][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:56:57,146][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:57:27,806][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:57:57,895][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:58:27,302][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:58:57,304][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:59:27,543][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:59:57,101][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:00:27,148][root][INFO] - Processing question number 10
[2025-02-21 11:00:27,150][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:00:56,375][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:01:26,203][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:01:56,178][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:02:25,661][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:02:56,076][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:03:26,109][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:03:56,093][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:04:25,907][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:04:56,280][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:05:26,738][root][INFO] - Processing question number 20
[2025-02-21 11:05:26,740][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:05:56,011][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:06:26,156][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:06:55,849][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:07:25,683][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:07:55,627][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:08:26,096][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:08:56,098][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:09:26,264][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:09:56,262][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:10:26,840][root][INFO] - Processing question number 30
[2025-02-21 11:10:26,843][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:10:56,901][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:11:26,764][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:11:56,592][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:12:27,140][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:12:57,115][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:13:27,193][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:13:57,208][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:14:27,857][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:14:58,045][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:15:28,220][root][INFO] - Processing question number 40
[2025-02-21 11:15:28,224][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:15:58,381][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:16:28,368][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:16:58,851][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:17:28,150][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:17:58,797][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:18:28,949][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:18:58,941][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:19:29,096][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:19:59,273][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:20:29,787][root][INFO] - Processing question number 50
[2025-02-21 11:20:29,791][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:21:00,452][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:21:30,054][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:22:00,709][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:22:30,985][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:23:00,642][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:23:30,574][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:24:01,411][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:24:31,957][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:25:02,499][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:25:32,876][root][INFO] - Processing question number 60
[2025-02-21 11:25:32,881][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:26:03,008][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:26:33,191][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:27:04,088][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:27:34,510][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:28:04,796][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:28:34,611][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:29:04,249][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:29:33,768][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:30:03,549][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:30:33,278][root][INFO] - Processing question number 70
[2025-02-21 11:30:33,283][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:31:03,564][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:31:33,753][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:32:04,182][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:32:35,101][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:33:04,832][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:33:35,227][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:34:06,637][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:34:37,060][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:35:06,398][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:35:36,168][root][INFO] - Processing question number 80
[2025-02-21 11:35:36,173][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:36:06,824][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:36:37,524][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:37:08,152][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:37:38,519][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:38:09,862][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:38:39,825][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:39:10,324][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:39:41,366][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:40:11,558][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:40:41,781][root][INFO] - Processing question number 90
[2025-02-21 11:40:41,787][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:41:12,009][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:41:42,586][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:42:12,985][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:42:43,124][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:43:13,960][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:43:44,679][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:44:15,077][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:44:45,030][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:45:14,557][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:45:45,251][root][INFO] - Inference complete
[2025-02-21 11:45:45,252][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,259][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,260][root][WARNING] - No match found for 3. Chosen Option Label in question number 1 in domain Constitutional_law
[2025-02-21 11:45:45,262][root][WARNING] - No match found for 3. Chosen Option Label in question number 70 in domain Constitutional_law
[2025-02-21 11:45:45,262][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Constitutional_law
[2025-02-21 11:45:45,264][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 11:45:45,264][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 11:45:45,265][root][WARNING] - No match found for 3. Chosen Option Label in question number 7 in domain Contracts
[2025-02-21 11:45:45,265][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 11:45:45,265][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 11:45:45,266][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 11:45:45,266][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Contracts
[2025-02-21 11:45:45,267][root][WARNING] - No match found for 3. Chosen Option Label in question number 65 in domain Contracts
[2025-02-21 11:45:45,267][root][WARNING] - No match found for 3. Chosen Option Label in question number 72 in domain Contracts
[2025-02-21 11:45:45,267][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 11:45:45,268][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Evidence
[2025-02-21 11:45:45,269][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 11:45:45,269][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Evidence
[2025-02-21 11:45:45,270][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Evidence
[2025-02-21 11:45:45,270][root][WARNING] - No match found for 3. Chosen Option Label in question number 19 in domain Civil_procedure
[2025-02-21 11:45:45,271][root][WARNING] - No match found for 3. Chosen Option Label in question number 26 in domain Civil_procedure
[2025-02-21 11:45:45,271][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 11:45:45,272][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 11:45:45,272][root][WARNING] - No match found for 3. Chosen Option Label in question number 75 in domain Civil_procedure
[2025-02-21 11:45:45,272][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Civil_procedure
[2025-02-21 11:45:45,273][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 11:45:45,273][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Property
[2025-02-21 11:45:45,273][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 11:45:45,273][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 11:45:45,274][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Property
[2025-02-21 11:45:45,274][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 11:45:45,275][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Property
[2025-02-21 11:45:45,275][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 11:45:45,276][root][WARNING] - No match found for 3. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 11:45:45,276][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 11:45:45,277][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 11:45:45,277][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Torts
[2025-02-21 11:45:45,277][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 11:45:45,278][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,284][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,284][root][INFO] - Saved parsed outputs
[2025-02-21 11:45:45,284][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,285][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,285][root][INFO] - Saved parsing metadata
[2025-02-21 11:45:45,286][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,288][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:45:45,289][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:45:45,302][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 11:45:45,302][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.21, 'malformed_label': 36, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 21, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.21, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 55, 'correct_label_wrong_domain': 6, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 11:45:51,571][root][INFO] - Setting global seed to 206
[2025-02-21 11:45:51,577][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 11:45:51,577][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 11:45:51,578][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:45:51,580][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:45:51,583][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:45:51,583][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:45:51,744][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:45:51,989][root][INFO] - Full model selected, loading model
[2025-02-21 11:46:03,889][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 11:46:03,890][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 11:46:10,369][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:46:10,371][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:46:10,371][root][INFO] - Starting inference
[2025-02-21 11:46:10,493][root][INFO] - Processing question number 0
[2025-02-21 11:46:10,495][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:46:40,717][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:47:11,435][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:47:42,351][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:48:12,752][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:48:42,534][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:49:11,789][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:49:41,539][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:50:11,586][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:50:40,880][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:51:10,826][root][INFO] - Processing question number 10
[2025-02-21 11:51:10,829][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:51:39,983][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:52:09,714][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:52:39,570][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:53:08,891][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:53:39,171][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:54:09,107][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:54:38,979][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:55:08,727][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:55:38,992][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:56:09,388][root][INFO] - Processing question number 20
[2025-02-21 11:56:09,390][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:56:38,594][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:57:08,658][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:57:38,266][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:58:08,019][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:58:37,825][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:59:08,188][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:59:38,047][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:00:08,123][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:00:37,992][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:01:08,485][root][INFO] - Processing question number 30
[2025-02-21 12:01:08,488][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:01:38,449][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:02:08,217][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:02:37,944][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:03:08,406][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:03:38,253][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:04:08,207][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:04:38,074][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:05:08,636][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:05:38,723][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:06:08,827][root][INFO] - Processing question number 40
[2025-02-21 12:06:08,830][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:06:38,902][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:07:08,760][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:07:39,148][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:08:08,381][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:08:38,951][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:09:08,998][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:09:38,856][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:10:08,922][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:10:38,885][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:11:09,173][root][INFO] - Processing question number 50
[2025-02-21 12:11:09,177][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:11:39,748][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:12:09,265][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:12:39,829][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:13:10,008][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:13:39,563][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:14:09,345][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:14:40,015][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:15:10,465][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:15:40,924][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:16:11,148][root][INFO] - Processing question number 60
[2025-02-21 12:16:11,152][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:16:41,158][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:17:11,300][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:17:42,150][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:18:12,539][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:18:42,849][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:19:12,558][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:19:42,095][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:20:11,437][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:20:41,127][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:21:10,739][root][INFO] - Processing question number 70
[2025-02-21 12:21:10,744][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:21:40,934][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:22:11,014][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:22:41,293][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:23:12,045][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:23:41,650][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:24:11,878][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:24:43,076][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:25:13,320][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:25:42,570][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:26:12,227][root][INFO] - Processing question number 80
[2025-02-21 12:26:12,233][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:26:42,785][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:27:13,369][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:27:43,892][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:28:14,103][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:28:45,246][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:29:15,042][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:29:45,446][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:30:16,390][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:30:46,476][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:31:16,578][root][INFO] - Processing question number 90
[2025-02-21 12:31:16,583][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:31:46,695][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:32:17,153][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:32:47,396][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:33:17,452][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:33:48,136][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:34:18,706][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:34:48,964][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:35:18,787][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:35:48,142][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:36:18,740][root][INFO] - Inference complete
[2025-02-21 12:36:18,740][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,748][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,749][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 12:36:18,750][root][WARNING] - No match found for 3. Chosen Option Label in question number 56 in domain Constitutional_law
[2025-02-21 12:36:18,751][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 12:36:18,752][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Criminal_law
[2025-02-21 12:36:18,752][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Criminal_law
[2025-02-21 12:36:18,753][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 12:36:18,755][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 12:36:18,755][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 12:36:18,755][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Contracts
[2025-02-21 12:36:18,756][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 12:36:18,756][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 12:36:18,757][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 12:36:18,757][root][WARNING] - No match found for 3. Chosen Option Label in question number 10 in domain Evidence
[2025-02-21 12:36:18,757][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Evidence
[2025-02-21 12:36:18,758][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 12:36:18,759][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Evidence
[2025-02-21 12:36:18,760][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 12:36:18,761][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 12:36:18,761][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 12:36:18,762][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 12:36:18,762][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 12:36:18,763][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 12:36:18,763][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Property
[2025-02-21 12:36:18,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 12:36:18,764][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 12:36:18,765][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 12:36:18,765][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Torts
[2025-02-21 12:36:18,766][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 12:36:18,767][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 12:36:18,767][root][WARNING] - No match found for 3. Chosen Option Label in question number 74 in domain Torts
[2025-02-21 12:36:18,768][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,773][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,773][root][INFO] - Saved parsed outputs
[2025-02-21 12:36:18,773][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,775][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,775][root][INFO] - Saved parsing metadata
[2025-02-21 12:36:18,776][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,777][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:36:18,778][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:36:18,791][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 12:36:18,791][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.16, 'malformed_label': 31, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.23, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.15, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 7, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 12:36:24,918][root][INFO] - Setting global seed to 206
[2025-02-21 12:36:24,923][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 12:36:24,923][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 12:36:24,924][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:36:24,926][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:36:24,927][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:36:24,928][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:36:25,110][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:36:25,365][root][INFO] - Full model selected, loading model
[2025-02-21 12:36:36,987][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 12:37:39,188][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 12:37:39,189][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 12:38:05,359][root][INFO] - Peft model loaded successfully
[2025-02-21 12:38:11,642][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:38:11,644][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:38:11,644][root][INFO] - Starting inference
[2025-02-21 12:38:11,780][root][INFO] - Processing question number 0
[2025-02-21 12:38:11,783][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:38:42,238][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:39:13,231][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:39:44,258][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:40:14,765][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:40:44,704][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:41:14,029][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:41:43,892][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:42:14,041][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:42:43,449][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:43:13,516][root][INFO] - Processing question number 10
[2025-02-21 12:43:13,518][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:43:42,764][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:44:12,610][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:44:42,605][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:45:12,108][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:45:42,543][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:46:12,599][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:46:42,600][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:47:12,440][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:47:42,837][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:48:13,334][root][INFO] - Processing question number 20
[2025-02-21 12:48:13,336][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:48:42,642][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:49:12,811][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:49:42,510][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:50:12,356][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:50:42,318][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:51:12,805][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:51:42,829][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:52:13,016][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:52:43,042][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:53:13,641][root][INFO] - Processing question number 30
[2025-02-21 12:53:13,645][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:53:43,713][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:54:13,599][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:54:43,459][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:55:14,035][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:55:44,047][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:56:14,120][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:56:44,141][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:57:14,807][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:57:44,994][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:58:15,187][root][INFO] - Processing question number 40
[2025-02-21 12:58:15,190][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:58:45,347][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:59:15,331][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:59:45,824][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:00:15,150][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:00:45,844][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:01:16,006][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:01:46,005][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:02:16,173][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:02:46,241][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:03:16,656][root][INFO] - Processing question number 50
[2025-02-21 13:03:16,660][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:03:47,309][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:04:16,912][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:04:47,572][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:05:17,854][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:05:47,516][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:06:17,451][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:06:48,281][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:07:18,824][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:07:49,370][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:08:19,734][root][INFO] - Processing question number 60
[2025-02-21 13:08:19,738][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:08:49,838][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:09:20,009][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:09:50,899][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:10:21,316][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:10:51,596][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:11:21,402][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:11:51,042][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:12:20,565][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:12:50,348][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:13:20,059][root][INFO] - Processing question number 70
[2025-02-21 13:13:20,064][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:13:50,335][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:14:20,515][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:14:50,934][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:15:21,937][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:15:51,653][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:16:22,045][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:16:53,515][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:17:23,933][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:17:53,287][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:18:23,063][root][INFO] - Processing question number 80
[2025-02-21 13:18:23,068][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:18:53,719][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:19:24,433][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:19:55,068][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:20:25,463][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:20:57,037][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:21:27,011][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:21:57,728][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:22:28,966][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:22:59,279][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:23:29,594][root][INFO] - Processing question number 90
[2025-02-21 13:23:29,599][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:23:59,950][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:24:30,536][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:25:00,937][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:25:31,086][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:26:01,975][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:26:32,782][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:27:03,326][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:27:33,437][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:28:03,118][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:28:33,965][root][INFO] - Inference complete
[2025-02-21 13:28:33,965][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,973][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,976][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 13:28:33,977][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Criminal_law
[2025-02-21 13:28:33,977][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 13:28:33,978][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Criminal_law
[2025-02-21 13:28:33,979][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Contracts
[2025-02-21 13:28:33,983][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 13:28:33,983][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 13:28:33,983][root][WARNING] - No match found for 2. Explanation in question number 75 in domain Civil_procedure
[2025-02-21 13:28:33,984][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 13:28:33,984][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 13:28:33,985][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 13:28:33,985][root][WARNING] - No match found for 3. Chosen Option Label in question number 59 in domain Property
[2025-02-21 13:28:33,985][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 13:28:33,987][root][WARNING] - No match found for 3. Chosen Option Label in question number 22 in domain Torts
[2025-02-21 13:28:33,988][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 13:28:33,989][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,994][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,995][root][INFO] - Saved parsed outputs
[2025-02-21 13:28:33,995][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,996][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,996][root][INFO] - Saved parsing metadata
[2025-02-21 13:28:33,997][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:33,999][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:28:34,000][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:28:34,028][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 13:28:34,028][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.2, 'malformed_label': 14, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.12, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 8, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 13:28:41,812][root][INFO] - Setting global seed to 206
[2025-02-21 13:28:41,819][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 13:28:41,820][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 13:28:41,821][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:28:41,822][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:28:41,825][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:28:41,825][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:28:41,972][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:28:42,375][root][INFO] - Full model selected, loading model
[2025-02-21 13:28:56,020][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 13:28:56,020][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 13:29:02,551][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:29:02,553][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:29:02,553][root][INFO] - Starting inference
[2025-02-21 13:29:02,686][root][INFO] - Processing question number 0
[2025-02-21 13:29:02,688][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:29:33,060][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:30:03,930][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:30:34,999][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:31:05,551][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:31:35,488][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:32:04,880][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:32:34,787][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:33:04,969][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:33:34,408][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:34:04,504][root][INFO] - Processing question number 10
[2025-02-21 13:34:04,507][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:34:33,811][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:35:03,703][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:35:33,704][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:36:03,174][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:36:33,601][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:37:03,671][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:37:33,649][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:38:03,513][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:38:33,895][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:39:04,412][root][INFO] - Processing question number 20
[2025-02-21 13:39:04,416][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:39:33,755][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:40:03,947][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:40:33,687][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:41:03,574][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:41:33,524][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:42:04,044][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:42:34,050][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:43:04,266][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:43:34,275][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:44:04,911][root][INFO] - Processing question number 30
[2025-02-21 13:44:04,914][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:44:35,013][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:45:04,990][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:45:34,900][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:46:05,524][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:46:35,527][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:47:05,635][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:47:35,738][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:48:06,486][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:48:36,753][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:49:07,041][root][INFO] - Processing question number 40
[2025-02-21 13:49:07,044][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:49:37,302][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:50:07,387][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:50:37,936][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:51:07,355][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:51:38,136][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:52:08,349][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:52:38,381][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:53:08,619][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:53:38,780][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:54:09,233][root][INFO] - Processing question number 50
[2025-02-21 13:54:09,237][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:54:39,962][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:55:09,642][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:55:40,243][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:56:10,534][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:56:40,114][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:57:09,915][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:57:40,601][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:58:11,056][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:58:41,528][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:59:11,758][root][INFO] - Processing question number 60
[2025-02-21 13:59:11,762][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:59:41,761][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:00:11,838][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:00:42,579][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:01:12,828][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:01:43,015][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:02:12,720][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:02:42,238][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:03:11,554][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:03:41,209][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:04:10,802][root][INFO] - Processing question number 70
[2025-02-21 14:04:10,807][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:04:40,969][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:05:11,124][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:05:41,605][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:06:12,334][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:06:41,945][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:07:12,167][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:07:43,364][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:08:13,596][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:08:42,836][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:09:12,492][root][INFO] - Processing question number 80
[2025-02-21 14:09:12,497][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:09:43,045][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:10:13,621][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:10:44,129][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:11:14,335][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:11:45,480][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:12:15,280][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:12:45,677][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:13:16,608][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:13:46,690][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:14:16,789][root][INFO] - Processing question number 90
[2025-02-21 14:14:16,794][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:14:46,900][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:15:17,356][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:15:47,599][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:16:17,624][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:16:48,288][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:17:18,840][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:17:49,085][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:18:18,906][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:18:48,263][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:19:18,832][root][INFO] - Inference complete
[2025-02-21 14:19:18,832][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,841][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,846][root][WARNING] - No match found for 3. Chosen Option Label in question number 7 in domain Contracts
[2025-02-21 14:19:18,847][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 14:19:18,848][root][WARNING] - No match found for 3. Chosen Option Label in question number 72 in domain Contracts
[2025-02-21 14:19:18,848][root][WARNING] - No match found for 3. Chosen Option Label in question number 97 in domain Contracts
[2025-02-21 14:19:18,849][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Evidence
[2025-02-21 14:19:18,852][root][WARNING] - No match found for 3. Chosen Option Label in question number 98 in domain Evidence
[2025-02-21 14:19:18,854][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 14:19:18,855][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 14:19:18,855][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Property
[2025-02-21 14:19:18,858][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 14:19:18,860][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,865][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,865][root][INFO] - Saved parsed outputs
[2025-02-21 14:19:18,865][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,867][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,867][root][INFO] - Saved parsing metadata
[2025-02-21 14:19:18,872][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,873][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:19:18,875][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:19:18,920][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 14:19:18,921][root][INFO] - Summary of metrics : {'label_accuracy': 0.23, 'misclassification_rate': 0.77, 'combined_accuracy': 0.16, 'malformed_label': 13, 'malformed_domain': 36, 'total_predictions': 100, 'correct_predictions': 23, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.15, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.08, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 7, 'both_wrong': 29}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 14:19:29,685][root][INFO] - Setting global seed to 989
[2025-02-21 14:19:29,693][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 14:19:29,694][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 14:19:29,695][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:19:29,697][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:19:29,702][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:19:29,703][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:19:29,842][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:19:30,087][root][INFO] - Full model selected, loading model
[2025-02-21 14:19:48,917][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 14:20:49,276][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 14:20:49,277][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 14:21:15,569][root][INFO] - Peft model loaded successfully
[2025-02-21 14:21:21,748][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:21:21,749][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:21:21,750][root][INFO] - Starting inference
[2025-02-21 14:21:21,932][root][INFO] - Processing question number 0
[2025-02-21 14:21:21,934][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:21:52,406][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:22:23,132][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:22:54,000][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:23:24,348][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:23:54,131][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:24:23,304][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:24:53,013][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:25:23,006][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:25:52,257][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:26:22,184][root][INFO] - Processing question number 10
[2025-02-21 14:26:22,186][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:26:51,504][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:27:21,326][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:27:51,316][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:28:20,783][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:28:51,066][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:29:20,956][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:29:50,783][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:30:20,470][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:30:50,711][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:31:21,034][root][INFO] - Processing question number 20
[2025-02-21 14:31:21,037][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:31:50,171][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:32:20,176][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:32:49,733][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:33:19,431][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:33:49,240][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:34:19,561][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:34:49,422][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:35:19,449][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:35:49,310][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:36:19,747][root][INFO] - Processing question number 30
[2025-02-21 14:36:19,752][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:36:49,658][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:37:19,382][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:37:49,063][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:38:19,474][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:38:49,311][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:39:19,223][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:39:49,086][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:40:19,577][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:40:49,615][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:41:19,668][root][INFO] - Processing question number 40
[2025-02-21 14:41:19,673][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:41:49,689][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:42:19,522][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:42:49,853][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:43:19,020][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:43:49,536][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:44:19,531][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:44:49,385][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:45:19,388][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:45:49,360][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:46:19,643][root][INFO] - Processing question number 50
[2025-02-21 14:46:19,648][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:46:50,177][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:47:19,648][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:47:50,258][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:48:20,437][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:48:49,946][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:49:19,737][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:49:50,421][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:50:20,822][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:50:51,235][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:51:21,456][root][INFO] - Processing question number 60
[2025-02-21 14:51:21,462][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:51:51,437][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:52:21,454][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:52:52,202][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:53:22,457][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:53:52,607][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:54:22,270][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:54:51,769][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:55:21,162][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:55:50,814][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:56:20,380][root][INFO] - Processing question number 70
[2025-02-21 14:56:20,385][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:56:50,539][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:57:20,580][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:57:50,874][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:58:21,639][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:58:51,203][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:59:21,437][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:59:52,678][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:00:22,915][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:00:52,095][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:01:21,873][root][INFO] - Processing question number 80
[2025-02-21 15:01:21,883][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:01:52,398][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:02:22,942][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:02:53,429][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:03:23,639][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:03:54,837][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:04:24,879][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:04:55,245][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:05:26,140][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:05:56,196][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:06:26,267][root][INFO] - Processing question number 90
[2025-02-21 15:06:26,272][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:06:56,352][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:07:26,771][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:07:57,028][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:08:27,012][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:08:57,705][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:09:28,224][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:09:58,485][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:10:28,323][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:10:57,740][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:11:28,302][root][INFO] - Inference complete
[2025-02-21 15:11:28,302][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,310][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,311][root][WARNING] - No match found for 3. Chosen Option Label in question number 1 in domain Constitutional_law
[2025-02-21 15:11:28,311][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Constitutional_law
[2025-02-21 15:11:28,311][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 15:11:28,312][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 15:11:28,313][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 15:11:28,313][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Criminal_law
[2025-02-21 15:11:28,314][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Criminal_law
[2025-02-21 15:11:28,314][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 15:11:28,314][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Criminal_law
[2025-02-21 15:11:28,315][root][WARNING] - No match found for 3. Chosen Option Label in question number 55 in domain Criminal_law
[2025-02-21 15:11:28,315][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 15:11:28,315][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Criminal_law
[2025-02-21 15:11:28,316][root][WARNING] - No match found for 3. Chosen Option Label in question number 76 in domain Criminal_law
[2025-02-21 15:11:28,316][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 15:11:28,317][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 15:11:28,317][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 15:11:28,318][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 15:11:28,318][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 15:11:28,319][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 15:11:28,319][root][WARNING] - No match found for 3. Chosen Option Label in question number 16 in domain Evidence
[2025-02-21 15:11:28,320][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 15:11:28,321][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Evidence
[2025-02-21 15:11:28,321][root][WARNING] - No match found for 3. Chosen Option Label in question number 85 in domain Evidence
[2025-02-21 15:11:28,321][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 15:11:28,322][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 15:11:28,322][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 15:11:28,323][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 15:11:28,323][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 15:11:28,323][root][WARNING] - No match found for 3. Chosen Option Label in question number 61 in domain Civil_procedure
[2025-02-21 15:11:28,323][root][WARNING] - No match found for 3. Chosen Option Label in question number 68 in domain Civil_procedure
[2025-02-21 15:11:28,324][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Civil_procedure
[2025-02-21 15:11:28,324][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 15:11:28,325][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 15:11:28,325][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 15:11:28,326][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 15:11:28,326][root][WARNING] - No match found for 3. Chosen Option Label in question number 81 in domain Property
[2025-02-21 15:11:28,326][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 15:11:28,326][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 15:11:28,327][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Property
[2025-02-21 15:11:28,327][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 15:11:28,328][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Torts
[2025-02-21 15:11:28,328][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Torts
[2025-02-21 15:11:28,329][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 15:11:28,329][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 15:11:28,330][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,336][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,336][root][INFO] - Saved parsed outputs
[2025-02-21 15:11:28,336][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,347][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,347][root][INFO] - Saved parsing metadata
[2025-02-21 15:11:28,348][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,350][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:28,369][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:11:28,382][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:11:28,383][root][INFO] - Summary of metrics : {'label_accuracy': 0.12, 'misclassification_rate': 0.88, 'combined_accuracy': 0.12, 'malformed_label': 44, 'malformed_domain': 24, 'total_predictions': 100, 'correct_predictions': 12, 'correct_label_and_domain': 12, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.21, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 64, 'correct_label_wrong_domain': 0, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 15:11:35,016][root][INFO] - Setting global seed to 989
[2025-02-21 15:11:35,022][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:11:35,022][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 15:11:35,023][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:11:35,025][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:11:35,027][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:11:35,027][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:11:35,197][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:11:35,439][root][INFO] - Full model selected, loading model
[2025-02-21 15:11:47,754][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:11:47,754][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:11:54,188][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:11:54,190][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:11:54,190][root][INFO] - Starting inference
[2025-02-21 15:11:54,324][root][INFO] - Processing question number 0
[2025-02-21 15:11:54,338][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:12:24,271][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:12:54,829][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:13:25,587][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:13:55,827][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:14:25,538][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:14:54,693][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:15:24,284][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:15:54,388][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:16:23,804][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:16:53,756][root][INFO] - Processing question number 10
[2025-02-21 15:16:53,759][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:17:22,905][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:17:52,663][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:18:22,351][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:18:51,505][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:19:21,627][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:19:51,423][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:20:21,113][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:20:50,685][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:21:20,772][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:21:50,998][root][INFO] - Processing question number 20
[2025-02-21 15:21:51,001][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:22:20,038][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:22:49,939][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:23:19,378][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:23:48,958][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:24:18,611][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:24:48,827][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:25:18,540][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:25:48,449][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:26:18,162][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:26:48,489][root][INFO] - Processing question number 30
[2025-02-21 15:26:48,493][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:27:18,293][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:27:47,901][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:28:17,479][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:28:47,786][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:29:17,476][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:29:47,271][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:30:16,986][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:30:47,385][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:31:17,304][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:31:47,241][root][INFO] - Processing question number 40
[2025-02-21 15:31:47,245][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:32:17,154][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:32:46,841][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:33:17,063][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:33:46,133][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:34:16,546][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:34:46,433][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:35:16,132][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:35:46,027][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:36:15,832][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:36:45,961][root][INFO] - Processing question number 50
[2025-02-21 15:36:45,967][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:37:16,371][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:37:45,738][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:38:16,347][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:38:46,383][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:39:15,852][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:39:45,508][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:40:16,071][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:40:46,373][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:41:16,678][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:41:46,743][root][INFO] - Processing question number 60
[2025-02-21 15:41:46,748][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:42:16,597][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:42:46,500][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:43:17,079][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:43:47,197][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:44:17,217][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:44:46,755][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:45:16,138][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:45:45,314][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:46:14,838][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:46:44,291][root][INFO] - Processing question number 70
[2025-02-21 15:46:44,297][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:47:14,322][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:47:44,234][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:48:14,357][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:48:44,944][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:49:14,385][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:49:44,446][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:50:15,494][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:50:45,575][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:51:14,656][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:51:44,153][root][INFO] - Processing question number 80
[2025-02-21 15:51:44,158][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:52:14,554][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:52:44,978][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:53:15,339][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:53:45,395][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:54:16,389][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:54:46,034][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:55:16,278][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:55:47,055][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:56:16,982][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:56:46,926][root][INFO] - Processing question number 90
[2025-02-21 15:56:46,932][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:57:16,883][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:57:47,185][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:58:17,273][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:58:47,142][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:59:17,658][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:59:48,054][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:00:18,145][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:00:47,813][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:01:17,013][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:01:47,434][root][INFO] - Inference complete
[2025-02-21 16:01:47,435][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,442][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,443][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Constitutional_law
[2025-02-21 16:01:47,444][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 16:01:47,444][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 16:01:47,444][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 16:01:47,445][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Constitutional_law
[2025-02-21 16:01:47,446][root][WARNING] - No match found for 3. Chosen Option Label in question number 99 in domain Constitutional_law
[2025-02-21 16:01:47,446][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 16:01:47,447][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Criminal_law
[2025-02-21 16:01:47,447][root][WARNING] - No match found for 3. Chosen Option Label in question number 37 in domain Criminal_law
[2025-02-21 16:01:47,448][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 16:01:47,448][root][WARNING] - No match found for 3. Chosen Option Label in question number 71 in domain Criminal_law
[2025-02-21 16:01:47,448][root][WARNING] - No match found for 3. Chosen Option Label in question number 76 in domain Criminal_law
[2025-02-21 16:01:47,448][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 16:01:47,449][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Criminal_law
[2025-02-21 16:01:47,449][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 16:01:47,450][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 16:01:47,450][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 16:01:47,450][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 16:01:47,451][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 16:01:47,451][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 16:01:47,452][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 16:01:47,453][root][WARNING] - No match found for 3. Chosen Option Label in question number 38 in domain Evidence
[2025-02-21 16:01:47,453][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 16:01:47,454][root][WARNING] - No match found for 3. Chosen Option Label in question number 60 in domain Evidence
[2025-02-21 16:01:47,454][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Evidence
[2025-02-21 16:01:47,455][root][WARNING] - No match found for 3. Chosen Option Label in question number 98 in domain Evidence
[2025-02-21 16:01:47,455][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 16:01:47,455][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 16:01:47,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 16:01:47,456][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 16:01:47,457][root][WARNING] - No match found for 3. Chosen Option Label in question number 82 in domain Civil_procedure
[2025-02-21 16:01:47,457][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 16:01:47,458][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 16:01:47,458][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 16:01:47,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 16:01:47,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 16:01:47,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 16:01:47,459][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 16:01:47,460][root][WARNING] - No match found for 3. Chosen Option Label in question number 94 in domain Property
[2025-02-21 16:01:47,460][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 16:01:47,460][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Torts
[2025-02-21 16:01:47,461][root][WARNING] - No match found for 3. Chosen Option Label in question number 22 in domain Torts
[2025-02-21 16:01:47,461][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 16:01:47,461][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Torts
[2025-02-21 16:01:47,462][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 16:01:47,462][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 16:01:47,463][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,471][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,471][root][INFO] - Saved parsed outputs
[2025-02-21 16:01:47,471][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,473][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,473][root][INFO] - Saved parsing metadata
[2025-02-21 16:01:47,474][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,476][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:01:47,477][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:01:47,506][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 16:01:47,507][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.16, 'malformed_label': 46, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 59, 'correct_label_wrong_domain': 3, 'both_wrong': 22}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 16:01:55,470][root][INFO] - Setting global seed to 989
[2025-02-21 16:01:55,476][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 16:01:55,477][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 16:01:55,478][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:01:55,479][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:01:55,482][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:01:55,482][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:01:55,646][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:01:55,890][root][INFO] - Full model selected, loading model
[2025-02-21 16:02:14,848][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 16:03:15,360][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 16:03:15,380][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 16:03:41,749][root][INFO] - Peft model loaded successfully
[2025-02-21 16:03:47,965][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:03:47,967][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:03:47,967][root][INFO] - Starting inference
[2025-02-21 16:03:48,157][root][INFO] - Processing question number 0
[2025-02-21 16:03:48,159][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:04:18,808][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:04:49,719][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:05:20,772][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:05:51,303][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:06:21,280][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:06:50,660][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:07:20,552][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:07:50,776][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:08:20,219][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:08:50,315][root][INFO] - Processing question number 10
[2025-02-21 16:08:50,317][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:09:19,593][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:09:49,468][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:10:19,502][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:10:49,040][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:11:19,520][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:11:49,604][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:12:19,638][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:12:49,514][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:13:19,942][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:13:50,455][root][INFO] - Processing question number 20
[2025-02-21 16:13:50,458][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:14:19,785][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:14:49,981][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:15:19,756][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:15:49,635][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:16:19,650][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:16:50,164][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:17:20,222][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:17:50,450][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:18:20,501][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:18:51,136][root][INFO] - Processing question number 30
[2025-02-21 16:18:51,142][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:19:21,253][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:19:51,156][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:20:21,042][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:20:51,745][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:21:22,046][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:21:52,425][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:22:22,637][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:22:53,393][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:23:23,608][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:23:53,835][root][INFO] - Processing question number 40
[2025-02-21 16:23:53,839][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:24:24,043][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:24:54,063][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:25:24,570][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:25:53,917][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:26:24,624][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:26:54,794][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:27:24,822][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:27:55,016][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:28:25,115][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:28:55,556][root][INFO] - Processing question number 50
[2025-02-21 16:28:55,560][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:29:26,250][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:29:55,882][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:30:26,574][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:30:56,880][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:31:26,627][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:31:56,680][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:32:27,557][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:32:58,138][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:33:28,724][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:33:59,115][root][INFO] - Processing question number 60
[2025-02-21 16:33:59,119][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:34:29,261][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:34:59,458][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:35:30,370][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:36:00,808][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:36:31,107][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:37:00,941][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:37:30,615][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:38:00,155][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:38:29,974][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:38:59,714][root][INFO] - Processing question number 70
[2025-02-21 16:38:59,718][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:39:30,029][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:40:00,236][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:40:30,700][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:41:01,635][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:41:31,369][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:42:01,769][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:42:33,187][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:43:03,739][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:43:33,305][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:44:03,111][root][INFO] - Processing question number 80
[2025-02-21 16:44:03,116][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:44:33,799][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:45:04,562][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:45:35,213][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:46:05,607][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:46:36,983][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:47:06,964][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:47:37,497][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:48:08,564][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:48:38,803][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:49:09,045][root][INFO] - Processing question number 90
[2025-02-21 16:49:09,051][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:49:39,301][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:50:09,901][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:50:40,332][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:51:10,498][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:51:41,361][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:52:12,055][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:52:42,486][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:53:12,488][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:53:42,061][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:54:12,802][root][INFO] - Inference complete
[2025-02-21 16:54:12,802][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,809][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,810][root][WARNING] - No match found for 3. Chosen Option Label in question number 1 in domain Constitutional_law
[2025-02-21 16:54:12,811][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 16:54:12,811][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 16:54:12,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 56 in domain Constitutional_law
[2025-02-21 16:54:12,812][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 16:54:12,813][root][WARNING] - No match found for 3. Chosen Option Label in question number 8 in domain Criminal_law
[2025-02-21 16:54:12,813][root][WARNING] - No match found for 3. Chosen Option Label in question number 21 in domain Criminal_law
[2025-02-21 16:54:12,814][root][WARNING] - No match found for 3. Chosen Option Label in question number 64 in domain Criminal_law
[2025-02-21 16:54:12,814][root][WARNING] - No match found for 3. Chosen Option Label in question number 83 in domain Criminal_law
[2025-02-21 16:54:12,815][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 16:54:12,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 16:54:12,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 42 in domain Contracts
[2025-02-21 16:54:12,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 48 in domain Contracts
[2025-02-21 16:54:12,816][root][WARNING] - No match found for 3. Chosen Option Label in question number 58 in domain Contracts
[2025-02-21 16:54:12,817][root][WARNING] - No match found for 3. Chosen Option Label in question number 65 in domain Contracts
[2025-02-21 16:54:12,817][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 16:54:12,818][root][WARNING] - No match found for 3. Chosen Option Label in question number 31 in domain Evidence
[2025-02-21 16:54:12,819][root][WARNING] - No match found for 3. Chosen Option Label in question number 80 in domain Evidence
[2025-02-21 16:54:12,820][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 16:54:12,820][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 16:54:12,820][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 16:54:12,821][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 16:54:12,822][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Property
[2025-02-21 16:54:12,822][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 16:54:12,822][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 16:54:12,823][root][WARNING] - No match found for 3. Chosen Option Label in question number 46 in domain Property
[2025-02-21 16:54:12,823][root][WARNING] - No match found for 3. Chosen Option Label in question number 53 in domain Property
[2025-02-21 16:54:12,823][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 16:54:12,824][root][WARNING] - No match found for 3. Chosen Option Label in question number 69 in domain Property
[2025-02-21 16:54:12,824][root][WARNING] - No match found for 3. Chosen Option Label in question number 88 in domain Property
[2025-02-21 16:54:12,824][root][WARNING] - No match found for 3. Chosen Option Label in question number 91 in domain Property
[2025-02-21 16:54:12,825][root][WARNING] - No match found for 3. Chosen Option Label in question number 11 in domain Torts
[2025-02-21 16:54:12,825][root][WARNING] - No match found for 3. Chosen Option Label in question number 39 in domain Torts
[2025-02-21 16:54:12,826][root][WARNING] - No match found for 3. Chosen Option Label in question number 57 in domain Torts
[2025-02-21 16:54:12,826][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 16:54:12,827][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,833][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,833][root][INFO] - Saved parsed outputs
[2025-02-21 16:54:12,833][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,834][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,835][root][INFO] - Saved parsing metadata
[2025-02-21 16:54:12,835][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,837][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:12,838][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:54:12,866][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 16:54:12,866][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.14, 'malformed_label': 35, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 61, 'correct_label_wrong_domain': 5, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 16:54:20,796][root][INFO] - Setting global seed to 989
[2025-02-21 16:54:20,803][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 16:54:20,803][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 16:54:20,804][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:54:20,806][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:54:20,808][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:54:20,809][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:54:20,974][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:54:21,248][root][INFO] - Full model selected, loading model
[2025-02-21 16:54:39,138][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 16:54:39,139][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 16:54:45,598][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:54:45,600][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:54:45,600][root][INFO] - Starting inference
[2025-02-21 16:54:45,753][root][INFO] - Processing question number 0
[2025-02-21 16:54:45,755][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:55:16,118][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:55:46,903][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:56:17,849][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:56:48,262][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:57:18,063][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:57:47,310][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:58:17,079][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:58:47,134][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:59:16,450][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:59:46,416][root][INFO] - Processing question number 10
[2025-02-21 16:59:46,418][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:00:15,584][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:00:45,336][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:01:15,203][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:01:44,533][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:02:14,829][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:02:44,782][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:03:14,643][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:03:44,384][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:04:14,645][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:04:45,040][root][INFO] - Processing question number 20
[2025-02-21 17:04:45,043][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:05:14,256][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:05:44,323][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:06:13,935][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:06:43,690][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:07:13,515][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:07:43,905][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:08:13,785][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:08:43,873][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:09:13,751][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:09:44,254][root][INFO] - Processing question number 30
[2025-02-21 17:09:44,257][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:10:14,226][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:10:44,011][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:11:13,754][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:11:44,230][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:12:14,095][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:12:44,058][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:13:13,936][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:13:44,504][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:14:14,599][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:14:44,713][root][INFO] - Processing question number 40
[2025-02-21 17:14:44,716][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:15:14,796][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:15:44,647][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:16:15,038][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:16:44,278][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:17:14,866][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:17:44,928][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:18:14,800][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:18:44,864][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:19:14,845][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:19:45,144][root][INFO] - Processing question number 50
[2025-02-21 17:19:45,148][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:20:15,720][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:20:45,247][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:21:15,824][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:21:46,018][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:22:15,602][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:22:45,408][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:23:16,104][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:23:46,575][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:24:17,049][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:24:47,294][root][INFO] - Processing question number 60
[2025-02-21 17:24:47,298][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:25:17,537][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:25:47,873][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:26:18,869][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:26:49,300][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:27:19,695][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:27:49,419][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:28:18,982][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:28:48,343][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:29:18,045][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:29:47,678][root][INFO] - Processing question number 70
[2025-02-21 17:29:47,683][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:30:17,889][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:30:47,980][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:31:18,278][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:31:49,040][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:32:18,660][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:32:48,901][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:33:20,118][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:33:50,374][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:34:19,634][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:34:49,309][root][INFO] - Processing question number 80
[2025-02-21 17:34:49,313][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:35:19,882][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:35:50,493][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:36:21,027][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:36:51,251][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:37:22,419][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:37:52,240][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:38:22,652][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:38:53,602][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:39:23,701][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:39:53,819][root][INFO] - Processing question number 90
[2025-02-21 17:39:53,824][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:40:23,949][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:40:54,425][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:41:24,687][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:41:54,732][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:42:25,419][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:42:55,991][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:43:26,261][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:43:56,102][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:44:25,473][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:44:56,064][root][INFO] - Inference complete
[2025-02-21 17:44:56,064][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,071][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,072][root][WARNING] - No match found for 3. Chosen Option Label in question number 6 in domain Constitutional_law
[2025-02-21 17:44:56,073][root][WARNING] - No match found for 3. Chosen Option Label in question number 13 in domain Constitutional_law
[2025-02-21 17:44:56,075][root][WARNING] - No match found for 3. Chosen Option Label in question number 2 in domain Criminal_law
[2025-02-21 17:44:56,075][root][WARNING] - No match found for 3. Chosen Option Label in question number 29 in domain Criminal_law
[2025-02-21 17:44:56,076][root][WARNING] - No match found for 3. Chosen Option Label in question number 44 in domain Criminal_law
[2025-02-21 17:44:56,077][root][WARNING] - No match found for 3. Chosen Option Label in question number 96 in domain Criminal_law
[2025-02-21 17:44:56,077][root][WARNING] - No match found for 3. Chosen Option Label in question number 7 in domain Contracts
[2025-02-21 17:44:56,078][root][WARNING] - No match found for 3. Chosen Option Label in question number 24 in domain Contracts
[2025-02-21 17:44:56,078][root][WARNING] - No match found for 3. Chosen Option Label in question number 28 in domain Contracts
[2025-02-21 17:44:56,078][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 17:44:56,079][root][WARNING] - No match found for 3. Chosen Option Label in question number 65 in domain Contracts
[2025-02-21 17:44:56,080][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 17:44:56,080][root][WARNING] - No match found for 3. Chosen Option Label in question number 10 in domain Evidence
[2025-02-21 17:44:56,081][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 17:44:56,082][root][WARNING] - No match found for 3. Chosen Option Label in question number 73 in domain Evidence
[2025-02-21 17:44:56,082][root][WARNING] - No match found for 3. Chosen Option Label in question number 90 in domain Evidence
[2025-02-21 17:44:56,083][root][WARNING] - No match found for 3. Chosen Option Label in question number 12 in domain Civil_procedure
[2025-02-21 17:44:56,083][root][WARNING] - No match found for 3. Chosen Option Label in question number 33 in domain Civil_procedure
[2025-02-21 17:44:56,084][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 17:44:56,084][root][WARNING] - No match found for 3. Chosen Option Label in question number 54 in domain Civil_procedure
[2025-02-21 17:44:56,085][root][WARNING] - No match found for 3. Chosen Option Label in question number 93 in domain Civil_procedure
[2025-02-21 17:44:56,085][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Property
[2025-02-21 17:44:56,085][root][WARNING] - No match found for 3. Chosen Option Label in question number 17 in domain Property
[2025-02-21 17:44:56,086][root][WARNING] - No match found for 3. Chosen Option Label in question number 25 in domain Property
[2025-02-21 17:44:56,086][root][WARNING] - No match found for 3. Chosen Option Label in question number 36 in domain Property
[2025-02-21 17:44:56,087][root][WARNING] - No match found for 3. Chosen Option Label in question number 66 in domain Property
[2025-02-21 17:44:56,088][root][WARNING] - No match found for 3. Chosen Option Label in question number 100 in domain Property
[2025-02-21 17:44:56,088][root][WARNING] - No match found for 3. Chosen Option Label in question number 18 in domain Torts
[2025-02-21 17:44:56,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 17:44:56,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 52 in domain Torts
[2025-02-21 17:44:56,089][root][WARNING] - No match found for 3. Chosen Option Label in question number 63 in domain Torts
[2025-02-21 17:44:56,090][root][WARNING] - No match found for 3. Chosen Option Label in question number 79 in domain Torts
[2025-02-21 17:44:56,091][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,096][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,096][root][INFO] - Saved parsed outputs
[2025-02-21 17:44:56,096][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,097][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,097][root][INFO] - Saved parsing metadata
[2025-02-21 17:44:56,098][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:44:56,101][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:44:56,129][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 17:44:56,129][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.13, 'malformed_label': 32, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 13, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 62, 'correct_label_wrong_domain': 6, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 17:45:04,780][root][INFO] - Setting global seed to 989
[2025-02-21 17:45:04,788][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 17:45:04,788][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 17:45:04,789][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:45:04,791][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:45:04,794][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:45:04,794][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:45:04,978][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:45:05,218][root][INFO] - Full model selected, loading model
[2025-02-21 17:45:24,228][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 17:46:24,181][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 17:46:24,181][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 17:46:50,280][root][INFO] - Peft model loaded successfully
[2025-02-21 17:46:56,469][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:46:56,471][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:46:56,471][root][INFO] - Starting inference
[2025-02-21 17:46:56,635][root][INFO] - Processing question number 0
[2025-02-21 17:46:56,637][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:47:27,165][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:47:58,066][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:48:29,144][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:48:59,897][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:49:29,894][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:49:59,244][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:50:29,138][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:50:59,317][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:51:28,754][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:51:58,843][root][INFO] - Processing question number 10
[2025-02-21 17:51:58,845][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:52:28,118][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:52:57,991][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:53:28,012][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:53:57,540][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:54:28,004][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:54:58,082][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:55:28,107][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:55:57,971][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:56:28,392][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:56:58,900][root][INFO] - Processing question number 20
[2025-02-21 17:56:58,903][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:57:28,215][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:57:58,401][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:58:28,119][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:58:57,992][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:59:27,968][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:59:58,465][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:00:28,501][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:00:58,700][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:01:28,733][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:01:59,347][root][INFO] - Processing question number 30
[2025-02-21 18:01:59,350][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:02:29,433][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:02:59,333][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:03:29,191][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:03:59,769][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:04:29,779][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:04:59,854][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:05:29,892][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:06:00,565][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:06:30,772][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:07:00,987][root][INFO] - Processing question number 40
[2025-02-21 18:07:00,990][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:07:31,182][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:08:01,189][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:08:31,679][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:09:01,009][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:09:31,703][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:10:01,876][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:10:31,891][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:11:02,072][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:11:32,160][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:12:02,608][root][INFO] - Processing question number 50
[2025-02-21 18:12:02,611][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:12:33,288][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:13:02,922][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:13:33,612][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:14:03,909][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:14:33,596][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:15:03,547][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:15:34,437][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:16:05,284][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:16:36,024][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:17:06,547][root][INFO] - Processing question number 60
[2025-02-21 18:17:06,551][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:17:36,849][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:18:07,061][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:18:37,982][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:19:08,491][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:19:38,802][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:20:08,649][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:20:38,312][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:21:07,860][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:21:37,668][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:22:07,410][root][INFO] - Processing question number 70
[2025-02-21 18:22:07,414][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:22:37,720][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:23:07,926][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:23:38,376][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:24:09,308][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:24:39,035][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:25:09,436][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:25:40,848][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:26:11,255][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:26:40,608][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:27:10,399][root][INFO] - Processing question number 80
[2025-02-21 18:27:10,403][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:27:41,089][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:28:11,806][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:28:42,452][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:29:12,836][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:29:44,203][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:30:14,180][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:30:44,713][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:31:15,778][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:31:46,008][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:32:16,244][root][INFO] - Processing question number 90
[2025-02-21 18:32:16,250][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:32:46,492][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:33:17,079][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:33:47,494][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:34:17,646][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:34:48,500][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:35:19,183][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:35:49,604][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:36:19,591][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:36:49,161][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:37:19,895][root][INFO] - Inference complete
[2025-02-21 18:37:19,895][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,902][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,903][root][WARNING] - No match found for 3. Chosen Option Label in question number 20 in domain Constitutional_law
[2025-02-21 18:37:19,903][root][WARNING] - No match found for 3. Chosen Option Label in question number 27 in domain Constitutional_law
[2025-02-21 18:37:19,904][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 18:37:19,905][root][WARNING] - No match found for 3. Chosen Option Label in question number 78 in domain Constitutional_law
[2025-02-21 18:37:19,907][root][WARNING] - No match found for 3. Chosen Option Label in question number 34 in domain Contracts
[2025-02-21 18:37:19,908][root][WARNING] - No match found for 3. Chosen Option Label in question number 77 in domain Contracts
[2025-02-21 18:37:19,909][root][WARNING] - No match found for 3. Chosen Option Label in question number 87 in domain Contracts
[2025-02-21 18:37:19,910][root][WARNING] - No match found for 3. Chosen Option Label in question number 50 in domain Evidence
[2025-02-21 18:37:19,911][root][WARNING] - No match found for 3. Chosen Option Label in question number 5 in domain Civil_procedure
[2025-02-21 18:37:19,912][root][WARNING] - No match found for 3. Chosen Option Label in question number 47 in domain Civil_procedure
[2025-02-21 18:37:19,915][root][WARNING] - No match found for 3. Chosen Option Label in question number 32 in domain Torts
[2025-02-21 18:37:19,916][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 18:37:19,916][root][WARNING] - No match found for 3. Chosen Option Label in question number 92 in domain Torts
[2025-02-21 18:37:19,917][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,922][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,923][root][INFO] - Saved parsed outputs
[2025-02-21 18:37:19,923][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,924][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,924][root][INFO] - Saved parsing metadata
[2025-02-21 18:37:19,925][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,926][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:19,928][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:37:19,957][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 18:37:19,957][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.18, 'malformed_label': 13, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 51, 'correct_label_wrong_domain': 6, 'both_wrong': 25}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 11 to status running with exit code None
Eval status update completed for job 11
[2025-02-21 18:37:28,226][root][INFO] - Setting global seed to 989
[2025-02-21 18:37:28,233][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 18:37:28,234][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 18:37:28,235][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:37:28,236][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:37:28,239][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:37:28,239][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:37:28,391][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:37:28,707][root][INFO] - Full model selected, loading model
[2025-02-21 18:37:47,565][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 18:37:47,565][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 18:37:54,046][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:37:54,048][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:37:54,048][root][INFO] - Starting inference
[2025-02-21 18:37:54,215][root][INFO] - Processing question number 0
[2025-02-21 18:37:54,217][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:38:24,562][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:38:55,482][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:39:26,420][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:39:56,802][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:40:26,578][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:40:55,806][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:41:25,551][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:41:55,595][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:42:24,885][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:42:54,822][root][INFO] - Processing question number 10
[2025-02-21 18:42:54,824][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:43:23,964][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:43:53,690][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:44:23,530][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:44:52,840][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:45:23,108][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:45:53,033][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:46:22,868][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:46:52,582][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:47:22,817][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:47:53,188][root][INFO] - Processing question number 20
[2025-02-21 18:47:53,190][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:48:22,377][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:48:52,413][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:49:22,000][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:49:51,728][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:50:21,528][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:50:51,892][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:51:21,745][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:51:51,810][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:52:21,670][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:52:52,159][root][INFO] - Processing question number 30
[2025-02-21 18:52:52,162][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:53:22,121][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:53:51,880][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:54:21,608][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:54:52,071][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:55:21,907][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:55:51,851][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:56:21,709][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:56:52,247][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:57:22,313][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:57:52,401][root][INFO] - Processing question number 40
[2025-02-21 18:57:52,404][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:58:22,464][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:58:52,295][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:59:22,664][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:59:51,880][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 19:00:22,444][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 19:00:52,483][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 19:01:22,328][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 19:01:52,378][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 19:02:22,333][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 19:02:52,604][root][INFO] - Processing question number 50
[2025-02-21 19:02:52,608][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 19:03:23,156][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 19:03:52,662][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 19:04:23,214][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 19:04:53,385][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 19:05:22,942][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 19:05:52,723][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 19:06:23,402][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 19:06:53,848][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 19:07:24,300][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:07:54,515][root][INFO] - Processing question number 60
[2025-02-21 19:07:54,520][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:08:24,522][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:08:54,586][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:09:25,317][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:09:55,583][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:10:25,762][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:10:55,461][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:11:25,066][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:11:54,461][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:12:24,143][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:12:53,750][root][INFO] - Processing question number 70
[2025-02-21 19:12:53,754][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:13:23,932][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:13:54,002][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:14:24,272][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:14:55,008][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:15:24,599][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:15:54,815][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:16:26,002][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:16:56,230][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:17:25,457][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:17:55,104][root][INFO] - Processing question number 80
[2025-02-21 19:17:55,109][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:18:25,650][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:18:56,225][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:19:26,731][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:19:56,934][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:20:28,072][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:20:57,864][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:21:28,271][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:21:59,417][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:22:29,724][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:22:59,953][root][INFO] - Processing question number 90
[2025-02-21 19:22:59,959][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:23:30,234][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:24:00,778][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:24:31,011][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:25:01,027][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:25:31,744][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:26:02,290][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:26:32,532][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:27:02,349][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:27:31,697][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:28:02,267][root][INFO] - Inference complete
[2025-02-21 19:28:02,267][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,274][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,275][root][WARNING] - No match found for 3. Chosen Option Label in question number 1 in domain Constitutional_law
[2025-02-21 19:28:02,275][root][WARNING] - No match found for 3. Chosen Option Label in question number 35 in domain Constitutional_law
[2025-02-21 19:28:02,277][root][WARNING] - No match found for 3. Chosen Option Label in question number 86 in domain Constitutional_law
[2025-02-21 19:28:02,284][root][WARNING] - No match found for 3. Chosen Option Label in question number 19 in domain Civil_procedure
[2025-02-21 19:28:02,286][root][WARNING] - No match found for 3. Chosen Option Label in question number 9 in domain Property
[2025-02-21 19:28:02,287][root][WARNING] - No match found for 3. Chosen Option Label in question number 59 in domain Property
[2025-02-21 19:28:02,290][root][WARNING] - No match found for 3. Chosen Option Label in question number 45 in domain Torts
[2025-02-21 19:28:02,290][root][WARNING] - No match found for 3. Chosen Option Label in question number 67 in domain Torts
[2025-02-21 19:28:02,292][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,296][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,297][root][INFO] - Saved parsed outputs
[2025-02-21 19:28:02,297][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,298][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,298][root][INFO] - Saved parsing metadata
[2025-02-21 19:28:02,298][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,300][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:28:02,301][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_fact_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:28:02,329][root][INFO] - Evaluation completed for number_list_fact_first_few_shot_unstructured, on test_set_2
[2025-02-21 19:28:02,329][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.19, 'malformed_label': 9, 'malformed_domain': 38, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 10, 'both_wrong': 28}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '11', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_fact_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 11 to status completed with exit code 0
Eval status update completed for job 11
Job 11 completed at Fri Feb 21 19:28:03 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n515
Job ID: 25309346
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 20:28:28
CPU Efficiency: 9.94% of 8-13:56:50 core-walltime
Job Wall-clock time: 20:35:41
Memory Utilized: 28.32 GB
Memory Efficiency: 78.66% of 36.00 GB
