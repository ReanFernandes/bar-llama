Starting job 15 at Thu Mar  6 10:11:18 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=json_fact_first_zero_shot_unstructured train=json_fact_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '15', 'training']
Updating job 15 to status training with exit code None
Status update completed for job 15
[2025-03-06 10:11:34,018][root][INFO] - Global seed set to 314
[2025-03-06 10:11:34,020][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 10:11:34,020][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 10:11:34,020][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 10:11:34,020][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:11:34,021][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-03-06 10:11:34,039][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:11:34,117][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 10:11:34,119][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 10:11:34,131][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 10:11:34,602][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:11:47,683][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:12:21,683][root][INFO] - Model prepared for kbit training
[2025-03-06 10:12:21,684][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'up_proj', 'gate_proj', 'v_proj', 'down_proj', 'q_proj', 'k_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 10:12:23,462][root][INFO] - Lora adapter added to model
[2025-03-06 10:12:23,465][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_zero_shot_unstructured
[2025-03-06 10:12:23,697][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.686, 'grad_norm': 0.14313699305057526, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.5443, 'grad_norm': 0.179293692111969, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.4348, 'grad_norm': 0.19990944862365723, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.3439, 'grad_norm': 0.2568739354610443, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.1738, 'grad_norm': 0.2506766617298126, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 332.3832, 'train_samples_per_second': 0.316, 'train_steps_per_second': 0.045, 'train_loss': 1.436575746536255, 'epoch': 15.0}
[2025-03-06 10:17:59,862][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '15', 'trained', '0']
Updating job 15 to status trained with exit code 0
Status update completed for job 15
Starting evaluations for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 10:18:11,085][root][INFO] - Setting global seed to 206
[2025-03-06 10:18:11,090][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:18:11,090][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:18:11,092][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:18:11,093][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:18:11,096][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:18:11,096][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:18:11,252][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:18:11,528][root][INFO] - Full model selected, loading model
[2025-03-06 10:18:30,447][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:19:40,545][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:19:40,564][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:20:07,978][root][INFO] - Peft model loaded successfully
[2025-03-06 10:20:14,512][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:20:14,514][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:20:14,515][root][INFO] - Starting inference
[2025-03-06 10:20:14,750][root][INFO] - Processing question number 0
[2025-03-06 10:20:14,752][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:20:40,923][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:21:07,842][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:21:34,275][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:22:01,055][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:22:27,255][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:22:38,482][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:22:45,885][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:23:12,364][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:23:23,439][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:23:30,975][root][INFO] - Processing question number 10
[2025-03-06 10:23:30,977][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:23:59,063][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:24:24,973][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:24:37,542][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:24:44,186][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:24:56,293][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:25:22,264][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:25:48,164][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:25:53,972][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:26:20,367][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:26:46,437][root][INFO] - Processing question number 20
[2025-03-06 10:26:46,439][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:27:12,808][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:27:39,321][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:27:48,114][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:28:14,031][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:28:40,643][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:28:47,372][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:28:55,763][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:29:02,981][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:29:29,477][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:29:55,259][root][INFO] - Processing question number 30
[2025-03-06 10:29:55,261][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:30:21,932][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:30:33,204][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:30:41,937][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:30:48,900][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:30:58,301][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:31:25,200][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:31:51,517][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:32:18,175][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:32:26,227][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:32:53,431][root][INFO] - Processing question number 40
[2025-03-06 10:32:53,434][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:33:19,951][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:33:46,466][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:34:13,438][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:34:40,365][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:35:06,570][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:35:33,056][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:36:00,823][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:36:26,389][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:36:34,117][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:37:01,126][root][INFO] - Processing question number 50
[2025-03-06 10:37:01,129][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:37:28,379][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:37:38,468][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:38:04,242][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:38:31,755][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:38:58,312][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:39:23,885][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:39:51,100][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:39:55,879][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:40:03,177][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:40:30,987][root][INFO] - Processing question number 60
[2025-03-06 10:40:30,990][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:40:37,283][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:41:03,649][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:41:30,537][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:41:37,945][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:42:04,393][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:42:30,922][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:42:38,599][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:42:43,969][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:43:10,700][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:43:37,773][root][INFO] - Processing question number 70
[2025-03-06 10:43:37,777][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:43:42,740][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:43:49,287][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:43:56,412][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:44:13,848][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:44:40,597][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:45:06,629][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:45:33,482][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:46:00,125][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:46:26,959][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:46:53,277][root][INFO] - Processing question number 80
[2025-03-06 10:46:53,281][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:47:19,997][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:47:46,660][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:48:12,830][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:48:39,052][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:49:06,019][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:49:32,809][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:49:59,665][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:50:08,378][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:50:15,068][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:50:40,994][root][INFO] - Processing question number 90
[2025-03-06 10:50:40,999][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:50:50,224][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:51:15,683][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:51:42,051][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:52:07,670][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:52:34,537][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:53:00,489][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:53:13,119][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:53:39,694][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:54:06,694][root][INFO] - Inference complete
[2025-03-06 10:54:06,694][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,700][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,701][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,702][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,703][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,703][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,703][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,703][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,703][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,703][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,704][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,704][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,704][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,704][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,704][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,705][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,705][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,705][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,705][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,705][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,705][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,706][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,706][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,706][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,706][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,707][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,707][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,707][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,707][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,707][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,708][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,708][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,708][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,708][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,709][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,709][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,709][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,709][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,709][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,710][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,710][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,710][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,710][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,710][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,710][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,711][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,711][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,711][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,711][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,711][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,712][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,712][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,712][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,712][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,712][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,713][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,713][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,713][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,713][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,714][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,714][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,714][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,714][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,714][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,714][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,714][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,715][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,715][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,715][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,715][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,716][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,716][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,716][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,716][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,716][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,717][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,717][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,717][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,718][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,718][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,718][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,718][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,718][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,719][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,719][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,719][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,719][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,719][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,719][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,719][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,720][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,720][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,720][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,720][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,721][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,721][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,721][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,721][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,721][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,722][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,722][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,722][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,722][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,722][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,722][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,722][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,723][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,723][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,723][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,723][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,723][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,724][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,724][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,724][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,724][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,725][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,725][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,725][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,725][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,725][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,726][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,726][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,726][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,726][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,726][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,726][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,727][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,727][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,727][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,727][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,727][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,728][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,728][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,728][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,728][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,728][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,728][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,729][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,729][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,729][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,729][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,729][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,729][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,730][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,730][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,730][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,730][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,730][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,730][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,730][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,731][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,731][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,731][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,731][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,732][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,732][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,732][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,732][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,732][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,733][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,733][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,733][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,733][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,733][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,734][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,734][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,734][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,734][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,735][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,735][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,735][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,735][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,735][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,735][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,736][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,736][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,736][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,736][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,737][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,737][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,737][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,737][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,738][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,738][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,738][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,738][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,738][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,739][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,739][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,739][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,739][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,739][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,739][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,740][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,740][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,740][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,740][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,740][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,741][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,741][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,741][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,741][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,741][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,742][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,742][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,742][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,742][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,742][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,742][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,742][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,743][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,743][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,743][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,743][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,743][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,743][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,744][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,744][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,744][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,744][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,744][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,744][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,745][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,745][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,745][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,745][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,745][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,746][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,746][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,746][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,746][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,746][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,747][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,747][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,747][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,747][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:54:06,747][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,747][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,748][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,748][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,748][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,748][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,749][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,749][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,749][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,749][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,749][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,749][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,749][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,750][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,750][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,750][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,750][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,750][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,751][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,751][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,751][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,751][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,751][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,751][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,751][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,752][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,752][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,752][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,752][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,752][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:54:06,753][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:54:06,753][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:54:06,753][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:54:06,754][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,758][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,758][root][INFO] - Saved parsed outputs
[2025-03-06 10:54:06,758][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,759][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,759][root][INFO] - Saved parsing metadata
[2025-03-06 10:54:06,760][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,774][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:06,775][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:54:06,793][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:54:06,794][root][INFO] - Summary of metrics : {'label_accuracy': 0.0707070707070707, 'misclassification_rate': 0.9292929292929293, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 66, 'malformed_domain': 81, 'total_predictions': 99, 'correct_predictions': 7, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.020202020202020204, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 14, 'correct_label_wrong_domain': 3, 'both_wrong': 78}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 10:54:14,882][root][INFO] - Setting global seed to 206
[2025-03-06 10:54:14,889][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:54:14,890][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:54:14,891][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:54:14,892][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:54:14,894][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:54:14,894][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:54:15,043][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:54:15,319][root][INFO] - Full model selected, loading model
[2025-03-06 10:54:33,856][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:54:33,856][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:54:40,540][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:54:40,542][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:54:40,542][root][INFO] - Starting inference
[2025-03-06 10:54:40,749][root][INFO] - Processing question number 0
[2025-03-06 10:54:40,751][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:55:06,445][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:55:33,033][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:55:59,201][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:56:25,826][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:56:51,883][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:57:17,889][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:57:44,704][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:58:11,067][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:58:37,030][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:59:03,654][root][INFO] - Processing question number 10
[2025-03-06 10:59:03,656][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:59:31,609][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:59:57,357][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:00:23,699][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:00:50,556][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:01:17,411][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:01:43,438][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:02:09,447][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:02:35,868][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:03:02,196][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:03:28,348][root][INFO] - Processing question number 20
[2025-03-06 11:03:28,350][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:03:54,603][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:04:21,234][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:04:47,164][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:05:12,915][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:05:39,423][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:06:05,725][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:06:32,730][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:06:58,936][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:07:25,329][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:07:50,991][root][INFO] - Processing question number 30
[2025-03-06 11:07:50,993][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:08:17,562][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:08:44,403][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:09:10,791][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:09:36,967][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:10:03,012][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:10:29,803][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:10:55,925][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:11:22,476][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:11:48,852][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:12:15,872][root][INFO] - Processing question number 40
[2025-03-06 11:12:15,874][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:12:42,315][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:13:08,740][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:13:35,605][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:14:02,417][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:14:28,486][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:14:54,888][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:15:22,555][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:15:48,049][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:16:14,274][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:16:41,165][root][INFO] - Processing question number 50
[2025-03-06 11:16:41,171][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:17:08,243][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:17:34,722][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:18:00,402][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:18:27,808][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:18:54,273][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:19:19,766][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:19:46,800][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:20:12,693][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:20:39,591][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:21:07,303][root][INFO] - Processing question number 60
[2025-03-06 11:21:07,307][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:21:33,192][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:21:59,379][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:22:26,189][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:22:52,041][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:23:18,407][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:23:44,811][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:24:11,255][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:24:37,976][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:25:04,472][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:25:31,449][root][INFO] - Processing question number 70
[2025-03-06 11:25:31,454][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:25:57,624][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:26:23,835][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:26:49,883][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:27:16,537][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:27:43,137][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:28:09,067][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:28:35,817][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:29:02,371][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:29:29,119][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:29:55,275][root][INFO] - Processing question number 80
[2025-03-06 11:29:55,279][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:30:21,869][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:30:48,435][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:31:14,502][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:31:40,602][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:32:07,480][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:32:34,149][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:33:00,913][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:33:26,966][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:33:53,491][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:34:19,339][root][INFO] - Processing question number 90
[2025-03-06 11:34:19,344][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:34:46,637][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:35:11,980][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:35:38,219][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:36:03,740][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:36:30,507][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:36:56,348][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:37:22,465][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:37:48,921][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:38:15,814][root][INFO] - Inference complete
[2025-03-06 11:38:15,814][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,820][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,820][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,821][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,821][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,822][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,826][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,826][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,827][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,827][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,827][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,827][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,828][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,828][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,829][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,829][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,829][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,829][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,830][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,830][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:38:15,830][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,830][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,831][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,831][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,831][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,831][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,832][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,832][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,832][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,832][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,832][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,832][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,833][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,833][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,834][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,834][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,834][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,834][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,834][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,834][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,834][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,835][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,836][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,836][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,836][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,836][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,836][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,837][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,837][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,837][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,837][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,837][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,838][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,838][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,838][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,839][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,839][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,839][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,839][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:38:15,839][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,840][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,841][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,841][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,841][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,841][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,842][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,842][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,842][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,842][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,842][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,842][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,843][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,843][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,843][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,843][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,843][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,844][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,845][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:38:15,845][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,846][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,846][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,846][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,846][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,847][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,847][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:38:15,847][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,847][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,848][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,848][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,848][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,848][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,849][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,849][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,849][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,849][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,849][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,850][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,850][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,850][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,850][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:38:15,850][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,851][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,851][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,851][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,851][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,852][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,852][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,852][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,852][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,853][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,853][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,853][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,853][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,853][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:38:15,854][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:38:15,854][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:38:15,854][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:38:15,856][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,860][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,861][root][INFO] - Saved parsed outputs
[2025-03-06 11:38:15,861][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,862][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,862][root][INFO] - Saved parsing metadata
[2025-03-06 11:38:15,862][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,885][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:38:15,887][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:38:15,907][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:38:15,907][root][INFO] - Summary of metrics : {'label_accuracy': 0.20202020202020202, 'misclassification_rate': 0.797979797979798, 'combined_accuracy': 0.0, 'malformed_label': 46, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 20, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 20, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 11:38:23,590][root][INFO] - Setting global seed to 206
[2025-03-06 11:38:23,597][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:38:23,598][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:38:23,599][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:38:23,601][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:38:23,603][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:38:23,603][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:38:23,770][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:38:24,030][root][INFO] - Full model selected, loading model
[2025-03-06 11:38:42,341][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:39:50,314][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:39:50,346][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:40:16,238][root][INFO] - Peft model loaded successfully
[2025-03-06 11:40:22,618][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:40:22,620][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:40:22,620][root][INFO] - Starting inference
[2025-03-06 11:40:22,864][root][INFO] - Processing question number 0
[2025-03-06 11:40:22,866][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:40:28,169][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:40:55,087][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:41:03,059][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:41:30,009][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:41:43,566][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:41:51,079][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:42:18,180][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:42:44,821][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:42:52,516][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:43:01,820][root][INFO] - Processing question number 10
[2025-03-06 11:43:01,822][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:43:30,067][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:43:56,142][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:44:05,651][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:44:32,842][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:44:38,274][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:45:04,732][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:45:31,015][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:45:37,031][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:46:03,692][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:46:07,224][root][INFO] - Processing question number 20
[2025-03-06 11:46:07,226][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:46:33,965][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:46:40,655][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:46:51,123][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:47:17,391][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:47:44,333][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:48:10,935][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:48:17,256][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:48:43,816][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:48:53,257][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:49:02,095][root][INFO] - Processing question number 30
[2025-03-06 11:49:02,097][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:49:07,611][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:49:15,635][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:49:22,208][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:49:48,735][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:50:15,093][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:50:42,162][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:51:08,660][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:51:18,894][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:51:25,677][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:51:53,058][root][INFO] - Processing question number 40
[2025-03-06 11:51:53,061][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:52:19,760][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:52:26,673][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:52:53,821][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:53:20,915][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:53:47,289][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:54:13,961][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:54:20,615][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:54:39,573][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:54:49,152][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:55:16,342][root][INFO] - Processing question number 50
[2025-03-06 11:55:16,345][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:55:22,255][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:55:31,728][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:55:39,358][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:56:07,046][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:56:18,630][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:56:44,410][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:57:11,809][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:57:16,580][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:57:43,767][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:57:47,845][root][INFO] - Processing question number 60
[2025-03-06 11:57:47,848][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:57:54,365][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:58:20,911][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:58:48,021][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:58:59,027][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:59:25,685][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:59:44,773][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:59:51,314][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:00:18,320][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:00:29,094][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:00:39,041][root][INFO] - Processing question number 70
[2025-03-06 12:00:39,044][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:00:44,041][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:01:10,586][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:01:36,955][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:02:03,936][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:02:30,877][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:02:35,826][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:03:02,857][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:03:29,692][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:03:46,058][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:04:12,565][root][INFO] - Processing question number 80
[2025-03-06 12:04:12,569][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:04:30,623][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:04:57,476][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:05:23,853][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:05:37,564][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:06:04,728][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:06:31,718][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:06:58,763][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:07:10,719][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:07:37,526][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:07:42,449][root][INFO] - Processing question number 90
[2025-03-06 12:07:42,453][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:07:51,615][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:08:17,267][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:08:43,827][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:09:09,630][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:09:36,772][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:10:03,032][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:10:14,542][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:10:41,266][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:11:08,460][root][INFO] - Inference complete
[2025-03-06 12:11:08,460][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,466][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,467][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,467][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,468][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,468][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,468][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,468][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:08,468][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,469][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,469][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,469][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,469][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,470][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,470][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,470][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,470][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,471][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,471][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,471][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,471][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,471][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,472][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,472][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,472][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,472][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,472][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,472][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,472][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,473][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,473][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,473][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,473][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,473][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,474][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,474][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,474][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,474][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,474][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,474][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,474][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,475][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,475][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,475][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,475][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,476][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,476][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,476][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,476][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,477][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,477][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,477][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,477][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,477][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,478][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,478][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,478][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,478][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,478][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,479][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,479][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,479][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,479][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,480][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,480][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,480][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,481][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,481][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,481][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,481][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,481][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,482][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,482][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,482][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,482][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,482][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,482][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,483][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,483][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,483][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,483][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,484][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,484][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,484][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,484][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,484][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,485][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,485][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,485][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,485][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,485][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:08,485][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,485][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,486][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,486][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,486][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,486][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,486][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,486][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,486][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,487][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,487][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,487][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,487][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,487][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,488][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,488][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,488][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,488][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,489][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,489][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,489][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,490][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,490][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,490][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,490][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,490][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,491][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,491][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,491][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,491][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,491][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,491][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,491][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,492][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,492][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,492][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,492][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,493][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,493][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,493][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,493][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,493][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,494][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,494][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,494][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,494][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,495][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,495][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,495][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,495][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,496][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,496][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,496][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,496][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,497][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,497][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,497][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,497][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,497][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,498][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,498][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,498][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,498][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,498][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,498][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,499][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,499][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,499][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,499][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,499][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,500][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,500][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,500][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,500][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,500][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,501][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,501][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,501][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,501][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:11:08,501][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,501][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,502][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,502][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,502][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,502][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,502][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,502][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,503][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,503][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,503][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,504][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,504][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,504][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,504][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,504][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,505][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,505][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,505][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,505][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,505][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,505][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,505][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,506][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,506][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,506][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,506][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,506][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,506][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,506][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,507][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,507][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,507][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,507][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,507][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,508][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,508][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,508][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,508][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,508][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,509][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,509][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,509][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,509][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,509][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,510][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,510][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,510][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,510][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,510][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,510][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,511][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:11:08,511][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:11:08,511][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:11:08,511][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:11:08,512][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,516][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,516][root][INFO] - Saved parsed outputs
[2025-03-06 12:11:08,516][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,518][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,518][root][INFO] - Saved parsing metadata
[2025-03-06 12:11:08,518][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,520][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:08,521][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:11:08,538][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:11:08,538][root][INFO] - Summary of metrics : {'label_accuracy': 0.1111111111111111, 'misclassification_rate': 0.8888888888888888, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 54, 'malformed_domain': 66, 'total_predictions': 99, 'correct_predictions': 11, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.050505050505050504, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.030303030303030304, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.04040404040404041, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 8, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 12:11:16,332][root][INFO] - Setting global seed to 206
[2025-03-06 12:11:16,352][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:11:16,352][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:11:16,354][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:11:16,356][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:11:16,358][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:11:16,358][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:11:16,506][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:11:16,852][root][INFO] - Full model selected, loading model
[2025-03-06 12:11:39,466][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:11:39,466][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:11:46,153][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:11:46,155][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:11:46,155][root][INFO] - Starting inference
[2025-03-06 12:11:46,349][root][INFO] - Processing question number 0
[2025-03-06 12:11:46,351][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:12:12,264][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:12:39,051][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:13:05,407][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:13:32,225][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:13:58,486][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:14:24,705][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:14:51,715][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:15:18,279][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:15:44,467][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:16:11,303][root][INFO] - Processing question number 10
[2025-03-06 12:16:11,304][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:16:39,450][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:17:05,394][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:17:31,944][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:17:59,011][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:18:26,065][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:18:52,145][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:19:18,099][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:19:23,445][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:19:49,870][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:19:57,802][root][INFO] - Processing question number 20
[2025-03-06 12:19:57,804][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:20:24,207][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:20:50,832][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:21:16,902][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:21:42,845][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:22:09,549][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:22:36,052][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:23:03,261][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:23:29,680][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:23:56,278][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:24:22,147][root][INFO] - Processing question number 30
[2025-03-06 12:24:22,149][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:24:48,926][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:25:15,968][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:25:42,554][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:26:08,924][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:26:15,922][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:26:42,912][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:27:09,237][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:27:35,992][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:28:02,578][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:28:29,874][root][INFO] - Processing question number 40
[2025-03-06 12:28:29,877][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:28:56,859][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:29:23,676][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:29:50,832][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:30:18,023][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:30:44,398][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:31:11,232][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:31:39,187][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:32:04,855][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:32:31,284][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:32:58,361][root][INFO] - Processing question number 50
[2025-03-06 12:32:58,364][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:33:25,635][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:33:28,641][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:33:54,520][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:34:22,101][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:34:48,748][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:35:14,426][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:35:41,648][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:35:46,770][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:36:13,848][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:36:41,747][root][INFO] - Processing question number 60
[2025-03-06 12:36:41,750][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:37:07,824][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:37:34,196][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:38:01,189][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:38:27,228][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:38:53,774][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:39:20,370][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:39:47,002][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:40:13,906][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:40:40,591][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:41:07,751][root][INFO] - Processing question number 70
[2025-03-06 12:41:07,755][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:41:34,082][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:42:00,461][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:42:08,421][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:42:35,245][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:43:02,055][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:43:28,177][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:43:55,110][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:44:21,850][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:44:48,780][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:45:15,105][root][INFO] - Processing question number 80
[2025-03-06 12:45:15,109][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:45:41,881][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:46:08,635][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:46:34,885][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:47:01,173][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:47:28,239][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:47:55,074][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:48:01,198][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:48:27,446][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:48:54,161][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:49:20,196][root][INFO] - Processing question number 90
[2025-03-06 12:49:20,200][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:49:23,320][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:49:48,818][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:50:15,203][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:50:40,916][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:51:07,873][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:51:33,910][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:52:00,213][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:52:26,853][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:52:29,219][root][INFO] - Inference complete
[2025-03-06 12:52:29,219][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,225][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,231][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,231][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,232][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,232][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,232][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,233][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,233][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,233][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,233][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,234][root][WARNING] - |Q. 43||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,234][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,234][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,234][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,234][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,235][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,235][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,235][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,236][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,236][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,236][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,236][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,237][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,237][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,237][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,238][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,238][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,238][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,238][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,239][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,239][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,239][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,239][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,241][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,241][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,241][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,241][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,242][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,243][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,243][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,243][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,244][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,244][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,245][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,245][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,245][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,246][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,246][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,246][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,246][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,247][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,247][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,247][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,247][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,247][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,248][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,248][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,249][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,249][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,249][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,249][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,251][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,252][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,252][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,252][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,252][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,253][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:52:29,253][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,253][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,254][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,254][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,254][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,254][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:52:29,255][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:52:29,255][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:52:29,255][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:52:29,256][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,260][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,260][root][INFO] - Saved parsed outputs
[2025-03-06 12:52:29,260][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,262][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,262][root][INFO] - Saved parsing metadata
[2025-03-06 12:52:29,262][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,264][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:29,265][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:52:29,271][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:52:29,271][root][INFO] - Summary of metrics : {'label_accuracy': 0.21212121212121213, 'misclassification_rate': 0.7878787878787878, 'combined_accuracy': 0.0, 'malformed_label': 43, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 21, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 21, 'both_wrong': 78}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 12:52:35,950][root][INFO] - Setting global seed to 206
[2025-03-06 12:52:35,956][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:52:35,956][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:52:35,957][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:52:35,959][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:52:35,961][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:52:35,961][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:52:36,104][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:52:36,374][root][INFO] - Full model selected, loading model
[2025-03-06 12:52:55,560][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:54:03,982][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:54:03,983][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:54:31,675][root][INFO] - Peft model loaded successfully
[2025-03-06 12:54:38,025][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:54:38,027][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:54:38,027][root][INFO] - Starting inference
[2025-03-06 12:54:38,240][root][INFO] - Processing question number 0
[2025-03-06 12:54:38,242][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:55:04,356][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:55:31,224][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:55:40,497][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:55:46,438][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:55:57,295][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:56:09,345][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:56:36,379][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:57:02,969][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:57:10,624][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:57:18,362][root][INFO] - Processing question number 10
[2025-03-06 12:57:18,364][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:57:38,836][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:57:44,203][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:58:10,760][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:58:19,550][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:58:26,094][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:58:52,178][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:59:00,556][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:59:08,795][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:59:18,344][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:59:21,194][root][INFO] - Processing question number 20
[2025-03-06 12:59:21,196][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:59:26,229][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:59:45,512][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:00:05,928][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:00:31,959][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:00:43,268][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:01:09,807][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:01:20,608][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:01:42,282][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:01:54,157][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:02:20,053][root][INFO] - Processing question number 30
[2025-03-06 13:02:20,111][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:02:24,144][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:02:27,668][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:02:35,454][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:02:43,963][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:03:10,268][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:03:22,619][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:03:31,636][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:03:58,419][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:04:25,006][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:04:29,176][root][INFO] - Processing question number 40
[2025-03-06 13:04:29,178][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:04:55,821][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:05:03,121][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:05:11,220][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:05:17,544][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:05:22,044][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:05:31,671][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:05:59,550][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:06:25,247][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:06:33,311][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:07:00,438][root][INFO] - Processing question number 50
[2025-03-06 13:07:00,441][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:07:27,819][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:07:54,537][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:08:20,445][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:08:29,417][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:08:56,112][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:09:10,275][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:09:37,614][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:09:46,835][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:10:13,943][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:10:36,747][root][INFO] - Processing question number 60
[2025-03-06 13:10:36,751][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:10:44,667][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:10:49,204][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:11:00,242][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:11:04,748][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:11:12,913][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:11:29,973][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:11:43,811][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:11:49,231][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:11:56,713][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:12:09,021][root][INFO] - Processing question number 70
[2025-03-06 13:12:09,024][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:12:15,264][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:12:25,965][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:12:52,362][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:13:01,499][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:13:20,014][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:13:27,755][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:13:34,802][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:14:01,666][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:14:07,326][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:14:17,839][root][INFO] - Processing question number 80
[2025-03-06 13:14:17,843][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:14:24,466][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:14:51,303][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:15:17,614][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:15:43,967][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:15:52,150][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:16:19,071][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:16:31,362][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:16:35,938][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:17:02,682][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:17:10,164][root][INFO] - Processing question number 90
[2025-03-06 13:17:10,168][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:17:24,837][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:17:50,428][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:18:02,638][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:18:12,862][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:18:23,439][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:18:49,490][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:19:07,434][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:19:12,618][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:19:19,606][root][INFO] - Inference complete
[2025-03-06 13:19:19,606][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,613][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,613][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,614][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,614][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,614][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,615][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,615][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:19:19,615][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,616][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,616][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,616][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,616][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,617][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,617][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,617][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,617][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,618][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,618][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,618][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,618][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,618][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,618][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,618][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,619][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,619][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,619][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,619][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,619][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,619][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,619][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,620][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,620][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,620][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,620][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,620][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,620][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,621][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,621][root][WARNING] - |Q. 43||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,621][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,621][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,622][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,622][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,622][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,622][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,622][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,623][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,623][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,623][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,623][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,623][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,624][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,624][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,624][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,625][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,625][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,625][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,625][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,626][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,626][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,626][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,626][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,626][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,626][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,627][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,627][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,627][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,627][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,627][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,628][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,628][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,628][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,628][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,629][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,629][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,629][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,629][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,629][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,630][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,630][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,630][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,630][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,630][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,630][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,630][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,631][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,631][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,631][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,631][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,631][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,632][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,632][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,632][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,632][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,633][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,633][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,633][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,633][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,634][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,634][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,634][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,634][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,634][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,634][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,634][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,635][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,635][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:19:19,635][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,635][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,635][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,636][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,636][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,636][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,636][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,636][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,636][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,637][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,637][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,637][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,637][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,638][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,638][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:19:19,638][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,638][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,639][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,639][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,639][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,639][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,639][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:19:19,639][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,639][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,640][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,640][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,640][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,640][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,640][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,640][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,641][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,641][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,641][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,641][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,641][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,641][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,642][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,642][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,642][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,642][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,642][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,642][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,643][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,643][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,643][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,643][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,643][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,643][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,644][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,644][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,644][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,644][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,644][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,644][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,644][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,644][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,645][root][WARNING] - |Q. 36||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:19:19,645][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,645][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,645][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,645][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,645][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,646][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,646][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,646][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,646][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,646][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:19:19,647][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:19:19,647][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:19:19,647][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:19:19,648][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,652][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,652][root][INFO] - Saved parsed outputs
[2025-03-06 13:19:19,652][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,654][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,654][root][INFO] - Saved parsing metadata
[2025-03-06 13:19:19,656][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,670][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:19,672][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:19:19,691][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 13:19:19,691][root][INFO] - Summary of metrics : {'label_accuracy': 0.1414141414141414, 'misclassification_rate': 0.8585858585858586, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 39, 'malformed_domain': 70, 'total_predictions': 99, 'correct_predictions': 14, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.050505050505050504, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.020202020202020204, 'correct_domain_wrong_label': 26, 'correct_label_wrong_domain': 11, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 13:19:27,702][root][INFO] - Setting global seed to 206
[2025-03-06 13:19:27,709][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:19:27,710][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:19:27,711][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:19:27,713][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:19:27,716][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:19:27,716][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:19:28,041][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:19:28,362][root][INFO] - Full model selected, loading model
[2025-03-06 13:19:46,693][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:19:46,693][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:19:53,282][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:19:53,284][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:19:53,284][root][INFO] - Starting inference
[2025-03-06 13:19:53,498][root][INFO] - Processing question number 0
[2025-03-06 13:19:53,516][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:19:59,396][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:20:10,906][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:20:37,252][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:21:04,072][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:21:11,281][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:21:11,688][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:21:16,080][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:21:20,830][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:21:47,013][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:22:13,837][root][INFO] - Processing question number 10
[2025-03-06 13:22:13,839][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:22:41,982][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:22:42,291][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:22:44,222][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:22:44,683][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:22:50,230][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:23:16,359][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:23:42,292][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:23:46,470][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:24:12,888][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:24:39,059][root][INFO] - Processing question number 20
[2025-03-06 13:24:39,061][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:25:05,458][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:25:32,083][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:25:32,734][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:25:33,002][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:25:42,583][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:25:44,552][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:26:11,753][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:26:38,157][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:26:48,640][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:27:14,500][root][INFO] - Processing question number 30
[2025-03-06 13:27:14,503][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:27:41,269][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:27:43,359][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:27:46,611][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:27:46,969][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:27:47,549][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:27:56,908][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:27:59,927][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:28:00,422][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:28:12,109][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:28:39,318][root][INFO] - Processing question number 40
[2025-03-06 13:28:39,353][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:29:05,988][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:29:32,595][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:29:59,654][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:30:26,654][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:30:52,921][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:31:19,508][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:31:21,751][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:31:47,416][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:32:01,218][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:32:03,477][root][INFO] - Processing question number 50
[2025-03-06 13:32:03,480][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:32:30,732][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:32:57,409][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:33:23,292][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:33:33,270][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:33:33,682][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:33:59,367][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:34:26,594][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:34:52,695][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:34:56,553][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:34:57,169][root][INFO] - Processing question number 60
[2025-03-06 13:34:57,172][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:35:23,250][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:35:23,857][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:35:27,832][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:35:53,887][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:35:54,390][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:36:21,108][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:36:48,014][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:36:48,471][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:36:50,949][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:36:53,003][root][INFO] - Processing question number 70
[2025-03-06 13:36:53,006][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:36:54,909][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:36:56,817][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:37:04,066][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:37:30,904][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:37:57,714][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:37:59,047][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:38:01,799][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:38:02,375][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:38:29,319][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:38:31,879][root][INFO] - Processing question number 80
[2025-03-06 13:38:31,883][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:38:58,663][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:39:25,432][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:39:51,694][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:40:17,987][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:40:45,057][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:41:11,898][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:41:17,375][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:41:27,961][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:41:54,670][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:41:57,827][root][INFO] - Processing question number 90
[2025-03-06 13:41:57,834][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:42:14,002][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:42:39,498][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:43:05,867][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:43:31,563][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:43:39,871][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:44:05,894][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:44:32,184][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:44:58,815][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:45:25,889][root][INFO] - Inference complete
[2025-03-06 13:45:25,890][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,895][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,898][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,898][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,899][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,899][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,900][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,900][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,900][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,900][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,910][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,910][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,910][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,910][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,911][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,912][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,912][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,912][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,912][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,912][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,913][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,913][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,913][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,913][root][WARNING] - |Q. 50||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:45:25,913][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,914][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:45:25,914][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:45:25,914][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:45:25,914][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:45:25,917][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,921][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,921][root][INFO] - Saved parsed outputs
[2025-03-06 13:45:25,921][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,922][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,923][root][INFO] - Saved parsing metadata
[2025-03-06 13:45:25,923][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,925][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:45:25,926][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:45:25,943][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 13:45:25,943][root][INFO] - Summary of metrics : {'label_accuracy': 0.15151515151515152, 'misclassification_rate': 0.8484848484848485, 'combined_accuracy': 0.0, 'malformed_label': 52, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 13:45:34,078][root][INFO] - Setting global seed to 989
[2025-03-06 13:45:34,086][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:45:34,086][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:45:34,087][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:45:34,089][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:45:34,091][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:45:34,091][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:45:34,276][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:45:34,603][root][INFO] - Full model selected, loading model
[2025-03-06 13:45:53,267][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:47:01,375][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:47:01,375][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:47:28,476][root][INFO] - Peft model loaded successfully
[2025-03-06 13:47:34,847][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:47:34,849][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:47:34,849][root][INFO] - Starting inference
[2025-03-06 13:47:35,064][root][INFO] - Processing question number 0
[2025-03-06 13:47:35,066][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:48:00,917][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:48:27,615][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:48:53,914][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:49:20,665][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:49:46,836][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:49:58,048][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:50:05,441][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:50:31,887][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:50:42,947][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:50:50,471][root][INFO] - Processing question number 10
[2025-03-06 13:50:50,473][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:51:18,527][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:51:44,421][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:51:56,982][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:52:03,624][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:52:15,714][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:52:41,646][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:53:07,514][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:53:13,319][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:53:39,691][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:54:05,731][root][INFO] - Processing question number 20
[2025-03-06 13:54:05,734][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:54:32,095][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:54:58,602][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:55:07,384][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:55:33,428][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:56:00,278][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:56:07,059][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:56:15,503][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:56:22,763][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:56:49,321][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:57:15,271][root][INFO] - Processing question number 30
[2025-03-06 13:57:15,273][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:57:42,003][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:57:53,335][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:58:02,129][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:58:09,135][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:58:18,603][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:58:45,507][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:59:11,807][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:59:38,433][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:59:46,474][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:00:13,645][root][INFO] - Processing question number 40
[2025-03-06 14:00:13,648][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:00:40,133][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:01:06,596][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:01:33,516][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:02:00,404][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:02:26,571][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:02:53,006][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:03:20,732][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:03:46,283][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:03:53,997][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:04:20,967][root][INFO] - Processing question number 50
[2025-03-06 14:04:20,970][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:04:48,185][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:04:58,271][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:05:24,012][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:05:51,469][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:06:17,998][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:06:43,540][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:07:10,705][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:07:15,478][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:07:22,763][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:07:50,536][root][INFO] - Processing question number 60
[2025-03-06 14:07:50,540][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:07:56,828][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:08:23,158][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:08:50,030][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:08:57,431][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:09:23,857][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:09:50,335][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:09:57,959][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:10:03,291][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:10:29,852][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:10:56,902][root][INFO] - Processing question number 70
[2025-03-06 14:10:56,905][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:11:01,861][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:11:08,400][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:11:15,515][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:11:32,932][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:11:59,646][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:12:25,671][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:12:52,493][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:13:19,122][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:13:45,941][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:14:12,246][root][INFO] - Processing question number 80
[2025-03-06 14:14:12,250][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:14:38,938][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:15:05,590][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:15:31,749][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:15:57,947][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:16:24,897][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:16:51,682][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:17:18,502][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:17:27,211][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:17:33,891][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:17:59,795][root][INFO] - Processing question number 90
[2025-03-06 14:17:59,799][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:18:09,025][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:18:34,454][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:19:00,772][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:19:26,366][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:19:53,204][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:20:19,155][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:20:31,843][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:20:58,525][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:21:25,488][root][INFO] - Inference complete
[2025-03-06 14:21:25,488][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,494][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,495][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,495][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,496][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,496][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,496][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,496][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,496][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,496][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,497][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,497][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,497][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,497][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,497][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,498][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,498][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,498][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,498][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,498][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,498][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,499][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,499][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,499][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,499][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,499][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,500][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,500][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,500][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,500][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,501][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,501][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,501][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,501][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,502][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,502][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,502][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,502][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,502][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,502][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,503][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,503][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,503][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,503][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,504][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,504][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,504][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,504][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,504][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,505][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,505][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,505][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,505][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,505][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,506][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,506][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,506][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,506][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,507][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,507][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,507][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,507][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,507][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,507][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,508][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,508][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,508][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,508][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,508][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,509][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,509][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,509][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,509][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,509][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,510][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,510][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,510][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,511][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,511][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,511][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,511][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,511][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,512][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,512][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,512][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,512][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,512][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,512][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,513][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,513][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,513][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,513][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,513][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,514][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,514][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,514][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,514][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,514][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,514][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,515][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,515][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,515][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,515][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,515][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,515][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,516][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,516][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,516][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,516][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,516][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,517][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,517][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,517][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,517][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,517][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,517][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,518][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,518][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,518][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,518][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,518][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,519][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,519][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,519][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,519][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,519][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,520][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,520][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,520][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,520][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,520][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,520][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,521][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,521][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,521][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,521][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,521][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,522][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,522][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,522][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,522][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,522][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,522][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,523][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,523][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,523][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,523][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,523][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,523][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,524][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,524][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,524][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,524][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,525][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,525][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,525][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,525][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,525][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,525][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,526][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,526][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,526][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,526][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,526][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,527][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,527][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,527][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,527][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,527][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,528][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,528][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,528][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,528][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,529][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,529][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,529][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,529][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,529][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,529][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,529][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,530][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,530][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,531][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,531][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,531][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,531][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,531][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,531][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,532][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,532][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,532][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,532][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,532][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,533][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,533][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,533][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,533][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,533][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,533][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,534][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,534][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,534][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,534][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,534][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,534][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,535][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,535][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,535][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,535][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,535][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,535][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,536][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,536][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,536][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,536][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,536][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,536][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,537][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,537][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,537][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,537][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,537][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,537][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,538][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,538][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,538][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,538][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,538][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,539][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,539][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,539][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,539][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,539][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,539][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:21:25,539][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,540][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,540][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,540][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,540][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,540][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,541][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,541][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,541][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,541][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,541][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,541][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,541][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,542][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,542][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,542][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,542][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,542][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,543][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,543][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,543][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,543][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,543][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,543][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,543][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,544][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,544][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,544][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,544][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,545][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:25,545][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:21:25,545][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:25,545][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:21:25,546][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,550][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,550][root][INFO] - Saved parsed outputs
[2025-03-06 14:21:25,550][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,551][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,551][root][INFO] - Saved parsing metadata
[2025-03-06 14:21:25,552][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,554][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:25,555][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:21:25,572][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 14:21:25,572][root][INFO] - Summary of metrics : {'label_accuracy': 0.0707070707070707, 'misclassification_rate': 0.9292929292929293, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 66, 'malformed_domain': 81, 'total_predictions': 99, 'correct_predictions': 7, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.020202020202020204, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.09090909090909091, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 14, 'correct_label_wrong_domain': 3, 'both_wrong': 78}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 14:21:32,887][root][INFO] - Setting global seed to 989
[2025-03-06 14:21:32,895][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:21:32,896][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:21:32,897][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:21:32,899][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:21:32,901][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:21:32,901][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:21:33,052][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:21:33,377][root][INFO] - Full model selected, loading model
[2025-03-06 14:21:52,092][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:21:52,092][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:21:58,731][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:21:58,733][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 14:21:58,733][root][INFO] - Starting inference
[2025-03-06 14:21:58,917][root][INFO] - Processing question number 0
[2025-03-06 14:21:58,919][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:22:24,533][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:22:51,158][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:23:17,346][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:23:43,998][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:24:10,078][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:24:36,110][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:25:02,947][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:25:29,343][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:25:55,340][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:26:21,998][root][INFO] - Processing question number 10
[2025-03-06 14:26:22,000][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:26:49,999][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:27:15,764][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:27:42,123][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:28:09,017][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:28:35,901][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:29:01,790][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:29:27,540][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:29:53,799][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:30:20,044][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:30:46,031][root][INFO] - Processing question number 20
[2025-03-06 14:30:46,034][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:31:12,244][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:31:38,701][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:32:04,587][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:32:30,355][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:32:56,882][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:33:23,213][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:33:50,244][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:34:16,490][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:34:42,916][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:35:08,601][root][INFO] - Processing question number 30
[2025-03-06 14:35:08,603][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:35:35,213][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:36:02,103][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:36:28,524][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:36:54,729][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:37:20,813][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:37:47,636][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:38:13,780][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:38:40,367][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:39:06,769][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:39:33,819][root][INFO] - Processing question number 40
[2025-03-06 14:39:33,822][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:40:00,361][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:40:27,082][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:40:54,168][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:41:21,113][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:41:47,391][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:42:13,915][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:42:41,755][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:43:07,411][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:43:33,658][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:44:00,585][root][INFO] - Processing question number 50
[2025-03-06 14:44:00,588][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:44:27,675][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:44:54,180][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:45:19,880][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:45:47,295][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:46:13,767][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:46:39,280][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:47:06,324][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:47:32,233][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:47:59,144][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:48:26,871][root][INFO] - Processing question number 60
[2025-03-06 14:48:26,874][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:48:52,761][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:49:18,958][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:49:45,783][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:50:11,633][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:50:37,999][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:51:04,418][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:51:30,866][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:51:57,603][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:52:24,119][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:52:51,132][root][INFO] - Processing question number 70
[2025-03-06 14:52:51,136][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:53:17,313][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:53:43,532][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:54:09,605][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:54:36,279][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:55:02,908][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:55:28,860][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:55:55,628][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:56:22,194][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:56:48,959][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:57:15,129][root][INFO] - Processing question number 80
[2025-03-06 14:57:15,133][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:57:41,718][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:58:08,296][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:58:34,370][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:59:00,488][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:59:27,379][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:59:54,061][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:00:20,838][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:00:46,910][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:01:13,446][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:01:39,305][root][INFO] - Processing question number 90
[2025-03-06 15:01:39,309][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:02:06,591][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:02:31,921][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:02:58,139][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:03:23,667][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:03:50,446][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:04:16,337][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:04:42,619][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:05:09,160][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:05:36,057][root][INFO] - Inference complete
[2025-03-06 15:05:36,057][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,063][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,063][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,064][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,065][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,065][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,069][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,069][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,069][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,069][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,070][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,070][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,071][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,071][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,072][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,072][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,072][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,072][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,073][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,073][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:05:36,073][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,073][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,073][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,074][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,074][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,074][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,074][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,075][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,075][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,075][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,075][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,075][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,075][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,076][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,076][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,076][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,076][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,077][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,077][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,077][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,077][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,078][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,078][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,078][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,079][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,079][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,079][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,079][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,079][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,080][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,080][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,080][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,080][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,081][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,081][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,081][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,081][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,082][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,082][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:05:36,082][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,083][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,083][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,083][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,083][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,084][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,084][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,084][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,084][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,084][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,085][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,085][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,085][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,085][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,086][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,086][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,086][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,087][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,087][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:05:36,088][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,088][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,089][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,089][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,089][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,089][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,090][root][WARNING] - |Q. 54||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:05:36,090][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,090][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,090][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,090][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,090][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,091][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,091][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,091][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,091][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,092][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,092][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,092][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,092][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,092][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,093][root][WARNING] - |Q. 10||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:05:36,093][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,093][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,094][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,094][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,094][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,094][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,095][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,095][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,095][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,095][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,095][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,095][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,095][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,096][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:05:36,096][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:05:36,096][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:05:36,096][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:05:36,098][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,102][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,103][root][INFO] - Saved parsed outputs
[2025-03-06 15:05:36,103][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,104][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,104][root][INFO] - Saved parsing metadata
[2025-03-06 15:05:36,105][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,106][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:05:36,107][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:05:36,117][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 15:05:36,117][root][INFO] - Summary of metrics : {'label_accuracy': 0.20202020202020202, 'misclassification_rate': 0.797979797979798, 'combined_accuracy': 0.0, 'malformed_label': 46, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 20, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 20, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 15:05:43,214][root][INFO] - Setting global seed to 989
[2025-03-06 15:05:43,221][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 15:05:43,222][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:05:43,223][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:05:43,224][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:05:43,226][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:05:43,226][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:05:43,402][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:05:43,678][root][INFO] - Full model selected, loading model
[2025-03-06 15:06:02,190][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:07:10,572][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:07:10,573][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:07:38,543][root][INFO] - Peft model loaded successfully
[2025-03-06 15:07:44,924][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:07:44,928][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:07:44,928][root][INFO] - Starting inference
[2025-03-06 15:07:45,182][root][INFO] - Processing question number 0
[2025-03-06 15:07:45,184][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:07:54,802][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:08:02,238][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:08:08,987][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:08:35,914][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:09:02,262][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:09:12,271][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:09:19,240][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:09:45,868][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:10:12,100][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:10:16,911][root][INFO] - Processing question number 10
[2025-03-06 15:10:16,913][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:10:45,159][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:11:11,206][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:11:17,182][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:11:44,302][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:11:56,475][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:12:04,183][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:12:11,838][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:12:30,263][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:12:56,792][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:13:23,015][root][INFO] - Processing question number 20
[2025-03-06 15:13:23,017][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:13:28,558][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:13:36,277][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:14:02,383][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:14:28,452][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:14:55,221][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:15:21,798][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:15:49,145][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:15:57,301][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:16:06,859][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:16:32,782][root][INFO] - Processing question number 30
[2025-03-06 15:16:32,784][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:16:59,608][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:17:14,060][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:17:40,710][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:17:47,722][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:17:54,812][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:18:21,865][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:18:30,036][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:18:56,861][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:19:03,932][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:19:31,297][root][INFO] - Processing question number 40
[2025-03-06 15:19:31,299][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:19:57,971][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:20:04,289][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:20:31,405][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:20:58,478][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:21:06,499][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:21:33,145][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:22:01,063][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:22:09,242][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:22:17,024][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:22:44,178][root][INFO] - Processing question number 50
[2025-03-06 15:22:44,181][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:22:50,382][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:23:00,714][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:23:26,743][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:23:31,951][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:23:58,935][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:24:24,888][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:24:52,358][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:24:57,203][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:25:24,548][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:25:52,611][root][INFO] - Processing question number 60
[2025-03-06 15:25:52,629][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:25:59,402][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:26:26,130][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:26:36,917][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:27:03,027][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:27:29,640][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:27:41,448][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:27:48,573][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:28:15,564][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:28:42,325][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:28:49,169][root][INFO] - Processing question number 70
[2025-03-06 15:28:49,173][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:29:15,660][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:29:23,639][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:29:30,937][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:29:41,335][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:29:50,457][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:30:05,336][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:30:32,347][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:30:43,921][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:30:49,635][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:31:16,123][root][INFO] - Processing question number 80
[2025-03-06 15:31:16,137][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:31:43,016][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:31:46,972][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:31:54,819][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:32:21,216][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:32:27,825][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:32:54,795][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:33:21,809][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:33:30,588][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:33:57,380][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:34:23,484][root][INFO] - Processing question number 90
[2025-03-06 15:34:23,488][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:34:38,270][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:35:03,909][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:35:30,434][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:35:56,214][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:36:23,232][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:36:49,323][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:37:15,718][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:37:42,425][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:38:09,594][root][INFO] - Inference complete
[2025-03-06 15:38:09,594][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,600][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,601][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,602][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,602][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,602][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,603][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,603][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,603][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,603][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,604][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,604][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,604][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,604][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,605][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,605][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,605][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,605][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,605][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,606][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,606][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,606][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,606][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,606][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,607][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,607][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,607][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,607][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,607][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,607][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,608][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,608][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,608][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,608][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,609][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,609][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,609][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,609][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,609][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,610][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,610][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,610][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,610][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,611][root][WARNING] - |Q. 43||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,611][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,611][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,611][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,611][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,611][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,611][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,612][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,612][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,612][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,612][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,612][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,613][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,613][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,613][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,613][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,614][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,614][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,614][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,614][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,614][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,614][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,614][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,615][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,615][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,615][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,615][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,615][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,616][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,616][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,616][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,616][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,616][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,617][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,617][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,617][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,617][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,618][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,618][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,618][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,618][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,618][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,618][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,618][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,619][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,619][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,619][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,619][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,619][root][WARNING] - |Q. 58||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:09,619][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,619][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,620][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,620][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,620][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,620][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,620][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,620][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,621][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,621][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,621][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,621][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,621][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,622][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,622][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,622][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,622][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,622][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,623][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,623][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,623][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,623][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,623][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,624][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,624][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,624][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,624][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,624][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,625][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,625][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,625][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,625][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,625][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,626][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,626][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,626][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,626][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,627][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,627][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,627][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,627][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,627][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,628][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,628][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,628][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,628][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,628][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,628][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,628][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,629][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,629][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,629][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,629][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,629][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,630][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,630][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,630][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,630][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,630][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,630][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,630][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,631][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,631][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,631][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,631][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,631][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,632][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,632][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,632][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,632][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,633][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,633][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,633][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,633][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,634][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,634][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,634][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,634][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,634][root][WARNING] - |Q. 86||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,634][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,634][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,635][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,635][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:09,635][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,635][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,636][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,636][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,636][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,636][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,636][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,636][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,637][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,637][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,637][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,637][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,637][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,638][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,638][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,638][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,638][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,638][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,638][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:09,638][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,639][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,639][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:09,639][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,639][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,639][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,639][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,639][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,640][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,640][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,640][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,640][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,640][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,641][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,641][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,641][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,641][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,641][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:09,641][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,641][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,642][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,642][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,642][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,642][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,642][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,642][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,642][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,643][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,643][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,643][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,643][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,643][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,644][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,644][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,644][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,644][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,644][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,644][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,645][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,645][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,645][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,645][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,645][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,645][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,646][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,646][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,646][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,646][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,646][root][WARNING] - |Q. 80||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,647][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,647][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,647][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,647][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,647][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,647][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,648][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:09,648][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:09,648][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:09,648][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:09,649][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,653][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,653][root][INFO] - Saved parsed outputs
[2025-03-06 15:38:09,653][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,655][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,655][root][INFO] - Saved parsing metadata
[2025-03-06 15:38:09,655][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,715][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:09,716][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:38:09,786][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 15:38:09,786][root][INFO] - Summary of metrics : {'label_accuracy': 0.16161616161616163, 'misclassification_rate': 0.8383838383838383, 'combined_accuracy': 0.08080808080808081, 'malformed_label': 60, 'malformed_domain': 67, 'total_predictions': 99, 'correct_predictions': 16, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.06060606060606061, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.04040404040404041, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.08080808080808081, 'Civil_Procedure_confidence': 0.030303030303030304, 'correct_domain_wrong_label': 24, 'correct_label_wrong_domain': 8, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 15:38:22,080][root][INFO] - Setting global seed to 989
[2025-03-06 15:38:22,089][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 15:38:22,089][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:38:22,090][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:38:22,092][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:38:22,097][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:38:22,097][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:38:22,257][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:38:22,699][root][INFO] - Full model selected, loading model
[2025-03-06 15:38:41,421][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:38:41,421][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:38:48,044][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:38:48,045][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 15:38:48,045][root][INFO] - Starting inference
[2025-03-06 15:38:48,256][root][INFO] - Processing question number 0
[2025-03-06 15:38:48,258][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:39:14,109][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:39:40,880][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:40:07,200][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:40:33,996][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:40:42,124][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:41:08,314][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:41:35,287][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:42:01,828][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:42:27,977][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:42:54,784][root][INFO] - Processing question number 10
[2025-03-06 15:42:54,786][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:43:22,903][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:43:48,833][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:44:15,342][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:44:30,269][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:44:35,086][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:44:37,883][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:45:03,797][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:45:30,215][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:45:56,603][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:46:22,746][root][INFO] - Processing question number 20
[2025-03-06 15:46:22,748][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:46:49,110][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:47:15,709][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:47:41,754][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:48:07,761][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:48:34,706][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:49:01,190][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:49:28,354][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:49:54,740][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:50:21,308][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:50:47,170][root][INFO] - Processing question number 30
[2025-03-06 15:50:47,173][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:51:13,913][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:51:40,932][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:52:07,500][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:52:33,851][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:53:00,085][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:53:27,047][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:53:53,350][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:54:20,083][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:54:46,635][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:55:13,835][root][INFO] - Processing question number 40
[2025-03-06 15:55:13,856][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:55:40,454][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:56:07,055][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:56:34,085][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:57:01,049][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:57:27,307][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:57:53,880][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:58:21,704][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:58:47,372][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:59:13,778][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:59:40,845][root][INFO] - Processing question number 50
[2025-03-06 15:59:40,906][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:00:08,135][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:00:34,795][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:01:00,658][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:01:28,217][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:01:54,851][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:02:20,539][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:02:47,737][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:03:13,809][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:03:40,865][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:04:08,747][root][INFO] - Processing question number 60
[2025-03-06 16:04:08,751][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:04:34,806][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:05:01,190][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:05:28,169][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:05:54,207][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:06:20,742][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:06:47,340][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:07:14,030][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:07:41,084][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:08:07,968][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:08:35,224][root][INFO] - Processing question number 70
[2025-03-06 16:08:35,228][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:08:39,001][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:09:05,582][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:09:31,906][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:09:58,890][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:10:25,799][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:10:51,918][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:11:18,835][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:11:45,566][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:12:12,476][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:12:38,785][root][INFO] - Processing question number 80
[2025-03-06 16:12:38,789][root][INFO] - Domain : Property, Question : 67
[2025-03-06 16:13:05,546][root][INFO] - Domain : Property, Question : 75
[2025-03-06 16:13:32,293][root][INFO] - Domain : Property, Question : 83
[2025-03-06 16:13:58,538][root][INFO] - Domain : Property, Question : 89
[2025-03-06 16:14:24,831][root][INFO] - Domain : Property, Question : 97
[2025-03-06 16:14:51,877][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:15:18,701][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 16:15:45,644][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:16:11,881][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:16:38,579][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:17:04,613][root][INFO] - Processing question number 90
[2025-03-06 16:17:04,629][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:17:32,078][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:17:57,558][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:18:23,918][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:18:49,631][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:19:16,568][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:19:42,599][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:19:45,657][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:19:55,296][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:19:59,461][root][INFO] - Inference complete
[2025-03-06 16:19:59,461][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,473][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,474][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,475][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,475][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,476][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,477][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,477][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,477][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,477][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,477][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,478][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,478][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,478][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,478][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,478][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,479][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,479][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,479][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,480][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,480][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,480][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,480][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,481][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,481][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,481][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,483][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,483][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:19:59,483][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,484][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,484][root][WARNING] - |Q. 38||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:19:59,484][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,484][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,485][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,485][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,485][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,486][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,486][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,486][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,486][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,486][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,487][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,487][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,487][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,488][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,488][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:19:59,488][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,489][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,489][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,489][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,489][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,492][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,492][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,492][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,492][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,493][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,493][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,493][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,493][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,494][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,494][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,495][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,495][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,496][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,496][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,496][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,496][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,496][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,497][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,497][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,497][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,497][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,497][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,498][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,498][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,498][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,498][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,499][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,499][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,499][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,499][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,499][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,499][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,500][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,500][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,500][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,500][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,502][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,502][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,502][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,502][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,502][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,503][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,503][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,503][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,503][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,503][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,503][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,504][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:19:59,504][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:19:59,504][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:19:59,504][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:19:59,505][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,509][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,509][root][INFO] - Saved parsed outputs
[2025-03-06 16:19:59,509][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,511][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,511][root][INFO] - Saved parsing metadata
[2025-03-06 16:19:59,511][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,513][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:19:59,514][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:19:59,539][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 16:19:59,539][root][INFO] - Summary of metrics : {'label_accuracy': 0.2222222222222222, 'misclassification_rate': 0.7777777777777778, 'combined_accuracy': 0.0, 'malformed_label': 42, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 22, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 22, 'both_wrong': 77}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 16:20:07,610][root][INFO] - Setting global seed to 989
[2025-03-06 16:20:07,617][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 16:20:07,617][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 16:20:07,619][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 16:20:07,630][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:20:07,632][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:20:07,632][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 16:20:07,818][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:20:08,074][root][INFO] - Full model selected, loading model
[2025-03-06 16:20:26,131][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:21:34,098][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:21:34,099][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:22:00,282][root][INFO] - Peft model loaded successfully
[2025-03-06 16:22:06,619][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:22:06,621][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:22:06,621][root][INFO] - Starting inference
[2025-03-06 16:22:06,837][root][INFO] - Processing question number 0
[2025-03-06 16:22:06,839][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 16:22:15,870][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 16:22:23,868][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 16:22:29,528][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 16:22:56,470][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 16:23:22,832][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 16:23:29,502][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 16:23:37,036][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 16:23:48,184][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 16:24:14,429][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 16:24:41,370][root][INFO] - Processing question number 10
[2025-03-06 16:24:41,372][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:25:09,621][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:25:35,686][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:25:42,043][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:26:02,711][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:26:29,829][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:26:55,935][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:27:06,918][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:27:13,181][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:27:19,143][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:27:27,271][root][INFO] - Processing question number 20
[2025-03-06 16:27:27,273][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:27:53,789][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:28:20,467][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:28:46,590][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:28:53,945][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 16:29:02,042][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:29:16,574][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:29:29,124][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:29:36,681][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:29:46,802][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:30:12,741][root][INFO] - Processing question number 30
[2025-03-06 16:30:12,743][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:30:23,153][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:30:34,100][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:31:00,763][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:31:19,149][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:31:23,859][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:31:50,949][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:32:17,637][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:32:44,557][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:32:51,797][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:32:57,432][root][INFO] - Processing question number 40
[2025-03-06 16:32:57,435][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:33:24,118][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:33:50,789][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 16:34:12,145][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 16:34:39,217][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 16:34:47,739][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:34:51,379][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 16:35:19,315][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:35:30,633][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 16:35:36,056][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 16:36:03,249][root][INFO] - Processing question number 50
[2025-03-06 16:36:03,252][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:36:30,685][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:36:42,567][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:36:48,192][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:37:15,851][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:37:42,579][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:37:46,173][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:38:13,537][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:38:17,767][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:38:44,918][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:39:12,867][root][INFO] - Processing question number 60
[2025-03-06 16:39:12,871][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:39:21,401][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:39:28,723][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:39:35,293][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:39:39,060][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:39:45,897][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:40:12,481][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:40:20,830][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:40:47,799][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:40:57,233][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:41:15,455][root][INFO] - Processing question number 70
[2025-03-06 16:41:15,458][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:41:42,164][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:42:08,653][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:42:16,186][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:42:32,657][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:42:59,559][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:43:25,725][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:43:37,927][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:44:04,706][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:44:31,686][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:44:39,265][root][INFO] - Processing question number 80
[2025-03-06 16:44:39,269][root][INFO] - Domain : Property, Question : 67
[2025-03-06 16:44:48,458][root][INFO] - Domain : Property, Question : 75
[2025-03-06 16:45:02,889][root][INFO] - Domain : Property, Question : 83
[2025-03-06 16:45:25,505][root][INFO] - Domain : Property, Question : 89
[2025-03-06 16:45:38,189][root][INFO] - Domain : Property, Question : 97
[2025-03-06 16:45:49,928][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:45:55,926][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 16:46:02,539][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:46:10,801][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:46:37,562][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:46:49,234][root][INFO] - Processing question number 90
[2025-03-06 16:46:49,238][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:47:16,752][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:47:42,353][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:47:52,596][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:47:58,995][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:48:10,192][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:48:21,984][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:48:48,360][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:49:15,043][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:49:42,178][root][INFO] - Inference complete
[2025-03-06 16:49:42,178][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,183][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,184][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,184][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,185][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,185][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,185][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,185][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,185][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,185][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,185][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,186][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,186][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,186][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,186][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,187][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,187][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,187][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,187][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,188][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,188][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,188][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,188][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,188][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,189][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,189][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,189][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,189][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,189][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,189][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,189][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,189][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,189][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,190][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,190][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,190][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,190][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,190][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,191][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,191][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,191][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,191][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,191][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,191][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,191][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,192][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,192][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,192][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,192][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,192][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,192][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,192][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,192][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,193][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,193][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,193][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,193][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,193][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,194][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,194][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,194][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,194][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,194][root][WARNING] - |Q. 43||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,195][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,195][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,195][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,195][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,195][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,196][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,196][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,196][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,196][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,197][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,197][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,197][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,197][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,197][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,197][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,198][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,198][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,198][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,198][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,199][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,199][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,199][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,199][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,199][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,199][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,200][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,200][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,200][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,200][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,200][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,200][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,200][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,201][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,201][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,201][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,201][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,201][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,202][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,202][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,202][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,202][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,202][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,202][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,202][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,203][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,203][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,203][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,203][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,204][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,204][root][WARNING] - |Q. 41||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,204][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,204][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,204][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,204][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,204][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,204][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,205][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,205][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,205][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,205][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,206][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,206][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,206][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,206][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,206][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,206][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,206][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,206][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,207][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,207][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,207][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,207][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,207][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,208][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,208][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,208][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,208][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,208][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,208][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,208][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,208][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,209][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,209][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,209][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,209][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,209][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,209][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,209][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,210][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,210][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,210][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,210][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,210][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,210][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,211][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,211][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,211][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,211][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,211][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,211][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,212][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,212][root][WARNING] - |Q. 86||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,212][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,212][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,213][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,213][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,213][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,213][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,213][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,213][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,213][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,214][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,214][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,214][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,214][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,214][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,214][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,215][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,215][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,215][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,215][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,215][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,215][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,216][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,216][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,216][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,216][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,216][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,217][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,217][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,217][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,217][root][WARNING] - |Q. 83||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:49:42,217][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,218][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,218][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,218][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,218][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,218][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,218][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,218][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,218][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,219][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,219][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,219][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,219][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,220][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,220][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,220][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,220][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,220][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,220][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,221][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,221][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,221][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,221][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,221][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,222][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,222][root][WARNING] - |Q. 80||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,222][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,222][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,223][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,223][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,223][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,223][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:49:42,223][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:49:42,223][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:49:42,224][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:49:42,224][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,228][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,228][root][INFO] - Saved parsed outputs
[2025-03-06 16:49:42,228][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,230][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,230][root][INFO] - Saved parsing metadata
[2025-03-06 16:49:42,231][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,232][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:49:42,234][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:49:42,286][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 16:49:42,286][root][INFO] - Summary of metrics : {'label_accuracy': 0.12121212121212122, 'misclassification_rate': 0.8787878787878788, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 55, 'malformed_domain': 69, 'total_predictions': 99, 'correct_predictions': 12, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.0707070707070707, 'Contracts_confidence': 0.09090909090909091, 'Criminal_Law_confidence': 0.030303030303030304, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.0707070707070707, 'Civil_Procedure_confidence': 0.04040404040404041, 'correct_domain_wrong_label': 27, 'correct_label_wrong_domain': 9, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 16:49:53,278][root][INFO] - Setting global seed to 989
[2025-03-06 16:49:53,287][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 16:49:53,287][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 16:49:53,288][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 16:49:53,290][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:49:53,295][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:49:53,295][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 16:49:53,479][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:49:53,747][root][INFO] - Full model selected, loading model
[2025-03-06 16:50:12,311][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:50:12,311][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:50:18,809][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:50:18,811][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 16:50:18,811][root][INFO] - Starting inference
[2025-03-06 16:50:19,011][root][INFO] - Processing question number 0
[2025-03-06 16:50:19,013][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 16:50:22,253][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 16:50:48,970][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 16:50:49,329][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 16:51:16,105][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 16:51:21,152][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 16:51:47,556][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 16:52:14,704][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 16:52:16,933][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 16:52:19,011][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 16:52:22,138][root][INFO] - Processing question number 10
[2025-03-06 16:52:22,140][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:52:50,334][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:53:16,380][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:53:42,966][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:53:48,327][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:54:15,447][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:54:41,424][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:54:47,316][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:54:50,116][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:54:52,016][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:55:18,095][root][INFO] - Processing question number 20
[2025-03-06 16:55:18,097][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:55:18,619][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:55:19,037][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:55:45,027][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:55:50,757][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 16:56:17,379][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:56:17,917][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:56:45,035][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:57:11,362][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:57:37,874][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:57:43,012][root][INFO] - Processing question number 30
[2025-03-06 16:57:43,014][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:58:09,693][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:58:11,733][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:58:20,039][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:58:21,899][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:58:27,995][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:58:41,043][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:58:41,496][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:58:44,301][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:59:10,787][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:59:11,253][root][INFO] - Processing question number 40
[2025-03-06 16:59:11,255][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:59:14,301][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:59:40,827][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 17:00:07,803][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 17:00:34,723][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 17:01:00,919][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:01:27,417][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 17:01:55,189][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:02:20,781][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 17:02:47,135][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 17:03:14,139][root][INFO] - Processing question number 50
[2025-03-06 17:03:14,142][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:03:17,377][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 17:03:43,975][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 17:04:09,764][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 17:04:37,268][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 17:05:03,856][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:05:29,472][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 17:05:56,635][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 17:05:57,328][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 17:05:57,790][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 17:06:25,620][root][INFO] - Processing question number 60
[2025-03-06 17:06:25,623][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:06:51,615][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:07:17,917][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 17:07:44,835][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 17:07:51,016][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 17:07:54,299][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 17:07:54,720][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 17:07:57,107][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 17:07:57,647][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:08:24,278][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 17:08:51,399][root][INFO] - Processing question number 70
[2025-03-06 17:08:51,403][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 17:09:17,662][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 17:09:43,972][root][INFO] - Domain : Property, Question : 6
[2025-03-06 17:10:10,140][root][INFO] - Domain : Property, Question : 13
[2025-03-06 17:10:12,377][root][INFO] - Domain : Property, Question : 20
[2025-03-06 17:10:39,113][root][INFO] - Domain : Property, Question : 33
[2025-03-06 17:10:53,176][root][INFO] - Domain : Property, Question : 39
[2025-03-06 17:11:20,041][root][INFO] - Domain : Property, Question : 48
[2025-03-06 17:11:36,394][root][INFO] - Domain : Property, Question : 54
[2025-03-06 17:11:41,359][root][INFO] - Domain : Property, Question : 61
[2025-03-06 17:11:43,708][root][INFO] - Processing question number 80
[2025-03-06 17:11:43,711][root][INFO] - Domain : Property, Question : 67
[2025-03-06 17:11:50,118][root][INFO] - Domain : Property, Question : 75
[2025-03-06 17:12:16,815][root][INFO] - Domain : Property, Question : 83
[2025-03-06 17:12:43,006][root][INFO] - Domain : Property, Question : 89
[2025-03-06 17:13:09,212][root][INFO] - Domain : Property, Question : 97
[2025-03-06 17:13:36,214][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:14:02,990][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 17:14:29,887][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:14:39,298][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 17:15:05,958][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 17:15:32,032][root][INFO] - Processing question number 90
[2025-03-06 17:15:32,036][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 17:15:32,579][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 17:15:34,308][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 17:15:37,416][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 17:16:03,463][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:16:30,347][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 17:16:56,318][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 17:17:22,540][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 17:17:26,495][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 17:17:28,725][root][INFO] - Inference complete
[2025-03-06 17:17:28,725][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,730][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,731][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,732][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,732][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,732][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,733][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,733][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,733][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,733][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,734][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,734][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,734][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,734][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,735][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,735][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,735][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,735][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,736][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,736][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,736][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,737][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,737][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,737][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,737][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,737][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,737][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,737][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,738][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,738][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,738][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,739][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,739][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,739][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,739][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,740][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,740][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,740][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,740][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,740][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,741][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,741][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,742][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,742][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,743][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,747][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,747][root][WARNING] - |Q. 78||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,747][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,748][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,748][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:17:28,748][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,749][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,749][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,749][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,749][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,750][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,750][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,750][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,750][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,751][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,751][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,752][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,752][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,752][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:17:28,752][root][WARNING] - |Q. 57||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:17:28,752][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:17:28,752][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:17:28,754][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,758][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,758][root][INFO] - Saved parsed outputs
[2025-03-06 17:17:28,758][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,759][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,759][root][INFO] - Saved parsing metadata
[2025-03-06 17:17:28,760][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,762][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 17:17:28,763][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 17:17:28,789][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 17:17:28,789][root][INFO] - Summary of metrics : {'label_accuracy': 0.24242424242424243, 'misclassification_rate': 0.7575757575757576, 'combined_accuracy': 0.0, 'malformed_label': 42, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 24, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 24, 'both_wrong': 75}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 17:17:35,935][root][INFO] - Setting global seed to 206
[2025-03-06 17:17:35,942][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:17:35,942][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 17:17:35,943][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:17:35,945][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:17:35,948][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:17:35,948][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:17:36,106][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:17:36,362][root][INFO] - Full model selected, loading model
[2025-03-06 17:17:53,903][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:18:54,826][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:18:54,826][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:19:21,459][root][INFO] - Peft model loaded successfully
[2025-03-06 17:19:27,711][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:19:27,713][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:19:27,713][root][INFO] - Starting inference
[2025-03-06 17:19:27,911][root][INFO] - Processing question number 0
[2025-03-06 17:19:27,913][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:19:54,541][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:20:00,558][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:20:27,834][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:20:54,608][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:21:01,443][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:21:07,278][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:21:13,225][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:21:39,655][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:21:46,788][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:22:13,137][root][INFO] - Processing question number 10
[2025-03-06 17:22:13,139][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:22:38,661][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:22:49,398][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:23:15,697][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:23:41,477][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:24:08,172][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:24:34,521][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:24:42,136][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:25:08,245][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:25:34,901][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:26:01,640][root][INFO] - Processing question number 20
[2025-03-06 17:26:01,643][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:26:09,114][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:26:35,551][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:27:01,509][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:27:07,459][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:27:33,724][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:28:00,490][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:28:26,800][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:28:53,255][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:29:19,563][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:29:27,246][root][INFO] - Processing question number 30
[2025-03-06 17:29:27,249][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:29:34,501][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:30:00,664][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:30:14,512][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:30:41,339][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:31:07,622][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:31:26,301][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:31:52,616][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:32:19,533][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:32:34,517][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:33:01,001][root][INFO] - Processing question number 40
[2025-03-06 17:33:01,004][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:33:06,563][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:33:32,839][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:33:47,741][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:34:13,359][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:34:36,346][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:34:42,529][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:34:49,773][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:35:16,416][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:35:42,887][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:36:09,808][root][INFO] - Processing question number 50
[2025-03-06 17:36:09,812][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:36:36,825][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:37:02,917][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:37:29,897][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:37:56,483][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:38:22,416][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:38:48,653][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:39:15,771][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:39:22,089][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:39:48,920][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:40:15,539][root][INFO] - Processing question number 60
[2025-03-06 17:40:15,543][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:40:24,031][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:40:32,964][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:41:00,145][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:41:06,131][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:41:32,706][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:41:39,486][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:42:05,386][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:42:08,931][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:42:35,015][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:43:00,995][root][INFO] - Processing question number 70
[2025-03-06 17:43:00,999][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:43:06,753][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:43:14,171][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:43:19,231][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:43:46,430][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:44:05,881][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:44:32,518][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:45:00,162][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:45:26,836][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:45:52,481][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:46:18,543][root][INFO] - Processing question number 80
[2025-03-06 17:46:18,547][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:46:45,467][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:46:53,227][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:47:01,740][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:47:07,081][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:47:34,684][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:48:00,960][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:48:11,331][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:48:20,721][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:48:47,180][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:49:13,673][root][INFO] - Processing question number 90
[2025-03-06 17:49:13,677][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:49:40,171][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:50:07,017][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:50:15,079][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:50:41,518][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:50:48,262][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:51:15,216][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:51:41,904][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:51:48,728][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:52:14,605][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:52:25,123][root][INFO] - Inference complete
[2025-03-06 17:52:25,123][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,130][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,131][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,131][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,132][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,132][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,132][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,133][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,133][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,133][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,133][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,133][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,133][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,134][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,134][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,134][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,134][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,134][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,135][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,135][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,135][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,135][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,135][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,136][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,136][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,136][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,136][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,136][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,136][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,137][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,137][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,137][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,137][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,137][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,138][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,138][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,138][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,138][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,138][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,139][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,139][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,139][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,139][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,139][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,140][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,140][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,140][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,140][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,140][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,140][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,141][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,141][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,141][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,141][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,141][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,142][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,142][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,142][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,142][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,142][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,142][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,142][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,142][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,143][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,143][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,143][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,143][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,143][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,143][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,143][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,144][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,144][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,144][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,144][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,144][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,145][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,145][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,145][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,145][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,146][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,146][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,146][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,146][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,146][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,146][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,146][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,147][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,147][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,147][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,147][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,147][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,148][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,148][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,148][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,148][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,148][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,148][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,148][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,149][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,149][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,149][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,149][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,149][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,150][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,150][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,150][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,150][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,150][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,150][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,150][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,151][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,151][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,151][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,151][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,151][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,152][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,152][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,152][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,152][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,152][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,152][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,152][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,153][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,153][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,153][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,153][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,153][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,153][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,154][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,154][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,154][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,154][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,154][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,154][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,155][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,155][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,156][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,156][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,156][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,156][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,156][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,156][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,157][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,157][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,157][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,157][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,157][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,157][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,158][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,158][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,158][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,158][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,158][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,158][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,159][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,159][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,159][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,159][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,159][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,160][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,160][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,160][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,160][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,160][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,160][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,161][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,161][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,161][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,161][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,161][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,162][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,162][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,162][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,162][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,162][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,163][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,163][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,163][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,163][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,163][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,163][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,163][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,164][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,164][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,164][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,164][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,165][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,165][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,165][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,165][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,165][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,166][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,166][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,166][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,166][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,166][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,167][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,167][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,167][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,167][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,167][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,167][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,168][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,168][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,168][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,168][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,169][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,169][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,169][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,169][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,169][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,170][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,170][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,170][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,170][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,170][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,170][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,170][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,171][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,171][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,171][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,171][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,171][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,172][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,172][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,172][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,172][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,172][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,172][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,172][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,173][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,173][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,173][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,173][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,173][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,174][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,174][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,174][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,174][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,174][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,174][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,174][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,175][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,175][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,175][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,175][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,176][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,176][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,176][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,176][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,176][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,177][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,177][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,177][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,177][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,177][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,177][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,177][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,178][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,178][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,178][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,178][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,179][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,179][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,179][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,179][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,179][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,180][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,180][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,180][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,180][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:52:25,180][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:52:25,180][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:52:25,181][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 17:52:25,181][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,186][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,186][root][INFO] - Saved parsed outputs
[2025-03-06 17:52:25,186][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,188][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,188][root][INFO] - Saved parsing metadata
[2025-03-06 17:52:25,189][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,190][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:52:25,191][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:52:25,243][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 17:52:25,243][root][INFO] - Summary of metrics : {'label_accuracy': 0.09, 'misclassification_rate': 0.91, 'combined_accuracy': 0.02, 'malformed_label': 66, 'malformed_domain': 86, 'total_predictions': 100, 'correct_predictions': 9, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.04, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.01, 'Torts_confidence': 0.03, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 12, 'correct_label_wrong_domain': 7, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 17:52:40,952][root][INFO] - Setting global seed to 206
[2025-03-06 17:52:40,980][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:52:40,980][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 17:52:40,982][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:52:40,983][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:52:40,986][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:52:40,986][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:52:41,205][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:52:41,468][root][INFO] - Full model selected, loading model
[2025-03-06 17:53:00,248][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:53:00,249][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:53:06,739][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:53:06,741][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 17:53:06,741][root][INFO] - Starting inference
[2025-03-06 17:53:06,905][root][INFO] - Processing question number 0
[2025-03-06 17:53:06,907][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:53:33,788][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:54:00,807][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:54:28,031][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:54:54,739][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:55:20,818][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:55:46,376][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:56:12,423][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:56:38,807][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:57:04,475][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:57:30,773][root][INFO] - Processing question number 10
[2025-03-06 17:57:30,775][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:57:56,249][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:58:22,282][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:58:48,616][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:59:15,639][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:59:42,231][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:00:08,512][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:00:34,688][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:01:00,721][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:01:27,278][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:01:53,977][root][INFO] - Processing question number 20
[2025-03-06 18:01:53,980][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:02:19,509][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:02:45,895][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:03:11,785][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:03:37,824][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:04:03,974][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:04:30,635][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:04:56,840][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:05:23,264][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:05:49,489][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:06:16,306][root][INFO] - Processing question number 30
[2025-03-06 18:06:16,308][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:06:42,596][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:07:08,665][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:07:34,693][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:08:01,479][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:08:27,668][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:08:53,978][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:09:20,197][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:09:47,084][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:10:13,499][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:10:39,949][root][INFO] - Processing question number 40
[2025-03-06 18:10:39,952][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:11:06,368][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:11:32,544][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:11:59,193][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:12:24,756][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:12:51,651][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:13:18,057][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:13:44,258][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:14:10,672][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:14:36,995][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:15:03,617][root][INFO] - Processing question number 50
[2025-03-06 18:15:03,621][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:15:30,502][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:15:56,340][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:16:23,235][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:16:49,737][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:17:15,615][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:17:41,836][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:18:09,047][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:18:36,040][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:19:02,966][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:19:29,703][root][INFO] - Processing question number 60
[2025-03-06 18:19:29,707][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:19:56,190][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:20:22,828][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:20:49,899][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:21:16,508][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:21:43,030][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:22:09,064][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:22:34,947][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:23:00,644][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:23:26,641][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:23:52,576][root][INFO] - Processing question number 70
[2025-03-06 18:23:52,580][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:24:19,111][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:24:45,560][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:25:12,176][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:25:39,257][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:26:05,186][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:26:31,756][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:26:59,286][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:27:25,866][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:27:51,449][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:28:17,438][root][INFO] - Processing question number 80
[2025-03-06 18:28:17,442][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:28:44,332][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:29:11,274][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:29:38,138][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:30:04,685][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:30:32,153][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:30:58,297][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:31:25,042][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:31:52,313][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:32:18,755][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:32:45,204][root][INFO] - Processing question number 90
[2025-03-06 18:32:45,208][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:33:11,663][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:33:38,461][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:34:05,036][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:34:31,418][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:34:58,424][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:35:25,313][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:35:51,904][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:36:18,081][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:36:43,809][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:37:10,741][root][INFO] - Inference complete
[2025-03-06 18:37:10,741][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,748][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,749][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,749][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,750][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,750][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,750][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,750][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,751][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,751][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,751][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,751][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,751][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,751][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,752][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,752][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,753][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,753][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,753][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,753][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,753][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,753][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,754][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,754][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,754][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,754][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,755][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,755][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,755][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,755][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,756][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,757][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,757][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,757][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,757][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,758][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,758][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,758][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,758][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,758][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,758][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,758][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,759][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,760][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,760][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,760][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,760][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,760][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,761][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,761][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,762][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,762][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,762][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,762][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,763][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,763][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,764][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,764][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,766][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,766][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,766][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,766][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,766][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,767][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,767][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,767][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,770][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,770][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,770][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,770][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,771][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,772][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,772][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,772][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,772][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,772][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,772][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,773][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,773][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,774][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,774][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,774][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,774][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,774][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,775][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,775][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,775][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,775][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,775][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,775][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,776][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,776][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,777][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,777][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,777][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,777][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,777][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,777][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,780][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,780][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,780][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,780][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,780][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,781][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,781][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,781][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,781][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,782][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,782][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,782][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,782][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:37:10,782][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:37:10,783][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:37:10,783][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 18:37:10,784][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,789][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,789][root][INFO] - Saved parsed outputs
[2025-03-06 18:37:10,789][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,791][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,791][root][INFO] - Saved parsing metadata
[2025-03-06 18:37:10,792][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,794][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:37:10,795][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:37:10,827][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 18:37:10,827][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 50, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 18:37:32,237][root][INFO] - Setting global seed to 206
[2025-03-06 18:37:32,393][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:37:32,393][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 18:37:32,395][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:37:32,416][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:37:32,418][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:37:32,418][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:37:32,680][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:37:33,079][root][INFO] - Full model selected, loading model
[2025-03-06 18:37:52,093][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:38:53,997][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:38:53,998][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:39:19,912][root][INFO] - Peft model loaded successfully
[2025-03-06 18:39:26,139][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:39:26,141][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 18:39:26,141][root][INFO] - Starting inference
[2025-03-06 18:39:26,333][root][INFO] - Processing question number 0
[2025-03-06 18:39:26,336][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:39:53,203][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:39:59,128][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:40:26,602][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:40:53,560][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:41:11,058][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:41:36,862][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:42:03,239][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:42:10,507][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:42:36,827][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:43:03,362][root][INFO] - Processing question number 10
[2025-03-06 18:43:03,363][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:43:29,078][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:43:39,165][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:44:05,639][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:44:10,379][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:44:37,252][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:45:03,784][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:45:12,260][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:45:38,575][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:46:05,422][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:46:32,373][root][INFO] - Processing question number 20
[2025-03-06 18:46:32,376][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:46:58,137][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:47:24,779][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:47:35,250][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:48:01,576][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:48:28,017][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:48:48,185][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:49:14,677][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:49:20,151][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:49:46,654][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:49:59,470][root][INFO] - Processing question number 30
[2025-03-06 18:49:59,473][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:50:06,782][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:50:11,913][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:50:38,228][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:50:45,617][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:51:12,083][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:51:38,630][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:52:05,119][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:52:32,200][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:52:58,825][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:53:25,496][root][INFO] - Processing question number 40
[2025-03-06 18:53:25,499][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:53:52,109][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:54:11,272][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:54:38,187][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:55:03,988][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:55:18,973][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:55:25,746][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:55:30,154][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:55:56,792][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:56:23,343][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:56:50,223][root][INFO] - Processing question number 50
[2025-03-06 18:56:50,227][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:56:55,318][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:57:04,899][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:57:32,013][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:57:44,121][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:57:50,707][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:57:54,814][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:58:00,691][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:58:27,693][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:58:54,708][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:59:21,499][root][INFO] - Processing question number 60
[2025-03-06 18:59:21,503][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:59:30,318][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:59:56,979][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:00:10,288][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:00:19,745][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:00:46,494][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:01:12,905][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:01:25,544][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:01:32,210][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:01:39,870][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:01:45,181][root][INFO] - Processing question number 70
[2025-03-06 19:01:45,185][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:02:11,934][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:02:16,397][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:02:21,446][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:02:49,033][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:03:15,377][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:03:42,520][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:04:10,441][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:04:37,291][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:05:03,099][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:05:11,458][root][INFO] - Processing question number 80
[2025-03-06 19:05:11,463][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:05:38,560][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:05:45,289][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:06:12,347][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:06:18,176][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:06:45,968][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:07:12,464][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:07:39,405][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:07:47,795][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:08:14,436][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:08:41,101][root][INFO] - Processing question number 90
[2025-03-06 19:08:41,106][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:08:47,630][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:09:08,854][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:09:35,696][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:10:02,285][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:10:07,165][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:10:34,280][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:10:44,273][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:11:10,708][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:11:21,069][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:11:48,206][root][INFO] - Inference complete
[2025-03-06 19:11:48,206][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,212][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,213][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,214][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,214][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,214][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,215][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,215][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,215][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,215][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,215][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,216][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,216][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,216][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,216][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,216][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,216][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,216][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,217][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,217][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,217][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,217][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,217][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,218][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,218][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,218][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,218][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,219][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,219][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,219][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,219][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,219][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,220][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,220][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,220][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,220][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,220][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,221][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,221][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,221][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,221][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,222][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,222][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,222][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,222][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,222][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,223][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,223][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,223][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,223][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,223][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,224][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,224][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,224][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,224][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,225][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,225][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,225][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,225][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,225][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,225][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,225][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,225][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,226][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,226][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,226][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,226][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,226][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,226][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,226][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,227][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,227][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,227][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,227][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,227][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,228][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,228][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,228][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,228][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,228][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,228][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,228][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,229][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,229][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,229][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,229][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,229][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,230][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,230][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,230][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,230][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,230][root][WARNING] - |Q. 7||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:11:48,230][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,231][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,231][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,231][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,231][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,231][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,232][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,232][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,232][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,232][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,232][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,233][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,233][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,233][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,233][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,233][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,233][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,234][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,234][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,234][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,234][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,234][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,235][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,235][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,235][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,235][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,235][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,235][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,235][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,236][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,236][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,236][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,236][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,236][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,236][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,237][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,237][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,237][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,237][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,237][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,237][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,238][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,238][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,238][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,238][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,238][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,238][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,239][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,239][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,239][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,239][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,239][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,240][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,240][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,240][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,240][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,240][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,240][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,241][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,241][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,241][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,241][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,242][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,242][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,242][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,242][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,243][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,243][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,243][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,243][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,243][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,243][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,243][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,244][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,244][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,244][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,244][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,244][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,245][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,245][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,245][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,245][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,246][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,246][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,246][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,246][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,246][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,247][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,247][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,247][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,248][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,248][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,248][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,248][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,248][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,249][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,249][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,249][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,249][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,249][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,249][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,250][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,250][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,250][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,250][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,250][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,251][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,251][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,251][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,251][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,251][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,251][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,251][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,252][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,252][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,252][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,252][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,252][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,253][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,253][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,253][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,253][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,253][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:11:48,253][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,254][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,254][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,254][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,254][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,254][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,254][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,255][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,255][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,255][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,255][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,255][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,255][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,256][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,256][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,256][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,256][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,256][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,257][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,257][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,257][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,257][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,257][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,257][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,258][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,258][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,258][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,258][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,258][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,258][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,259][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,259][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,259][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,259][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,259][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,260][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,260][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,260][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,260][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,260][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,260][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,261][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,261][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,261][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,261][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,262][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:11:48,262][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:11:48,262][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:11:48,262][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:11:48,263][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,267][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,267][root][INFO] - Saved parsed outputs
[2025-03-06 19:11:48,267][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,268][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,268][root][INFO] - Saved parsing metadata
[2025-03-06 19:11:48,269][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,271][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:11:48,272][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:11:48,308][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 19:11:48,308][root][INFO] - Summary of metrics : {'label_accuracy': 0.08, 'misclassification_rate': 0.92, 'combined_accuracy': 0.04, 'malformed_label': 64, 'malformed_domain': 66, 'total_predictions': 100, 'correct_predictions': 8, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.06, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.05, 'Civil_Procedure_confidence': 0.02, 'correct_domain_wrong_label': 30, 'correct_label_wrong_domain': 4, 'both_wrong': 62}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 19:11:58,436][root][INFO] - Setting global seed to 206
[2025-03-06 19:11:58,450][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 19:11:58,451][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 19:11:58,452][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:11:58,453][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:11:58,457][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:11:58,457][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:11:58,629][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:11:58,895][root][INFO] - Full model selected, loading model
[2025-03-06 19:12:17,396][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 19:12:17,396][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 19:12:24,050][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:12:24,051][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:12:24,051][root][INFO] - Starting inference
[2025-03-06 19:12:24,234][root][INFO] - Processing question number 0
[2025-03-06 19:12:24,236][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:12:51,132][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:13:18,274][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:13:45,630][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:14:12,475][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:14:38,695][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:15:04,408][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:15:10,176][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:15:36,700][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:16:02,492][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:16:28,922][root][INFO] - Processing question number 10
[2025-03-06 19:16:28,942][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:16:54,592][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:17:20,778][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:17:47,096][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:18:12,904][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:18:23,319][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:18:49,743][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:19:16,057][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:19:42,224][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:20:08,916][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:20:12,067][root][INFO] - Processing question number 20
[2025-03-06 19:20:12,069][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:20:37,742][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:21:04,260][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:21:30,295][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:21:56,476][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:22:22,736][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:22:49,516][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:23:15,864][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:23:42,404][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:24:08,732][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:24:35,668][root][INFO] - Processing question number 30
[2025-03-06 19:24:35,671][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:25:02,113][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:25:28,333][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:25:54,499][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:26:21,398][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:26:47,704][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:27:14,122][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:27:40,460][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:28:07,459][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:28:34,005][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:29:00,558][root][INFO] - Processing question number 40
[2025-03-06 19:29:00,562][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:29:27,089][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:29:53,398][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:30:20,160][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:30:45,876][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:31:12,896][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:31:39,407][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:32:05,706][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:32:32,238][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:32:58,688][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:33:25,422][root][INFO] - Processing question number 50
[2025-03-06 19:33:25,425][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:33:52,456][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:34:18,421][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:34:45,434][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:35:12,064][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:35:18,870][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:35:45,149][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:36:12,267][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:36:39,174][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:37:06,076][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:37:32,749][root][INFO] - Processing question number 60
[2025-03-06 19:37:32,752][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:37:59,238][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:38:25,784][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:38:27,792][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:38:34,291][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:39:00,941][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:39:27,102][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:39:53,114][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:40:02,578][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:40:28,725][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:40:54,806][root][INFO] - Processing question number 70
[2025-03-06 19:40:54,810][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:40:56,776][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:41:23,336][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:41:50,073][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:42:17,277][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:42:43,328][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:43:10,019][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:43:37,654][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:44:04,350][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:44:30,077][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:44:56,207][root][INFO] - Processing question number 80
[2025-03-06 19:44:56,212][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:45:23,216][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:45:50,259][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:46:17,233][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:46:43,929][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:47:11,524][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:47:37,813][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:48:04,683][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:48:32,098][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:48:58,667][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:49:25,257][root][INFO] - Processing question number 90
[2025-03-06 19:49:25,261][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:49:51,854][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:50:18,812][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:50:45,532][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:51:12,057][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:51:39,187][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:52:06,188][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:52:32,916][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:52:59,223][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:53:25,072][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:53:52,103][root][INFO] - Inference complete
[2025-03-06 19:53:52,103][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,111][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,112][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,112][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,113][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,113][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,113][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,114][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,114][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,114][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,114][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,115][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,115][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,115][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,115][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,116][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,116][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,116][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,116][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,116][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,117][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,117][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,119][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,119][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,119][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,120][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,120][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,121][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,121][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,121][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,121][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,122][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,122][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,122][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,123][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,123][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,123][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,123][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,123][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,124][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,124][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,124][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,124][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,124][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,124][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,124][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,126][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,126][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,126][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,127][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,127][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,127][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,127][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,127][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,130][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,130][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,130][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,130][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,130][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,131][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,131][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,131][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,131][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,131][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,131][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,131][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,136][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,136][root][WARNING] - |Q. 68||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,136][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,136][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,138][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,138][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,138][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,139][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,140][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,140][root][WARNING] - |Q. 46||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:53:52,140][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,141][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,141][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,141][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,141][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,142][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,142][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,142][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,142][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,145][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,145][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,145][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,145][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,146][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:53:52,147][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:53:52,147][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:53:52,147][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 19:53:52,149][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,153][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,153][root][INFO] - Saved parsed outputs
[2025-03-06 19:53:52,153][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,154][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,154][root][INFO] - Saved parsing metadata
[2025-03-06 19:53:52,155][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,157][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:53:52,158][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:53:52,175][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 19:53:52,175][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.0, 'malformed_label': 50, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 16, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 19:53:58,600][root][INFO] - Setting global seed to 206
[2025-03-06 19:53:58,605][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 19:53:58,606][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 19:53:58,607][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:53:58,609][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:53:58,611][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:53:58,611][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:53:58,787][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:53:59,052][root][INFO] - Full model selected, loading model
[2025-03-06 19:54:10,800][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:55:11,018][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:55:11,019][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:55:37,116][root][INFO] - Peft model loaded successfully
[2025-03-06 19:55:43,407][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:55:43,408][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 19:55:43,408][root][INFO] - Starting inference
[2025-03-06 19:55:43,621][root][INFO] - Processing question number 0
[2025-03-06 19:55:43,623][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:55:49,794][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:55:58,132][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:56:00,698][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:56:27,648][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:56:39,846][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:56:45,111][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:56:56,660][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:57:10,448][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:57:36,346][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:58:02,870][root][INFO] - Processing question number 10
[2025-03-06 19:58:02,872][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:58:06,536][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:58:17,084][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:58:23,873][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:58:30,298][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:58:38,799][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:59:05,331][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:59:31,787][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:59:36,441][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:59:44,029][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:59:54,578][root][INFO] - Processing question number 20
[2025-03-06 19:59:54,580][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:00:01,759][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:00:06,632][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:00:15,396][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:00:24,233][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:00:42,785][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:00:55,530][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:01:04,301][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:01:08,134][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:01:34,620][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:01:42,652][root][INFO] - Processing question number 30
[2025-03-06 20:01:42,654][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:01:59,678][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:02:03,593][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:02:29,877][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:02:37,946][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:02:46,880][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:03:13,404][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:03:35,063][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:03:45,858][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:04:12,504][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:04:26,596][root][INFO] - Processing question number 40
[2025-03-06 20:04:26,600][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:04:33,878][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:05:00,373][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:05:27,297][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:05:49,610][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:05:56,374][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:06:03,259][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:06:07,329][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:06:13,881][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:06:40,599][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:06:44,585][root][INFO] - Processing question number 50
[2025-03-06 20:06:44,588][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:07:00,205][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:07:08,004][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:07:35,293][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:08:02,233][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:08:10,422][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:08:15,946][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:08:43,256][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:08:48,709][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:09:15,715][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:09:26,490][root][INFO] - Processing question number 60
[2025-03-06 20:09:26,493][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:09:53,088][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:10:19,737][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:10:36,657][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:11:03,637][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:11:30,554][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:11:36,053][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:11:41,814][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:11:58,766][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:12:07,362][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:12:14,652][root][INFO] - Processing question number 70
[2025-03-06 20:12:14,655][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:12:23,498][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:12:44,308][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:12:50,865][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:13:18,319][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:13:44,552][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:13:55,008][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:14:22,918][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:14:46,178][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:15:12,040][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:15:26,664][root][INFO] - Processing question number 80
[2025-03-06 20:15:26,668][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:15:53,826][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:15:58,807][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:16:09,267][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:16:21,683][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:16:49,526][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:17:02,698][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:17:13,202][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:17:40,749][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:17:48,953][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:18:15,683][root][INFO] - Processing question number 90
[2025-03-06 20:18:15,687][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:18:42,428][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:18:54,640][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:19:02,335][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:19:28,999][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:19:37,827][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:19:47,469][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:19:53,539][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:19:59,448][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:20:25,503][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:20:31,806][root][INFO] - Inference complete
[2025-03-06 20:20:31,807][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,812][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,814][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,814][root][WARNING] - |Q. 13||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,814][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,814][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,815][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,815][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,815][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,816][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,816][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,816][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,816][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,816][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,816][root][WARNING] - |Q. 41||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,816][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,817][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,817][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,817][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,817][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,817][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,818][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,818][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,818][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,819][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,819][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,819][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,819][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,820][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,820][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,820][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,821][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,821][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,821][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,821][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,822][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,822][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,822][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,822][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,822][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,822][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,822][root][WARNING] - |Q. 14||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,822][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,822][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,823][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,823][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,823][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,823][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,824][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,824][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,824][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,824][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,825][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,825][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,825][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,825][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,825][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,826][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,826][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,826][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,826][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,826][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,826][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,826][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,827][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,827][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,827][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,827][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,828][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,828][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,828][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,828][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,828][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,828][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,828][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,829][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,829][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,829][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,829][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,830][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,830][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,830][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,830][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,831][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,831][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,831][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,831][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,831][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,831][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,831][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,832][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,832][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,832][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,832][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,833][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,833][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,833][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,833][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,833][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,834][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,834][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,834][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,834][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,834][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,834][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,834][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,835][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,835][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,835][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,835][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,835][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,835][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,836][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,836][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,836][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,836][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,836][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,836][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,836][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,837][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,837][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,837][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,837][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,837][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,837][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,838][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,838][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,838][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,838][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,838][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,839][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,839][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,839][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,839][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,839][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,840][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,840][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,840][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,840][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,840][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,840][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,841][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,841][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,841][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,841][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,841][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,841][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,841][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,842][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,842][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,842][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,842][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,842][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,843][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,843][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,843][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,843][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,843][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,844][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,844][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,844][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,844][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,844][root][WARNING] - |Q. 18||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,844][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,845][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,845][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,845][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,845][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,845][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,846][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,846][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,846][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,846][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,847][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,847][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,847][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,847][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,847][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,848][root][WARNING] - |Q. 74||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:20:31,848][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,848][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,848][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,848][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,848][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,849][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:20:31,849][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:20:31,849][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:20:31,849][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:20:31,850][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,854][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,854][root][INFO] - Saved parsed outputs
[2025-03-06 20:20:31,854][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,855][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,855][root][INFO] - Saved parsing metadata
[2025-03-06 20:20:31,856][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,858][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:20:31,860][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:20:31,893][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 20:20:31,893][root][INFO] - Summary of metrics : {'label_accuracy': 0.17, 'misclassification_rate': 0.83, 'combined_accuracy': 0.06, 'malformed_label': 43, 'malformed_domain': 72, 'total_predictions': 100, 'correct_predictions': 17, 'correct_label_and_domain': 6, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.08, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 22, 'correct_label_wrong_domain': 11, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 20:20:40,692][root][INFO] - Setting global seed to 206
[2025-03-06 20:20:40,700][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 20:20:40,700][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:20:40,701][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:20:40,703][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:20:40,705][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:20:40,705][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:20:40,865][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:20:41,171][root][INFO] - Full model selected, loading model
[2025-03-06 20:20:59,300][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 20:20:59,301][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 20:21:05,787][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:21:05,789][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:21:05,789][root][INFO] - Starting inference
[2025-03-06 20:21:05,992][root][INFO] - Processing question number 0
[2025-03-06 20:21:05,994][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:21:32,876][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:22:00,036][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:22:00,572][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:22:27,437][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:22:53,661][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:23:19,373][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:23:45,569][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:23:45,984][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:24:11,772][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:24:38,213][root][INFO] - Processing question number 10
[2025-03-06 20:24:38,215][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:25:03,846][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:25:30,037][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:25:38,242][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:26:04,048][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:26:04,460][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:26:05,001][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:26:31,312][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:26:57,500][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:27:02,057][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:27:28,896][root][INFO] - Processing question number 20
[2025-03-06 20:27:28,898][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:27:54,561][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:27:57,227][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:28:23,264][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:28:49,451][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:28:49,847][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:29:16,642][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:29:17,039][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:29:43,704][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:30:10,189][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:30:10,977][root][INFO] - Processing question number 30
[2025-03-06 20:30:10,980][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:30:11,519][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:30:14,327][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:30:40,645][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:31:07,725][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:31:09,926][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:31:36,408][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:32:02,752][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:32:06,254][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:32:32,815][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:32:59,559][root][INFO] - Processing question number 40
[2025-03-06 20:32:59,562][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:33:00,145][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:33:26,703][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:33:53,640][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:34:19,524][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:34:21,578][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:34:48,235][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:35:14,725][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:35:16,296][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:35:42,837][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:35:45,483][root][INFO] - Processing question number 50
[2025-03-06 20:35:45,490][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:35:51,836][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:35:52,242][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:36:19,252][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:36:24,508][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:36:50,525][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:36:53,237][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:37:20,359][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:37:47,267][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:38:14,166][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:38:40,842][root][INFO] - Processing question number 60
[2025-03-06 20:38:40,845][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:39:07,335][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:39:09,424][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:39:36,596][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:39:38,575][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:39:40,585][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:40:06,738][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:40:32,749][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:40:35,220][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:40:37,038][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:40:38,205][root][INFO] - Processing question number 70
[2025-03-06 20:40:38,208][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:40:40,383][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:41:06,943][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:41:33,719][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:42:00,949][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:42:04,509][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:42:31,222][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:42:31,748][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:42:58,469][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:43:24,194][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:43:50,326][root][INFO] - Processing question number 80
[2025-03-06 20:43:50,330][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:43:53,457][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:43:55,457][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:44:22,431][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:44:49,115][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:44:51,253][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:45:17,548][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:45:44,417][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:46:11,829][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:46:38,394][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:46:42,638][root][INFO] - Processing question number 90
[2025-03-06 20:46:42,642][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:47:09,223][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:47:36,150][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:47:38,086][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:48:04,615][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:48:31,741][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:48:44,933][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:48:47,533][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:49:13,849][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:49:39,705][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:50:06,747][root][INFO] - Inference complete
[2025-03-06 20:50:06,747][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,753][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,756][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,756][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,757][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,757][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,757][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,757][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,757][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,757][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,759][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,759][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,760][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,760][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,760][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,761][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,761][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,761][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,761][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,761][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,761][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,761][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,762][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,762][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,762][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,762][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,764][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,765][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,765][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,765][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,765][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,766][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,766][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,766][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,771][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:50:06,772][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:50:06,772][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:50:06,772][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:50:06,774][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,778][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,778][root][INFO] - Saved parsed outputs
[2025-03-06 20:50:06,778][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,780][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,780][root][INFO] - Saved parsing metadata
[2025-03-06 20:50:06,781][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,782][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:50:06,784][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:50:06,801][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 20:50:06,801][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 49, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 20:50:15,132][root][INFO] - Setting global seed to 989
[2025-03-06 20:50:15,140][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 20:50:15,140][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:50:15,141][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:50:15,143][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:50:15,144][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:50:15,145][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:50:15,299][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:50:15,560][root][INFO] - Full model selected, loading model
[2025-03-06 20:50:34,010][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:51:34,709][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:51:34,709][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:52:00,962][root][INFO] - Peft model loaded successfully
[2025-03-06 20:52:07,120][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:52:07,122][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 20:52:07,122][root][INFO] - Starting inference
[2025-03-06 20:52:07,354][root][INFO] - Processing question number 0
[2025-03-06 20:52:07,356][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:52:34,009][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:52:40,026][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:53:07,320][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:53:34,240][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:53:41,123][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:53:47,013][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:53:52,982][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:54:19,549][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:54:26,704][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:54:53,241][root][INFO] - Processing question number 10
[2025-03-06 20:54:53,245][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:55:19,022][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:55:29,836][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:55:56,331][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:56:22,245][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:56:49,144][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:57:15,594][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:57:23,275][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:57:49,552][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:58:16,237][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:58:43,015][root][INFO] - Processing question number 20
[2025-03-06 20:58:43,017][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:58:50,484][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:59:16,928][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:59:42,877][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:59:48,823][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:00:15,070][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:00:41,807][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:01:08,161][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:01:34,679][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:02:01,002][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:02:08,686][root][INFO] - Processing question number 30
[2025-03-06 21:02:08,688][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:02:15,958][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:02:42,251][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:02:56,109][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:03:22,945][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:03:49,248][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:04:07,926][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:04:34,250][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:05:01,274][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:05:16,375][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:05:43,072][root][INFO] - Processing question number 40
[2025-03-06 21:05:43,075][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:05:48,673][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:06:15,160][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:06:30,174][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:06:55,997][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:07:19,012][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:07:25,196][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:07:32,451][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:07:59,088][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:08:25,683][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:08:52,683][root][INFO] - Processing question number 50
[2025-03-06 21:08:52,687][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:09:19,842][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:09:45,945][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:10:13,107][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:10:39,899][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:11:06,016][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:11:32,487][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:11:59,839][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:12:06,200][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:12:33,254][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:13:00,101][root][INFO] - Processing question number 60
[2025-03-06 21:13:00,105][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:13:08,663][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:13:17,677][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:13:45,069][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:13:51,063][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:14:17,834][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:14:24,665][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:14:50,803][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:14:54,371][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:15:20,685][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:15:46,901][root][INFO] - Processing question number 70
[2025-03-06 21:15:46,906][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:15:52,704][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:16:00,179][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:16:05,279][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:16:32,705][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:16:52,346][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:17:19,277][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:17:47,282][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:18:14,211][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:18:40,077][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:19:06,314][root][INFO] - Processing question number 80
[2025-03-06 21:19:06,318][root][INFO] - Domain : Property, Question : 69
[2025-03-06 21:19:33,408][root][INFO] - Domain : Property, Question : 81
[2025-03-06 21:19:41,195][root][INFO] - Domain : Property, Question : 88
[2025-03-06 21:19:49,744][root][INFO] - Domain : Property, Question : 91
[2025-03-06 21:19:55,125][root][INFO] - Domain : Property, Question : 94
[2025-03-06 21:20:22,889][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:20:49,153][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:20:59,515][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:21:08,897][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:21:35,357][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:22:01,853][root][INFO] - Processing question number 90
[2025-03-06 21:22:01,857][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:22:28,351][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:22:55,187][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:23:03,238][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:23:29,655][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:23:36,388][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:24:03,328][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:24:29,999][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:24:36,818][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:25:02,659][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:25:13,184][root][INFO] - Inference complete
[2025-03-06 21:25:13,184][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,190][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,191][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,192][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,192][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,192][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,193][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,193][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,193][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,193][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,193][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,194][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,194][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,194][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,194][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,194][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,194][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,194][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,195][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,195][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,195][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,195][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,196][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,196][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,196][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,196][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,196][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,197][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,197][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,197][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,197][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,197][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,198][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,198][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,198][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,198][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,198][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,198][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,199][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,199][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,199][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,199][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,199][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,200][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,200][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,200][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,200][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,200][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,200][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,201][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,201][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,201][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,201][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,201][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,202][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,202][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,202][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,202][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,202][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,202][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,202][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,202][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,203][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,203][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,203][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,203][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,203][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,203][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,204][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,204][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,204][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,204][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,204][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,204][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,205][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,205][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,205][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,205][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,205][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,206][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,206][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,206][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,206][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,206][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,206][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,206][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,207][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,207][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,207][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,207][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,208][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,208][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,208][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,208][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,208][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,208][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,209][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,209][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,209][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,209][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,209][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,209][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,210][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,210][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,210][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,210][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,210][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,210][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,210][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,211][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,211][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,211][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,211][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,211][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,212][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,212][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,212][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,212][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,212][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,212][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,212][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,213][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,213][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,213][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,213][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,213][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,213][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,214][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,214][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,214][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,214][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,215][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,215][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,215][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,215][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,216][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,216][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,216][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,216][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,216][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,217][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,217][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,217][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,217][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,217][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,217][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,217][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,218][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,218][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,218][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,218][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,218][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,219][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,219][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,219][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,219][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,220][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,220][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,220][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,220][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,220][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,221][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,221][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,221][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,221][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,221][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,222][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,222][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,222][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,222][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,223][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,223][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,223][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,223][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,223][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,223][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,224][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,224][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,224][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,224][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,224][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,225][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,225][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,225][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,225][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,225][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,226][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,226][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,226][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,226][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,227][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,227][root][WARNING] - |Q. 75||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,227][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,227][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,227][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,227][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,228][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,228][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,228][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,228][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,228][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,229][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,229][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,229][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,229][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,229][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,230][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,230][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,230][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,230][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,230][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,231][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,231][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,231][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,231][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,231][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,231][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,231][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,232][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,232][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,232][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,232][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,232][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,233][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,233][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,233][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,233][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,233][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,233][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,233][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,234][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,234][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,234][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,234][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,234][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,235][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,235][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,235][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,235][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,235][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,236][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,236][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,236][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,236][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,236][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,236][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,237][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,237][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,237][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,237][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,237][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,238][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,238][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,238][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,238][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,238][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,238][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,239][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,239][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,239][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,239][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,239][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,240][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,240][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,240][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,240][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,240][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:25:13,241][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:25:13,241][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:25:13,241][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:25:13,242][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,246][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,246][root][INFO] - Saved parsed outputs
[2025-03-06 21:25:13,246][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,248][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,248][root][INFO] - Saved parsing metadata
[2025-03-06 21:25:13,249][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,250][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:13,252][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:25:13,335][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 21:25:13,335][root][INFO] - Summary of metrics : {'label_accuracy': 0.09, 'misclassification_rate': 0.91, 'combined_accuracy': 0.02, 'malformed_label': 66, 'malformed_domain': 86, 'total_predictions': 100, 'correct_predictions': 9, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.04, 'Contracts_confidence': 0.05, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.01, 'Torts_confidence': 0.03, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 12, 'correct_label_wrong_domain': 7, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 21:25:21,446][root][INFO] - Setting global seed to 989
[2025-03-06 21:25:21,454][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 21:25:21,454][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:25:21,455][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:25:21,457][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:25:21,460][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:25:21,460][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:25:21,627][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:25:21,888][root][INFO] - Full model selected, loading model
[2025-03-06 21:25:37,563][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 21:25:37,563][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 21:25:43,976][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:25:43,978][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:25:43,978][root][INFO] - Starting inference
[2025-03-06 21:25:44,178][root][INFO] - Processing question number 0
[2025-03-06 21:25:44,180][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:26:10,558][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:26:37,524][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:27:04,711][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:27:31,378][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:27:57,426][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:28:22,950][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:28:48,962][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:29:15,295][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:29:40,896][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:30:07,145][root][INFO] - Processing question number 10
[2025-03-06 21:30:07,147][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:30:32,593][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:30:58,592][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:31:24,729][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:31:50,341][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:32:16,899][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:32:43,138][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:33:09,265][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:33:35,252][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:34:01,773][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:34:28,429][root][INFO] - Processing question number 20
[2025-03-06 21:34:28,432][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:34:53,927][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:35:20,299][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:35:46,211][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:36:12,211][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:36:38,313][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:37:04,915][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:37:31,076][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:37:57,442][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:38:23,600][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:38:50,354][root][INFO] - Processing question number 30
[2025-03-06 21:38:50,357][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:39:16,622][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:39:42,692][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:40:08,907][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:40:35,858][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:41:02,184][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:41:28,642][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:41:54,977][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:42:21,965][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:42:48,399][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:43:14,782][root][INFO] - Processing question number 40
[2025-03-06 21:43:14,785][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:43:41,152][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:44:07,276][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:44:33,891][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:44:59,411][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:45:26,242][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:45:52,591][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:46:18,743][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:46:45,109][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:47:11,378][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:47:37,938][root][INFO] - Processing question number 50
[2025-03-06 21:47:37,941][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:48:04,807][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:48:30,609][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:48:57,445][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:49:23,917][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:49:49,762][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:50:15,852][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:50:42,798][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:51:09,526][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:51:36,263][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:52:02,768][root][INFO] - Processing question number 60
[2025-03-06 21:52:02,778][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:52:29,096][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:52:55,467][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:53:22,472][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:53:49,029][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:54:15,503][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:54:41,479][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:55:07,310][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:55:32,962][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:55:58,918][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:56:24,818][root][INFO] - Processing question number 70
[2025-03-06 21:56:24,822][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:56:51,297][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:57:17,677][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:57:44,247][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:58:11,266][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:58:37,148][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:59:03,664][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:59:31,137][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:59:57,664][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:00:23,208][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:00:49,144][root][INFO] - Processing question number 80
[2025-03-06 22:00:49,149][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:01:15,991][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:01:42,857][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:02:09,722][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:02:36,529][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:03:04,227][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:03:30,515][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:03:57,445][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:04:24,921][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:04:51,483][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:05:17,880][root][INFO] - Processing question number 90
[2025-03-06 22:05:17,884][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:05:44,291][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:06:11,032][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:06:37,564][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:07:03,897][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:07:30,836][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:07:57,664][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:08:24,205][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:08:50,328][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:09:15,994][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:09:42,853][root][INFO] - Inference complete
[2025-03-06 22:09:42,853][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,859][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,860][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,860][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,861][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,861][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,861][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,861][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,862][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,862][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,862][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,862][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,862][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,862][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,863][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,863][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,864][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,864][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,864][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,864][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,864][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,864][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,865][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,865][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,865][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,865][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,866][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,866][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,866][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,866][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,867][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,868][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,868][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,868][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,868][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,869][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,869][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,869][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,869][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,869][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,869][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,869][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,871][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,871][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,871][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,871][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,871][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,872][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,872][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,872][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,873][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,873][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,873][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,873][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,874][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,875][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,875][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,875][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,877][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,877][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,877][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,877][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,878][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,878][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,878][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,878][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,881][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,881][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,881][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,881][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,882][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,883][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,883][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,883][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,883][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,883][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,883][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,884][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,884][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,885][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,885][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,885][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,885][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,885][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,886][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,886][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,886][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,886][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,886][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,886][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,887][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,887][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,888][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,888][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,888][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,888][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,888][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,888][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,891][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,891][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,891][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,891][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,891][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,892][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,892][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,892][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,892][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,893][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,893][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,893][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,893][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:09:42,894][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:09:42,894][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:09:42,894][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:09:42,895][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,900][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,900][root][INFO] - Saved parsed outputs
[2025-03-06 22:09:42,900][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,903][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,903][root][INFO] - Saved parsing metadata
[2025-03-06 22:09:42,903][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,905][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:42,907][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:09:42,923][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 22:09:42,923][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 50, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 22:09:50,236][root][INFO] - Setting global seed to 989
[2025-03-06 22:09:50,242][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 22:09:50,242][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:09:50,243][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:09:50,245][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:09:50,247][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:09:50,247][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:09:50,510][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 22:09:50,752][root][INFO] - Full model selected, loading model
[2025-03-06 22:10:03,800][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:11:04,450][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:11:04,450][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:11:30,810][root][INFO] - Peft model loaded successfully
[2025-03-06 22:11:37,007][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:11:37,009][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:11:37,009][root][INFO] - Starting inference
[2025-03-06 22:11:37,193][root][INFO] - Processing question number 0
[2025-03-06 22:11:37,196][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:12:04,116][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:12:10,043][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:12:37,526][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:12:58,471][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:13:05,352][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:13:13,887][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:13:19,842][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:13:46,452][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:14:12,350][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:14:38,895][root][INFO] - Processing question number 10
[2025-03-06 22:14:38,897][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:14:51,391][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:15:04,958][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:15:10,614][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:15:36,574][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:16:03,457][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:16:17,481][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:16:25,148][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:16:51,452][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:17:18,305][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:17:45,244][root][INFO] - Processing question number 20
[2025-03-06 22:17:45,246][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:17:49,693][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:18:16,313][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:18:42,453][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:19:08,772][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:19:19,502][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:19:39,792][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:20:06,295][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:20:11,596][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:20:38,097][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:20:50,992][root][INFO] - Processing question number 30
[2025-03-06 22:20:50,995][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:20:58,555][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:21:04,512][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:21:30,825][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:21:57,843][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:22:24,321][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:22:44,625][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:23:11,125][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:23:38,231][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:24:04,885][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:24:31,555][root][INFO] - Processing question number 40
[2025-03-06 22:24:31,558][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:24:39,136][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:24:46,842][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:24:52,282][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:25:18,137][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:25:30,270][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:25:36,535][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:25:41,077][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:26:07,870][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:26:34,571][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:26:40,737][root][INFO] - Processing question number 50
[2025-03-06 22:26:40,740][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:27:08,082][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:27:34,300][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:27:45,115][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:28:12,087][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:28:38,263][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:28:42,992][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:29:10,314][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:29:14,416][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:29:41,510][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:30:08,308][root][INFO] - Processing question number 60
[2025-03-06 22:30:08,312][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:30:17,290][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:30:25,425][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:30:52,797][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:30:58,946][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:31:25,708][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:31:51,991][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:32:18,080][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:32:24,761][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:32:46,914][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:33:13,075][root][INFO] - Processing question number 70
[2025-03-06 22:33:13,079][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:33:21,938][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:33:31,574][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:33:36,664][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:34:04,037][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:34:30,193][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:34:57,032][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:35:24,869][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:35:51,723][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:36:17,541][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:36:43,743][root][INFO] - Processing question number 80
[2025-03-06 22:36:43,747][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:37:10,862][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:37:38,012][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:38:05,089][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:38:18,497][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:38:46,278][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:39:12,710][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:39:39,680][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:39:45,850][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:40:12,519][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:40:39,202][root][INFO] - Processing question number 90
[2025-03-06 22:40:39,207][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:41:05,894][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:41:13,322][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:41:24,500][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:41:51,114][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:42:18,417][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:42:35,608][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:43:02,469][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:43:08,745][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:43:34,752][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:43:41,265][root][INFO] - Inference complete
[2025-03-06 22:43:41,265][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,271][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,272][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,273][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,273][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,273][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,274][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,274][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,274][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,274][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,274][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,275][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,275][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,275][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,275][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,276][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,276][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,276][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,276][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,276][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,276][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,277][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,277][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,277][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,277][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,277][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,278][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,278][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,278][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,278][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,279][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,279][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,279][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,279][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,279][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,280][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,280][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,280][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,280][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,280][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,281][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,281][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,281][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,281][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,281][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,281][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,282][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,282][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,282][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,282][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,282][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,283][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,283][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,283][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,283][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,283][root][WARNING] - |Q. 71||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,283][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,283][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,284][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,284][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,284][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,284][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,284][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,285][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,285][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,285][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,285][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,285][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,286][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,286][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,286][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,286][root][WARNING] - |Q. 14||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,286][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,286][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,287][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,287][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,287][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,287][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,287][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,288][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,288][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,288][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,288][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,288][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,288][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,288][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,289][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,289][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,289][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,289][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,289][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,290][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,290][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,290][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,290][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,290][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,290][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,290][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,291][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,291][root][WARNING] - |Q. 72||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:43:41,291][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,291][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,292][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,292][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,292][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,292][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,293][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,293][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,293][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,293][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,293][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,293][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,293][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,294][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,294][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,294][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,294][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,294][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,295][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,295][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,295][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,295][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,295][root][WARNING] - |Q. 50||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,296][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,296][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,296][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,296][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,296][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,296][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,297][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,297][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,297][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,297][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,298][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,298][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,298][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,298][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,298][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,299][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,299][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,299][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,299][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,299][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,299][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,300][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,300][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,300][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,300][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,300][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,301][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,301][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,301][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,301][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,301][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,302][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,302][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,302][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,302][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,302][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,303][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,303][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,303][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,303][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,303][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,303][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,304][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,304][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,304][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,304][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,305][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,305][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:43:41,305][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,305][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,305][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,306][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,306][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,306][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,306][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,306][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,306][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,307][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,307][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,307][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,307][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,307][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,308][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,308][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,308][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,308][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,308][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,308][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,308][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,309][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,309][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,309][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,309][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,309][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,310][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,310][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,310][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,310][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,310][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,310][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,310][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,311][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,311][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,311][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,311][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,311][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,312][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,312][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,312][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,312][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,312][root][WARNING] - |Q. 91||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:43:41,312][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,312][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,313][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,313][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,313][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,313][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,313][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,313][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,314][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,314][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,314][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,314][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,314][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,315][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,315][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,315][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,315][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,315][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,316][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,316][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,316][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,316][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,316][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,316][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,317][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,317][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,317][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,317][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,317][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,317][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,318][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,318][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,318][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,318][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,318][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,319][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,319][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,319][root][WARNING] - |Q. 74||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,319][root][WARNING] - |Q. 74||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,319][root][INFO] - |Q. 74||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,319][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,320][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:43:41,320][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:43:41,320][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:43:41,320][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:43:41,321][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,326][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,326][root][INFO] - Saved parsed outputs
[2025-03-06 22:43:41,326][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,336][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,336][root][INFO] - Saved parsing metadata
[2025-03-06 22:43:41,337][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,339][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:43:41,341][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:43:41,357][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 22:43:41,358][root][INFO] - Summary of metrics : {'label_accuracy': 0.1, 'misclassification_rate': 0.9, 'combined_accuracy': 0.01, 'malformed_label': 61, 'malformed_domain': 71, 'total_predictions': 100, 'correct_predictions': 10, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.02, 'Torts_confidence': 0.06, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 28, 'correct_label_wrong_domain': 9, 'both_wrong': 62}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 22:43:48,256][root][INFO] - Setting global seed to 989
[2025-03-06 22:43:48,261][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 22:43:48,261][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:43:48,262][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:43:48,266][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:43:48,267][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:43:48,268][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:43:48,421][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 22:43:48,660][root][INFO] - Full model selected, loading model
[2025-03-06 22:44:00,608][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 22:44:00,608][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 22:44:07,060][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:44:07,062][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:44:07,062][root][INFO] - Starting inference
[2025-03-06 22:44:07,230][root][INFO] - Processing question number 0
[2025-03-06 22:44:07,232][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:44:33,908][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:45:01,080][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:45:28,462][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:45:55,332][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:46:21,582][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:46:47,313][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:47:13,531][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:47:40,199][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:48:06,255][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:48:32,899][root][INFO] - Processing question number 10
[2025-03-06 22:48:32,901][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:48:58,677][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:49:25,061][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:49:51,507][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:50:17,514][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:50:44,270][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:51:10,734][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:51:37,224][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:52:03,552][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:52:30,413][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:52:57,425][root][INFO] - Processing question number 20
[2025-03-06 22:52:57,427][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:53:23,193][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:53:49,749][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:54:15,814][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:54:42,029][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:55:08,322][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:55:35,139][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:55:44,641][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:55:48,146][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:56:14,530][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:56:41,560][root][INFO] - Processing question number 30
[2025-03-06 22:56:41,562][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:57:08,040][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:57:34,291][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:58:00,499][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:58:27,445][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:58:53,795][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:59:20,262][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:59:46,633][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:00:13,660][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:00:40,244][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:01:06,840][root][INFO] - Processing question number 40
[2025-03-06 23:01:06,843][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:01:33,528][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:01:59,956][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:02:26,850][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:02:52,692][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:03:19,842][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:03:46,500][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:04:12,935][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:04:39,605][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:05:06,176][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:05:09,086][root][INFO] - Processing question number 50
[2025-03-06 23:05:09,089][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:05:36,214][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:06:02,321][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:06:29,458][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:06:29,950][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:06:56,096][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:07:02,144][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:07:13,406][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:07:40,443][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:07:52,533][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:08:19,347][root][INFO] - Processing question number 60
[2025-03-06 23:08:19,351][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:08:45,967][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:09:12,658][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:09:40,018][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:09:45,702][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:10:12,490][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:10:38,789][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:11:04,943][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:11:30,910][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:11:57,148][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:12:23,296][root][INFO] - Processing question number 70
[2025-03-06 23:12:23,300][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:12:50,018][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:13:16,677][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:13:43,519][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:14:10,829][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:14:37,003][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:15:03,817][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:15:31,558][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:15:58,358][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:16:24,219][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:16:50,452][root][INFO] - Processing question number 80
[2025-03-06 23:16:50,456][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:17:17,568][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:17:22,324][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:17:49,390][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:18:16,194][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:18:43,921][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:19:10,348][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:19:22,412][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:19:49,953][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:20:16,622][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:20:43,335][root][INFO] - Processing question number 90
[2025-03-06 23:20:43,340][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:21:10,047][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:21:37,083][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:22:03,922][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:22:30,562][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:22:57,809][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:23:25,001][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:23:27,946][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:23:54,376][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:24:20,363][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:24:47,529][root][INFO] - Inference complete
[2025-03-06 23:24:47,529][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,535][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,536][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,536][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,537][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,537][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,538][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,538][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,538][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,538][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,539][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,540][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,540][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,540][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,542][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,543][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,543][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,543][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,544][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,544][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,544][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,544][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,545][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,545][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,546][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,546][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,546][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,546][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,546][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,546][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,547][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,547][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,547][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,547][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,551][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,551][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,551][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,551][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,552][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,552][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,552][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,552][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,556][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,556][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,556][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,556][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,558][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,559][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,559][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,559][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,559][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,559][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,559][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,560][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,560][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,560][root][WARNING] - |Q. 46||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:47,560][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,560][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,560][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,561][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,561][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,561][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,562][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,562][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,562][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,562][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,562][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,562][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,562][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,563][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,563][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,563][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,563][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,564][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,564][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,564][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,564][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,567][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,567][root][WARNING] - |Q. 52||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:24:47,567][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,567][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,567][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,567][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,567][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,568][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:24:47,568][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:24:47,568][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:24:47,568][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:24:47,571][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,575][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,575][root][INFO] - Saved parsed outputs
[2025-03-06 23:24:47,575][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,576][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,577][root][INFO] - Saved parsing metadata
[2025-03-06 23:24:47,577][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,579][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:24:47,580][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:24:47,626][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:24:47,627][root][INFO] - Summary of metrics : {'label_accuracy': 0.18, 'misclassification_rate': 0.8200000000000001, 'combined_accuracy': 0.0, 'malformed_label': 49, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 18, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 18, 'both_wrong': 82}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 23:24:54,841][root][INFO] - Setting global seed to 989
[2025-03-06 23:24:54,848][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:24:54,848][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:24:54,849][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:24:54,850][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:24:54,853][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:24:54,853][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:24:55,004][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 23:24:55,255][root][INFO] - Full model selected, loading model
[2025-03-06 23:25:14,423][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:26:14,999][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:26:14,999][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:26:41,302][root][INFO] - Peft model loaded successfully
[2025-03-06 23:26:47,465][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:26:47,466][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:26:47,466][root][INFO] - Starting inference
[2025-03-06 23:26:47,650][root][INFO] - Processing question number 0
[2025-03-06 23:26:47,651][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:26:54,072][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:27:21,403][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:27:48,875][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:28:15,835][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:28:42,198][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:28:46,896][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:29:00,002][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:29:10,832][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:29:21,960][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:29:48,503][root][INFO] - Processing question number 10
[2025-03-06 23:29:48,505][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:30:14,229][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:30:27,157][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:30:53,646][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:31:01,072][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:31:08,206][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:31:24,078][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:31:31,914][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:31:36,861][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:32:03,859][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:32:31,072][root][INFO] - Processing question number 20
[2025-03-06 23:32:31,074][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:32:57,037][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:33:01,463][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:33:27,749][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:33:37,091][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:33:52,682][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:33:58,294][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:34:24,947][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:34:51,698][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:35:02,665][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:35:10,445][root][INFO] - Processing question number 30
[2025-03-06 23:35:10,447][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:35:18,476][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:35:30,159][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:35:33,368][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:36:00,375][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:36:26,843][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:36:53,386][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:37:19,880][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:37:46,993][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:37:57,147][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:38:23,809][root][INFO] - Processing question number 40
[2025-03-06 23:38:23,812][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:38:50,452][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:38:57,781][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:39:05,788][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:39:15,363][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:39:23,991][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:39:34,390][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:39:45,845][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:39:50,399][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:40:17,138][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:40:20,114][root][INFO] - Processing question number 50
[2025-03-06 23:40:20,117][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:40:28,263][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:40:36,597][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:41:03,847][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:41:06,873][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:41:33,164][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:41:38,381][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:41:44,277][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:42:11,292][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:42:23,155][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:42:49,946][root][INFO] - Processing question number 60
[2025-03-06 23:42:49,949][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:42:58,499][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:43:05,697][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:43:16,163][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:43:24,584][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:43:35,955][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:44:02,245][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:44:08,867][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:44:14,639][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:44:20,206][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:44:27,351][root][INFO] - Processing question number 70
[2025-03-06 23:44:27,355][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:44:43,179][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:44:52,949][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:45:19,845][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:45:29,925][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:45:54,530][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:46:21,382][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:46:49,227][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:47:16,082][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:47:41,918][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:47:54,388][root][INFO] - Processing question number 80
[2025-03-06 23:47:54,392][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:48:21,506][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:48:26,996][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:48:39,202][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:48:45,084][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:49:12,881][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:49:30,698][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:49:41,176][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:49:57,493][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:50:05,007][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:50:31,713][root][INFO] - Processing question number 90
[2025-03-06 23:50:31,717][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:50:38,165][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:50:57,527][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:51:24,384][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:51:33,710][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:51:40,318][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:51:47,991][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:51:54,564][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:52:01,638][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:52:27,658][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:52:54,844][root][INFO] - Inference complete
[2025-03-06 23:52:54,844][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,851][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,852][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,852][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,852][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,852][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,853][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,853][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,853][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,853][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,854][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,854][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,854][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,854][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,855][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,855][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,855][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,855][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,856][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,856][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,856][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,856][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,856][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,857][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,857][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,857][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,857][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,857][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,858][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,858][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,858][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,858][root][WARNING] - |Q. 99||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:52:54,858][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,859][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,859][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,859][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,859][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,859][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,860][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,860][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,860][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,860][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,860][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,860][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,861][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,861][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,861][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,861][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,861][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,861][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,862][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,862][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,862][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,862][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,862][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,862][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,863][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,863][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,863][root][WARNING] - |Q. 96||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,863][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,863][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,863][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,864][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,864][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,864][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,864][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,864][root][WARNING] - |Q. 14||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,864][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,864][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,864][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,865][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:52:54,865][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,865][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,865][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,866][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,866][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,866][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,866][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,866][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,866][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,867][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,867][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,867][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,867][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,867][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,868][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,868][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,868][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,868][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,868][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,868][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,868][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,869][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,869][root][WARNING] - |Q. 77||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,869][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,869][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,869][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,870][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,870][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,870][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,870][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,870][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,870][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,870][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,871][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,871][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:52:54,871][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,871][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,871][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,871][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,871][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,872][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,872][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,872][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,872][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,873][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,873][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,873][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,873][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,874][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,874][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,874][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,874][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,874][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,875][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,875][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,875][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,875][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,875][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,875][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,875][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,875][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,876][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,876][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,876][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,876][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,876][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,876][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,876][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,877][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,877][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,877][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,877][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,877][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,878][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,878][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,878][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,878][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,878][root][WARNING] - |Q. 82||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,878][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,879][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,879][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,879][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:52:54,879][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,879][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,880][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,880][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,880][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,880][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,880][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,880][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,880][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,881][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,881][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,881][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,881][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,881][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,882][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,882][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,882][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,882][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,882][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,883][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,883][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,883][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,883][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,883][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,883][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,883][root][WARNING] - |Q. 66||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,884][root][WARNING] - |Q. 66||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,884][root][INFO] - |Q. 66||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,884][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,884][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,885][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,885][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,885][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,885][root][WARNING] - |Q. 18||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,886][root][WARNING] - |Q. 18||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,886][root][INFO] - |Q. 18||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,886][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,886][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,886][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,886][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,886][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,887][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,887][root][WARNING] - |Q. 45||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:52:54,887][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,887][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,887][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,888][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,888][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,888][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,889][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,889][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,889][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,889][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:52:54,889][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:52:54,889][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:52:54,889][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:52:54,890][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,894][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,894][root][INFO] - Saved parsed outputs
[2025-03-06 23:52:54,894][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,896][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,897][root][INFO] - Saved parsing metadata
[2025-03-06 23:52:54,897][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,899][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:52:54,900][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:52:54,917][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:52:54,917][root][INFO] - Summary of metrics : {'label_accuracy': 0.18, 'misclassification_rate': 0.8200000000000001, 'combined_accuracy': 0.1, 'malformed_label': 47, 'malformed_domain': 67, 'total_predictions': 100, 'correct_predictions': 18, 'correct_label_and_domain': 10, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.09, 'Contracts_confidence': 0.15, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.05, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 23, 'correct_label_wrong_domain': 8, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 15 to status running with exit code None
Eval status update completed for job 15
[2025-03-06 23:53:03,561][root][INFO] - Setting global seed to 989
[2025-03-06 23:53:03,593][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 23:53:03,593][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:53:03,594][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:53:03,595][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:53:03,597][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:53:03,597][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:53:03,763][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 23:53:04,053][root][INFO] - Full model selected, loading model
[2025-03-06 23:53:19,920][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 23:53:19,920][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 23:53:26,352][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:53:26,353][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:53:26,354][root][INFO] - Starting inference
[2025-03-06 23:53:26,536][root][INFO] - Processing question number 0
[2025-03-06 23:53:26,540][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:53:31,813][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:53:59,027][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:54:00,755][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:54:27,855][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:54:54,285][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:55:20,118][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:55:26,398][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:55:53,126][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:55:53,430][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:56:19,972][root][INFO] - Processing question number 10
[2025-03-06 23:56:19,974][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:56:25,784][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:56:32,438][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:56:58,879][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:57:24,696][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:57:30,567][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:57:57,005][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:58:23,335][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:58:28,853][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:58:55,575][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:58:56,317][root][INFO] - Processing question number 20
[2025-03-06 23:58:56,319][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:59:22,009][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:59:48,556][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-07 00:00:14,616][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-07 00:00:40,825][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-07 00:01:07,112][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-07 00:01:07,897][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-07 00:01:13,059][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-07 00:01:39,630][root][INFO] - Domain : Contracts, Question : 3
[2025-03-07 00:02:05,990][root][INFO] - Domain : Contracts, Question : 7
[2025-03-07 00:02:10,037][root][INFO] - Processing question number 30
[2025-03-07 00:02:10,039][root][INFO] - Domain : Contracts, Question : 14
[2025-03-07 00:02:10,455][root][INFO] - Domain : Contracts, Question : 24
[2025-03-07 00:02:36,687][root][INFO] - Domain : Contracts, Question : 28
[2025-03-07 00:03:02,879][root][INFO] - Domain : Contracts, Question : 34
[2025-03-07 00:03:05,751][root][INFO] - Domain : Contracts, Question : 42
[2025-03-07 00:03:32,082][root][INFO] - Domain : Contracts, Question : 48
[2025-03-07 00:03:58,531][root][INFO] - Domain : Contracts, Question : 58
[2025-03-07 00:04:24,900][root][INFO] - Domain : Contracts, Question : 65
[2025-03-07 00:04:52,068][root][INFO] - Domain : Contracts, Question : 72
[2025-03-07 00:04:57,141][root][INFO] - Domain : Contracts, Question : 77
[2025-03-07 00:05:23,836][root][INFO] - Processing question number 40
[2025-03-07 00:05:23,839][root][INFO] - Domain : Contracts, Question : 84
[2025-03-07 00:05:50,520][root][INFO] - Domain : Contracts, Question : 87
[2025-03-07 00:05:54,662][root][INFO] - Domain : Contracts, Question : 97
[2025-03-07 00:05:55,074][root][INFO] - Domain : Evidence, Question : 4
[2025-03-07 00:06:20,979][root][INFO] - Domain : Evidence, Question : 10
[2025-03-07 00:06:24,489][root][INFO] - Domain : Evidence, Question : 16
[2025-03-07 00:06:51,032][root][INFO] - Domain : Evidence, Question : 23
[2025-03-07 00:07:17,367][root][INFO] - Domain : Evidence, Question : 31
[2025-03-07 00:07:21,365][root][INFO] - Domain : Evidence, Question : 38
[2025-03-07 00:07:47,831][root][INFO] - Domain : Evidence, Question : 43
[2025-03-07 00:08:14,595][root][INFO] - Processing question number 50
[2025-03-07 00:08:14,599][root][INFO] - Domain : Evidence, Question : 50
[2025-03-07 00:08:41,623][root][INFO] - Domain : Evidence, Question : 51
[2025-03-07 00:08:44,981][root][INFO] - Domain : Evidence, Question : 60
[2025-03-07 00:09:12,012][root][INFO] - Domain : Evidence, Question : 73
[2025-03-07 00:09:38,677][root][INFO] - Domain : Evidence, Question : 80
[2025-03-07 00:10:04,714][root][INFO] - Domain : Evidence, Question : 85
[2025-03-07 00:10:06,573][root][INFO] - Domain : Evidence, Question : 90
[2025-03-07 00:10:33,720][root][INFO] - Domain : Evidence, Question : 98
[2025-03-07 00:11:00,644][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-07 00:11:27,574][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-07 00:11:54,280][root][INFO] - Processing question number 60
[2025-03-07 00:11:54,283][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-07 00:12:20,799][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-07 00:12:21,298][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-07 00:12:23,312][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-07 00:12:28,467][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-07 00:12:32,768][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-07 00:12:33,337][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-07 00:12:40,651][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-07 00:13:06,502][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-07 00:13:32,659][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-07 00:13:39,442][root][INFO] - Processing question number 70
[2025-03-07 00:13:39,446][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-07 00:13:41,416][root][INFO] - Domain : Property, Question : 9
[2025-03-07 00:14:07,989][root][INFO] - Domain : Property, Question : 17
[2025-03-07 00:14:34,762][root][INFO] - Domain : Property, Question : 25
[2025-03-07 00:15:01,982][root][INFO] - Domain : Property, Question : 30
[2025-03-07 00:15:28,066][root][INFO] - Domain : Property, Question : 36
[2025-03-07 00:15:32,628][root][INFO] - Domain : Property, Question : 46
[2025-03-07 00:15:39,931][root][INFO] - Domain : Property, Question : 53
[2025-03-07 00:15:41,867][root][INFO] - Domain : Property, Question : 59
[2025-03-07 00:15:42,724][root][INFO] - Domain : Property, Question : 66
[2025-03-07 00:15:45,192][root][INFO] - Processing question number 80
[2025-03-07 00:15:45,195][root][INFO] - Domain : Property, Question : 69
[2025-03-07 00:16:12,319][root][INFO] - Domain : Property, Question : 81
[2025-03-07 00:16:39,581][root][INFO] - Domain : Property, Question : 88
[2025-03-07 00:17:06,759][root][INFO] - Domain : Property, Question : 91
[2025-03-07 00:17:33,668][root][INFO] - Domain : Property, Question : 94
[2025-03-07 00:17:34,204][root][INFO] - Domain : Property, Question : 100
[2025-03-07 00:18:00,697][root][INFO] - Domain : Torts, Question : 11
[2025-03-07 00:18:27,681][root][INFO] - Domain : Torts, Question : 18
[2025-03-07 00:18:55,302][root][INFO] - Domain : Torts, Question : 22
[2025-03-07 00:18:57,306][root][INFO] - Domain : Torts, Question : 32
[2025-03-07 00:19:00,306][root][INFO] - Processing question number 90
[2025-03-07 00:19:00,310][root][INFO] - Domain : Torts, Question : 39
[2025-03-07 00:19:26,922][root][INFO] - Domain : Torts, Question : 45
[2025-03-07 00:19:53,867][root][INFO] - Domain : Torts, Question : 52
[2025-03-07 00:19:56,718][root][INFO] - Domain : Torts, Question : 57
[2025-03-07 00:20:23,252][root][INFO] - Domain : Torts, Question : 63
[2025-03-07 00:20:50,391][root][INFO] - Domain : Torts, Question : 67
[2025-03-07 00:20:53,729][root][INFO] - Domain : Torts, Question : 74
[2025-03-07 00:21:20,465][root][INFO] - Domain : Torts, Question : 79
[2025-03-07 00:21:21,186][root][INFO] - Domain : Torts, Question : 92
[2025-03-07 00:21:24,299][root][INFO] - Domain : Torts, Question : 95
[2025-03-07 00:21:51,353][root][INFO] - Inference complete
[2025-03-07 00:21:51,353][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,361][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,362][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,362][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,362][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,362][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,363][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,363][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,363][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,363][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,364][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,365][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,365][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,365][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,365][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,366][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,366][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,366][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,366][root][WARNING] - |Q. 55||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,367][root][WARNING] - |Q. 55||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,367][root][INFO] - |Q. 55||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,367][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,372][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,372][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,372][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,373][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,373][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,373][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,373][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,373][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,373][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,373][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,373][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,373][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,375][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,375][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,375][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,375][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,377][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-07 00:21:51,377][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-07 00:21:51,377][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-07 00:21:51,377][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-07 00:21:51,380][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,384][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,384][root][INFO] - Saved parsed outputs
[2025-03-07 00:21:51,384][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,385][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,385][root][INFO] - Saved parsing metadata
[2025-03-07 00:21:51,386][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,387][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-07 00:21:51,388][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-07 00:21:51,416][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-07 00:21:51,416][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 43, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '15', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 15 to status completed with exit code 0
Eval status update completed for job 15
Job 15 completed at Fri Mar  7 00:21:52 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n517
Job ID: 25358390
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 14:04:16
CPU Efficiency: 9.92% of 5-21:51:00 core-walltime
Job Wall-clock time: 14:11:06
Memory Utilized: 28.62 GB
Memory Efficiency: 79.50% of 36.00 GB
