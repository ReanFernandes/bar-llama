Starting job 4 at Thu Feb 20 22:42:47 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=number_list_answer_first_few_shot_unstructured train=number_list_answer_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '4', 'training']
Updating job 4 to status training with exit code None
Status update completed for job 4
[2025-02-20 22:43:02,208][root][INFO] - Global seed set to 314
[2025-02-20 22:43:02,209][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:43:02,209][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:43:02,209][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:43:02,209][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:43:02,210][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 22:43:02,226][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:43:02,266][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:43:02,268][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:43:02,274][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:43:03,009][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:43:27,524][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 22:43:56,267][root][INFO] - Model prepared for kbit training
[2025-02-20 22:43:56,268][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'down_proj', 'k_proj', 'up_proj', 'q_proj', 'gate_proj', 'v_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:43:57,966][root][INFO] - Lora adapter added to model
[2025-02-20 22:43:57,968][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_answer_first_few_shot_unstructured
[2025-02-20 22:43:58,191][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.8252, 'grad_norm': 0.4650691747665405, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.5169, 'grad_norm': 0.3776624798774719, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.3149, 'grad_norm': 0.3733808398246765, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1484, 'grad_norm': 0.38411256670951843, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8802, 'grad_norm': 0.4093160927295685, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 418.8197, 'train_samples_per_second': 0.251, 'train_steps_per_second': 0.036, 'train_loss': 1.3371184666951497, 'epoch': 15.0}
[2025-02-20 22:51:04,520][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_number_list_answer_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '4', 'trained', '0']
Updating job 4 to status trained with exit code 0
Status update completed for job 4
Starting evaluations for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-20 22:51:15,316][root][INFO] - Setting global seed to 206
[2025-02-20 22:51:15,324][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 22:51:15,324][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:51:15,325][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 22:51:15,327][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:51:15,333][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 22:51:15,333][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 22:51:15,489][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 22:51:16,030][root][INFO] - Full model selected, loading model
[2025-02-20 22:51:39,560][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 22:53:21,667][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 22:53:21,668][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 22:53:52,970][root][INFO] - Peft model loaded successfully
[2025-02-20 22:54:00,268][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 22:54:00,269][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 22:54:00,269][root][INFO] - Starting inference
[2025-02-20 22:54:00,473][root][INFO] - Processing question number 0
[2025-02-20 22:54:00,492][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 22:54:11,067][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 22:54:20,228][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 22:54:29,110][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 22:55:00,573][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 22:55:11,790][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 22:55:21,111][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 22:55:52,701][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 22:56:02,703][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 22:56:10,586][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 22:56:18,454][root][INFO] - Processing question number 10
[2025-02-20 22:56:18,456][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 22:56:51,045][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 22:57:06,474][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 22:57:13,652][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 22:57:20,642][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 22:57:34,239][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 22:57:42,773][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 22:58:13,593][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 22:58:19,405][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 22:58:29,251][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 22:58:39,461][root][INFO] - Processing question number 20
[2025-02-20 22:58:39,463][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 22:58:51,176][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 22:59:04,235][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 22:59:20,630][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 22:59:30,353][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 22:59:38,923][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 22:59:46,488][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:00:18,330][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:00:28,177][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:00:59,453][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:01:07,372][root][INFO] - Processing question number 30
[2025-02-20 23:01:07,375][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:01:16,399][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:01:34,827][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:01:46,792][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:01:57,816][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:02:06,305][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:02:15,140][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:02:25,974][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:02:36,887][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:02:54,252][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:03:07,044][root][INFO] - Processing question number 40
[2025-02-20 23:03:07,047][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:03:15,855][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:03:27,108][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:03:39,313][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:03:48,550][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:04:07,364][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:04:36,070][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:04:49,810][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:04:57,197][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:05:05,805][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:05:12,250][root][INFO] - Processing question number 50
[2025-02-20 23:05:12,258][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:05:22,445][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:05:33,216][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:05:44,988][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:06:17,005][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:06:27,786][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:06:40,700][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:06:52,436][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:06:59,819][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:07:31,396][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:08:03,394][root][INFO] - Processing question number 60
[2025-02-20 23:08:03,398][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:08:10,346][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:08:18,641][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:08:30,624][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:08:39,969][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:08:51,649][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:09:22,885][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:09:34,923][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:10:06,282][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:10:37,593][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:11:09,092][root][INFO] - Processing question number 70
[2025-02-20 23:11:09,096][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:11:17,048][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:11:26,668][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:11:34,660][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:11:59,697][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:12:09,557][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:12:20,349][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:12:33,612][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:12:44,166][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:12:58,567][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:13:29,705][root][INFO] - Processing question number 80
[2025-02-20 23:13:29,711][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:13:38,131][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:14:09,621][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:14:19,004][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:14:27,241][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:14:39,240][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:14:50,586][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:15:01,320][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:15:11,840][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:15:25,353][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:15:36,138][root][INFO] - Processing question number 90
[2025-02-20 23:15:36,143][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:16:08,015][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:16:15,962][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:16:47,135][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:16:58,840][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:17:09,680][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:17:19,253][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:17:26,112][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:17:34,207][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:18:05,820][root][INFO] - Inference complete
[2025-02-20 23:18:05,821][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,827][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,843][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,875][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,876][root][INFO] - Saved parsed outputs
[2025-02-20 23:18:05,876][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,886][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,887][root][INFO] - Saved parsing metadata
[2025-02-20 23:18:05,887][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,889][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:05,938][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:18:05,956][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:18:05,956][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 0, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 7, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-20 23:18:14,156][root][INFO] - Setting global seed to 206
[2025-02-20 23:18:14,164][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:18:14,164][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:18:14,165][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:18:14,167][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:18:14,169][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:18:14,169][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:18:14,327][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:18:14,860][root][INFO] - Full model selected, loading model
[2025-02-20 23:18:32,243][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:18:32,243][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:18:39,617][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:18:39,618][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:18:39,618][root][INFO] - Starting inference
[2025-02-20 23:18:39,815][root][INFO] - Processing question number 0
[2025-02-20 23:18:39,875][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:18:46,196][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:18:54,511][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:19:05,102][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:19:15,150][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:19:22,810][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:19:37,297][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:19:48,739][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:19:58,937][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:20:08,541][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:20:16,619][root][INFO] - Processing question number 10
[2025-02-20 23:20:16,621][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:20:49,061][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:20:58,817][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:21:05,566][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:21:16,759][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:21:23,843][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:21:32,285][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:21:41,653][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:21:51,806][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:22:22,885][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:22:31,182][root][INFO] - Processing question number 20
[2025-02-20 23:22:31,185][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:22:39,582][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:22:48,831][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:22:56,747][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:23:06,076][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:23:17,340][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:23:26,875][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:23:34,451][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:23:44,394][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:23:54,309][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:24:03,187][root][INFO] - Processing question number 30
[2025-02-20 23:24:03,190][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:24:17,703][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:24:29,333][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:24:39,691][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:24:49,571][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:24:56,401][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:25:04,692][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:25:13,394][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:25:22,156][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:25:30,754][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:25:38,346][root][INFO] - Processing question number 40
[2025-02-20 23:25:38,350][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:25:49,204][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:25:58,358][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:26:07,645][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:26:16,041][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:26:25,804][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:26:56,896][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:27:04,819][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:27:14,646][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:27:21,886][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:27:29,339][root][INFO] - Processing question number 50
[2025-02-20 23:27:29,343][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:27:37,419][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:27:48,077][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:27:55,536][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:28:05,123][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:28:16,975][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:28:24,602][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:28:34,626][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:28:42,064][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:28:54,608][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:29:04,137][root][INFO] - Processing question number 60
[2025-02-20 23:29:04,141][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:29:13,486][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:29:20,755][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:29:31,371][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:29:38,852][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:29:50,067][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:30:00,384][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:30:12,107][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:30:21,133][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:30:29,487][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:30:37,107][root][INFO] - Processing question number 70
[2025-02-20 23:30:37,111][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:30:45,215][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:30:53,700][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:31:02,286][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:31:14,045][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:31:24,398][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:31:33,166][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:31:41,947][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:31:51,653][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:31:58,836][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:32:07,234][root][INFO] - Processing question number 80
[2025-02-20 23:32:07,238][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:32:14,749][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:32:23,189][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:32:34,609][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:32:43,416][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:32:52,683][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:33:02,339][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:33:13,833][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:33:24,565][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:33:35,874][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:34:06,472][root][INFO] - Processing question number 90
[2025-02-20 23:34:06,477][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:34:17,838][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:34:26,247][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:34:36,022][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:34:41,955][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:34:52,063][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:35:00,635][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:35:08,364][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:35:18,813][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:35:29,340][root][INFO] - Inference complete
[2025-02-20 23:35:29,340][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,346][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,359][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,424][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,424][root][INFO] - Saved parsed outputs
[2025-02-20 23:35:29,424][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,463][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,463][root][INFO] - Saved parsing metadata
[2025-02-20 23:35:29,464][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,466][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:35:29,483][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:35:29,497][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:35:29,497][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.3838383838383838, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 11, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-20 23:35:35,951][root][INFO] - Setting global seed to 206
[2025-02-20 23:35:35,956][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:35:35,956][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:35:35,958][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:35:35,960][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:35:35,962][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:35:35,962][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:35:36,127][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:35:36,675][root][INFO] - Full model selected, loading model
[2025-02-20 23:35:55,832][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:37:37,266][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:37:37,281][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:38:09,001][root][INFO] - Peft model loaded successfully
[2025-02-20 23:38:16,213][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:38:16,215][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:38:16,215][root][INFO] - Starting inference
[2025-02-20 23:38:16,427][root][INFO] - Processing question number 0
[2025-02-20 23:38:16,435][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:38:25,414][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:38:35,958][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:38:45,831][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:38:58,752][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:39:29,958][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:39:48,935][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:39:59,357][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:40:14,433][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:40:27,328][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:40:33,991][root][INFO] - Processing question number 10
[2025-02-20 23:40:33,993][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:40:49,953][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:40:59,038][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:41:07,607][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:41:21,817][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:41:33,008][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:41:44,071][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:42:14,948][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:42:24,818][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:42:56,046][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:43:07,819][root][INFO] - Processing question number 20
[2025-02-20 23:43:07,822][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:43:18,661][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:43:30,083][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:43:37,711][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:43:46,317][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:43:56,697][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:44:08,950][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:44:21,044][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:44:31,201][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:44:44,846][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:44:54,080][root][INFO] - Processing question number 30
[2025-02-20 23:44:54,083][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:45:01,981][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:45:16,030][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:45:26,910][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:45:40,009][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:45:47,823][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:45:54,968][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:46:01,806][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:46:15,715][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:46:28,380][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:46:37,431][root][INFO] - Processing question number 40
[2025-02-20 23:46:37,434][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:46:47,010][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:46:57,881][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:47:08,536][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:47:20,964][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:47:31,236][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:47:42,779][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:47:53,206][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:48:14,551][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:48:24,465][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:48:38,789][root][INFO] - Processing question number 50
[2025-02-20 23:48:38,793][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:48:48,333][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:49:00,727][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:49:31,564][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:50:03,629][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:50:14,118][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:50:20,585][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:50:52,319][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:51:01,975][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:51:09,068][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:51:41,110][root][INFO] - Processing question number 60
[2025-02-20 23:51:41,114][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:51:48,512][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:51:57,510][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:52:11,997][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:52:20,862][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:52:34,320][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:52:47,059][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:52:57,058][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:53:28,460][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:53:37,822][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:53:47,200][root][INFO] - Processing question number 70
[2025-02-20 23:53:47,205][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:53:54,133][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:54:01,205][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:54:13,883][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:54:23,963][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:54:35,845][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:54:44,963][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:54:59,076][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:55:07,310][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:55:17,304][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:55:36,917][root][INFO] - Processing question number 80
[2025-02-20 23:55:36,922][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:55:57,657][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:56:07,686][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:56:15,405][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:56:24,051][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:56:34,765][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:57:06,385][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:57:17,033][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:57:26,682][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:57:40,856][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:57:52,705][root][INFO] - Processing question number 90
[2025-02-20 23:57:52,711][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:58:07,922][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:58:38,418][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:58:52,142][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:59:09,912][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:59:19,677][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:59:31,856][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:59:42,334][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:00:13,656][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:00:22,343][root][INFO] - Inference complete
[2025-02-21 00:00:22,343][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,349][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,364][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,399][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,399][root][INFO] - Saved parsed outputs
[2025-02-21 00:00:22,399][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,409][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,410][root][INFO] - Saved parsing metadata
[2025-02-21 00:00:22,410][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,411][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:22,438][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:00:22,450][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:00:22,450][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.3939393939393939, 'malformed_label': 1, 'malformed_domain': 15, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 7, 'both_wrong': 8}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 00:00:29,028][root][INFO] - Setting global seed to 206
[2025-02-21 00:00:29,033][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:00:29,033][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:00:29,035][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:00:29,036][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:00:29,038][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:00:29,038][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:00:29,203][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:00:29,793][root][INFO] - Full model selected, loading model
[2025-02-21 00:00:52,360][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:00:52,374][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:00:59,989][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:00:59,990][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:00:59,990][root][INFO] - Starting inference
[2025-02-21 00:01:00,220][root][INFO] - Processing question number 0
[2025-02-21 00:01:00,227][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:01:07,592][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:01:18,623][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:01:24,232][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:01:35,305][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:01:43,396][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:01:54,023][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:02:09,231][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:02:17,249][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:02:28,357][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:02:34,919][root][INFO] - Processing question number 10
[2025-02-21 00:02:34,921][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:02:47,218][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:02:59,267][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:03:06,139][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:03:14,425][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:03:21,584][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:03:32,050][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:03:42,664][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:03:50,629][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:03:57,302][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:04:07,029][root][INFO] - Processing question number 20
[2025-02-21 00:04:07,031][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:04:15,124][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:04:25,178][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:04:32,835][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:04:39,946][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:04:49,317][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:04:59,862][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:05:09,391][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:05:18,790][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:05:30,177][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:05:40,736][root][INFO] - Processing question number 30
[2025-02-21 00:05:40,739][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:05:49,317][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:05:57,793][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:06:08,466][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:06:17,907][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:06:26,198][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:06:34,527][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:06:42,382][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:06:52,049][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:07:01,496][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:07:08,762][root][INFO] - Processing question number 40
[2025-02-21 00:07:08,765][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:07:17,426][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:07:26,929][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:07:35,666][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:07:43,949][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:07:53,721][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:08:25,164][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:08:34,301][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:08:43,400][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:08:50,520][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:09:00,020][root][INFO] - Processing question number 50
[2025-02-21 00:09:00,024][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:09:08,997][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:09:20,528][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:09:28,957][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:09:38,289][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:09:47,671][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:09:54,700][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:10:04,224][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:10:13,967][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:10:23,607][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:10:30,996][root][INFO] - Processing question number 60
[2025-02-21 00:10:30,999][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:10:42,640][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:10:50,089][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:11:21,817][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:11:28,793][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:11:43,886][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:11:51,613][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:12:01,207][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:12:10,821][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:12:21,179][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:12:29,684][root][INFO] - Processing question number 70
[2025-02-21 00:12:29,689][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:12:38,181][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:12:45,874][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:12:53,665][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:13:06,467][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:13:17,895][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:13:26,506][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:13:35,393][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:13:44,810][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:13:53,688][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:14:04,892][root][INFO] - Processing question number 80
[2025-02-21 00:14:04,897][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:14:12,890][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:14:21,848][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:14:31,077][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:14:40,006][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:14:47,332][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:14:58,789][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:15:10,042][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:15:18,036][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:15:27,939][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:15:58,971][root][INFO] - Processing question number 90
[2025-02-21 00:15:58,977][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:16:09,215][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:16:16,810][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:16:28,788][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:16:33,978][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:16:42,866][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:16:50,425][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:16:57,960][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:17:11,686][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:17:21,254][root][INFO] - Inference complete
[2025-02-21 00:17:21,255][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,261][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,274][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,279][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,279][root][INFO] - Saved parsed outputs
[2025-02-21 00:17:21,279][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,281][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,281][root][INFO] - Saved parsing metadata
[2025-02-21 00:17:21,282][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,284][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:17:21,285][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:17:21,316][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:17:21,316][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.36363636363636365, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 36, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.08080808080808081, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 12, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 00:17:29,505][root][INFO] - Setting global seed to 206
[2025-02-21 00:17:29,513][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:17:29,513][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:17:29,514][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:17:29,516][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:17:29,519][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:17:29,519][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:17:29,670][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:17:30,195][root][INFO] - Full model selected, loading model
[2025-02-21 00:17:48,621][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:19:31,110][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:19:31,110][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:20:01,913][root][INFO] - Peft model loaded successfully
[2025-02-21 00:20:09,363][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:20:09,365][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:20:09,365][root][INFO] - Starting inference
[2025-02-21 00:20:09,564][root][INFO] - Processing question number 0
[2025-02-21 00:20:09,567][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:20:17,061][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:20:28,237][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:20:53,160][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:21:05,477][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:21:36,626][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:21:51,446][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:22:03,935][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:22:15,962][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:22:22,729][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:22:33,005][root][INFO] - Processing question number 10
[2025-02-21 00:22:33,007][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:22:50,924][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:23:02,924][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:23:10,955][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:23:21,966][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:23:28,154][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:23:34,009][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:23:47,920][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:23:55,908][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:24:01,280][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:24:08,551][root][INFO] - Processing question number 20
[2025-02-21 00:24:08,554][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:24:16,413][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:24:30,390][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:24:37,473][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:24:49,581][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:24:58,860][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:25:06,431][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:25:15,567][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:25:25,968][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:25:40,770][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:26:09,586][root][INFO] - Processing question number 30
[2025-02-21 00:26:09,588][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:26:16,248][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:26:47,846][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:27:00,832][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:27:11,575][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:27:20,322][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:27:33,299][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:27:47,403][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:28:01,102][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:28:32,419][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:28:50,780][root][INFO] - Processing question number 40
[2025-02-21 00:28:50,784][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:29:03,563][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:29:17,904][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:29:29,613][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:29:44,076][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:29:53,162][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:30:09,916][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:30:20,354][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:30:34,924][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:30:45,189][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:30:51,671][root][INFO] - Processing question number 50
[2025-02-21 00:30:51,675][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:31:00,099][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:31:09,024][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:31:18,738][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:31:33,480][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:31:45,384][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:32:03,400][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:32:15,156][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:32:24,214][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:32:34,515][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:32:41,858][root][INFO] - Processing question number 60
[2025-02-21 00:32:41,862][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:33:12,985][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:33:21,827][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:33:45,732][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:33:59,125][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:34:10,070][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:34:22,217][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:34:53,683][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:35:00,804][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:35:10,208][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:35:20,841][root][INFO] - Processing question number 70
[2025-02-21 00:35:20,846][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:35:30,631][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:35:39,267][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:35:49,045][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:36:08,637][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:36:17,044][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:36:27,939][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:36:40,525][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:36:49,450][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:37:06,495][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:37:19,516][root][INFO] - Processing question number 80
[2025-02-21 00:37:19,521][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:37:27,287][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:37:58,980][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:38:10,465][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:38:20,792][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:38:29,281][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:38:42,167][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:38:52,263][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:39:09,623][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:39:26,131][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:39:34,275][root][INFO] - Processing question number 90
[2025-02-21 00:39:34,280][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:39:43,104][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:39:53,261][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:40:02,772][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:40:08,116][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:40:18,267][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:40:31,291][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:40:38,834][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:40:57,173][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:41:04,138][root][INFO] - Inference complete
[2025-02-21 00:41:04,138][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,144][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,159][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,164][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,164][root][INFO] - Saved parsed outputs
[2025-02-21 00:41:04,164][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,166][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,166][root][INFO] - Saved parsing metadata
[2025-02-21 00:41:04,167][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,168][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:04,170][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:41:04,184][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:41:04,184][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.47474747474747475, 'malformed_label': 0, 'malformed_domain': 16, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.7692307692307693, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.46153846153846156, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.1717171717171717, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.12121212121212122, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 6, 'both_wrong': 10}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 00:41:10,716][root][INFO] - Setting global seed to 206
[2025-02-21 00:41:10,721][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:41:10,722][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:41:10,723][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:41:10,724][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:41:10,726][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:41:10,727][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:41:10,869][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:41:11,476][root][INFO] - Full model selected, loading model
[2025-02-21 00:41:34,837][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:41:34,851][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:41:42,360][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:41:42,362][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:41:42,362][root][INFO] - Starting inference
[2025-02-21 00:41:42,554][root][INFO] - Processing question number 0
[2025-02-21 00:41:42,556][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:41:51,594][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:42:02,729][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:42:08,828][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:42:20,504][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:42:29,043][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:42:43,702][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:42:55,525][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:43:07,805][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:43:14,303][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:43:22,619][root][INFO] - Processing question number 10
[2025-02-21 00:43:22,621][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:43:32,047][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:43:41,048][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:43:48,829][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:43:57,468][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:44:04,538][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:44:15,154][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:44:23,247][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:44:30,222][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:44:38,037][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:44:45,736][root][INFO] - Processing question number 20
[2025-02-21 00:44:45,739][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:44:57,633][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:45:05,379][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:45:12,643][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:45:23,413][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:45:32,685][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:45:41,534][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:45:50,255][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:46:02,018][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:46:13,654][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:46:20,807][root][INFO] - Processing question number 30
[2025-02-21 00:46:20,810][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:46:33,112][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:46:44,165][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:46:57,315][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:47:06,359][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:47:13,758][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:47:21,483][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:47:31,531][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:47:41,648][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:47:49,492][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:47:58,476][root][INFO] - Processing question number 40
[2025-02-21 00:47:58,479][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:48:07,690][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:48:16,344][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:48:25,738][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:48:33,818][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:48:45,548][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:48:56,489][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:49:05,677][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:49:14,583][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:49:22,995][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:49:30,276][root][INFO] - Processing question number 50
[2025-02-21 00:49:30,279][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:49:38,997][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:49:50,077][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:49:56,734][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:50:06,837][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:50:16,422][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:50:26,154][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:50:37,809][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:50:49,645][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:51:00,299][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:51:08,450][root][INFO] - Processing question number 60
[2025-02-21 00:51:08,454][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:51:16,817][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:51:26,102][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:51:48,912][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:51:55,149][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:52:04,935][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:52:15,768][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:52:26,871][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:52:36,588][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:52:44,832][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:52:54,048][root][INFO] - Processing question number 70
[2025-02-21 00:52:54,052][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:53:02,293][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:53:10,481][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:53:17,530][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:53:29,419][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:53:38,477][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:53:47,339][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:53:59,010][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:54:09,637][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:54:17,907][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:54:25,815][root][INFO] - Processing question number 80
[2025-02-21 00:54:25,819][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:54:35,874][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:54:43,577][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:54:55,512][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:55:04,048][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:55:13,541][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:55:23,482][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:55:32,966][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:55:42,846][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:55:51,345][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:56:03,307][root][INFO] - Processing question number 90
[2025-02-21 00:56:03,312][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:56:17,608][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:56:29,090][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:56:39,353][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:56:46,247][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:56:58,215][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:57:09,040][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:57:18,016][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:57:29,115][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:57:40,958][root][INFO] - Inference complete
[2025-02-21 00:57:40,958][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,965][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,977][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,982][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,983][root][INFO] - Saved parsed outputs
[2025-02-21 00:57:40,983][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,984][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,984][root][INFO] - Saved parsing metadata
[2025-02-21 00:57:40,985][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,987][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:57:40,988][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:57:41,017][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:57:41,017][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 27, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.1111111111111111, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.1111111111111111, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 00:57:49,166][root][INFO] - Setting global seed to 989
[2025-02-21 00:57:49,174][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:57:49,174][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:57:49,175][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:57:49,177][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:57:49,180][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:57:49,180][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:57:49,335][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:57:49,860][root][INFO] - Full model selected, loading model
[2025-02-21 00:58:08,072][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:59:50,249][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:59:50,249][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:00:20,985][root][INFO] - Peft model loaded successfully
[2025-02-21 01:00:28,191][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:00:28,192][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:00:28,193][root][INFO] - Starting inference
[2025-02-21 01:00:28,401][root][INFO] - Processing question number 0
[2025-02-21 01:00:28,403][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:00:38,991][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:00:48,125][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:00:56,987][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:01:28,416][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:01:39,695][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:01:49,058][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:02:20,727][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:02:30,785][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:02:38,665][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:02:46,534][root][INFO] - Processing question number 10
[2025-02-21 01:02:46,536][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:03:19,252][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:03:34,634][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:03:41,795][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:03:48,763][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:04:02,331][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:04:10,846][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:04:41,616][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:04:47,435][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:04:57,279][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:05:07,484][root][INFO] - Processing question number 20
[2025-02-21 01:05:07,486][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:05:19,183][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:05:32,221][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:05:48,585][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:05:58,289][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:06:06,852][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:06:14,406][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:06:46,177][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:06:55,994][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:07:27,129][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:07:35,006][root][INFO] - Processing question number 30
[2025-02-21 01:07:35,010][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:07:44,016][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:08:02,392][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:08:14,330][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:08:25,333][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:08:33,818][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:08:42,652][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:08:53,506][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:09:04,412][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:09:21,766][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:09:34,535][root][INFO] - Processing question number 40
[2025-02-21 01:09:34,538][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:09:43,330][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:09:54,566][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:10:06,751][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:10:15,975][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:10:34,758][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:11:03,422][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:11:17,132][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:11:24,501][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:11:33,090][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:11:39,519][root][INFO] - Processing question number 50
[2025-02-21 01:11:39,522][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:11:49,684][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:12:00,427][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:12:12,168][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:12:44,108][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:12:54,863][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:13:07,745][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:13:19,455][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:13:26,818][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:13:58,316][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:14:30,227][root][INFO] - Processing question number 60
[2025-02-21 01:14:30,231][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:14:37,162][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:14:45,435][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:14:57,390][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:15:06,708][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:15:18,360][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:15:49,498][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:16:01,511][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:16:32,789][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:17:04,024][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:17:35,439][root][INFO] - Processing question number 70
[2025-02-21 01:17:35,443][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:17:43,376][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:17:52,966][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:18:00,937][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:18:25,909][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:18:35,741][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:18:46,492][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:18:59,685][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:19:10,183][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:19:24,483][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:19:55,553][root][INFO] - Processing question number 80
[2025-02-21 01:19:55,558][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:20:03,958][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:20:35,366][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:20:44,726][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:20:52,942][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:21:04,912][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:21:16,227][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:21:26,938][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:21:37,431][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:21:50,909][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:22:01,632][root][INFO] - Processing question number 90
[2025-02-21 01:22:01,638][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:22:33,382][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:22:41,304][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:23:12,404][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:23:24,082][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:23:34,898][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:23:44,455][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:23:51,300][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:23:59,370][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:24:30,914][root][INFO] - Inference complete
[2025-02-21 01:24:30,914][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,925][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,941][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,950][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,950][root][INFO] - Saved parsed outputs
[2025-02-21 01:24:30,950][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,953][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,953][root][INFO] - Saved parsing metadata
[2025-02-21 01:24:30,954][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,956][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:24:30,967][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:24:30,999][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:24:30,999][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.40404040404040403, 'malformed_label': 0, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 40, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.18181818181818182, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 7, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 01:24:39,203][root][INFO] - Setting global seed to 989
[2025-02-21 01:24:39,211][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:24:39,211][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:24:39,213][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:24:39,214][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:24:39,217][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:24:39,217][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:24:39,364][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:24:39,926][root][INFO] - Full model selected, loading model
[2025-02-21 01:25:02,877][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:25:02,884][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:25:10,375][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:25:10,376][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:25:10,376][root][INFO] - Starting inference
[2025-02-21 01:25:10,555][root][INFO] - Processing question number 0
[2025-02-21 01:25:10,557][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:25:16,878][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:25:25,171][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:25:35,733][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:25:45,751][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:25:53,392][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:26:07,842][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:26:19,248][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:26:29,416][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:26:38,991][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:26:47,044][root][INFO] - Processing question number 10
[2025-02-21 01:26:47,046][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:27:19,394][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:27:29,122][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:27:35,852][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:27:47,008][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:27:54,073][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:28:02,491][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:28:11,831][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:28:21,949][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:28:52,876][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:29:01,149][root][INFO] - Processing question number 20
[2025-02-21 01:29:01,152][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:29:09,524][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:29:18,746][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:29:26,641][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:29:35,943][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:29:47,168][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:29:56,675][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:30:04,233][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:30:14,143][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:30:24,028][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:30:32,882][root][INFO] - Processing question number 30
[2025-02-21 01:30:32,884][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:30:47,362][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:30:58,994][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:31:09,336][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:31:19,188][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:31:25,998][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:31:34,268][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:31:42,946][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:31:51,684][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:32:00,253][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:32:07,823][root][INFO] - Processing question number 40
[2025-02-21 01:32:07,826][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:32:18,658][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:32:27,804][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:32:37,081][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:32:45,459][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:32:55,192][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:33:26,185][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:33:34,086][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:33:43,880][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:33:51,098][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:33:58,531][root][INFO] - Processing question number 50
[2025-02-21 01:33:58,534][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:34:06,588][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:34:17,216][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:34:24,654][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:34:34,213][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:34:46,042][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:34:53,647][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:35:03,640][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:35:11,056][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:35:23,560][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:35:33,064][root][INFO] - Processing question number 60
[2025-02-21 01:35:33,068][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:35:42,388][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:35:49,640][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:36:00,229][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:36:07,690][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:36:18,874][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:36:29,156][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:36:40,845][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:36:49,833][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:36:58,167][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:37:05,768][root][INFO] - Processing question number 70
[2025-02-21 01:37:05,772][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:37:13,853][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:37:22,319][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:37:30,881][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:37:42,605][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:37:52,930][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:38:01,666][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:38:10,436][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:38:20,118][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:38:27,287][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:38:35,672][root][INFO] - Processing question number 80
[2025-02-21 01:38:35,676][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:38:43,167][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:38:51,609][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:39:03,023][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:39:11,828][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:39:21,094][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:39:30,750][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:39:42,301][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:39:53,104][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:40:04,434][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:40:35,020][root][INFO] - Processing question number 90
[2025-02-21 01:40:35,025][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:40:46,385][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:40:54,794][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:41:04,565][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:41:10,503][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:41:20,608][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:41:29,179][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:41:36,904][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:41:47,352][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:41:57,883][root][INFO] - Inference complete
[2025-02-21 01:41:57,884][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,889][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,903][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,908][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,908][root][INFO] - Saved parsed outputs
[2025-02-21 01:41:57,908][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,909][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,909][root][INFO] - Saved parsing metadata
[2025-02-21 01:41:57,910][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,912][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:41:57,913][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:41:57,929][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:41:57,930][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.3838383838383838, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.10101010101010101, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 11, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 01:42:04,630][root][INFO] - Setting global seed to 989
[2025-02-21 01:42:04,637][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:42:04,638][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:42:04,639][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:42:04,640][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:42:04,642][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:42:04,642][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:42:04,793][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:42:05,392][root][INFO] - Full model selected, loading model
[2025-02-21 01:42:26,600][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:44:07,888][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:44:07,888][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:44:39,638][root][INFO] - Peft model loaded successfully
[2025-02-21 01:44:46,796][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:44:46,798][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:44:46,798][root][INFO] - Starting inference
[2025-02-21 01:44:47,000][root][INFO] - Processing question number 0
[2025-02-21 01:44:47,002][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:44:57,138][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:45:08,619][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:45:16,974][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:45:33,624][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:45:42,320][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:45:56,856][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:46:06,205][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:46:18,275][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:46:25,528][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:46:36,460][root][INFO] - Processing question number 10
[2025-02-21 01:46:36,462][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:47:09,099][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:47:23,682][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:47:32,547][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:47:43,507][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:47:50,189][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:47:59,573][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:48:30,437][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:48:37,186][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:48:51,615][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:49:00,809][root][INFO] - Processing question number 20
[2025-02-21 01:49:00,811][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:49:07,196][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:49:27,679][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:49:36,237][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:49:47,354][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:49:56,781][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:50:04,350][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:50:13,695][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:50:25,405][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:50:35,292][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:50:44,578][root][INFO] - Processing question number 30
[2025-02-21 01:50:44,581][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:50:56,575][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:51:07,529][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:51:36,254][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:51:55,800][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:52:03,661][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:52:15,523][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:52:26,720][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:52:37,851][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:52:47,354][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:53:09,168][root][INFO] - Processing question number 40
[2025-02-21 01:53:09,172][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:53:32,320][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:53:42,692][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:53:55,367][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:54:27,082][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:54:36,178][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:54:50,811][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:55:01,659][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:55:13,621][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:55:20,368][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:55:28,785][root][INFO] - Processing question number 50
[2025-02-21 01:55:28,789][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:55:39,714][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:55:49,608][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:55:55,461][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:56:27,555][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:56:36,308][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:56:57,174][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:57:11,385][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:57:22,074][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:57:44,902][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:58:02,077][root][INFO] - Processing question number 60
[2025-02-21 01:58:02,081][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:58:09,337][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:58:18,044][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:58:29,047][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:58:41,030][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:58:53,990][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:59:08,304][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:59:24,418][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:59:35,467][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:59:42,198][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:59:52,478][root][INFO] - Processing question number 70
[2025-02-21 01:59:52,483][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:00:04,373][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:00:11,884][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:00:21,565][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:00:32,798][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:00:41,715][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:00:51,619][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:01:02,484][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:01:13,121][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:01:22,964][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:01:54,148][root][INFO] - Processing question number 80
[2025-02-21 02:01:54,152][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:02:08,471][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:02:19,249][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:02:31,223][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:02:40,256][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:02:50,059][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:02:58,250][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:03:12,444][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:03:38,329][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:03:54,902][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:04:04,189][root][INFO] - Processing question number 90
[2025-02-21 02:04:04,194][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:04:15,767][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:04:22,945][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:04:30,036][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:04:44,294][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:05:15,903][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:05:23,186][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:05:32,610][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:05:42,858][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:06:14,524][root][INFO] - Inference complete
[2025-02-21 02:06:14,524][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,531][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,546][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,551][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,551][root][INFO] - Saved parsed outputs
[2025-02-21 02:06:14,551][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,553][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,553][root][INFO] - Saved parsing metadata
[2025-02-21 02:06:14,553][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,555][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:14,557][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:06:14,581][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:06:14,582][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.41414141414141414, 'malformed_label': 0, 'malformed_domain': 14, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 41, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6923076923076923, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 44, 'correct_label_wrong_domain': 7, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 02:06:21,299][root][INFO] - Setting global seed to 989
[2025-02-21 02:06:21,305][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:06:21,305][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:06:21,306][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:06:21,308][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:06:21,311][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:06:21,311][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:06:21,458][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:06:22,022][root][INFO] - Full model selected, loading model
[2025-02-21 02:06:43,378][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:06:43,378][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:06:50,987][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:06:50,988][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:06:50,988][root][INFO] - Starting inference
[2025-02-21 02:06:51,176][root][INFO] - Processing question number 0
[2025-02-21 02:06:51,178][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:06:59,848][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:07:08,967][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:07:18,340][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:07:31,821][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:07:39,429][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:07:50,350][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:07:59,292][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:08:09,851][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:08:21,848][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:08:31,219][root][INFO] - Processing question number 10
[2025-02-21 02:08:31,221][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:08:41,174][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:08:51,679][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:09:00,045][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:09:08,886][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:09:14,915][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:09:26,656][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:09:35,637][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:09:44,498][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:09:52,324][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:10:01,410][root][INFO] - Processing question number 20
[2025-02-21 02:10:01,413][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:10:10,352][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:10:17,860][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:10:26,754][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:10:34,856][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:10:44,479][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:10:52,143][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:11:00,015][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:11:09,715][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:11:21,188][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:11:30,905][root][INFO] - Processing question number 30
[2025-02-21 02:11:30,908][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:11:39,341][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:11:49,132][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:11:59,547][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:12:10,736][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:12:18,146][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:12:26,933][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:12:36,083][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:12:44,745][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:12:53,389][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:13:01,973][root][INFO] - Processing question number 40
[2025-02-21 02:13:01,976][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:13:10,838][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:13:19,651][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:13:30,499][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:13:39,992][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:13:51,557][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:14:04,651][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:14:12,975][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:14:23,160][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:14:32,367][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:14:40,615][root][INFO] - Processing question number 50
[2025-02-21 02:14:40,619][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:14:47,735][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:14:58,703][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:15:05,179][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:15:14,773][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:15:31,516][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:15:39,825][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:15:48,847][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:15:58,884][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:16:08,982][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:16:19,860][root][INFO] - Processing question number 60
[2025-02-21 02:16:19,864][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:16:27,571][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:16:35,731][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:16:43,903][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:16:51,822][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:17:03,760][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:17:12,437][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:17:21,538][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:17:30,900][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:17:39,064][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:17:48,241][root][INFO] - Processing question number 70
[2025-02-21 02:17:48,245][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:17:56,401][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:18:04,824][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:18:12,654][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:18:23,240][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:18:34,266][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:18:44,180][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:18:54,245][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:19:02,774][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:19:12,967][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:19:24,173][root][INFO] - Processing question number 80
[2025-02-21 02:19:24,177][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:19:32,081][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:19:40,547][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:19:51,211][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:20:01,431][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:20:10,672][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:20:20,763][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:20:32,206][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:20:40,650][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:20:49,903][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:21:20,767][root][INFO] - Processing question number 90
[2025-02-21 02:21:20,772][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:21:30,905][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:21:38,029][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:21:48,538][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:21:55,403][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:22:05,042][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:22:10,263][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:22:18,648][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:22:26,941][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:22:37,565][root][INFO] - Inference complete
[2025-02-21 02:22:37,565][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,571][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,583][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,588][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,588][root][INFO] - Saved parsed outputs
[2025-02-21 02:22:37,588][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,590][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,590][root][INFO] - Saved parsing metadata
[2025-02-21 02:22:37,590][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,592][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:22:37,593][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:22:37,620][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:22:37,620][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.13131313131313133, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.13131313131313133, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 12, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 02:22:44,635][root][INFO] - Setting global seed to 989
[2025-02-21 02:22:44,642][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:22:44,642][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:22:44,643][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:22:44,645][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:22:44,648][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:22:44,648][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:22:44,789][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:22:45,306][root][INFO] - Full model selected, loading model
[2025-02-21 02:23:03,447][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:24:44,214][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:24:44,247][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:25:15,806][root][INFO] - Peft model loaded successfully
[2025-02-21 02:25:22,984][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:25:22,986][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:25:22,986][root][INFO] - Starting inference
[2025-02-21 02:25:23,207][root][INFO] - Processing question number 0
[2025-02-21 02:25:23,209][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:25:32,261][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:25:40,133][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:25:48,740][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:25:56,104][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:26:09,893][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:26:22,877][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:26:38,520][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:26:49,491][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:26:55,619][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:27:01,367][root][INFO] - Processing question number 10
[2025-02-21 02:27:01,369][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:27:34,024][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:27:44,441][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:28:15,670][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:28:24,727][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:28:33,015][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:28:50,032][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:28:59,516][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:29:09,241][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:29:16,445][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:29:30,814][root][INFO] - Processing question number 20
[2025-02-21 02:29:30,817][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:29:35,398][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:29:44,272][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:29:51,317][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:29:59,937][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:30:09,660][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:30:17,825][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:30:30,722][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:30:40,244][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:30:54,515][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:31:04,067][root][INFO] - Processing question number 30
[2025-02-21 02:31:04,070][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:31:35,396][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:32:07,035][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:32:25,114][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:32:47,895][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:32:54,883][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:33:04,857][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:33:12,943][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:33:24,301][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:33:45,121][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:34:03,530][root][INFO] - Processing question number 40
[2025-02-21 02:34:03,533][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:34:13,178][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:34:23,973][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:34:35,141][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:34:43,545][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:34:56,925][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:35:07,621][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:35:15,096][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:35:45,699][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:35:55,262][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:36:02,217][root][INFO] - Processing question number 50
[2025-02-21 02:36:02,220][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:36:27,424][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:36:36,657][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:36:43,187][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:36:56,012][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:37:16,103][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:37:25,007][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:37:56,753][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:38:07,447][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:38:17,400][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:38:30,170][root][INFO] - Processing question number 60
[2025-02-21 02:38:30,174][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:38:38,900][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:38:54,356][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:39:04,446][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:39:12,522][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:39:22,866][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:39:31,059][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:39:44,327][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:39:55,819][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:40:02,407][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:40:13,560][root][INFO] - Processing question number 70
[2025-02-21 02:40:13,564][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:40:22,576][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:40:36,486][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:40:42,585][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:40:53,683][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:41:04,220][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:41:10,884][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:41:24,857][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:41:36,992][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:41:47,119][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:42:02,440][root][INFO] - Processing question number 80
[2025-02-21 02:42:02,445][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:42:10,791][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:42:23,170][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:42:35,191][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:42:43,614][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:42:55,847][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:43:06,269][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:43:14,277][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:43:20,770][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:43:30,503][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:43:43,221][root][INFO] - Processing question number 90
[2025-02-21 02:43:43,227][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:43:55,592][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:44:26,133][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:44:32,537][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:44:39,351][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:44:51,976][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:45:00,588][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:45:07,568][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:45:23,658][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:45:33,669][root][INFO] - Inference complete
[2025-02-21 02:45:33,670][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,676][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,692][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,697][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,697][root][INFO] - Saved parsed outputs
[2025-02-21 02:45:33,697][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,699][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,699][root][INFO] - Saved parsing metadata
[2025-02-21 02:45:33,699][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,701][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:45:33,703][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:45:33,722][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:45:33,722][root][INFO] - Summary of metrics : {'label_accuracy': 0.47474747474747475, 'misclassification_rate': 0.5252525252525253, 'combined_accuracy': 0.3939393939393939, 'malformed_label': 1, 'malformed_domain': 15, 'total_predictions': 99, 'correct_predictions': 47, 'correct_label_and_domain': 39, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.6153846153846154, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.5714285714285714, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.16161616161616163, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 8, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 02:45:41,681][root][INFO] - Setting global seed to 989
[2025-02-21 02:45:41,688][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:45:41,688][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:45:41,690][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:45:41,691][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:45:41,694][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:45:41,694][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:45:41,836][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:45:42,378][root][INFO] - Full model selected, loading model
[2025-02-21 02:46:05,797][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:46:05,813][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:46:13,791][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:46:13,792][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:46:13,792][root][INFO] - Starting inference
[2025-02-21 02:46:13,987][root][INFO] - Processing question number 0
[2025-02-21 02:46:13,990][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:46:22,687][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:46:34,021][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:46:43,186][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:46:53,043][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:47:03,178][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:47:14,227][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:47:24,396][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:47:33,226][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:47:45,361][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:47:54,698][root][INFO] - Processing question number 10
[2025-02-21 02:47:54,700][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:48:08,628][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:48:18,098][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:48:24,324][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:48:36,343][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:48:43,447][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:48:53,316][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:49:01,656][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:49:09,289][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:49:17,119][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:49:27,867][root][INFO] - Processing question number 20
[2025-02-21 02:49:27,870][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:49:36,665][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:49:44,320][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:49:53,458][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:50:01,803][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:50:13,339][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:50:23,078][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:50:35,217][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:50:51,096][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:51:01,998][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:51:10,649][root][INFO] - Processing question number 30
[2025-02-21 02:51:10,652][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:51:19,385][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:51:28,215][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:51:40,068][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:51:50,381][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:51:57,895][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:52:07,801][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:52:17,305][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:52:25,158][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:52:34,001][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:52:43,440][root][INFO] - Processing question number 40
[2025-02-21 02:52:43,443][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:52:53,664][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:53:02,915][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:53:15,832][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:53:24,233][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:53:33,277][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:53:45,506][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:53:58,733][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:54:08,788][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:54:16,068][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:54:21,397][root][INFO] - Processing question number 50
[2025-02-21 02:54:21,401][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:54:32,310][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:54:41,624][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:54:48,673][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:54:59,438][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:55:10,024][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:55:24,622][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:55:33,230][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:55:44,174][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:55:53,582][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:56:02,156][root][INFO] - Processing question number 60
[2025-02-21 02:56:02,159][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:56:10,938][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:56:19,339][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:56:31,947][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:56:38,427][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:56:50,526][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:57:01,662][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:57:11,826][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:57:19,450][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:57:30,179][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:57:42,099][root][INFO] - Processing question number 70
[2025-02-21 02:57:42,103][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:57:51,343][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:57:59,980][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:58:06,931][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:58:17,860][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:58:30,965][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:58:38,805][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:58:48,776][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:58:58,668][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:59:09,010][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:59:17,561][root][INFO] - Processing question number 80
[2025-02-21 02:59:17,565][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:59:27,419][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:59:37,487][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:59:46,091][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:59:55,985][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:00:05,548][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:00:14,640][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:00:25,141][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:00:36,530][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:00:48,954][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:00:57,986][root][INFO] - Processing question number 90
[2025-02-21 03:00:57,991][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:01:08,943][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:01:18,309][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:01:29,729][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:01:37,175][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:01:47,395][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:01:56,500][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:02:04,776][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:02:14,580][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:02:27,446][root][INFO] - Inference complete
[2025-02-21 03:02:27,446][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,452][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,465][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,470][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,470][root][INFO] - Saved parsed outputs
[2025-02-21 03:02:27,470][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,472][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,472][root][INFO] - Saved parsing metadata
[2025-02-21 03:02:27,472][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,474][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:02:27,475][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:02:27,497][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:02:27,497][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.3434343434343434, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.4, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.38461538461538464, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.10101010101010101, 'Criminal_Law_confidence': 0.12121212121212122, 'Evidence_confidence': 0.13131313131313133, 'Real_Property_confidence': 0.1414141414141414, 'Torts_confidence': 0.10101010101010101, 'Civil_Procedure_confidence': 0.08080808080808081, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 15, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 03:02:35,346][root][INFO] - Setting global seed to 206
[2025-02-21 03:02:35,353][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:02:35,353][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:02:35,355][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:02:35,357][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:02:35,360][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:02:35,360][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:02:35,538][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:02:36,223][root][INFO] - Full model selected, loading model
[2025-02-21 03:02:52,342][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:04:32,214][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:04:32,248][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:05:04,603][root][INFO] - Peft model loaded successfully
[2025-02-21 03:05:11,762][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:05:11,764][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:05:11,764][root][INFO] - Starting inference
[2025-02-21 03:05:11,960][root][INFO] - Processing question number 0
[2025-02-21 03:05:11,963][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:05:23,498][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:05:43,044][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:05:56,455][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:06:12,019][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:06:22,700][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:06:31,001][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:07:02,062][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:07:11,224][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:07:16,832][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:07:33,319][root][INFO] - Processing question number 10
[2025-02-21 03:07:33,321][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:07:42,409][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:07:53,881][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:08:02,996][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:08:10,495][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:08:20,669][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:08:33,848][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:08:45,359][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:08:58,152][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:09:08,144][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:09:15,495][root][INFO] - Processing question number 20
[2025-02-21 03:09:15,497][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:09:26,343][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:09:35,101][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:09:43,630][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:09:52,249][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:10:01,115][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:10:14,023][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:10:24,727][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:10:39,800][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:10:49,272][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:10:58,797][root][INFO] - Processing question number 30
[2025-02-21 03:10:58,800][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:11:09,065][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:11:17,987][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:11:27,313][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:11:43,748][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:11:54,426][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:12:25,596][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:12:35,804][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:12:44,683][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:12:53,837][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:13:05,993][root][INFO] - Processing question number 40
[2025-02-21 03:13:05,996][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:13:16,928][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:13:27,877][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:13:39,929][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:13:54,443][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:14:08,405][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:14:39,584][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:14:50,299][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:15:21,547][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:15:33,604][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:15:42,912][root][INFO] - Processing question number 50
[2025-02-21 03:15:42,917][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:15:49,808][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:16:09,598][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:16:18,878][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:16:30,031][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:16:41,757][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:16:56,197][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:17:08,094][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:17:17,952][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:17:49,413][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:17:59,254][root][INFO] - Processing question number 60
[2025-02-21 03:17:59,258][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:18:08,769][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:18:20,465][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:18:29,886][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:18:45,652][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:19:03,650][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:19:34,687][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:20:05,513][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:20:15,009][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:20:29,472][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:20:38,631][root][INFO] - Processing question number 70
[2025-02-21 03:20:38,635][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:20:46,222][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:20:54,751][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:21:26,075][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:21:57,704][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:22:11,348][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:22:21,201][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:22:30,025][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:22:42,699][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:22:52,719][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:23:00,417][root][INFO] - Processing question number 80
[2025-02-21 03:23:00,422][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:23:06,621][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:23:18,776][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:23:28,530][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:23:36,594][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:23:45,458][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:24:16,386][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:24:29,996][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 03:24:38,772][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 03:24:48,668][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:25:19,693][root][INFO] - Processing question number 90
[2025-02-21 03:25:19,698][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 03:25:26,097][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 03:25:57,599][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:26:09,783][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 03:26:19,529][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 03:26:28,780][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 03:26:39,825][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 03:26:52,042][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 03:27:20,393][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 03:27:29,363][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:27:42,291][root][INFO] - Inference complete
[2025-02-21 03:27:42,291][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,298][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,313][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,319][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,319][root][INFO] - Saved parsed outputs
[2025-02-21 03:27:42,319][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,320][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,320][root][INFO] - Saved parsing metadata
[2025-02-21 03:27:42,321][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,323][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:27:42,324][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 03:27:42,364][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 03:27:42,364][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.46, 'malformed_label': 0, 'malformed_domain': 14, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 11, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 03:27:49,685][root][INFO] - Setting global seed to 206
[2025-02-21 03:27:49,692][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 03:27:49,692][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:27:49,693][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:27:49,695][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:27:49,697][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:27:49,697][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:27:49,841][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:27:50,390][root][INFO] - Full model selected, loading model
[2025-02-21 03:28:14,163][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:28:14,164][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:28:22,237][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:28:22,239][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:28:22,239][root][INFO] - Starting inference
[2025-02-21 03:28:22,454][root][INFO] - Processing question number 0
[2025-02-21 03:28:22,457][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:28:35,917][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:28:44,266][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:28:53,474][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:29:02,533][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:29:12,931][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:29:22,264][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:29:31,629][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:29:38,915][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:29:45,763][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:29:54,792][root][INFO] - Processing question number 10
[2025-02-21 03:29:54,794][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:30:03,825][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:30:22,441][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:30:33,284][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:30:42,438][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:30:50,760][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:30:59,918][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:31:07,698][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:31:18,197][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:31:25,761][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:31:34,417][root][INFO] - Processing question number 20
[2025-02-21 03:31:34,420][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:31:47,088][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:31:56,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:32:03,776][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:32:13,390][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:32:20,655][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:32:30,012][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:32:40,330][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:32:49,851][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:32:57,571][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:33:06,900][root][INFO] - Processing question number 30
[2025-02-21 03:33:06,903][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:33:16,091][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:33:26,306][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:33:39,320][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:33:49,186][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:33:57,696][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:34:06,520][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:34:17,535][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:34:26,227][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:34:34,467][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:34:44,827][root][INFO] - Processing question number 40
[2025-02-21 03:34:44,830][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:34:53,439][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:35:02,662][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:35:12,463][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:35:25,528][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:35:37,806][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:35:44,812][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:35:52,918][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:36:04,546][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:36:14,461][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:36:24,673][root][INFO] - Processing question number 50
[2025-02-21 03:36:24,676][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:36:35,120][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:36:42,922][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:36:54,366][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:37:04,627][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:37:13,957][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:37:24,555][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:37:36,405][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:37:43,931][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:37:53,291][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:38:01,153][root][INFO] - Processing question number 60
[2025-02-21 03:38:01,156][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:38:09,789][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:38:18,312][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:38:30,064][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:38:37,000][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:38:47,450][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:38:56,432][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:39:04,261][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:39:14,325][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:39:26,847][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:39:39,667][root][INFO] - Processing question number 70
[2025-02-21 03:39:39,671][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:39:48,200][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:39:56,934][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:40:20,289][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:40:30,871][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:40:40,649][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:40:53,654][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:41:02,081][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:41:13,755][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:41:21,446][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:41:30,522][root][INFO] - Processing question number 80
[2025-02-21 03:41:30,526][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:41:37,709][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:41:46,716][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:41:54,827][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:42:03,054][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:42:13,095][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:42:20,819][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:42:33,798][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 03:42:43,534][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 03:42:52,454][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:43:02,826][root][INFO] - Processing question number 90
[2025-02-21 03:43:02,831][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 03:43:10,864][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 03:43:22,658][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:43:54,086][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 03:44:03,578][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 03:44:11,899][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 03:44:22,225][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 03:44:31,051][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 03:44:39,252][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 03:44:47,594][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:44:57,295][root][INFO] - Inference complete
[2025-02-21 03:44:57,295][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,302][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,315][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,320][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,320][root][INFO] - Saved parsed outputs
[2025-02-21 03:44:57,321][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,322][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,322][root][INFO] - Saved parsing metadata
[2025-02-21 03:44:57,323][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,324][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:44:57,327][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 03:44:57,359][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 03:44:57,359][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.09, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 15, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 03:45:04,794][root][INFO] - Setting global seed to 206
[2025-02-21 03:45:04,801][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:45:04,802][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:45:04,803][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:45:04,804][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:45:04,807][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:45:04,807][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:45:04,955][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:45:05,497][root][INFO] - Full model selected, loading model
[2025-02-21 03:45:27,043][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:47:11,330][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:47:11,330][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:47:44,438][root][INFO] - Peft model loaded successfully
[2025-02-21 03:47:51,721][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:47:51,723][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 03:47:51,723][root][INFO] - Starting inference
[2025-02-21 03:47:51,932][root][INFO] - Processing question number 0
[2025-02-21 03:47:51,934][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:48:10,824][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:48:22,733][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:48:38,483][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:48:48,434][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:48:58,225][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:49:09,574][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:49:40,903][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:49:48,554][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:49:56,004][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:50:06,522][root][INFO] - Processing question number 10
[2025-02-21 03:50:06,525][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:50:17,115][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:50:29,178][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:50:41,413][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:50:52,514][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:51:06,137][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:51:17,527][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:51:27,553][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:51:35,108][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:51:43,020][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:51:54,920][root][INFO] - Processing question number 20
[2025-02-21 03:51:54,922][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:52:25,698][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:52:57,282][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:53:07,274][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:53:16,860][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:53:31,732][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:53:42,424][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:53:58,624][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:54:07,713][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:54:14,186][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:54:23,844][root][INFO] - Processing question number 30
[2025-02-21 03:54:23,847][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:54:30,799][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:54:40,395][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:54:57,181][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:55:13,294][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:55:26,179][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:55:39,546][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:55:51,502][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:56:00,259][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:56:09,497][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:56:22,213][root][INFO] - Processing question number 40
[2025-02-21 03:56:22,216][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:56:31,982][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:56:43,169][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:56:54,613][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:57:10,360][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:57:26,906][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:57:34,794][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:57:43,945][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:57:56,218][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:58:10,596][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:58:20,586][root][INFO] - Processing question number 50
[2025-02-21 03:58:20,589][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:58:27,436][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:58:37,415][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:58:54,186][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:59:09,517][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:59:24,762][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:59:34,641][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:59:48,591][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:59:56,212][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:00:09,087][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:00:20,265][root][INFO] - Processing question number 60
[2025-02-21 04:00:20,269][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:00:32,434][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:00:48,645][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:01:05,195][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:01:14,375][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:01:24,955][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:01:39,026][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:01:45,031][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:01:55,070][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:02:06,510][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:02:21,401][root][INFO] - Processing question number 70
[2025-02-21 04:02:21,405][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:02:30,639][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:02:39,637][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:02:55,440][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:03:06,416][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:03:16,955][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:03:26,588][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:03:42,498][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:04:14,344][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:04:24,256][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:04:55,549][root][INFO] - Processing question number 80
[2025-02-21 04:04:55,554][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:05:06,914][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:05:16,543][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:05:28,091][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:05:47,505][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:05:55,105][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:06:19,072][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:06:38,910][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:07:10,968][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:07:19,785][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:07:32,039][root][INFO] - Processing question number 90
[2025-02-21 04:07:32,045][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:07:40,469][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:07:54,870][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:08:09,043][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:08:18,291][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:08:29,475][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:08:41,651][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:08:51,640][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:09:02,526][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:09:33,553][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:09:50,706][root][INFO] - Inference complete
[2025-02-21 04:09:50,706][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,712][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,728][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,733][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,734][root][INFO] - Saved parsed outputs
[2025-02-21 04:09:50,734][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,744][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,745][root][INFO] - Saved parsing metadata
[2025-02-21 04:09:50,745][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,747][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:09:50,748][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:09:50,777][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:09:50,777][root][INFO] - Summary of metrics : {'label_accuracy': 0.59, 'misclassification_rate': 0.41000000000000003, 'combined_accuracy': 0.5, 'malformed_label': 0, 'malformed_domain': 12, 'total_predictions': 100, 'correct_predictions': 59, 'correct_label_and_domain': 50, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 9, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 04:09:58,598][root][INFO] - Setting global seed to 206
[2025-02-21 04:09:58,605][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:09:58,605][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:09:58,607][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:09:58,608][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:09:58,611][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:09:58,611][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:09:58,756][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:09:59,293][root][INFO] - Full model selected, loading model
[2025-02-21 04:10:21,086][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:10:21,097][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:10:28,671][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:10:28,673][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:10:28,673][root][INFO] - Starting inference
[2025-02-21 04:10:28,857][root][INFO] - Processing question number 0
[2025-02-21 04:10:28,860][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:10:42,745][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:10:52,313][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:11:00,780][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:11:09,962][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:11:18,751][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:11:27,618][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:11:37,400][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:11:45,743][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:11:52,361][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:12:02,074][root][INFO] - Processing question number 10
[2025-02-21 04:12:02,076][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:12:10,045][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:12:41,314][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:12:52,191][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:13:02,648][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:13:12,332][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:13:22,055][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:13:32,334][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:13:52,952][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:14:01,118][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:14:09,337][root][INFO] - Processing question number 20
[2025-02-21 04:14:09,339][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:14:21,401][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:14:29,080][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:14:37,882][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:14:49,819][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:14:57,473][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:15:05,344][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:15:15,526][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:15:23,662][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:15:33,297][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:15:42,282][root][INFO] - Processing question number 30
[2025-02-21 04:15:42,285][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:15:49,831][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:15:59,658][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:16:08,508][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:16:19,039][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:16:27,155][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:16:37,629][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:16:48,560][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:16:57,502][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:17:04,993][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:17:14,062][root][INFO] - Processing question number 40
[2025-02-21 04:17:14,065][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:17:21,737][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:17:30,078][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:17:41,042][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:17:51,183][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:18:02,664][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:18:11,438][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:18:19,345][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:18:27,994][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:18:38,617][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:18:46,441][root][INFO] - Processing question number 50
[2025-02-21 04:18:46,444][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:18:57,914][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:19:04,196][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:19:23,181][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:19:35,972][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:19:47,425][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:19:55,072][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:20:06,143][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:20:15,669][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:20:26,244][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:20:35,498][root][INFO] - Processing question number 60
[2025-02-21 04:20:35,502][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:20:43,095][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:20:52,266][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:21:01,650][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:21:09,927][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:21:22,608][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:21:32,186][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:21:39,767][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:21:51,224][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:22:02,891][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:22:13,735][root][INFO] - Processing question number 70
[2025-02-21 04:22:13,740][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:22:25,171][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:22:33,661][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:22:48,801][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:22:59,399][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:23:08,001][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:23:21,049][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:23:30,140][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:23:39,578][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:23:47,268][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:23:56,843][root][INFO] - Processing question number 80
[2025-02-21 04:23:56,848][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:24:03,675][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:24:12,338][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:24:22,560][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:24:32,282][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:24:40,443][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:24:47,617][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:25:01,383][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:25:09,056][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:25:17,924][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:25:26,407][root][INFO] - Processing question number 90
[2025-02-21 04:25:26,412][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:25:37,090][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:25:45,966][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:26:17,578][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:26:25,575][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:26:35,246][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:26:46,640][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:26:54,164][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:27:04,089][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:27:13,364][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:27:23,679][root][INFO] - Inference complete
[2025-02-21 04:27:23,679][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,687][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,700][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,706][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,706][root][INFO] - Saved parsed outputs
[2025-02-21 04:27:23,706][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,718][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,718][root][INFO] - Saved parsing metadata
[2025-02-21 04:27:23,719][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,721][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:27:23,724][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:27:23,752][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:27:23,752][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.32, 'malformed_label': 0, 'malformed_domain': 33, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.16, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.09, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 16, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 04:27:31,710][root][INFO] - Setting global seed to 206
[2025-02-21 04:27:31,717][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:27:31,717][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:27:31,719][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:27:31,720][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:27:31,723][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:27:31,723][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:27:31,873][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:27:32,411][root][INFO] - Full model selected, loading model
[2025-02-21 04:27:55,243][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:29:36,635][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:29:36,635][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:30:08,992][root][INFO] - Peft model loaded successfully
[2025-02-21 04:30:16,230][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:30:16,231][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:30:16,231][root][INFO] - Starting inference
[2025-02-21 04:30:16,423][root][INFO] - Processing question number 0
[2025-02-21 04:30:16,432][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:30:27,765][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:30:38,882][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:30:51,466][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:31:01,252][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:31:11,624][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:31:21,323][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:31:32,030][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:31:40,882][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:31:46,081][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:31:54,998][root][INFO] - Processing question number 10
[2025-02-21 04:31:55,000][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:32:05,619][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:32:21,745][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:32:30,742][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:32:42,069][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:32:55,318][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:33:05,883][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:33:15,788][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:33:24,661][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:33:35,439][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:33:45,926][root][INFO] - Processing question number 20
[2025-02-21 04:33:45,928][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:33:57,623][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:34:10,319][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:34:19,797][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:34:28,573][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:34:38,141][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:34:47,555][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:35:00,194][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:35:09,366][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:35:18,698][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:35:28,737][root][INFO] - Processing question number 30
[2025-02-21 04:35:28,739][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:35:44,642][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:35:53,221][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:36:01,369][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:36:33,069][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:36:44,618][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:36:55,544][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:37:06,576][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:37:18,443][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:37:29,773][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:37:38,232][root][INFO] - Processing question number 40
[2025-02-21 04:37:38,235][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:37:51,657][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:37:59,244][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:38:15,359][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:38:46,092][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:39:02,663][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:39:09,988][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:39:20,020][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:39:51,471][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:40:00,636][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:40:10,255][root][INFO] - Processing question number 50
[2025-02-21 04:40:10,259][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:40:18,498][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:40:31,441][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:40:43,464][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:40:56,920][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:41:09,549][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:41:20,140][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:41:33,586][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:41:45,846][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:41:52,446][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:42:04,248][root][INFO] - Processing question number 60
[2025-02-21 04:42:04,252][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:42:12,667][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:42:23,003][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:42:55,177][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:43:06,197][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:43:16,081][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:43:21,829][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:43:31,578][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:43:42,791][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:43:55,566][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:44:03,240][root][INFO] - Processing question number 70
[2025-02-21 04:44:03,245][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:44:17,009][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:44:24,643][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:44:56,330][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:45:08,871][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:45:32,933][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:45:46,080][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:45:54,799][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:46:07,309][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:46:28,420][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:46:59,657][root][INFO] - Processing question number 80
[2025-02-21 04:46:59,662][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:47:13,136][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:47:23,199][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:47:36,570][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:47:49,202][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:47:56,534][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:48:13,282][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:48:26,536][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:48:37,851][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:48:52,199][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:49:01,163][root][INFO] - Processing question number 90
[2025-02-21 04:49:01,168][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:49:19,637][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:49:33,390][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:49:45,044][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:49:55,482][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:50:08,906][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:50:19,790][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:50:28,903][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:50:51,226][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:50:59,556][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:51:12,838][root][INFO] - Inference complete
[2025-02-21 04:51:12,838][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,845][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,860][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,884][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,884][root][INFO] - Saved parsed outputs
[2025-02-21 04:51:12,885][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,896][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,896][root][INFO] - Saved parsing metadata
[2025-02-21 04:51:12,896][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,898][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:12,909][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:51:12,924][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 04:51:12,924][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.48, 'malformed_label': 0, 'malformed_domain': 16, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 48, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.26666666666666666, 'Torts_accuracy': 0.6428571428571429, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 10, 'both_wrong': 6}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 04:51:19,281][root][INFO] - Setting global seed to 206
[2025-02-21 04:51:19,286][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:51:19,286][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:51:19,287][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:51:19,288][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:51:19,290][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:51:19,290][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:51:19,437][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:51:19,986][root][INFO] - Full model selected, loading model
[2025-02-21 04:51:38,339][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:51:38,339][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:51:45,896][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:51:45,898][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 04:51:45,898][root][INFO] - Starting inference
[2025-02-21 04:51:46,094][root][INFO] - Processing question number 0
[2025-02-21 04:51:46,096][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:51:58,653][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:52:07,559][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:52:17,688][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:52:28,184][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:52:42,735][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:52:52,632][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:52:59,881][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:53:10,023][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:53:19,285][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:53:28,832][root][INFO] - Processing question number 10
[2025-02-21 04:53:28,834][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:53:37,930][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:53:49,168][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:53:59,374][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:54:09,766][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:54:22,460][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:54:33,277][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:54:42,532][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:54:52,797][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:54:59,889][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:55:09,548][root][INFO] - Processing question number 20
[2025-02-21 04:55:09,550][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:55:20,626][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:55:28,488][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:55:37,372][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:55:46,347][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:55:53,982][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:56:02,340][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:56:13,526][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:56:21,650][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:56:28,703][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:56:38,088][root][INFO] - Processing question number 30
[2025-02-21 04:56:38,091][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:56:46,821][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:56:55,705][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:57:04,498][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:57:14,372][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:57:25,425][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:57:33,652][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:57:42,612][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:57:50,472][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:57:59,195][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:58:07,868][root][INFO] - Processing question number 40
[2025-02-21 04:58:07,871][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:58:19,396][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:58:26,796][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:58:37,516][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:58:44,218][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:58:57,774][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:59:10,280][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:59:19,621][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:59:27,014][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:59:37,956][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:59:47,336][root][INFO] - Processing question number 50
[2025-02-21 04:59:47,340][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:59:57,155][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:00:08,216][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:00:20,237][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:00:30,663][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:00:40,685][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:00:50,604][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:01:01,878][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:01:12,104][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:01:20,861][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:01:30,866][root][INFO] - Processing question number 60
[2025-02-21 05:01:30,870][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:01:42,010][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:01:50,225][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:02:04,525][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:02:13,040][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:02:22,852][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:02:33,424][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:02:42,030][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:02:52,551][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:03:03,674][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:03:15,526][root][INFO] - Processing question number 70
[2025-02-21 05:03:15,530][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:03:24,147][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:03:34,234][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:03:45,774][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:03:57,808][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:04:07,296][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:04:19,590][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:04:31,288][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:04:44,676][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:04:54,625][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:05:04,002][root][INFO] - Processing question number 80
[2025-02-21 05:05:04,007][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:05:10,666][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:05:19,367][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:05:27,711][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:05:38,687][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:05:50,218][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:06:03,027][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:06:16,085][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:06:24,651][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:06:33,709][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:06:42,883][root][INFO] - Processing question number 90
[2025-02-21 05:06:42,888][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:06:52,258][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:07:01,581][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:07:12,070][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:07:18,076][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:07:29,531][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:07:38,700][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:07:46,714][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:07:55,795][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:08:04,128][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:08:13,082][root][INFO] - Inference complete
[2025-02-21 05:08:13,083][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,089][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,103][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,109][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,109][root][INFO] - Saved parsed outputs
[2025-02-21 05:08:13,109][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,110][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,111][root][INFO] - Saved parsing metadata
[2025-02-21 05:08:13,111][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,113][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:08:13,114][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:08:13,127][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:08:13,127][root][INFO] - Summary of metrics : {'label_accuracy': 0.52, 'misclassification_rate': 0.48, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 52, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.08, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 18, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 05:08:20,376][root][INFO] - Setting global seed to 989
[2025-02-21 05:08:20,381][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:08:20,382][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:08:20,383][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:08:20,385][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:08:20,387][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:08:20,387][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:08:20,589][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:08:21,144][root][INFO] - Full model selected, loading model
[2025-02-21 05:08:36,735][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:10:16,865][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:10:16,866][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:10:48,719][root][INFO] - Peft model loaded successfully
[2025-02-21 05:10:55,906][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:10:55,909][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:10:55,909][root][INFO] - Starting inference
[2025-02-21 05:10:56,152][root][INFO] - Processing question number 0
[2025-02-21 05:10:56,154][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:11:07,551][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:11:27,003][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:11:40,352][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:11:55,849][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:12:06,493][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:12:14,756][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:12:45,646][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:12:54,716][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:13:00,271][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:13:16,617][root][INFO] - Processing question number 10
[2025-02-21 05:13:16,619][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:13:25,642][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:13:37,018][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:13:46,052][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:13:53,480][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:14:03,566][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:14:16,568][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:14:27,984][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:14:40,686][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:14:50,622][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:14:57,929][root][INFO] - Processing question number 20
[2025-02-21 05:14:57,932][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:15:08,712][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:15:17,416][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:15:25,894][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:15:34,455][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:15:43,263][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:15:56,093][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:16:06,731][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:16:21,706][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:16:31,121][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:16:40,586][root][INFO] - Processing question number 30
[2025-02-21 05:16:40,589][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:16:50,794][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:16:59,662][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:17:08,932][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:17:25,262][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:17:35,875][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:18:06,847][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:18:16,994][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:18:25,819][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:18:34,921][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:18:46,994][root][INFO] - Processing question number 40
[2025-02-21 05:18:46,997][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:18:57,864][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:19:08,749][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:19:20,756][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:19:35,190][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:19:49,062][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:20:20,050][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:20:30,696][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:21:01,899][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:21:13,912][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:21:23,161][root][INFO] - Processing question number 50
[2025-02-21 05:21:23,165][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:21:30,014][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:21:49,664][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:21:58,888][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:22:09,968][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:22:21,619][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:22:35,960][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:22:47,786][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:22:57,577][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:23:28,847][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:23:38,619][root][INFO] - Processing question number 60
[2025-02-21 05:23:38,623][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:23:48,073][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:23:59,692][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:24:09,055][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:24:24,706][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:24:42,487][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:25:13,318][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:25:43,972][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:25:53,415][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:26:07,759][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:26:16,840][root][INFO] - Processing question number 70
[2025-02-21 05:26:16,844][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:26:24,407][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:26:32,923][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:27:04,214][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:27:35,800][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:27:49,429][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:27:59,267][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:28:08,077][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:28:20,737][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:28:30,744][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:28:38,429][root][INFO] - Processing question number 80
[2025-02-21 05:28:38,434][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:28:44,621][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:28:56,757][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:29:06,500][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:29:14,548][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:29:23,397][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:29:54,284][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:30:07,879][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:30:16,637][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:30:26,518][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:30:57,494][root][INFO] - Processing question number 90
[2025-02-21 05:30:57,499][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:31:03,887][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:31:35,342][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:31:47,505][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:31:57,217][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:32:06,442][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:32:17,438][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:32:29,623][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:32:57,901][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:33:06,854][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:33:19,760][root][INFO] - Inference complete
[2025-02-21 05:33:19,760][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,766][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,781][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,790][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,790][root][INFO] - Saved parsed outputs
[2025-02-21 05:33:19,790][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,791][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,791][root][INFO] - Saved parsing metadata
[2025-02-21 05:33:19,792][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,794][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:19,796][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:33:19,819][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:33:19,819][root][INFO] - Summary of metrics : {'label_accuracy': 0.57, 'misclassification_rate': 0.43000000000000005, 'combined_accuracy': 0.46, 'malformed_label': 0, 'malformed_domain': 14, 'total_predictions': 100, 'correct_predictions': 57, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 40, 'correct_label_wrong_domain': 11, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 05:33:26,157][root][INFO] - Setting global seed to 989
[2025-02-21 05:33:26,163][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:33:26,163][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:33:26,164][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:33:26,165][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:33:26,167][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:33:26,167][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:33:26,328][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:33:26,854][root][INFO] - Full model selected, loading model
[2025-02-21 05:33:48,058][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:33:48,067][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:33:55,898][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:33:55,900][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:33:55,900][root][INFO] - Starting inference
[2025-02-21 05:33:56,091][root][INFO] - Processing question number 0
[2025-02-21 05:33:56,094][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:34:09,365][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:34:17,654][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:34:26,791][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:34:35,794][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:34:46,113][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:34:55,383][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:35:04,684][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:35:11,926][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:35:18,725][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:35:27,698][root][INFO] - Processing question number 10
[2025-02-21 05:35:27,700][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:35:36,670][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:35:55,204][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:36:06,012][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:36:15,134][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:36:23,429][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:36:32,564][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:36:40,322][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:36:50,793][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:36:58,335][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:37:06,966][root][INFO] - Processing question number 20
[2025-02-21 05:37:06,969][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:37:19,596][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:37:28,886][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:37:36,232][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:37:45,818][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:37:53,059][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:38:02,392][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:38:12,677][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:38:22,168][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:38:29,857][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:38:39,160][root][INFO] - Processing question number 30
[2025-02-21 05:38:39,162][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:38:48,316][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:38:58,501][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:39:11,476][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:39:21,315][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:39:29,794][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:39:38,590][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:39:49,569][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:39:58,235][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:40:06,441][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:40:16,768][root][INFO] - Processing question number 40
[2025-02-21 05:40:16,772][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:40:25,352][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:40:34,546][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:40:44,318][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:40:57,342][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:41:09,581][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:41:16,565][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:41:24,644][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:41:36,239][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:41:46,123][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:41:56,308][root][INFO] - Processing question number 50
[2025-02-21 05:41:56,311][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:42:06,726][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:42:14,507][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:42:25,912][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:42:36,143][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:42:45,441][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:42:56,008][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:43:07,833][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:43:15,355][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:43:24,718][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:43:32,563][root][INFO] - Processing question number 60
[2025-02-21 05:43:32,566][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:43:41,170][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:43:49,678][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:44:01,420][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:44:08,359][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:44:18,785][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:44:27,752][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:44:35,564][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:44:45,604][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:44:58,061][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:45:10,844][root][INFO] - Processing question number 70
[2025-02-21 05:45:10,848][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:45:19,353][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:45:28,072][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:45:51,378][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:46:01,945][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:46:11,699][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:46:24,681][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:46:33,084][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:46:44,727][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:46:52,398][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:47:01,447][root][INFO] - Processing question number 80
[2025-02-21 05:47:01,451][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:47:08,615][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:47:17,594][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:47:25,680][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:47:33,877][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:47:43,875][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:47:51,567][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:48:04,494][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:48:14,191][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:48:23,075][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:48:33,410][root][INFO] - Processing question number 90
[2025-02-21 05:48:33,414][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:48:41,415][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:48:53,169][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:49:24,492][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:49:33,949][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:49:42,239][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:49:52,528][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:50:01,320][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:50:09,492][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:50:17,807][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:50:27,486][root][INFO] - Inference complete
[2025-02-21 05:50:27,486][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,492][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,505][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,521][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,521][root][INFO] - Saved parsed outputs
[2025-02-21 05:50:27,521][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,522][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,522][root][INFO] - Saved parsing metadata
[2025-02-21 05:50:27,523][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,524][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:50:27,534][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:50:27,549][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 05:50:27,549][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.34, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.09, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.1, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 15, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 05:50:34,910][root][INFO] - Setting global seed to 989
[2025-02-21 05:50:34,917][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:50:34,917][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:50:34,918][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:50:34,920][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:50:34,922][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:50:34,923][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:50:35,085][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:50:35,605][root][INFO] - Full model selected, loading model
[2025-02-21 05:50:56,782][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:52:37,649][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:52:37,649][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:53:10,304][root][INFO] - Peft model loaded successfully
[2025-02-21 05:53:17,954][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:53:17,956][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 05:53:17,956][root][INFO] - Starting inference
[2025-02-21 05:53:18,152][root][INFO] - Processing question number 0
[2025-02-21 05:53:18,155][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:53:28,764][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:53:39,067][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:53:55,254][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:54:02,369][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:54:15,404][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:54:24,216][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:54:55,509][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:55:04,797][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:55:12,877][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:55:22,527][root][INFO] - Processing question number 10
[2025-02-21 05:55:22,529][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:55:33,894][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:55:46,743][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:55:57,404][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:56:05,869][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:56:14,981][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:56:22,653][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:56:34,518][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:56:44,038][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:56:54,555][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:57:03,063][root][INFO] - Processing question number 20
[2025-02-21 05:57:03,066][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:57:13,299][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:57:21,413][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:57:30,494][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:57:40,019][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:57:49,191][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:57:58,307][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:58:13,466][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:58:29,926][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:58:44,289][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:58:55,293][root][INFO] - Processing question number 30
[2025-02-21 05:58:55,295][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:59:06,289][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:59:13,935][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:59:45,412][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:00:01,831][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:00:17,510][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:00:40,484][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:00:50,198][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:01:00,527][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:01:14,277][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:01:24,412][root][INFO] - Processing question number 40
[2025-02-21 06:01:24,415][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:01:40,015][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:01:50,334][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:02:21,988][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:02:33,717][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:02:54,353][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:03:04,376][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:03:35,670][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:03:47,129][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:03:59,364][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:04:09,389][root][INFO] - Processing question number 50
[2025-02-21 06:04:09,393][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:04:15,523][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:04:29,530][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:05:01,302][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:05:13,210][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:05:21,369][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:05:33,066][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:05:48,965][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:06:02,574][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:06:16,089][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:06:27,758][root][INFO] - Processing question number 60
[2025-02-21 06:06:27,763][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:06:59,189][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:07:16,309][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:07:27,171][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:07:36,692][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:07:50,656][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:08:03,290][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:08:09,187][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:08:15,804][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:08:46,986][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:08:58,586][root][INFO] - Processing question number 70
[2025-02-21 06:08:58,590][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:09:07,610][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:09:15,893][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:09:47,592][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:09:58,142][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:10:09,508][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:10:21,962][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:10:30,278][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:10:43,312][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:10:54,300][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:11:25,558][root][INFO] - Processing question number 80
[2025-02-21 06:11:25,562][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:11:34,540][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:11:47,870][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:12:02,178][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:12:12,297][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:12:39,271][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:12:48,662][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:13:00,698][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:13:07,703][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:13:19,431][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:13:29,511][root][INFO] - Processing question number 90
[2025-02-21 06:13:29,516][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:13:38,229][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:14:10,101][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:14:24,261][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:14:30,658][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:15:02,585][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:15:22,919][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:15:32,943][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:15:51,515][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:16:11,376][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:16:22,825][root][INFO] - Inference complete
[2025-02-21 06:16:22,825][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,832][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,847][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,853][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,853][root][INFO] - Saved parsed outputs
[2025-02-21 06:16:22,853][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,866][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,866][root][INFO] - Saved parsing metadata
[2025-02-21 06:16:22,866][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,868][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:22,873][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:16:22,891][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:16:22,892][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.45, 'malformed_label': 0, 'malformed_domain': 16, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 45, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 39, 'correct_label_wrong_domain': 13, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 06:16:30,245][root][INFO] - Setting global seed to 989
[2025-02-21 06:16:30,253][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:16:30,254][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:16:30,255][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:16:30,256][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:16:30,259][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:16:30,259][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:16:30,418][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:16:30,947][root][INFO] - Full model selected, loading model
[2025-02-21 06:16:47,459][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:16:47,459][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:16:54,849][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:16:54,850][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:16:54,851][root][INFO] - Starting inference
[2025-02-21 06:16:55,055][root][INFO] - Processing question number 0
[2025-02-21 06:16:55,061][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:17:06,460][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:17:14,862][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:17:23,065][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:17:35,079][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:17:44,311][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:17:54,754][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:18:03,742][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:18:11,378][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:18:19,012][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:18:29,414][root][INFO] - Processing question number 10
[2025-02-21 06:18:29,416][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:18:35,571][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:18:48,219][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:18:57,024][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:19:04,650][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:19:16,392][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:19:26,257][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:19:34,271][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:19:43,546][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:19:50,839][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:20:00,703][root][INFO] - Processing question number 20
[2025-02-21 06:20:00,706][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:20:10,064][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:20:19,033][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:20:27,347][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:20:36,185][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:20:43,478][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:20:53,550][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:21:05,557][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:21:14,943][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:21:25,536][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:21:36,195][root][INFO] - Processing question number 30
[2025-02-21 06:21:36,198][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:21:44,147][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:21:53,141][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:22:04,995][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:22:13,259][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:22:20,225][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:22:33,529][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:22:44,768][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:22:55,478][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:23:04,149][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:23:13,616][root][INFO] - Processing question number 40
[2025-02-21 06:23:13,619][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:23:23,171][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:23:31,503][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:23:42,935][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:23:50,370][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:24:02,372][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:24:09,253][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:24:16,654][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:24:25,098][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:24:35,378][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:24:46,923][root][INFO] - Processing question number 50
[2025-02-21 06:24:46,926][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:24:56,579][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:25:06,394][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:25:20,315][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:25:31,659][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:25:43,323][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:25:53,843][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:26:04,618][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:26:12,231][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:26:22,299][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:26:29,997][root][INFO] - Processing question number 60
[2025-02-21 06:26:30,001][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:26:38,079][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:26:47,548][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:26:56,980][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:27:05,802][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:27:17,588][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:27:26,322][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:27:34,783][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:27:44,317][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:27:55,997][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:28:08,155][root][INFO] - Processing question number 70
[2025-02-21 06:28:08,159][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:28:17,132][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:28:24,816][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:28:42,510][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:28:54,440][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:29:06,368][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:29:17,755][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:29:28,122][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:29:37,815][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:29:44,692][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:29:53,196][root][INFO] - Processing question number 80
[2025-02-21 06:29:53,202][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:29:59,979][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:30:07,785][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:30:18,423][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:30:29,715][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:30:41,569][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:30:52,017][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:31:01,834][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:31:12,297][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:31:21,920][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:31:32,362][root][INFO] - Processing question number 90
[2025-02-21 06:31:32,367][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:31:40,483][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:31:50,123][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:31:59,924][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:32:08,021][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:32:19,480][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:32:30,220][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:32:39,290][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:32:46,933][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:32:54,530][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:33:05,303][root][INFO] - Inference complete
[2025-02-21 06:33:05,304][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,310][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,323][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,329][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,329][root][INFO] - Saved parsed outputs
[2025-02-21 06:33:05,329][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,330][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,330][root][INFO] - Saved parsing metadata
[2025-02-21 06:33:05,331][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,333][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:33:05,334][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:33:05,360][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:33:05,360][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.33, 'malformed_label': 0, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.1, 'Criminal_Law_confidence': 0.08, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.12, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 36, 'correct_label_wrong_domain': 16, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 06:33:12,901][root][INFO] - Setting global seed to 989
[2025-02-21 06:33:12,908][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:33:12,908][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:33:12,909][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:33:12,910][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:33:12,913][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:33:12,913][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:33:13,098][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:33:14,072][root][INFO] - Full model selected, loading model
[2025-02-21 06:33:34,288][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:35:15,372][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:35:15,372][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:35:49,035][root][INFO] - Peft model loaded successfully
[2025-02-21 06:35:56,366][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:35:56,367][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:35:56,367][root][INFO] - Starting inference
[2025-02-21 06:35:56,597][root][INFO] - Processing question number 0
[2025-02-21 06:35:56,607][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:36:04,533][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:36:14,486][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:36:22,592][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:36:30,868][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:36:55,285][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:37:07,161][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:37:16,846][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:37:24,490][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:37:38,089][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:37:46,151][root][INFO] - Processing question number 10
[2025-02-21 06:37:46,152][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:37:53,237][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:38:08,718][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:38:19,429][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:38:27,108][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:38:42,251][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:39:00,746][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:39:09,705][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:39:19,682][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:39:32,435][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:39:39,591][root][INFO] - Processing question number 20
[2025-02-21 06:39:39,594][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:39:49,043][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:39:57,560][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:40:06,849][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:40:16,531][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:40:23,382][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:40:41,120][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:40:50,755][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:41:07,126][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:41:17,468][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:41:41,096][root][INFO] - Processing question number 30
[2025-02-21 06:41:41,099][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:41:51,142][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:42:00,229][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:42:09,575][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:42:23,059][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:42:33,917][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:42:48,594][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:42:57,040][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:43:04,726][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:43:14,756][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:43:23,871][root][INFO] - Processing question number 40
[2025-02-21 06:43:23,874][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:43:38,368][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:43:47,598][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:44:19,270][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:44:41,456][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:44:59,280][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:45:09,860][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:45:20,101][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:45:30,154][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:45:44,019][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:45:52,792][root][INFO] - Processing question number 50
[2025-02-21 06:45:52,795][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:46:01,044][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:46:08,788][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:46:19,149][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:46:32,061][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:46:42,489][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:46:50,825][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:47:01,244][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:47:08,910][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:47:27,162][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:47:38,938][root][INFO] - Processing question number 60
[2025-02-21 06:47:38,942][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:47:55,524][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:48:10,448][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:48:25,583][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:48:37,528][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:48:47,748][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:48:57,628][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:49:28,724][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:49:35,989][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:49:46,120][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:49:56,080][root][INFO] - Processing question number 70
[2025-02-21 06:49:56,085][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:50:06,821][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:50:18,174][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:50:49,902][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:51:21,927][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:51:36,028][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:51:58,138][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:52:12,970][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:52:26,235][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:52:33,134][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:52:55,639][root][INFO] - Processing question number 80
[2025-02-21 06:52:55,644][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:53:04,926][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:53:12,526][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:53:44,009][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:53:51,826][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:54:01,971][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:54:12,924][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:54:28,768][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:54:38,968][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:54:47,076][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:54:57,457][root][INFO] - Processing question number 90
[2025-02-21 06:54:57,462][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:55:08,145][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:55:23,871][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:55:33,863][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:55:42,454][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:56:12,942][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:56:23,685][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:56:32,512][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:56:44,946][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:56:53,378][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:57:17,301][root][INFO] - Inference complete
[2025-02-21 06:57:17,302][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,308][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,323][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,328][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,328][root][INFO] - Saved parsed outputs
[2025-02-21 06:57:17,328][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,330][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,330][root][INFO] - Saved parsing metadata
[2025-02-21 06:57:17,331][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,333][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:17,334][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:57:17,357][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 06:57:17,357][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.48, 'malformed_label': 0, 'malformed_domain': 15, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 48, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.26666666666666666, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.3333333333333333, 'Torts_accuracy': 0.7857142857142857, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.15, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.15, 'Evidence_confidence': 0.1, 'Real_Property_confidence': 0.1, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 5}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 4 to status running with exit code None
Eval status update completed for job 4
[2025-02-21 06:57:23,764][root][INFO] - Setting global seed to 989
[2025-02-21 06:57:23,770][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:57:23,770][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:57:23,772][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:57:23,773][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:57:23,775][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:57:23,776][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:57:23,930][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:57:24,452][root][INFO] - Full model selected, loading model
[2025-02-21 06:57:46,380][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:57:46,381][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:57:54,050][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:57:54,052][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 06:57:54,052][root][INFO] - Starting inference
[2025-02-21 06:57:54,237][root][INFO] - Processing question number 0
[2025-02-21 06:57:54,248][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:58:04,809][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:58:16,311][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:58:26,694][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:58:35,522][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:58:47,552][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:58:55,673][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:59:05,704][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:59:14,904][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:59:22,216][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:59:32,105][root][INFO] - Processing question number 10
[2025-02-21 06:59:32,107][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:59:39,334][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:59:48,031][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:59:56,743][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:00:05,951][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:00:16,539][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:00:29,347][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:00:35,331][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:00:50,217][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:00:58,986][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:01:08,052][root][INFO] - Processing question number 20
[2025-02-21 07:01:08,054][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:01:14,085][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:01:22,548][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:01:31,084][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:01:39,315][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:01:49,932][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:01:58,387][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:02:10,678][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:02:19,603][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:02:31,546][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:02:40,984][root][INFO] - Processing question number 30
[2025-02-21 07:02:40,987][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:02:50,519][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:02:57,965][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:03:09,061][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:03:21,513][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:03:28,427][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:03:41,878][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:03:52,917][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:04:05,603][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:04:12,534][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:04:22,803][root][INFO] - Processing question number 40
[2025-02-21 07:04:22,806][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:04:32,306][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:04:42,022][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:04:53,597][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:04:59,666][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:05:13,970][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:05:22,091][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:05:30,084][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:05:40,330][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:05:51,915][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:06:00,674][root][INFO] - Processing question number 50
[2025-02-21 07:06:00,677][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:06:10,429][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:06:16,936][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:06:26,227][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:06:38,020][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:06:48,388][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:06:58,953][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:07:08,103][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:07:17,567][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:07:26,980][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:07:37,537][root][INFO] - Processing question number 60
[2025-02-21 07:07:37,541][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:07:47,570][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:07:57,136][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:08:11,949][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:08:24,501][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:08:35,015][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:08:46,443][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:08:54,060][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:09:03,589][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:09:10,393][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:09:18,612][root][INFO] - Processing question number 70
[2025-02-21 07:09:18,616][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:09:28,591][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:09:36,322][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:09:45,288][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:09:54,712][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:10:03,061][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:10:12,171][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:10:21,867][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:10:31,399][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:10:38,929][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:10:46,717][root][INFO] - Processing question number 80
[2025-02-21 07:10:46,722][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:10:53,532][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:10:59,064][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:11:07,714][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:11:17,931][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:11:26,532][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:11:35,973][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:11:47,043][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:11:55,508][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:12:05,371][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:12:15,148][root][INFO] - Processing question number 90
[2025-02-21 07:12:15,154][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:12:27,398][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:12:39,110][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:12:48,544][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:12:55,041][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:13:07,877][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:13:16,639][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:13:23,401][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:13:33,076][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:13:41,260][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:13:50,263][root][INFO] - Inference complete
[2025-02-21 07:13:50,263][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,270][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,283][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,288][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,288][root][INFO] - Saved parsed outputs
[2025-02-21 07:13:50,288][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,290][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,290][root][INFO] - Saved parsing metadata
[2025-02-21 07:13:50,290][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,292][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 07:13:50,294][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:13:50,327][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 07:13:50,327][root][INFO] - Summary of metrics : {'label_accuracy': 0.5, 'misclassification_rate': 0.5, 'combined_accuracy': 0.31, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 50, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.06666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.14, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.1, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.13, 'Torts_confidence': 0.09, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 19, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '4', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 4 to status completed with exit code 0
Eval status update completed for job 4
Job 4 completed at Fri Feb 21 07:13:51 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n511
Job ID: 25309339
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 08:26:33
CPU Efficiency: 9.90% of 3-13:16:10 core-walltime
Job Wall-clock time: 08:31:37
Memory Utilized: 34.85 GB
Memory Efficiency: 96.81% of 36.00 GB
